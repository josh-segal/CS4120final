<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Redundancy Does Not Imply Fault Tolerance: Analysis of Distributed Storage Reactions</p>
    <p>to Single Errors and Corruptions</p>
    <p>Aishwarya Ganesan, Ramnatthan Alagappan,</p>
    <p>Andrea Arpaci-Dusseau, Remzi Arpaci-Dusseau</p>
  </div>
  <div class="page">
    <p>Redundancy for Fault Tolerance</p>
  </div>
  <div class="page">
    <p>Redundancy for Fault Tolerance</p>
    <p>Replication can mask failures</p>
  </div>
  <div class="page">
    <p>Redundancy for Fault Tolerance</p>
    <p>Replication can mask failures</p>
    <p>- System crashes</p>
  </div>
  <div class="page">
    <p>Redundancy for Fault Tolerance</p>
    <p>Replication can mask failures</p>
    <p>- System crashes</p>
    <p>- Machine reboots</p>
  </div>
  <div class="page">
    <p>Redundancy for Fault Tolerance</p>
    <p>Replication can mask failures</p>
    <p>- Network failures</p>
    <p>- System crashes</p>
    <p>- Machine reboots</p>
  </div>
  <div class="page">
    <p>Redundancy in Distributed Storage</p>
  </div>
  <div class="page">
    <p>Redundancy in Distributed Storage</p>
    <p>Depend on local file systems to store data</p>
  </div>
  <div class="page">
    <p>Redundancy in Distributed Storage</p>
    <p>How about partial storage faults?</p>
    <p>Depend on local file systems to store data</p>
  </div>
  <div class="page">
    <p>Redundancy in Distributed Storage</p>
    <p>File system may return corrupted data on reads</p>
    <p>How about partial storage faults?</p>
    <p>Depend on local file systems to store data</p>
  </div>
  <div class="page">
    <p>Redundancy in Distributed Storage</p>
    <p>File system may return corrupted data on reads</p>
    <p>How about partial storage faults?</p>
    <p>Depend on local file systems to store data</p>
  </div>
  <div class="page">
    <p>Redundancy in Distributed Storage</p>
    <p>File system may return corrupted data on reads</p>
    <p>- disk block corruption</p>
    <p>How about partial storage faults?</p>
    <p>Depend on local file systems to store data</p>
  </div>
  <div class="page">
    <p>Redundancy in Distributed Storage</p>
    <p>File system may return corrupted data on reads</p>
    <p>- disk block corruption</p>
    <p>File system may return I/O error on a read</p>
    <p>How about partial storage faults?</p>
    <p>Depend on local file systems to store data</p>
  </div>
  <div class="page">
    <p>Redundancy in Distributed Storage</p>
    <p>File system may return corrupted data on reads</p>
    <p>- disk block corruption</p>
    <p>File system may return I/O error on a read</p>
    <p>- latent sector error</p>
    <p>How about partial storage faults?</p>
    <p>Depend on local file systems to store data</p>
  </div>
  <div class="page">
    <p>Redundancy in Distributed Storage</p>
    <p>File system may return corrupted data on reads</p>
    <p>- disk block corruption</p>
    <p>File system may return I/O error on a read</p>
    <p>- latent sector error</p>
    <p>We call these file-system faults</p>
    <p>How about partial storage faults?</p>
    <p>Depend on local file systems to store data</p>
  </div>
  <div class="page">
    <p>Redundancy in Distributed Storage</p>
    <p>File system may return corrupted data on reads</p>
    <p>- disk block corruption</p>
    <p>File system may return I/O error on a read</p>
    <p>- latent sector error</p>
    <p>We call these file-system faults</p>
    <p>How about partial storage faults?</p>
    <p>Depend on local file systems to store data</p>
    <p>Do distributed storage systems use redundancy to recover from local file-system faults?</p>
  </div>
  <div class="page">
    <p>Our Study</p>
  </div>
  <div class="page">
    <p>Our Study Behavior of eight distributed systems in response to file-system faults</p>
  </div>
  <div class="page">
    <p>Our Study Behavior of eight distributed systems in response to file-system faults</p>
    <p>Broad spectrum of replication and consensus protocols</p>
  </div>
  <div class="page">
    <p>Our Study Behavior of eight distributed systems in response to file-system faults</p>
    <p>Broad spectrum of replication and consensus protocols</p>
    <p>Replicated state machines - ZooKeeper (uses ZAB for consensus)</p>
    <p>- LogCabin, CockroachDB, and RethinkDB (uses RAFT for consensus)</p>
  </div>
  <div class="page">
    <p>Our Study Behavior of eight distributed systems in response to file-system faults</p>
    <p>Broad spectrum of replication and consensus protocols</p>
    <p>Replicated state machines - ZooKeeper (uses ZAB for consensus)</p>
    <p>- LogCabin, CockroachDB, and RethinkDB (uses RAFT for consensus)</p>
    <p>Primary backup replication - MongoDB</p>
    <p>- Redis</p>
    <p>- Kafka (in-sync replicas for leader election)</p>
  </div>
  <div class="page">
    <p>Our Study Behavior of eight distributed systems in response to file-system faults</p>
    <p>Broad spectrum of replication and consensus protocols</p>
    <p>Replicated state machines - ZooKeeper (uses ZAB for consensus)</p>
    <p>- LogCabin, CockroachDB, and RethinkDB (uses RAFT for consensus)</p>
    <p>Primary backup replication - MongoDB</p>
    <p>- Redis</p>
    <p>- Kafka (in-sync replicas for leader election)</p>
    <p>Dynamo-style quorum - Cassandra (decentralized, no leader/follower)</p>
  </div>
  <div class="page">
    <p>Fault model</p>
  </div>
  <div class="page">
    <p>Fault model</p>
    <p>A single fault to a single file-system block in a single node</p>
  </div>
  <div class="page">
    <p>Fault model</p>
    <p>A single fault to a single file-system block in a single node</p>
    <p>Type of faults:</p>
    <p>- corruptions</p>
    <p>- read errors</p>
    <p>- write errors</p>
  </div>
  <div class="page">
    <p>Common Expectation</p>
  </div>
  <div class="page">
    <p>Common Expectation</p>
  </div>
  <div class="page">
    <p>Common Expectation</p>
    <p>Fault Model: A single fault to one block in only one replica</p>
  </div>
  <div class="page">
    <p>Common Expectation</p>
    <p>Fault Model: A single fault to one block in only one replica</p>
    <p>Redundancy would enable recovery from local file-system faults</p>
  </div>
  <div class="page">
    <p>Redundancy Does Not Imply Fault Tolerance</p>
  </div>
  <div class="page">
    <p>Redundancy Does Not Imply Fault Tolerance A single fault in one node can cause catastrophic outcomes</p>
  </div>
  <div class="page">
    <p>Redundancy Does Not Imply Fault Tolerance A single fault in one node can cause catastrophic outcomes</p>
    <p>- data loss, corruption, unavailability, and spread of corruption to other intact replicas</p>
  </div>
  <div class="page">
    <p>Redundancy Does Not Imply Fault Tolerance A single fault in one node can cause catastrophic outcomes</p>
    <p>- data loss, corruption, unavailability, and spread of corruption to other intact replicas</p>
    <p>Silent corruption</p>
    <p>Unavailability Data loss Reduced</p>
    <p>redundancy Query</p>
    <p>failures</p>
    <p>Redis</p>
    <p>ZooKeeper</p>
    <p>Cassandra</p>
    <p>Kafka</p>
    <p>RethinkDB</p>
    <p>MongoDB</p>
    <p>LogCabin</p>
    <p>CockroachDB</p>
  </div>
  <div class="page">
    <p>Redundancy Does Not Imply Fault Tolerance A single fault in one node can cause catastrophic outcomes</p>
    <p>- data loss, corruption, unavailability, and spread of corruption to other intact replicas</p>
    <p>Silent corruption</p>
    <p>Unavailability Data loss Reduced</p>
    <p>redundancy Query</p>
    <p>failures</p>
    <p>Redis</p>
    <p>ZooKeeper</p>
    <p>Cassandra</p>
    <p>Kafka</p>
    <p>RethinkDB</p>
    <p>MongoDB</p>
    <p>LogCabin</p>
    <p>CockroachDB</p>
  </div>
  <div class="page">
    <p>Why does Redundancy Not Imply Fault Tolerance?</p>
  </div>
  <div class="page">
    <p>Why does Redundancy Not Imply Fault Tolerance?</p>
    <p>Some fundamental problems across multiple systems  not just implementation bugs!</p>
  </div>
  <div class="page">
    <p>Why does Redundancy Not Imply Fault Tolerance?</p>
    <p>Some fundamental problems across multiple systems  not just implementation bugs!</p>
    <p>Faults are often undetected locally  leads to harmful global effects</p>
  </div>
  <div class="page">
    <p>Why does Redundancy Not Imply Fault Tolerance?</p>
    <p>Some fundamental problems across multiple systems  not just implementation bugs!</p>
    <p>Faults are often undetected locally  leads to harmful global effects</p>
    <p>On detection, crashing is the common action  redundancy underutilized</p>
  </div>
  <div class="page">
    <p>Why does Redundancy Not Imply Fault Tolerance?</p>
    <p>Some fundamental problems across multiple systems  not just implementation bugs!</p>
    <p>Faults are often undetected locally  leads to harmful global effects</p>
    <p>On detection, crashing is the common action  redundancy underutilized</p>
    <p>Crash and corruption handling are entangled  loss of committed data</p>
  </div>
  <div class="page">
    <p>Why does Redundancy Not Imply Fault Tolerance?</p>
    <p>Some fundamental problems across multiple systems  not just implementation bugs!</p>
    <p>Faults are often undetected locally  leads to harmful global effects</p>
    <p>On detection, crashing is the common action  redundancy underutilized</p>
    <p>Crash and corruption handling are entangled  loss of committed data</p>
    <p>Unsafe interaction between local behavior and global distributed protocols can spread corruption or data loss</p>
  </div>
  <div class="page">
    <p>Fundamental Problems: Summary</p>
  </div>
  <div class="page">
    <p>Locally undetected</p>
    <p>faults?</p>
    <p>Crashing common local</p>
    <p>action?</p>
    <p>Crash &amp; corruption handling</p>
    <p>entangled?</p>
    <p>Unsafe interaction of local &amp; global</p>
    <p>protocols?</p>
    <p>Redundancy underutilized for recovery?</p>
    <p>Redis</p>
    <p>ZooKeeper</p>
    <p>Cassandra</p>
    <p>Kafka</p>
    <p>RethinkDB</p>
    <p>MongoDB</p>
    <p>LogCabin</p>
    <p>CockroachDB</p>
    <p>Fundamental Problems: Summary</p>
  </div>
  <div class="page">
    <p>Locally undetected</p>
    <p>faults?</p>
    <p>Crashing common local</p>
    <p>action?</p>
    <p>Crash &amp; corruption handling</p>
    <p>entangled?</p>
    <p>Unsafe interaction of local &amp; global</p>
    <p>protocols?</p>
    <p>Redundancy underutilized for recovery?</p>
    <p>Redis</p>
    <p>ZooKeeper</p>
    <p>Cassandra</p>
    <p>Kafka</p>
    <p>RethinkDB</p>
    <p>MongoDB</p>
    <p>LogCabin</p>
    <p>CockroachDB</p>
    <p>Fundamental Problems: Summary</p>
  </div>
  <div class="page">
    <p>Locally undetected</p>
    <p>faults?</p>
    <p>Crashing common local</p>
    <p>action?</p>
    <p>Crash &amp; corruption handling</p>
    <p>entangled?</p>
    <p>Unsafe interaction of local &amp; global</p>
    <p>protocols?</p>
    <p>Redundancy underutilized for recovery?</p>
    <p>Redis</p>
    <p>ZooKeeper</p>
    <p>Cassandra</p>
    <p>Kafka</p>
    <p>RethinkDB</p>
    <p>MongoDB</p>
    <p>LogCabin</p>
    <p>CockroachDB</p>
    <p>Fundamental Problems: Summary</p>
  </div>
  <div class="page">
    <p>Locally undetected</p>
    <p>faults?</p>
    <p>Crashing common local</p>
    <p>action?</p>
    <p>Crash &amp; corruption handling</p>
    <p>entangled?</p>
    <p>Unsafe interaction of local &amp; global</p>
    <p>protocols?</p>
    <p>Redundancy underutilized for recovery?</p>
    <p>Redis</p>
    <p>ZooKeeper</p>
    <p>Cassandra</p>
    <p>Kafka</p>
    <p>RethinkDB</p>
    <p>MongoDB</p>
    <p>LogCabin</p>
    <p>CockroachDB</p>
    <p>Fundamental Problems: Summary</p>
  </div>
  <div class="page">
    <p>Locally undetected</p>
    <p>faults?</p>
    <p>Crashing common local</p>
    <p>action?</p>
    <p>Crash &amp; corruption handling</p>
    <p>entangled?</p>
    <p>Unsafe interaction of local &amp; global</p>
    <p>protocols?</p>
    <p>Redundancy underutilized for recovery?</p>
    <p>Redis</p>
    <p>ZooKeeper</p>
    <p>Cassandra</p>
    <p>Kafka</p>
    <p>RethinkDB</p>
    <p>MongoDB</p>
    <p>LogCabin</p>
    <p>CockroachDB</p>
    <p>Fundamental Problems: Summary</p>
  </div>
  <div class="page">
    <p>Locally undetected</p>
    <p>faults?</p>
    <p>Crashing common local</p>
    <p>action?</p>
    <p>Crash &amp; corruption handling</p>
    <p>entangled?</p>
    <p>Unsafe interaction of local &amp; global</p>
    <p>protocols?</p>
    <p>Redundancy underutilized for recovery?</p>
    <p>Redis</p>
    <p>ZooKeeper</p>
    <p>Cassandra</p>
    <p>Kafka</p>
    <p>RethinkDB</p>
    <p>MongoDB</p>
    <p>LogCabin</p>
    <p>CockroachDB</p>
    <p>Fundamental Problems: Summary</p>
  </div>
  <div class="page">
    <p>Outline</p>
    <p>Introduction</p>
    <p>Fault Injection</p>
    <p>System Behavior Analysis</p>
    <p>Major Results</p>
    <p>Observations Across Systems</p>
    <p>Conclusion</p>
  </div>
  <div class="page">
    <p>Fault Model</p>
  </div>
  <div class="page">
    <p>Fault Model</p>
    <p>Server 1 Server 2 Server 3</p>
  </div>
  <div class="page">
    <p>Request</p>
    <p>Fault Model</p>
    <p>Server 1 Server 2 Server 3Client</p>
  </div>
  <div class="page">
    <p>Request</p>
    <p>Fault Model</p>
    <p>Server 1 Server 2 Server 3Client</p>
  </div>
  <div class="page">
    <p>Request</p>
    <p>Fault Model</p>
    <p>Server 1 Server 2 Server 3Client</p>
    <p>File System</p>
    <p>re a</p>
    <p>d /</p>
    <p>w ri</p>
    <p>te</p>
    <p>File System</p>
    <p>re a</p>
    <p>d /</p>
    <p>w ri</p>
    <p>te</p>
    <p>File System</p>
    <p>re a</p>
    <p>d /</p>
    <p>w ri</p>
    <p>te</p>
  </div>
  <div class="page">
    <p>Request</p>
    <p>Fault Model</p>
    <p>Server 1 Server 2 Server 3Client</p>
    <p>File System</p>
    <p>re a</p>
    <p>d /</p>
    <p>w ri</p>
    <p>te</p>
    <p>A single fault to a single file-system block in a single node</p>
    <p>File System</p>
    <p>re a</p>
    <p>d /</p>
    <p>w ri</p>
    <p>te</p>
    <p>File System</p>
    <p>re a</p>
    <p>d /</p>
    <p>w ri</p>
    <p>te</p>
  </div>
  <div class="page">
    <p>Request</p>
    <p>Fault Model</p>
    <p>Server 1 Server 2 Server 3Client</p>
    <p>File System</p>
    <p>re a</p>
    <p>d /</p>
    <p>w ri</p>
    <p>te</p>
    <p>A single fault to a single file-system block in a single node</p>
    <p>Fault for current run: server 1, block B1 read corruption</p>
    <p>File System</p>
    <p>re a</p>
    <p>d /</p>
    <p>w ri</p>
    <p>te</p>
    <p>File System</p>
    <p>re a</p>
    <p>d /</p>
    <p>w ri</p>
    <p>te</p>
  </div>
  <div class="page">
    <p>Request</p>
    <p>Fault Model</p>
    <p>Server 1 Server 2 Server 3Client</p>
    <p>File System</p>
    <p>re a</p>
    <p>d /</p>
    <p>w ri</p>
    <p>te</p>
    <p>A single fault to a single file-system block in a single node</p>
    <p>Fault for current run: server 1, block B1 read corruption</p>
    <p>Fault for next run: server 1, block B1 read error</p>
    <p>File System</p>
    <p>re a</p>
    <p>d /</p>
    <p>w ri</p>
    <p>te</p>
    <p>File System</p>
    <p>re a</p>
    <p>d /</p>
    <p>w ri</p>
    <p>te</p>
  </div>
  <div class="page">
    <p>Request</p>
    <p>Fault Model</p>
    <p>Server 1 Server 2 Server 3Client</p>
    <p>File System</p>
    <p>re a</p>
    <p>d /</p>
    <p>w ri</p>
    <p>te</p>
    <p>A single fault to a single file-system block in a single node</p>
    <p>Faults injected only to user data not filesystem metadata</p>
    <p>Fault for current run: server 1, block B1 read corruption</p>
    <p>Fault for next run: server 1, block B1 read error</p>
    <p>File System</p>
    <p>re a</p>
    <p>d /</p>
    <p>w ri</p>
    <p>te</p>
    <p>File System</p>
    <p>re a</p>
    <p>d /</p>
    <p>w ri</p>
    <p>te</p>
  </div>
  <div class="page">
    <p>Request</p>
    <p>Fault Model: ext4 and btrfs</p>
    <p>Server 1 Server 2 Server 3Client</p>
    <p>File System File System File System</p>
  </div>
  <div class="page">
    <p>Request</p>
    <p>Fault Model: ext4 and btrfs</p>
    <p>Server 1 Server 2 Server 3Client</p>
    <p>File System File System File Systemext4 ext4ext4</p>
  </div>
  <div class="page">
    <p>Request</p>
    <p>Fault Model: ext4 and btrfs</p>
    <p>Server 1 Server 2 Server 3Client</p>
    <p>File System File System File Systemext4 ext4ext4</p>
  </div>
  <div class="page">
    <p>Request</p>
    <p>Fault Model: ext4 and btrfs</p>
    <p>Server 1 Server 2 Server 3Client</p>
    <p>C o</p>
    <p>rr u</p>
    <p>p t</p>
    <p>d a</p>
    <p>ta</p>
    <p>File System File System File Systemext4 ext4ext4</p>
  </div>
  <div class="page">
    <p>Request</p>
    <p>Fault Model: ext4 and btrfs</p>
    <p>Server 1 Server 2 Server 3Client</p>
    <p>C o</p>
    <p>rr u</p>
    <p>p t</p>
    <p>d a</p>
    <p>ta C</p>
    <p>o rr</p>
    <p>u p</p>
    <p>t d</p>
    <p>a ta</p>
    <p>File System File System File Systemext4 ext4ext4</p>
  </div>
  <div class="page">
    <p>Request</p>
    <p>Fault Model: ext4 and btrfs</p>
    <p>Server 1 Server 2 Server 3Client</p>
    <p>C o</p>
    <p>rr u</p>
    <p>p t</p>
    <p>d a</p>
    <p>ta C</p>
    <p>o rr</p>
    <p>u p</p>
    <p>t d</p>
    <p>a ta</p>
    <p>Ext4: disk corruption  corrupted data to applications</p>
    <p>File System File System File Systemext4 ext4ext4</p>
  </div>
  <div class="page">
    <p>Request</p>
    <p>Fault Model: ext4 and btrfs</p>
    <p>Server 1 Server 2 Server 3Client</p>
    <p>Ext4: disk corruption  corrupted data to applications</p>
    <p>File System File System File Systemext4 ext4ext4 btrfsbtrfs btrfs</p>
  </div>
  <div class="page">
    <p>Request</p>
    <p>Fault Model: ext4 and btrfs</p>
    <p>Server 1 Server 2 Server 3Client</p>
    <p>C o</p>
    <p>rr u</p>
    <p>p t</p>
    <p>d a</p>
    <p>ta</p>
    <p>Ext4: disk corruption  corrupted data to applications</p>
    <p>File System File System File Systemext4 ext4ext4 btrfsbtrfs btrfs</p>
  </div>
  <div class="page">
    <p>Request</p>
    <p>Fault Model: ext4 and btrfs</p>
    <p>Server 1 Server 2 Server 3Client</p>
    <p>C o</p>
    <p>rr u</p>
    <p>p t</p>
    <p>d a</p>
    <p>ta</p>
    <p>Ext4: disk corruption  corrupted data to applications</p>
    <p>File System File System File Systemext4 ext4ext4 btrfsbtrfs btrfs</p>
    <p>I/ O</p>
    <p>E</p>
    <p>rr o</p>
    <p>r</p>
  </div>
  <div class="page">
    <p>Request</p>
    <p>Fault Model: ext4 and btrfs</p>
    <p>Server 1 Server 2 Server 3Client</p>
    <p>C o</p>
    <p>rr u</p>
    <p>p t</p>
    <p>d a</p>
    <p>ta</p>
    <p>Ext4: disk corruption  corrupted data to applications</p>
    <p>Btrfs: disk corruption  I/O error to applications</p>
    <p>File System File System File Systemext4 ext4ext4 btrfsbtrfs btrfs</p>
    <p>I/ O</p>
    <p>E</p>
    <p>rr o</p>
    <p>r</p>
  </div>
  <div class="page">
    <p>Fault Injection Methodology</p>
    <p>Server 1 Server 2 Server 3</p>
    <p>File System File SystemFile System</p>
  </div>
  <div class="page">
    <p>Fault Injection Methodology</p>
    <p>Server 1 Server 2 Server 3</p>
    <p>File System File SystemFile Systemerrfs (FUSE FS)errfs (FUSE FS) errfs (FUSE FS)</p>
    <p>errfs - a FUSE file system to inject file-system faults</p>
  </div>
  <div class="page">
    <p>Fault Injection Methodology</p>
    <p>Server 1 Server 2 Server 3</p>
    <p>File System</p>
    <p>Fault for current run: server 1, block B1 read corruption File SystemFile Systemerrfs (FUSE FS)errfs (FUSE FS) errfs (FUSE FS)</p>
    <p>errfs - a FUSE file system to inject file-system faults</p>
  </div>
  <div class="page">
    <p>Read</p>
    <p>Fault Injection Methodology</p>
    <p>Server 1 Server 2 Server 3Client</p>
    <p>File System</p>
    <p>Fault for current run: server 1, block B1 read corruption File SystemFile Systemerrfs (FUSE FS)errfs (FUSE FS) errfs (FUSE FS)</p>
    <p>errfs - a FUSE file system to inject file-system faults</p>
  </div>
  <div class="page">
    <p>Read</p>
    <p>Fault Injection Methodology</p>
    <p>Server 1 Server 2 Server 3Client</p>
    <p>File System</p>
    <p>Fault for current run: server 1, block B1 read corruption File SystemFile Systemerrfs (FUSE FS)errfs (FUSE FS) errfs (FUSE FS)</p>
    <p>read B1-B4</p>
    <p>errfs - a FUSE file system to inject file-system faults</p>
  </div>
  <div class="page">
    <p>Read</p>
    <p>Fault Injection Methodology</p>
    <p>Server 1 Server 2 Server 3Client</p>
    <p>File System</p>
    <p>Fault for current run: server 1, block B1 read corruption File SystemFile Systemerrfs (FUSE FS)errfs (FUSE FS) errfs (FUSE FS)</p>
    <p>read B1-B4</p>
    <p>read B1-B4</p>
    <p>return B1-B4</p>
    <p>errfs - a FUSE file system to inject file-system faults</p>
  </div>
  <div class="page">
    <p>Read</p>
    <p>Fault Injection Methodology</p>
    <p>Server 1 Server 2 Server 3Client</p>
    <p>File System</p>
    <p>Fault for current run: server 1, block B1 read corruption File SystemFile Systemerrfs (FUSE FS)errfs (FUSE FS) errfs (FUSE FS)</p>
    <p>read B1-B4</p>
    <p>read B1-B4</p>
    <p>return B1-B4</p>
    <p>return B1-B4</p>
    <p>errfs - a FUSE file system to inject file-system faults</p>
  </div>
  <div class="page">
    <p>Read</p>
    <p>Fault Injection Methodology</p>
    <p>Server 1 Server 2 Server 3Client</p>
    <p>File System</p>
    <p>Fault for current run: server 1, block B1 read corruption File SystemFile Systemerrfs (FUSE FS)errfs (FUSE FS) errfs (FUSE FS)</p>
    <p>read B1-B4</p>
    <p>read B1-B4</p>
    <p>return B1-B4</p>
    <p>return B1-B4</p>
    <p>errfs - a FUSE file system to inject file-system faults</p>
    <p>Local Behavior</p>
  </div>
  <div class="page">
    <p>Read</p>
    <p>Fault Injection Methodology</p>
    <p>Server 1 Server 2 Server 3Client</p>
    <p>File System</p>
    <p>Fault for current run: server 1, block B1 read corruption File SystemFile Systemerrfs (FUSE FS)errfs (FUSE FS) errfs (FUSE FS)</p>
    <p>read B1-B4</p>
    <p>read B1-B4</p>
    <p>return B1-B4</p>
    <p>return B1-B4</p>
    <p>errfs - a FUSE file system to inject file-system faults</p>
    <p>Local Behavior Crash Retry Ignore faulty data No detection/recovery</p>
  </div>
  <div class="page">
    <p>Read</p>
    <p>Fault Injection Methodology</p>
    <p>Server 1 Server 2 Server 3Client</p>
    <p>File System</p>
    <p>Fault for current run: server 1, block B1 read corruption File SystemFile Systemerrfs (FUSE FS)errfs (FUSE FS) errfs (FUSE FS)</p>
    <p>read B1-B4</p>
    <p>read B1-B4</p>
    <p>return B1-B4</p>
    <p>return B1-B4</p>
    <p>errfs - a FUSE file system to inject file-system faults</p>
    <p>Local Behavior Crash Retry Ignore faulty data No detection/recovery Global Effect</p>
  </div>
  <div class="page">
    <p>Read</p>
    <p>Fault Injection Methodology</p>
    <p>Server 1 Server 2 Server 3Client</p>
    <p>File System</p>
    <p>Fault for current run: server 1, block B1 read corruption File SystemFile Systemerrfs (FUSE FS)errfs (FUSE FS) errfs (FUSE FS)</p>
    <p>read B1-B4</p>
    <p>read B1-B4</p>
    <p>return B1-B4</p>
    <p>return B1-B4</p>
    <p>errfs - a FUSE file system to inject file-system faults</p>
    <p>Local Behavior Crash Retry Ignore faulty data No detection/recovery Global Effect</p>
    <p>Corruption Data loss Unavailability</p>
  </div>
  <div class="page">
    <p>Outline</p>
    <p>Introduction</p>
    <p>Fault Injection</p>
    <p>System Behavior Analysis</p>
    <p>Major Results</p>
    <p>Observations Across Systems</p>
    <p>Conclusion</p>
  </div>
  <div class="page">
    <p>System Behavior Analysis Behavior of eight distributed systems in response to file-system faults</p>
    <p>Broad spectrum of replication and consensus protocols</p>
    <p>Replicated state machines - ZooKeeper (uses ZAB for consensus)</p>
    <p>- LogCabin, CockroachDB, and RethinkDB (uses RAFT for consensus)</p>
    <p>Primary backup replication - MongoDB</p>
    <p>- Redis</p>
    <p>- Kafka (in-sync replicas for leader election)</p>
    <p>Dynamo-style quorum - Cassandra (decentralized, no leader/follower)</p>
  </div>
  <div class="page">
    <p>An Example: Redis</p>
  </div>
  <div class="page">
    <p>An Example: Redis</p>
    <p>Redis is a popular data structure store</p>
  </div>
  <div class="page">
    <p>Leader</p>
    <p>An Example: Redis</p>
    <p>Redis is a popular data structure store</p>
  </div>
  <div class="page">
    <p>Follower</p>
    <p>Follower</p>
    <p>Leader</p>
    <p>An Example: Redis</p>
    <p>Redis is a popular data structure store</p>
  </div>
  <div class="page">
    <p>Follower</p>
    <p>Follower</p>
    <p>Leader</p>
    <p>An Example: Redis</p>
    <p>appendonlyfile</p>
    <p>appendonlyfile</p>
    <p>appendonlyfile</p>
    <p>Redis is a popular data structure store</p>
  </div>
  <div class="page">
    <p>Follower</p>
    <p>Follower</p>
    <p>Leader</p>
    <p>An Example: Redis</p>
    <p>appendonlyfile</p>
    <p>appendonlyfile</p>
    <p>appendonlyfile</p>
    <p>Client Write</p>
    <p>Redis is a popular data structure store</p>
  </div>
  <div class="page">
    <p>Follower</p>
    <p>Follower</p>
    <p>Leader</p>
    <p>An Example: Redis</p>
    <p>appendonlyfile</p>
    <p>appendonlyfile</p>
    <p>appendonlyfile</p>
    <p>Client Write</p>
    <p>Redis is a popular data structure store</p>
  </div>
  <div class="page">
    <p>Follower</p>
    <p>Follower</p>
    <p>Leader</p>
    <p>An Example: Redis</p>
    <p>appendonlyfile</p>
    <p>appendonlyfile</p>
    <p>appendonlyfile</p>
    <p>Client Write</p>
    <p>Redis is a popular data structure store</p>
  </div>
  <div class="page">
    <p>Follower</p>
    <p>Follower</p>
    <p>Leader</p>
    <p>An Example: Redis</p>
    <p>appendonlyfile</p>
    <p>appendonlyfile</p>
    <p>appendonlyfile</p>
    <p>Client Write</p>
    <p>Redis is a popular data structure store</p>
  </div>
  <div class="page">
    <p>Follower</p>
    <p>Follower</p>
    <p>Leader</p>
    <p>An Example: Redis</p>
    <p>appendonlyfile</p>
    <p>appendonlyfile</p>
    <p>appendonlyfile</p>
    <p>Redis is a popular data structure store</p>
  </div>
  <div class="page">
    <p>Follower</p>
    <p>Follower</p>
    <p>Leader</p>
    <p>An Example: Redis</p>
    <p>redis_database</p>
    <p>appendonlyfile</p>
    <p>appendonlyfile</p>
    <p>appendonlyfile</p>
    <p>Redis is a popular data structure store</p>
  </div>
  <div class="page">
    <p>Follower</p>
    <p>Follower</p>
    <p>Leader</p>
    <p>An Example: Redis</p>
    <p>redis_database</p>
    <p>appendonlyfile</p>
    <p>appendonlyfile</p>
    <p>appendonlyfile</p>
    <p>Redis is a popular data structure store</p>
  </div>
  <div class="page">
    <p>Follower</p>
    <p>Follower</p>
    <p>Leader</p>
    <p>An Example: Redis</p>
    <p>redis_database</p>
    <p>appendonlyfile</p>
    <p>appendonlyfile</p>
    <p>appendonlyfile</p>
    <p>Redis is a popular data structure store</p>
  </div>
  <div class="page">
    <p>Follower</p>
    <p>Follower</p>
    <p>Leader</p>
    <p>An Example: Redis</p>
    <p>redis_database</p>
    <p>redis_database</p>
    <p>redis_database</p>
    <p>appendonlyfile</p>
    <p>appendonlyfile</p>
    <p>appendonlyfile</p>
    <p>Redis is a popular data structure store</p>
  </div>
  <div class="page">
    <p>Follower</p>
    <p>Follower</p>
    <p>Leader</p>
    <p>An Example: Redis</p>
    <p>redis_database</p>
    <p>redis_database</p>
    <p>redis_database</p>
    <p>appendonlyfile</p>
    <p>appendonlyfile</p>
    <p>appendonlyfile</p>
    <p>Redis is a popular data structure store</p>
  </div>
  <div class="page">
    <p>Redis: Behavior Analysis</p>
  </div>
  <div class="page">
    <p>Redis: Behavior Analysis</p>
    <p>Read Workload</p>
  </div>
  <div class="page">
    <p>Redis: Behavior Analysis</p>
    <p>Local Behavior</p>
    <p>Read Workload</p>
  </div>
  <div class="page">
    <p>Redis: Behavior Analysis</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>Local Behavior</p>
    <p>Read Workload</p>
  </div>
  <div class="page">
    <p>Redis: Behavior Analysis</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Read Workload</p>
  </div>
  <div class="page">
    <p>Redis: Behavior Analysis</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Read Workload</p>
    <p>LeaderL</p>
  </div>
  <div class="page">
    <p>Redis: Behavior Analysis</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Read Workload</p>
    <p>LeaderL FollowerF</p>
  </div>
  <div class="page">
    <p>Redis: Behavior Analysis</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Read Workload</p>
    <p>LeaderL FollowerF</p>
    <p>On-disk Structures</p>
    <p>appendonlyfile.metadata</p>
    <p>appendonlyfile.data</p>
    <p>redis_database.block_0</p>
    <p>redis_database.metadata</p>
    <p>redis_database.userdata</p>
  </div>
  <div class="page">
    <p>Redis: Behavior Analysis</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Read Workload</p>
    <p>LeaderL FollowerF</p>
    <p>On-disk Structures</p>
    <p>appendonlyfile.metadata</p>
    <p>appendonlyfile.data</p>
    <p>redis_database.block_0</p>
    <p>redis_database.metadata</p>
    <p>redis_database.userdata</p>
  </div>
  <div class="page">
    <p>Redis: Behavior Analysis</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Read Workload</p>
    <p>LeaderL FollowerF</p>
    <p>On-disk Structures</p>
    <p>appendonlyfile.metadata</p>
    <p>appendonlyfile.data</p>
    <p>redis_database.block_0</p>
    <p>redis_database.metadata</p>
    <p>redis_database.userdata</p>
  </div>
  <div class="page">
    <p>Redis: Behavior Analysis</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Read Workload</p>
    <p>LeaderL FollowerF Crash</p>
    <p>On-disk Structures</p>
    <p>appendonlyfile.metadata</p>
    <p>appendonlyfile.data</p>
    <p>redis_database.block_0</p>
    <p>redis_database.metadata</p>
    <p>redis_database.userdata</p>
    <p>Local Behavior</p>
  </div>
  <div class="page">
    <p>Redis: Behavior Analysis</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Read Workload</p>
    <p>LeaderL FollowerF Crash</p>
    <p>On-disk Structures</p>
    <p>appendonlyfile.metadata</p>
    <p>appendonlyfile.data</p>
    <p>redis_database.block_0</p>
    <p>redis_database.metadata</p>
    <p>redis_database.userdata</p>
    <p>Global Effect</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
  </div>
  <div class="page">
    <p>Redis: Behavior Analysis</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Read Workload</p>
    <p>LeaderL FollowerF Crash</p>
    <p>On-disk Structures</p>
    <p>appendonlyfile.metadata</p>
    <p>appendonlyfile.data</p>
    <p>redis_database.block_0</p>
    <p>redis_database.metadata</p>
    <p>redis_database.userdata</p>
    <p>Global Effect</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
  </div>
  <div class="page">
    <p>Redis: Behavior Analysis</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Read Workload</p>
    <p>LeaderL FollowerF Crash</p>
    <p>On-disk Structures</p>
    <p>appendonlyfile.metadata</p>
    <p>appendonlyfile.data</p>
    <p>redis_database.block_0</p>
    <p>redis_database.metadata</p>
    <p>redis_database.userdata</p>
    <p>Global Effect</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
  </div>
  <div class="page">
    <p>Redis: Behavior Analysis</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Read Workload</p>
    <p>LeaderL FollowerF Crash</p>
    <p>On-disk Structures</p>
    <p>appendonlyfile.metadata</p>
    <p>appendonlyfile.data</p>
    <p>redis_database.block_0</p>
    <p>redis_database.metadata</p>
    <p>redis_database.userdata</p>
    <p>Global Effect</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Global Effect</p>
    <p>Unavailability</p>
  </div>
  <div class="page">
    <p>Redis: Behavior Analysis</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Read Workload</p>
    <p>LeaderL FollowerF Crash</p>
    <p>On-disk Structures</p>
    <p>appendonlyfile.metadata</p>
    <p>appendonlyfile.data</p>
    <p>redis_database.block_0</p>
    <p>redis_database.metadata</p>
    <p>redis_database.userdata</p>
    <p>Global Effect</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Global Effect</p>
    <p>Unavailability No checksums to detect corruption Leader crashes due to failed deserialization No automatic failover - cluster unavailable</p>
  </div>
  <div class="page">
    <p>Redis: Behavior Analysis</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Read Workload</p>
    <p>LeaderL FollowerF Crash</p>
    <p>On-disk Structures</p>
    <p>appendonlyfile.metadata</p>
    <p>appendonlyfile.data</p>
    <p>redis_database.block_0</p>
    <p>redis_database.metadata</p>
    <p>redis_database.userdata</p>
    <p>Global Effect</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Global Effect</p>
    <p>Unavailability</p>
  </div>
  <div class="page">
    <p>Redis: Behavior Analysis</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Read Workload</p>
    <p>LeaderL FollowerF Crash</p>
    <p>On-disk Structures</p>
    <p>appendonlyfile.metadata</p>
    <p>appendonlyfile.data</p>
    <p>redis_database.block_0</p>
    <p>redis_database.metadata</p>
    <p>redis_database.userdata</p>
    <p>Global Effect</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Global Effect</p>
    <p>Unavailability</p>
  </div>
  <div class="page">
    <p>Redis: Behavior Analysis</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Read Workload</p>
    <p>LeaderL FollowerF Crash</p>
    <p>On-disk Structures</p>
    <p>appendonlyfile.metadata</p>
    <p>appendonlyfile.data</p>
    <p>redis_database.block_0</p>
    <p>redis_database.metadata</p>
    <p>redis_database.userdata</p>
    <p>Global Effect</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Global Effect</p>
    <p>Unavailability</p>
  </div>
  <div class="page">
    <p>Redis: Behavior Analysis</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Read Workload</p>
    <p>LeaderL FollowerF Crash</p>
    <p>On-disk Structures</p>
    <p>appendonlyfile.metadata</p>
    <p>appendonlyfile.data</p>
    <p>redis_database.block_0</p>
    <p>redis_database.metadata</p>
    <p>redis_database.userdata</p>
    <p>Global Effect</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Global Effect</p>
    <p>Unavailability</p>
  </div>
  <div class="page">
    <p>Redis: Behavior Analysis</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Read Workload</p>
    <p>LeaderL FollowerF Crash</p>
    <p>On-disk Structures</p>
    <p>appendonlyfile.metadata</p>
    <p>appendonlyfile.data</p>
    <p>redis_database.block_0</p>
    <p>redis_database.metadata</p>
    <p>redis_database.userdata</p>
    <p>Global Effect</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Global Effect</p>
    <p>Unavailability</p>
    <p>Reduced Redundancy</p>
  </div>
  <div class="page">
    <p>Redis: Behavior Analysis</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Read Workload</p>
    <p>LeaderL FollowerF Crash</p>
    <p>On-disk Structures</p>
    <p>appendonlyfile.metadata</p>
    <p>appendonlyfile.data</p>
    <p>redis_database.block_0</p>
    <p>redis_database.metadata</p>
    <p>redis_database.userdata</p>
    <p>Global Effect</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Global Effect</p>
    <p>Unavailability</p>
    <p>Reduced Redundancy</p>
  </div>
  <div class="page">
    <p>Redis: Behavior Analysis</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Read Workload</p>
    <p>LeaderL FollowerF Crash</p>
    <p>On-disk Structures</p>
    <p>appendonlyfile.metadata</p>
    <p>appendonlyfile.data</p>
    <p>redis_database.block_0</p>
    <p>redis_database.metadata</p>
    <p>redis_database.userdata</p>
    <p>Global Effect</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Global Effect</p>
    <p>Unavailability</p>
    <p>Reduced Redundancy</p>
  </div>
  <div class="page">
    <p>Redis: Behavior Analysis</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Read Workload</p>
    <p>LeaderL FollowerF Crash</p>
    <p>On-disk Structures</p>
    <p>appendonlyfile.metadata</p>
    <p>appendonlyfile.data</p>
    <p>redis_database.block_0</p>
    <p>redis_database.metadata</p>
    <p>redis_database.userdata</p>
    <p>Global Effect</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Global Effect</p>
    <p>Unavailability</p>
    <p>Reduced Redundancy</p>
  </div>
  <div class="page">
    <p>Redis: Behavior Analysis</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Read Workload</p>
    <p>LeaderL FollowerF Crash</p>
    <p>On-disk Structures</p>
    <p>appendonlyfile.metadata</p>
    <p>appendonlyfile.data</p>
    <p>redis_database.block_0</p>
    <p>redis_database.metadata</p>
    <p>redis_database.userdata</p>
    <p>Global Effect</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Global Effect</p>
    <p>Unavailability</p>
    <p>Reduced Redundancy</p>
    <p>No Detection/ No Recovery</p>
  </div>
  <div class="page">
    <p>Redis: Behavior Analysis</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Read Workload</p>
    <p>LeaderL FollowerF Crash</p>
    <p>On-disk Structures</p>
    <p>appendonlyfile.metadata</p>
    <p>appendonlyfile.data</p>
    <p>redis_database.block_0</p>
    <p>redis_database.metadata</p>
    <p>redis_database.userdata</p>
    <p>Global Effect</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Global Effect</p>
    <p>Unavailability</p>
    <p>Reduced Redundancy</p>
    <p>No Detection/ No Recovery</p>
  </div>
  <div class="page">
    <p>Redis: Behavior Analysis</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Read Workload</p>
    <p>LeaderL FollowerF Crash</p>
    <p>On-disk Structures</p>
    <p>appendonlyfile.metadata</p>
    <p>appendonlyfile.data</p>
    <p>redis_database.block_0</p>
    <p>redis_database.metadata</p>
    <p>redis_database.userdata</p>
    <p>Global Effect</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Global Effect</p>
    <p>Unavailability</p>
    <p>Reduced Redundancy</p>
    <p>No Detection/ No Recovery</p>
    <p>Corruption</p>
  </div>
  <div class="page">
    <p>Redis: Behavior Analysis</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Read Workload</p>
    <p>LeaderL FollowerF Crash</p>
    <p>On-disk Structures</p>
    <p>appendonlyfile.metadata</p>
    <p>appendonlyfile.data</p>
    <p>redis_database.block_0</p>
    <p>redis_database.metadata</p>
    <p>redis_database.userdata</p>
    <p>Global Effect</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Global Effect</p>
    <p>Unavailability</p>
    <p>Reduced Redundancy</p>
    <p>No Detection/ No Recovery</p>
    <p>Corruption No checksums to detect corruption Leader returns corrupted data on queries Corruption propagation to followers</p>
  </div>
  <div class="page">
    <p>Redis: Behavior Analysis</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Read Workload</p>
    <p>LeaderL FollowerF Crash</p>
    <p>On-disk Structures</p>
    <p>appendonlyfile.metadata</p>
    <p>appendonlyfile.data</p>
    <p>redis_database.block_0</p>
    <p>redis_database.metadata</p>
    <p>redis_database.userdata</p>
    <p>Global Effect</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Global Effect</p>
    <p>Unavailability</p>
    <p>Reduced Redundancy</p>
    <p>No Detection/ No Recovery</p>
    <p>Corruption</p>
  </div>
  <div class="page">
    <p>Redis: Behavior Analysis</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Read Workload</p>
    <p>LeaderL FollowerF Crash</p>
    <p>On-disk Structures</p>
    <p>appendonlyfile.metadata</p>
    <p>appendonlyfile.data</p>
    <p>redis_database.block_0</p>
    <p>redis_database.metadata</p>
    <p>redis_database.userdata</p>
    <p>Global Effect</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Global Effect</p>
    <p>Unavailability</p>
    <p>Reduced Redundancy</p>
    <p>No Detection/ No Recovery</p>
    <p>Corruption</p>
  </div>
  <div class="page">
    <p>Redis: Behavior Analysis</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Read Workload</p>
    <p>LeaderL FollowerF Crash</p>
    <p>On-disk Structures</p>
    <p>appendonlyfile.metadata</p>
    <p>appendonlyfile.data</p>
    <p>redis_database.block_0</p>
    <p>redis_database.metadata</p>
    <p>redis_database.userdata</p>
    <p>Global Effect</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Global Effect</p>
    <p>Unavailability</p>
    <p>Reduced Redundancy</p>
    <p>No Detection/ No Recovery</p>
    <p>Corruption</p>
  </div>
  <div class="page">
    <p>Redis: Behavior Analysis</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Read Workload</p>
    <p>LeaderL FollowerF Crash</p>
    <p>On-disk Structures</p>
    <p>appendonlyfile.metadata</p>
    <p>appendonlyfile.data</p>
    <p>redis_database.block_0</p>
    <p>redis_database.metadata</p>
    <p>redis_database.userdata</p>
    <p>Global Effect</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Global Effect</p>
    <p>Unavailability</p>
    <p>Reduced Redundancy</p>
    <p>No Detection/ No Recovery</p>
    <p>Corruption</p>
    <p>Correct</p>
  </div>
  <div class="page">
    <p>Redis: Behavior Analysis</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Read Workload</p>
    <p>LeaderL FollowerF Crash</p>
    <p>On-disk Structures</p>
    <p>appendonlyfile.metadata</p>
    <p>appendonlyfile.data</p>
    <p>redis_database.block_0</p>
    <p>redis_database.metadata</p>
    <p>redis_database.userdata</p>
    <p>Global Effect</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Global Effect</p>
    <p>Unavailability</p>
    <p>Reduced Redundancy</p>
    <p>No Detection/ No Recovery</p>
    <p>Corruption</p>
    <p>Correct</p>
  </div>
  <div class="page">
    <p>Redis: Behavior Analysis</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Read Workload</p>
    <p>LeaderL FollowerF Crash</p>
    <p>On-disk Structures</p>
    <p>appendonlyfile.metadata</p>
    <p>appendonlyfile.data</p>
    <p>redis_database.block_0</p>
    <p>redis_database.metadata</p>
    <p>redis_database.userdata</p>
    <p>Global Effect</p>
    <p>Corrupt Read</p>
    <p>I/O Error</p>
    <p>L LF F</p>
    <p>Local Behavior</p>
    <p>Global Effect</p>
    <p>Unavailability</p>
    <p>Reduced Redundancy</p>
    <p>No Detection/ No Recovery</p>
    <p>Corruption</p>
    <p>Retry</p>
    <p>Write Unavailability</p>
    <p>Correct</p>
  </div>
  <div class="page">
    <p>Other Systems</p>
  </div>
  <div class="page">
    <p>Other Systems</p>
    <p>Metadata stores: ZooKeeper, LogCabin</p>
    <p>Wide column store: Cassandra</p>
    <p>Document stores: MongoDB</p>
    <p>Distributed databases: RethinkDB, CockroachDB</p>
    <p>Message Queues: Kafka</p>
  </div>
  <div class="page">
    <p>Outline</p>
    <p>Introduction</p>
    <p>Fault Injection</p>
    <p>System Behavior Analysis</p>
    <p>Major Results</p>
    <p>Redundancy Does not Provide Fault Tolerance</p>
    <p>Observations Across Systems</p>
    <p>Conclusion</p>
  </div>
  <div class="page">
    <p>Redundancy Does not Provide Fault Tolerance</p>
  </div>
  <div class="page">
    <p>Redundancy Does not Provide Fault Tolerance</p>
    <p>Redis Read</p>
    <p>ZooKeeper Write</p>
    <p>Kafka Read</p>
    <p>RethinkDB Read</p>
    <p>Cassandra Read Kafka Write</p>
  </div>
  <div class="page">
    <p>Redundancy Does not Provide Fault Tolerance</p>
    <p>Redis Read</p>
    <p>Corrupt Read Error</p>
    <p>ZooKeeper Write Write Error</p>
    <p>Kafka Read</p>
    <p>RethinkDB Read Corrupt</p>
    <p>Cassandra Read Kafka Write</p>
    <p>Corrupt Read Error Corrupt</p>
    <p>Read Error</p>
    <p>Corrupt Read Error</p>
  </div>
  <div class="page">
    <p>Redundancy Does not Provide Fault Tolerance</p>
    <p>Redis Read</p>
    <p>Corrupt Read Error</p>
    <p>txn_head log.tail</p>
    <p>ZooKeeper Write Write Error</p>
    <p>log.header log.other replication</p>
    <p>Kafka Read</p>
    <p>aof.metadata aof.data rdb.metadata rdb.userdata</p>
    <p>RethinkDB Read</p>
    <p>db.txn_head db.txn_body db.txn_tail db.metablock</p>
    <p>Corrupt</p>
    <p>Cassandra Read Kafka Write</p>
    <p>checkpoint</p>
    <p>Corrupt Read Error Corrupt</p>
    <p>Read Error</p>
    <p>Corrupt Read Error</p>
    <p>sstable.block0 sstable.metadata sstable.userdata sstable.index</p>
  </div>
  <div class="page">
    <p>Redundancy Does not Provide Fault Tolerance</p>
    <p>Redis Read</p>
    <p>Corrupt Read Error</p>
    <p>txn_head log.tail</p>
    <p>ZooKeeper Write Write Error</p>
    <p>log.header log.other replication</p>
    <p>L F L F</p>
    <p>L F</p>
    <p>L F L F</p>
    <p>Kafka Read</p>
    <p>aof.metadata aof.data rdb.metadata rdb.userdata</p>
    <p>RethinkDB Read</p>
    <p>db.txn_head db.txn_body db.txn_tail db.metablock</p>
    <p>L F</p>
    <p>Corrupt</p>
    <p>Cassandra Read Kafka Write</p>
    <p>checkpoint L F L F</p>
    <p>Corrupt Read Error Corrupt</p>
    <p>Read Error</p>
    <p>Corrupt Read Error</p>
    <p>sstable.block0 sstable.metadata sstable.userdata sstable.index</p>
  </div>
  <div class="page">
    <p>Redundancy Does not Provide Fault Tolerance</p>
    <p>Redis Read</p>
    <p>Corrupt Read Error</p>
    <p>txn_head log.tail</p>
    <p>ZooKeeper Write Write Error</p>
    <p>log.header log.other replication</p>
    <p>L F L F</p>
    <p>L F</p>
    <p>L F L F</p>
    <p>Kafka Read</p>
    <p>aof.metadata aof.data rdb.metadata rdb.userdata</p>
    <p>RethinkDB Read</p>
    <p>db.txn_head db.txn_body db.txn_tail db.metablock</p>
    <p>L F</p>
    <p>CorruptionCorrupt</p>
    <p>Cassandra Read Kafka Write</p>
    <p>checkpoint L F L F</p>
    <p>Corrupt Read Error Corrupt</p>
    <p>Read Error</p>
    <p>Corrupt Read Error</p>
    <p>sstable.block0 sstable.metadata sstable.userdata sstable.index</p>
  </div>
  <div class="page">
    <p>Redundancy Does not Provide Fault Tolerance</p>
    <p>Redis Read</p>
    <p>Corrupt Read Error</p>
    <p>txn_head log.tail</p>
    <p>ZooKeeper Write Write Error</p>
    <p>log.header log.other replication</p>
    <p>L F L F</p>
    <p>L F</p>
    <p>L F L F</p>
    <p>Kafka Read</p>
    <p>aof.metadata aof.data rdb.metadata rdb.userdata</p>
    <p>RethinkDB Read</p>
    <p>db.txn_head db.txn_body db.txn_tail db.metablock</p>
    <p>L F</p>
    <p>Corruption</p>
    <p>Data Loss</p>
    <p>Corrupt</p>
    <p>Cassandra Read Kafka Write</p>
    <p>checkpoint L F L F</p>
    <p>Corrupt Read Error Corrupt</p>
    <p>Read Error</p>
    <p>Corrupt Read Error</p>
    <p>sstable.block0 sstable.metadata sstable.userdata sstable.index</p>
  </div>
  <div class="page">
    <p>Redundancy Does not Provide Fault Tolerance</p>
    <p>Redis Read</p>
    <p>Corrupt Read Error</p>
    <p>txn_head log.tail</p>
    <p>ZooKeeper Write Write Error</p>
    <p>log.header log.other replication</p>
    <p>L F L F</p>
    <p>L F</p>
    <p>L F L F</p>
    <p>Kafka Read</p>
    <p>aof.metadata aof.data rdb.metadata rdb.userdata</p>
    <p>RethinkDB Read</p>
    <p>db.txn_head db.txn_body db.txn_tail db.metablock</p>
    <p>L F</p>
    <p>Corruption</p>
    <p>Write Unavailability</p>
    <p>Data Loss</p>
    <p>Corrupt</p>
    <p>Cassandra Read Kafka Write</p>
    <p>checkpoint L F L F</p>
    <p>Corrupt Read Error Corrupt</p>
    <p>Read Error</p>
    <p>Corrupt Read Error</p>
    <p>sstable.block0 sstable.metadata sstable.userdata sstable.index</p>
  </div>
  <div class="page">
    <p>Redundancy Does not Provide Fault Tolerance</p>
    <p>Redis Read</p>
    <p>Corrupt Read Error</p>
    <p>txn_head log.tail</p>
    <p>ZooKeeper Write Write Error</p>
    <p>log.header log.other replication</p>
    <p>L F L F</p>
    <p>L F</p>
    <p>L F L F</p>
    <p>Kafka Read</p>
    <p>aof.metadata aof.data rdb.metadata rdb.userdata</p>
    <p>RethinkDB Read</p>
    <p>db.txn_head db.txn_body db.txn_tail db.metablock</p>
    <p>L F</p>
    <p>Corruption</p>
    <p>Write Unavailability</p>
    <p>Data Loss</p>
    <p>UnavailabilityCorrupt</p>
    <p>Cassandra Read Kafka Write</p>
    <p>checkpoint L F L F</p>
    <p>Corrupt Read Error Corrupt</p>
    <p>Read Error</p>
    <p>Corrupt Read Error</p>
    <p>sstable.block0 sstable.metadata sstable.userdata sstable.index</p>
  </div>
  <div class="page">
    <p>Redundancy Does not Provide Fault Tolerance</p>
    <p>Redis Read</p>
    <p>Corrupt Read Error</p>
    <p>txn_head log.tail</p>
    <p>ZooKeeper Write Write Error</p>
    <p>log.header log.other replication</p>
    <p>L F L F</p>
    <p>L F</p>
    <p>L F L F</p>
    <p>Kafka Read</p>
    <p>aof.metadata aof.data rdb.metadata rdb.userdata</p>
    <p>RethinkDB Read</p>
    <p>db.txn_head db.txn_body db.txn_tail db.metablock</p>
    <p>L F</p>
    <p>Corruption</p>
    <p>Write Unavailability</p>
    <p>Data Loss</p>
    <p>UnavailabilityCorrupt</p>
    <p>Query Failure</p>
    <p>Cassandra Read Kafka Write</p>
    <p>checkpoint L F L F</p>
    <p>Corrupt Read Error Corrupt</p>
    <p>Read Error</p>
    <p>Corrupt Read Error</p>
    <p>sstable.block0 sstable.metadata sstable.userdata sstable.index</p>
  </div>
  <div class="page">
    <p>Redundancy Does not Provide Fault Tolerance</p>
    <p>Redis Read</p>
    <p>Corrupt Read Error</p>
    <p>txn_head log.tail</p>
    <p>ZooKeeper Write Write Error</p>
    <p>log.header log.other replication</p>
    <p>L F L F</p>
    <p>L F</p>
    <p>L F L F</p>
    <p>Kafka Read</p>
    <p>aof.metadata aof.data rdb.metadata rdb.userdata</p>
    <p>RethinkDB Read</p>
    <p>db.txn_head db.txn_body db.txn_tail db.metablock</p>
    <p>L F</p>
    <p>Corruption</p>
    <p>Write Unavailability</p>
    <p>Data Loss</p>
    <p>UnavailabilityCorrupt</p>
    <p>Query Failure</p>
    <p>Cassandra Read Kafka Write</p>
    <p>checkpoint L F L F</p>
    <p>Corrupt Read Error Corrupt</p>
    <p>Read Error</p>
    <p>Corrupt Read Error</p>
    <p>sstable.block0 sstable.metadata sstable.userdata sstable.index</p>
    <p>Reduced Redundancy</p>
  </div>
  <div class="page">
    <p>Redundancy Does not Provide Fault Tolerance</p>
    <p>Redis Read</p>
    <p>Corrupt Read Error</p>
    <p>txn_head log.tail</p>
    <p>ZooKeeper Write Write Error</p>
    <p>log.header log.other replication</p>
    <p>L F L F</p>
    <p>L F</p>
    <p>L F L F</p>
    <p>Kafka Read</p>
    <p>aof.metadata aof.data rdb.metadata rdb.userdata</p>
    <p>RethinkDB Read</p>
    <p>db.txn_head db.txn_body db.txn_tail db.metablock</p>
    <p>L F</p>
    <p>Corruption</p>
    <p>Write Unavailability</p>
    <p>Data Loss</p>
    <p>UnavailabilityCorrupt</p>
    <p>Query Failure</p>
    <p>Cassandra Read Kafka Write</p>
    <p>checkpoint L F L F</p>
    <p>Corrupt Read Error Corrupt</p>
    <p>Read Error</p>
    <p>Corrupt Read Error</p>
    <p>sstable.block0 sstable.metadata sstable.userdata sstable.index</p>
    <p>Reduced Redundancy</p>
    <p>Harmful global effects despite redundancy</p>
  </div>
  <div class="page">
    <p>Redundancy Does not Provide Fault Tolerance</p>
    <p>Redis Read</p>
    <p>Corrupt Read Error</p>
    <p>txn_head log.tail</p>
    <p>ZooKeeper Write Write Error</p>
    <p>log.header log.other replication</p>
    <p>L F L F</p>
    <p>L F</p>
    <p>L F L F</p>
    <p>Kafka Read</p>
    <p>aof.metadata aof.data rdb.metadata rdb.userdata</p>
    <p>RethinkDB Read</p>
    <p>db.txn_head db.txn_body db.txn_tail db.metablock</p>
    <p>L F</p>
    <p>Corruption</p>
    <p>Write Unavailability</p>
    <p>Data Loss</p>
    <p>UnavailabilityCorrupt</p>
    <p>Query Failure</p>
    <p>Cassandra Read Kafka Write</p>
    <p>checkpoint L F L F</p>
    <p>Corrupt Read Error Corrupt</p>
    <p>Read Error</p>
    <p>Corrupt Read Error</p>
    <p>sstable.block0 sstable.metadata sstable.userdata sstable.index</p>
    <p>Reduced Redundancy</p>
    <p>Harmful global effects despite redundancy Not simple implementation bugs - fundamental problems across multiple systems!</p>
  </div>
  <div class="page">
    <p>Outline Introduction</p>
    <p>Fault Injection</p>
    <p>System Behavior Analysis</p>
    <p>Major Results</p>
    <p>Observations Across Systems</p>
    <p>Faults are Often Undetected Locally</p>
    <p>Crashing: Common Local Reaction</p>
    <p>Crash and Corruption Handling are Entangled</p>
    <p>Unsafe interaction between local and global protocols</p>
    <p>Conclusion</p>
  </div>
  <div class="page">
    <p>Faults are Often Undetected Locally</p>
  </div>
  <div class="page">
    <p>Faults are Often Undetected Locally Undetected faults may lead to harmful global effect</p>
  </div>
  <div class="page">
    <p>Faults are Often Undetected Locally Undetected faults may lead to harmful global effect</p>
    <p>- Locally undetected corruption  global silent corruption</p>
  </div>
  <div class="page">
    <p>Faults are Often Undetected Locally Undetected faults may lead to harmful global effect</p>
    <p>- Locally undetected corruption  global silent corruption</p>
    <p>Cassandra: Locally Undetected Fault</p>
  </div>
  <div class="page">
    <p>Faults are Often Undetected Locally Undetected faults may lead to harmful global effect</p>
    <p>- Locally undetected corruption  global silent corruption</p>
    <p>Client Replica 1 Other Replicas</p>
    <p>Cassandra: Locally Undetected Fault</p>
  </div>
  <div class="page">
    <p>sstable</p>
    <p>Faults are Often Undetected Locally Undetected faults may lead to harmful global effect</p>
    <p>- Locally undetected corruption  global silent corruption</p>
    <p>key | value</p>
    <p>Client Replica 1 Other Replicas</p>
    <p>key | value</p>
    <p>Cassandra: Locally Undetected Fault</p>
    <p>sstable</p>
  </div>
  <div class="page">
    <p>sstable</p>
    <p>Faults are Often Undetected Locally Undetected faults may lead to harmful global effect</p>
    <p>- Locally undetected corruption  global silent corruption</p>
    <p>key | value</p>
    <p>Client Replica 1 Other Replicas</p>
    <p>key | value</p>
    <p>sstable.userdata corrupted</p>
    <p>Cassandra: Locally Undetected Fault</p>
    <p>sstable</p>
  </div>
  <div class="page">
    <p>sstable compression = off No checksums to detect corruption</p>
    <p>sstable</p>
    <p>Faults are Often Undetected Locally Undetected faults may lead to harmful global effect</p>
    <p>- Locally undetected corruption  global silent corruption</p>
    <p>key | value</p>
    <p>Client Replica 1 Other Replicas</p>
    <p>key | value</p>
    <p>sstable.userdata corrupted</p>
    <p>Cassandra: Locally Undetected Fault</p>
    <p>sstable</p>
  </div>
  <div class="page">
    <p>sstable compression = off No checksums to detect corruption</p>
    <p>sstable</p>
    <p>Faults are Often Undetected Locally Undetected faults may lead to harmful global effect</p>
    <p>- Locally undetected corruption  global silent corruption</p>
    <p>key | value</p>
    <p>Client Replica 1 Other Replicas</p>
    <p>key | value</p>
    <p>sstable.userdata corrupted</p>
    <p>Cassandra: Locally Undetected Fault</p>
    <p>sstable</p>
    <p>READ (R=1)</p>
  </div>
  <div class="page">
    <p>sstable compression = off No checksums to detect corruption</p>
    <p>sstable</p>
    <p>Faults are Often Undetected Locally Undetected faults may lead to harmful global effect</p>
    <p>- Locally undetected corruption  global silent corruption</p>
    <p>key | value</p>
    <p>Client Replica 1 Other Replicas</p>
    <p>key | value</p>
    <p>sstable.userdata corrupted</p>
    <p>Cassandra: Locally Undetected Fault</p>
    <p>sstable</p>
    <p>CORRUPT</p>
    <p>READ (R=1)</p>
  </div>
  <div class="page">
    <p>Read Repair</p>
    <p>sstable compression = off No checksums to detect corruption</p>
    <p>sstable</p>
    <p>Faults are Often Undetected Locally Undetected faults may lead to harmful global effect</p>
    <p>- Locally undetected corruption  global silent corruption</p>
    <p>key | value</p>
    <p>Client Replica 1 Other Replicas</p>
    <p>key | value</p>
    <p>sstable.userdata corrupted</p>
    <p>Cassandra: Locally Undetected Fault</p>
    <p>sstable</p>
    <p>CORRUPT</p>
    <p>READ (R=1)</p>
  </div>
  <div class="page">
    <p>Read Repair</p>
    <p>sstable compression = off No checksums to detect corruption</p>
    <p>sstable</p>
    <p>Faults are Often Undetected Locally Undetected faults may lead to harmful global effect</p>
    <p>- Locally undetected corruption  global silent corruption</p>
    <p>key | value</p>
    <p>Client Replica 1 Other Replicas</p>
    <p>key | value</p>
    <p>sstable.userdata corrupted</p>
    <p>key | value</p>
    <p>Cassandra: Locally Undetected Fault</p>
    <p>sstable</p>
    <p>CORRUPT</p>
    <p>READ (R=1)</p>
  </div>
  <div class="page">
    <p>Read Repair</p>
    <p>sstable compression = off No checksums to detect corruption</p>
    <p>sstable</p>
    <p>Faults are Often Undetected Locally Undetected faults may lead to harmful global effect</p>
    <p>- Locally undetected corruption  global silent corruption</p>
    <p>key | value</p>
    <p>Client Replica 1 Other Replicas</p>
    <p>key | value</p>
    <p>sstable.userdata corrupted</p>
    <p>key | value READ</p>
    <p>CORRUPT</p>
    <p>Cassandra: Locally Undetected Fault</p>
    <p>sstable</p>
    <p>CORRUPT</p>
    <p>READ (R=1)</p>
  </div>
  <div class="page">
    <p>Read Repair</p>
    <p>sstable compression = off No checksums to detect corruption</p>
    <p>sstable</p>
    <p>Faults are Often Undetected Locally Undetected faults may lead to harmful global effect</p>
    <p>- Locally undetected corruption  global silent corruption</p>
    <p>key | value</p>
    <p>Client Replica 1 Other Replicas</p>
    <p>key | value</p>
    <p>sstable.userdata corrupted</p>
    <p>key | value READ</p>
    <p>CORRUPT</p>
    <p>Cassandra: Locally Undetected Fault</p>
    <p>sstable</p>
    <p>CORRUPT</p>
    <p>READ (R=1)</p>
    <p>Need for end-to-end integrity and error handling</p>
  </div>
  <div class="page">
    <p>Crashing - Common Local Reaction</p>
  </div>
  <div class="page">
    <p>Crashing - Common Local Reaction</p>
    <p>Many systems that reliably detect fault simply crash on encountering faults</p>
  </div>
  <div class="page">
    <p>collections.header collections.metadata collections.data index journal.header journal.other storage_bson wiredtiger_wt</p>
    <p>Crashing - Common Local Reaction</p>
    <p>Many systems that reliably detect fault simply crash on encountering faults</p>
    <p>MongoDB Block Corruption during Read Workloads</p>
    <p>L F</p>
    <p>Crash</p>
    <p>Leader</p>
    <p>Follower</p>
    <p>L</p>
    <p>F</p>
  </div>
  <div class="page">
    <p>collections.header collections.metadata collections.data index journal.header journal.other storage_bson wiredtiger_wt</p>
    <p>Crashing - Common Local Reaction</p>
    <p>Many systems that reliably detect fault simply crash on encountering faults</p>
    <p>MongoDB Block Corruption during Read Workloads</p>
    <p>L F</p>
    <p>Crash</p>
    <p>Leader</p>
    <p>Follower</p>
    <p>L</p>
    <p>F</p>
  </div>
  <div class="page">
    <p>collections.header collections.metadata collections.data index journal.header journal.other storage_bson wiredtiger_wt</p>
    <p>Crashing - Common Local Reaction</p>
    <p>Many systems that reliably detect fault simply crash on encountering faults</p>
    <p>MongoDB Block Corruption during Read Workloads</p>
    <p>L F</p>
    <p>epoch epoch_tmp myid log.transaction_head log.transaction_body log.transaction_tail log.remaining log.tail</p>
    <p>ZooKeeper</p>
    <p>L F</p>
    <p>Crash</p>
    <p>Leader</p>
    <p>Follower</p>
    <p>L</p>
    <p>F</p>
  </div>
  <div class="page">
    <p>collections.header collections.metadata collections.data index journal.header journal.other storage_bson wiredtiger_wt</p>
    <p>Crashing - Common Local Reaction</p>
    <p>Many systems that reliably detect fault simply crash on encountering faults</p>
    <p>MongoDB Block Corruption during Read Workloads</p>
    <p>L F</p>
    <p>epoch epoch_tmp myid log.transaction_head log.transaction_body log.transaction_tail log.remaining log.tail</p>
    <p>ZooKeeper</p>
    <p>L F</p>
    <p>Crash</p>
    <p>Leader</p>
    <p>Follower</p>
    <p>L</p>
    <p>F</p>
  </div>
  <div class="page">
    <p>collections.header collections.metadata collections.data index journal.header journal.other storage_bson wiredtiger_wt</p>
    <p>Crashing - Common Local Reaction</p>
    <p>Many systems that reliably detect fault simply crash on encountering faults</p>
    <p>MongoDB Block Corruption during Read Workloads</p>
    <p>L F</p>
    <p>epoch epoch_tmp myid log.transaction_head log.transaction_body log.transaction_tail log.remaining log.tail</p>
    <p>ZooKeeper</p>
    <p>L F</p>
    <p>Crash</p>
    <p>Leader</p>
    <p>Follower</p>
    <p>L</p>
    <p>F</p>
    <p>Crashing leads to reduced redundancy and imminent unavailability</p>
  </div>
  <div class="page">
    <p>collections.header collections.metadata collections.data index journal.header journal.other storage_bson wiredtiger_wt</p>
    <p>Crashing - Common Local Reaction</p>
    <p>Many systems that reliably detect fault simply crash on encountering faults</p>
    <p>MongoDB Block Corruption during Read Workloads</p>
    <p>L F</p>
    <p>epoch epoch_tmp myid log.transaction_head log.transaction_body log.transaction_tail log.remaining log.tail</p>
    <p>ZooKeeper</p>
    <p>L F</p>
    <p>Crash</p>
    <p>Leader</p>
    <p>Follower</p>
    <p>L</p>
    <p>F</p>
    <p>Crashing leads to reduced redundancy and imminent unavailability Persistent fault -- Requires manual intervention</p>
  </div>
  <div class="page">
    <p>collections.header collections.metadata collections.data index journal.header journal.other storage_bson wiredtiger_wt</p>
    <p>Crashing - Common Local Reaction</p>
    <p>Many systems that reliably detect fault simply crash on encountering faults</p>
    <p>MongoDB Block Corruption during Read Workloads</p>
    <p>L F</p>
    <p>epoch epoch_tmp myid log.transaction_head log.transaction_body log.transaction_tail log.remaining log.tail</p>
    <p>ZooKeeper</p>
    <p>L F</p>
    <p>Crash</p>
    <p>Leader</p>
    <p>Follower</p>
    <p>L</p>
    <p>F</p>
    <p>Crashing leads to reduced redundancy and imminent unavailability Persistent fault -- Requires manual intervention</p>
    <p>Redundancy underutilized!</p>
  </div>
  <div class="page">
    <p>Crash and Corruption Handling are Entangled</p>
  </div>
  <div class="page">
    <p>Crash and Corruption Handling are Entangled Kafka Message Log</p>
  </div>
  <div class="page">
    <p>Crash and Corruption Handling are Entangled Kafka Message Log</p>
  </div>
  <div class="page">
    <p>Crash and Corruption Handling are Entangled Kafka Message Log</p>
    <p>data</p>
  </div>
  <div class="page">
    <p>Crash and Corruption Handling are Entangled Kafka Message Log</p>
    <p>checksum data</p>
  </div>
  <div class="page">
    <p>Crash and Corruption Handling are Entangled Kafka Message Log</p>
    <p>checksum data</p>
  </div>
  <div class="page">
    <p>Crash and Corruption Handling are Entangled Kafka Message Log</p>
    <p>checksum data</p>
    <p>Append(log, entry 2)</p>
  </div>
  <div class="page">
    <p>Crash and Corruption Handling are Entangled Kafka Message Log</p>
    <p>checksum data</p>
    <p>Append(log, entry 2)</p>
  </div>
  <div class="page">
    <p>Crash and Corruption Handling are Entangled Kafka Message Log</p>
    <p>checksum data</p>
    <p>Append(log, entry 2)</p>
  </div>
  <div class="page">
    <p>Crash and Corruption Handling are Entangled Kafka Message Log</p>
    <p>checksum data</p>
    <p>Append(log, entry 2)</p>
    <p>Checksum mismatch</p>
  </div>
  <div class="page">
    <p>Crash and Corruption Handling are Entangled Kafka Message Log</p>
    <p>checksum data</p>
    <p>Append(log, entry 2)</p>
    <p>Checksum mismatch</p>
    <p>Action: Truncate log at 1</p>
  </div>
  <div class="page">
    <p>Crash and Corruption Handling are Entangled Kafka Message Log</p>
    <p>checksum data</p>
    <p>Append(log, entry 2)</p>
    <p>Checksum mismatch</p>
    <p>Action: Truncate log at 1</p>
  </div>
  <div class="page">
    <p>Crash and Corruption Handling are Entangled Kafka Message Log</p>
    <p>checksum data</p>
    <p>Append(log, entry 2)</p>
    <p>Checksum mismatch</p>
    <p>Action: Truncate log at 1</p>
    <p>Lose uncommitted data</p>
  </div>
  <div class="page">
    <p>Crash and Corruption Handling are Entangled Kafka Message Log</p>
    <p>checksum data</p>
    <p>Append(log, entry 2)</p>
    <p>Checksum mismatch</p>
    <p>Action: Truncate log at 1</p>
    <p>Lose uncommitted data</p>
  </div>
  <div class="page">
    <p>Crash and Corruption Handling are Entangled Kafka Message Log</p>
    <p>checksum data</p>
    <p>Append(log, entry 2)</p>
    <p>Checksum mismatch</p>
    <p>Action: Truncate log at 1</p>
    <p>Lose uncommitted data</p>
  </div>
  <div class="page">
    <p>Crash and Corruption Handling are Entangled Kafka Message Log</p>
    <p>checksum data</p>
    <p>Append(log, entry 2)</p>
    <p>Checksum mismatch</p>
    <p>Action: Truncate log at 1</p>
    <p>Lose uncommitted data</p>
  </div>
  <div class="page">
    <p>Crash and Corruption Handling are Entangled Kafka Message Log</p>
    <p>checksum data</p>
    <p>Append(log, entry 2)</p>
    <p>Checksum mismatch</p>
    <p>Action: Truncate log at 1</p>
    <p>Disk corruption</p>
    <p>Lose uncommitted data</p>
  </div>
  <div class="page">
    <p>Crash and Corruption Handling are Entangled Kafka Message Log</p>
    <p>checksum data</p>
    <p>Append(log, entry 2)</p>
    <p>Checksum mismatch</p>
    <p>Checksum mismatch</p>
    <p>Action: Truncate log at 1</p>
    <p>Disk corruption</p>
    <p>Lose uncommitted data</p>
  </div>
  <div class="page">
    <p>Crash and Corruption Handling are Entangled Kafka Message Log</p>
    <p>checksum data</p>
    <p>Append(log, entry 2)</p>
    <p>Checksum mismatch</p>
    <p>Checksum mismatch</p>
    <p>Action: Truncate log at 1</p>
    <p>Disk corruption</p>
    <p>Action: Truncate log at 0</p>
    <p>Lose uncommitted data</p>
  </div>
  <div class="page">
    <p>Crash and Corruption Handling are Entangled Kafka Message Log</p>
    <p>checksum data</p>
    <p>Append(log, entry 2)</p>
    <p>Checksum mismatch</p>
    <p>Checksum mismatch</p>
    <p>Action: Truncate log at 1</p>
    <p>Disk corruption</p>
    <p>Action: Truncate log at 0</p>
    <p>Lose uncommitted data</p>
  </div>
  <div class="page">
    <p>Crash and Corruption Handling are Entangled Kafka Message Log</p>
    <p>checksum data</p>
    <p>Append(log, entry 2)</p>
    <p>Checksum mismatch</p>
    <p>Checksum mismatch</p>
    <p>Action: Truncate log at 1</p>
    <p>Disk corruption</p>
    <p>Action: Truncate log at 0</p>
    <p>Lose uncommitted data</p>
    <p>Lose committed data!</p>
  </div>
  <div class="page">
    <p>Crash and Corruption Handling are Entangled Kafka Message Log</p>
    <p>checksum data</p>
    <p>Append(log, entry 2)</p>
    <p>Checksum mismatch</p>
    <p>Checksum mismatch</p>
    <p>Action: Truncate log at 1</p>
    <p>Disk corruption</p>
    <p>Action: Truncate log at 0</p>
    <p>Lose uncommitted data</p>
    <p>Lose committed data!</p>
    <p>Developers of LogCabin and RethinkDB agree entanglement is the problem</p>
  </div>
  <div class="page">
    <p>Crash and Corruption Handling are Entangled Kafka Message Log</p>
    <p>checksum data</p>
    <p>Append(log, entry 2)</p>
    <p>Checksum mismatch</p>
    <p>Checksum mismatch</p>
    <p>Action: Truncate log at 1</p>
    <p>Disk corruption</p>
    <p>Action: Truncate log at 0</p>
    <p>Lose uncommitted data</p>
    <p>Lose committed data!</p>
    <p>Developers of LogCabin and RethinkDB agree entanglement is the problem</p>
  </div>
  <div class="page">
    <p>Unsafe Interaction between Local &amp; Global Protocols</p>
  </div>
  <div class="page">
    <p>Unsafe Interaction between Local &amp; Global Protocols</p>
    <p>Kafka: Message log at Node 1</p>
  </div>
  <div class="page">
    <p>Unsafe Interaction between Local &amp; Global Protocols Disk corruption Checksum mismatch</p>
    <p>Kafka: Message log at Node 1</p>
  </div>
  <div class="page">
    <p>Unsafe Interaction between Local &amp; Global Protocols Disk corruption Checksum mismatch Action: Truncate log at 0</p>
    <p>Kafka: Message log at Node 1</p>
  </div>
  <div class="page">
    <p>Unsafe Interaction between Local &amp; Global Protocols Disk corruption Checksum mismatch Action: Truncate log at 0 Lose committed data!0 1 2</p>
    <p>Kafka: Message log at Node 1</p>
  </div>
  <div class="page">
    <p>Unsafe Interaction between Local &amp; Global Protocols Disk corruption Checksum mismatch Action: Truncate log at 0 Lose committed data!0 1 2</p>
    <p>Kafka: Message log at Node 1</p>
    <p>Local Behavior</p>
  </div>
  <div class="page">
    <p>Unsafe Interaction between Local &amp; Global Protocols Disk corruption Checksum mismatch Action: Truncate log at 0 Lose committed data!0 1 2</p>
    <p>Kafka: Message log at Node 1</p>
    <p>Local Behavior</p>
  </div>
  <div class="page">
    <p>Unsafe Interaction between Local &amp; Global Protocols Disk corruption Checksum mismatch Action: Truncate log at 0 Lose committed data!0 1 2</p>
    <p>Kafka: Message log at Node 1</p>
    <p>Local Behavior</p>
    <p>Node1 Other Nodes</p>
  </div>
  <div class="page">
    <p>Unsafe Interaction between Local &amp; Global Protocols Disk corruption Checksum mismatch Action: Truncate log at 0 Lose committed data!0 1 2</p>
    <p>Kafka: Message log at Node 1</p>
    <p>Local Behavior</p>
    <p>Node1 Other Nodes</p>
    <p>Set of in-sync replicas</p>
  </div>
  <div class="page">
    <p>Unsafe Interaction between Local &amp; Global Protocols Disk corruption Checksum mismatch Action: Truncate log at 0 Lose committed data!0 1 2</p>
    <p>Kafka: Message log at Node 1</p>
    <p>Local Behavior</p>
    <p>Node1 Other Nodes</p>
    <p>Set of in-sync replicas</p>
    <p>Node1 with truncated log not removed from in-sync replicas</p>
  </div>
  <div class="page">
    <p>Unsafe Interaction between Local &amp; Global Protocols Disk corruption Checksum mismatch Action: Truncate log at 0 Lose committed data!0 1 2</p>
    <p>Kafka: Message log at Node 1</p>
    <p>Local Behavior</p>
    <p>Node1 Other Nodes</p>
    <p>Leader Followers Set of in-sync replicas</p>
    <p>Node1 with truncated log not removed from in-sync replicas</p>
    <p>Node 1 elected as leader</p>
  </div>
  <div class="page">
    <p>Unsafe Interaction between Local &amp; Global Protocols Disk corruption Checksum mismatch Action: Truncate log at 0 Lose committed data!0 1 2</p>
    <p>Kafka: Message log at Node 1</p>
    <p>Local Behavior</p>
    <p>Client Node1 Other Nodes READ</p>
    <p>Leader Followers Set of in-sync replicas</p>
    <p>Node1 with truncated log not removed from in-sync replicas</p>
    <p>Node 1 elected as leader</p>
  </div>
  <div class="page">
    <p>Unsafe Interaction between Local &amp; Global Protocols Disk corruption Checksum mismatch Action: Truncate log at 0 Lose committed data!0 1 2</p>
    <p>Kafka: Message log at Node 1</p>
    <p>Local Behavior</p>
    <p>Client Node1 Other Nodes</p>
    <p>message:0</p>
    <p>[Silent data loss]</p>
    <p>READ</p>
    <p>Leader Followers Set of in-sync replicas</p>
    <p>Node1 with truncated log not removed from in-sync replicas</p>
    <p>Node 1 elected as leader</p>
  </div>
  <div class="page">
    <p>Unsafe Interaction between Local &amp; Global Protocols Disk corruption Checksum mismatch Action: Truncate log at 0 Lose committed data!0 1 2</p>
    <p>Kafka: Message log at Node 1</p>
    <p>Local Behavior</p>
    <p>Client Node1 Other Nodes</p>
    <p>message:0</p>
    <p>[Silent data loss]</p>
    <p>READ</p>
    <p>Truncate upto message 0</p>
    <p>Leader Followers Set of in-sync replicas</p>
    <p>Node1 with truncated log not removed from in-sync replicas</p>
    <p>Node 1 elected as leader</p>
  </div>
  <div class="page">
    <p>Unsafe Interaction between Local &amp; Global Protocols Disk corruption Checksum mismatch Action: Truncate log at 0 Lose committed data!0 1 2</p>
    <p>Kafka: Message log at Node 1</p>
    <p>Local Behavior</p>
    <p>Client Node1 Other Nodes</p>
    <p>message:0</p>
    <p>[Silent data loss]</p>
    <p>READ</p>
    <p>Truncate upto message 0</p>
    <p>Assertion failure</p>
    <p>Leader Followers Set of in-sync replicas</p>
    <p>Node1 with truncated log not removed from in-sync replicas</p>
    <p>Node 1 elected as leader</p>
  </div>
  <div class="page">
    <p>Unsafe Interaction between Local &amp; Global Protocols Disk corruption Checksum mismatch Action: Truncate log at 0 Lose committed data!0 1 2</p>
    <p>Kafka: Message log at Node 1</p>
    <p>Local Behavior</p>
    <p>Client Node1 Other Nodes</p>
    <p>message:0</p>
    <p>[Silent data loss]</p>
    <p>READ</p>
    <p>Truncate upto message 0</p>
    <p>Assertion failureWRITE (W=2)</p>
    <p>Leader Followers Set of in-sync replicas</p>
    <p>Node1 with truncated log not removed from in-sync replicas</p>
    <p>Node 1 elected as leader</p>
  </div>
  <div class="page">
    <p>Unsafe Interaction between Local &amp; Global Protocols Disk corruption Checksum mismatch Action: Truncate log at 0 Lose committed data!0 1 2</p>
    <p>Kafka: Message log at Node 1</p>
    <p>Local Behavior</p>
    <p>Client Node1 Other Nodes</p>
    <p>message:0</p>
    <p>[Silent data loss]</p>
    <p>READ</p>
    <p>Truncate upto message 0</p>
    <p>Assertion failure</p>
    <p>Failure</p>
    <p>WRITE (W=2)</p>
    <p>Leader Followers Set of in-sync replicas</p>
    <p>Node1 with truncated log not removed from in-sync replicas</p>
    <p>Node 1 elected as leader</p>
  </div>
  <div class="page">
    <p>Unsafe Interaction between Local &amp; Global Protocols Disk corruption Checksum mismatch Action: Truncate log at 0 Lose committed data!0 1 2</p>
    <p>Kafka: Message log at Node 1</p>
    <p>Local Behavior</p>
    <p>Client Node1 Other Nodes</p>
    <p>message:0</p>
    <p>[Silent data loss]</p>
    <p>READ</p>
    <p>Truncate upto message 0</p>
    <p>Assertion failure</p>
    <p>Failure</p>
    <p>WRITE (W=2)</p>
    <p>Leader Followers Set of in-sync replicas</p>
    <p>Node1 with truncated log not removed from in-sync replicas</p>
    <p>Node 1 elected as leader</p>
    <p>Unsafe interaction between local behavior and leader election protocol leads to data loss and write unavailability</p>
  </div>
  <div class="page">
    <p>Unsafe Interaction between Local &amp; Global Protocols Disk corruption Checksum mismatch Action: Truncate log at 0 Lose committed data!0 1 2</p>
    <p>Kafka: Message log at Node 1</p>
    <p>Local Behavior</p>
    <p>Client Node1 Other Nodes</p>
    <p>message:0</p>
    <p>[Silent data loss]</p>
    <p>READ</p>
    <p>Truncate upto message 0</p>
    <p>Assertion failure</p>
    <p>Failure</p>
    <p>WRITE (W=2)</p>
    <p>Leader Followers Set of in-sync replicas</p>
    <p>Node1 with truncated log not removed from in-sync replicas</p>
    <p>Node 1 elected as leader</p>
    <p>Need for synergy between local behavior and global protocol</p>
    <p>Unsafe interaction between local behavior and leader election protocol leads to data loss and write unavailability</p>
  </div>
  <div class="page">
    <p>Redundancy Does not Provide Fault Tolerance</p>
    <p>Redis Read</p>
    <p>Corrupt Read Error</p>
    <p>txn_head log.tail</p>
    <p>ZooKeeper Write Write Error</p>
    <p>log.header log.other replication</p>
    <p>L F L F</p>
    <p>L F</p>
    <p>L F L F</p>
    <p>Kafka Read</p>
    <p>aof.metadata aof.data rdb.metadata rdb.userdata</p>
    <p>RethinkDB Read</p>
    <p>db.txn_head db.txn_body db.txn_tail db.metablock</p>
    <p>L F</p>
    <p>Corruption</p>
    <p>Write Unavailability</p>
    <p>Data Loss</p>
    <p>UnavailabilityCorrupt</p>
    <p>Query Failure</p>
    <p>Cassandra Read Kafka Write</p>
    <p>checkpoint L F L F</p>
    <p>Corrupt Read Error Corrupt</p>
    <p>Read Error</p>
    <p>Corrupt Read Error</p>
    <p>sstable.block0 sstable.metadata sstable.userdata sstable.index</p>
    <p>Reduced Redundancy</p>
  </div>
  <div class="page">
    <p>Why does Redundancy Not Imply Fault Tolerance?</p>
    <p>Redis Read</p>
    <p>Corrupt Read Error</p>
    <p>ZooKeeper Write</p>
    <p>Write Error</p>
    <p>L F L F</p>
    <p>L F</p>
    <p>L F L F</p>
    <p>Kafka Read</p>
    <p>RethinkDB Read</p>
    <p>L F</p>
    <p>Corrupt</p>
    <p>Cassandra Read</p>
    <p>Kafka Write</p>
    <p>L F L F</p>
    <p>Corrupt Read Error Corrupt</p>
    <p>Read Error</p>
    <p>Corrupt Read Error</p>
  </div>
  <div class="page">
    <p>Why does Redundancy Not Imply Fault Tolerance?</p>
    <p>Redis Read</p>
    <p>Corrupt Read Error</p>
    <p>ZooKeeper Write</p>
    <p>Write Error</p>
    <p>L F L F</p>
    <p>L F</p>
    <p>L F L F</p>
    <p>Kafka Read</p>
    <p>RethinkDB Read</p>
    <p>L F</p>
    <p>Corrupt</p>
    <p>Cassandra Read</p>
    <p>Kafka Write</p>
    <p>L F L F</p>
    <p>Corrupt Read Error Corrupt</p>
    <p>Read Error</p>
    <p>Corrupt Read Error</p>
  </div>
  <div class="page">
    <p>Why does Redundancy Not Imply Fault Tolerance?</p>
    <p>Redis Read</p>
    <p>Corrupt Read Error</p>
    <p>ZooKeeper Write</p>
    <p>Write Error</p>
    <p>L F L F</p>
    <p>L F</p>
    <p>L F L F</p>
    <p>Kafka Read</p>
    <p>RethinkDB Read</p>
    <p>L F</p>
    <p>Corrupt</p>
    <p>Cassandra Read</p>
    <p>Kafka Write</p>
    <p>L F L F</p>
    <p>Corrupt Read Error Corrupt</p>
    <p>Read Error</p>
    <p>Corrupt Read Error</p>
    <p>Faults are often locally undetected</p>
  </div>
  <div class="page">
    <p>Why does Redundancy Not Imply Fault Tolerance?</p>
    <p>Redis Read</p>
    <p>Corrupt Read Error</p>
    <p>ZooKeeper Write</p>
    <p>Write Error</p>
    <p>L F L F</p>
    <p>L F</p>
    <p>L F L F</p>
    <p>Kafka Read</p>
    <p>RethinkDB Read</p>
    <p>L F</p>
    <p>Corrupt</p>
    <p>Cassandra Read</p>
    <p>Kafka Write</p>
    <p>L F L F</p>
    <p>Corrupt Read Error Corrupt</p>
    <p>Read Error</p>
    <p>Corrupt Read Error</p>
    <p>Faults are often locally undetected</p>
  </div>
  <div class="page">
    <p>Why does Redundancy Not Imply Fault Tolerance?</p>
    <p>Redis Read</p>
    <p>Corrupt Read Error</p>
    <p>ZooKeeper Write</p>
    <p>Write Error</p>
    <p>L F L F</p>
    <p>L F</p>
    <p>L F L F</p>
    <p>Kafka Read</p>
    <p>RethinkDB Read</p>
    <p>L F</p>
    <p>Corrupt</p>
    <p>Cassandra Read</p>
    <p>Kafka Write</p>
    <p>L F L F</p>
    <p>Corrupt Read Error Corrupt</p>
    <p>Read Error</p>
    <p>Corrupt Read Error</p>
    <p>Faults are often locally undetected</p>
    <p>Crashing on detecting faults is the common reaction</p>
  </div>
  <div class="page">
    <p>Why does Redundancy Not Imply Fault Tolerance?</p>
    <p>Redis Read</p>
    <p>Corrupt Read Error</p>
    <p>ZooKeeper Write</p>
    <p>Write Error</p>
    <p>L F L F</p>
    <p>L F</p>
    <p>L F L F</p>
    <p>Kafka Read</p>
    <p>RethinkDB Read</p>
    <p>L F</p>
    <p>Corrupt</p>
    <p>Cassandra Read</p>
    <p>Kafka Write</p>
    <p>L F L F</p>
    <p>Corrupt Read Error Corrupt</p>
    <p>Read Error</p>
    <p>Corrupt Read Error</p>
    <p>Faults are often locally undetected</p>
    <p>Crashing on detecting faults is the common reaction</p>
  </div>
  <div class="page">
    <p>Why does Redundancy Not Imply Fault Tolerance?</p>
    <p>Redis Read</p>
    <p>Corrupt Read Error</p>
    <p>ZooKeeper Write</p>
    <p>Write Error</p>
    <p>L F L F</p>
    <p>L F</p>
    <p>L F L F</p>
    <p>Kafka Read</p>
    <p>RethinkDB Read</p>
    <p>L F</p>
    <p>Corrupt</p>
    <p>Cassandra Read</p>
    <p>Kafka Write</p>
    <p>L F L F</p>
    <p>Corrupt Read Error Corrupt</p>
    <p>Read Error</p>
    <p>Corrupt Read Error</p>
    <p>Faults are often locally undetected</p>
    <p>Crashing on detecting faults is the common reaction</p>
    <p>Crash and corruption handling are entangled</p>
  </div>
  <div class="page">
    <p>Why does Redundancy Not Imply Fault Tolerance?</p>
    <p>Redis Read</p>
    <p>Corrupt Read Error</p>
    <p>ZooKeeper Write</p>
    <p>Write Error</p>
    <p>L F L F</p>
    <p>L F</p>
    <p>L F L F</p>
    <p>Kafka Read</p>
    <p>RethinkDB Read</p>
    <p>L F</p>
    <p>Corrupt</p>
    <p>Cassandra Read</p>
    <p>Kafka Write</p>
    <p>L F L F</p>
    <p>Corrupt Read Error Corrupt</p>
    <p>Read Error</p>
    <p>Corrupt Read Error</p>
    <p>Faults are often locally undetected</p>
    <p>Crashing on detecting faults is the common reaction</p>
    <p>Crash and corruption handling are entangled</p>
  </div>
  <div class="page">
    <p>Why does Redundancy Not Imply Fault Tolerance?</p>
    <p>Redis Read</p>
    <p>Corrupt Read Error</p>
    <p>ZooKeeper Write</p>
    <p>Write Error</p>
    <p>L F L F</p>
    <p>L F</p>
    <p>L F L F</p>
    <p>Kafka Read</p>
    <p>RethinkDB Read</p>
    <p>L F</p>
    <p>Corrupt</p>
    <p>Cassandra Read</p>
    <p>Kafka Write</p>
    <p>L F L F</p>
    <p>Corrupt Read Error Corrupt</p>
    <p>Read Error</p>
    <p>Corrupt Read Error</p>
    <p>Faults are often locally undetected</p>
    <p>Crashing on detecting faults is the common reaction</p>
    <p>Crash and corruption handling are entangled</p>
    <p>Unsafe interaction between local and global protocols</p>
  </div>
  <div class="page">
    <p>Why does Redundancy Not Imply Fault Tolerance?</p>
    <p>Redis Read</p>
    <p>Corrupt Read Error</p>
    <p>ZooKeeper Write</p>
    <p>Write Error</p>
    <p>L F L F</p>
    <p>L F</p>
    <p>L F L F</p>
    <p>Kafka Read</p>
    <p>RethinkDB Read</p>
    <p>L F</p>
    <p>Corrupt</p>
    <p>Cassandra Read</p>
    <p>Kafka Write</p>
    <p>L F L F</p>
    <p>Corrupt Read Error Corrupt</p>
    <p>Read Error</p>
    <p>Corrupt Read Error</p>
    <p>Faults are often locally undetected</p>
    <p>Crashing on detecting faults is the common reaction</p>
    <p>Crash and corruption handling are entangled</p>
    <p>Unsafe interaction between local and global protocols</p>
  </div>
  <div class="page">
    <p>Why does Redundancy Not Imply Fault Tolerance?</p>
    <p>Redis Read</p>
    <p>Corrupt Read Error</p>
    <p>ZooKeeper Write</p>
    <p>Write Error</p>
    <p>L F L F</p>
    <p>L F</p>
    <p>L F L F</p>
    <p>Kafka Read</p>
    <p>RethinkDB Read</p>
    <p>L F</p>
    <p>Corrupt</p>
    <p>Cassandra Read</p>
    <p>Kafka Write</p>
    <p>L F L F</p>
    <p>Corrupt Read Error Corrupt</p>
    <p>Read Error</p>
    <p>Corrupt Read Error</p>
    <p>Faults are often locally undetected</p>
    <p>Not simple implementation bugs - fundamental problems across multiple systems!</p>
    <p>Crashing on detecting faults is the common reaction</p>
    <p>Crash and corruption handling are entangled</p>
    <p>Unsafe interaction between local and global protocols</p>
  </div>
  <div class="page">
    <p>Why does Redundancy Not Imply Fault Tolerance?</p>
    <p>Redis Read</p>
    <p>Corrupt Read Error</p>
    <p>ZooKeeper Write</p>
    <p>Write Error</p>
    <p>L F L F</p>
    <p>L F</p>
    <p>L F L F</p>
    <p>Kafka Read</p>
    <p>RethinkDB Read</p>
    <p>L F</p>
    <p>Corrupt</p>
    <p>Cassandra Read</p>
    <p>Kafka Write</p>
    <p>L F L F</p>
    <p>Corrupt Read Error Corrupt</p>
    <p>Read Error</p>
    <p>Corrupt Read Error</p>
    <p>Faults are often locally undetected</p>
    <p>Not simple implementation bugs - fundamental problems across multiple systems! Redundancy underutilized as a source of recovery</p>
    <p>Crashing on detecting faults is the common reaction</p>
    <p>Crash and corruption handling are entangled</p>
    <p>Unsafe interaction between local and global protocols</p>
  </div>
  <div class="page">
    <p>Fundamental Problems: Summary</p>
  </div>
  <div class="page">
    <p>Fundamental Problems: Summary</p>
    <p>Locally undetected</p>
    <p>faults?</p>
    <p>Crashing common local</p>
    <p>action?</p>
    <p>Crash &amp; corruption handling</p>
    <p>entangled?</p>
    <p>Unsafe interaction of local &amp; global</p>
    <p>protocols?</p>
    <p>Redundancy underutilized for recovery?</p>
    <p>Redis</p>
    <p>ZooKeeper</p>
    <p>Cassandra</p>
    <p>Kafka</p>
    <p>RethinkDB</p>
    <p>MongoDB</p>
    <p>LogCabin</p>
    <p>CockroachDB</p>
  </div>
  <div class="page">
    <p>Fundamental Problems: Summary</p>
    <p>Locally undetected</p>
    <p>faults?</p>
    <p>Crashing common local</p>
    <p>action?</p>
    <p>Crash &amp; corruption handling</p>
    <p>entangled?</p>
    <p>Unsafe interaction of local &amp; global</p>
    <p>protocols?</p>
    <p>Redundancy underutilized for recovery?</p>
    <p>Redis</p>
    <p>ZooKeeper</p>
    <p>Cassandra</p>
    <p>Kafka</p>
    <p>RethinkDB</p>
    <p>MongoDB</p>
    <p>LogCabin</p>
    <p>CockroachDB</p>
  </div>
  <div class="page">
    <p>Fundamental Problems: Summary</p>
    <p>Locally undetected</p>
    <p>faults?</p>
    <p>Crashing common local</p>
    <p>action?</p>
    <p>Crash &amp; corruption handling</p>
    <p>entangled?</p>
    <p>Unsafe interaction of local &amp; global</p>
    <p>protocols?</p>
    <p>Redundancy underutilized for recovery?</p>
    <p>Redis</p>
    <p>ZooKeeper</p>
    <p>Cassandra</p>
    <p>Kafka</p>
    <p>RethinkDB</p>
    <p>MongoDB</p>
    <p>LogCabin</p>
    <p>CockroachDB</p>
  </div>
  <div class="page">
    <p>Fundamental Problems: Summary</p>
    <p>More observations, results, and discussions in the paper</p>
    <p>Locally undetected</p>
    <p>faults?</p>
    <p>Crashing common local</p>
    <p>action?</p>
    <p>Crash &amp; corruption handling</p>
    <p>entangled?</p>
    <p>Unsafe interaction of local &amp; global</p>
    <p>protocols?</p>
    <p>Redundancy underutilized for recovery?</p>
    <p>Redis</p>
    <p>ZooKeeper</p>
    <p>Cassandra</p>
    <p>Kafka</p>
    <p>RethinkDB</p>
    <p>MongoDB</p>
    <p>LogCabin</p>
    <p>CockroachDB</p>
  </div>
  <div class="page">
    <p>Outline Introduction</p>
    <p>Fault Injection</p>
    <p>System Behavior Analysis</p>
    <p>Major Results</p>
    <p>Observations Across Systems</p>
    <p>Faults are Often Undetected Locally</p>
    <p>Crashing: Common Local Reaction</p>
    <p>Crash and Corruption Handling are Entangled</p>
    <p>Unsafe interaction between local and global protocols</p>
    <p>Conclusion</p>
  </div>
  <div class="page">
    <p>Summary</p>
  </div>
  <div class="page">
    <p>Summary We analyzed distributed storage reactions to single file-system faults</p>
  </div>
  <div class="page">
    <p>Summary We analyzed distributed storage reactions to single file-system faults</p>
    <p>Redis, ZooKeeper, Cassandra, Kafka, MongoDB, LogCabin, RethinkDB, and CockroachDB</p>
  </div>
  <div class="page">
    <p>Summary We analyzed distributed storage reactions to single file-system faults</p>
    <p>Redis, ZooKeeper, Cassandra, Kafka, MongoDB, LogCabin, RethinkDB, and CockroachDB</p>
    <p>Redundancy does not provide fault tolerance</p>
  </div>
  <div class="page">
    <p>Summary We analyzed distributed storage reactions to single file-system faults</p>
    <p>Redis, ZooKeeper, Cassandra, Kafka, MongoDB, LogCabin, RethinkDB, and CockroachDB</p>
    <p>Redundancy does not provide fault tolerance</p>
    <p>A single fault in one node can cause catastrophic outcomes</p>
  </div>
  <div class="page">
    <p>Summary We analyzed distributed storage reactions to single file-system faults</p>
    <p>Redis, ZooKeeper, Cassandra, Kafka, MongoDB, LogCabin, RethinkDB, and CockroachDB</p>
    <p>Redundancy does not provide fault tolerance</p>
    <p>A single fault in one node can cause catastrophic outcomes</p>
    <p>data loss, corruption, unavailability, and spread of corruption to other intact replicas</p>
  </div>
  <div class="page">
    <p>Summary We analyzed distributed storage reactions to single file-system faults</p>
    <p>Redis, ZooKeeper, Cassandra, Kafka, MongoDB, LogCabin, RethinkDB, and CockroachDB</p>
    <p>Redundancy does not provide fault tolerance</p>
    <p>A single fault in one node can cause catastrophic outcomes</p>
    <p>data loss, corruption, unavailability, and spread of corruption to other intact replicas</p>
    <p>Some fundamental problems across multiple systems:</p>
  </div>
  <div class="page">
    <p>Summary We analyzed distributed storage reactions to single file-system faults</p>
    <p>Redis, ZooKeeper, Cassandra, Kafka, MongoDB, LogCabin, RethinkDB, and CockroachDB</p>
    <p>Redundancy does not provide fault tolerance</p>
    <p>A single fault in one node can cause catastrophic outcomes</p>
    <p>data loss, corruption, unavailability, and spread of corruption to other intact replicas</p>
    <p>Some fundamental problems across multiple systems:</p>
    <p>Faults are often undetected locally  leads to harmful global effects</p>
  </div>
  <div class="page">
    <p>Summary We analyzed distributed storage reactions to single file-system faults</p>
    <p>Redis, ZooKeeper, Cassandra, Kafka, MongoDB, LogCabin, RethinkDB, and CockroachDB</p>
    <p>Redundancy does not provide fault tolerance</p>
    <p>A single fault in one node can cause catastrophic outcomes</p>
    <p>data loss, corruption, unavailability, and spread of corruption to other intact replicas</p>
    <p>Some fundamental problems across multiple systems:</p>
    <p>Faults are often undetected locally  leads to harmful global effects</p>
    <p>On detection, crashing is the common action  redundancy underutilized</p>
  </div>
  <div class="page">
    <p>Summary We analyzed distributed storage reactions to single file-system faults</p>
    <p>Redis, ZooKeeper, Cassandra, Kafka, MongoDB, LogCabin, RethinkDB, and CockroachDB</p>
    <p>Redundancy does not provide fault tolerance</p>
    <p>A single fault in one node can cause catastrophic outcomes</p>
    <p>data loss, corruption, unavailability, and spread of corruption to other intact replicas</p>
    <p>Some fundamental problems across multiple systems:</p>
    <p>Faults are often undetected locally  leads to harmful global effects</p>
    <p>On detection, crashing is the common action  redundancy underutilized</p>
    <p>Crash and corruption handling are entangled  loss of committed data</p>
  </div>
  <div class="page">
    <p>Summary We analyzed distributed storage reactions to single file-system faults</p>
    <p>Redis, ZooKeeper, Cassandra, Kafka, MongoDB, LogCabin, RethinkDB, and CockroachDB</p>
    <p>Redundancy does not provide fault tolerance</p>
    <p>A single fault in one node can cause catastrophic outcomes</p>
    <p>data loss, corruption, unavailability, and spread of corruption to other intact replicas</p>
    <p>Some fundamental problems across multiple systems:</p>
    <p>Faults are often undetected locally  leads to harmful global effects</p>
    <p>On detection, crashing is the common action  redundancy underutilized</p>
    <p>Crash and corruption handling are entangled  loss of committed data</p>
    <p>Unsafe interaction between local behavior and global distributed protocols can spread corruption or data loss</p>
  </div>
  <div class="page">
    <p>Conclusion</p>
  </div>
  <div class="page">
    <p>Conclusion</p>
    <p>Most distributed systems not yet resilient</p>
  </div>
  <div class="page">
    <p>Conclusion</p>
    <p>Most distributed systems not yet resilient</p>
    <p>Always detect faults  important in layered stacks on commodity hardware</p>
  </div>
  <div class="page">
    <p>Conclusion</p>
    <p>Most distributed systems not yet resilient</p>
    <p>Always detect faults  important in layered stacks on commodity hardware</p>
    <p>Detecting faults and not using redundancy to recover is undesirable</p>
  </div>
  <div class="page">
    <p>Conclusion</p>
    <p>Most distributed systems not yet resilient</p>
    <p>Always detect faults  important in layered stacks on commodity hardware</p>
    <p>Detecting faults and not using redundancy to recover is undesirable</p>
    <p>Cannot always assume corruption to be caused by a crash</p>
  </div>
  <div class="page">
    <p>Conclusion</p>
    <p>Most distributed systems not yet resilient</p>
    <p>Always detect faults  important in layered stacks on commodity hardware</p>
    <p>Detecting faults and not using redundancy to recover is undesirable</p>
    <p>Cannot always assume corruption to be caused by a crash</p>
    <p>Local behavior has implications for distributed systems</p>
  </div>
  <div class="page">
    <p>Conclusion</p>
    <p>Most distributed systems not yet resilient</p>
    <p>Always detect faults  important in layered stacks on commodity hardware</p>
    <p>Detecting faults and not using redundancy to recover is undesirable</p>
    <p>Cannot always assume corruption to be caused by a crash</p>
    <p>Local behavior has implications for distributed systems</p>
    <p>Our study provides directions for more robust distributed storage design</p>
  </div>
  <div class="page">
    <p>Conclusion</p>
    <p>Most distributed systems not yet resilient</p>
    <p>Always detect faults  important in layered stacks on commodity hardware</p>
    <p>Detecting faults and not using redundancy to recover is undesirable</p>
    <p>Cannot always assume corruption to be caused by a crash</p>
    <p>Local behavior has implications for distributed systems</p>
    <p>Our study provides directions for more robust distributed storage design</p>
    <p>Our fault injection framework available online: http://research.cs.wisc.edu/adsl/Software/cords/</p>
    <p>Thank you! 31</p>
  </div>
</Presentation>
