<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>BRAID: Discovering Lag Correlations in Multiple Streams</p>
    <p>Yasushi Sakurai (NTT Cyber Space Labs)</p>
    <p>Spiros Papadimitriou (Carnegie Mellon Univ.)</p>
    <p>Christos Faloutsos (Carnegie Mellon Univ.)</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 2</p>
    <p>Motivation</p>
    <p>Data-stream applications  Network analysis  Sensor monitoring  Financial data analysis  Moving object tracking</p>
    <p>Goal  Monitor multiple numerical streams  Determine which pairs are correlated with lags  Report the value of each such lag (if any)</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 3</p>
    <p>Lag Correlations</p>
    <p>Examples  A decrease in interest rates typically precedes an</p>
    <p>increase in house sales by a few months</p>
    <p>Higher amounts of fluoride in the drinking water leads to fewer dental cavities, some years later</p>
    <p>High CPU utilization on server 1 precedes high CPU utilization for server 2 by a few minutes</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 4</p>
    <p>Lag Correlations  Example of lag-correlated sequences</p>
    <p>These sequences are correlated with lag l=1300 time-ticks</p>
    <p>CCF (Cross-Correlation Function)</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 5</p>
    <p>Lag Correlations</p>
    <p>CCF (Cross-Correlation Function)</p>
    <p>Example of lag-correlated sequences  Fast</p>
    <p>(high performance)</p>
    <p>Nimble (Low memory</p>
    <p>consumption)</p>
    <p>Accurate (good approximation)</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 6</p>
    <p>Problem #1: PAIR of sequences  For given two co-evolving sequences X and</p>
    <p>Y, determine  Whether there is a lag correlation  If yes, what is the lag length l</p>
    <p>Any time, on semi-infinite streams</p>
    <p>? yes; l = 1,300</p>
    <p>X</p>
    <p>Y</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 7</p>
    <p>Problem #2: k-way</p>
    <p>For given k numerical sequences, X1,,Xk , report  Which pairs (if any) have a lag correlation  The corresponding lag for such pairs</p>
    <p>again, any time, streaming fashion</p>
    <p>? X1 and X2; l = 1,300 ...</p>
    <p>X1</p>
    <p>...</p>
    <p>X2</p>
    <p>Xk</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 8</p>
    <p>Our solution, BRAID</p>
    <p>characteristics:  Any-time processing, and fast</p>
    <p>Computation time per time tick is constant</p>
    <p>Nimble Memory space requirement is sub-linear of sequence</p>
    <p>length</p>
    <p>Accurate Approximation introduces small error</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 9</p>
    <p>Sequence indexing  Agrawal et al. (FODO 1993)  Faloutsos et al. (SIGMOD 1994)  Keogh et al. (SIGMOD 2001)</p>
    <p>Compression (wavelet and random projections)  Gilbert et al. (VLDB 2001)  Guha et al. (VLDB 2004)  Dobra et al.(SIGMOD 2002)  Ganguly et al.(SIGMOD 2003)</p>
    <p>Related Work</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 10</p>
    <p>Data Stream Management  Abadi et al. (VLDB Journal 2003)  Motwani et al. (CIDR 2003)  Chandrasekaran et al. (CIDR 2003)  Cranor et al. (SIGMOD 2003)</p>
    <p>Related Work</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 11</p>
    <p>Related Work  Pattern discovery</p>
    <p>Clustering for data streams Guha et al. (TKDE 2003)</p>
    <p>Monitoring multiple streams Zhu et al. (VLDB 2002)</p>
    <p>Forecasting Yi et al. (ICDE 2000) Papadimitriou et al. (VLDB 2003)</p>
    <p>None of previously published methods focuses on the problem</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 12</p>
    <p>Overview</p>
    <p>Introduction / Related work  Background  Main ideas  Theoretical analysis  Experimental results</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 13</p>
    <p>Background</p>
    <p>CCF (Cross-Correlation Function)</p>
    <p>positively correlated</p>
    <p>un-correlated</p>
    <p>+</p>
    <p>anti-correlated (lower than -)</p>
    <p>Lag correlation</p>
    <p>Lag</p>
    <p>C o</p>
    <p>rr e la</p>
    <p>tio n</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 14</p>
    <p>Background</p>
    <p>Definition of score, the absolute value of R(l)</p>
    <p>Lag correlation  Given a threshold ,  A local maximum  The earliest such maximum, if more maxima exist</p>
    <p>)()( lRlscore</p>
    <p>ln</p>
    <p>t t</p>
    <p>n</p>
    <p>lt t</p>
    <p>n</p>
    <p>lt ltt</p>
    <p>yyxx</p>
    <p>yyxx lR</p>
    <p>)()(</p>
    <p>))(( )(</p>
    <p>)(lscore</p>
    <p>details</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 15</p>
    <p>Overview</p>
    <p>Introduction / Related work  Background  Main ideas  Theoretical analysis  Experimental results</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 16</p>
    <p>Why not naive?  Naive solution:</p>
    <p>Compute correlation coefficient for each lag</p>
    <p>l = 0, 1, 2, 3, , n/2</p>
    <p>But,  O(n) space  O(n2) time</p>
    <p>or O(n log n) time w/ FFT</p>
    <p>t=nTime Lag</p>
    <p>C o rr</p>
    <p>el at</p>
    <p>io n</p>
    <p>n/20</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 17</p>
    <p>Main Idea (1)</p>
    <p>Incremental computing:  the correlation coefficient of two sequences is</p>
    <p>algebraic -&gt; can be computed incrementally</p>
    <p>we need to maintain only 6 sufficient statistics:  Sequence length n  Sum of X, Square sum of X  Sum of Y, Square sum of Y  Inner-product for X and the shifted Y</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 18</p>
    <p>Main Idea (1)  Incremental computing:</p>
    <p>Sequence length n  Sum of X :  Square sum of X :  Inner-product for X and the shifted Y :</p>
    <p>Compute R(l) incrementally:</p>
    <p>Covariance of X and Y:</p>
    <p>Variance of X:</p>
    <p>n</p>
    <p>lt ltt yxlSxy</p>
    <p>n</p>
    <p>t t xnSx</p>
    <p>n</p>
    <p>t t xnSxx</p>
    <p>),1(),1(</p>
    <p>)( )(</p>
    <p>lnVynlVx</p>
    <p>lC lR</p>
    <p>ln</p>
    <p>lnSynlSx lSxylC</p>
    <p>),1(),1( )()(</p>
    <p>ln</p>
    <p>nlSx nlSxxnlVx</p>
    <p>details</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 19</p>
    <p>Main Idea (1)</p>
    <p>Complexity</p>
    <p>Naive Naive (incremental)</p>
    <p>BRAID</p>
    <p>Space O(n) O(n)</p>
    <p>Comp. time O(n log n) O(n)</p>
    <p>Better, but not good enough!</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 20</p>
    <p>Main Idea (2)</p>
    <p>Lag</p>
    <p>C o rr</p>
    <p>el a ti</p>
    <p>o n</p>
    <p>Geometric lag probing</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 21</p>
    <p>Main Idea (2)</p>
    <p>Lag</p>
    <p>C o rr</p>
    <p>el a ti</p>
    <p>o n</p>
    <p>Geometric lag probing  ie., compute the correlation coefficient for lag:</p>
    <p>l = 0, 1, 2, 4, ... 2h</p>
    <p>O(log n) estimations</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 22</p>
    <p>Main Idea (2)</p>
    <p>Geometric lag probing</p>
    <p>But, so far, we still need O(n) space because the longest lag is n/2</p>
    <p>Naive Naive (incremental)</p>
    <p>BRAID</p>
    <p>Space O(n) O(n)</p>
    <p>Comp. time O(n log n) O(n) O(log n)</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 23</p>
    <p>Main Idea (3)</p>
    <p>Lag</p>
    <p>C o rr</p>
    <p>el at</p>
    <p>io n</p>
    <p>Sequence smoothing</p>
    <p>t=nTime</p>
    <p>Reminder: Nave:</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 24</p>
    <p>Main Idea (3)</p>
    <p>Lag</p>
    <p>C o rr</p>
    <p>el at</p>
    <p>io n</p>
    <p>Level</p>
    <p>h=0 t=nTime</p>
    <p>Sequence smoothing  Means of windows for each level  Sufficient statistics computed from the means  CCF computed from the sufficient statistics  But, it allows a partial redundancy</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 25</p>
    <p>Putting it all together:</p>
    <p>Lag</p>
    <p>C o rr</p>
    <p>el at</p>
    <p>io n</p>
    <p>Level</p>
    <p>h=0 t=nTime</p>
    <p>Geometric lag probing + smoothing  Use colored windows  Keep track of only a geometric progression of the</p>
    <p>lag values: l={0,1,2,4,8,,2h,}</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 26</p>
    <p>Putting it all together:</p>
    <p>Geometric lag probing + smoothing  Use colored windows  Keep track of only a geometric progression of the</p>
    <p>lag values: l={0,1,2,4,8,,2h,}</p>
    <p>Lag</p>
    <p>C o rr</p>
    <p>el at</p>
    <p>io n</p>
    <p>Level</p>
    <p>h=0 t=nTime</p>
    <p>h=0Y</p>
    <p>X</p>
    <p>l=0</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 27</p>
    <p>Putting it all together:</p>
    <p>Geometric lag probing + smoothing  Use colored windows  Keep track of only a geometric progression of the</p>
    <p>lag values: l={0,1,2,4,8,,2h,}</p>
    <p>Lag</p>
    <p>C o rr</p>
    <p>el at</p>
    <p>io n</p>
    <p>Level</p>
    <p>h=0 t=nTime</p>
    <p>h=0Y</p>
    <p>X</p>
    <p>l=1</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 28</p>
    <p>Putting it all together:</p>
    <p>Geometric lag probing + smoothing  Use colored windows  Keep track of only a geometric progression of the</p>
    <p>lag values: l={0,1,2,4,8,,2h,}</p>
    <p>Lag</p>
    <p>C o rr</p>
    <p>el at</p>
    <p>io n</p>
    <p>Level</p>
    <p>h=1 th=n/2Time</p>
    <p>h=1Y</p>
    <p>X</p>
    <p>l=2</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 29</p>
    <p>Putting it all together:</p>
    <p>Geometric lag probing + smoothing  Use colored windows  Keep track of only a geometric progression of the</p>
    <p>lag values: l={0,1,2,4,8,,2h,}</p>
    <p>Lag</p>
    <p>C o rr</p>
    <p>el at</p>
    <p>io n</p>
    <p>Level</p>
    <p>h=2 Time</p>
    <p>h=2Y</p>
    <p>X th=n/4</p>
    <p>l=4</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 30</p>
    <p>Putting it all together:</p>
    <p>Geometric lag probing + smoothing  Use colored windows  Keep track of only a geometric progression of the</p>
    <p>lag values: l={0,1,2,4,8,,2h,}</p>
    <p>Lag</p>
    <p>C o rr</p>
    <p>el at</p>
    <p>io n</p>
    <p>Level</p>
    <p>h=3 Time</p>
    <p>h=3Y</p>
    <p>X th=n/8</p>
    <p>l=8</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 31</p>
    <p>Putting it all together:</p>
    <p>Lag</p>
    <p>C o rr</p>
    <p>el at</p>
    <p>io n</p>
    <p>Level</p>
    <p>h=0 t=nTime</p>
    <p>Geometric lag probing + smoothing  Use colored windows  Keep track of only a geometric progression of the</p>
    <p>lag values: l={0,1,2,4,8,,2h,}  Use a cubic spline to interpolate</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 32</p>
    <p>Thus:</p>
    <p>Complexity</p>
    <p>Naive Naive (incremental)</p>
    <p>BRAID</p>
    <p>Space O(n) O(n) O(log n)</p>
    <p>Comp. time O(n log n) O(n) O(1) *</p>
    <p>(*) Computation time: O(logn) And actually, amortized time: O(1)</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 33</p>
    <p>Overview</p>
    <p>Introduction / Related work  Background  Main ideas</p>
    <p>enhancing the accuracy</p>
    <p>Theoretical analysis  Experimental results</p>
    <p>details</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 34</p>
    <p>Enhanced Probing Scheme</p>
    <p>Q: How to probe more densely than 2h ?</p>
    <p>Lag</p>
    <p>C o rr</p>
    <p>el at</p>
    <p>io n</p>
    <p>Level</p>
    <p>h=0 t=nTime</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 35</p>
    <p>Enhanced Probing Scheme</p>
    <p>Q: How to probe more densely than 2h ?  A: probe in a mixture of geometric and arithmetic</p>
    <p>progressions</p>
    <p>Lag</p>
    <p>C o rr</p>
    <p>el at</p>
    <p>io n</p>
    <p>Level</p>
    <p>h=0 t=nTime</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 36</p>
    <p>Enhanced Probing Scheme</p>
    <p>Basic scheme: b=1 (one number for each level)  Enhanced scheme: b&gt;1</p>
    <p>Example of b=4  Probing the CCF in a mixture of geometric and arithmetic</p>
    <p>progressions: l={0,1,,7;8,10,12,14;16,20,24,28;32,40,}</p>
    <p>Level</p>
    <p>h=0</p>
    <p>Time t=n</p>
    <p>C o</p>
    <p>rr el</p>
    <p>a ti</p>
    <p>o n</p>
    <p>Lag</p>
    <p>step:1 step: 2 step: 4</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 37</p>
    <p>Overview</p>
    <p>Introduction / Related work  Background  Main ideas  Theoretical analysis  Experimental results</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 38</p>
    <p>Theoretical Analysis Accuracy  Effect of smoothing</p>
    <p>Effect of geometric lag probing</p>
    <p>For sequences with low frequencies, smoothing introduces only small error</p>
    <p>BRAIDS will provide no error, if lag probing satisfies the sampling theorem (Nyquists)</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 39</p>
    <p>Effect of geometric lag probing  Informally, BRAIDS will provide no error, if lag</p>
    <p>probing satisfies the sampling theorem (Nyquists)  Formally: Theorem 2</p>
    <p>fR: the Nyquist frequency of CCF, fR=min(fx, fy) fx, fy: the Nyquist frequencies of X and Y</p>
    <p>Theoretical Analysis Accuracy</p>
    <p>BRAID will find the lag correlations perfectly, if</p>
    <p>Rf</p>
    <p>b l</p>
    <p>details</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 40</p>
    <p>Theoretical Analysis Complexity Naive solution</p>
    <p>O(n) space</p>
    <p>O(n) time per time tick</p>
    <p>BRAID  O(log n) space</p>
    <p>O(1) time for updating sufficient statistics</p>
    <p>O(log n) time for interpolating (when output is required)</p>
    <p>details</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 41</p>
    <p>Overview</p>
    <p>Introduction / Related work  Background  Main ideas  Theoretical analysis  Experimental results</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 42</p>
    <p>Experimental results</p>
    <p>Setup  Intel Xeon 2.8GHz, 1GB memory, Linux  Datasets:</p>
    <p>Synthetic: Sines, SpikeTrains,</p>
    <p>Real: Humidity, Light, Temperature, Kursk, Sunspots  Enhanced BRAID, b=16</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 43</p>
    <p>Experimental results</p>
    <p>Evaluation  Accuracy for CCF  Accuracy for the lag estimation  Computation time  k-way lag correlations</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 44</p>
    <p>Accuracy for CCF (1)  Sines</p>
    <p>CCF (Cross-Correlation Function)</p>
    <p>BRAID perfectly estimates the correlation coefficients</p>
    <p>of the sinusoidal wave</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 45</p>
    <p>Accuracy for CCF (2)  SpikeTrains</p>
    <p>CCF (Cross-Correlation Function)</p>
    <p>BRAID closely estimates the correlation coefficients</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 46</p>
    <p>Accuracy for CCF (3)  Humidity (Real data)</p>
    <p>CCF (Cross-Correlation Function)</p>
    <p>BRAID closely estimates the correlation coefficients</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 47</p>
    <p>Accuracy for CCF (4)  Light (Real data)</p>
    <p>CCF (Cross-Correlation Function)</p>
    <p>BRAID closely estimates the correlation coefficients</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 48</p>
    <p>Accuracy for CCF (5)  Kursk (Real data)</p>
    <p>CCF (Cross-Correlation Function)</p>
    <p>BRAID closely estimates the correlation coefficients</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 49</p>
    <p>Accuracy for CCF (6)  Sunspots (Real data)</p>
    <p>CCF (Cross-Correlation Function)</p>
    <p>BRAID closely estimates the correlation coefficients</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 50</p>
    <p>Experimental results</p>
    <p>Evaluation  Accuracy for CCF  Accuracy for the lag estimation  Computation time  k-way lag correlations</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 51</p>
    <p>Estimation Error of Lag Correlations</p>
    <p>Largest relative error is about 1%</p>
    <p>Datasets</p>
    <p>Lag correlation Estimation error (%)Naive BRAID</p>
    <p>Sines 716 716 0.000</p>
    <p>SpikeTrains 2841 2830 0.387</p>
    <p>Humidity 3842 3855 0.338</p>
    <p>Light 567 570 0.529</p>
    <p>Kursk 1463 1472 0.615</p>
    <p>Sunspots 1156 1168 1.038</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 52</p>
    <p>Experimental results</p>
    <p>Evaluation  Accuracy for CCF  Accuracy for the lag estimation  Computation time  k-way lag correlations</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 53</p>
    <p>Computation time</p>
    <p>Reduce computation time dramatically  Up to 40,000 times faster</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 54</p>
    <p>Experimental results</p>
    <p>Evaluation  Accuracy for CCF  Accuracy for the lag estimation  Computation time  k-way lag correlations</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 55</p>
    <p>Group Lag Correlations  55 Temperature sequences  Two correlated pairs</p>
    <p>Estimation of CCF of #16 and #19 Estimation of CCF of #47 and #48</p>
    <p>#16 #19 #47 #48</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 56</p>
    <p>Conclusions</p>
    <p>Automatic lag correlation detection on data stream</p>
    <p>O(log n) space, O(1) time to update the statistics</p>
    <p>implementation</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 57</p>
    <p>Effect of geometric lag probing  Informally, BRAIDS will provide no error, if lag</p>
    <p>probing satisfies the sampling theorem (Nyquists)  Formally: Theorem 2</p>
    <p>fR: the Nyquist frequency of CCF, fR=min(fx, fy) fx, fy: the Nyquist frequencies of X and Y</p>
    <p>Theoretical Analysis Accuracy</p>
    <p>BRAID will find the lag correlations perfectly, if</p>
    <p>Rf</p>
    <p>b l</p>
    <p>details</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 58</p>
    <p>Effect of Probing</p>
    <p>Dataset: Sines  Lag correlation with b=1  lR=1024</p>
  </div>
  <div class="page">
    <p>SIGMOD 2005 Y. Sakurai et al 59</p>
    <p>Effect of Probing</p>
    <p>Dataset: Light  Lag correlation with b=1  lR=630</p>
  </div>
</Presentation>
