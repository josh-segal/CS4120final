<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Non-Deterministic Timers for Hardware Trojan Activation (Or How a Little Randomness Can Go the Wrong Way)</p>
    <p>Frank Imeson</p>
    <p>Electrical and Computer Engineering</p>
    <p>August 8th, 2016</p>
    <p>Collaborators: Saeed Nejati (Waterloo), Siddharth Garg (NYU) and Mahesh V. Tripunitara (Waterloo)</p>
  </div>
  <div class="page">
    <p>Intro</p>
    <p>Clock Jitter Ring Oscillators Sampling</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 1</p>
  </div>
  <div class="page">
    <p>Attack Model</p>
    <p>case(display_state) UPDATE : begin seg00_reg &lt;= seg00; seg01_reg &lt;= seg01; // update leds if (count00[0]) begin state &lt;= UPDATE; end default : begin ons00 &lt;= 0; count00 &lt;= 0; display_state &lt;= UPDATE; end endcase</p>
    <p>HDL Netlist IC</p>
    <p>Credit: www.theverge.com/2011/11/16/2565638/mit-neural-connectivity-silicon-synapse</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 2</p>
  </div>
  <div class="page">
    <p>Attack Model</p>
    <p>case(display_state) UPDATE : begin seg00_reg &lt;= seg00; seg01_reg &lt;= seg01; // update leds if (count00[0]) begin state &lt;= UPDATE; end default : begin ons00 &lt;= 1; count00 &lt;= 1; display_state &lt;= UPDATE; end endcase</p>
    <p>HDL Netlist IC</p>
    <p>Credit: www.theverge.com/2011/11/16/2565638/mit-neural-connectivity-silicon-synapse</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 2</p>
  </div>
  <div class="page">
    <p>Background</p>
    <p>Hardware modifications are permanent!</p>
    <p>Trojans:</p>
    <p>Privilege escalation [5]  Leaking private information [3]  Sabotage [4]</p>
    <p>Activation Types:</p>
    <p>Time Trigger [2]  Data Trigger [5]</p>
    <p>A B</p>
    <p>C</p>
    <p>Trigger</p>
    <p>Payload</p>
    <p>Cmodified</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 3</p>
  </div>
  <div class="page">
    <p>Deterministic Timers</p>
    <p>Clock Jitter Ring Oscillators Sampling</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 4</p>
  </div>
  <div class="page">
    <p>Hardware Constraints</p>
    <p>No access to Wall time (guarded)  Power on time  Power is not persistent  Cannot save state off chip</p>
    <p>(guarded)</p>
    <p>NV-memory can be used on chip</p>
    <p>NV-memory technology, e.g., Flash, has limited write durability</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 5</p>
  </div>
  <div class="page">
    <p>Hardware Constraints</p>
    <p>No access to Wall time (guarded)  Power on time  Power is not persistent  Cannot save state off chip</p>
    <p>(guarded)</p>
    <p>NV-memory can be used on chip  NV-memory technology, e.g.,</p>
    <p>Flash, has limited write durability</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 5</p>
  </div>
  <div class="page">
    <p>Single Stage D-Timer</p>
    <p>Timer</p>
    <p>Power</p>
    <p>Timer</p>
    <p>Trigger</p>
    <p>Deterministic Timer (D-Timer) will trigger at a specified number of clock cycles with probability 1</p>
    <p>Can be defeated with power cycling [7]</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 6</p>
  </div>
  <div class="page">
    <p>Single Stage D-Timer</p>
    <p>Timer</p>
    <p>Power</p>
    <p>Timer</p>
    <p>Trigger</p>
    <p>Deterministic Timer (D-Timer) will trigger at a specified number of clock cycles with probability 1</p>
    <p>Can be defeated with power cycling [7]</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 6</p>
  </div>
  <div class="page">
    <p>Single Stage D-Timer</p>
    <p>Timer</p>
    <p>Power</p>
    <p>Timer</p>
    <p>Trigger</p>
    <p>Deterministic Timer (D-Timer) will trigger at a specified number of clock cycles with probability 1</p>
    <p>Can be defeated with power cycling [7]</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 6</p>
  </div>
  <div class="page">
    <p>Single Stage D-Timer</p>
    <p>Timer</p>
    <p>Power</p>
    <p>Timer</p>
    <p>Trigger</p>
    <p>Deterministic Timer (D-Timer) will trigger at a specified number of clock cycles with probability 1</p>
    <p>Can be defeated with power cycling [7]</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 6</p>
  </div>
  <div class="page">
    <p>Single Stage D-Timer</p>
    <p>Timer</p>
    <p>Power</p>
    <p>Timer</p>
    <p>Trigger</p>
    <p>Deterministic Timer (D-Timer) will trigger at a specified number of clock cycles with probability 1</p>
    <p>Can be defeated with power cycling [7]</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 6</p>
  </div>
  <div class="page">
    <p>Single Stage D-Timer</p>
    <p>Timer</p>
    <p>Power</p>
    <p>Timer</p>
    <p>Trigger</p>
    <p>Deterministic Timer (D-Timer) will trigger at a specified number of clock cycles with probability 1</p>
    <p>Can be defeated with power cycling [7]</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 6</p>
  </div>
  <div class="page">
    <p>Single Stage D-Timer</p>
    <p>Timer</p>
    <p>Power</p>
    <p>Timer</p>
    <p>Trigger</p>
    <p>Deterministic Timer (D-Timer) will trigger at a specified number of clock cycles with probability 1</p>
    <p>Can be defeated with power cycling [7]</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 6</p>
  </div>
  <div class="page">
    <p>Single Stage D-Timer</p>
    <p>Timer</p>
    <p>Power</p>
    <p>Timer</p>
    <p>Trigger</p>
    <p>Deterministic Timer (D-Timer) will trigger at a specified number of clock cycles with probability 1</p>
    <p>Can be defeated with power cycling [7]</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 6</p>
  </div>
  <div class="page">
    <p>Single Stage D-Timer</p>
    <p>Timer</p>
    <p>Power</p>
    <p>Timer</p>
    <p>Trigger</p>
    <p>Deterministic Timer (D-Timer) will trigger at a specified number of clock cycles with probability 1</p>
    <p>Can be defeated with power cycling [7]</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 6</p>
  </div>
  <div class="page">
    <p>Single Stage D-Timer</p>
    <p>Timer</p>
    <p>Power</p>
    <p>Timer</p>
    <p>Trigger</p>
    <p>Deterministic Timer (D-Timer) will trigger at a specified number of clock cycles with probability 1</p>
    <p>Can be defeated with power cycling [7]</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 6</p>
  </div>
  <div class="page">
    <p>Single Stage D-Timer</p>
    <p>Timer</p>
    <p>Power</p>
    <p>Timer</p>
    <p>Trigger</p>
    <p>Deterministic Timer (D-Timer) will trigger at a specified number of clock cycles with probability 1</p>
    <p>Can be defeated with power cycling [7]</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 6</p>
  </div>
  <div class="page">
    <p>Single Stage D-Timer</p>
    <p>Timer</p>
    <p>Power</p>
    <p>Timer</p>
    <p>Trigger</p>
    <p>Deterministic Timer (D-Timer) will trigger at a specified number of clock cycles with probability 1</p>
    <p>Can be defeated with power cycling [7] [7] Waksman and Sethumadhavan, Silencing Hardware Backdoors</p>
    <p>IEEE Symposium on Security and Privacy</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 6</p>
  </div>
  <div class="page">
    <p>Single Stage D-Timer</p>
    <p>Timer</p>
    <p>Power</p>
    <p>Timer</p>
    <p>Trigger</p>
    <p>Deterministic Timer (D-Timer) will trigger at a specified number of clock cycles with probability 1</p>
    <p>Can be defeated with power cycling [7] [7] Waksman and Sethumadhavan, Silencing Hardware Backdoors</p>
    <p>IEEE Symposium on Security and Privacy</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 6</p>
  </div>
  <div class="page">
    <p>Single Stage D-Timer</p>
    <p>Timer</p>
    <p>Power</p>
    <p>Timer</p>
    <p>Trigger</p>
    <p>Deterministic Timer (D-Timer) will trigger at a specified number of clock cycles with probability 1</p>
    <p>Can be defeated with power cycling [7] [7] Waksman and Sethumadhavan, Silencing Hardware Backdoors</p>
    <p>IEEE Symposium on Security and Privacy</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 6</p>
  </div>
  <div class="page">
    <p>Single Stage D-Timer</p>
    <p>Timer</p>
    <p>Power</p>
    <p>Timer</p>
    <p>Trigger</p>
    <p>Deterministic Timer (D-Timer) will trigger at a specified number of clock cycles with probability 1</p>
    <p>Can be defeated with power cycling [7] [7] Waksman and Sethumadhavan, Silencing Hardware Backdoors</p>
    <p>IEEE Symposium on Security and Privacy</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 6</p>
  </div>
  <div class="page">
    <p>Single Stage D-Timer</p>
    <p>Timer</p>
    <p>Power</p>
    <p>Timer</p>
    <p>Trigger</p>
    <p>Deterministic Timer (D-Timer) will trigger at a specified number of clock cycles with probability 1</p>
    <p>Can be defeated with power cycling [7] [7] Waksman and Sethumadhavan, Silencing Hardware Backdoors</p>
    <p>IEEE Symposium on Security and Privacy</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 6</p>
  </div>
  <div class="page">
    <p>Single Stage D-Timer</p>
    <p>Timer</p>
    <p>Power</p>
    <p>Timer</p>
    <p>Trigger</p>
    <p>Deterministic Timer (D-Timer) will trigger at a specified number of clock cycles with probability 1</p>
    <p>Can be defeated with power cycling [7] [7] Waksman and Sethumadhavan, Silencing Hardware Backdoors</p>
    <p>IEEE Symposium on Security and Privacy</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 6</p>
  </div>
  <div class="page">
    <p>Single Stage D-Timer</p>
    <p>Timer</p>
    <p>Power</p>
    <p>Timer</p>
    <p>Trigger</p>
    <p>Deterministic Timer (D-Timer) will trigger at a specified number of clock cycles with probability 1</p>
    <p>Can be defeated with power cycling [7] [7] Waksman and Sethumadhavan, Silencing Hardware Backdoors</p>
    <p>IEEE Symposium on Security and Privacy</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 6</p>
  </div>
  <div class="page">
    <p>Single Stage D-Timer</p>
    <p>Timer</p>
    <p>Power</p>
    <p>Timer</p>
    <p>Trigger</p>
    <p>Deterministic Timer (D-Timer) will trigger at a specified number of clock cycles with probability 1</p>
    <p>Can be defeated with power cycling [7] [7] Waksman and Sethumadhavan, Silencing Hardware Backdoors</p>
    <p>IEEE Symposium on Security and Privacy</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 6</p>
  </div>
  <div class="page">
    <p>Single Stage D-Timer</p>
    <p>Timer</p>
    <p>Power</p>
    <p>Timer</p>
    <p>Trigger</p>
    <p>Deterministic Timer (D-Timer) will trigger at a specified number of clock cycles with probability 1</p>
    <p>Can be defeated with power cycling [7] [7] Waksman and Sethumadhavan, Silencing Hardware Backdoors</p>
    <p>IEEE Symposium on Security and Privacy</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 6</p>
  </div>
  <div class="page">
    <p>Single Stage D-Timer</p>
    <p>Timer</p>
    <p>Power</p>
    <p>Timer</p>
    <p>Trigger</p>
    <p>Deterministic Timer (D-Timer) will trigger at a specified number of clock cycles with probability 1</p>
    <p>Can be defeated with power cycling [7] [7] Waksman and Sethumadhavan, Silencing Hardware Backdoors</p>
    <p>IEEE Symposium on Security and Privacy</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 6</p>
  </div>
  <div class="page">
    <p>Single Stage D-Timer</p>
    <p>Timer</p>
    <p>Power</p>
    <p>Timer</p>
    <p>Trigger</p>
    <p>Deterministic Timer (D-Timer) will trigger at a specified number of clock cycles with probability 1</p>
    <p>Can be defeated with power cycling [7] [7] Waksman and Sethumadhavan, Silencing Hardware Backdoors</p>
    <p>IEEE Symposium on Security and Privacy</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 6</p>
  </div>
  <div class="page">
    <p>Single Stage D-Timer</p>
    <p>Timer</p>
    <p>Power</p>
    <p>Timer</p>
    <p>Trigger</p>
    <p>Deterministic Timer (D-Timer) will trigger at a specified number of clock cycles with probability 1</p>
    <p>Can be defeated with power cycling [7] [7] Waksman and Sethumadhavan, Silencing Hardware Backdoors</p>
    <p>IEEE Symposium on Security and Privacy</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 6</p>
  </div>
  <div class="page">
    <p>Single Stage D-Timer</p>
    <p>Timer</p>
    <p>Power</p>
    <p>Timer</p>
    <p>Trigger</p>
    <p>Deterministic Timer (D-Timer) will trigger at a specified number of clock cycles with probability 1</p>
    <p>Can be defeated with power cycling [7] [7] Waksman and Sethumadhavan, Silencing Hardware Backdoors</p>
    <p>IEEE Symposium on Security and Privacy</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 6</p>
  </div>
  <div class="page">
    <p>Single Stage D-Timer</p>
    <p>Timer</p>
    <p>Power</p>
    <p>Timer</p>
    <p>Trigger</p>
    <p>Deterministic Timer (D-Timer) will trigger at a specified number of clock cycles with probability 1</p>
    <p>Can be defeated with power cycling [7] [7] Waksman and Sethumadhavan, Silencing Hardware Backdoors</p>
    <p>IEEE Symposium on Security and Privacy</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 6</p>
  </div>
  <div class="page">
    <p>Single Stage D-Timer</p>
    <p>Timer</p>
    <p>Power</p>
    <p>Timer</p>
    <p>Trigger</p>
    <p>Deterministic Timer (D-Timer) will trigger at a specified number of clock cycles with probability 1</p>
    <p>Can be defeated with power cycling [7] [7] Waksman and Sethumadhavan, Silencing Hardware Backdoors</p>
    <p>IEEE Symposium on Security and Privacy</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 6</p>
  </div>
  <div class="page">
    <p>Dual Stage D-Timer</p>
    <p>V Timer 1 NV Timer 2</p>
    <p>Power</p>
    <p>Timer1</p>
    <p>Timer2 Trigger</p>
    <p>Trigger</p>
    <p>Dual stage timer stores 2nd timer in NV memory</p>
    <p>This design defeats the power cycling  Vulnerable to power cycling with period  VSW (Volatile</p>
    <p>State Window)</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 7</p>
  </div>
  <div class="page">
    <p>Dual Stage D-Timer</p>
    <p>V Timer 1 NV Timer 2</p>
    <p>Power</p>
    <p>Timer1</p>
    <p>Timer2 Trigger</p>
    <p>Trigger</p>
    <p>Dual stage timer stores 2nd timer in NV memory</p>
    <p>This design defeats the power cycling  Vulnerable to power cycling with period  VSW (Volatile</p>
    <p>State Window)</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 7</p>
  </div>
  <div class="page">
    <p>Dual Stage D-Timer</p>
    <p>V Timer 1 NV Timer 2</p>
    <p>Power</p>
    <p>Timer1</p>
    <p>Timer2 Trigger</p>
    <p>Trigger</p>
    <p>Dual stage timer stores 2nd timer in NV memory</p>
    <p>This design defeats the power cycling  Vulnerable to power cycling with period  VSW (Volatile</p>
    <p>State Window)</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 7</p>
  </div>
  <div class="page">
    <p>Dual Stage D-Timer</p>
    <p>V Timer 1 NV Timer 2</p>
    <p>Power</p>
    <p>Timer1</p>
    <p>Timer2 Trigger</p>
    <p>Trigger</p>
    <p>Dual stage timer stores 2nd timer in NV memory</p>
    <p>This design defeats the power cycling  Vulnerable to power cycling with period  VSW (Volatile</p>
    <p>State Window)</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 7</p>
  </div>
  <div class="page">
    <p>Dual Stage D-Timer</p>
    <p>V Timer 1 NV Timer 2</p>
    <p>Power</p>
    <p>Timer1</p>
    <p>Timer2 Trigger</p>
    <p>Trigger</p>
    <p>Dual stage timer stores 2nd timer in NV memory</p>
    <p>This design defeats the power cycling  Vulnerable to power cycling with period  VSW (Volatile</p>
    <p>State Window)</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 7</p>
  </div>
  <div class="page">
    <p>Dual Stage D-Timer</p>
    <p>V Timer 1 NV Timer 2</p>
    <p>Power</p>
    <p>Timer1</p>
    <p>Timer2 Trigger</p>
    <p>Trigger</p>
    <p>Dual stage timer stores 2nd timer in NV memory</p>
    <p>This design defeats the power cycling  Vulnerable to power cycling with period  VSW (Volatile</p>
    <p>State Window)</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 7</p>
  </div>
  <div class="page">
    <p>Dual Stage D-Timer</p>
    <p>V Timer 1 NV Timer 2</p>
    <p>Power</p>
    <p>Timer1</p>
    <p>Timer2 Trigger</p>
    <p>Trigger</p>
    <p>Dual stage timer stores 2nd timer in NV memory</p>
    <p>This design defeats the power cycling  Vulnerable to power cycling with period  VSW (Volatile</p>
    <p>State Window)</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 7</p>
  </div>
  <div class="page">
    <p>Dual Stage D-Timer</p>
    <p>V Timer 1 NV Timer 2</p>
    <p>Power</p>
    <p>Timer1</p>
    <p>Timer2 Trigger</p>
    <p>Trigger</p>
    <p>Dual stage timer stores 2nd timer in NV memory</p>
    <p>This design defeats the power cycling  Vulnerable to power cycling with period  VSW (Volatile</p>
    <p>State Window)</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 7</p>
  </div>
  <div class="page">
    <p>Dual Stage D-Timer</p>
    <p>V Timer 1 NV Timer 2</p>
    <p>Power</p>
    <p>Timer1</p>
    <p>Timer2 Trigger</p>
    <p>Trigger</p>
    <p>Dual stage timer stores 2nd timer in NV memory</p>
    <p>This design defeats the power cycling  Vulnerable to power cycling with period  VSW (Volatile</p>
    <p>State Window)</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 7</p>
  </div>
  <div class="page">
    <p>Dual Stage D-Timer</p>
    <p>V Timer 1 NV Timer 2</p>
    <p>Power</p>
    <p>Timer1</p>
    <p>Timer2 Trigger</p>
    <p>Trigger</p>
    <p>Dual stage timer stores 2nd timer in NV memory</p>
    <p>This design defeats the power cycling  Vulnerable to power cycling with period  VSW (Volatile</p>
    <p>State Window)</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 7</p>
  </div>
  <div class="page">
    <p>Dual Stage D-Timer</p>
    <p>V Timer 1 NV Timer 2</p>
    <p>Power</p>
    <p>Timer1</p>
    <p>Timer2 Trigger</p>
    <p>Trigger</p>
    <p>Dual stage timer stores 2nd timer in NV memory</p>
    <p>This design defeats the power cycling  Vulnerable to power cycling with period  VSW (Volatile</p>
    <p>State Window)</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 7</p>
  </div>
  <div class="page">
    <p>Dual Stage D-Timer</p>
    <p>V Timer 1 NV Timer 2</p>
    <p>Power</p>
    <p>Timer1</p>
    <p>Timer2 Trigger</p>
    <p>Trigger</p>
    <p>Dual stage timer stores 2nd timer in NV memory</p>
    <p>This design defeats the power cycling  Vulnerable to power cycling with period  VSW (Volatile</p>
    <p>State Window)</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 7</p>
  </div>
  <div class="page">
    <p>Dual Stage D-Timer</p>
    <p>V Timer 1 NV Timer 2</p>
    <p>Power</p>
    <p>Timer1</p>
    <p>Timer2 Trigger</p>
    <p>Trigger</p>
    <p>Dual stage timer stores 2nd timer in NV memory</p>
    <p>This design defeats the power cycling  Vulnerable to power cycling with period  VSW (Volatile</p>
    <p>State Window)</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 7</p>
  </div>
  <div class="page">
    <p>Dual Stage D-Timer</p>
    <p>V Timer 1 NV Timer 2</p>
    <p>Power</p>
    <p>Timer1</p>
    <p>Timer2 Trigger</p>
    <p>Trigger</p>
    <p>Dual stage timer stores 2nd timer in NV memory</p>
    <p>This design defeats the power cycling  Vulnerable to power cycling with period  VSW (Volatile</p>
    <p>State Window)</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 7</p>
  </div>
  <div class="page">
    <p>Dual Stage D-Timer</p>
    <p>V Timer 1 NV Timer 2</p>
    <p>Power</p>
    <p>Timer1</p>
    <p>Timer2 Trigger</p>
    <p>Trigger</p>
    <p>Dual stage timer stores 2nd timer in NV memory</p>
    <p>This design defeats the power cycling  Vulnerable to power cycling with period  VSW (Volatile</p>
    <p>State Window)</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 7</p>
  </div>
  <div class="page">
    <p>Dual Stage D-Timer</p>
    <p>V Timer 1 NV Timer 2</p>
    <p>Power</p>
    <p>Timer1</p>
    <p>Timer2 Trigger</p>
    <p>Trigger</p>
    <p>Dual stage timer stores 2nd timer in NV memory</p>
    <p>This design defeats the power cycling  Vulnerable to power cycling with period  VSW (Volatile</p>
    <p>State Window)</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 7</p>
  </div>
  <div class="page">
    <p>Dual Stage D-Timer</p>
    <p>V Timer 1 NV Timer 2</p>
    <p>Power</p>
    <p>Timer1</p>
    <p>Timer2 Trigger</p>
    <p>Trigger</p>
    <p>Dual stage timer stores 2nd timer in NV memory</p>
    <p>This design defeats the power cycling  Vulnerable to power cycling with period  VSW (Volatile</p>
    <p>State Window)</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 7</p>
  </div>
  <div class="page">
    <p>Dual Stage D-Timer</p>
    <p>V Timer 1 NV Timer 2</p>
    <p>Power</p>
    <p>Timer1</p>
    <p>Timer2 Trigger</p>
    <p>Trigger</p>
    <p>Dual stage timer stores 2nd timer in NV memory</p>
    <p>This design defeats the power cycling  Vulnerable to power cycling with period  VSW (Volatile</p>
    <p>State Window)</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 7</p>
  </div>
  <div class="page">
    <p>Dual Stage D-Timer</p>
    <p>V Timer 1 NV Timer 2</p>
    <p>Power</p>
    <p>Timer1</p>
    <p>Timer2 Trigger</p>
    <p>Trigger</p>
    <p>Dual stage timer stores 2nd timer in NV memory</p>
    <p>This design defeats the power cycling  Vulnerable to power cycling with period  VSW (Volatile</p>
    <p>State Window)</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 7</p>
  </div>
  <div class="page">
    <p>Dual Stage D-Timer</p>
    <p>V Timer 1 NV Timer 2</p>
    <p>Power</p>
    <p>Timer1</p>
    <p>Timer2 Trigger</p>
    <p>Trigger</p>
    <p>Dual stage timer stores 2nd timer in NV memory  This design defeats the power cycling</p>
    <p>Vulnerable to power cycling with period  VSW (Volatile State Window)</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 7</p>
  </div>
  <div class="page">
    <p>Dual Stage D-Timer</p>
    <p>V Timer 1 NV Timer 2</p>
    <p>Power</p>
    <p>Timer1</p>
    <p>Timer2 Trigger</p>
    <p>Trigger</p>
    <p>Dual stage timer stores 2nd timer in NV memory  This design defeats the power cycling</p>
    <p>Vulnerable to power cycling with period  VSW (Volatile State Window)</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 7</p>
  </div>
  <div class="page">
    <p>Dual Stage D-Timer</p>
    <p>V Timer 1 NV Timer 2</p>
    <p>Power</p>
    <p>Timer1</p>
    <p>Timer2 Trigger</p>
    <p>Trigger</p>
    <p>VSW</p>
    <p>Dual stage timer stores 2nd timer in NV memory  This design defeats the power cycling  Vulnerable to power cycling with period  VSW (Volatile</p>
    <p>State Window)</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 7</p>
  </div>
  <div class="page">
    <p>Deterministic Timer Drawbacks</p>
    <p>Dual Stage D-Timers require frequent writes to NV. Given a write durability w and a timer that counts up to k we need m  k</p>
    <p>w bits.</p>
    <p>A one year timer:</p>
    <p>VSW = 1 second  m  3153 NV-bits</p>
    <p>VSW = 52 minutes  m = 14 NV-bits</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 8</p>
  </div>
  <div class="page">
    <p>ND-Timers</p>
    <p>Clock Jitter Ring Oscillators Sampling</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 9</p>
  </div>
  <div class="page">
    <p>Single Shot Timer</p>
    <p>Rand X</p>
    <p>Power</p>
    <p>Rand X</p>
    <p>Trigger</p>
    <p>Not easy to control  Chance of early detection  Large Variance</p>
    <p>Small VSW</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 10</p>
  </div>
  <div class="page">
    <p>Single Shot Timer</p>
    <p>Rand X</p>
    <p>Power</p>
    <p>Rand X</p>
    <p>Trigger</p>
    <p>Not easy to control  Chance of early detection  Large Variance</p>
    <p>Small VSW</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 10</p>
  </div>
  <div class="page">
    <p>Single Shot Timer</p>
    <p>Rand X</p>
    <p>Power</p>
    <p>Rand X</p>
    <p>Trigger</p>
    <p>Not easy to control  Chance of early detection  Large Variance</p>
    <p>Small VSW</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 10</p>
  </div>
  <div class="page">
    <p>Single Shot Timer</p>
    <p>Rand X</p>
    <p>Power</p>
    <p>Rand X</p>
    <p>Trigger</p>
    <p>Not easy to control  Chance of early detection  Large Variance</p>
    <p>Small VSW</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 10</p>
  </div>
  <div class="page">
    <p>Single Shot Timer</p>
    <p>Rand X</p>
    <p>Power</p>
    <p>Rand X</p>
    <p>Trigger</p>
    <p>Not easy to control  Chance of early detection  Large Variance</p>
    <p>Small VSW</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 10</p>
  </div>
  <div class="page">
    <p>Single Shot Timer</p>
    <p>Rand X</p>
    <p>Power</p>
    <p>Rand X</p>
    <p>Trigger</p>
    <p>Not easy to control  Chance of early detection  Large Variance</p>
    <p>Small VSW</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 10</p>
  </div>
  <div class="page">
    <p>Single Shot Timer</p>
    <p>Rand X</p>
    <p>Power</p>
    <p>Rand X</p>
    <p>Trigger</p>
    <p>Not easy to control  Chance of early detection  Large Variance</p>
    <p>Small VSW</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 10</p>
  </div>
  <div class="page">
    <p>Single Shot Timer</p>
    <p>Rand X</p>
    <p>Power</p>
    <p>Rand X</p>
    <p>Trigger</p>
    <p>Not easy to control  Chance of early detection  Large Variance</p>
    <p>Small VSW</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 10</p>
  </div>
  <div class="page">
    <p>Single Shot Timer</p>
    <p>Rand X</p>
    <p>Power</p>
    <p>Rand X</p>
    <p>Trigger</p>
    <p>VSW</p>
    <p>Not easy to control  Chance of early detection  Large Variance  Small VSW</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 10</p>
  </div>
  <div class="page">
    <p>Statistical Comparison</p>
    <p>Early Expected Late D-Timer 0% 100% 0% SS-Timer 39% 39% 22%</p>
    <p>Early LateExpected</p>
    <p>(a) PMFs</p>
    <p>(b) CDFs</p>
    <p>Figure: The ND-Timer1 was designed with an expectation of 1000. The corresponding deterministic timer is shown for comparison.</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 11</p>
  </div>
  <div class="page">
    <p>ND-Timer: Counts k Independent Random Events</p>
    <p>Rand X NV Timer</p>
    <p>Power</p>
    <p>Rand X</p>
    <p>Timer Trigger</p>
    <p>Trigger</p>
    <p>Controllable  Small Variance</p>
    <p>Small VSW</p>
    <p>+ + + =</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 12</p>
  </div>
  <div class="page">
    <p>ND-Timer: Counts k Independent Random Events</p>
    <p>Rand X NV Timer</p>
    <p>Power</p>
    <p>Rand X</p>
    <p>Timer Trigger</p>
    <p>Trigger</p>
    <p>Controllable  Small Variance</p>
    <p>Small VSW</p>
    <p>+ + + =</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 12</p>
  </div>
  <div class="page">
    <p>ND-Timer: Counts k Independent Random Events</p>
    <p>Rand X NV Timer</p>
    <p>Power</p>
    <p>Rand X</p>
    <p>Timer Trigger</p>
    <p>Trigger</p>
    <p>Controllable  Small Variance</p>
    <p>Small VSW</p>
    <p>+ + + =</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 12</p>
  </div>
  <div class="page">
    <p>ND-Timer: Counts k Independent Random Events</p>
    <p>Rand X NV Timer</p>
    <p>Power</p>
    <p>Rand X</p>
    <p>Timer Trigger</p>
    <p>Trigger</p>
    <p>Controllable  Small Variance</p>
    <p>Small VSW</p>
    <p>+ + + =</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 12</p>
  </div>
  <div class="page">
    <p>ND-Timer: Counts k Independent Random Events</p>
    <p>Rand X NV Timer</p>
    <p>Power</p>
    <p>Rand X</p>
    <p>Timer Trigger</p>
    <p>Trigger</p>
    <p>Controllable  Small Variance</p>
    <p>Small VSW</p>
    <p>+ + + =</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 12</p>
  </div>
  <div class="page">
    <p>ND-Timer: Counts k Independent Random Events</p>
    <p>Rand X NV Timer</p>
    <p>Power</p>
    <p>Rand X</p>
    <p>Timer Trigger</p>
    <p>Trigger</p>
    <p>Controllable  Small Variance</p>
    <p>Small VSW</p>
    <p>+ + + =</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 12</p>
  </div>
  <div class="page">
    <p>ND-Timer: Counts k Independent Random Events</p>
    <p>Rand X NV Timer</p>
    <p>Power</p>
    <p>Rand X</p>
    <p>Timer Trigger</p>
    <p>Trigger</p>
    <p>Controllable  Small Variance</p>
    <p>Small VSW</p>
    <p>+ + + =</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 12</p>
  </div>
  <div class="page">
    <p>ND-Timer: Counts k Independent Random Events</p>
    <p>Rand X NV Timer</p>
    <p>Power</p>
    <p>Rand X</p>
    <p>Timer Trigger</p>
    <p>Trigger</p>
    <p>Controllable  Small Variance</p>
    <p>Small VSW</p>
    <p>+ + + =</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 12</p>
  </div>
  <div class="page">
    <p>ND-Timer: Counts k Independent Random Events</p>
    <p>Rand X NV Timer</p>
    <p>Power</p>
    <p>Rand X</p>
    <p>Timer Trigger</p>
    <p>Trigger</p>
    <p>Controllable  Small Variance</p>
    <p>Small VSW</p>
    <p>+ + + =</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 12</p>
  </div>
  <div class="page">
    <p>ND-Timer: Counts k Independent Random Events</p>
    <p>Rand X NV Timer</p>
    <p>Power</p>
    <p>Rand X</p>
    <p>Timer Trigger</p>
    <p>Trigger</p>
    <p>Controllable  Small Variance</p>
    <p>Small VSW</p>
    <p>+ + + =</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 12</p>
  </div>
  <div class="page">
    <p>ND-Timer: Counts k Independent Random Events</p>
    <p>Rand X NV Timer</p>
    <p>Power</p>
    <p>Rand X</p>
    <p>Timer Trigger</p>
    <p>Trigger</p>
    <p>Controllable  Small Variance</p>
    <p>Small VSW</p>
    <p>+ + + =</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 12</p>
  </div>
  <div class="page">
    <p>ND-Timer: Counts k Independent Random Events</p>
    <p>Rand X NV Timer</p>
    <p>Power</p>
    <p>Rand X</p>
    <p>Timer Trigger</p>
    <p>Trigger</p>
    <p>Controllable  Small Variance</p>
    <p>Small VSW</p>
    <p>+ + + =</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 12</p>
  </div>
  <div class="page">
    <p>ND-Timer: Counts k Independent Random Events</p>
    <p>Rand X NV Timer</p>
    <p>Power</p>
    <p>Rand X</p>
    <p>Timer Trigger</p>
    <p>Trigger</p>
    <p>Controllable  Small Variance</p>
    <p>Small VSW</p>
    <p>+ + + =</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 12</p>
  </div>
  <div class="page">
    <p>ND-Timer: Counts k Independent Random Events</p>
    <p>Rand X NV Timer</p>
    <p>Power</p>
    <p>Rand X</p>
    <p>Timer Trigger</p>
    <p>Trigger</p>
    <p>Controllable  Small Variance</p>
    <p>Small VSW</p>
    <p>+ + + =</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 12</p>
  </div>
  <div class="page">
    <p>ND-Timer: Counts k Independent Random Events</p>
    <p>Rand X NV Timer</p>
    <p>Power</p>
    <p>Rand X</p>
    <p>Timer Trigger</p>
    <p>Trigger</p>
    <p>Controllable  Small Variance</p>
    <p>Small VSW</p>
    <p>+ + + =</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 12</p>
  </div>
  <div class="page">
    <p>ND-Timer: Counts k Independent Random Events</p>
    <p>Rand X NV Timer</p>
    <p>Power</p>
    <p>Rand X</p>
    <p>Timer Trigger</p>
    <p>Trigger</p>
    <p>Controllable  Small Variance</p>
    <p>Small VSW</p>
    <p>+ + + =</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 12</p>
  </div>
  <div class="page">
    <p>ND-Timer: Counts k Independent Random Events</p>
    <p>Rand X NV Timer</p>
    <p>Power</p>
    <p>Rand X</p>
    <p>Timer Trigger</p>
    <p>Trigger</p>
    <p>Controllable  Small Variance</p>
    <p>Small VSW</p>
    <p>+ + + =</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 12</p>
  </div>
  <div class="page">
    <p>ND-Timer: Counts k Independent Random Events</p>
    <p>Rand X NV Timer</p>
    <p>Power</p>
    <p>Rand X</p>
    <p>Timer Trigger</p>
    <p>Trigger</p>
    <p>Controllable  Small Variance</p>
    <p>Small VSW</p>
    <p>+ + + =</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 12</p>
  </div>
  <div class="page">
    <p>ND-Timer: Counts k Independent Random Events</p>
    <p>Rand X NV Timer</p>
    <p>Power</p>
    <p>Rand X</p>
    <p>Timer Trigger</p>
    <p>Trigger</p>
    <p>Controllable  Small Variance</p>
    <p>Small VSW</p>
    <p>+ + + =</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 12</p>
  </div>
  <div class="page">
    <p>ND-Timer: Counts k Independent Random Events</p>
    <p>Rand X NV Timer</p>
    <p>Power</p>
    <p>Rand X</p>
    <p>Timer Trigger</p>
    <p>Trigger</p>
    <p>Controllable  Small Variance</p>
    <p>Small VSW</p>
    <p>+ + + =</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 12</p>
  </div>
  <div class="page">
    <p>ND-Timer: Counts k Independent Random Events</p>
    <p>Rand X NV Timer</p>
    <p>Power</p>
    <p>Rand X</p>
    <p>Timer Trigger</p>
    <p>Trigger</p>
    <p>Controllable  Small Variance</p>
    <p>Small VSW</p>
    <p>+ + + =</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 12</p>
  </div>
  <div class="page">
    <p>ND-Timer: Counts k Independent Random Events</p>
    <p>Rand X NV Timer</p>
    <p>Power</p>
    <p>Rand X</p>
    <p>Timer Trigger</p>
    <p>Trigger</p>
    <p>VSW</p>
    <p>Controllable  Small Variance  Small VSW</p>
    <p>+ + + =</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 12</p>
  </div>
  <div class="page">
    <p>Comparison</p>
    <p>Early Expected Late D-Timer 0% 100% 0% SS-Timer 39% 39% 22% ND-Timer 1.8e-9% 100% 2.22e-4%</p>
    <p>Early LateExpected</p>
    <p>(a) PMFs</p>
    <p>(b) CDFs</p>
    <p>Figure: The ND-Timer was designed with an expectation of 1000. The corresponding deterministic timer and single event is shown for comparison.</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 13</p>
  </div>
  <div class="page">
    <p>Benefits of the ND-Timer</p>
    <p>ND-timers break the trade-off between size of NV-memory and susceptibility to periodic power cycling.</p>
    <p>Accuracy E(N) = k p</p>
    <p>Precision  E(N)</p>
    <p>= 1 k</p>
    <p>D-Timer01 D-Timer02 ND-Timer</p>
    <p>Expected Trigger 1y 1y 1y 99% Confidence Interval 0m 0m 12d VSW 52m 27.6s 27.6s NV-Bits 14 114Mbits 14</p>
    <p>Table: Performance and resource comparison of each timers.</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 14</p>
  </div>
  <div class="page">
    <p>TRNG</p>
    <p>Clock Jitter Ring Oscillators Sampling</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 15</p>
  </div>
  <div class="page">
    <p>TRNG</p>
    <p>The generation of random numbers is too important to be left to chance.</p>
    <p>Robert R. Coveyou</p>
    <p>True random sources exist in the physical world Temperature Timing Power . . .</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 16</p>
  </div>
  <div class="page">
    <p>Clock Jitter</p>
    <p>Clock jitter contains true unbiased randomness [1]</p>
    <p>Easy to construct (minimum of 3 gates)</p>
    <p>Time</p>
    <p>Voltage</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 17</p>
  </div>
  <div class="page">
    <p>Sampling</p>
    <p>Sample ROs with a slower clock to allow for multiple separate transitions.</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 18</p>
  </div>
  <div class="page">
    <p>Ring Oscillators</p>
    <p>Use multiple ROs to fill the time spectrum with transitions. Down sample results 1024 times to remove bias and ensure true randomness. [8]</p>
    <p>clock</p>
    <p>clock</p>
    <p>clock</p>
    <p>Decimate 1024 times</p>
    <p>Sample and reset every 1024 cyclesclock</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 19</p>
  </div>
  <div class="page">
    <p>Summary</p>
    <p>16 ROs  80 gates  1 bit/1024 cycles  Passes NIST</p>
    <p>clock</p>
    <p>clock</p>
    <p>clock</p>
    <p>Decimate 1024 times</p>
    <p>Sample and reset every 1024 cyclesclock</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 20</p>
  </div>
  <div class="page">
    <p>Results</p>
    <p>Clock Jitter Ring Oscillators Sampling</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 21</p>
  </div>
  <div class="page">
    <p>Hardware</p>
    <p>Experimental Hardware Setup:</p>
    <p>Altera DE4 development board  Simulated power cycling and NV memory  Two different 24h timer experiments  Each experiment repeated 15 times  Both experimental trials passed the 2</p>
    <p>test for expected distributions.</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 22</p>
  </div>
  <div class="page">
    <p>P ro</p>
    <p>ba bi</p>
    <p>lit y</p>
    <p>Time (s)</p>
    <p>Figure: Measured and predicted CDFs for the two 24 hour triggers. Trigger one (red) has a standard deviation of 2.84 minutes, while trigger two (blue) the other has a standard deviation of 16 minutes.</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 23</p>
  </div>
  <div class="page">
    <p>Detection</p>
    <p>Clock Jitter Ring Oscillators Sampling</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 24</p>
  </div>
  <div class="page">
    <p>Hardware Resource Identification</p>
    <p>Cheat Code (Simple)</p>
    <p>Cheat Code (Seq)</p>
    <p>D-timer</p>
    <p>ND-timer</p>
    <p>O ve</p>
    <p>rh ea</p>
    <p>d %</p>
    <p>Logic Elements</p>
    <p>Cheat Code (Simple)</p>
    <p>Cheat Code (Seq)</p>
    <p>D-timer</p>
    <p>ND-timer</p>
    <p>Registers</p>
    <p>Cheat Code (Simple)</p>
    <p>Cheat Code (Seq)</p>
    <p>D-timer</p>
    <p>ND-timer</p>
    <p>Non volatile bits</p>
    <p>Figure: Hardware overhead comparison for two data trigger and two timer attacks. Black represents the amount used by the trigger and grey represents the amount used by the Trojan.</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 25</p>
  </div>
  <div class="page">
    <p>Simulation: Does not have randomness!</p>
    <p>clk</p>
    <p>rand_bit</p>
    <p>ring00 ring01 ring03 ring04</p>
    <p>reg00 reg01 reg02 reg03</p>
    <p>Figure: A simulation results from Modelsim shown in the top diagram for ND-timer. Bottom diagram shows a typical pattern for rand bit gathered from FPGA.</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 26</p>
  </div>
  <div class="page">
    <p>Logic Analysis: Unused Circuit Identification</p>
    <p>UCI &amp; FANCI:</p>
    <p>Looks for unused or nearly unused logic (circuitry).  Redundant circuitry could be replaced with a wire.  Flagged as suspicious.</p>
    <p>Known methods to defeat UCI [6] and FANCI [9].</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 27</p>
  </div>
  <div class="page">
    <p>Logic Analysis: Unused Circuit Identification</p>
    <p>UCI &amp; FANCI:</p>
    <p>Looks for unused or nearly unused logic (circuitry).  Redundant circuitry could be replaced with a wire.  Flagged as suspicious.  Known methods to defeat UCI [6] and FANCI [9].</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 27</p>
  </div>
  <div class="page">
    <p>Summary</p>
    <p>ND-Timers:</p>
    <p>Defeat power cycling defences.  Use less resources than D-Timers.  Controllable.  Do not simulate.</p>
    <p>MIPS 00000-00-001</p>
    <p>BUG!</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 28</p>
  </div>
  <div class="page">
    <p>References I</p>
    <p>[1] B.J. Abcunas. Evaluation of random number generators on FPGAs. PhD thesis, WORCESTER POLYTECHNIC INSTITUTE, 2004.</p>
    <p>[2] Alex Baumgarten, Michael Steffen, Matthew Clausman, and Joseph Zambreno. A case study in hardware trojan design and implementation. International Journal of Information Security, 10(1):114, 2011.</p>
    <p>[3] Yier Jin, Nathan Kupp, and Yiorgos Makris. Experiences in hardware trojan design and implementation. In Hardware-Oriented Security and Trust, 2009. HOST09. IEEE International Workshop on, pages 5057. IEEE, 2009.</p>
    <p>[4] Justin Rilling, David Graziano, Jamin Hitchcock, Tim Meyer, Xinying Wang, Phillip Jones, and Joseph Zambreno. Circumventing a ring oscillator approach to fpga-based hardware trojan detection. In Computer Design (ICCD), 2011 IEEE 29th International Conference on, pages 289292. IEEE, 2011.</p>
    <p>[5] S. Skorobogatov and C. Woods. Breakthrough silicon scanning discovers backdoor in military chip. Cryptographic Hardware and Embedded SystemsCHES 2012, pages 2340, 2012.</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 29</p>
  </div>
  <div class="page">
    <p>References II</p>
    <p>[6] C. Sturton, M. Hicks, D. Wagner, and S.T. King. Defeating uci: Building stealthy and malicious hardware. In IEEE Symposium on Security and Privacy, pages 6477, 2011.</p>
    <p>[7] A. Waksman and S. Sethumadhavan. Silencing hardware backdoors. In IEEE Symposium on Security and Privacy, pages 4963, 2011.</p>
    <p>[8] K. Wold and C.H. Tan. Analysis and enhancement of random number generator in fpga based on oscillator rings. International Journal of Reconfigurable Computing, 2009:4, 2009.</p>
    <p>[9] Jie Zhang, Feng Yuan, and Qiang Xu. Detrust: Defeating hardware trust verification with stealthy implicitly-triggered hardware trojans. In Proceedings of the 2014 ACM SIGSAC Conference on Computer and Communications Security, pages 153166. ACM, 2014.</p>
    <p>Frank Imeson (University of Waterloo) Non-deterministic Timer Based Attacks on Computer Hardware 30</p>
  </div>
</Presentation>
