<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Stable and Practical AS Relationship Inference with ProbLink</p>
    <p>Yuchen Jin1 , Colin Scott2, Amogh Dhamdhere3, Vasileios Giotsas4, Arvind Krishnamurthy1, Scott Shenker2</p>
  </div>
  <div class="page">
    <p>AS 1</p>
    <p>AS 2</p>
    <p>AS 3</p>
    <p>AS 4</p>
    <p>AS5</p>
    <p>Autonomous System (AS) and BGP</p>
    <p>ASes: Google Comcast UW</p>
  </div>
  <div class="page">
    <p>AS 1</p>
    <p>AS 2</p>
    <p>AS 3</p>
    <p>AS 4</p>
    <p>AS5</p>
    <p>Customer-to-provider (Cust-Prov) Customer AS pays the provider AS for transit Peer-to-peer (Peer-Peer) Settlement free</p>
    <p>$$$</p>
    <p>Customer</p>
    <p>Provider</p>
    <p>Peering</p>
    <p>AS Relationships</p>
    <p>ASes keep relationships confidential!</p>
  </div>
  <div class="page">
    <p>AS relationship inference application domains  Understanding Internet evolution  Identifying malicious ASes  Detecting network congestion</p>
    <p>Motivation</p>
    <p>A research problem which has been studied for ~2 decades  Gao (2001)  Subramanian et al. (2002)  Di Battista et al. (2003)  Dimitropoulos et al. (2007)  AS-Rank (2013)</p>
    <p>How does AS-Rank perform for actual applications?</p>
  </div>
  <div class="page">
    <p>AS 15169 Google</p>
    <p>AS 3491 PCCW</p>
    <p>AS 23947 Moratel</p>
    <p>AS Path: 23947, 15169 Prefix: 8.8.8.0/24</p>
    <p>AS Path: 3491, 15169 Prefix: 8.8.8.0/24</p>
    <p>On November 5, 2012, Googles services cannot be accessible in Asia for half an hour.</p>
    <p>Peer-Peer</p>
    <p>Peer-Peer</p>
    <p>AS Path: 15169 Prefix: 8.8.8.0/24</p>
    <p>AS Path: 3491, 23947, 15169 Prefix: 8.8.8.0/24</p>
    <p>Case Study: Route Leak Detection</p>
    <p>Customer</p>
    <p>Provider</p>
    <p>Data Data</p>
    <p>AS Path: 23947, 15169 Prefix: 8.8.8.0/24</p>
  </div>
  <div class="page">
    <p>Valley-free assumption: Path consists of Cust-Prov links, followed by zero or one Peer-Peer link, followed by Prov-Cust links. (uphill  cross  downhill)</p>
    <p>Valley-free violation:</p>
    <p>Prov-Cust</p>
    <p>Peer-Peer</p>
    <p>Case Study: Route Leak Detection</p>
    <p>Google</p>
    <p>Moratel</p>
    <p>PCCW</p>
    <p>Valley-free:</p>
    <p>Peer-Peer</p>
    <p>Cust-Prov</p>
    <p>A</p>
    <p>B C</p>
  </div>
  <div class="page">
    <p>Route Leak Detection</p>
    <p>AS relationship validation dataset:  relationships encoded using the Community attribute in</p>
    <p>BGP paths o E.g., AS209 (CenturyLink) uses the Community 13570 to tag</p>
    <p>routes received from customers</p>
    <p>Detection method: Check valley-free violations</p>
  </div>
  <div class="page">
    <p>Detect route leaks using AS-Rank:  Low precision: only 20% of the route leaks detected</p>
    <p>using AS-Rank were real route leaks  Low recall: 78% of the real leaks were missed</p>
    <p>Route Leak Detection Using AS-Rank</p>
  </div>
  <div class="page">
    <p>Outline  AS-Rank does not meet the demands of actual applications.</p>
    <p>We develop a simple inference algorithm CoreToLeaf that achieves accuracy comparable to AS-Rank.  Most links in the validation dataset are relatively easy to infer.</p>
    <p>We identify different subsets of the validation dataset that are hard to infer.</p>
    <p>We develop ProbLink - a probabilistic AS relationship inference algorithm.</p>
    <p>Evaluation 9</p>
  </div>
  <div class="page">
    <p>A Simple Algorithm: CoreToLeaf</p>
    <p>A 3356B C D Cust-Prov</p>
    <p>E 209F D C</p>
    <p>BGP path1</p>
    <p>BGP path2</p>
    <p>Conflict can occur!</p>
    <p>Prov-Cust</p>
    <p>Cust-Prov Prov-Cust</p>
    <p>Tier-1</p>
  </div>
  <div class="page">
    <p>CoreToLeaf vs. AS-Rank</p>
    <p>Algorithm</p>
    <p>Validation dataset Conflict (%)</p>
    <p>Route Leak Detection</p>
    <p>Precision Recall Precision Recall (%) (%) (%) (%)</p>
    <p>CoreToLeaf 97.0 97.3 0.12 19.8 22.1 AS-Rank 98.4 98.6 0 8.1 5.6</p>
    <p>Implications:</p>
    <p>April 1st, 2017</p>
  </div>
  <div class="page">
    <p>Extract Hard Links</p>
    <p>Category CoreToLeaf</p>
    <p>error (%) AS-Rank error (%)</p>
    <p>Max node degree &lt; 100 13.7 8.6 Observed by 50-100 VPs 4.7 9.3</p>
    <p>Non-VP &amp; Non-Tier1 5.3 9.0 Unlabeled Stub-clique 95.5 33.4</p>
    <p>Conflict 100 8.1</p>
    <p>Use gradient boosting decision tree to calculate feature importance</p>
    <p>April 1st, 2017</p>
    <p>Fraction of hard links in the validation dataset are 3X fewer than that in the overall links</p>
    <p>The validation dataset is skewed to easy links 12</p>
  </div>
  <div class="page">
    <p>Outline  AS-Rank does not meet the demands of actual applications.</p>
    <p>We develop a simple inference algorithm CoreToLeaf that achieves accuracy comparable to AS-Rank.  Most links in the validation dataset are relatively easy to infer.</p>
    <p>We identify different subsets of the validation dataset that are hard to infer.</p>
    <p>We develop ProbLink - a probabilistic AS relationship inference algorithm.</p>
    <p>Evaluation 13</p>
  </div>
  <div class="page">
    <p>Feature Design</p>
    <p>(A) The structure of paths that use the link</p>
    <p>(B) The structure of paths that do not use the link</p>
    <p>(C) Connectivity properties of the link</p>
  </div>
  <div class="page">
    <p>Triplet Feature Intuition: Most triplets are valley-free compliant, but we should tolerate some valleys.  Likelihood of valleys is derived from data</p>
    <p>Definition: Attribute probabilistic values for the relationships of the first and the last links given the relationship of the middle link  P(t1, t3|t2)</p>
    <p>A CB D</p>
    <p>t1 t2 t3</p>
    <p>t  {Cust-Prov, Prov-Cust, Peer-Peer}</p>
  </div>
  <div class="page">
    <p>X</p>
    <p>B C</p>
    <p>Prov-CustY</p>
    <p>Z</p>
    <p>No path contains:  X-B-C  Y-B-C  Z-B-C</p>
    <p>Non-path Feature Intuition: If none of the Peer-Peer/Prov-Cust links coming into an AS are followed by a specific link, then the link is likely not a Prov-Cust link. Definition: Attribute probabilistic values for the number of previous PeerPeer/Prov-Cust links given the relationship of the next link.  P(# Peer-Peer + # Prov-Cust | t)</p>
    <p>t Peer-Peer</p>
  </div>
  <div class="page">
    <p>Distance to clique feature: P(dist(AS1), dist(AS2) | t) Intuition: - High-tier ASes are closer to clique ASes than low-tier ASes - Peer-Peer links are typically between the ASes in the same tier</p>
    <p>Vantage point feature: P(# VPs observing AS1 -- AS2| t) Intuition: Prov-Cust links are more likely to be seen by more VPs</p>
    <p>Co-located IXP and co-located peering facility feature: (extracted from PeeringDB) P(# IXPs/facilities| t)</p>
    <p>Intuition: The more IXPs or facilities two ASes are co-located in, the more likely they are peering with each other</p>
    <p>Connectivity Features</p>
    <p>AS1 AS2 t</p>
  </div>
  <div class="page">
    <p>Use CoreToLeaf to come up with an initial labeling Repeat:  Compute the conditional probability distribution of</p>
    <p>each feature based on current labels  E.g., P(# VPs observing a link| t)</p>
    <p>Predict new label for each link using Nave Bayes and conditional probability distributions</p>
    <p>Stop upon convergence</p>
    <p>ProbLink Algorithm</p>
  </div>
  <div class="page">
    <p>Outline  AS-Rank does not meet the demands of actual applications.</p>
    <p>We develop a simple inference algorithm CoreToLeaf that achieves accuracy comparable to AS-Rank.  Most links in the validation dataset are relatively easy to infer.</p>
    <p>We identify different subsets of the validation dataset that are hard to infer.</p>
    <p>We develop ProbLink - a probabilistic AS relationship inference algorithm.</p>
    <p>Evaluation 19</p>
  </div>
  <div class="page">
    <p>Accuracy Comparison</p>
    <p>How well can ProbLink perform across years? Compare inference error rates to that of AS-Rank:</p>
    <p>The whole validation dataset: 1.7X improvement  Hard links: 1.8X to 6.1X improvement</p>
    <p>Category AS-Rank error (%)</p>
    <p>ProbLink error (%)</p>
    <p>Improvement</p>
    <p>Observed by 50-100 VPs 8.8 1.5 5.9X Non-VP &amp; Non-Tier1 4.4 1.7 2.6X</p>
    <p>Unlabeled Stub-clique 33.6 5.5 6.1X Conflict 6.8 3.8 1.8X</p>
    <p>Max node degree &lt; 100 8.6 4.4 2.0X 20</p>
  </div>
  <div class="page">
    <p>Stability Analysis</p>
    <p>AS-Rank is sensitive to snapshot selection  ProbLink is consistently stable</p>
  </div>
  <div class="page">
    <p>ProbLink 81.1% AS-Rank 19.8%</p>
    <p>CoreToLeaf 8.1%</p>
    <p>Precision Recall</p>
    <p>ProbLink 76.2% AS-Rank 22.1%</p>
    <p>CoreToLeaf 5.6%</p>
    <p>Route Leak Detection Route leak detection method: Check valley-free violations</p>
  </div>
  <div class="page">
    <p>Practical Applications</p>
    <p>Improvements over AS-Rank:  Route leak detection</p>
    <p>Complex relationship inference 27%</p>
    <p>Predicting the impact of selective advertisement 34%</p>
  </div>
  <div class="page">
    <p>Conclusion  High accuracy in validation dataset does not translate to high</p>
    <p>application-level performance</p>
    <p>Most links in the validation dataset are easy to infer</p>
    <p>Constructed hard links sets and use them as benchmarks</p>
    <p>Developed ProbLink and allow for integration of many noisy but useful attributes</p>
    <p>Demonstrated that ProbLink is more effective and stable for real applications than previous techniques</p>
  </div>
</Presentation>
