<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Checking absence of illicit applet interaction: a case study in compositional verification</p>
    <p>Marieke Huisman</p>
    <p>INRIA Sophia Antipolis, France</p>
    <p>(Marieke.Huisman@inria.fr)</p>
    <p>joint work with Dilian Gurov (KTH Sweden), Christoph Sprenger &amp; Gennady Chugunov (SICS Sweden)</p>
    <p>Checking absence of illicit applet interaction  p.1</p>
  </div>
  <div class="page">
    <p>Motivation</p>
    <p>Smart cards: new challenges for security</p>
    <p>Sensitive data stored on cards Small applications: formal verification feasible</p>
    <p>Multiple interacting applets</p>
    <p>Example: purse applet and several loyalties Communication via method invocation (over shared interfaces)</p>
    <p>Post-issuance loading</p>
    <p>Checking absence of illicit applet interaction  p.2</p>
  </div>
  <div class="page">
    <p>Motivation</p>
    <p>Smart cards: new challenges for security</p>
    <p>Sensitive data stored on cards Small applications: formal verification feasible</p>
    <p>Multiple interacting applets</p>
    <p>Example: purse applet and several loyalties Communication via method invocation (over shared interfaces)</p>
    <p>Post-issuance loading</p>
    <p>Checking absence of illicit applet interaction  p.2</p>
  </div>
  <div class="page">
    <p>Motivation</p>
    <p>Smart cards: new challenges for security</p>
    <p>Sensitive data stored on cards Small applications: formal verification feasible</p>
    <p>Multiple interacting applets</p>
    <p>Example: purse applet and several loyalties Communication via method invocation (over shared interfaces)</p>
    <p>Post-issuance loading</p>
    <p>Checking absence of illicit applet interaction  p.2</p>
  </div>
  <div class="page">
    <p>Post-issuance loading of applets</p>
    <p>BNP my first electronic purse</p>
    <p>Iberia applet not trusted, cannot join</p>
    <p>OK to join the SAS club</p>
    <p>SAS</p>
    <p>Iberia</p>
    <p>Terminal</p>
    <p>Terminal</p>
    <p>Checking absence of illicit applet interaction  p.3</p>
  </div>
  <div class="page">
    <p>Secure post-issuance loading</p>
    <p>Requires compositional verification</p>
    <p>Decompose global security property into local applet properties</p>
    <p>Possible loading scenarios Each new applet has to respect local specification Each new applet comes with local specification, should be sufficient to guarantee global specification</p>
    <p>Checking absence of illicit applet interaction  p.4</p>
  </div>
  <div class="page">
    <p>Secure post-issuance loading</p>
    <p>Requires compositional verification</p>
    <p>Decompose global security property into local applet properties</p>
    <p>Possible loading scenarios Each new applet has to respect local specification Each new applet comes with local specification, should be sufficient to guarantee global specification</p>
    <p>Checking absence of illicit applet interaction  p.4</p>
  </div>
  <div class="page">
    <p>Overview</p>
    <p>Our approach to compositional verification</p>
    <p>Tool set</p>
    <p>Case study: PACAP Specifications Verifications</p>
    <p>Checking absence of illicit applet interaction  p.5</p>
  </div>
  <div class="page">
    <p>Compositional verification principle</p>
    <p>A |=  Max() ] B |=</p>
    <p>A ] B |=</p>
    <p>A maximal model Max() simulates all other models having property .</p>
    <p>Checking absence of illicit applet interaction  p.6</p>
  </div>
  <div class="page">
    <p>Program model</p>
    <p>Distinction between structural and behavioural level</p>
    <p>Structural level Each method represented by control flow graph Applet collection of methods, with interface</p>
    <p>Behavioural level States: control point + call stack Transition rules describe possible executions</p>
    <p>Property specification on structural and behavioural level</p>
    <p>Checking absence of illicit applet interaction  p.7</p>
  </div>
  <div class="page">
    <p>Program model</p>
    <p>Distinction between structural and behavioural level</p>
    <p>Structural level Each method represented by control flow graph Applet collection of methods, with interface</p>
    <p>Behavioural level States: control point + call stack Transition rules describe possible executions</p>
    <p>Property specification on structural and behavioural level</p>
    <p>Checking absence of illicit applet interaction  p.7</p>
  </div>
  <div class="page">
    <p>Program model</p>
    <p>Distinction between structural and behavioural level</p>
    <p>Structural level Each method represented by control flow graph Applet collection of methods, with interface</p>
    <p>Behavioural level States: control point + call stack Transition rules describe possible executions</p>
    <p>Property specification on structural and behavioural level</p>
    <p>Checking absence of illicit applet interaction  p.7</p>
  </div>
  <div class="page">
    <p>Program model</p>
    <p>Distinction between structural and behavioural level</p>
    <p>Structural level Each method represented by control flow graph Applet collection of methods, with interface</p>
    <p>Behavioural level States: control point + call stack Transition rules describe possible executions</p>
    <p>Property specification on structural and behavioural level</p>
    <p>Checking absence of illicit applet interaction  p.7</p>
  </div>
  <div class="page">
    <p>Structural vs. behavioural</p>
    <p>v1</p>
    <p>v2</p>
    <p>v3</p>
    <p>Loyalty.askForTransaction</p>
    <p>eps</p>
    <p>Loyalty.logFull</p>
    <p>Loyalty.logFull</p>
    <p>Loyalty.logFull, r</p>
    <p>Execution steps:</p>
    <p>&lt;v1, &gt; &lt;v2, &gt;</p>
    <p>&lt;v2, &gt;</p>
    <p>&lt;v3, &gt;</p>
    <p>L.lF call L.afT</p>
    <p>L.afT ret L.lF</p>
    <p>&lt;entry L.aFT, v3 . &gt;</p>
    <p>&lt;return L.afT, v3 . &gt;</p>
    <p>........</p>
    <p>Checking absence of illicit applet interaction  p.8</p>
  </div>
  <div class="page">
    <p>Compositional verification for applets</p>
    <p>Local properties must be structural</p>
    <p>Global property may be behavioural</p>
    <p>Maximal model for property, restricted to applet structure (based on interface)</p>
    <p>Maximal applet w.r.t.  and I: MaxI ()</p>
    <p>A |=s A MaxIA(A) ]s B |=b</p>
    <p>A ] B |=b</p>
    <p>Checking absence of illicit applet interaction  p.9</p>
  </div>
  <div class="page">
    <p>Steps</p>
    <p>Specification of global security properties as behavioural safety properties</p>
    <p>Goal: A ] B |=</p>
    <p>Specification of local properties as structural safety properties</p>
    <p>A and B, respectively</p>
    <p>Algorithmic verification of property decompositions, ensures the local properties are sufficient to guarantee the global one</p>
    <p>MaxIA (A) ] MaxIB (B) |=</p>
    <p>Algorithmic verification of local properties for individual applets</p>
    <p>A |= A and B |= B, respectively</p>
    <p>Checking absence of illicit applet interaction  p.10</p>
  </div>
  <div class="page">
    <p>Steps</p>
    <p>Specification of global security properties as behavioural safety properties Goal: A ] B |=</p>
    <p>Specification of local properties as structural safety properties</p>
    <p>A and B, respectively</p>
    <p>Algorithmic verification of property decompositions, ensures the local properties are sufficient to guarantee the global one</p>
    <p>MaxIA (A) ] MaxIB (B) |=</p>
    <p>Algorithmic verification of local properties for individual applets</p>
    <p>A |= A and B |= B, respectively</p>
    <p>Checking absence of illicit applet interaction  p.10</p>
  </div>
  <div class="page">
    <p>Steps</p>
    <p>Specification of global security properties as behavioural safety properties Goal: A ] B |=</p>
    <p>Specification of local properties as structural safety properties A and B, respectively</p>
    <p>Algorithmic verification of property decompositions, ensures the local properties are sufficient to guarantee the global one</p>
    <p>MaxIA (A) ] MaxIB (B) |=</p>
    <p>Algorithmic verification of local properties for individual applets</p>
    <p>A |= A and B |= B, respectively</p>
    <p>Checking absence of illicit applet interaction  p.10</p>
  </div>
  <div class="page">
    <p>Steps</p>
    <p>Specification of global security properties as behavioural safety properties Goal: A ] B |=</p>
    <p>Specification of local properties as structural safety properties A and B, respectively</p>
    <p>Algorithmic verification of property decompositions, ensures the local properties are sufficient to guarantee the global one MaxIA (A) ] MaxIB (B) |=</p>
    <p>Algorithmic verification of local properties for individual applets</p>
    <p>A |= A and B |= B, respectively</p>
    <p>Checking absence of illicit applet interaction  p.10</p>
  </div>
  <div class="page">
    <p>Steps</p>
    <p>Specification of global security properties as behavioural safety properties Goal: A ] B |=</p>
    <p>Specification of local properties as structural safety properties A and B, respectively</p>
    <p>Algorithmic verification of property decompositions, ensures the local properties are sufficient to guarantee the global one MaxIA (A) ] MaxIB (B) |=</p>
    <p>Algorithmic verification of local properties for individual applets A |= A and B |= B, respectively</p>
    <p>Checking absence of illicit applet interaction  p.10</p>
  </div>
  <div class="page">
    <p>Java Card Applet Verification Environment (JCAVE)</p>
    <p>+</p>
    <p>YES/NO</p>
    <p>YES/NOStructural specification</p>
    <p>Applet Analyser</p>
    <p>Maximal model constructor</p>
    <p>Applet Graphs</p>
    <p>CCS process</p>
    <p>CWB</p>
    <p>Alfred</p>
    <p>PDA</p>
    <p>Model generator</p>
    <p>specification Behavioural</p>
    <p>Implementation</p>
    <p>Interface</p>
    <p>Checking absence of illicit applet interaction  p.11</p>
  </div>
  <div class="page">
    <p>PACAP: electronic purse case study</p>
    <p>Developed by Gemplus, test case for formal methods</p>
    <p>Several interacting applets: purse, loyalty, card issuer</p>
    <p>Communication between purse and loyalties, and among loyalties necessary</p>
    <p>Information about transaction log table should not flow freely between loyalties</p>
    <p>Checking absence of illicit applet interaction  p.12</p>
  </div>
  <div class="page">
    <p>The specifications</p>
    <p>Global specification: A call to Loyalty.logFull does not trigger any calls to any other loyalty</p>
    <p>() Within Loyalty.logFull (CanNotCall Loyalty MSIL )  (CanNotCall Purse MSIL )</p>
    <p>where MSIL is the set of shareable interface methods of Loyalty</p>
    <p>Checking absence of illicit applet interaction  p.13</p>
  </div>
  <div class="page">
    <p>The specifications</p>
    <p>Global specification: A call to Loyalty.logFull does not trigger any calls to any other loyalty</p>
    <p>() Within Loyalty.logFull (CanNotCall Loyalty MSIL )  (CanNotCall Purse MSIL )</p>
    <p>where MSIL is the set of shareable interface methods of Loyalty</p>
    <p>Checking absence of illicit applet interaction  p.13</p>
  </div>
  <div class="page">
    <p>Unfolding the specification</p>
    <p>Loyalty.logFull  Z.</p>
    <p>mI +</p>
    <p>L</p>
    <p>mM SI L</p>
    <p>[m call m] false</p>
    <p>mI +</p>
    <p>P</p>
    <p>mM SI L</p>
    <p>[m call m] false</p>
    <p>[LP ]L] Z</p>
    <p>Checking absence of illicit applet interaction  p.14</p>
  </div>
  <div class="page">
    <p>The local specifications</p>
    <p>Loyalty: From any entry point of Loyalty.logFull, the only reachable external calls are calls to Purse.isThereTransaction and Purse.getTransaction</p>
    <p>Purse: From any entry point of Purse.isThereTransaction or Purse.getTransaction, no external call is reachable</p>
    <p>Checking absence of illicit applet interaction  p.15</p>
  </div>
  <div class="page">
    <p>The local specifications</p>
    <p>Loyalty: From any entry point of Loyalty.logFull, the only reachable external calls are calls to Purse.isThereTransaction and Purse.getTransaction</p>
    <p>Purse: From any entry point of Purse.isThereTransaction or Purse.getTransaction, no external call is reachable</p>
    <p>Checking absence of illicit applet interaction  p.15</p>
  </div>
  <div class="page">
    <p>Formalising the local specification for Purse</p>
    <p>Purse: From any entry point of Purse.isThereTransaction or Purse.getTransaction, no external call is reachable</p>
    <p>(Purse) HasNoOutsideCalls MiT T  HasNoOutsideCalls MgT</p>
    <p>where MiT T  I</p>
    <p>+</p>
    <p>P , containing Purse.isThereTransaction and</p>
    <p>MgT  I +</p>
    <p>P , containing Purse.getTransaction</p>
    <p>Information from Applet Analyser</p>
    <p>Checking absence of illicit applet interaction  p.16</p>
  </div>
  <div class="page">
    <p>Formalising the local specification for Loyalty</p>
    <p>Loyalty: From any entry point of Loyalty.logFull, the only reachable external calls are calls to Purse.isThereTransaction and Purse.getTransaction</p>
    <p>(Loyalty) MlF HasNoCallsTo I</p>
    <p>L \</p>
    <p>(</p>
    <p>M \ MSIL )</p>
    <p>where MlF  I</p>
    <p>+</p>
    <p>L , containing Loyalty.logFull and</p>
    <p>M = MlF  { Purse.isThereTransaction, Purse.getTransaction }</p>
    <p>Checking absence of illicit applet interaction  p.17</p>
  </div>
  <div class="page">
    <p>Verification tasks</p>
    <p>Verifying property decomposition: building maximal applets for Purse and Loyalty</p>
    <p>Loyalty : 25 min., Purse: 13 hrs.</p>
    <p>model checking MaxIPurse (Purse )  MaxILoyalty (Loyalty ) |=</p>
    <p>Verifying local structural properties: extracting applet graphs Purse and Loyalty</p>
    <p>Loyalty : 5.6 sec., Purse: 7.5 sec.</p>
    <p>model checking Purse |= Purse and Loyalty |= Loyalty</p>
    <p>Loyalty : 12 sec., Purse: 19 sec.</p>
    <p>Checking absence of illicit applet interaction  p.18</p>
  </div>
  <div class="page">
    <p>Verification tasks</p>
    <p>Verifying property decomposition: building maximal applets for Purse and Loyalty Loyalty : 25 min., Purse: 13 hrs. model checking MaxIPurse (Purse )  MaxILoyalty (Loyalty ) |=</p>
    <p>Verifying local structural properties: extracting applet graphs Purse and Loyalty</p>
    <p>Loyalty : 5.6 sec., Purse: 7.5 sec.</p>
    <p>model checking Purse |= Purse and Loyalty |= Loyalty</p>
    <p>Loyalty : 12 sec., Purse: 19 sec.</p>
    <p>Checking absence of illicit applet interaction  p.18</p>
  </div>
  <div class="page">
    <p>Verification tasks</p>
    <p>Verifying property decomposition: building maximal applets for Purse and Loyalty Loyalty : 25 min., Purse: 13 hrs. model checking MaxIPurse (Purse )  MaxILoyalty (Loyalty ) |=</p>
    <p>Verifying local structural properties: extracting applet graphs Purse and Loyalty Loyalty : 5.6 sec., Purse: 7.5 sec. model checking Purse |= Purse and Loyalty |= Loyalty</p>
    <p>Loyalty : 12 sec., Purse: 19 sec.</p>
    <p>Checking absence of illicit applet interaction  p.18</p>
  </div>
  <div class="page">
    <p>Verification tasks</p>
    <p>Verifying property decomposition: building maximal applets for Purse and Loyalty Loyalty : 25 min., Purse: 13 hrs. model checking MaxIPurse (Purse )  MaxILoyalty (Loyalty ) |=</p>
    <p>Verifying local structural properties: extracting applet graphs Purse and Loyalty Loyalty : 5.6 sec., Purse: 7.5 sec. model checking Purse |= Purse and Loyalty |= Loyalty Loyalty : 12 sec., Purse: 19 sec.</p>
    <p>Checking absence of illicit applet interaction  p.18</p>
  </div>
  <div class="page">
    <p>Conclusions</p>
    <p>Method and tool set to show absence of illicit control flow between different applets</p>
    <p>Verifications push-button, using algorithmic techniques</p>
    <p>Naturally supports post-issuance loading of applets, but also applicable in other contexts</p>
    <p>Scalability issue: maximal model construction exponential in size of applet interface</p>
    <p>Current work: distinction between public and private interfaces</p>
    <p>Checking absence of illicit applet interaction  p.19</p>
  </div>
  <div class="page">
    <p>Conclusions</p>
    <p>Method and tool set to show absence of illicit control flow between different applets</p>
    <p>Verifications push-button, using algorithmic techniques</p>
    <p>Naturally supports post-issuance loading of applets, but also applicable in other contexts</p>
    <p>Scalability issue: maximal model construction exponential in size of applet interface</p>
    <p>Current work: distinction between public and private interfaces</p>
    <p>Checking absence of illicit applet interaction  p.19</p>
  </div>
</Presentation>
