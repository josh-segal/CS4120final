<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>iSeeYou: Disabling the MacBook Webcam Indicator LED</p>
    <p>Matthew Brocker Stephen Checkoway</p>
    <p>Johns Hopkins University</p>
  </div>
  <div class="page">
    <p>Embedded Systems</p>
  </div>
  <div class="page">
    <p>Embedded Systems</p>
  </div>
  <div class="page">
    <p>Processors all the way down</p>
  </div>
  <div class="page">
    <p>Toasters all the way down</p>
  </div>
  <div class="page">
    <p>MacBook iSight</p>
  </div>
  <div class="page">
    <p>MacBook iSight</p>
    <p>EZ-USB processor</p>
  </div>
  <div class="page">
    <p>MacBook iSight</p>
    <p>EZ-USB processor</p>
    <p>LED</p>
  </div>
  <div class="page">
    <p>Okay. So what?</p>
    <p>! Nation state actors</p>
    <p>! Stalkers on the Internet</p>
    <p>! Anyone who gives you a computer</p>
    <p>! Biometric authentication using webcam</p>
  </div>
  <div class="page">
    <p>Can we turn the LED off</p>
    <p>while recording?</p>
    <p>! Can malicious firmware control the LED?</p>
    <p>! Can malicious software (on the host) replace the firmware</p>
  </div>
  <div class="page">
    <p>Hardware</p>
    <p>U S B</p>
    <p>U S B</p>
    <p>MCU</p>
    <p>LED</p>
    <p>EEPROM</p>
    <p>Image Sensor</p>
  </div>
  <div class="page">
    <p>Which one?</p>
  </div>
  <div class="page">
    <p>Image Sensor</p>
  </div>
  <div class="page">
    <p>Typical Configuration</p>
  </div>
  <div class="page">
    <p>iSight architecture</p>
    <p>! USB connection to host</p>
    <p>! Configure sensor via I2C</p>
    <p>! 16 byte I2C EEPROM</p>
    <p>! STANDBY=output disable</p>
    <p>! PD3 also controls LED:</p>
    <p>PD3 Output LED</p>
    <p>Vcc Disabled Off</p>
    <p>Gnd Enabled On</p>
  </div>
  <div class="page">
    <p>RESET Register</p>
    <p>Bit Field Description</p>
    <p>Bit 7 Inhibit STANDBY</p>
    <p>Setting this bit stops STANDBY from affecting entry to or exit from the low-power state.</p>
    <p>Bit 6 Drive Signals</p>
    <p>By default, asserting STANDBY causes the ball interface to enter High-Z. Setting this bit stops STANDBY from contributing to output enable control.</p>
  </div>
  <div class="page">
    <p>With malicious firmware</p>
    <p>! Set RESET register via I2C</p>
    <p>! Control LED via PD3 (independent of Standby)</p>
  </div>
  <div class="page">
    <p>With malicious firmware</p>
    <p>! Set RESET register via I2C</p>
    <p>! Control LED via PD3 (independent of Standby)</p>
  </div>
  <div class="page">
    <p>With malicious firmware</p>
    <p>! Set RESET register via I2C</p>
    <p>! Control LED via PD3 (independent of Standby)</p>
  </div>
  <div class="page">
    <p>Firmware Load</p>
    <p>! Internal Hi-Speed USB bus</p>
    <p>! AppleUsbVideoSupport kext</p>
    <p>! Non-root process Kext</p>
  </div>
  <div class="page">
    <p>Firmware Load</p>
    <p>! Internal Hi-Speed USB bus</p>
    <p>! AppleUsbVideoSupport kext</p>
    <p>! Non-root process Kext</p>
  </div>
  <div class="page">
    <p>Firmware Load</p>
    <p>! Internal Hi-Speed USB bus</p>
    <p>! AppleUsbVideoSupport kext</p>
    <p>! Non-root process Kext</p>
  </div>
  <div class="page">
    <p>Programming the EZ-USB</p>
    <p>! Malware on host programs EZ-USB via USB</p>
    <p>! EZ-USB sets RESET reg.</p>
    <p>! LED under host control</p>
  </div>
  <div class="page">
    <p>Programming the EZ-USB</p>
    <p>! Malware on host programs EZ-USB via USB</p>
    <p>! EZ-USB sets RESET reg.</p>
    <p>! LED under host control</p>
  </div>
  <div class="page">
    <p>Programming the EZ-USB</p>
    <p>! Malware on host programs EZ-USB via USB</p>
    <p>! EZ-USB sets RESET reg.</p>
    <p>! LED under host control</p>
  </div>
  <div class="page">
    <p>Demo</p>
  </div>
  <div class="page">
    <p>What else can we do?</p>
    <p>! Pretend to be a USB HID keyboard</p>
    <p>! Break out of a Virtual Machine</p>
  </div>
  <div class="page">
    <p>Conclusions</p>
    <p>! LED has privacy/security implications</p>
    <p>! Software-circumventable defenses bad</p>
    <p>! Processors in computer are vulnerable</p>
    <p>! Security is a systems problem</p>
  </div>
  <div class="page">
    <p>Conclusions</p>
    <p>! LED has privacy/security implications</p>
    <p>! Software-circumventable defenses bad</p>
    <p>! Processors in computer are vulnerable</p>
    <p>! Security is a systems problem</p>
    <p>Fin</p>
  </div>
</Presentation>
