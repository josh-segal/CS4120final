<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>In VINI Veritas Realistic and Controlled Network Experimentation</p>
    <p>Andy Bavier Nick Feamster* Mark Huang</p>
    <p>Larry Peterson Jennifer Rexford</p>
    <p>Princeton University *Georgia Tech</p>
  </div>
  <div class="page">
    <p>How to Validate an Idea?</p>
    <p>Fixed, shared among many experiments  Runs real routing software  Exposes realistic network conditions  Gives control over network events  Carries traffic on behalf of real users</p>
    <p>Simulation</p>
    <p>Emulation</p>
    <p>Small-scale experiment</p>
    <p>Live deployment</p>
    <p>VINI</p>
  </div>
  <div class="page">
    <p>Scientific Value</p>
    <p>The most exciting phrase to hear in science, the one that heralds new discoveries, is not Eureka! (I found it!) but Thats funny  -- Isaac Asimov</p>
    <p>Move off the emulator, into the wild  Opportunity for more thats funny moments</p>
    <p>Avoid Fallacy of Misplaced Concreteness  Simulation and emulation are important tools  Modeling abstracts general properties from reality</p>
    <p>Philosophy: the devil may be in the details  But insights and soundness are found there too</p>
  </div>
  <div class="page">
    <p>Controlled Realism  Start with a controlled</p>
    <p>experiment  Relax constraints,</p>
    <p>study effects  Result: an operational</p>
    <p>virtual network thats  Feasible  Valuable  Robust  Scalable, etc.</p>
    <p>Topology</p>
    <p>Actual network</p>
    <p>Arbitrary, emulated</p>
    <p>Traffic</p>
    <p>Real clients, servers</p>
    <p>Synthetic or traces</p>
    <p>Network Events</p>
    <p>Observed in operational network</p>
    <p>Inject faults, anomalies</p>
  </div>
  <div class="page">
    <p>Overview  VINI requirements</p>
    <p>Fixed, shared infrastructure  Flexible network topology  Expose/inject network events  External connectivity and routing adjacencies</p>
    <p>Strategy for building VINI  PL-VINI: prototype on PlanetLab  Experimental results  Timeline</p>
  </div>
  <div class="page">
    <p>Fixed Infrastructure</p>
    <p>Deploying VINI nodes in National LambdaRail, Abilene with Gigabit links</p>
  </div>
  <div class="page">
    <p>Shared Infrastructure</p>
    <p>Experiments given illusion of dedicated h/w</p>
  </div>
  <div class="page">
    <p>Flexible Topology</p>
    <p>VINI supports arbitrary virtual topologies</p>
  </div>
  <div class="page">
    <p>Network Events</p>
    <p>VINI exposes, can inject network failures</p>
  </div>
  <div class="page">
    <p>External Connectivity</p>
    <p>s</p>
    <p>c</p>
    <p>Experiments can carry traffic for real end-users</p>
  </div>
  <div class="page">
    <p>External Routing Adjacencies</p>
    <p>s</p>
    <p>c</p>
    <p>BGP</p>
    <p>BGP</p>
    <p>BGP</p>
    <p>BGP</p>
    <p>Experiments can participate in Internet routing</p>
  </div>
  <div class="page">
    <p>PlanetLab  VINI</p>
    <p>Build VINI from PlanetLab, a global testbed for distributed services  Begun in 2002  700 nodes at 336 sites in 35 countries  600 projects and 2500 researchers  Serves 3-4 TB/day to ~1M clients</p>
    <p>MyPLC: PlanetLab software distribution  Anyone can run their own private PlanetLab</p>
  </div>
  <div class="page">
    <p>PlanetLab Experiments</p>
    <p>Simultaneous experiments in separate VMs  Each has root in its own VM, can customize</p>
    <p>Reserve CPU, network capacity per experiment</p>
    <p>Virtual Machine Monitor (VMM) (Linux++)</p>
    <p>Node Mgr</p>
    <p>Local Admin</p>
    <p>VM1 VM2 VMn PlanetLab node</p>
  </div>
  <div class="page">
    <p>PL-VINI: Prototype on PlanetLab</p>
    <p>Feasible?  prototype on public PlanetLab  Enable experiment: Internet In A Slice</p>
    <p>XORP open-source routing protocol suite (NSDI 05)  Click modular router (TOCS 00, SOSP 99)</p>
    <p>Clarify issues that a VINI must address  Unmodified routing software on a virtual topology  Forwarding packets at line speed  Illusion of dedicated hardware  Injection of faults and other events</p>
  </div>
  <div class="page">
    <p>XORP: Control Plane</p>
    <p>Goal: real routing protocols on virtual network topologies</p>
    <p>BGP, OSPF, RIP, PIM-SM, IGMP/MLD</p>
    <p>XORP can run in a PlanetLab VM</p>
    <p>XORP (routing protocols)</p>
    <p>PlanetLab VM</p>
  </div>
  <div class="page">
    <p>User-Mode Linux: Environment</p>
    <p>Interface  network  PlanetLab limitation:</p>
    <p>Experiments cannot create new interfaces</p>
    <p>Run routing software in UML environment</p>
    <p>Create virtual network interfaces in UML</p>
    <p>XORP (routing protocols)</p>
    <p>UML</p>
    <p>eth1 eth3eth2eth0</p>
    <p>PlanetLab VM</p>
  </div>
  <div class="page">
    <p>Click: Data Plane</p>
    <p>Performance  Avoid UML overhead  Move to kernel, FPGA</p>
    <p>Interfaces  tunnels  Click UDP tunnels</p>
    <p>correspond to UML network interfaces</p>
    <p>Filters  Fail a link by blocking</p>
    <p>packets at tunnel</p>
    <p>XORP (routing protocols)</p>
    <p>UML</p>
    <p>eth1 eth3eth2eth0</p>
    <p>Click</p>
    <p>Packet Forward Engine</p>
    <p>Control</p>
    <p>Data UmlSwitch</p>
    <p>element</p>
    <p>Tunnel table</p>
    <p>Filters</p>
    <p>PlanetLab VM</p>
  </div>
  <div class="page">
    <p>Resource Isolation</p>
    <p>Issue: Forwarding packets in user space  PlanetLab sees heavy use  CPU load affects virtual network performance</p>
    <p>Property Depends On Solution</p>
    <p>Throughput CPU% received PlanetLab provides CPU reservations</p>
    <p>Latency CPU scheduling delay</p>
    <p>PL-VINI: boost priority of packet forward process</p>
  </div>
  <div class="page">
    <p>Intra-domain Route Changes s</p>
    <p>c</p>
    <p>Watch OSPF route convergence on Abilene</p>
  </div>
  <div class="page">
    <p>Ping During Link Failure</p>
    <p>P in</p>
    <p>g R</p>
    <p>T T</p>
    <p>( m</p>
    <p>s )</p>
    <p>Sec onds</p>
    <p>Link down Link up</p>
    <p>Routes converging</p>
    <p>Abilene RTT: 73ms</p>
  </div>
  <div class="page">
    <p>TCP Throughput</p>
    <p>M e</p>
    <p>g ab</p>
    <p>y te</p>
    <p>s t</p>
    <p>ra ns</p>
    <p>fe rr</p>
    <p>e d</p>
    <p>Seconds</p>
    <p>Packet receiv ed</p>
    <p>Zoom in</p>
    <p>Link down Link up</p>
  </div>
  <div class="page">
    <p>Arriving TCP Packets</p>
    <p>M eg</p>
    <p>ab yt</p>
    <p>es in</p>
    <p>s tr</p>
    <p>ea m</p>
    <p>Seco nds</p>
    <p>Pack et receiv ed</p>
    <p>Slow start</p>
    <p>Retransmit lost packet</p>
    <p>PL-VINI enables a user-space virtual network to behave like a real network on PlanetLab</p>
  </div>
  <div class="page">
    <p>Attracting Real Users</p>
    <p>Could have run experiments on Emulab  Goal: Operate our own virtual network</p>
    <p>Carrying traffic for actual users  We can tinker with routing protocols</p>
    <p>We expect that:  PlanetLab services will subscribe to VINI</p>
    <p>network architectures to access Gb/s  Experiments will advertise routes via BGP</p>
  </div>
  <div class="page">
    <p>Timeline</p>
    <p>PL-VINI  PlanetLab  Resource resv  CPU priority</p>
    <p>You are here</p>
    <p>NLR-VINI Abilene-VINI Japan-VINI  PCs  VINI OS  MyVINI  Xen  Exchange traffic with ISPs</p>
    <p>NLR-VINI Abilene-VINI  PCs  PlanetLab OS  MyPLC  Gigabit layer 2  eBGP uplinks to friendly ISPs</p>
    <p>Fall 2006 2008</p>
    <p>NLR-VINI Abilene-VINI Japan-VINI ???-VINI  Other GREN  PC + FPGAs, NPs  Create layer 2 on the fly</p>
    <p>Other features?</p>
  </div>
  <div class="page">
    <p>The End</p>
    <p>Questions?</p>
  </div>
  <div class="page">
    <p>The End</p>
    <p>URL: http://www.vini-veritas.net  Questions?</p>
  </div>
  <div class="page">
    <p>Backup slides</p>
  </div>
  <div class="page">
    <p>Conclusion</p>
    <p>VINI = evolution of PlanetLab  Installing VINI nodes in NLR, Abilene  Download and run Internet In A Slice  MyPLC  MyVINI as code diverges</p>
    <p>Build, run, modify your own VINI  We expect there to be many VINIs</p>
    <p>http://www.vini-veritas.net</p>
  </div>
  <div class="page">
    <p>Timeline</p>
    <p>Conclude with a timeline instead? Like the one for Gibson.</p>
    <p>Experiments on the top, infrastructure on the bottom, You are here.</p>
    <p>Today: IIAS, PL-VINI  Next: RCP, VINI-NLR  What other experiments?</p>
  </div>
  <div class="page">
    <p>Ongoing Work</p>
    <p>Improving realism  Exposing network failures and changes in the</p>
    <p>underlying topology  Participating in routing with neighboring networks</p>
    <p>Improving control  Better isolation  Experiment specification</p>
  </div>
  <div class="page">
    <p>Performance is bad</p>
    <p>User-space Click: ~200Mb/s forwarding  Can do a lot with 200Mb/s</p>
    <p>20 experiments can have dedicated 10Mb/s nationwide networks</p>
    <p>Improving performance is ongoing work  Allow experiments to load custom Click</p>
    <p>modules into the VINI kernel</p>
  </div>
  <div class="page">
    <p>PL-VINI Summary Flexible Network Topology</p>
    <p>Virtual point-to-point connectivity Tunnels in Click</p>
    <p>Unique interfaces per experiment Virtual network devices in UML</p>
    <p>Exposure of topology changes Upcalls of layer-3 alarms</p>
    <p>Flexible Routing and Forwarding</p>
    <p>Per-node forwarding table Separate Click per virtual node</p>
    <p>Per-node routing process Separate XORP per virtual node</p>
    <p>Connectivity to External Hosts</p>
    <p>End-hosts can direct traffic through VINI Connect to OpenVPN server</p>
    <p>Return traffic flows through VINI NAT in Click on egress node</p>
    <p>Support for Simultaneous Experiments</p>
    <p>Isolation between experiments PlanetLab VMs and network isolation CPU reservations and priorities</p>
    <p>Distinct external routing adjacencies BGP multiplexer for external sessions</p>
  </div>
  <div class="page">
    <p>PL-VINI / IIAS Router</p>
    <p>XORP: control plane  UML: environment</p>
    <p>Virtual interfaces</p>
    <p>Click: data plane  Performance</p>
    <p>Avoid UML overhead  Move to kernel, FPGA</p>
    <p>Interfaces  tunnels  Fail a link</p>
    <p>XORP (routing protocols)</p>
    <p>UML</p>
    <p>eth1 eth3eth2eth0</p>
    <p>Click</p>
    <p>Packet Forward Engine</p>
    <p>Control</p>
    <p>Data UmlSwitch</p>
    <p>element</p>
    <p>Tunnel table</p>
  </div>
  <div class="page">
    <p>Whats New with VINI?</p>
    <p>Integration of routing w/Internet  Better isolation  Real topologies  Inject events</p>
  </div>
  <div class="page">
    <p>Controlled Realism  Control:</p>
    <p>Reproduce results  Methodically change or</p>
    <p>relax constraints</p>
    <p>Realism:  Long-running services</p>
    <p>attract real customers  Forward high traffic</p>
    <p>volumes (Gb/s)  Robustly handle</p>
    <p>unexpected events</p>
    <p>Topology</p>
    <p>Actual network</p>
    <p>Arbitrary, emulated</p>
    <p>Traffic</p>
    <p>Real clients, servers</p>
    <p>Synthetic or traces</p>
    <p>Network Events</p>
    <p>Observed in operational network</p>
    <p>Inject faults, anomalies</p>
  </div>
</Presentation>
