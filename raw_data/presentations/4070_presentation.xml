<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>HOW TO BREAK MICROSOFT RIGHTS MANAGEMENT SERVICES | WOOT | 08.08.2016 1</p>
    <p>Bildquelle: http://www.google.com/about/datacenters/galler y/#/tech/12</p>
    <p>How to Break Microsoft Rights Management Services</p>
    <p>Workshop on Offensive Technology</p>
    <p>Christian Mainka, Paul Rsler, Jrg Schwenk and Martin Grothe</p>
  </div>
  <div class="page">
    <p>HOW TO BREAK MICROSOFT RIGHTS MANAGEMENT SERVICES | WOOT | 08.08.2016 2</p>
    <p>Agenda</p>
    <p>Motivation</p>
    <p>Microsoft RMS</p>
    <p>DisARMS Attack #1 (unprotect)</p>
    <p>DisARMS Attack #2</p>
    <p>(modifcation)</p>
    <p>Conclusion</p>
  </div>
  <div class="page">
    <p>HOW TO BREAK MICROSOFT RIGHTS MANAGEMENT SERVICES | WOOT | 08.08.2016 3</p>
    <p>Going to talk about Enterprise Rights Management (ERM)</p>
    <p>Consumer version: Digital Rights Management (DRM)  Music, movies, e-books</p>
    <p>ERM goal: protect (digital) company assets</p>
    <p>Useful for different scenarios</p>
    <p>Motivation</p>
  </div>
  <div class="page">
    <p>HOW TO BREAK MICROSOFT RIGHTS MANAGEMENT SERVICES | WOOT | 08.08.2016 4</p>
    <p>Motivation</p>
  </div>
  <div class="page">
    <p>HOW TO BREAK MICROSOFT RIGHTS MANAGEMENT SERVICES | WOOT | 08.08.2016 5</p>
    <p>Agenda</p>
    <p>Motivation</p>
    <p>Microsoft RMS</p>
    <p>DisARMS Attack #1 (unprotect)</p>
    <p>DisARMS Attack #2</p>
    <p>(modifcation)</p>
    <p>Conclusion</p>
  </div>
  <div class="page">
    <p>HOW TO BREAK MICROSOFT RIGHTS MANAGEMENT SERVICES | WOOT | 08.08.2016 6</p>
    <p>Microsoft RMS - Intro</p>
  </div>
  <div class="page">
    <p>HOW TO BREAK MICROSOFT RIGHTS MANAGEMENT SERVICES | WOOT | 08.08.2016 7</p>
    <p>Microsoft RMS - High Level</p>
    <p>Set specific rights for a person and/or group via e-mail addr.</p>
    <p>Use sym. and asym. cryptography  AES content encryption  PKI (RSA)  Licenses</p>
    <p>Use license (UL)  Publishing license (PL)</p>
  </div>
  <div class="page">
    <p>HOW TO BREAK MICROSOFT RIGHTS MANAGEMENT SERVICES | WOOT | 08.08.2016 8</p>
    <p>Microsoft RMS PKI</p>
    <p>Root Cert has separate PrivK  SLC has separate PrivK</p>
    <p>SPC has separate PrivK  SLC is signed with RootPrivK</p>
    <p>RACPubK and encrypted RACPrivK are signed by SLCPrivK</p>
    <p>SPC is self-signed</p>
    <p>CLCPubK and encrypted CLCPrivK are signed by SLCPrivK</p>
  </div>
  <div class="page">
    <p>HOW TO BREAK MICROSOFT RIGHTS MANAGEMENT SERVICES | WOOT | 08.08.2016 9</p>
    <p>Microsoft RMS Create File</p>
    <p>PL content encrypted with SLCPubK  PL signed with author CLCPrivK  Author CLC signed with SLCPrivK</p>
  </div>
  <div class="page">
    <p>HOW TO BREAK MICROSOFT RIGHTS MANAGEMENT SERVICES | WOOT | 08.08.2016 10</p>
    <p>Microsoft RMS Create File</p>
    <p>Demonstration</p>
  </div>
  <div class="page">
    <p>HOW TO BREAK MICROSOFT RIGHTS MANAGEMENT SERVICES | WOOT | 08.08.2016 11</p>
    <p>Microsoft RMS Consume File</p>
  </div>
  <div class="page">
    <p>HOW TO BREAK MICROSOFT RIGHTS MANAGEMENT SERVICES | WOOT | 08.08.2016 12</p>
    <p>Microsoft RMS Attacks</p>
    <p>Responsible disclosed in april 2016  Case number MSRC 33210  We used:  C++  RMS SDK 2.1</p>
    <p>Attack requirements:  View access right  C++ Redistributable 2015  That is all J</p>
  </div>
  <div class="page">
    <p>HOW TO BREAK MICROSOFT RIGHTS MANAGEMENT SERVICES | WOOT | 08.08.2016 13</p>
    <p>Agenda</p>
    <p>Motivation</p>
    <p>Microsoft RMS</p>
    <p>DisARMS Attack #1 (unprotect)</p>
    <p>DisARMS Attack #2</p>
    <p>(modifcation)</p>
    <p>Conclusion</p>
  </div>
  <div class="page">
    <p>HOW TO BREAK MICROSOFT RIGHTS MANAGEMENT SERVICES | WOOT | 08.08.2016 14</p>
    <p>Bildquelle: http://www.google.com/about/datacenters/galler y/#/tech/12</p>
    <p>Microsoft RMS DisARMS #1</p>
  </div>
  <div class="page">
    <p>HOW TO BREAK MICROSOFT RIGHTS MANAGEMENT SERVICES | WOOT | 08.08.2016 15</p>
    <p>Microsoft RMS DisARMS #1</p>
    <p>Demonstration</p>
  </div>
  <div class="page">
    <p>HOW TO BREAK MICROSOFT RIGHTS MANAGEMENT SERVICES | WOOT | 08.08.2016 16</p>
    <p>Agenda</p>
    <p>Motivation</p>
    <p>Microsoft RMS</p>
    <p>DisARMS Attack #1 (unprotect)</p>
    <p>DisARMS Attack #2</p>
    <p>(modifcation)</p>
    <p>Conclusion</p>
  </div>
  <div class="page">
    <p>HOW TO BREAK MICROSOFT RIGHTS MANAGEMENT SERVICES | WOOT | 08.08.2016 17</p>
    <p>Bildquelle: http://www.google.com/about/datacenters/galler y/#/tech/12</p>
    <p>DisARMS #2 modification</p>
  </div>
  <div class="page">
    <p>HOW TO BREAK MICROSOFT RIGHTS MANAGEMENT SERVICES | WOOT | 08.08.2016 18</p>
    <p>DisARMS #2 modification</p>
    <p>Demonstration</p>
  </div>
  <div class="page">
    <p>HOW TO BREAK MICROSOFT RIGHTS MANAGEMENT SERVICES | WOOT | 08.08.2016 19</p>
    <p>Microsoft Response</p>
    <p>From: Microsoft Security Response Center secure@microsoft.com</p>
    <p>. . . The type of attack you present falls in the category of policy enforcement limitations. Policy enforcement capabilities, such as the ability to prevent printing or modifying content to which the user has legitimate access, are not guaranteed by cryptography or other hard technical means . . .</p>
  </div>
  <div class="page">
    <p>HOW TO BREAK MICROSOFT RIGHTS MANAGEMENT SERVICES | WOOT | 08.08.2016 20</p>
    <p>Agenda</p>
    <p>Motivation</p>
    <p>Microsoft RMS</p>
    <p>DisARMS Attack #1 (unprotect)</p>
    <p>DisARMS Attack #2</p>
    <p>(modifcation)</p>
    <p>Conclusion</p>
  </div>
  <div class="page">
    <p>HOW TO BREAK MICROSOFT RIGHTS MANAGEMENT SERVICES | WOOT | 08.08.2016 21</p>
    <p>Conclusion</p>
    <p>RMS is used by important companies and ministry</p>
    <p>AD RMS, Azure RMS, etc. are not secure  DisARMS #1 can not be prevented (look DRM)</p>
    <p>Just make it not that simple  DisARMS #2 can be prevented (see paper)</p>
    <p>Microsoft seems to has no interest in fixing the attacks</p>
  </div>
  <div class="page">
    <p>HOW TO BREAK MICROSOFT RIGHTS MANAGEMENT SERVICES | WOOT | 08.08.2016 22</p>
    <p>Questions? Email: martin.grothe@rub.de</p>
    <p>Email: christian.mainka@rub.de Twitter: @CheariX</p>
    <p>Code on Github: RUB-NDS/MS-RMS-Attacks</p>
    <p>Further Infos: web-in-security.blogspot.de</p>
    <p>Sponsored by German Ministry for Education and Research</p>
  </div>
  <div class="page">
    <p>HOW TO BREAK MICROSOFT RIGHTS MANAGEMENT SERVICES | WOOT | 08.08.2016 23</p>
    <p>Agenda</p>
    <p>Motivation</p>
    <p>Microsoft RMS</p>
    <p>DisARMS Attack #1 (unprotect)</p>
    <p>DisARMS Attack #2</p>
    <p>(modifcation)</p>
    <p>Conclusion</p>
  </div>
</Presentation>
