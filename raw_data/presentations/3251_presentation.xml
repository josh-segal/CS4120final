<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Circuit Fingerprinting Attack:</p>
    <p>Passive Deanonymization of Tor Hidden Services</p>
    <p>Albert Kwon1 Mashael Saad Al-Sabah123 David Lazar1</p>
    <p>Marc Dacier2 Srinivas Devadas1</p>
    <p>August 25, 2015</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 1 / 26</p>
  </div>
  <div class="page">
    <p>Outline</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 2 / 26</p>
  </div>
  <div class="page">
    <p>Backgound</p>
    <p>Outline</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 3 / 26</p>
  </div>
  <div class="page">
    <p>Backgound</p>
    <p>Tor: The Onion Router</p>
    <p>Conceal users identities and activities</p>
    <p>User picks 3 onion routers (OR), Entry guard, middle, exit (circuit)</p>
    <p>Onion encrypts the message for the circuit</p>
    <p>Protect client (user) anonymity</p>
    <p>https://torproject.org</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 4 / 26</p>
  </div>
  <div class="page">
    <p>Backgound</p>
    <p>Tor: The Onion Router</p>
    <p>Conceal users identities and activities</p>
    <p>User picks 3 onion routers (OR), Entry guard, middle, exit (circuit)</p>
    <p>Onion encrypts the message for the circuit</p>
    <p>Protect client (user) anonymity</p>
    <p>https://torproject.org</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 4 / 26</p>
  </div>
  <div class="page">
    <p>Backgound</p>
    <p>Tor: The Onion Router</p>
    <p>Conceal users identities and activities</p>
    <p>User picks 3 onion routers (OR), Entry guard, middle, exit (circuit)</p>
    <p>Onion encrypts the message for the circuit</p>
    <p>Protect client (user) anonymity</p>
    <p>https://torproject.org</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 4 / 26</p>
  </div>
  <div class="page">
    <p>Backgound</p>
    <p>Tor: The Onion Router</p>
    <p>Conceal users identities and activities</p>
    <p>User picks 3 onion routers (OR), Entry guard, middle, exit (circuit)</p>
    <p>Onion encrypts the message for the circuit</p>
    <p>Protect client (user) anonymity</p>
    <p>https://torproject.org</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 4 / 26</p>
  </div>
  <div class="page">
    <p>Backgound</p>
    <p>Tor Hidden Services (HS)</p>
    <p>Mechanism for protecting server anonymity</p>
    <p>Useful for servers hosting sensitive information</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 5 / 26</p>
  </div>
  <div class="page">
    <p>Backgound</p>
    <p>Tor Hidden Services (HS)</p>
    <p>Mechanism for protecting server anonymity</p>
    <p>Useful for servers hosting sensitive information</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 5 / 26</p>
  </div>
  <div class="page">
    <p>Backgound</p>
    <p>Tor Hidden Services (HS)</p>
    <p>Mechanism for protecting server anonymity</p>
    <p>Useful for servers hosting sensitive information</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 5 / 26</p>
  </div>
  <div class="page">
    <p>Backgound</p>
    <p>Tor Hidden Services (HS)</p>
    <p>Mechanism for protecting server anonymity</p>
    <p>Useful for servers hosting sensitive information</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 5 / 26</p>
  </div>
  <div class="page">
    <p>Backgound</p>
    <p>Tor Hidden Services (HS)</p>
    <p>Mechanism for protecting server anonymity</p>
    <p>Useful for servers hosting sensitive information</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 5 / 26</p>
  </div>
  <div class="page">
    <p>Backgound</p>
    <p>Tor Hidden Services (HS)</p>
    <p>Mechanism for protecting server anonymity</p>
    <p>Useful for servers hosting sensitive information</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 5 / 26</p>
  </div>
  <div class="page">
    <p>Backgound</p>
    <p>Tor Hidden Services (HS)</p>
    <p>Mechanism for protecting server anonymity</p>
    <p>Useful for servers hosting sensitive information</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 5 / 26</p>
  </div>
  <div class="page">
    <p>Backgound</p>
    <p>Tor Hidden Services (HS)</p>
    <p>Mechanism for protecting server anonymity</p>
    <p>Useful for servers hosting sensitive information</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 5 / 26</p>
  </div>
  <div class="page">
    <p>Backgound</p>
    <p>Tor Hidden Services (HS)</p>
    <p>Mechanism for protecting server anonymity</p>
    <p>Useful for servers hosting sensitive information</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 5 / 26</p>
  </div>
  <div class="page">
    <p>Backgound</p>
    <p>Threat Model</p>
    <p>Provide anonymity unless both ends of a circuit are compromised</p>
    <p>For HS, need to compromise two entry guards</p>
    <p>HS users/servers should look the same as regular clients Our goal: break HS anonymity as a local adversary</p>
    <p>Can get accurate packet information Has circuit level visibility</p>
    <p>Malicious entry guard</p>
    <p>abc.onion</p>
    <p>xyz.onion</p>
    <p>Malicious Entry Guard</p>
    <p>Entry Guard</p>
    <p>The Tor Network</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 6 / 26</p>
  </div>
  <div class="page">
    <p>Backgound</p>
    <p>Threat Model</p>
    <p>Provide anonymity unless both ends of a circuit are compromised For HS, need to compromise two entry guards</p>
    <p>HS users/servers should look the same as regular clients Our goal: break HS anonymity as a local adversary</p>
    <p>Can get accurate packet information Has circuit level visibility</p>
    <p>Malicious entry guard</p>
    <p>abc.onion</p>
    <p>xyz.onion</p>
    <p>Malicious Entry Guard</p>
    <p>Entry Guard</p>
    <p>The Tor Network</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 6 / 26</p>
  </div>
  <div class="page">
    <p>Backgound</p>
    <p>Threat Model</p>
    <p>Provide anonymity unless both ends of a circuit are compromised For HS, need to compromise two entry guards</p>
    <p>HS users/servers should look the same as regular clients</p>
    <p>Our goal: break HS anonymity as a local adversary</p>
    <p>Can get accurate packet information Has circuit level visibility</p>
    <p>Malicious entry guard</p>
    <p>abc.onion</p>
    <p>xyz.onion</p>
    <p>Malicious Entry Guard</p>
    <p>Entry Guard</p>
    <p>The Tor Network</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 6 / 26</p>
  </div>
  <div class="page">
    <p>Backgound</p>
    <p>Threat Model</p>
    <p>Provide anonymity unless both ends of a circuit are compromised For HS, need to compromise two entry guards</p>
    <p>HS users/servers should look the same as regular clients Our goal: break HS anonymity as a local adversary</p>
    <p>Can get accurate packet information Has circuit level visibility</p>
    <p>Malicious entry guard</p>
    <p>abc.onion</p>
    <p>xyz.onion</p>
    <p>Malicious Entry Guard</p>
    <p>Entry Guard</p>
    <p>The Tor Network</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 6 / 26</p>
  </div>
  <div class="page">
    <p>Backgound</p>
    <p>Threat Model</p>
    <p>Provide anonymity unless both ends of a circuit are compromised For HS, need to compromise two entry guards</p>
    <p>HS users/servers should look the same as regular clients Our goal: break HS anonymity as a local adversary</p>
    <p>Can get accurate packet information</p>
    <p>Has circuit level visibility</p>
    <p>Malicious entry guard</p>
    <p>abc.onion</p>
    <p>xyz.onion</p>
    <p>Malicious Entry Guard</p>
    <p>Entry Guard</p>
    <p>The Tor Network</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 6 / 26</p>
  </div>
  <div class="page">
    <p>Backgound</p>
    <p>Threat Model</p>
    <p>Provide anonymity unless both ends of a circuit are compromised For HS, need to compromise two entry guards</p>
    <p>HS users/servers should look the same as regular clients Our goal: break HS anonymity as a local adversary</p>
    <p>Can get accurate packet information Has circuit level visibility</p>
    <p>Malicious entry guard</p>
    <p>abc.onion</p>
    <p>xyz.onion</p>
    <p>Malicious Entry Guard</p>
    <p>Entry Guard</p>
    <p>The Tor Network</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 6 / 26</p>
  </div>
  <div class="page">
    <p>Backgound</p>
    <p>Threat Model</p>
    <p>Provide anonymity unless both ends of a circuit are compromised For HS, need to compromise two entry guards</p>
    <p>HS users/servers should look the same as regular clients Our goal: break HS anonymity as a local adversary</p>
    <p>Can get accurate packet information Has circuit level visibility</p>
    <p>Malicious entry guard</p>
    <p>abc.onion</p>
    <p>xyz.onion</p>
    <p>Malicious Entry Guard</p>
    <p>Entry Guard</p>
    <p>The Tor Network</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 6 / 26</p>
  </div>
  <div class="page">
    <p>Backgound</p>
    <p>Approach and Experiments</p>
    <p>Experiments on live Tor network</p>
    <p>Client side experiment</p>
    <p>Visiting multiple websites and hidden services</p>
    <p>Server side experiment</p>
    <p>Our own HS that serves cached versions of other HS</p>
    <p>Identify HS circuits using their unique features</p>
    <p>Classify HS once the circuits are isolated</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 7 / 26</p>
  </div>
  <div class="page">
    <p>Backgound</p>
    <p>Approach and Experiments</p>
    <p>Experiments on live Tor network</p>
    <p>Client side experiment</p>
    <p>Visiting multiple websites and hidden services</p>
    <p>Server side experiment</p>
    <p>Our own HS that serves cached versions of other HS</p>
    <p>Identify HS circuits using their unique features</p>
    <p>Classify HS once the circuits are isolated</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 7 / 26</p>
  </div>
  <div class="page">
    <p>Backgound</p>
    <p>Approach and Experiments</p>
    <p>Experiments on live Tor network</p>
    <p>Client side experiment</p>
    <p>Visiting multiple websites and hidden services</p>
    <p>Server side experiment</p>
    <p>Our own HS that serves cached versions of other HS</p>
    <p>Identify HS circuits using their unique features</p>
    <p>Classify HS once the circuits are isolated</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 7 / 26</p>
  </div>
  <div class="page">
    <p>Backgound</p>
    <p>Approach and Experiments</p>
    <p>Experiments on live Tor network</p>
    <p>Client side experiment</p>
    <p>Visiting multiple websites and hidden services</p>
    <p>Server side experiment</p>
    <p>Our own HS that serves cached versions of other HS</p>
    <p>Identify HS circuits using their unique features</p>
    <p>Classify HS once the circuits are isolated</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 7 / 26</p>
  </div>
  <div class="page">
    <p>Backgound</p>
    <p>Approach and Experiments</p>
    <p>Experiments on live Tor network</p>
    <p>Client side experiment</p>
    <p>Visiting multiple websites and hidden services</p>
    <p>Server side experiment</p>
    <p>Our own HS that serves cached versions of other HS</p>
    <p>Identify HS circuits using their unique features</p>
    <p>Classify HS once the circuits are isolated</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 7 / 26</p>
  </div>
  <div class="page">
    <p>Observations</p>
    <p>Outline</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 8 / 26</p>
  </div>
  <div class="page">
    <p>Observations</p>
    <p>Characteristics: Cumulative Distribution Function</p>
    <p>The duration of activity</p>
    <p>The number of incoming cells The number of outgoing cells</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 9 / 26</p>
  </div>
  <div class="page">
    <p>Observations</p>
    <p>Characteristics: Cumulative Distribution Function</p>
    <p>The number of incoming cells The number of outgoing cells</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 9 / 26</p>
  </div>
  <div class="page">
    <p>Observations</p>
    <p>Observations</p>
    <p>IP circuits have unique characteristics</p>
    <p>HS-IPs are long-lived and Client-IPs are short-lived IPs have have little incoming and outgoing cells</p>
    <p>HS-RP circuits have more outgoing than incoming</p>
    <p>Streams for different .onion domains are not multiplexed</p>
    <p>IP and RP circuits are disjoint from general circuits</p>
    <p>Special circuits have particular starting cell sequences</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 10 / 26</p>
  </div>
  <div class="page">
    <p>Observations</p>
    <p>Observations</p>
    <p>IP circuits have unique characteristics</p>
    <p>HS-IPs are long-lived and Client-IPs are short-lived IPs have have little incoming and outgoing cells</p>
    <p>HS-RP circuits have more outgoing than incoming</p>
    <p>Streams for different .onion domains are not multiplexed</p>
    <p>IP and RP circuits are disjoint from general circuits</p>
    <p>Special circuits have particular starting cell sequences</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 10 / 26</p>
  </div>
  <div class="page">
    <p>Observations</p>
    <p>Observations</p>
    <p>IP circuits have unique characteristics</p>
    <p>HS-IPs are long-lived and Client-IPs are short-lived IPs have have little incoming and outgoing cells</p>
    <p>HS-RP circuits have more outgoing than incoming</p>
    <p>Streams for different .onion domains are not multiplexed</p>
    <p>IP and RP circuits are disjoint from general circuits</p>
    <p>Special circuits have particular starting cell sequences</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 10 / 26</p>
  </div>
  <div class="page">
    <p>Observations</p>
    <p>Observations</p>
    <p>IP circuits have unique characteristics</p>
    <p>HS-IPs are long-lived and Client-IPs are short-lived IPs have have little incoming and outgoing cells</p>
    <p>HS-RP circuits have more outgoing than incoming</p>
    <p>Streams for different .onion domains are not multiplexed</p>
    <p>IP and RP circuits are disjoint from general circuits</p>
    <p>Special circuits have particular starting cell sequences</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 10 / 26</p>
  </div>
  <div class="page">
    <p>Observations</p>
    <p>Observations</p>
    <p>IP circuits have unique characteristics</p>
    <p>HS-IPs are long-lived and Client-IPs are short-lived IPs have have little incoming and outgoing cells</p>
    <p>HS-RP circuits have more outgoing than incoming</p>
    <p>Streams for different .onion domains are not multiplexed</p>
    <p>IP and RP circuits are disjoint from general circuits</p>
    <p>Special circuits have particular starting cell sequences</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 10 / 26</p>
  </div>
  <div class="page">
    <p>Circuit Fingerprinting Attack</p>
    <p>Outline</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 11 / 26</p>
  </div>
  <div class="page">
    <p>Circuit Fingerprinting Attack</p>
    <p>Circuit Classification Attack</p>
    <p>Use the characteristics to classify circuits</p>
    <p>HS-IP, Client-IP, HS-RP, Client-RP, and General</p>
    <p>Features of the circuits</p>
    <p>Duration of activity The number of incoming and outgoing cells Sequence of the first 10 cells</p>
    <p>Tree-based and k-NN for classifier</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 12 / 26</p>
  </div>
  <div class="page">
    <p>Circuit Fingerprinting Attack</p>
    <p>Circuit Classification Attack</p>
    <p>Use the characteristics to classify circuits</p>
    <p>HS-IP, Client-IP, HS-RP, Client-RP, and General</p>
    <p>Features of the circuits</p>
    <p>Duration of activity The number of incoming and outgoing cells Sequence of the first 10 cells</p>
    <p>Tree-based and k-NN for classifier</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 12 / 26</p>
  </div>
  <div class="page">
    <p>Circuit Fingerprinting Attack</p>
    <p>Circuit Classification Attack</p>
    <p>Use the characteristics to classify circuits</p>
    <p>HS-IP, Client-IP, HS-RP, Client-RP, and General</p>
    <p>Features of the circuits</p>
    <p>Duration of activity The number of incoming and outgoing cells Sequence of the first 10 cells</p>
    <p>Tree-based and k-NN for classifier</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 12 / 26</p>
  </div>
  <div class="page">
    <p>Circuit Fingerprinting Attack</p>
    <p>IP-Decision Tree</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 13 / 26</p>
  </div>
  <div class="page">
    <p>Circuit Fingerprinting Attack</p>
    <p>IP-Decision Tree</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 13 / 26</p>
  </div>
  <div class="page">
    <p>Circuit Fingerprinting Attack</p>
    <p>IP-Decision Tree</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 13 / 26</p>
  </div>
  <div class="page">
    <p>Circuit Fingerprinting Attack</p>
    <p>IP-Decision Tree</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 13 / 26</p>
  </div>
  <div class="page">
    <p>Circuit Fingerprinting Attack</p>
    <p>IP-Decision Tree</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 13 / 26</p>
  </div>
  <div class="page">
    <p>Circuit Fingerprinting Attack</p>
    <p>RP-Decision Tree</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 14 / 26</p>
  </div>
  <div class="page">
    <p>Circuit Fingerprinting Attack</p>
    <p>RP-Decision Tree</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 14 / 26</p>
  </div>
  <div class="page">
    <p>Circuit Fingerprinting Attack</p>
    <p>RP-Decision Tree</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 14 / 26</p>
  </div>
  <div class="page">
    <p>Circuit Fingerprinting Attack</p>
    <p>RP-Decision Tree</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 14 / 26</p>
  </div>
  <div class="page">
    <p>Circuit Fingerprinting Attack</p>
    <p>RP-Uniqueness</p>
    <p>Sequences: O, I, O, I, O, I, I, O, I, O</p>
    <p>O, I, O, I, O, I, I, O, I</p>
    <p>O, I, O, I, O, I, I, O, I, I</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 15 / 26</p>
  </div>
  <div class="page">
    <p>Circuit Fingerprinting Attack</p>
    <p>RP-Uniqueness</p>
    <p>Sequences: O, I, O, I, O, I, I, O, I, O</p>
    <p>O, I, O, I, O, I, I, O, I</p>
    <p>O, I, O, I, O, I, I, O, I, I</p>
    <p>User Guard extend extended extend extended</p>
    <p>begin connected</p>
    <p>General circuit</p>
    <p>User Guard extend extended extend extended</p>
    <p>begin connected</p>
    <p>establish_rend rend_extended rendevous2</p>
    <p>Client-RP circuit (Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 15 / 26</p>
  </div>
  <div class="page">
    <p>Circuit Fingerprinting Attack</p>
    <p>RP-Uniqueness</p>
    <p>Sequences: O, I, O, I, O, I, I, O, I, O</p>
    <p>O, I, O, I, O, I, I, O, I</p>
    <p>O, I, O, I, O, I, I, O, I, I</p>
    <p>User Guard extend extended extend extended</p>
    <p>begin connected</p>
    <p>General circuit</p>
    <p>User Guard extend extended extend extended</p>
    <p>begin connected</p>
    <p>establish_rend rend_extended rendevous2</p>
    <p>Client-RP circuit (Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 15 / 26</p>
  </div>
  <div class="page">
    <p>Circuit Fingerprinting Attack</p>
    <p>Evaluation: Circuit Classification</p>
    <p>Dataset</p>
    <p>Ac cu</p>
    <p>ra cy</p>
    <p>Client-IP HS-IP Other10 -4</p>
    <p>Fa ls</p>
    <p>e Po</p>
    <p>si tiv</p>
    <p>e Ra</p>
    <p>te</p>
    <p>Client-IP HS-IP Other 0.8</p>
    <p>Tr ue</p>
    <p>P os</p>
    <p>iti ve</p>
    <p>R at</p>
    <p>e</p>
    <p>C4.5 CART k-NN</p>
    <p>IP Classification Accuracy</p>
    <p>Ac cu</p>
    <p>ra cy</p>
    <p>Client-RP HS-RP Other10 -4</p>
    <p>Fa ls</p>
    <p>e Po</p>
    <p>si tiv</p>
    <p>e Ra</p>
    <p>te</p>
    <p>Client-RP HS-RP Other 0.8</p>
    <p>Tr ue</p>
    <p>P os</p>
    <p>iti ve</p>
    <p>R at</p>
    <p>e</p>
    <p>C4.5 CART k-NN</p>
    <p>RP Classification Accuracy</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 16 / 26</p>
  </div>
  <div class="page">
    <p>Website Fingerprinting Hidden Services</p>
    <p>Outline</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 17 / 26</p>
  </div>
  <div class="page">
    <p>Website Fingerprinting Hidden Services</p>
    <p>Website Fingerprinting (WF)</p>
    <p>Local adversary to deanonymize a user</p>
    <p>Classify websites using features of the communication</p>
    <p>Duration of activity Number of incoming/outgoing Bursts of incoming/outgoing</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 18 / 26</p>
  </div>
  <div class="page">
    <p>Website Fingerprinting Hidden Services</p>
    <p>WF Criticisms</p>
    <p>Noisy streams of data</p>
    <p>General circuits are multiplexed between multiple connections</p>
    <p>Size of the world</p>
    <p>Experiments only include &lt; 10,000 websites</p>
    <p>Rapidly changing pages</p>
    <p>Websites contents (and thus traffic) are constantly changing</p>
    <p>Juarez et al., A Critical Evaluation of Website Fingerprinting Attacks, CCS 2014.</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 19 / 26</p>
  </div>
  <div class="page">
    <p>Website Fingerprinting Hidden Services</p>
    <p>WF Criticisms</p>
    <p>Noisy streams of data</p>
    <p>General circuits are multiplexed between multiple connections</p>
    <p>Size of the world</p>
    <p>Experiments only include &lt; 10,000 websites</p>
    <p>Rapidly changing pages</p>
    <p>Websites contents (and thus traffic) are constantly changing</p>
    <p>Juarez et al., A Critical Evaluation of Website Fingerprinting Attacks, CCS 2014.</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 19 / 26</p>
  </div>
  <div class="page">
    <p>Website Fingerprinting Hidden Services</p>
    <p>WF Criticisms</p>
    <p>Noisy streams of data</p>
    <p>General circuits are multiplexed between multiple connections</p>
    <p>Size of the world</p>
    <p>Experiments only include &lt; 10,000 websites</p>
    <p>Rapidly changing pages</p>
    <p>Websites contents (and thus traffic) are constantly changing</p>
    <p>Juarez et al., A Critical Evaluation of Website Fingerprinting Attacks, CCS 2014.</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 19 / 26</p>
  </div>
  <div class="page">
    <p>Website Fingerprinting Hidden Services</p>
    <p>Website Fingerprinting HS</p>
    <p>HS circuits are not shared</p>
    <p>Different .onion use different circuits RP circuits and general circuits are disjoint</p>
    <p>Size of the world is significantly smaller</p>
    <p>Only 30,000 unique .onion address Even smaller number of popular HS</p>
    <p>HS pages are not rapidly changing</p>
    <p>Similarity 1 week 2 weeks 3 weeks 8 weeks Q1 1 0.997 0.994 0.980</p>
    <p>Median 1 1 1 1 Q3 1 1 1 1</p>
    <p>Mean 0.96 0.97 0.96 0.927</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 20 / 26</p>
  </div>
  <div class="page">
    <p>Website Fingerprinting Hidden Services</p>
    <p>Website Fingerprinting HS</p>
    <p>HS circuits are not shared</p>
    <p>Different .onion use different circuits RP circuits and general circuits are disjoint</p>
    <p>Size of the world is significantly smaller</p>
    <p>Only 30,000 unique .onion address Even smaller number of popular HS</p>
    <p>HS pages are not rapidly changing</p>
    <p>Similarity 1 week 2 weeks 3 weeks 8 weeks Q1 1 0.997 0.994 0.980</p>
    <p>Median 1 1 1 1 Q3 1 1 1 1</p>
    <p>Mean 0.96 0.97 0.96 0.927</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 20 / 26</p>
  </div>
  <div class="page">
    <p>Website Fingerprinting Hidden Services</p>
    <p>Website Fingerprinting HS</p>
    <p>HS circuits are not shared</p>
    <p>Different .onion use different circuits RP circuits and general circuits are disjoint</p>
    <p>Size of the world is significantly smaller</p>
    <p>Only 30,000 unique .onion address Even smaller number of popular HS</p>
    <p>HS pages are not rapidly changing</p>
    <p>Similarity 1 week 2 weeks 3 weeks 8 weeks Q1 1 0.997 0.994 0.980</p>
    <p>Median 1 1 1 1 Q3 1 1 1 1</p>
    <p>Mean 0.96 0.97 0.96 0.927</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 20 / 26</p>
  </div>
  <div class="page">
    <p>Website Fingerprinting Hidden Services</p>
    <p>WF Experiments</p>
    <p>Training set</p>
    <p>Clients/servers visit/serve one of the 1000 pages</p>
    <p>Classify into one of the sensitives or non-sensitive</p>
    <p>Our own HS serving cached pages</p>
    <p>Tree-based and k-NN classifier</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 21 / 26</p>
  </div>
  <div class="page">
    <p>Website Fingerprinting Hidden Services</p>
    <p>WF Experiments</p>
    <p>Training set</p>
    <p>Clients/servers visit/serve one of the 1000 pages</p>
    <p>Classify into one of the sensitives or non-sensitive</p>
    <p>Our own HS serving cached pages</p>
    <p>Tree-based and k-NN classifier</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 21 / 26</p>
  </div>
  <div class="page">
    <p>Website Fingerprinting Hidden Services</p>
    <p>WF Experiments</p>
    <p>Training set</p>
    <p>Clients/servers visit/serve one of the 1000 pages</p>
    <p>Classify into one of the sensitives or non-sensitive</p>
    <p>Our own HS serving cached pages</p>
    <p>Tree-based and k-NN classifier</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 21 / 26</p>
  </div>
  <div class="page">
    <p>Website Fingerprinting Hidden Services</p>
    <p>WF Experiments</p>
    <p>Training set</p>
    <p>Clients/servers visit/serve one of the 1000 pages</p>
    <p>Classify into one of the sensitives or non-sensitive Our own HS serving cached pages</p>
    <p>Tree-based and k-NN classifier</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 21 / 26</p>
  </div>
  <div class="page">
    <p>Website Fingerprinting Hidden Services</p>
    <p>WF Experiments</p>
    <p>Training set</p>
    <p>Clients/servers visit/serve one of the 1000 pages</p>
    <p>Classify into one of the sensitives or non-sensitive Our own HS serving cached pages</p>
    <p>Tree-based and k-NN classifier</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 21 / 26</p>
  </div>
  <div class="page">
    <p>Website Fingerprinting Hidden Services</p>
    <p>WF Accuracy</p>
    <p>Fa ls</p>
    <p>e Po</p>
    <p>si tiv</p>
    <p>e Ra</p>
    <p>te C4.5 CART k-NN</p>
    <p>Tr ue</p>
    <p>P os</p>
    <p>iti ve</p>
    <p>R at</p>
    <p>e</p>
    <p>Client accuracy (Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 22 / 26</p>
  </div>
  <div class="page">
    <p>Website Fingerprinting Hidden Services</p>
    <p>WF Accuracy</p>
    <p>Fa ls</p>
    <p>e Po</p>
    <p>si tiv</p>
    <p>e Ra</p>
    <p>te C4.5 CART k-NN</p>
    <p>Tr ue</p>
    <p>P os</p>
    <p>iti ve</p>
    <p>R at</p>
    <p>e</p>
    <p>Server accuracy (Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 22 / 26</p>
  </div>
  <div class="page">
    <p>Conclusion</p>
    <p>Outline</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 23 / 26</p>
  </div>
  <div class="page">
    <p>Conclusion</p>
    <p>Potential Defenses</p>
    <p>Circuit classification defense</p>
    <p>Obfuscate the features</p>
    <p>Website Fingerprinting</p>
    <p>Multiplex the RP circuits Previous work on defending WF attacks</p>
    <p>Wang et al., Effective Attacks and Provable Defenses for Website Fingerprinting, USENIX Security 2014.</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 24 / 26</p>
  </div>
  <div class="page">
    <p>Conclusion</p>
    <p>Conclusion</p>
    <p>Hidden service connections are fingerprintable</p>
    <p>Website fingerprinting is more realistic in the domain of HS</p>
    <p>Demonstrated effectiveness of the proposed attacks</p>
    <p>Data available at http://people.csail.mit.edu/kwonal/hswf.tar.gz</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 25 / 26</p>
  </div>
  <div class="page">
    <p>Conclusion</p>
    <p>Thank you!</p>
    <p>(Usenix Security 2015) Circuit Fingerprinting Attack August 25, 2015 26 / 26</p>
  </div>
</Presentation>
