<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Web-based Attacks on Host-Proof Encrypted Storage</p>
    <p>A. Delignat-Lavaud K. Bhargavan</p>
    <p>PROSECCO, INRIA Paris-Rocquencourt</p>
    <p>WOOT12 August 7, 2012</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Host-Proof Application Design</p>
    <p>User</p>
    <p>Content Server Client Application</p>
    <p>Sensitive dataHacker X</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Host-Proof Application Design</p>
    <p>User</p>
    <p>Content Server Client Application</p>
    <p>Sensitive dataHacker X</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Host-Proof Application A foolproof design?</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Host-Proof Web Application Uh-Oh.</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Host-Proof Pattern: Cloud Storage</p>
    <p>User</p>
    <p>Server App Website</p>
    <p>Decrypted Data</p>
    <p>authentication</p>
    <p>encrypted data</p>
    <p>decryption script</p>
    <p>decryption</p>
    <p>Hacker</p>
    <p>CSRF</p>
    <p>XSS</p>
    <p>Hacker</p>
    <p>key</p>
    <p>Friends?</p>
    <p>sharing</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Host-Proof Pattern: Cloud Storage</p>
    <p>User</p>
    <p>Server App Website</p>
    <p>Decrypted Data</p>
    <p>authentication</p>
    <p>encrypted data</p>
    <p>decryption script</p>
    <p>decryption</p>
    <p>Hacker</p>
    <p>CSRF</p>
    <p>XSS</p>
    <p>Hacker</p>
    <p>key</p>
    <p>Friends?</p>
    <p>sharing</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Host-Proof Pattern: Cloud Storage</p>
    <p>User</p>
    <p>Server App Website</p>
    <p>Decrypted Data</p>
    <p>authentication</p>
    <p>encrypted data</p>
    <p>malicious script</p>
    <p>decryption</p>
    <p>Hacker</p>
    <p>CSRF</p>
    <p>XSS</p>
    <p>Hacker</p>
    <p>key</p>
    <p>Friends?</p>
    <p>sharing</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Host-Proof Pattern: Cloud Storage</p>
    <p>User</p>
    <p>Server App Website</p>
    <p>Decrypted Data</p>
    <p>authentication</p>
    <p>encrypted data</p>
    <p>decryption script</p>
    <p>decryption</p>
    <p>Hacker</p>
    <p>CSRF</p>
    <p>XSS</p>
    <p>Hacker</p>
    <p>key</p>
    <p>Friends?</p>
    <p>sharing</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Host-Proof Patterns: Password Manager</p>
    <p>Server</p>
    <p>Host Page</p>
    <p>Extension</p>
    <p>User</p>
    <p>session</p>
    <p>URL password</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Host-Proof Patterns: Password Manager</p>
    <p>Server</p>
    <p>Host Page</p>
    <p>Extension</p>
    <p>User</p>
    <p>session</p>
    <p>URL password</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Host-Proof Patterns: Password Manager</p>
    <p>Server</p>
    <p>Host Page</p>
    <p>Extension</p>
    <p>User</p>
    <p>session</p>
    <p>URL password</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Host-Proof Patterns: Password Manager</p>
    <p>Server</p>
    <p>Host Page</p>
    <p>Extension</p>
    <p>User</p>
    <p>session</p>
    <p>URL password</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Host-Proof Pattern: Roaming Password Manager</p>
    <p>Server</p>
    <p>App Website Host Page</p>
    <p>Bookmarklet</p>
    <p>User</p>
    <p>secret</p>
    <p>session intention</p>
    <p>session</p>
    <p>URL password</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Host-Proof Pattern: Roaming Password Manager</p>
    <p>Server</p>
    <p>App Website Host Page</p>
    <p>Bookmarklet</p>
    <p>User</p>
    <p>secret</p>
    <p>session intention</p>
    <p>session</p>
    <p>URL password</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Host-Proof Pattern: Roaming Password Manager</p>
    <p>Server</p>
    <p>App Website Host Page</p>
    <p>Bookmarklet</p>
    <p>User</p>
    <p>secret</p>
    <p>session intention</p>
    <p>session</p>
    <p>URL password</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Host-Proof Pattern: Roaming Password Manager</p>
    <p>Server</p>
    <p>App Website Host Page</p>
    <p>Bookmarklet</p>
    <p>User</p>
    <p>secret</p>
    <p>session intention</p>
    <p>session</p>
    <p>URL password</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Host-Proof Pattern: Roaming Password Manager</p>
    <p>Server</p>
    <p>App Website Host Page</p>
    <p>Bookmarklet</p>
    <p>User</p>
    <p>secret</p>
    <p>session intention</p>
    <p>session</p>
    <p>URL password</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Host-Proof Pattern: Roaming Password Manager</p>
    <p>Server</p>
    <p>App Website Host Page</p>
    <p>Bookmarklet</p>
    <p>User</p>
    <p>secret</p>
    <p>session intention</p>
    <p>session</p>
    <p>URL password</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Host-Proof Pattern: Roaming Password Manager</p>
    <p>Server</p>
    <p>App Website Host Page</p>
    <p>Bookmarklet</p>
    <p>User</p>
    <p>secret</p>
    <p>session intention</p>
    <p>session</p>
    <p>URL password</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Exploiting the weak points</p>
    <p>What can go wrong? I Encryption and ciphertext sharing. I Authorized release of plaintext. I Key management. I Programming errors.</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Exploiting the weak points</p>
    <p>What can go wrong? I Encryption and ciphertext sharing. I Authorized release of plaintext. I Key management. I Programming errors.</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Exploiting the weak points</p>
    <p>What can go wrong? I Encryption and ciphertext sharing. I Authorized release of plaintext. I Key management. I Programming errors.</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Exploiting the weak points</p>
    <p>What can go wrong? I Encryption and ciphertext sharing. I Authorized release of plaintext. I Key management. I Programming errors.</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Strong crypto primitives</p>
    <p>Name Key Derivation Encryption Integrity Crypt Meta Wuala PBKDF2-SHA256 AES, RSA HMAC ! SpiderOak PBKDF2-SHA256 AES, RSA HMAC ! BoxCryptor PBKDF2 AES None # CloudFogger PBKDF2 AES, RSA None # LastPass PBKDF2-SHA256 AES, RSA None # PassPack SHA256 AES Records ! RoboForm PBKDF2 AES, DES None # 1Password PBKDF2-SHA1 AES None # Clipperz SHA256 AES SHA-256 !</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Key derivation</p>
    <p>Andrey Belenko and Dmitry Sklyarov Secure Password Managers&quot; and Military-Grade Encryption&quot; on Smartphones: Oh, Really? Elcomsoft Technical Report</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Incorrect use of crypto</p>
    <p>Old wisdom from Steven Bellovin Without integrity protection, encryption is all but useless.</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>No ciphertext integrity protection</p>
    <p>RoboForm Passcard URL3:Encode(URL)</p>
    <p>+PROTECTED-2+</p>
    <p>&lt;ENCk(username,password)&gt;</p>
    <p>&quot;encrypted&quot;:&lt;ENCk(username,password)&gt;}</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>No ciphertext integrity protection</p>
    <p>User</p>
    <p>Content Server google.com</p>
    <p>ENC(u, p)</p>
    <p>Client Application</p>
    <p>google.com</p>
    <p>p</p>
    <p>Hacker p</p>
    <p>Friend google.com</p>
    <p>ENC(u, p)</p>
    <p>share</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>No ciphertext integrity protection</p>
    <p>User</p>
    <p>Content Server bad.com</p>
    <p>ENC(u, p)</p>
    <p>Client Application</p>
    <p>bad.com</p>
    <p>p</p>
    <p>Hacker p</p>
    <p>Friend google.com</p>
    <p>ENC(u, p)</p>
    <p>share</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>No ciphertext integrity protection</p>
    <p>User</p>
    <p>Content Server google.com</p>
    <p>ENC(u, p)</p>
    <p>Client Application</p>
    <p>google.com</p>
    <p>p</p>
    <p>Hacker p</p>
    <p>Friend google.com</p>
    <p>ENC(u, p)</p>
    <p>share</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Authorized release of plaintext</p>
    <p>Classic problem: URL authenticating I Browser extension-based password managers; I Match URL with password database in JS. I Error-prone RegExp matching.</p>
    <p>parseUri pattern /^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)</p>
    <p>(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?</p>
    <p>((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?</p>
    <p>(?:#(.*))?)/</p>
    <p>Incorrect http://bad.com/#@accounts.google.com</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Authorized release of plaintext</p>
    <p>Classic problem: URL authenticating I Browser extension-based password managers; I Match URL with password database in JS. I Error-prone RegExp matching.</p>
    <p>parseUri pattern /^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)</p>
    <p>(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?</p>
    <p>((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?</p>
    <p>(?:#(.*))?)/</p>
    <p>Incorrect http://bad.com/#@accounts.google.com</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Authorized release of plaintext</p>
    <p>Classic problem: URL authenticating I Browser extension-based password managers; I Match URL with password database in JS. I Error-prone RegExp matching.</p>
    <p>parseUri pattern /^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)</p>
    <p>(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?</p>
    <p>((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?</p>
    <p>(?:#(.*))?)/</p>
    <p>Incorrect http://bad.com/#@accounts.google.com</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Authorized release of plaintext</p>
    <p>Classic problem: URL authenticating I Browser extension-based password managers; I Match URL with password database in JS. I Error-prone RegExp matching.</p>
    <p>parseUri pattern /^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)</p>
    <p>(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?</p>
    <p>((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?</p>
    <p>(?:#(.*))?)/</p>
    <p>Incorrect http://bad.com/#@accounts.google.com</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Authorized release of plaintext</p>
    <p>Classic problem: URL authenticating I Browser extension-based password managers; I Match URL with password database in JS. I Error-prone RegExp matching.</p>
    <p>parseUri pattern /^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)</p>
    <p>(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?</p>
    <p>((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?</p>
    <p>(?:#(.*))?)/</p>
    <p>Incorrect http://bad.com/#@accounts.google.com</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Phishing attack on 1Password extension</p>
    <p>URL parsing code var href = getBrowser().contentWindow</p>
    <p>.location.href + &quot;/&quot;;</p>
    <p>var domain = href.replace(</p>
    <p>/^http[s]*:\/\/(.*?)\/.*$/i, &quot;$1&quot;);</p>
    <p>var middle = domain.replace(</p>
    <p>/^(www.)*(.*)/i, &quot;$2&quot;);</p>
    <p>return middle.substring(0,1).toUpperCase() +</p>
    <p>middle.substring(1,middle.length);</p>
    <p>Phishing URL http://www.google.com:xxx@bad.com</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Phishing attack on 1Password extension</p>
    <p>URL parsing code var href = getBrowser().contentWindow</p>
    <p>.location.href + &quot;/&quot;;</p>
    <p>var domain = href.replace(</p>
    <p>/^http[s]*:\/\/(.*?)\/.*$/i, &quot;$1&quot;);</p>
    <p>var middle = domain.replace(</p>
    <p>/^(www.)*(.*)/i, &quot;$2&quot;);</p>
    <p>return middle.substring(0,1).toUpperCase() +</p>
    <p>middle.substring(1,middle.length);</p>
    <p>Phishing URL http://www.google.com:xxx@bad.com</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Server</p>
    <p>Attacker</p>
    <p>User</p>
    <p>session</p>
    <p>Phishing URL Googlepassword</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Server</p>
    <p>Attacker</p>
    <p>User</p>
    <p>session</p>
    <p>Phishing URL Googlepassword</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Server</p>
    <p>Attacker</p>
    <p>User</p>
    <p>session</p>
    <p>Phishing URL Googlepassword</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Usual range of web attacks</p>
    <p>Web interfaces I Hard to maintain client-side decryption due</p>
    <p>to JavaScript limitations. I Login form exposed to web attacks. I Decryption in same scope as GUI and user</p>
    <p>data.</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Usual range of web attacks</p>
    <p>Web interfaces I Hard to maintain client-side decryption due</p>
    <p>to JavaScript limitations. I Login form exposed to web attacks. I Decryption in same scope as GUI and user</p>
    <p>data.</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Usual range of web attacks</p>
    <p>Web interfaces I Hard to maintain client-side decryption due</p>
    <p>to JavaScript limitations. I Login form exposed to web attacks. I Decryption in same scope as GUI and user</p>
    <p>data.</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>SpiderOak</p>
    <p>User</p>
    <p>Server SpiderOak</p>
    <p>session</p>
    <p>JSON listing</p>
    <p>Attacker JSONP query</p>
    <p>JSON listing</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>SpiderOak</p>
    <p>User</p>
    <p>Server SpiderOak</p>
    <p>session</p>
    <p>JSON listing</p>
    <p>Attacker JSONP query</p>
    <p>JSON listing</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>SpiderOak</p>
    <p>User</p>
    <p>Server SpiderOak</p>
    <p>session</p>
    <p>JSON listing</p>
    <p>Attacker JSONP query</p>
    <p>JSON listing</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>SpiderOak</p>
    <p>Query https://spideroak.com/storage/&lt;u32&gt;/?callback=f</p>
    <p>Result f({</p>
    <p>&quot;stats&quot;: {</p>
    <p>&quot;firstname&quot;: &quot;...&quot;,</p>
    <p>&quot;lastname&quot;: &quot;...&quot;,</p>
    <p>&quot;devices&quot;: ...,</p>
    <p>},</p>
    <p>&quot;devices&quot;: [</p>
    <p>[&quot;pc1&quot;, &quot;pc1/&quot;],[&quot;laptop&quot;, &quot;laptop/&quot;],...</p>
    <p>]</p>
    <p>})</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>SpiderOak</p>
    <p>Query https://spideroak.com/storage/&lt;u32&gt;/shares</p>
    <p>Result {</p>
    <p>&quot;share_rooms&quot; : [</p>
    <p>&quot;url&quot; : &quot;/browse/share/&lt;id&gt;/&lt;key&gt;&quot;,</p>
    <p>&quot;room_key&quot; : &quot;&lt;key&gt;&quot;,</p>
    <p>&quot;room_description&quot; : &quot;&quot; ,</p>
    <p>&quot;room_name&quot;: &quot;&lt;room&gt;&quot;</p>
    <p>],</p>
    <p>&quot;share_id&quot; : &quot;&lt;id&gt;&quot;,</p>
    <p>&quot;share_id_b32&quot; : &quot;&lt;u32&gt;&quot;</p>
    <p>}</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Key management</p>
    <p>A difficult challenge I All applications implement some form of</p>
    <p>sharing. I Key policy: reencrypt? Key hierarchy? Share</p>
    <p>keys? Share plaintexts? I Design errors virtually impossible to fix.</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Key management</p>
    <p>A difficult challenge I All applications implement some form of</p>
    <p>sharing. I Key policy: reencrypt? Key hierarchy? Share</p>
    <p>keys? Share plaintexts? I Design errors virtually impossible to fix.</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Key management</p>
    <p>A difficult challenge I All applications implement some form of</p>
    <p>sharing. I Key policy: reencrypt? Key hierarchy? Share</p>
    <p>keys? Share plaintexts? I Design errors virtually impossible to fix.</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>LastPass login bookmarklet</p>
    <p>Server</p>
    <p>App Website Attacker</p>
    <p>Bookmarklet</p>
    <p>User</p>
    <p>s</p>
    <p>K</p>
    <p>session intention</p>
    <p>session</p>
    <p>D, Encs,r(K), r</p>
    <p>rootkit K</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>LastPass login bookmarklet</p>
    <p>Server</p>
    <p>App Website Attacker</p>
    <p>Bookmarklet</p>
    <p>User</p>
    <p>s</p>
    <p>K</p>
    <p>session intention</p>
    <p>session</p>
    <p>D, Encs,r(K), r</p>
    <p>rootkit K</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>LastPass login bookmarklet</p>
    <p>Server</p>
    <p>App Website Attacker</p>
    <p>Bookmarklet</p>
    <p>User</p>
    <p>s</p>
    <p>K</p>
    <p>session intention</p>
    <p>session</p>
    <p>D, Encs,r(K), r</p>
    <p>rootkit K</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>LastPass login bookmarklet</p>
    <p>Server</p>
    <p>App Website Attacker</p>
    <p>Bookmarklet</p>
    <p>User</p>
    <p>s</p>
    <p>K</p>
    <p>session intention</p>
    <p>session</p>
    <p>D, Encs,r(K), r</p>
    <p>rootkit K</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>LastPass login bookmarklet</p>
    <p>Server</p>
    <p>App Website Attacker</p>
    <p>Bookmarklet</p>
    <p>User</p>
    <p>s</p>
    <p>K</p>
    <p>session intention</p>
    <p>session</p>
    <p>D, Encs,r(K), r</p>
    <p>rootkit K</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>LastPass login bookmarklet</p>
    <p>Server</p>
    <p>App Website Attacker</p>
    <p>Bookmarklet</p>
    <p>User</p>
    <p>s</p>
    <p>K</p>
    <p>session intention</p>
    <p>session</p>
    <p>D, Encs,r(K), r</p>
    <p>rootkit K</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Key recovery by rootkiting</p>
    <p>Key recovery by rootkiting function _LP_START() {</p>
    <p>_LP = new _LP_CONTAINER();</p>
    <p>var d = {&lt;encrypted form data&gt;};</p>
    <p>_LP.setVars(d, '&lt;user&gt;',</p>
    <p>'&lt;encrypted_key&gt;', _LASTPASS_RAND, ...);</p>
    <p>_LP.bmMulti(null, null);</p>
    <p>}</p>
    <p>Ben Adida, Adam Barth and Collin Jackson Rootkits for JavaScript environments WOOT2009</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Towards secure host-proof web applications</p>
    <p>Is secure crypto possible in browsers? Matasano plea: JavaScript Cryptography Considered Harmful:</p>
    <p>I Secure delivery of JavaScript to browsers is a chicken-egg problem.</p>
    <p>I Browser Javascript is hostile to cryptography. I The view-source transparency of JavaScript</p>
    <p>is illusory.</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Towards secure host-proof web applications</p>
    <p>Is secure crypto possible in browsers? Matasano plea: JavaScript Cryptography Considered Harmful:</p>
    <p>I Secure delivery of JavaScript to browsers is a chicken-egg problem.</p>
    <p>I Browser Javascript is hostile to cryptography. I The view-source transparency of JavaScript</p>
    <p>is illusory.</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Towards secure host-proof web applications</p>
    <p>Is secure crypto possible in browsers? Matasano plea: JavaScript Cryptography Considered Harmful:</p>
    <p>I Secure delivery of JavaScript to browsers is a chicken-egg problem.</p>
    <p>I Browser Javascript is hostile to cryptography. I The view-source transparency of JavaScript</p>
    <p>is illusory.</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Available building blocks</p>
    <p>Server side I Origin HTTP header. I Access-Control-Allow-Origin. I Content Security Policy.</p>
    <p>Client side I Browser extension sandboxing. I Web Crypto API. I ECMA 6 I HTML5 frame sandboxing. I HTML5 local storage.</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Available building blocks</p>
    <p>Server side I Origin HTTP header. I Access-Control-Allow-Origin. I Content Security Policy.</p>
    <p>Client side I Browser extension sandboxing. I Web Crypto API. I ECMA 6 I HTML5 frame sandboxing. I HTML5 local storage.</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Available building blocks</p>
    <p>Server side I Origin HTTP header. I Access-Control-Allow-Origin. I Content Security Policy.</p>
    <p>Client side I Browser extension sandboxing. I Web Crypto API. I ECMA 6 I HTML5 frame sandboxing. I HTML5 local storage.</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Available building blocks</p>
    <p>Server side I Origin HTTP header. I Access-Control-Allow-Origin. I Content Security Policy.</p>
    <p>Client side I Browser extension sandboxing. I Web Crypto API. I ECMA 6 I HTML5 frame sandboxing. I HTML5 local storage.</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Available building blocks</p>
    <p>Server side I Origin HTTP header. I Access-Control-Allow-Origin. I Content Security Policy.</p>
    <p>Client side I Browser extension sandboxing. I Web Crypto API. I ECMA 6 I HTML5 frame sandboxing. I HTML5 local storage.</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Available building blocks</p>
    <p>Server side I Origin HTTP header. I Access-Control-Allow-Origin. I Content Security Policy.</p>
    <p>Client side I Browser extension sandboxing. I Web Crypto API. I ECMA 6 I HTML5 frame sandboxing. I HTML5 local storage.</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Available building blocks</p>
    <p>Server side I Origin HTTP header. I Access-Control-Allow-Origin. I Content Security Policy.</p>
    <p>Client side I Browser extension sandboxing. I Web Crypto API. I ECMA 6 I HTML5 frame sandboxing. I HTML5 local storage.</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Available building blocks</p>
    <p>Server side I Origin HTTP header. I Access-Control-Allow-Origin. I Content Security Policy.</p>
    <p>Client side I Browser extension sandboxing. I Web Crypto API. I ECMA 6 I HTML5 frame sandboxing. I HTML5 local storage.</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Connecting the dots New automated security analysis tools</p>
    <p>I Formal models of crypto in web apps: WebSpi / ProVerif.</p>
    <p>I Formal models of JavaScript security: Alloy model, JS subsets.</p>
    <p>I Information flow analyses: Jif (A. Myers), jsflow (D. Hedin, A. Sabelfeld), Zdancewic and Li.</p>
    <p>Chetan Bansal, Karthikeyan Bhargavan and Sergio Maffeis Discovering Concrete Attacks on Website Authrorization by Formal Analysis CSF 2012 (to appear) Akhawe, Barth, Lam, Mitchell, Song Towards a Formal Foundation of Web Security CSF 2010</p>
  </div>
  <div class="page">
    <p>Web-based Attacks on Host-Proof</p>
    <p>Encrypted Storage</p>
    <p>Delignat-Lavaud, Bhargavan</p>
    <p>Introduction Host-Proof Application Design Web Patterns</p>
    <p>Towards secure host-proof web applications</p>
    <p>Thank you. ... as well as ERC and USENIX Sponsors.</p>
  </div>
</Presentation>
