<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>An EntropyAn Entropy--based Objective based Objective</p>
    <p>Evaluation Method for Image Evaluation Method for Image</p>
    <p>SegmentationSegmentation</p>
    <p>Hui Zhang, Hui Zhang, Jason E. FrittsJason E. Fritts, Sally A. Goldman, Sally A. Goldman</p>
    <p>Department of Computer Science and EngineeringDepartment of Computer Science and Engineering</p>
    <p>Washington University in St. LouisWashington University in St. Louis</p>
  </div>
  <div class="page">
    <p>IntroductionIntroduction</p>
    <p>Research into better segmentation encounters two Research into better segmentation encounters two problems:problems:</p>
    <p>different parameterizations of a methoddifferent parameterizations of a method</p>
    <p>Current segmentation evaluation methods are Current segmentation evaluation methods are subjective or systemsubjective or system--specificspecific</p>
    <p>Objective segmentation evaluation methods are Objective segmentation evaluation methods are greatly neededgreatly needed</p>
  </div>
  <div class="page">
    <p>Current Evaluation MethodsCurrent Evaluation Methods</p>
    <p>( ( Subjective / SystemSubjective / System--Level Evaluation )Level Evaluation )</p>
    <p>Evaluate segmentation visually/qualitatively Evaluate segmentation visually/qualitatively  Large amount of human involvementsLarge amount of human involvements</p>
    <p>Rather subjectiveRather subjective</p>
    <p>Evaluate segmentation by its effectiveness on Evaluate segmentation by its effectiveness on the subsequent processing steps the subsequent processing steps  Only good for systems/applications employing segmentationOnly good for systems/applications employing segmentation</p>
    <p>Indirect, not necessarily correlated in a positive wayIndirect, not necessarily correlated in a positive way</p>
  </div>
  <div class="page">
    <p>Current Evaluation MethodsCurrent Evaluation Methods</p>
    <p>( ( Objective Evaluation )Objective Evaluation )</p>
    <p>Analytic methodsAnalytic methods</p>
    <p>-- judge segmentation methodjudge segmentation methods effectiveness by conceptual elegance,s effectiveness by conceptual elegance, mathematical sophistication or computational complexity, mathematical sophistication or computational complexity, etc.etc.</p>
    <p>Supervised methodsSupervised methods (a.k.a. Empirical discrepancy methods) (a.k.a. Empirical discrepancy methods) -- comparing results to manuallycomparing results to manually--segmented reference imagesegmented reference image</p>
    <p>-- generating reference image is difficult, subjective, timegenerating reference image is difficult, subjective, time--consuming, and consuming, and inaccurate for most images, e.g. for natural images.inaccurate for most images, e.g. for natural images.</p>
    <p>Unsupervised methodsUnsupervised methods (a.k.a. Empirical goodness methods) (a.k.a. Empirical goodness methods) -- evaluating results by measuring various image features, such asevaluating results by measuring various image features, such as</p>
    <p>smoothness or continuity of the edge, etc.smoothness or continuity of the edge, etc.</p>
    <p>-- often used with simple images; not designed for general applicaoften used with simple images; not designed for general applications.tions.</p>
  </div>
  <div class="page">
    <p>Current Evaluation MethodsCurrent Evaluation Methods (Quantitative objective evaluation)(Quantitative objective evaluation)</p>
    <p>Good segmentation evaluation methods must:Good segmentation evaluation methods must:  accurately judge the segmentation performanceaccurately judge the segmentation performance  have minimal human involvementhave minimal human involvement  be independent of the contents and type of imagebe independent of the contents and type of image  be independent of the segmentation method being evaluatedbe independent of the segmentation method being evaluated</p>
    <p>Current quantitative objective evaluation methods:Current quantitative objective evaluation methods:  FF, proposed by Liu and Yang, proposed by Liu and Yang  FF and and QQ, proposed by Borsotti, Campadelli and , proposed by Borsotti, Campadelli and SchettiniSchettini  based on empirical analysis; little grounding in theorybased on empirical analysis; little grounding in theory</p>
  </div>
  <div class="page">
    <p>Liu and YangLiu and Yangs F Functions F Function</p>
    <p>=</p>
    <p>= N</p>
    <p>i i</p>
    <p>i</p>
    <p>S</p>
    <p>e NkIF</p>
    <p>)(</p>
    <p>F(I) is biased towards small numbers of segments or large numbers of small segments</p>
    <p>F(I) is 0 when the color error is zero for all segments, which occurs when each pixel is its own region</p>
    <p>large numbers of regions in the segmented image is penalized only by the global measure .</p>
    <p>segmentations that have regions with large areas are heavily penalized unless the region is very uniform in color</p>
    <p>Based on empirical analysis</p>
    <p>N</p>
  </div>
  <div class="page">
    <p>Borsotti et. al Borsotti et. al s Fs F FunctionFunction</p>
    <p>Better than F when the segmentation has lots of Better than F when the segmentation has lots of regions consisting of small number of pixelsregions consisting of small number of pixels</p>
    <p>Problems:Problems:  Reaches minimum value of zero when segmented such that Reaches minimum value of zero when segmented such that each region is its own pixeleach region is its own pixel</p>
    <p>Heavily penalizes segmentations with a very large number of Heavily penalizes segmentations with a very large number of regionsregions</p>
    <p>==</p>
    <p>+</p>
    <p>=</p>
    <p>N</p>
    <p>j j</p>
    <p>j MaxArea</p>
    <p>a</p>
    <p>a</p>
    <p>I S</p>
    <p>e aN</p>
    <p>S IF</p>
    <p>/11)]([ 1000</p>
  </div>
  <div class="page">
    <p>Borsotti et. al Borsotti et. al s Q Functions Q Function</p>
    <p>Segmentations with large numbers of regions are not Segmentations with large numbers of regions are not penalized as heavily penalized as heavily</p>
    <p>Problems:Problems:  Very strong bias against regions with large area unless there isVery strong bias against regions with large area unless there is very little variation in colorvery little variation in color</p>
    <p>Second termSecond term in the summationin the summation typically has a very small value typically has a very small value as compared to the first term, so has negligible effect on as compared to the first term, so has negligible effect on</p>
    <p>evaluation resultsevaluation results</p>
    <p>( )</p>
    <p>=</p>
    <p>+</p>
    <p>+ =</p>
    <p>N</p>
    <p>j j</p>
    <p>j</p>
    <p>j</p>
    <p>j</p>
    <p>I S</p>
    <p>SN</p>
    <p>S</p>
    <p>e N</p>
    <p>S IQ</p>
    <p>log11000</p>
  </div>
  <div class="page">
    <p>EntropyEntropy--based Evaluationbased Evaluation</p>
    <p>A good segmentation should maximize the uniformity of pixels A good segmentation should maximize the uniformity of pixels within each region, and minimize the uniformity across the within each region, and minimize the uniformity across the regions. regions.</p>
    <p>Hence, entropy is a natural characteristic to be incorporated inHence, entropy is a natural characteristic to be incorporated in evaluation function.evaluation function.</p>
    <p>= )(</p>
    <p>)( log</p>
    <p>)( )(</p>
    <p>v jVm j</p>
    <p>j</p>
    <p>j</p>
    <p>j jv</p>
    <p>S</p>
    <p>mL</p>
    <p>S</p>
    <p>mL RH</p>
    <p>( ) =</p>
    <p>=</p>
    <p>N</p>
    <p>j j</p>
    <p>I</p>
    <p>j r RH</p>
    <p>S</p>
    <p>S IH</p>
    <p>)(</p>
    <p>Entropy for region Entropy for region j:j:</p>
    <p>Expected region entropyExpected region entropy:</p>
  </div>
  <div class="page">
    <p>EntropyEntropy--based Evaluationbased Evaluation</p>
    <p>Expected region entropy has a strong bias to overExpected region entropy has a strong bias to over--segment, segment, we must combine the expected region entropy with another we must combine the expected region entropy with another</p>
    <p>term or factor that penalizes segmentations having a large term or factor that penalizes segmentations having a large</p>
    <p>numbers of regions.numbers of regions.</p>
    <p>One approach would be to multiply the expected region One approach would be to multiply the expected region entropy by to penalize segmentations with a large entropy by to penalize segmentations with a large</p>
    <p>numbers of regions. numbers of regions.</p>
    <p>Weighted disorder functionWeighted disorder function: ( ) )()( 1</p>
    <p>IHNRH S</p>
    <p>S NIH r</p>
    <p>N</p>
    <p>j j</p>
    <p>I</p>
    <p>j w =</p>
    <p>=</p>
    <p>=</p>
    <p>N</p>
  </div>
  <div class="page">
    <p>EntropyEntropy--based Evaluationbased Evaluation</p>
    <p>Regard segmentation as a modeling process.Regard segmentation as a modeling process.  According to minimum description length (MDL) principle, if According to minimum description length (MDL) principle, if we balance the tradewe balance the trade--off between the uniformity of the individual off between the uniformity of the individual regions with the complexity of the segmentation, the minimum regions with the complexity of the segmentation, the minimum description length corresponds to the best segmentation. description length corresponds to the best segmentation.</p>
    <p>A measure of segmentation complexity:A measure of segmentation complexity:</p>
    <p>==</p>
    <p>= N I</p>
    <p>i</p>
    <p>I</p>
    <p>i i</p>
    <p>N</p>
    <p>i il</p>
    <p>S</p>
    <p>S</p>
    <p>S</p>
    <p>S ppIH loglog)(</p>
    <p>+</p>
    <p>=+=</p>
    <p>N N i</p>
    <p>I</p>
    <p>i</p>
    <p>I</p>
    <p>i</p>
    <p>I</p>
    <p>i rl RH</p>
    <p>S</p>
    <p>S</p>
    <p>S</p>
    <p>S</p>
    <p>S</p>
    <p>S IHIHE )(log)()(</p>
    <p>Our Evaluation function, Our Evaluation function, EE, based on MDL:, based on MDL:</p>
    <p>Layout Entropy:Layout Entropy:</p>
  </div>
  <div class="page">
    <p>Experimental ResultsExperimental Results</p>
    <p>Evaluation effectiveness when the number of Evaluation effectiveness when the number of regions in the segmentation variesregions in the segmentation varies</p>
    <p>Evaluation effectiveness when the number of Evaluation effectiveness when the number of</p>
    <p>regions is fixedregions is fixed</p>
    <p>Evaluation effectiveness when work on Evaluation effectiveness when work on</p>
    <p>theoretically different segmentation methodstheoretically different segmentation methods</p>
  </div>
  <div class="page">
    <p>When number of regions varies When number of regions varies</p>
    <p>Original image 2 regions 4 regions</p>
    <p>Generated with</p>
    <p>EDISON</p>
  </div>
  <div class="page">
    <p>When number of regions varies When number of regions varies (Comparison of F, F(Comparison of F, F, Hw, Q and E), Hw, Q and E)</p>
    <p>F, F', Hw, Q, and E for EDISON segmentation</p>
    <p>Q</p>
    <p>E</p>
    <p>F</p>
    <p>F'</p>
    <p>Hw</p>
    <p>FF and and FF generally increase and are almost identical until about 400 regigenerally increase and are almost identical until about 400 regions ons are in the segmentationare in the segmentation</p>
    <p>QQ also tends to increase as the number of regions grows, but it halso tends to increase as the number of regions grows, but it has clear as clear local minimalocal minima</p>
    <p>FF, , FF andand Q Q have a strong bias towards the meaningless segmentation have a strong bias towards the meaningless segmentation containing a single regioncontaining a single region</p>
  </div>
  <div class="page">
    <p>When number of regions variesWhen number of regions varies (A Closer Look at E)(A Closer Look at E)</p>
    <p>E for EDISON segmentation</p>
    <p>E</p>
    <p>EE can be used to pick out the best segmentation over a wider rangcan be used to pick out the best segmentation over a wider range of e of desired granularitydesired granularity</p>
    <p>EE does not have a strong bias towards the segmentation containingdoes not have a strong bias towards the segmentation containing a single a single regionregion</p>
  </div>
  <div class="page">
    <p>When number of regions varies When number of regions varies (The interaction of components in E and Q)(The interaction of components in E and Q)</p>
    <p>Q1, Q2 for EDISON Segmentation</p>
    <p>Q1</p>
    <p>Q2</p>
    <p>H_l, H_r for EDISON Segmentation</p>
    <p>H_l</p>
    <p>H_r</p>
    <p>( ) = += N</p>
    <p>j jj SeNQ</p>
    <p>N</p>
    <p>j jj SSCNQ</p>
    <p>Q1Q1 and and Q2Q2 do not complement each other well. In contrast, the two componedo not complement each other well. In contrast, the two components of nts of E E complement each other quite nicely and thus together can countercomplement each other quite nicely and thus together can counteract the effects of act the effects of</p>
    <p>overover-- and underand under--segmentation. segmentation.</p>
    <p>QQ can be broken into two terms:can be broken into two terms:</p>
    <p>The interactions between The interactions between HlHl and and Hr Hr and between and between Q1Q1 and and Q2Q2 ::</p>
  </div>
  <div class="page">
    <p>Experimental ResultsExperimental Results</p>
    <p>Evaluation effectiveness when the number of Evaluation effectiveness when the number of</p>
    <p>regions in the segmentation variesregions in the segmentation varies</p>
    <p>Evaluation effectiveness when the number of Evaluation effectiveness when the number of</p>
    <p>regions is fixedregions is fixed</p>
    <p>Evaluation effectiveness when work on Evaluation effectiveness when work on</p>
    <p>theoretically different segmentation methodstheoretically different segmentation methods</p>
  </div>
  <div class="page">
    <p>When the number of regions is fixedWhen the number of regions is fixed Original image Image 1 (thresh.= 0) Image 2 (thresh.= 0.2)</p>
    <p>Image 3 (thresh.= 50) Image 4 (thresh.= 100) Image 5 (thresh.= 1000)</p>
    <p>(Generated with hierarchical image segmentation methods with different fast feature extraction threshold)</p>
    <p>All five segmented</p>
    <p>images have 10 regions.</p>
  </div>
  <div class="page">
    <p>When the number of regions is fixedWhen the number of regions is fixed</p>
    <p>Total Total</p>
    <p>correctcorrect (4,5)(4,5)(4,3)(4,3)(2,5)(2,5)(2,3)(2,3)(1,5)(1,5)(1,3)(1,3)Evaluation Evaluation</p>
    <p>method method</p>
    <p>Images are paired into 6 groups: {Image 1, Image 3}, {Image 1, Images are paired into 6 groups: {Image 1, Image 3}, {Image 1, Image 5}, {Image 2, Image 3}, {Image 2, Image 5}, {Image 4, Image 5}, {Image 2, Image 3}, {Image 2, Image 5}, {Image 4,</p>
    <p>Image 3}, {Image 4, Image 5}. Image 3}, {Image 4, Image 5}.</p>
    <p>Based on clear consensus of human evaluators, the first image inBased on clear consensus of human evaluators, the first image in each pair is preferable. each pair is preferable.</p>
    <p>The pairThe pair--wise comparison results of segmented ``lady'' images wise comparison results of segmented ``lady'' images given by given by F, FF, F, Hw, Q, Hw, Q and and EE</p>
  </div>
  <div class="page">
    <p>Experimental ResultsExperimental Results</p>
    <p>Evaluation effectiveness when the number of Evaluation effectiveness when the number of</p>
    <p>regions in the segmentation variesregions in the segmentation varies</p>
    <p>Evaluation effectiveness when the number of Evaluation effectiveness when the number of</p>
    <p>regions is fixedregions is fixed</p>
    <p>Evaluation effectiveness when work on Evaluation effectiveness when work on</p>
    <p>theoretically different segmentation methodstheoretically different segmentation methods</p>
  </div>
  <div class="page">
    <p>Original image Sea 1 (Hierarchical Seg.) Sea 2 (EDISON)</p>
    <p>Original image Rose 1 (Hierarchical Seg.) Rose 2 (EDISON)</p>
    <p>In the above examples, all but In the above examples, all but HwHw correctly evaluated Sea 1 is correctly evaluated Sea 1 is</p>
    <p>better. All but better. All but FF and and FF correctly evaluated Rose 2 is better.correctly evaluated Rose 2 is better.</p>
    <p>More experiments are needed, but preliminary results showed More experiments are needed, but preliminary results showed</p>
    <p>that that EE is not biased towards some segmentation, thus can be is not biased towards some segmentation, thus can be</p>
    <p>used in crossused in cross--segmentation evaluation.segmentation evaluation.</p>
  </div>
  <div class="page">
    <p>ConclusionConclusion</p>
    <p>EE does a better job of selecting images that agreed with does a better job of selecting images that agreed with our human subjective evaluation our human subjective evaluation</p>
    <p>F F and and FF have a very strong bias towards images with very have a very strong bias towards images with very few regions and thus do not perform wellfew regions and thus do not perform well</p>
    <p>Q Q outperforms outperforms F F and and FF but still disagrees with our human but still disagrees with our human evaluators more often than evaluators more often than EE</p>
    <p>Q Q and and EE have a set of local minima which can be used to pick have a set of local minima which can be used to pick a set of preferred segmentations at different segmentation a set of preferred segmentations at different segmentation granularitiesgranularities</p>
    <p>EE was able to indicate local minima over a wider range of was able to indicate local minima over a wider range of parameterizations than parameterizations than QQ</p>
  </div>
  <div class="page">
    <p>Future ResearchFuture Research</p>
    <p>More extensive experiments using a wider variety of images and More extensive experiments using a wider variety of images and additional segmentation methods are needed. additional segmentation methods are needed.</p>
    <p>Add userAdd user--specified weighting parameter to expected region specified weighting parameter to expected region entropy and the layout entropy, thus enable user to tailor the entropy and the layout entropy, thus enable user to tailor the evaluation method to his/her particular subjective preferences. evaluation method to his/her particular subjective preferences.</p>
    <p>Use Markov assumption instead of Use Markov assumption instead of iid iid ((independent and identically independent and identically distributeddistributed) assumption for layout entropy) assumption for layout entropy</p>
    <p>Improve layout measure to take into account local information Improve layout measure to take into account local information and incorporate measure about the shapes of the regions, and to and incorporate measure about the shapes of the regions, and to diminish the effects of region sizes.diminish the effects of region sizes.</p>
    <p>Utilize evaluation function to control the segmentation process Utilize evaluation function to control the segmentation process and dynamically choose the optimal number of regions. and dynamically choose the optimal number of regions.</p>
  </div>
</Presentation>
