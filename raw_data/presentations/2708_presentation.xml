<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Alex Horn1, Ali Kheradmand2 and Mukul R. Prasad1</p>
    <p>Delta-net: Real-time Network</p>
    <p>Verification Using Atoms</p>
    <p>NSDI 2017, Boston, March 29</p>
  </div>
  <div class="page">
    <p>Context: Network Verification</p>
    <p>Staged, or actual data plane</p>
    <p>Network</p>
    <p>Control Plane</p>
    <p>[Khurshid et al., NSDI 2013], Veriflow  [Kazemian et al., NSDI 2013], NetPlumber  [Yang and Lam, ICNP 2013], AP Verifier</p>
    <p>[Canini et al., NSDI 2012], NICE  [Ball et al., PLDI 2014], VeriCon  [Fayaz et., NSDI 2016], BUZZ  [Stoenescu et al., SIGCOMM 2016], SymNet  [Fogel et al., NSDI 2015], Batfish  [Lopes et al., NSDI 2015], NoD in Z3</p>
    <p>Goal: detect network outages before they occur</p>
  </div>
  <div class="page">
    <p>Context: Network Verification</p>
    <p>Staged, or actual data plane</p>
    <p>Network</p>
    <p>Control Plane</p>
    <p>[Khurshid et al., NSDI 2013], Veriflow  [Kazemian et al., NSDI 2013], NetPlumber  [Yang and Lam, ICNP 2013], AP Verifier</p>
    <p>[Canini et al., NSDI 2012], NICE  [Ball et al., PLDI 2014], VeriCon  [Fayaz et., NSDI 2016], BUZZ  [Stoenescu et al., SIGCOMM 2016], SymNet  [Fogel et al., NSDI 2015], Batfish  [Lopes et al., NSDI 2015], NoD in Z3</p>
    <p>Goal: detect network outages before they occur</p>
    <p>Undecidable</p>
    <p>Decidable</p>
  </div>
  <div class="page">
    <p>Big Picture of Real-time Network Verification</p>
    <p>Properties</p>
    <p>Data Plane Checker</p>
    <p>Errors</p>
    <p>+</p>
    <p>z</p>
    <p>z</p>
    <p>z</p>
    <p>Forwarding Table</p>
    <p>Priority IP Prefix Action Next Hop</p>
    <p>Forwarding Rule</p>
    <p>Staged, or actual data plane</p>
    <p>e.g., forwarding loop</p>
  </div>
  <div class="page">
    <p>Taxonomy</p>
    <p>Real-time Network</p>
    <p>Verification</p>
    <p>Incremental Network</p>
    <p>Verification</p>
    <p>Packet Equivalence</p>
    <p>Classes</p>
    <p>[Khurshid et al., NSDI 2013][Khurshid et al., NSDI 2013] [Kazemian et al., NSDI 2013] [Yang and Lam, ICNP 2013]</p>
  </div>
  <div class="page">
    <p>Taxonomy</p>
    <p>Real-time Network</p>
    <p>Verification</p>
    <p>Local Similarity</p>
    <p>Incremental Network</p>
    <p>Verification</p>
    <p>Packet Equivalence</p>
    <p>Classes</p>
    <p>New</p>
    <p>[Khurshid et al., NSDI 2013] [Kazemian et al., NSDI 2013] [Yang and Lam, ICNP 2013]</p>
    <p>[Khurshid et al., NSDI 2013]</p>
  </div>
  <div class="page">
    <p>Incremental Network Verification</p>
    <p>Control Plane</p>
    <p>Network</p>
    <p>Data plane 2</p>
    <p>Data plane 2</p>
    <p>Data plane 2</p>
    <p>Data plane k</p>
  </div>
  <div class="page">
    <p>Incremental Network Verification</p>
    <p>Control Plane</p>
    <p>Network</p>
    <p>Data plane 2</p>
    <p>Data plane 2</p>
    <p>Data plane 2</p>
    <p>Data plane k</p>
    <p>Possibly a lot of overlap</p>
  </div>
  <div class="page">
    <p>Incremental Network Verification</p>
    <p>Control Plane</p>
    <p>Network</p>
    <p>Data plane 2</p>
    <p>Data plane 2</p>
    <p>Data plane 2</p>
    <p>Data plane k</p>
    <p>Possibly a lot of overlap</p>
    <p>Problem: disruptive changes (e.g. outages) are still challenging to analyze in real-time.</p>
  </div>
  <div class="page">
    <p>Our Contribution: Delta-net</p>
    <p>Exploit similarity among forwarding behavior of packets through parts of the network, rather than its entirety.</p>
    <p>Experiments: 10-100x faster on network-wide use cases</p>
    <p>Example next ...</p>
    <p>delta of deltas</p>
  </div>
  <div class="page">
    <p>Forwarding Graphs Per Equivalence Class</p>
    <p>r1</p>
    <p>r2</p>
    <p>r3</p>
    <p>r4 r1</p>
    <p>r2</p>
    <p>r3</p>
    <p>r4s1</p>
    <p>s2 s3</p>
    <p>s4</p>
    <p>range of IP addresses</p>
    <p>Lowest priority</p>
    <p>Highest priority</p>
  </div>
  <div class="page">
    <p>Forwarding Graphs Per Equivalence Class</p>
    <p>r1</p>
    <p>r2</p>
    <p>r3</p>
    <p>r4 r1</p>
    <p>r2</p>
    <p>r3</p>
    <p>r4s1</p>
    <p>s2 s3</p>
    <p>s4</p>
  </div>
  <div class="page">
    <p>Forwarding Graphs Per Equivalence Class</p>
    <p>r1</p>
    <p>r2</p>
    <p>r3</p>
    <p>r4 r1</p>
    <p>r2</p>
    <p>r3</p>
    <p>r4s1</p>
    <p>s2 s3</p>
    <p>s4</p>
  </div>
  <div class="page">
    <p>Forwarding Graphs Per Equivalence Class</p>
    <p>r1</p>
    <p>r2</p>
    <p>r3</p>
    <p>r4 r1</p>
    <p>r2</p>
    <p>r3</p>
    <p>r4s1</p>
    <p>s2 s3</p>
    <p>s4</p>
  </div>
  <div class="page">
    <p>Our Contribution: Delta-net</p>
    <p>+ + =</p>
    <p>incrementally maintain a single edge-labelled graph; represents all packet flows.</p>
    <p>1</p>
    <p>2,3</p>
    <p>3</p>
    <p>2,3,4</p>
    <p>Rather than re-computing forwarding graphs</p>
    <p>delta of deltas</p>
  </div>
  <div class="page">
    <p>Our Contribution: Delta-net</p>
    <p>+ + =</p>
    <p>incrementally maintain a single edge-labelled graph; represents all packet flows.</p>
    <p>1</p>
    <p>2,3</p>
    <p>3</p>
    <p>2,3,4</p>
    <p>Rather than re-computing forwarding graphs</p>
    <p>delta of deltas</p>
    <p>Single graph data structure to answer reachability queries, exposed through a simple C++ API.</p>
  </div>
  <div class="page">
    <p>Our Contribution: Delta-net</p>
    <p>+ + =</p>
    <p>incrementally maintain a single edge-labelled graph; represents all packet flows.</p>
    <p>1</p>
    <p>2,3</p>
    <p>3</p>
    <p>2,3,4</p>
    <p>Rather than re-computing forwarding graphs</p>
    <p>delta of deltas atoms</p>
    <p>Single graph data structure to answer reachability queries, exposed through a simple C++ API.</p>
  </div>
  <div class="page">
    <p>Atoms</p>
    <p>Complex Stuff = Simpler Stuff</p>
    <p>Example: factorization into prime numbers, e.g.</p>
    <p>For IP prefix based networks, atoms:</p>
    <p>1 2 3</p>
    <p>range of IP addresses</p>
  </div>
  <div class="page">
    <p>Compactness of Atoms</p>
    <p>More compact than a Patricia tree, e.g. consider 0 = [0 : 10):</p>
    <p>[0 : 8)</p>
    <p>[8 : 10)</p>
    <p>[0 : 8) = 00***</p>
    <p>[8 : 10) = 0100*</p>
  </div>
  <div class="page">
    <p>Atoms and Graph Transformation</p>
    <p>r1</p>
    <p>r2</p>
    <p>r3</p>
    <p>r1</p>
    <p>r2</p>
    <p>r3</p>
    <p>r4</p>
    <p>1 2 3</p>
    <p>s1</p>
    <p>s2 s3</p>
    <p>s4</p>
  </div>
  <div class="page">
    <p>Atoms and Graph Transformation</p>
    <p>r1</p>
    <p>r2</p>
    <p>r3</p>
    <p>r1</p>
    <p>r2</p>
    <p>r3</p>
    <p>r4</p>
    <p>1 2 3</p>
    <p>s1</p>
    <p>s2 s3</p>
    <p>s4</p>
    <p>1,2,3</p>
    <p>2,3</p>
    <p>3</p>
  </div>
  <div class="page">
    <p>Atoms and Graph Transformation</p>
    <p>r1</p>
    <p>r2</p>
    <p>r3</p>
    <p>r4</p>
    <p>1,2,3,4</p>
    <p>2,3</p>
    <p>3</p>
    <p>r1</p>
    <p>r2</p>
    <p>r3</p>
    <p>r4</p>
    <p>1 4 2 3</p>
    <p>s1</p>
    <p>s2 s3</p>
    <p>s4</p>
  </div>
  <div class="page">
    <p>Atoms and Graph Transformation</p>
    <p>r1</p>
    <p>r2</p>
    <p>r3</p>
    <p>r4</p>
    <p>1,2,3,4</p>
    <p>2,3</p>
    <p>3</p>
    <p>r1</p>
    <p>r2</p>
    <p>r3</p>
    <p>r4</p>
    <p>1 4 2 3</p>
    <p>s1</p>
    <p>s2 s3</p>
    <p>s4</p>
  </div>
  <div class="page">
    <p>Atoms and Graph Transformation</p>
    <p>r1</p>
    <p>r2</p>
    <p>r3</p>
    <p>r4</p>
    <p>1,2,3,4</p>
    <p>2,3</p>
    <p>3 1</p>
    <p>2,3</p>
    <p>3</p>
    <p>2,3,4</p>
    <p>r1</p>
    <p>r2</p>
    <p>r3</p>
    <p>r4</p>
    <p>1 4 2 3</p>
    <p>Graph</p>
    <p>Transformation</p>
    <p>s1</p>
    <p>s2 s3</p>
    <p>s4</p>
  </div>
  <div class="page">
    <p>High-level Flowchart</p>
    <p>Start</p>
    <p>New atoms required?</p>
    <p>Modify forwarding table</p>
    <p>Create new atoms</p>
    <p>Transform edge-labelled graph</p>
    <p>Yes</p>
    <p>No</p>
    <p>More modifications?</p>
    <p>No</p>
    <p>Yes</p>
    <p>Check properties</p>
    <p>Refine precision of abstraction</p>
    <p>End</p>
  </div>
  <div class="page">
    <p>All-Pairs Reachability</p>
    <p>1,2</p>
    <p>2,3</p>
    <p>3</p>
    <p>2,3</p>
    <p>Adaptation of Floyd-Warshall Algorithm</p>
    <p>Essential for Datalog-style what-if queries:</p>
  </div>
  <div class="page">
    <p>All-Pairs Reachability</p>
    <p>1,2</p>
    <p>2,3</p>
    <p>3</p>
    <p>2,3</p>
    <p>2</p>
    <p>Adaptation of Floyd-Warshall Algorithm</p>
    <p>Essential for Datalog-style what-if queries:</p>
  </div>
  <div class="page">
    <p>All-Pairs Reachability</p>
    <p>1,2</p>
    <p>2,3</p>
    <p>3</p>
    <p>2,3</p>
    <p>2</p>
    <p>3</p>
    <p>Adaptation of Floyd-Warshall Algorithm</p>
    <p>Essential for Datalog-style what-if queries:</p>
  </div>
  <div class="page">
    <p>Experimental Setup (2 Classes of Data Sets)</p>
    <p>Synthetic data sets similar to [Zeng et al., NSDI 2014]</p>
    <p>Rocketfuel and Berkeley topologies from [Narayana et al., NSDI 2016]</p>
    <p>IP prefixes from RouteViews project</p>
    <p>SDN-IP [Lin et al., SIGCOMM 2013] in ONOS</p>
    <p>Globally deployed, ONOS flagship application</p>
  </div>
  <div class="page">
    <p>SDN-IP Experimental Setup</p>
  </div>
  <div class="page">
    <p>Data Sets</p>
    <p>Hundreds of million IP prefix rule insertions</p>
    <p>SDN-IP</p>
    <p>Synthetic</p>
    <p>+ removals</p>
  </div>
  <div class="page">
    <p>Find all forwarding loops introduced by a rule insertion.</p>
    <p>Experiments: Measuring Rule Updates</p>
  </div>
  <div class="page">
    <p>Find all forwarding loops introduced by a rule insertion.</p>
    <p>Experiments: Measuring Rule Updates</p>
    <p>Vast majority of rule updates analyzed in &lt;&lt; 1 ms</p>
  </div>
  <div class="page">
    <p>What parts of the network are affected by link failures?</p>
    <p>Query proposed by [Khurshid et al., NSDI 2013].</p>
    <p>Summary: Delta-net can answer queries where Veriflow-RI times out.</p>
    <p>Experiments: Beyond Network Updates</p>
  </div>
  <div class="page">
    <p>Concluding Remarks</p>
    <p>Delta-net, a new real-time data plane checker.</p>
    <p>Our research considers the delta of deltas.</p>
    <p>Opens up new Datalog-style use cases, previously out of reach.</p>
    <p>Data sets publically available now:</p>
    <p>https://github.com/delta-net/datasets</p>
    <p>For questions and comments, contact: ahorn@us.fujitsu.com.</p>
    <p>We are also looking for industry/academic partners, interns etc.</p>
    <p>Future work:</p>
    <p>Parallelization</p>
    <p>Multi-range support</p>
    <p>Avoid space/time trade-offs, at what cost for query expressiveness?</p>
  </div>
</Presentation>
