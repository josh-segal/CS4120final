<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Enhancing Drug-Drug Interaction Extraction from Texts by</p>
    <p>Molecular Structure Information</p>
    <p>Masaki Asada, Makoto Miwa, Yutaka Sasaki</p>
    <p>Toyota Technological Institute, Japan</p>
  </div>
  <div class="page">
    <p>Introduction</p>
    <p>Our target problem is the extraction of drug-drug interactions (DDIs) from biomedical texts</p>
    <p>Grepafloxacin inhibits the metabolism of Theophylline</p>
    <p>Mechanism</p>
  </div>
  <div class="page">
    <p>Introduction</p>
    <p>Our target problem is the extraction of drug-drug interactions (DDIs) from biomedical texts</p>
    <p>We investigate the use of external drug database (DrugBank) information in extracting DDIs from texts</p>
    <p>We especially focus on molecular structure information</p>
    <p>Grepafloxacin inhibits the metabolism of Theophylline</p>
    <p>Mechanism</p>
    <p>DrugBank database</p>
  </div>
  <div class="page">
    <p>Method Overview</p>
    <p>We obtain the representations of textual drug pairs using convolutional neural networks (CNNs) and molecular drug pairs using graph convolutional networks (GCNs)</p>
    <p>We concatenate text-based and molecule-based vectors</p>
    <p>Text</p>
    <p>Molecular structure</p>
    <p>GCN</p>
    <p>CNN</p>
    <p>concat</p>
    <p>concat</p>
    <p>Grepafloxacin inhibits the metabolism of Theophylline</p>
    <p>Grepafloxacin</p>
    <p>Theophylline</p>
    <p>DDI types</p>
    <p>DrugBank Database</p>
  </div>
  <div class="page">
    <p>Method</p>
    <p>Text Corpus</p>
    <p>Grepafloxacin inhibits</p>
    <p>the metabolism</p>
    <p>of Theophylline</p>
    <p>word + position embeddings</p>
    <p>Molecular vector</p>
    <p>concat</p>
    <p>concat</p>
    <p>Theophylline</p>
    <p>DDI extraction from texts using molecular structures  Text-based DDI representation  Molecular structure-based DDI representation</p>
    <p>DDI types</p>
    <p>DrugBank Database</p>
    <p>Grepafloxacin GCN</p>
    <p>Textual vector</p>
    <p>CNN</p>
  </div>
  <div class="page">
    <p>Method</p>
    <p>Text Corpus</p>
    <p>Grepafloxacin inhibits</p>
    <p>the metabolism</p>
    <p>of Theophylline</p>
    <p>word + position embeddings</p>
    <p>Molecular vector</p>
    <p>concat</p>
    <p>concat</p>
    <p>Theophylline</p>
    <p>DDI extraction from texts using molecular structures  Text-based DDI representation  Molecular structure-based DDI representation</p>
    <p>DDI types</p>
    <p>DrugBank Database</p>
    <p>Grepafloxacin GCN</p>
    <p>Textual vector</p>
    <p>CNN</p>
  </div>
  <div class="page">
    <p>Method: Text-based DDI Representation</p>
    <p>Text Corpus</p>
    <p>Grepafloxacin inhibits</p>
    <p>the metabolism</p>
    <p>of Theophylline</p>
    <p>word + position embeddings</p>
    <p>Textual vector</p>
    <p>CNN</p>
    <p>Our model for representing textual DDIs is based on the CNN model by Zeng et al. (2014)</p>
    <p>We use word and position embeddings as the input to the convolution layer</p>
    <p>We convert the output of the convolution layer into a fixed-size textual vector</p>
  </div>
  <div class="page">
    <p>Method</p>
    <p>Text Corpus</p>
    <p>Grepafloxacin inhibits</p>
    <p>the metabolism</p>
    <p>of Theophylline</p>
    <p>word vectorInput sentence</p>
    <p>Molecular vector</p>
    <p>concat</p>
    <p>concat</p>
    <p>Theophylline</p>
    <p>Predict DDI</p>
    <p>Grepafloxacin GCN</p>
    <p>Textual vector</p>
    <p>DDI extraction from texts using molecular structures  Text-based DDI representation  Molecular structure-based DDI representation</p>
    <p>CNN</p>
    <p>DrugBank Database</p>
  </div>
  <div class="page">
    <p>Method: Molecular Structure-based DDI Representation  We represent drug pairs in molecular graph structures using</p>
    <p>GCNs</p>
    <p>We pre-train GCNs using interacting (positive) pairs mentioned in the DrugBank and not mentioned (pseudo negative) pairs in the DrugBank</p>
    <p>Molecular vector</p>
    <p>GCN interact not mentioned</p>
    <p>prediction</p>
    <p>Theophylline</p>
    <p>Grepafloxacin</p>
  </div>
  <div class="page">
    <p>Method: Molecular Structure-based DDI Representation</p>
    <p>Graph Convolutional Network (GCN) [Li et al. 2016]</p>
    <p>We use GCNs to convert a drug molecule graph into a fixed size vector by aggregating node vectors</p>
    <p>Node  Edge</p>
    <p>GCN</p>
    <p>molecular vectorgraph structure</p>
    <p>Node</p>
    <p>: node vector</p>
    <p>: neighbors of</p>
    <p>GRU : gated Recurrent Unit</p>
    <p>,  : linear layer</p>
    <p>: element-wise product [;] : concatenation</p>
    <p>: learned weight</p>
    <p>+1 = ()</p>
    <p>+1 = GRU([</p>
    <p>; +1])</p>
  </div>
  <div class="page">
    <p>Method: Molecular Structure-based DDI Representation</p>
    <p>Graph Convolutional Network (GCN) [Li et al. 2016]</p>
    <p>We use GCNs to convert a drug molecule graph into a fixed size vector by aggregating node vectors</p>
    <p>Node  Edge</p>
    <p>GCN</p>
    <p>molecular vectorgraph structure</p>
    <p>Node</p>
    <p>: node vector</p>
    <p>: neighbors of</p>
    <p>GRU : gated Recurrent Unit</p>
    <p>,  : linear layer</p>
    <p>: element-wise product [;] : concatenation</p>
    <p>: learned weight</p>
    <p>+1 = ()</p>
    <p>+1 = GRU([</p>
    <p>; +1])</p>
    <p>=   (  ;</p>
  </div>
  <div class="page">
    <p>Method: DDI Extraction from Texts Using Molecular Structures</p>
    <p>Grepafloxacin inhibits</p>
    <p>the metabolism</p>
    <p>of Theophylline</p>
    <p>word + position embeddings</p>
    <p>textual vector</p>
    <p>CNN</p>
  </div>
  <div class="page">
    <p>Method: DDI Extraction from Texts Using Molecular Structures  Link mentions in text corpus to drug database entries by relaxed</p>
    <p>string matching</p>
    <p>Grepafloxacin inhibits</p>
    <p>the metabolism</p>
    <p>of Theophylline</p>
    <p>word + position embeddings</p>
    <p>Theophylline DrugBank</p>
    <p>Grepafloxacin</p>
    <p>textual vector</p>
    <p>CNN Relaxed string</p>
    <p>matching</p>
  </div>
  <div class="page">
    <p>Method: DDI Extraction from Texts Using Molecular Structures  Link mentions in text corpus to drug database entries by relaxed</p>
    <p>string matching  Obtain molecular vectors via GCNs with fixed parameters</p>
    <p>Grepafloxacin inhibits</p>
    <p>the metabolism</p>
    <p>of Theophylline</p>
    <p>word + position embeddings</p>
    <p>molecular vector</p>
    <p>Theophylline DrugBank</p>
    <p>Grepafloxacin</p>
    <p>GCN</p>
    <p>textual vector</p>
    <p>CNN Relaxed string</p>
    <p>matching</p>
  </div>
  <div class="page">
    <p>Method: DDI Extraction from Texts Using Molecular Structures  Link mentions in text corpus to drug database entries by relaxed</p>
    <p>string matching  Obtain molecular vectors via GCNs with fixed parameters  Predict DDIs from concatenated textual and molecular vectors</p>
    <p>DDI types</p>
    <p>Grepafloxacin inhibits</p>
    <p>the metabolism</p>
    <p>of Theophylline</p>
    <p>word + position embeddings</p>
    <p>molecular vector</p>
    <p>concat</p>
    <p>concat</p>
    <p>Theophylline</p>
    <p>Grepafloxacin</p>
    <p>GCN</p>
    <p>textual vector</p>
    <p>CNN</p>
    <p>DrugBank</p>
    <p>Relaxed string</p>
    <p>matching</p>
  </div>
  <div class="page">
    <p>Task Settings</p>
    <p>SemEval2013 shared task 9.2 The data set is composed of documents annotated with drug mentions and their 4 types of interactions (Mechanism, Effect, Advice and Interaction) or no interaction</p>
    <p>Statistics of the DDI SemEval2013 shared task</p>
  </div>
  <div class="page">
    <p>Data for Pre-training GCNs</p>
    <p>We extracted 255,229 interacting (positive) pairs from DrugBank and generated the same number of pseudo negative pairs by randomly pairing DrugBank drugs</p>
    <p>We deleted drug pairs mentioned in the test set of the text corpus</p>
  </div>
  <div class="page">
    <p>Molecular Structure Features</p>
    <p>To obtain the graph of a drug molecule, we took as input the SMILES string encoding of the molecule from DrugBank and then converted it into the 2D graph structure using RDKit</p>
    <p>For the initial atom (node) vectors, we used randomly embedded vectors for atoms, i.e., C, O, N,</p>
    <p>We also used 4 bond (edge) types: single, double, triple, and aromatic</p>
  </div>
  <div class="page">
    <p>Differences of Labels in Text and Database Tasks  Interacting drug pairs in database may not appear</p>
    <p>as positive instances in the text task</p>
    <p>Text task define 4 detailed types, while database task has one positive type.</p>
    <p>Grepafloxacin inhibits the metabolism of Theophylline</p>
    <p>Mechanism</p>
    <p>While the effect of Grepafloxacin on the metabolism of C.P.A substrates is not evaluated, in vitro data suggested similar effects of Grepafloxacin in Theophylline metabolism</p>
    <p>No relation</p>
    <p>No relation</p>
  </div>
  <div class="page">
    <p>Training Settings</p>
    <p>Mini-batch training using the Adam optimizer with L2 regularization</p>
    <p>Word embeddings trained by the word2vec tool on the 2014 MEDLINE/PubMed baseline distribution  Skip-gram</p>
    <p>Vocabulary size: 215k</p>
  </div>
  <div class="page">
    <p>Training Settings</p>
    <p>Hyper-parameters</p>
    <p>Hyper-parameters for text-based model Hyper-parameters for molecule-based model</p>
  </div>
  <div class="page">
    <p>Evaluation on Relaxed String Matching</p>
    <p>How much of drug mentions in texts are linked to DrugBank entries by relaxed string matching?  We lowercased the mentions and the names in the entries and</p>
    <p>chose the entries with the most overlaps</p>
    <p>As a result, 92.15% and 93.09% of drug mentions in train and test SemEval2013 data set matched the DrugBank entries</p>
  </div>
  <div class="page">
    <p>Text-Only</p>
    <p>Text + Molecular Structure</p>
    <p>Zheng et al. 2017</p>
    <p>Lim et al. 2018</p>
    <p>micro F-score (%)</p>
    <p>Evaluation on DDI Extraction from Texts (SemEval2013 Shared Task)  We observe the increase of micro F-score by using</p>
    <p>molecular structures</p>
  </div>
  <div class="page">
    <p>Can molecular structures alone represent DDIs in texts ?</p>
    <p>- Low F-score (23.90%) - This might be because the drug pairs that interact can appear in the</p>
    <p>textual context that does not describe their interactions</p>
    <p>Analysis</p>
    <p>Grepafloxacin inhibits</p>
    <p>the metabolism</p>
    <p>of Theophylline</p>
    <p>Molecular vector</p>
    <p>concat</p>
    <p>Theophylline</p>
    <p>interact</p>
    <p>Grepafloxacin GCN</p>
    <p>Textual vector</p>
    <p>CNN</p>
    <p>not interact</p>
    <p>DrugBank Database</p>
  </div>
  <div class="page">
    <p>Conclusions</p>
    <p>We proposed a novel neural method for DDI extraction using both textual and molecular information</p>
    <p>The molecular information has improved DDI extraction performance</p>
    <p>As future work, we will investigate the use of other information in DrugBank</p>
  </div>
</Presentation>
