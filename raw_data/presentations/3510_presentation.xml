<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Malicious Management Unit Why Stopping Cache Attacks in Software is Harder Than</p>
    <p>You Think</p>
    <p>Stephan van Schaik</p>
    <p>Cristiano Giuffrida Herbert Bos Kaveh Razavi</p>
  </div>
  <div class="page">
    <p>Motivation</p>
    <p>Why should you care about cache attacks?</p>
  </div>
  <div class="page">
    <p>Motivation</p>
    <p>CPU Registers</p>
    <p>Main Memory</p>
    <p>Disk Storage</p>
  </div>
  <div class="page">
    <p>Motivation</p>
    <p>CPU Registers</p>
    <p>Main Memory</p>
    <p>Disk Storage</p>
    <p>Increasing performance gap</p>
    <p>Processors advance faster than memory</p>
  </div>
  <div class="page">
    <p>Motivation</p>
    <p>CPU Registers</p>
    <p>L1 Cache</p>
    <p>L2 Cache</p>
    <p>L3 Cache</p>
    <p>Main Memory</p>
    <p>Disk Storage</p>
  </div>
  <div class="page">
    <p>Motivation</p>
    <p>CPU Registers</p>
    <p>L1 Cache</p>
    <p>L2 Cache</p>
    <p>L3 Cache</p>
    <p>Main Memory</p>
    <p>Disk Storage</p>
    <p>Faster Sm</p>
    <p>aller Larg</p>
    <p>er Slo</p>
    <p>w er</p>
  </div>
  <div class="page">
    <p>Motivation</p>
    <p>CPU Registers</p>
    <p>L1 Cache</p>
    <p>L2 Cache</p>
    <p>L3 Cache</p>
    <p>Main Memory</p>
    <p>Disk Storage</p>
    <p>Cache Miss</p>
    <p>Cache Hit</p>
    <p>Faster Sm</p>
    <p>aller Larg</p>
    <p>er Slo</p>
    <p>w er</p>
  </div>
  <div class="page">
    <p>Motivation</p>
    <p>CPU Registers</p>
    <p>L1 Cache</p>
    <p>L2 Cache</p>
    <p>L3 Cache</p>
    <p>Main Memory</p>
    <p>Disk Storage</p>
    <p>Cache Miss</p>
    <p>Cache Hit</p>
    <p>Faster Sm</p>
    <p>aller Larg</p>
    <p>er Slo</p>
    <p>w er</p>
    <p>Memory accesses are not performed in constant time</p>
  </div>
  <div class="page">
    <p>Motivation</p>
    <p>Caches are shared resources</p>
    <p>Caches can be manipulated</p>
    <p>Spy on other processes</p>
    <p>Input events</p>
    <p>Leak sensitive data</p>
  </div>
  <div class="page">
    <p>Motivation</p>
    <p>CPU Registers</p>
    <p>L1 Cache</p>
    <p>L2 Cache</p>
    <p>L3 Cache</p>
    <p>Main Memory</p>
    <p>Disk Storage</p>
  </div>
  <div class="page">
    <p>Motivation</p>
    <p>CPU Registers</p>
    <p>L1 Cache</p>
    <p>L2 Cache</p>
    <p>L3 Cache</p>
    <p>Main Memory</p>
    <p>Disk Storage</p>
    <p>CPU</p>
  </div>
  <div class="page">
    <p>Motivation</p>
    <p>CPU Registers</p>
    <p>L1 Cache</p>
    <p>L2 Cache</p>
    <p>L3 Cache</p>
    <p>Main Memory</p>
    <p>Disk Storage</p>
    <p>MMU</p>
  </div>
  <div class="page">
    <p>AES</p>
    <p>Advanced Encryption Standard</p>
    <p>Software implementations use T-tables</p>
    <p>T[pi  ki]</p>
    <p>Indices are key-dependent</p>
    <p>Elements may be in main memory or the cache</p>
  </div>
  <div class="page">
    <p>PRIME + PROBE</p>
    <p>An example of PRIME + PROBE against AES encryption</p>
  </div>
  <div class="page">
    <p>PRIME + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
  </div>
  <div class="page">
    <p>PRIME + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache AES T-table</p>
  </div>
  <div class="page">
    <p>PRIME + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache AES T-tableAttacker</p>
  </div>
  <div class="page">
    <p>PRIME + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache AES T-tableAttacker</p>
    <p>Eviction Set</p>
  </div>
  <div class="page">
    <p>PRIME + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache AES T-tableAttacker</p>
    <p>PRIME</p>
  </div>
  <div class="page">
    <p>PRIME + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache AES T-tableAttacker</p>
    <p>PRIME</p>
  </div>
  <div class="page">
    <p>PRIME + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache AES T-tableAttacker</p>
    <p>PRIME</p>
  </div>
  <div class="page">
    <p>PRIME + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache AES T-tableAttacker</p>
    <p>PRIME</p>
  </div>
  <div class="page">
    <p>PRIME + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache AES T-tableAttacker</p>
    <p>Wait</p>
  </div>
  <div class="page">
    <p>PRIME + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache AES T-tableAttacker</p>
    <p>Wait Encrypt</p>
  </div>
  <div class="page">
    <p>PRIME + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache AES T-tableAttacker</p>
    <p>Wait</p>
  </div>
  <div class="page">
    <p>PRIME + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache AES T-tableAttacker</p>
    <p>PROBE</p>
  </div>
  <div class="page">
    <p>PRIME + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache AES T-tableAttacker</p>
    <p>PROBE</p>
  </div>
  <div class="page">
    <p>PRIME + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache AES T-tableAttacker</p>
    <p>PROBE</p>
  </div>
  <div class="page">
    <p>PRIME + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache AES T-tableAttacker</p>
    <p>PROBE</p>
  </div>
  <div class="page">
    <p>PRIME + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache AES T-tableAttacker</p>
    <p>PROBE</p>
    <p>AES encrypt used another cache set</p>
  </div>
  <div class="page">
    <p>PRIME + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache AES T-tableAttacker</p>
  </div>
  <div class="page">
    <p>PRIME + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache AES T-tableAttacker</p>
    <p>Eviction Set</p>
  </div>
  <div class="page">
    <p>PRIME + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache AES T-tableAttacker</p>
    <p>PRIME</p>
  </div>
  <div class="page">
    <p>PRIME + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache AES T-tableAttacker</p>
    <p>PRIME</p>
  </div>
  <div class="page">
    <p>PRIME + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache AES T-tableAttacker</p>
    <p>PRIME</p>
  </div>
  <div class="page">
    <p>PRIME + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache AES T-tableAttacker</p>
    <p>PRIME</p>
  </div>
  <div class="page">
    <p>PRIME + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache AES T-tableAttacker</p>
    <p>Wait</p>
  </div>
  <div class="page">
    <p>PRIME + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache AES T-tableAttacker</p>
    <p>Wait Encrypt</p>
  </div>
  <div class="page">
    <p>PRIME + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache AES T-tableAttacker</p>
    <p>Wait</p>
  </div>
  <div class="page">
    <p>PRIME + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache AES T-tableAttacker</p>
    <p>PROBE</p>
  </div>
  <div class="page">
    <p>PRIME + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache AES T-tableAttacker</p>
    <p>PROBE</p>
  </div>
  <div class="page">
    <p>PRIME + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache AES T-tableAttacker</p>
    <p>PROBE</p>
  </div>
  <div class="page">
    <p>PRIME + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache AES T-tableAttacker</p>
    <p>PROBE</p>
  </div>
  <div class="page">
    <p>PRIME + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache AES T-tableAttacker</p>
    <p>PROBE</p>
    <p>AES encrypt used the same cache set</p>
  </div>
  <div class="page">
    <p>Defenses</p>
    <p>Can we defend against cache attacks?</p>
  </div>
  <div class="page">
    <p>Defenses</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets Cache</p>
    <p>Way Partitioning</p>
    <p>Victim</p>
    <p>Attacker</p>
  </div>
  <div class="page">
    <p>Defenses</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets Cache</p>
    <p>Set Partitioning</p>
    <p>Victim</p>
    <p>Attacker</p>
  </div>
  <div class="page">
    <p>Page coloring</p>
    <p>How does page coloring work?</p>
  </div>
  <div class="page">
    <p>Page coloring</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
  </div>
  <div class="page">
    <p>Page coloring</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
  </div>
  <div class="page">
    <p>Page coloring</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
  </div>
  <div class="page">
    <p>Page coloring</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
  </div>
  <div class="page">
    <p>Page coloring</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
  </div>
  <div class="page">
    <p>Page coloring</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
    <p>Attacker</p>
  </div>
  <div class="page">
    <p>Page coloring</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
    <p>Attacker</p>
    <p>Victim</p>
  </div>
  <div class="page">
    <p>Page coloring</p>
    <p>The victim and the attacker are nicely isolated.</p>
  </div>
  <div class="page">
    <p>Page coloring</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
    <p>Pages</p>
    <p>The attacker can only allocate red pages</p>
  </div>
  <div class="page">
    <p>Page coloring</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
    <p>Pages</p>
    <p>However, the page tables aren't colored</p>
    <p>Page Tables</p>
  </div>
  <div class="page">
    <p>Page coloring</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
    <p>Pages</p>
    <p>However, the page tables aren't colored</p>
    <p>Page Tables</p>
  </div>
  <div class="page">
    <p>Page coloring</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
    <p>Pages</p>
    <p>However, the page tables aren't colored</p>
    <p>Page Tables</p>
  </div>
  <div class="page">
    <p>Page coloring</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
    <p>Pages</p>
    <p>However, the page tables aren't colored</p>
    <p>Page Tables</p>
  </div>
  <div class="page">
    <p>Page coloring</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
    <p>Pages</p>
    <p>However, the page tables aren't colored</p>
    <p>Page Tables</p>
  </div>
  <div class="page">
    <p>Page coloring</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
    <p>Pages</p>
    <p>Can we control the page tables for cache attacks?</p>
    <p>Page Tables</p>
  </div>
  <div class="page">
    <p>XLATE attacks</p>
    <p>Memory Management Unit (MMU)</p>
    <p>Translates virtual addresses into their physical counterparts</p>
    <p>Hence translate or XLATE attacks</p>
    <p>XLATE + PROBE caches page tables instead of pages</p>
  </div>
  <div class="page">
    <p>Page table walks</p>
    <p>How does the MMU perform page table walks?</p>
  </div>
  <div class="page">
    <p>Page table walks</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>Virtual Address 0x1fafe7fbf000</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
  </div>
  <div class="page">
    <p>Page table walks</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>Virtual Address 0x1fafe7fbf000</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
  </div>
  <div class="page">
    <p>Page table walks</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>Virtual Address 0x1fafe7fbf000</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
  </div>
  <div class="page">
    <p>Page table walks</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>Virtual Address 0x1fafe7fbf000</p>
    <p>CR3</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
  </div>
  <div class="page">
    <p>Page table walks</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>Virtual Address 0x1fafe7fbf000</p>
    <p>PML4</p>
    <p>CR3</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
  </div>
  <div class="page">
    <p>Page table walks</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>Virtual Address 0x1fafe7fbf000</p>
    <p>PML4</p>
    <p>CR3 PML4E</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
  </div>
  <div class="page">
    <p>Page table walks</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>Virtual Address 0x1fafe7fbf000</p>
    <p>PML4 PDPT</p>
    <p>CR3 PML4E</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
  </div>
  <div class="page">
    <p>Page table walks</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>Virtual Address 0x1fafe7fbf000</p>
    <p>PML4 PDPT</p>
    <p>CR3 PML4E</p>
    <p>PDPTE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
  </div>
  <div class="page">
    <p>Page table walks</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>Virtual Address 0x1fafe7fbf000</p>
    <p>PML4 PDPT Page Directory</p>
    <p>CR3 PML4E</p>
    <p>PDPTE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
  </div>
  <div class="page">
    <p>Page table walks</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>Virtual Address 0x1fafe7fbf000</p>
    <p>PML4 PDPT Page Directory</p>
    <p>CR3 PML4E</p>
    <p>PDPTE</p>
    <p>PDE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
  </div>
  <div class="page">
    <p>Page table walks</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>Page Table</p>
    <p>Virtual Address 0x1fafe7fbf000</p>
    <p>PML4 PDPT Page Directory</p>
    <p>CR3 PML4E</p>
    <p>PDPTE</p>
    <p>PDE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
  </div>
  <div class="page">
    <p>Page table walks</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>Page Table</p>
    <p>Virtual Address 0x1fafe7fbf000</p>
    <p>PML4 PDPT Page Directory</p>
    <p>CR3 PML4E</p>
    <p>PDPTE</p>
    <p>PDE</p>
    <p>PTE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
  </div>
  <div class="page">
    <p>Page table walks</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>Page Table</p>
    <p>Virtual Address 0x1fafe7fbf000</p>
    <p>PML4 PDPT Page Directory</p>
    <p>CR3 PML4E</p>
    <p>PDPTE</p>
    <p>PDE</p>
    <p>PTE</p>
    <p>Physical Address</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
  </div>
  <div class="page">
    <p>Page table walks</p>
    <p>What do we need for XLATE + PROBE?</p>
  </div>
  <div class="page">
    <p>Challenges</p>
  </div>
  <div class="page">
    <p>Translation Caches</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>Virtual Address 0x1fafe7fbf000</p>
    <p>Translation Cache</p>
  </div>
  <div class="page">
    <p>Translation Caches</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>Virtual Address 0x1fafe7fbf000</p>
    <p>Translation Cache</p>
  </div>
  <div class="page">
    <p>Translation Caches</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>Virtual Address 0x1fafe7fbf000</p>
    <p>Translation Cache</p>
  </div>
  <div class="page">
    <p>Translation Caches</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>Virtual Address 0x1fafe7fbf000</p>
    <p>CR3</p>
    <p>Translation Cache</p>
  </div>
  <div class="page">
    <p>Translation Caches</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>Virtual Address 0x1fafe7fbf000</p>
    <p>PML4</p>
    <p>CR3</p>
    <p>Translation Cache</p>
  </div>
  <div class="page">
    <p>Translation Caches</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>Virtual Address 0x1fafe7fbf000</p>
    <p>PML4</p>
    <p>CR3 PML4E</p>
    <p>Translation Cache</p>
  </div>
  <div class="page">
    <p>Translation Caches</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>Virtual Address 0x1fafe7fbf000</p>
    <p>PML4 PDPT</p>
    <p>CR3 PML4E</p>
    <p>Translation Cache</p>
  </div>
  <div class="page">
    <p>Translation Caches</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>Virtual Address 0x1fafe7fbf000</p>
    <p>PML4 PDPT</p>
    <p>CR3 PML4E</p>
    <p>PDPTE</p>
    <p>Translation Cache</p>
  </div>
  <div class="page">
    <p>Translation Caches</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>Virtual Address 0x1fafe7fbf000</p>
    <p>PML4 PDPT Page Directory</p>
    <p>CR3 PML4E</p>
    <p>PDPTE</p>
    <p>Translation Cache</p>
  </div>
  <div class="page">
    <p>Translation Caches</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>Virtual Address 0x1fafe7fbf000</p>
    <p>PML4 PDPT Page Directory</p>
    <p>CR3 PML4E</p>
    <p>PDPTE</p>
    <p>PDE</p>
    <p>Translation Cache</p>
  </div>
  <div class="page">
    <p>Translation Caches</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>Page Table</p>
    <p>Virtual Address 0x1fafe7fbf000</p>
    <p>PML4 PDPT Page Directory</p>
    <p>CR3 PML4E</p>
    <p>PDPTE</p>
    <p>PDE</p>
    <p>Translation Cache</p>
  </div>
  <div class="page">
    <p>Translation Caches</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>Page Table</p>
    <p>Virtual Address 0x1fafe7fbf000</p>
    <p>PML4 PDPT Page Directory</p>
    <p>CR3 PML4E</p>
    <p>PDPTE</p>
    <p>PDE 63 191 319</p>
    <p>Translation Cache</p>
    <p>Translation caches cache intermediate page tables</p>
  </div>
  <div class="page">
    <p>Translation Caches</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>Page Table</p>
    <p>Virtual Address 0x1fafe7fbf000</p>
    <p>PML4 PDPT Page Directory</p>
    <p>CR3 PML4E</p>
    <p>PDPTE</p>
    <p>PDE</p>
    <p>PTE 63 191 319</p>
    <p>Translation Cache</p>
  </div>
  <div class="page">
    <p>Translation Caches</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>Page Table</p>
    <p>Virtual Address 0x1fafe7fbf000</p>
    <p>PML4 PDPT Page Directory</p>
    <p>CR3 PML4E</p>
    <p>PDPTE</p>
    <p>PDE</p>
    <p>PTE</p>
    <p>Physical Address</p>
    <p>Translation Cache</p>
  </div>
  <div class="page">
    <p>Translation Caches</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>Virtual Address 0x1fafe7fb8000</p>
    <p>Translation Cache</p>
  </div>
  <div class="page">
    <p>Translation Caches</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>Virtual Address 0x1fafe7fb8000</p>
    <p>Translation Cache</p>
  </div>
  <div class="page">
    <p>Translation Caches</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>Virtual Address 0x1fafe7fb8000</p>
    <p>Translation Cache</p>
    <p>Translation caches cache intermediate page tables</p>
  </div>
  <div class="page">
    <p>Translation Caches</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>Virtual Address 0x1fafe7fb8000</p>
    <p>Translation Cache</p>
    <p>Translation caches cache intermediate page tables</p>
  </div>
  <div class="page">
    <p>Translation Caches</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>Page Table</p>
    <p>Virtual Address 0x1fafe7fb8000</p>
    <p>Translation Cache</p>
    <p>Translation caches cache intermediate page tables</p>
  </div>
  <div class="page">
    <p>Translation Caches</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>Page Table</p>
    <p>Virtual Address 0x1fafe7fb8000</p>
    <p>PTE 63 191 319</p>
    <p>Translation Cache</p>
  </div>
  <div class="page">
    <p>Translation Caches</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>Page Table</p>
    <p>Virtual Address 0x1fafe7fb8000</p>
    <p>PTE</p>
    <p>Physical Address</p>
    <p>Translation Cache</p>
  </div>
  <div class="page">
    <p>Translation Caches</p>
    <p>Some properties of translation caches are undocumented</p>
    <p>How do we reverse engineer them?</p>
  </div>
  <div class="page">
    <p>Translation Caches</p>
    <p>Some properties of translation caches are undocumented</p>
    <p>How do we reverse engineer them?</p>
  </div>
  <div class="page">
    <p>Translation Caches</p>
    <p>Translation Cache</p>
    <p>Virtual Address 0x1fafe7e00000</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>MMU</p>
  </div>
  <div class="page">
    <p>Translation Caches</p>
    <p>Translation Cache</p>
    <p>Virtual Address 0x1fafe7e00000</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>MMU</p>
    <p>Load into translation cache</p>
  </div>
  <div class="page">
    <p>Translation Caches</p>
    <p>Translation Cache</p>
    <p>Virtual Address 0x1fafe7e00000</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>MMU</p>
    <p>Physical Address</p>
    <p>Load into translation cache</p>
  </div>
  <div class="page">
    <p>Translation Caches</p>
    <p>Translation Cache</p>
    <p>Virtual Address 0x1fafe7e00000</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>MMU</p>
    <p>Physical Address</p>
    <p>Perform n page table walks</p>
  </div>
  <div class="page">
    <p>Translation Caches</p>
    <p>Translation Cache</p>
    <p>Virtual Address 0x1fafe8000000</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>MMU</p>
    <p>Perform n page table walks</p>
  </div>
  <div class="page">
    <p>Translation Caches</p>
    <p>Translation Cache</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>MMU</p>
    <p>Physical Address</p>
    <p>Virtual Address 0x1fafe8000000</p>
    <p>Perform n page table walks</p>
  </div>
  <div class="page">
    <p>Translation Caches</p>
    <p>Translation Cache</p>
    <p>Virtual Address 0x1fafe8200000</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>MMU</p>
    <p>Perform n page table walks</p>
  </div>
  <div class="page">
    <p>Translation Caches</p>
    <p>Translation Cache</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>MMU</p>
    <p>Physical Address</p>
    <p>Virtual Address 0x1fafe8200000</p>
    <p>Perform n page table walks</p>
  </div>
  <div class="page">
    <p>Translation Caches</p>
    <p>Reload the target</p>
    <p>Translation Cache</p>
    <p>Virtual Address 0x1fafe7e00000</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>MMU 63 191 320</p>
  </div>
  <div class="page">
    <p>Translation Caches</p>
    <p>The page table entry is still cached</p>
    <p>Translation Cache</p>
    <p>Virtual Address 0x1fafe7e00000</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>MMU</p>
    <p>Physical Address</p>
  </div>
  <div class="page">
    <p>Translation Caches</p>
    <p>Translation Cache</p>
    <p>Virtual Address 0x1fafe7e00000</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>MMU</p>
    <p>Physical Address</p>
    <p>Perform n page table walks</p>
  </div>
  <div class="page">
    <p>Translation Caches</p>
    <p>Translation Cache</p>
    <p>Virtual Address 0x1fafe8000000</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>MMU</p>
    <p>Perform n page table walks</p>
  </div>
  <div class="page">
    <p>Translation Caches</p>
    <p>Translation Cache</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>MMU</p>
    <p>Physical Address</p>
    <p>Virtual Address 0x1fafe8000000</p>
    <p>Perform n page table walks</p>
  </div>
  <div class="page">
    <p>Translation Caches</p>
    <p>Translation Cache</p>
    <p>Virtual Address 0x1fafe8200000</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>MMU</p>
    <p>Perform n page table walks</p>
  </div>
  <div class="page">
    <p>Translation Caches</p>
    <p>Translation Cache</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>MMU</p>
    <p>Physical Address</p>
    <p>Virtual Address 0x1fafe8200000</p>
    <p>Perform n page table walks</p>
  </div>
  <div class="page">
    <p>Translation Caches</p>
    <p>Translation Cache</p>
    <p>Virtual Address 0x1fafe8400000</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>MMU</p>
    <p>Perform n page table walks</p>
  </div>
  <div class="page">
    <p>Translation Caches</p>
    <p>Translation Cache</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>MMU</p>
    <p>Physical Address</p>
    <p>Virtual Address 0x1fafe8400000</p>
    <p>Perform n page table walks</p>
  </div>
  <div class="page">
    <p>Translation Caches</p>
    <p>Translation Cache</p>
    <p>Virtual Address 0x1fafe8600000</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>MMU</p>
    <p>Perform n page table walks</p>
  </div>
  <div class="page">
    <p>Translation Caches</p>
    <p>Translation Cache</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>MMU</p>
    <p>Physical Address</p>
    <p>Virtual Address 0x1fafe8600000</p>
    <p>Perform n page table walks</p>
  </div>
  <div class="page">
    <p>Translation Caches</p>
    <p>Reload the target</p>
    <p>Translation Cache</p>
    <p>Virtual Address 0x1fafe7e00000</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>MMU 63 191 320</p>
  </div>
  <div class="page">
    <p>Translation Caches</p>
    <p>Perform full page table walk</p>
    <p>Translation Cache</p>
    <p>Virtual Address 0x1fafe7e00000</p>
    <p>page offset (12-bit)page table indices (36-bit)</p>
    <p>MMU</p>
    <p>Physical Address</p>
  </div>
  <div class="page">
    <p>Translation Caches Caches TLBs Translation Caches</p>
    <p>CPU Ye ar</p>
    <p>L1 d</p>
    <p>L2 L3 4K p ag</p>
    <p>es</p>
    <p>es</p>
    <p>es</p>
    <p>P M L2</p>
    <p>E</p>
    <p>P M L3</p>
    <p>E</p>
    <p>P M L4</p>
    <p>E</p>
    <p>Ti m e</p>
    <p>Intel Core i7-7500U (Kaby Lake) @ 2.70GHz 2016 32K 256K 4M 1600 32 20 24-32 3-4 0 5m49s Intel Core m3-6Y30 (Skylake) @ 0.90GHz 2015 32K 256K 4M 1600 32 20 24 3-4 0 6m01s Intel Xeon E3-1240 v5 (Skylake) @ 3.50GHz 2015 32K 256K 8M 1600 32 20 24 3-4 0 3m08s Intel Core i7-6700K (Skylake) @ 4.00GHz 2015 32K 256K 8M 1600 32 20 24 3-4 0 3m41s Intel Celeron N2840 (Silvermont) @ 2.16GHz 2014 24K 1M N/A 128 16 N/A 12-16 0 0 52s Intel Core i7-4500U (Haswell) @ 1.80GHz 2013 32K 256K 4M 1088 32 4 24 3-4 0 2m53 Intel Core i7-3632QM (Ivy Bridge) @ 2.20GHz 2012 32K 256K 6M 576 32 4 24-32 3 0 3m05s Intel Core i7-2620QM (Sandy Bridge) @ 2.00GHz 2011 32K 256K 6M 576 32 4 24 2-4 0 3m11s Intel Core i5 M480 (Westmere) @ 2.67GHz 2010 32K 256K 3M 576 32 N/A 24-32 2-6 0 2m44s Intel Core i7 920 (Nehalem) @ 2.67GHz 2008 32K 256K 8M 576 32 N/A 24-32 3 0 4m26s AMD Ryzen 7 1700 8-Core (Zen) @ 3.3GHz 2017 32K 512K 16M 1600 1600 64 0 64 0 13m16s AMD Ryzen 5 1600X 6-Core (Zen) @ 3.6GHz 2017 32K 512K 16M 1600 1600 64 0 64 16 30m50s AMD FX-8350 8-Core (Piledriver) @ 4.0GHz 2012 64K 2M 8M 1088 1088 1088 0 0 0 2m50s AMD FX-8320 8-Core (Piledriver) @ 3.5GHz 2012 64K 2M 8M 1088 1088 1088 0 0 0 2m47s AMD FX-8120 8-Core (Bulldozer) @ 3.4GHz 2011 16K 2M 8M 1056 1056 1056 0 0 0 2m33s AMD Athlon II 640 X4 (K10) @ 3.0GHz 2010 64K 512K N/A 560 176 N/A 24 0 0 7m50s AMD E-350 (Bobcat) @ 1.6GHz 2010 32K 512K N/A 552 8-12 N/A 8-12 0 0 5m38s AMD Phenom 9550 4-Core (K10) @ 2.2GHz 2008 64K 512K 2M 560 176 48 24 0 0 6m52s Rockchip RK3399 (ARM Cortex A72) @ 2.0GHz 2017 32K 1M N/A 544 512 N/A 16 6 N/A 17m49s Rockchip RK3399 (ARM Cortex A53) @ 1.4GHz 2017 32K 512K N/A 522 512 N/A 64 0 N/A 7m06s Allwinner A64 (ARM Cortex A53) @ 1.2GHz 2016 32K 512K N/A 522 512 N/A 64 0 N/A 52m26s Samsung Exynos 5800 (ARM Cortex A15) @ 2.1GHz 2014 32K 2M N/A 544 512 N/A 16 0 N/A 13m28s Nvidia Tegra K1 CD580M-A1 (ARM Cortex A15) @ 2.3GHz 2014 32K 2M N/A 544 512 N/A 16 0 N/A 24m19s Nvidia Tegra K1 CD570M-A1 (ARM Cortex A15; LPAE) @ 2.1GHz 2014 32K 2M N/A 544 512 N/A 16 0 N/A 6m35s Samsung Exynos 5800 (ARM Cortex A7) @ 1.3GHz 2014 32K 512K N/A 266 256 N/A 64 0 N/A 17m42s Samsung Exynos 5250 (ARM Cortex A15) @ 1.7GHz 2012 32K 1M N/A 544 512 N/A 16 0 N/A 6m46s</p>
  </div>
  <div class="page">
    <p>Translation Caches</p>
    <p>Translation caches are widely available on Intel, AMD and ARM</p>
  </div>
  <div class="page">
    <p>Translation Caches</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
    <p>Pages</p>
    <p>Page Tables</p>
  </div>
  <div class="page">
    <p>Translation Caches</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
    <p>Pages</p>
    <p>Translation caches skip page table walks</p>
    <p>Page Tables</p>
    <p>Translation Cache</p>
  </div>
  <div class="page">
    <p>Challenges</p>
  </div>
  <div class="page">
    <p>Shared Memory</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
    <p>Pages</p>
    <p>Page Tables</p>
    <p>Translation Cache</p>
  </div>
  <div class="page">
    <p>Shared Memory</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
    <p>Shared Page</p>
    <p>Use shared memory to reduce noise</p>
    <p>Page Tables</p>
    <p>Translation Cache</p>
  </div>
  <div class="page">
    <p>Challenges</p>
  </div>
  <div class="page">
    <p>Building Eviction Sets</p>
    <p>The Spy in the Sandbox: Practical Cache Attacks in JavaScript and their Implications - Oren et al.</p>
  </div>
  <div class="page">
    <p>Building Eviction Sets</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
  </div>
  <div class="page">
    <p>Building Eviction Sets</p>
    <p>Allocate pages Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
  </div>
  <div class="page">
    <p>Building Eviction Sets</p>
    <p>Allocate pages Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
  </div>
  <div class="page">
    <p>Building Eviction Sets</p>
    <p>Allocate pages Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
  </div>
  <div class="page">
    <p>Building Eviction Sets</p>
    <p>Allocate pages Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
  </div>
  <div class="page">
    <p>Building Eviction Sets</p>
    <p>Allocate pages Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
  </div>
  <div class="page">
    <p>Building Eviction Sets</p>
    <p>Allocate pages Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
  </div>
  <div class="page">
    <p>Building Eviction Sets</p>
    <p>Allocate pages Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
  </div>
  <div class="page">
    <p>Building Eviction Sets</p>
    <p>Draw target Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
  </div>
  <div class="page">
    <p>Building Eviction Sets</p>
    <p>Draw target Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
  </div>
  <div class="page">
    <p>Building Eviction Sets</p>
    <p>Load target into cache Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
  </div>
  <div class="page">
    <p>Building Eviction Sets</p>
    <p>Draw pages and try to evict the target Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
  </div>
  <div class="page">
    <p>Building Eviction Sets</p>
    <p>Draw pages and try to evict the target Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
  </div>
  <div class="page">
    <p>Building Eviction Sets</p>
    <p>Draw pages and try to evict the target Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
  </div>
  <div class="page">
    <p>Building Eviction Sets</p>
    <p>Draw pages and try to evict the target Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
  </div>
  <div class="page">
    <p>Building Eviction Sets</p>
    <p>Draw pages and try to evict the target Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
  </div>
  <div class="page">
    <p>Building Eviction Sets</p>
    <p>Draw pages and try to evict the target Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
  </div>
  <div class="page">
    <p>Building Eviction Sets</p>
    <p>Draw pages and try to evict the target Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
  </div>
  <div class="page">
    <p>Building Eviction Sets</p>
    <p>Draw pages and try to evict the target Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
  </div>
  <div class="page">
    <p>Building Eviction Sets</p>
    <p>Draw pages and try to evict the target Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
  </div>
  <div class="page">
    <p>Building Eviction Sets</p>
    <p>Found an eviction set Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
  </div>
  <div class="page">
    <p>Building Eviction Sets</p>
    <p>Optimize the eviction set Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
  </div>
  <div class="page">
    <p>Building Eviction Sets</p>
    <p>Optimize the eviction set Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
  </div>
  <div class="page">
    <p>Building Eviction Sets</p>
    <p>Optimize the eviction set Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
  </div>
  <div class="page">
    <p>Building Eviction Sets</p>
    <p>Optimize the eviction set Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
  </div>
  <div class="page">
    <p>Building Eviction Sets</p>
    <p>Optimize the eviction set Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
  </div>
  <div class="page">
    <p>Building Eviction Sets</p>
    <p>Optimize the eviction set Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
  </div>
  <div class="page">
    <p>Building Eviction Sets</p>
    <p>Optimal eviction set found Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
    <p>Cache</p>
  </div>
  <div class="page">
    <p>Building Eviction Sets</p>
    <p>Filter red pages Cache Entries</p>
    <p>C ach</p>
    <p>e Sets</p>
  </div>
  <div class="page">
    <p>Building Eviction Sets C</p>
    <p>ach e Sets</p>
    <p>Cache</p>
    <p>Filter red pages Cache Entries</p>
  </div>
  <div class="page">
    <p>Building Eviction Sets</p>
    <p>This technique can also be applied to page tables</p>
  </div>
  <div class="page">
    <p>Challenges</p>
  </div>
  <div class="page">
    <p>XLATE + PROBE</p>
    <p>Its time for the big picture.</p>
  </div>
  <div class="page">
    <p>XLATE + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets Cache AES T-tableAttacker</p>
  </div>
  <div class="page">
    <p>XLATE + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets Cache AES T-tableAttacker</p>
  </div>
  <div class="page">
    <p>XLATE + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets Cache AES T-tableAttacker</p>
    <p>Eviction Set</p>
  </div>
  <div class="page">
    <p>XLATE + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets Cache AES T-tableAttacker</p>
    <p>Eviction Set Page Tables</p>
  </div>
  <div class="page">
    <p>XLATE + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets Cache AES T-tableAttacker</p>
    <p>Eviction Set Page Tables XLATE</p>
  </div>
  <div class="page">
    <p>XLATE + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets Cache AES T-tableAttacker</p>
    <p>Eviction Set Page Tables</p>
    <p>MMU</p>
    <p>XLATE</p>
  </div>
  <div class="page">
    <p>XLATE + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets Cache AES T-tableAttacker</p>
    <p>Eviction Set Page Tables</p>
    <p>MMU</p>
    <p>XLATE</p>
  </div>
  <div class="page">
    <p>XLATE + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets Cache AES T-tableAttacker</p>
    <p>Eviction Set Page Tables</p>
    <p>MMU</p>
    <p>XLATE</p>
  </div>
  <div class="page">
    <p>XLATE + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets Cache AES T-tableAttacker</p>
    <p>Eviction Set Page Tables</p>
    <p>MMU</p>
    <p>XLATE</p>
  </div>
  <div class="page">
    <p>XLATE + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets Cache AES T-tableAttacker</p>
    <p>Eviction Set Page Tables</p>
    <p>MMU</p>
    <p>XLATE</p>
  </div>
  <div class="page">
    <p>XLATE + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets Cache AES T-tableAttacker</p>
    <p>Eviction Set Page Tables</p>
    <p>MMU</p>
    <p>XLATE</p>
  </div>
  <div class="page">
    <p>XLATE + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets Cache AES T-tableAttacker</p>
    <p>Eviction Set Page Tables</p>
    <p>MMU</p>
    <p>Wait</p>
  </div>
  <div class="page">
    <p>XLATE + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets Cache AES T-tableAttacker</p>
    <p>Eviction Set Page Tables</p>
    <p>MMU</p>
    <p>Wait Encrypt</p>
  </div>
  <div class="page">
    <p>XLATE + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets Cache AES T-tableAttacker</p>
    <p>Eviction Set Page Tables</p>
    <p>MMU</p>
    <p>Wait</p>
  </div>
  <div class="page">
    <p>XLATE + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets Cache AES T-tableAttacker</p>
    <p>Eviction Set Page Tables</p>
    <p>MMU</p>
    <p>Wait</p>
  </div>
  <div class="page">
    <p>XLATE + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets Cache AES T-tableAttacker</p>
    <p>Eviction Set Page Tables</p>
    <p>MMU</p>
    <p>Wait</p>
  </div>
  <div class="page">
    <p>XLATE + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets Cache AES T-tableAttacker</p>
    <p>Eviction Set Page Tables</p>
    <p>MMU</p>
    <p>PROBE</p>
  </div>
  <div class="page">
    <p>XLATE + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets Cache AES T-tableAttacker</p>
    <p>Eviction Set Page Tables</p>
    <p>MMU</p>
    <p>PROBE</p>
  </div>
  <div class="page">
    <p>XLATE + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets Cache AES T-tableAttacker</p>
    <p>Eviction Set Page Tables</p>
    <p>MMU</p>
    <p>PROBE</p>
  </div>
  <div class="page">
    <p>XLATE + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets Cache AES T-tableAttacker</p>
    <p>Eviction Set Page Tables</p>
    <p>MMU</p>
    <p>PROBE</p>
  </div>
  <div class="page">
    <p>XLATE + PROBE</p>
    <p>Cache Entries</p>
    <p>C ach</p>
    <p>e Sets Cache AES T-tableAttacker</p>
    <p>Eviction Set Page Tables</p>
    <p>MMU</p>
    <p>PROBE AES encrypt used the same cache set</p>
  </div>
  <div class="page">
    <p>Evaluation</p>
    <p>Evaluation</p>
  </div>
  <div class="page">
    <p>Evaluation</p>
    <p>Reliability</p>
    <p>Effectiveness</p>
    <p>Cache defenses</p>
  </div>
  <div class="page">
    <p>Reliability</p>
    <p>FL U</p>
    <p>SH +</p>
    <p>RE LO</p>
    <p>AD</p>
    <p>FL U</p>
    <p>SH +</p>
    <p>FL U</p>
    <p>SH</p>
    <p>PR IM</p>
    <p>E +</p>
    <p>PR O</p>
    <p>BE</p>
    <p>XL AT</p>
    <p>E +</p>
    <p>PR O</p>
    <p>BE 102</p>
    <p>B an</p>
    <p>dw id</p>
    <p>th (b</p>
    <p>yt es</p>
    <p>/s ec</p>
    <p>)</p>
    <p>FL U</p>
    <p>SH +</p>
    <p>RE LO</p>
    <p>AD</p>
    <p>FL U</p>
    <p>SH +</p>
    <p>FL U</p>
    <p>SH</p>
    <p>PR IM</p>
    <p>E +</p>
    <p>PR O</p>
    <p>BE</p>
    <p>XL AT</p>
    <p>E +</p>
    <p>PR O</p>
    <p>BE 101</p>
    <p>B it</p>
    <p>er ro</p>
    <p>rs (b</p>
    <p>its /s</p>
    <p>ec )</p>
    <p>Cross-Thread (correct) Cross-Thread (raw) Cross-Core (correct) Cross-Core (raw)</p>
    <p>XLATE attacks are practical</p>
  </div>
  <div class="page">
    <p>Reliability</p>
    <p>FL U</p>
    <p>SH +</p>
    <p>RE LO</p>
    <p>AD</p>
    <p>FL U</p>
    <p>SH +</p>
    <p>FL U</p>
    <p>SH</p>
    <p>PR IM</p>
    <p>E +</p>
    <p>PR O</p>
    <p>BE</p>
    <p>XL AT</p>
    <p>E +</p>
    <p>PR O</p>
    <p>BE 102</p>
    <p>B an</p>
    <p>dw id</p>
    <p>th (b</p>
    <p>yt es</p>
    <p>/s ec</p>
    <p>)</p>
    <p>FL U</p>
    <p>SH +</p>
    <p>RE LO</p>
    <p>AD</p>
    <p>FL U</p>
    <p>SH +</p>
    <p>FL U</p>
    <p>SH</p>
    <p>PR IM</p>
    <p>E +</p>
    <p>PR O</p>
    <p>BE</p>
    <p>XL AT</p>
    <p>E +</p>
    <p>PR O</p>
    <p>BE 101</p>
    <p>B it</p>
    <p>er ro</p>
    <p>rs (b</p>
    <p>its /s</p>
    <p>ec )</p>
    <p>Cross-Thread (correct) Cross-Thread (raw) Cross-Core (correct) Cross-Core (raw)</p>
    <p>XLATE attacks are practical 36 / 39</p>
  </div>
  <div class="page">
    <p>Effectiveness</p>
    <p>p[0]</p>
    <p>T e 0</p>
    <p>of fs</p>
    <p>et</p>
    <p>FLUSH + RELOAD</p>
    <p>p[0]</p>
    <p>T e 0</p>
    <p>of fs</p>
    <p>et</p>
    <p>PRIME + PROBE</p>
    <p>p[0]</p>
    <p>T e 0</p>
    <p>of fs</p>
    <p>et</p>
    <p>PRIME + ABORT</p>
    <p>p[0]</p>
    <p>T e 0</p>
    <p>of fs</p>
    <p>et</p>
    <p>FLUSH + FLUSH</p>
    <p>p[0]</p>
    <p>T e 0</p>
    <p>of fs</p>
    <p>et</p>
    <p>XLATE + PROBE</p>
    <p>p[0]</p>
    <p>T e 0</p>
    <p>of fs</p>
    <p>et</p>
    <p>XLATE + ABORT</p>
    <p>XLATE + PROBE is effective against AES T-tables</p>
  </div>
  <div class="page">
    <p>Effectiveness</p>
    <p>p[0]</p>
    <p>T e 0</p>
    <p>of fs</p>
    <p>et</p>
    <p>FLUSH + RELOAD</p>
    <p>p[0]</p>
    <p>T e 0</p>
    <p>of fs</p>
    <p>et</p>
    <p>PRIME + PROBE</p>
    <p>p[0]</p>
    <p>T e 0</p>
    <p>of fs</p>
    <p>et</p>
    <p>PRIME + ABORT</p>
    <p>p[0]</p>
    <p>T e 0</p>
    <p>of fs</p>
    <p>et</p>
    <p>FLUSH + FLUSH</p>
    <p>p[0]</p>
    <p>T e 0</p>
    <p>of fs</p>
    <p>et</p>
    <p>XLATE + PROBE</p>
    <p>p[0]</p>
    <p>T e 0</p>
    <p>of fs</p>
    <p>et</p>
    <p>XLATE + ABORT</p>
    <p>XLATE + PROBE is effective against AES T-tables 37 / 39</p>
  </div>
  <div class="page">
    <p>Cache Defenses</p>
    <p>p[0]</p>
    <p>T e 0</p>
    <p>of fs</p>
    <p>et</p>
    <p>PRIME + PROBE (coloring)</p>
    <p>p[0]</p>
    <p>T e 0</p>
    <p>of fs</p>
    <p>et</p>
    <p>XLATE + PROBE (coloring)</p>
    <p>p[0]</p>
    <p>T e 0</p>
    <p>of fs</p>
    <p>et</p>
    <p>PRIME + PROBE (ways)</p>
    <p>p[0]</p>
    <p>T e 0</p>
    <p>of fs</p>
    <p>et</p>
    <p>XLATE + PROBE (ways)</p>
    <p>XLATE + PROBE bypasses set and way partitioning</p>
  </div>
  <div class="page">
    <p>Cache Defenses</p>
    <p>p[0]</p>
    <p>T e 0</p>
    <p>of fs</p>
    <p>et</p>
    <p>PRIME + PROBE (coloring)</p>
    <p>p[0]</p>
    <p>T e 0</p>
    <p>of fs</p>
    <p>et</p>
    <p>XLATE + PROBE (coloring)</p>
    <p>p[0]</p>
    <p>T e 0</p>
    <p>of fs</p>
    <p>et</p>
    <p>PRIME + PROBE (ways)</p>
    <p>p[0]</p>
    <p>T e 0</p>
    <p>of fs</p>
    <p>et</p>
    <p>XLATE + PROBE (ways)</p>
    <p>XLATE + PROBE bypasses set and way partitioning 38 / 39</p>
  </div>
  <div class="page">
    <p>Conclusions</p>
    <p>New family of cache attacks: Xlate</p>
    <p>Indirect cache attacks are practical</p>
    <p>Reconsider existing cache defenses</p>
    <p>https://vusec.net/projects/xlate</p>
  </div>
</Presentation>
