<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Learning-Based Anomaly Detection in BGP Updates</p>
    <p>Jian Zhang</p>
    <p>Jennifer Rexford</p>
    <p>Joan Feigenbaum</p>
  </div>
  <div class="page">
    <p>Aug. 26, 20052</p>
    <p>Motivations</p>
    <p>Identifying anomalous BGP-updates is important.  Detecting security problems  Flaky equipment</p>
    <p>Its hard to define anomalies.  Only know the signatures of a few types of</p>
    <p>anomalies (e.g., constant updating)  Still at an early stage in understanding:</p>
    <p>What are the anomalies?</p>
    <p>What signal they generate?</p>
  </div>
  <div class="page">
    <p>Aug. 26, 20053</p>
    <p>Anomalies in Update Dynamics</p>
    <p>Anomalies in update dynamics may reflect anomalies in the BGP updates.</p>
    <p>From a routers view, update dynamics show as a sequence of update messages.</p>
    <p>Temporal features of this sequence are important in anomaly detection.  Message burst duration and intensity  Inter-burst interval</p>
  </div>
  <div class="page">
    <p>Aug. 26, 20054</p>
    <p>Previous Analyses of Update Dynamics</p>
    <p>Many use simple aggregations.  Consider aggregations over time interval T.  Temporal features at levels finer than T are lost.  To detect constant updating, these features may</p>
    <p>not be necessary.  They may be needed to identify other types of</p>
    <p>anomalies.  Some suffer from the magic number problem.</p>
  </div>
  <div class="page">
    <p>Aug. 26, 20055</p>
    <p>Our Approach</p>
    <p>Learn a model of normal update behavior.</p>
    <p>Identify updates that deviate significantly for further investigation.</p>
    <p>Difference from previous work:  Multi-scale analysis  Representation captures more temporal features.</p>
  </div>
  <div class="page">
    <p>Aug. 26, 20056</p>
    <p>Transformation of Update Message Signals</p>
    <p>We view the sequence of update messages for each prefix as a signal along time:</p>
    <p>Apply a wavelet transformation to the signal to reveal its temporal features.</p>
    <p>Time</p>
    <p># o</p>
    <p>f M e s</p>
    <p>s a</p>
    <p>g e s</p>
  </div>
  <div class="page">
    <p>Aug. 26, 20057</p>
    <p>Representation of Update Dynamics</p>
    <p>Build histograms for the distributions of the temporal features.</p>
    <p>View the histograms as a vector. A trace of update dynamics becomes a point in a vector space.</p>
    <p>The transformation and the representation capture temporal features at different time scales.</p>
  </div>
  <div class="page">
    <p>Aug. 26, 20058</p>
    <p>Avoid Magic Numbers</p>
    <p>It is hard to determine a good value for the magic numbers.</p>
    <p>We consider a set of values in an interval [Tmin, Tmax].</p>
    <p>Using an interval large enough, our analysis can avoid the magic-number problem.</p>
  </div>
  <div class="page">
    <p>Aug. 26, 20059</p>
    <p>Clustering</p>
    <p>Traces of update dynamics are mapped into points in a vector space.</p>
    <p>Clustering groups the update dynamics into clusters to reveal different types of dynamics.</p>
  </div>
  <div class="page">
    <p>Aug. 26, 200510</p>
    <p>Learn Normal Dynamics</p>
    <p>Normal dynamics: regions containing most of the update traces</p>
    <p>Abnormal dynamics: traces mapped to a location far away from the normal</p>
  </div>
  <div class="page">
    <p>Aug. 26, 200511</p>
    <p>System Overview</p>
    <p>Signal of updates</p>
    <p>Wavelet transformation</p>
    <p>Distribution of message-burst durations and intervals</p>
    <p>Representation in a vector space Learn normal</p>
    <p>dynamics and detect anomalies</p>
  </div>
  <div class="page">
    <p>Aug. 26, 200512</p>
    <p>Experiments</p>
    <p>RouteViews data</p>
    <p>6 Months of update messages</p>
    <p>Combined update messages from all RouteViews vantage points.</p>
    <p>Clustering for a single prefix along time and across prefixes.</p>
  </div>
  <div class="page">
    <p>Aug. 26, 200513</p>
    <p>Preliminary Results</p>
    <p>Focusing on individual prefixes:  Typically, the largest cluster contains 80-90% of</p>
    <p>instances of the update dynamics.</p>
    <p>Across prefixes:  Several (3-4) largest clusters contain about 50%</p>
    <p>of the prefixes.</p>
    <p>In both cases, constant updating show as outliers.</p>
  </div>
  <div class="page">
    <p>Aug. 26, 200514</p>
    <p>Further Investigation</p>
    <p>Ongoing work to find out:  What are the particular types of dynamics in each</p>
    <p>cluster?  Are the updates in the small clusters that deviate</p>
    <p>from the normal real anomalies?  Use labeled examples to build the knowledge</p>
    <p>base.</p>
    <p>Incorporate the route attributes in our representation.</p>
  </div>
</Presentation>
