<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Enabling Wide-spread Communications on Optical Fabric with MegaSwitch</p>
    <p>Li Chen</p>
    <p>Kai Chen, Zhonghua Zhu, Minlan Yu, George Porter, Chunming Qiao, Shan Zhong</p>
  </div>
  <div class="page">
    <p>Optical Networking in Data Centers</p>
    <p>Data center traffic demand is growing</p>
    <p>Optical Fabric</p>
    <p>Jupiter Rising [Sigcomm15]</p>
    <p>Optical networking in data centers  Low cost  Low power consumption  Low wiring complexity  High one-to-one bandwidth</p>
    <p>How to design an optical fabric that enables high bisection bandwidth?</p>
  </div>
  <div class="page">
    <p>Optical fabric usually provides one-to-one high-bandwidth circuits.  Data Center traffic is wide-spread</p>
    <p>Optical Networking in Data Centers</p>
    <p>How to design an optical fabric that supports high-bandwidth &amp; widespread traffic?</p>
    <p>Microsoft Data Center Network [ProjecToR, Sigcomm16]</p>
  </div>
  <div class="page">
    <p>Prior Works</p>
    <p>2010: C-Through, Helios  2012: OSA  2013: Mordia, ReacToR</p>
    <p>Prior works reuse wavelengths temporally to meet traffic demand</p>
    <p>t1 t2 time</p>
    <p>Schedule 1 Schedule 2 Schedule 3</p>
    <p>Traffic Demand Matrix</p>
    <p>Src</p>
    <p>Dest</p>
    <p>Wavelength/Circuit assignments</p>
    <p>BvN decomp.</p>
  </div>
  <div class="page">
    <p>High Bisection Bandwidth + Wide-Spread Connectivity</p>
    <p>2010: C-Through, Helios  2012: OSA  2013: Mordia, ReacToR</p>
    <p>Prior works take several rounds to meet a wide-spread demand</p>
    <p>MegaSwitch: Meet a wide-spread demand simultaneously</p>
    <p>t1 t2 time</p>
    <p>Schedule 1 Schedule 2 Schedule 3</p>
    <p>time Parallel circuits</p>
    <p>Circuit 1 Circuit 2 Circuit 3</p>
    <p>using MegaSwitch</p>
  </div>
  <div class="page">
    <p>MegaSwitch Data Plane Enabling Spatial Reuse of Wavelength Prototype implementation</p>
  </div>
  <div class="page">
    <p>Multiplexer</p>
    <p>MUX: k input wavelengths, 1 output fiber</p>
  </div>
  <div class="page">
    <p>Demultiplexer</p>
    <p>DEMUX: 1 input fiber, k output wavelengths</p>
  </div>
  <div class="page">
    <p>Wavelength Selective Switch</p>
    <p>WSS: w input fibers, 1 output fiber  Same set of wavelengths can be reused on different fibers.</p>
    <p>Fiber 1</p>
    <p>Fiber 2</p>
    <p>Fiber 3</p>
    <p>Fiber 4</p>
  </div>
  <div class="page">
    <p>Wavelength Selective Switch</p>
    <p>WSS: w input fibers, 1 output fiber  Same set of wavelengths can be reused on different fibers.</p>
    <p>Fiber 1</p>
    <p>Fiber 2</p>
    <p>Fiber 3</p>
    <p>Fiber 4</p>
  </div>
  <div class="page">
    <p>Sending</p>
    <p>ToR 1 ToR 2 ToR 3</p>
    <p>Send using k wavelengths</p>
    <p>Each ToR sends on its own fiber</p>
  </div>
  <div class="page">
    <p>Receiving</p>
    <p>Recv from w other nodes</p>
    <p>Select k wavelengths from wk wavelengths</p>
    <p>ToR 1 ToR 2 ToR 3</p>
  </div>
  <div class="page">
    <p>MegaSwitch: Full 3-Node Example</p>
    <p>ToR 1 ToR 2 ToR 3</p>
    <p>Recv from w other nodes</p>
    <p>Send using k wavelengths</p>
    <p>Select k wavelengths from wk wavelengths</p>
    <p>Each ToR sends on its own fiber</p>
  </div>
  <div class="page">
    <p>MegaSwitch: Scalability</p>
    <p>Recv from w other nodes</p>
    <p>Send using k wavelengths</p>
    <p>Select k wavelengths from wk wavelengths</p>
    <p>Each ToR sends on its own fiber</p>
    <p>ToR 1 ToR 2 ToR 3</p>
    <p>Key parameters: w = 2, n = w+1 =3, k =4, Port Count = n x k</p>
    <p># nodes on ring</p>
    <p>WSS port count # wavelength on a fiber</p>
    <p>With current technology, MegaSwitch can scale to n x k = 33 x 192 = 6336 Ports</p>
  </div>
  <div class="page">
    <p>Unicast from H1 to H12 1, Control plane select Blue as the wavelength for the unicast</p>
  </div>
  <div class="page">
    <p>Unicast from H1 to H12</p>
  </div>
  <div class="page">
    <p>Unicast from H1 to H12</p>
  </div>
  <div class="page">
    <p>Multicast from H1 to H5, H6, H7, and H10</p>
  </div>
  <div class="page">
    <p>MegaSwitch: Full 3-Node Example</p>
    <p>OWS+PRF box OWS+PRF box OWS+PRF box</p>
  </div>
  <div class="page">
    <p>OWS+PRF box</p>
    <p>Prototype Implementation</p>
    <p>Implemented OWS+PRF box for practical deployment.  Implemented prototype with 40  10Gbps</p>
    <p>Ports  5 nodes (OWS-EPS)  8 wavelengths per node</p>
  </div>
  <div class="page">
    <p>High Port Count &amp; Low Switching Latency</p>
    <p>Lowest WSS switching latency reported: 11.5us [Mordia, Sigcomm13]  Digital Light Processing (DLP) technology.  Cannot scale beyond 8 ports with 11.5us switching</p>
    <p>MegaSwitch need a large WSS port count to scale to more ports  Liquid Crystal tech. is a middle-ground in terms of both port count (10~100s) and</p>
    <p>switching latency (milliseconds).  Measured WSS switching latency: ~3ms</p>
    <p>Milliseconds switching latency is a hard limit for now.  Optics community are working on it</p>
    <p>How to mitigate impact to short flows?</p>
    <p>cannot be achieved at the same time</p>
  </div>
  <div class="page">
    <p>MegaSwitch Control Plane Basemesh for latency-sensitive applications</p>
  </div>
  <div class="page">
    <p>Basemesh</p>
    <p>Problem:  when traffic matrix changes quickly  when traffic matrix is estimated incorrectly</p>
    <p>Basemesh: a flexible overlay network on MegaSwitch to provide consistent connectivity for low latency traffic.  Each node dedicates b wavelengths to construct an overlay network on fully</p>
    <p>connected fiber mesh.</p>
    <p>Dynamic Allocation</p>
    <p>Basemesh Connectivity</p>
    <p>b wavelengths</p>
    <p>k-b wavelengths</p>
  </div>
  <div class="page">
    <p>Basemesh: Learning from DHT literature</p>
    <p>MegaSwitch uses Symphony [USITS 13] DHT topology for basemesh construction.  b (routing table size) is adjustable for varying degree of traffic volatility  Guaranteed average latency (average hop count per look-up)</p>
    <p>Basemesh b=5, Avg Hops =1 Fully connected mesh network (w=5) Recommended for low latency apps</p>
    <p>Basemesh b=3 Avg Hops = 1.4</p>
    <p>Basemesh b=1 Avg Hops = 2.5</p>
  </div>
  <div class="page">
    <p>Evaluations Testbed benchmark Real application deployments</p>
  </div>
  <div class="page">
    <p>Prototype Evaluation</p>
    <p>Setting:  5 nodes (OWS-EPS pair)  8 wavelengths per node  8 servers per node  Out-of-band control plane for EPS and OWS  Traffic demand matrices are known</p>
  </div>
  <div class="page">
    <p>Basic measurements</p>
    <p>Host-level stride  All-to-all pattern [Helios, Sigcomm10]  Every 10s, one wavelength changes</p>
    <p>per rack.</p>
    <p>Measured ~20ms total reconfiguration delay.  WSS (~3ms), EPS routing (~5ms),</p>
    <p>transceiver initialization (~10ms)</p>
    <p>50Gbps</p>
    <p>MegaSwitch achieves full-bisection bandwidth when circuit is stable</p>
  </div>
  <div class="page">
    <p>Redis on MegaSwitch</p>
    <p>Latency-sensitive application  1 Million GET/SET requests from all nodes to a server in Node1</p>
    <p>Fully connected basemesh  Uniform latency (one-hop)</p>
    <p>M ic</p>
    <p>ro se</p>
    <p>co nd</p>
    <p>s</p>
    <p>Number of Basemesh Wavelengths (b)</p>
    <p>Average Query Completion Time</p>
    <p>Node 1</p>
    <p>Node 2</p>
    <p>Node 3</p>
    <p>Node 4</p>
    <p>Node 5</p>
  </div>
  <div class="page">
    <p>Apache Spark on MegaSwitch</p>
    <p>Parallel computing applications  First connect the servers to a</p>
    <p>single ToR switch, and measure the bandwidth demand  MegaSwitch updates wavelength</p>
    <p>assignment every 1 sec.  &lt;10 reconfigurations in run-time.</p>
    <p>MegaSwitch performs similar to the optimal scenario: all servers in the same rack</p>
    <p>KMeans WordCount WikiPageRank</p>
    <p>Se co</p>
    <p>nd s</p>
    <p>Job Completion Time</p>
    <p>Single ToR MegaSwitch (1s)</p>
  </div>
  <div class="page">
    <p>Summary</p>
    <p>Spatial reuse of wavelengths to provide non-blocking connectivity for all ports.  Basemesh to provide consistent connectivity to latency-sensitive</p>
    <p>flows.  Practical implementation of a 5-node ring of 40 ports.</p>
    <p>MegaSwitch: An optical design that supports wide-spread, high-bandwidth traffic patterns in todays production workloads.</p>
    <p>More in our paper: Fault-tolerance, delay measurements, power budget, cost</p>
  </div>
  <div class="page">
    <p>Got New Ideas for NSDI18? Test them in APNet17!</p>
    <p>The first Asia-Pacific Workshop on Networking  Aug. 3-4, 2017 @Hong Kong</p>
    <p>A good venue to test your innovative ideas and get feedback from the community.  Submit your 6-page paper on/before Apr. 21th, 2017</p>
  </div>
</Presentation>
