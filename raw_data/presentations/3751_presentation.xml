<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Poison Over Troubled Forwarders: A Cache Poisoning Attack Targeting DNS Forwarding Devices</p>
    <p>Xiaofeng Zheng, Chaoyi Lu, Jian Peng, Qiushi Yang, Dongjie Zhou, Baojun Liu, Keyu Man, Shuang Hao, Haixin Duan and Zhiyun Qian</p>
  </div>
  <div class="page">
    <p>DNS Forwarder</p>
    <p>Devices standing in between stub and recursive resolvers E.g., home routers, open Wi-Fi networks Can have caching abilities Relies on the integrity of upstream resolvers</p>
  </div>
  <div class="page">
    <p>DNS Cache Poisoning Attacks</p>
    <p>Forging attacks targeting recursive resolvers Craft a DNS answer which matches the querys metadata Example: Kaminsky Attack (2008) Mitigation: increase randomness of DNS packet</p>
    <p>RFC 5452: DNS resolver implementations should use randomized ephemeral port numbers and DNS transaction IDs</p>
  </div>
  <div class="page">
    <p>Threat Model: Overview</p>
    <p>Defragmentation attacks targeting DNS forwarders Reliably forces DNS response fragmentation Targets arbitrary victim domain names</p>
  </div>
  <div class="page">
    <p>Threat Model: Overview</p>
    <p>Defragmentation attacks targeting DNS forwarders Reliably forces DNS response fragmentation Targets arbitrary victim domain names</p>
  </div>
  <div class="page">
    <p>Insight on Forwarder Roles</p>
    <p>Defragmentation attacks targeting DNS forwarders Reliably forces DNS response fragmentation Targets arbitrary victim domain names</p>
    <p>Relies on recursive resolvers Target of cache poisoning</p>
    <p>Security checks (e.g., DNSSEC)</p>
  </div>
  <div class="page">
    <p>Attackers Oversized DNS Response</p>
    <p>CNAME chain Use dummy CNAME records to enlarge attackers DNS response</p>
    <p>&gt; 1,500 Bytes (Ethernet MTU)</p>
    <p>Always produce fragments</p>
  </div>
  <div class="page">
    <p>Attackers Oversized DNS Response</p>
    <p>CNAME chain Use dummy CNAME records to enlarge attackers DNS response Use CNAME to point attackers domain to any victim</p>
    <p>What the recursive resolver sees</p>
    <p>What the DNS forwarder sees</p>
  </div>
  <div class="page">
    <p>Attackers Oversized DNS Response</p>
    <p>CNAME chain Use dummy CNAME records to enlarge attackers DNS response Use CNAME to point attackers domain to any victim</p>
    <p>What the recursive resolver sees</p>
    <p>What the DNS forwarder sees</p>
  </div>
  <div class="page">
    <p>Flow of Defragmentation Attack</p>
    <p>Defragmentation attacks targeting DNS forwarders</p>
  </div>
  <div class="page">
    <p>Flow of Defragmentation Attack</p>
    <p>Defragmentation attacks targeting DNS forwarders</p>
  </div>
  <div class="page">
    <p>Flow of Defragmentation Attack</p>
    <p>Defragmentation attacks targeting DNS forwarders</p>
    <p>returns oversized response (&gt; Ethernet MTU)</p>
  </div>
  <div class="page">
    <p>Flow of Defragmentation Attack</p>
    <p>Defragmentation attacks targeting DNS forwarders</p>
    <p>returns oversized response (&gt; Ethernet MTU)</p>
  </div>
  <div class="page">
    <p>Flow of Defragmentation Attack</p>
    <p>Defragmentation attacks targeting DNS forwarders</p>
    <p>returns oversized response (&gt; Ethernet MTU)</p>
    <p>Lack Security Checks</p>
  </div>
  <div class="page">
    <p>Conditions of Successful Attacks</p>
    <p>DNS caching by record The tampered record can be cached separately</p>
    <p>EDNS(0) support Allows transfer of DNS messages larger than 512 Bytes</p>
    <p>No active truncation of DNS response Ensures that the entire oversized response is transfered</p>
    <p>No response verification DNS forwarders rely on upstream resolvers</p>
  </div>
  <div class="page">
    <p>Vulnerable DNS Software</p>
    <p>Home routers 16 models are tested (by real attacks in controlled environment) 8 models are vulnerable</p>
    <p>DNS software 2 kinds of popular DNS software are vulnerable</p>
  </div>
  <div class="page">
    <p>Vulnerable DNS Software</p>
    <p>Home routers 16 models are tested (by real attacks in controlled environment) 8 models are vulnerable</p>
    <p>DNS software 2 kinds of popular DNS software are vulnerable</p>
    <p>Responsible Disclosure ASUS and D-Link release firmware patches Linksys accepts issue via BugCrowd</p>
  </div>
  <div class="page">
    <p>Measuring Clients Potentially Under Risk</p>
    <p>Collect vantage points Implement measurement code in a network diagnosis tool 20K clients, mostly located in China</p>
    <p>Check the forwarder conditions Ethical considerations: no real attack 40% do not support EDNS(0) yet Estimated vulnerable clients: 6.6%</p>
  </div>
  <div class="page">
    <p>Discussion</p>
    <p>Mitigation for DNS forwarders Perform response verification (e.g., DNSSEC) DNS caching by response (short-term solution)</p>
    <p>Lack clear guidelines of DNS forwarders What role should they play? What features should be supported?</p>
  </div>
  <div class="page">
    <p>Any Questions? zxf19@mails.tsinghua.edu.cn</p>
    <p>An attack targeting DNS forwarders</p>
    <p>Affects forwarder implementations extensively</p>
    <p>Call for more attention on DNS forwarder security</p>
  </div>
</Presentation>
