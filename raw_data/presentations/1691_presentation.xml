<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Catching Bandits and Only Bandits: Privacy-Preserving Intersection Warrants for</p>
    <p>Lawful Surveillance</p>
    <p>Aaron Segal, Bryan Ford, and Joan Feigenbaum</p>
    <p>Yale University</p>
    <p>FOCI 2014</p>
    <p>an unspeakable blasphemy. - @Dymaxion</p>
  </div>
  <div class="page">
    <p>Overview</p>
    <p>Mass Surveillance and Privacy  Introduction</p>
    <p>Privacy Principles for Open Surveillance Processes</p>
    <p>Case Study  High Country Bandits and Lawful Intersection Protocol</p>
    <p>Implementation &amp; Evaluation</p>
  </div>
  <div class="page">
    <p>Motivation &amp; Goals</p>
    <p>State of the art discussion on surveillance and privacy:</p>
    <p>- Secret processes for data collection</p>
    <p>- Public is asked to trust the government</p>
    <p>- Presumed tradeoff between national security and personal privacy</p>
    <p>- Ideal world: No surveillance</p>
  </div>
  <div class="page">
    <p>Motivation &amp; Goals</p>
    <p>State of the art discussion on surveillance and privacy:</p>
    <p>- Secret processes for data collection</p>
    <p>- Public is asked to trust the government</p>
    <p>- Presumed tradeoff between national security and personal privacy</p>
    <p>Realistic goal: Surveillance with privacy protection</p>
  </div>
  <div class="page">
    <p>Motivation &amp; Goals</p>
    <p>State of the art discussion on surveillance and privacy:</p>
    <p>- Secret processes for data collection</p>
    <p>- Public is asked to trust the government</p>
    <p>No need to abandon personal privacy to ensure national security</p>
    <p>Realistic goal: Surveillance with privacy protection</p>
  </div>
  <div class="page">
    <p>Motivation &amp; Goals</p>
    <p>State of the art discussion on surveillance and privacy:</p>
    <p>- Secret processes for data collection</p>
    <p>Accountability guaranteed by existing cryptographic technology</p>
    <p>No need to abandon personal privacy to ensure national security</p>
    <p>Realistic goal: Surveillance with privacy protection</p>
  </div>
  <div class="page">
    <p>Motivation &amp; Goals</p>
    <p>State of the art discussion on surveillance and privacy:</p>
    <p>Open processes for data collection</p>
    <p>Accountability guaranteed by existing cryptographic technology</p>
    <p>No need to abandon personal privacy to ensure national security</p>
    <p>Realistic goal: Surveillance with privacy protection</p>
  </div>
  <div class="page">
    <p>Privacy Principles for Surveillance</p>
    <p>Open processes</p>
    <p>- Must follow rules and procedures of public law</p>
    <p>- Need not disclose targets and details of investigations</p>
    <p>Two types of users:</p>
    <p>Targeted users - Under suspicion</p>
    <p>- Subject of a warrant</p>
    <p>- Can be known or unknown</p>
    <p>Untargeted users - No probable cause</p>
    <p>- Not targets of investigation</p>
    <p>- The vast majority of internet users</p>
  </div>
  <div class="page">
    <p>Open Privacy Firewall</p>
    <p>I. Any surveillance or law-enforcement process that obtains or uses private information about untargeted users shall be an open, public, unclassified process.</p>
    <p>II. Any secret surveillance or law-enforcement process shall use only: a. public information, and</p>
    <p>b. private information about targeted users obtained under authorized warrants via open surveillance processes.</p>
  </div>
  <div class="page">
    <p>Surveillance Privacy Principles</p>
    <p>Division of trust - No one agency can compromise privacy</p>
    <p>Enforced scope limiting - Overly broad group of users data is not captured</p>
    <p>Sealing time and notification - Finite, reasonable time before users are notified</p>
    <p>Accountability - Statistics presented on use of surveillance</p>
  </div>
  <div class="page">
    <p>Case Study  High Country Bandits</p>
    <p>FBI Intersection attack compared 3 cell tower dumps totaling 150,000 users</p>
    <p>1 number found in all 3 cell dumps  led to arrest</p>
    <p>149,999 innocent users information acquired</p>
  </div>
  <div class="page">
    <p>Intersecting Cell-Tower Dumps</p>
    <p>Law enforcement goal: Find targeted, unknown user whose phone number will appear in the intersection of cell-tower dumps</p>
    <p>Used in: High Country Bandits case, CO-TRAVELER program - Same principle for any collection of metadata</p>
    <p>Cell Tower A Time t1</p>
    <p>203-555-4430</p>
    <p>203-555-3435</p>
    <p>203-555-2840</p>
    <p>203-555-7691</p>
    <p>203-555-1505</p>
    <p>203-555-9589</p>
    <p>203-555-7976</p>
    <p>203-555-9266</p>
    <p>Cell Tower B</p>
    <p>Time t2</p>
    <p>203-555-3222</p>
    <p>203-555-3813</p>
    <p>203-555-2786</p>
    <p>203-555-7976</p>
    <p>203-555-0392</p>
    <p>203-555-5872</p>
    <p>203-555-4891</p>
    <p>203-555-9709</p>
    <p>Cell Tower C</p>
    <p>Time t3</p>
    <p>203-555-7928</p>
    <p>203-555-0599</p>
    <p>203-555-6445</p>
    <p>203-555-7511</p>
    <p>203-555-2277</p>
    <p>203-555-7976</p>
    <p>203-555-2840</p>
    <p>203-555-3222</p>
  </div>
  <div class="page">
    <p>Intersecting Cell-Tower Dumps</p>
    <p>Cell Tower A Time t1</p>
    <p>203-555-4430</p>
    <p>203-555-3435</p>
    <p>203-555-2840</p>
    <p>203-555-7691</p>
    <p>203-555-1505</p>
    <p>203-555-9589</p>
    <p>203-555-7976</p>
    <p>203-555-9266</p>
    <p>Cell Tower B</p>
    <p>Time t2</p>
    <p>203-555-3222</p>
    <p>203-555-3813</p>
    <p>203-555-2786</p>
    <p>203-555-7976</p>
    <p>203-555-0392</p>
    <p>203-555-5872</p>
    <p>203-555-4891</p>
    <p>203-555-9709</p>
    <p>Cell Tower C</p>
    <p>Time t3</p>
    <p>203-555-7928</p>
    <p>203-555-0599</p>
    <p>203-555-6445</p>
    <p>203-555-7511</p>
    <p>203-555-2277</p>
    <p>203-555-7976</p>
    <p>203-555-2840</p>
    <p>203-555-3222</p>
    <p>Law enforcement goal: Find targeted, unknown user whose phone number will appear in the intersection of cell-tower dumps</p>
    <p>Used in: High Country Bandits case, CO-TRAVELER program - Same principle for any collection of metadata</p>
  </div>
  <div class="page">
    <p>Privacy-Protecting Solution</p>
    <p>Based on Vaidya, Clifton (2005)</p>
    <p>A private set intersection protocol built to satisfy surveillance privacy principles</p>
    <p>Relies on multiple, independent agencies to execute protocol, providing division of trust, accountability</p>
    <p>Example:  Executive agency (FBI, NSA)</p>
    <p>Judicial agency (warrant-issuing court)</p>
    <p>Legislative agency (oversight committee established by law)</p>
  </div>
  <div class="page">
    <p>Private Set Intersection Protocol  Preparation</p>
    <p>Each agency provides encryption key based on commutative, publickey, randomized encryption scheme</p>
    <p>- Commutative encryption: DecA(DecB(c)) = DecB(DecA(c))</p>
    <p>Sources of phone metadata (telecoms) encrypt each data item using all agencies keys and give encrypted sets to repositories</p>
    <p>When agencies agree on a warrant for intersection, repositories distribute encrypted data sets to agencies</p>
    <p>- Agencies individually select temporary keys for a commutative, deterministic encryption scheme to be used for this intersection, then thrown away</p>
  </div>
  <div class="page">
    <p>Private Set Intersection Protocol  Phase 1</p>
    <p>An agency starts with data sets under randomized encryption by all agencies keys</p>
    <p>Each agency strips off its layer of randomized encryption, adds a layer of deterministic encryption using its temporary key, permutes the data sets, and sends them to next agency</p>
    <p>(203) 555-2469 (203) 555-7976 (203) 555-7976</p>
    <p>(203) 555-7976 (203) 555-8770 (203) 555-3179</p>
  </div>
  <div class="page">
    <p>Private Set Intersection Protocol  Phase 1</p>
    <p>An agency starts with data sets under randomized encryption by all agencies keys</p>
    <p>Each agency strips off its layer of randomized encryption, adds a layer of deterministic encryption using its temporary key, permutes the data sets, and sends them to next agency</p>
    <p>(203) 555-2469 (203) 555-7976 (203) 555-7976</p>
    <p>(203) 555-7976 (203) 555-8770 (203) 555-3179</p>
  </div>
  <div class="page">
    <p>Private Set Intersection Protocol  Phase 1</p>
    <p>An agency starts with data sets under randomized encryption by all agencies keys</p>
    <p>Each agency strips off its layer of randomized encryption, adds a layer of deterministic encryption using its temporary key, permutes the data sets, and sends them to next agency</p>
    <p>(203) 555-2469 (203) 555-7976 (203) 555-7976</p>
    <p>(203) 555-7976 (203) 555-8770 (203) 555-3179</p>
  </div>
  <div class="page">
    <p>Private Set Intersection Protocol  Phase 1</p>
    <p>An agency starts with data sets under randomized encryption by all agencies keys</p>
    <p>Each agency strips off its layer of randomized encryption, adds a layer of deterministic encryption using its temporary key, permutes the data sets, and sends them to next agency</p>
    <p>(203) 555-2469 (203) 555-7976 (203) 555-7976</p>
    <p>(203) 555-7976 (203) 555-8770 (203) 555-3179</p>
  </div>
  <div class="page">
    <p>Private Set Intersection Protocol  Phase 1</p>
    <p>An agency starts with data sets under randomized encryption by all agencies keys</p>
    <p>Each agency strips off its layer of randomized encryption, adds a layer of deterministic encryption using its temporary key, permutes the data sets, and sends them to next agency</p>
    <p>(203) 555-2469 (203) 555-7976 (203) 555-7976</p>
    <p>(203) 555-7976 (203) 555-8770 (203) 555-3179</p>
  </div>
  <div class="page">
    <p>Private Set Intersection Protocol  Phase 2</p>
    <p>When phase I is done, each item has encrypted with deterministic encryption using temporary keys</p>
    <p>Matching ciphertexts = matching plaintexts = targeted users  keep</p>
    <p>Non-matching ciphertexts = untargeted users  discard</p>
    <p>(203) 555-2469 (203) 555-7976 (203) 555-7976</p>
    <p>(203) 555-7976 (203) 555-8770 (203) 555-3179</p>
  </div>
  <div class="page">
    <p>Private Set Intersection Protocol  Phase 2</p>
    <p>When phase I is done, each item has encrypted with deterministic encryption using temporary keys</p>
    <p>Matching ciphertexts = matching plaintexts = targeted users  keep</p>
    <p>Non-matching ciphertexts = untargeted users  discard</p>
    <p>(203) 555-2469 (203) 555-7976 (203) 555-7976</p>
    <p>(203) 555-7976 (203) 555-8770 (203) 555-3179</p>
  </div>
  <div class="page">
    <p>Private Set Intersection Protocol  Phase 2</p>
    <p>When phase I is done, each item has encrypted with deterministic encryption using temporary keys</p>
    <p>Matching ciphertexts = matching plaintexts = targeted users  keep</p>
    <p>Non-matching ciphertexts = untargeted users  discard</p>
    <p>(203) 555-7976</p>
  </div>
  <div class="page">
    <p>Private Set Intersection Protocol  Phase 2</p>
    <p>After phase II, size of intersection revealed</p>
    <p>If intersection cardinality above pre-defined threshold, any agency can stop protocol</p>
    <p>- Prevents accidental compromise of privacy, e.g. concert scenario</p>
    <p>(203) 555-7976</p>
  </div>
  <div class="page">
    <p>Private Set Intersection Protocol  Phase 2</p>
    <p>After phase II, size of intersection revealed</p>
    <p>If intersection cardinality above pre-defined threshold, any agency can stop protocol</p>
    <p>- Prevents accidental compromise of privacy, e.g. concert scenario</p>
    <p>(203) 555-7976</p>
    <p>(203) 555-1282</p>
  </div>
  <div class="page">
    <p>Private Set Intersection Protocol  Phase 2</p>
    <p>After phase II, size of intersection revealed</p>
    <p>If intersection cardinality above pre-defined threshold, any agency can stop protocol</p>
    <p>- Prevents accidental compromise of privacy, e.g. concert scenario</p>
    <p>(203) 555-7976</p>
    <p>(203) 555-1282</p>
  </div>
  <div class="page">
    <p>Private Set Intersection Protocol  Phase 3</p>
    <p>Once intersection is determined, each agency uses temporary key to remove its layer of encryption</p>
    <p>Set is permuted and passed on as in phase I</p>
    <p>Final results sent to all participants</p>
    <p>Temporary keys securely deleted</p>
    <p>(203) 555-7976</p>
  </div>
  <div class="page">
    <p>Private Set Intersection Protocol  Phase 3</p>
    <p>Once intersection is determined, each agency uses temporary key to remove its layer of encryption</p>
    <p>Set is permuted and passed on as in phase I</p>
    <p>Final results sent to all participants</p>
    <p>Temporary keys securely deleted</p>
    <p>(203) 555-7976</p>
  </div>
  <div class="page">
    <p>Private Set Intersection Protocol  Phase 3</p>
    <p>Once intersection is determined, each agency uses temporary key to remove its layer of encryption</p>
    <p>Set is permuted and passed on as in phase I</p>
    <p>Final results sent to all participants</p>
    <p>Temporary keys securely deleted</p>
    <p>(203) 555-7976</p>
  </div>
  <div class="page">
    <p>Protocol Satisfies Privacy Principles</p>
    <p>Satisfies principle of Open Process - Can openly standardize protocol, crypto without compromising investigative</p>
    <p>power</p>
    <p>Division of trust - No one agency can decrypt or perform intersection</p>
    <p>Enforced scope limiting - Any agency can stop protocol if sets or intersection are too large</p>
    <p>Sealing time and notification - Implementable by policy  all agencies get final data set</p>
    <p>Accountability - Because every agency must participate, no agencies can perform attack</p>
    <p>without other agencies learning and getting statistics</p>
  </div>
  <div class="page">
    <p>Implementation of Protocol</p>
    <p>We implemented our lawful set intersection protocol in Java</p>
    <p>Tested with three agencies, run on PlanetLab nodes distributed across the US (CT, TX, CA)</p>
    <p>Proof-of-concept - Unoptimized crypto library</p>
    <p>- One single-threaded worker per agency</p>
    <p>https://github.com/DeDiS/Surveillance</p>
  </div>
  <div class="page">
    <p>Evaluation of Implementation</p>
    <p>Running time increases linearly with size of data sets</p>
    <p>Roughly 130-150 milliseconds per item of metadata</p>
    <p>High Country Bandits example with 50,000 items per set takes just under 2 hours to complete (43 minutes of CPU time per node)</p>
  </div>
  <div class="page">
    <p>Conclusions</p>
    <p>Open surveillance processes can and should be designed to meet law enforcement needs while protecting privacy</p>
    <p>Privacy-protecting surveillance is feasible using existing technology</p>
    <p>Directions for future work: - testing our protocol with optimized, multi-threaded implementation</p>
    <p>- creating privacy-protecting protocols to replace other forms of surveillance</p>
    <p>- testing with general-purpose Secure Multi-party Computation (SMPC) platforms such as FairPlay, Sharemind to automatically compile surveillance queries into privacy-protecting protocols</p>
  </div>
  <div class="page">
    <p>Thank you!</p>
  </div>
</Presentation>
