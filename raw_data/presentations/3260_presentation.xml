<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>WebWitness: Investigating, Categorizing, and Mitigating Malware Download Paths</p>
    <p>Terry Nelms1,2, Roberto Perdici3,2, Manos Antonakakis2, Mustaque Ahamd2,4</p>
    <p>tnelms@damballa.com, perdisci@cs.uga.edu, manos@gatech.edu, mustaq@cc.gatech.edu</p>
  </div>
  <div class="page">
    <p>Web Browser  Popular Infection Vector</p>
    <p>HTTP Protocol</p>
    <p>Webpage Malware Download</p>
    <p>Web browsing</p>
  </div>
  <div class="page">
    <p>How do users get infected?</p>
    <p>HTTP Protocol</p>
    <p>Webpage Malware Download</p>
    <p>Web browsing</p>
    <p>Drive-by Download</p>
  </div>
  <div class="page">
    <p>How do users get infected?</p>
    <p>HTTP Protocol</p>
    <p>Webpage Malware Download</p>
    <p>Web browsing</p>
    <p>Social Engineering</p>
  </div>
  <div class="page">
    <p>What happened before the download?</p>
  </div>
  <div class="page">
    <p>What happened before the download?</p>
  </div>
  <div class="page">
    <p>What happened before the download?</p>
    <p>Landing Search Engine</p>
    <p>Injec5on</p>
    <p>Exploit Drive-by Download</p>
  </div>
  <div class="page">
    <p>Our Work</p>
    <p>! Automatically provide context to attacks. ! Reconstruct download path. ! Identify download cause.</p>
    <p>! Understand current attack trends.</p>
    <p>! Develop more effective defenses.</p>
  </div>
  <div class="page">
    <p>How hard is it to find the download path?</p>
  </div>
  <div class="page">
    <p>Web Traffic Graph</p>
    <p>Single users HTTP requests 5 minutes prior to malware download.</p>
  </div>
  <div class="page">
    <p>Annotated Drive-by Download Path</p>
    <p>wiy1ob.valen:nesdaymodel.biz</p>
    <p>wiy1ob.valen:nesdaymodel.biz</p>
    <p>wiy1ob.valen:nesdaymodel.biz</p>
    <p>manualaddi:on.com</p>
    <p>www.nashville.com</p>
    <p>search.yahoo.com</p>
    <p>Drive-by Download</p>
    <p>Landing Node</p>
    <p>Exploit Node</p>
    <p>Injec:on Node</p>
    <p>Malware Node</p>
  </div>
  <div class="page">
    <p>Drive-by Download Defense</p>
    <p>wiy1ob.valen:nesdaymodel.biz</p>
    <p>wiy1ob.valen:nesdaymodel.biz</p>
    <p>wiy1ob.valen:nesdaymodel.biz</p>
    <p>manualaddi:on.com</p>
    <p>www.nashville.com</p>
    <p>search.yahoo.com Landing Node</p>
    <p>Exploit Node</p>
    <p>Injec:on Node</p>
    <p>Malware Node</p>
    <p>Most defenses focus on the exploit and malware download.</p>
  </div>
  <div class="page">
    <p>Drive-by Download Defense</p>
    <p>wiy1ob.valen:nesdaymodel.biz</p>
    <p>wiy1ob.valen:nesdaymodel.biz</p>
    <p>wiy1ob.valen:nesdaymodel.biz</p>
    <p>manualaddi:on.com</p>
    <p>www.nashville.com</p>
    <p>search.yahoo.com Landing Node</p>
    <p>Exploit Node</p>
    <p>Injec:on Node</p>
    <p>Malware Node</p>
    <p>Focus defenses where the aGack starts.</p>
  </div>
  <div class="page">
    <p>In-The-Wild Malware Study</p>
    <p>! Collection agent deployed on large academic network for a period of six months.</p>
    <p>! A total of 533 malware downloads due to drive-by, social engineering and update.</p>
    <p>! Extensive manual analysis of malicious downloads. ! Reverse engineer content. ! Deobfuscate java script.</p>
  </div>
  <div class="page">
    <p>In-The-Wild Malware Study Results</p>
    <p>! Download path trace back is difficult. ! Cannot only rely on Referrer and Location headers.</p>
    <p>! Labeling the role of nodes extremely challenging. ! Semantic gap between network and browser.</p>
  </div>
  <div class="page">
    <p>WebWitness System</p>
    <p>Download Path Traceback</p>
    <p>Malware Download Defenses</p>
    <p>Download Cause Classifier</p>
    <p>AUack Countermeasures</p>
    <p>Live Network Traffic</p>
    <p>WebWitness</p>
    <p>Annotated Download Paths</p>
  </div>
  <div class="page">
    <p>WebWitness System</p>
    <p>Download Path Traceback</p>
    <p>Malware Download Defenses</p>
    <p>Download Cause Classifier</p>
    <p>AUack Countermeasures</p>
    <p>Live Network Traffic</p>
    <p>WebWitness</p>
    <p>Annotated Download Paths</p>
  </div>
  <div class="page">
    <p>WebWitness System</p>
    <p>Download Path Traceback</p>
    <p>Malware Download Defenses</p>
    <p>Download Cause Classifier</p>
    <p>AUack Countermeasures</p>
    <p>Live Network Traffic</p>
    <p>WebWitness</p>
    <p>Annotated Download Paths</p>
  </div>
  <div class="page">
    <p>Web Traffic Graph</p>
    <p>Single users HTTP requests 5 minutes prior to malware download.</p>
  </div>
  <div class="page">
    <p>Referrer &amp; Location Header Only</p>
    <p>Drive-by Social Eng. 0% 53%</p>
  </div>
  <div class="page">
    <p>Web Graph Source-of Relationships</p>
    <p>Drive-by</p>
    <p>Social Eng.</p>
  </div>
  <div class="page">
    <p>Web Graph Source-of Relationships</p>
    <p>Drive-by</p>
    <p>Social Eng.</p>
  </div>
  <div class="page">
    <p>Improvement using all source-of features</p>
    <p>Drive-by Social Eng. 0% - &gt; 96% 53% - &gt; 95%</p>
  </div>
  <div class="page">
    <p>Download Path Traceback</p>
  </div>
  <div class="page">
    <p>WebWitness System</p>
    <p>Download Path Traceback</p>
    <p>Malware Download Defenses</p>
    <p>Download Cause Classifier</p>
    <p>AUack Countermeasures</p>
    <p>Live Network Traffic</p>
    <p>WebWitness</p>
    <p>Annotated Download Paths</p>
  </div>
  <div class="page">
    <p>Download Paths</p>
  </div>
  <div class="page">
    <p>Download Path Classification</p>
    <p>Drive-by Download Social Engineering Update</p>
  </div>
  <div class="page">
    <p>Cause Classifier Features</p>
    <p>! Candidate Exploit Domain Age. ! Drive-by URL Similarity. ! Download Domain Recurrence. ! Download Referrer. ! Download Path Length. ! User-Agent Popularity.</p>
  </div>
  <div class="page">
    <p>Candidate Exploit Domain Age</p>
    <p>Commonly Exploitable Content  Java  Flash  PDF</p>
    <p>Domain Age  First resolved  Exploit median age 0-days</p>
  </div>
  <div class="page">
    <p>WebWitness System</p>
    <p>Download Path Traceback</p>
    <p>Malware Download Defenses</p>
    <p>Download Cause Classifier</p>
    <p>AUack Countermeasures</p>
    <p>Live Network Traffic</p>
    <p>WebWitness</p>
    <p>Annotated Download Paths</p>
  </div>
  <div class="page">
    <p>Annotated Social Engineering Path</p>
    <p>:nyimage.tk</p>
    <p>ge.G</p>
    <p>w708688.open.ge.G</p>
    <p>s3.kkloud.com.s3.amazonaws.com</p>
    <p>www.omegle.com</p>
    <p>Social Engineering</p>
  </div>
  <div class="page">
    <p>Annotated Social Engineering Path</p>
    <p>:nyimage.tk</p>
    <p>ge.G</p>
    <p>w708688.open.ge.G</p>
    <p>s3.kkloud.com.s3.amazonaws.com</p>
    <p>www.omegle.com</p>
    <p>everyone at school says im ugly behind my back and my whole family wants me to change how i look...give me your honest opinions?? hGp://:nyimage.tk?/image/IMG_0210.jpg</p>
  </div>
  <div class="page">
    <p>Annotated Social Engineering Path</p>
    <p>:nyimage.tk</p>
    <p>ge.G</p>
    <p>w708688.open.ge.G</p>
    <p>s3.kkloud.com.s3.amazonaws.com</p>
    <p>www.omegle.com</p>
    <p>HTML page containing a frame loaded from IP address 173.88.75.20</p>
  </div>
  <div class="page">
    <p>Annotated Social Engineering Path</p>
    <p>:nyimage.tk</p>
    <p>ge.G</p>
    <p>w708688.open.ge.G</p>
    <p>s3.kkloud.com.s3.amazonaws.com</p>
    <p>www.omegle.com</p>
    <p>Redirect to a URL on ge.G, a free filesharing site.</p>
  </div>
  <div class="page">
    <p>Annotated Social Engineering Path</p>
    <p>:nyimage.tk</p>
    <p>ge.G</p>
    <p>w708688.open.ge.G</p>
    <p>s3.kkloud.com.s3.amazonaws.com</p>
    <p>www.omegle.com</p>
    <p>Temporary redirect to a different ge.G URL.</p>
  </div>
  <div class="page">
    <p>Annotated Social Engineering Path</p>
    <p>:nyimage.tk</p>
    <p>ge.G</p>
    <p>w708688.open.ge.G</p>
    <p>s3.kkloud.com.s3.amazonaws.com</p>
    <p>www.omegle.com</p>
    <p>Redirect Amazon Web Services URL where ge.U is hos5ng the file.</p>
  </div>
  <div class="page">
    <p>Annotated Social Engineering Path</p>
    <p>:nyimage.tk</p>
    <p>ge.G</p>
    <p>w708688.open.ge.G</p>
    <p>s3.kkloud.com.s3.amazonaws.com</p>
    <p>www.omegle.com</p>
    <p>Malware download later detected as Trojan by several an5-virus scanners.</p>
  </div>
  <div class="page">
    <p>Annotated Drive-by Download Path</p>
    <p>wiy1ob.valen:nesdaymodel.biz</p>
    <p>wiy1ob.valen:nesdaymodel.biz</p>
    <p>wiy1ob.valen:nesdaymodel.biz</p>
    <p>manualaddi:on.com</p>
    <p>www.nashville.com</p>
    <p>search.yahoo.com</p>
    <p>Drive-by Download</p>
  </div>
  <div class="page">
    <p>Annotated Drive-by Download Path</p>
    <p>wiy1ob.valen:nesdaymodel.biz</p>
    <p>wiy1ob.valen:nesdaymodel.biz</p>
    <p>wiy1ob.valen:nesdaymodel.biz</p>
    <p>manualaddi:on.com</p>
    <p>www.nashville.com</p>
    <p>search.yahoo.com Search Query: nashville music producer news. Top result www.nashville.com.</p>
  </div>
  <div class="page">
    <p>Annotated Drive-by Download Path</p>
    <p>wiy1ob.valen:nesdaymodel.biz</p>
    <p>wiy1ob.valen:nesdaymodel.biz</p>
    <p>wiy1ob.valen:nesdaymodel.biz</p>
    <p>manualaddi:on.com</p>
    <p>www.nashville.com</p>
    <p>search.yahoo.com Landing page is a hacked website that contains an iframe that points to manualaddi:on.com.</p>
  </div>
  <div class="page">
    <p>Annotated Drive-by Download Path</p>
    <p>wiy1ob.valen:nesdaymodel.biz</p>
    <p>wiy1ob.valen:nesdaymodel.biz</p>
    <p>wiy1ob.valen:nesdaymodel.biz</p>
    <p>manualaddi:on.com</p>
    <p>www.nashville.com</p>
    <p>search.yahoo.com Injec:on page that redirects to an exploit kit hosted on valen:nesdaymodel.biz.</p>
  </div>
  <div class="page">
    <p>Annotated Drive-by Download Path</p>
    <p>wiy1ob.valen:nesdaymodel.biz</p>
    <p>wiy1ob.valen:nesdaymodel.biz</p>
    <p>wiy1ob.valen:nesdaymodel.biz</p>
    <p>manualaddi:on.com</p>
    <p>www.nashville.com</p>
    <p>search.yahoo.com Vulnerability probe that checks sohware versions on the clients machine so they can be mapped to an exploit.</p>
  </div>
  <div class="page">
    <p>Annotated Drive-by Download Path</p>
    <p>wiy1ob.valen:nesdaymodel.biz</p>
    <p>wiy1ob.valen:nesdaymodel.biz</p>
    <p>wiy1ob.valen:nesdaymodel.biz</p>
    <p>manualaddi:on.com</p>
    <p>www.nashville.com</p>
    <p>search.yahoo.com Exploit page delivers a malicious JAR file to exploit a vulnerable version of Java running on the clients machine.</p>
  </div>
  <div class="page">
    <p>Annotated Drive-by Download Path</p>
    <p>wiy1ob.valen:nesdaymodel.biz</p>
    <p>wiy1ob.valen:nesdaymodel.biz</p>
    <p>wiy1ob.valen:nesdaymodel.biz</p>
    <p>manualaddi:on.com</p>
    <p>www.nashville.com</p>
    <p>search.yahoo.com Malware download later detected as Trojan Downloader by several AV scanners.</p>
  </div>
  <div class="page">
    <p>WebWitness System</p>
    <p>Download Path Traceback</p>
    <p>Malware Download Defenses</p>
    <p>Download Cause Classifier</p>
    <p>AUack Countermeasures</p>
    <p>Live Network Traffic</p>
    <p>WebWitness</p>
    <p>Annotated Download Paths</p>
  </div>
  <div class="page">
    <p>Drive-by Download Defense</p>
    <p>wiy1ob.valen:nesdaymodel.biz</p>
    <p>wiy1ob.valen:nesdaymodel.biz</p>
    <p>wiy1ob.valen:nesdaymodel.biz</p>
    <p>manualaddi:on.com</p>
    <p>www.nashville.com</p>
    <p>search.yahoo.com</p>
    <p>Exploit Node</p>
    <p>Malware Node</p>
    <p>Most defenses focus on the exploit and malware download.</p>
  </div>
  <div class="page">
    <p>wiy1ob.valen:nesdaymodel.biz</p>
    <p>wiy1ob.valen:nesdaymodel.biz</p>
    <p>wiy1ob.valen:nesdaymodel.biz</p>
    <p>manualaddi:on.com</p>
    <p>www.nashville.com</p>
    <p>search.yahoo.com</p>
    <p>Injec:on Node</p>
    <p>Drive-by Download Defense</p>
    <p>Automa5cally find the injec:on node.</p>
  </div>
  <div class="page">
    <p>wiy1ob.valen:nesdaymodel.biz</p>
    <p>wiy1ob.valen:nesdaymodel.biz</p>
    <p>wiy1ob.valen:nesdaymodel.biz</p>
    <p>manualaddi:on.com</p>
    <p>www.nashville.com</p>
    <p>search.yahoo.com Landing Node</p>
    <p>Exploit Node</p>
    <p>Injec:on Node</p>
    <p>Drive-by Download Defense</p>
    <p>Locate exploit, landing then injec5on</p>
  </div>
  <div class="page">
    <p>Node Classification Features</p>
    <p>! Exploit ! Hops to download page. ! Commonly exploitable content. ! Domain age. ! Same domain.</p>
    <p>! Landing ! Hops to exploit page. ! Domain age. ! Same domain.</p>
    <p>! Injection ! On path. ! Advertisement. ! Domain age. ! Successors. ! Same domain.</p>
    <p>Exploit</p>
    <p>Landing</p>
    <p>Injec5on Annotated Download Paths</p>
  </div>
  <div class="page">
    <p>WebWitness System</p>
    <p>Download Path Traceback</p>
    <p>Malware Download Defenses</p>
    <p>Download Cause Classifier</p>
    <p>AUack Countermeasures</p>
    <p>Live Network Traffic</p>
    <p>WebWitness</p>
    <p>Annotated Download Paths</p>
  </div>
  <div class="page">
    <p>Block Injection Domain</p>
    <p>wiy1ob.valen:nesdaymodel.biz</p>
    <p>wiy1ob.valen:nesdaymodel.biz</p>
    <p>wiy1ob.valen:nesdaymodel.biz</p>
    <p>manualaddi:on.com</p>
    <p>www.nashville.com</p>
    <p>search.yahoo.com</p>
    <p>Drive-by Download</p>
    <p>Injec:on Node 51</p>
  </div>
  <div class="page">
    <p>Saved Victims  Blocking Injection Domain</p>
    <p>Po te</p>
    <p>n ti</p>
    <p>al V</p>
    <p>ic ti</p>
    <p>m s</p>
    <p>Day</p>
    <p>Injection Exploit/Download</p>
  </div>
  <div class="page">
    <p>Saved Victims  Blocking Injection Domain</p>
    <p>Po te</p>
    <p>n ti</p>
    <p>al V</p>
    <p>ic ti</p>
    <p>m s</p>
    <p>Day</p>
    <p>Injection Exploit/Download</p>
  </div>
  <div class="page">
    <p>Conclusion</p>
    <p>Download Path Traceback</p>
    <p>Malware Download Defenses</p>
    <p>Download Cause Classifier</p>
    <p>AUack Countermeasures</p>
    <p>Live Network Traffic</p>
    <p>WebWitness</p>
    <p>Annotated Download Paths</p>
  </div>
  <div class="page">
    <p>Web Traffic Graph</p>
    <p>Single users HTTP requests 5 minutes prior to malware download.</p>
  </div>
  <div class="page">
    <p>Annotated Drive-by Download Path</p>
    <p>wiy1ob.valen:nesdaymodel.biz</p>
    <p>wiy1ob.valen:nesdaymodel.biz</p>
    <p>wiy1ob.valen:nesdaymodel.biz</p>
    <p>manualaddi:on.com</p>
    <p>www.nashville.com</p>
    <p>search.yahoo.com Landing Node</p>
    <p>Exploit Node</p>
    <p>Injec:on Node</p>
    <p>Malware Node</p>
  </div>
  <div class="page">
    <p>Drive-by Download Defense</p>
    <p>wiy1ob.valen:nesdaymodel.biz</p>
    <p>wiy1ob.valen:nesdaymodel.biz</p>
    <p>wiy1ob.valen:nesdaymodel.biz</p>
    <p>manualaddi:on.com</p>
    <p>www.nashville.com</p>
    <p>search.yahoo.com Landing Node</p>
    <p>Exploit Node</p>
    <p>Injec:on Node Malware Node</p>
  </div>
  <div class="page">
    <p>Questions?</p>
    <p>WebWitness: Investigating, Categorizing, and Mitigating Malware Download Paths</p>
    <p>Terry Nelms1,2, Roberto Perdici3,2, Manos Antonakakis2, Mustaque Ahamd2,4</p>
    <p>tnelms@damballa.com, perdisci@cs.uga.edu, manos@gatech.edu, mustaq@cc.gatech.edu 58</p>
  </div>
</Presentation>
