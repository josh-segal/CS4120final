<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Deepayan Chakraba rti</p>
    <p>CIKM 2002 1</p>
    <p>F4: Large Scale Automated Forecasting Using Fractals</p>
    <p>-Deepayan Chakrabarti -Christos Faloutsos</p>
  </div>
  <div class="page">
    <p>CIKM 2002 2</p>
    <p>Outline  Introduction/Motivation  Survey and Lag Plots  Exact Problem Formulation  Proposed Method</p>
    <p>Fractal Dimensions Background  Our method</p>
    <p>Results  Conclusions</p>
  </div>
  <div class="page">
    <p>CIKM 2002 3</p>
    <p>General Problem Definition</p>
    <p>Given a time series {xt}, predict its future course, that is, xt+1, xt+2, ...</p>
    <p>Time</p>
    <p>Value ?</p>
  </div>
  <div class="page">
    <p>CIKM 2002 4</p>
    <p>Motivation</p>
    <p>Financial data analysis</p>
    <p>Physiological data, elderly care</p>
    <p>Weather, environmental studies</p>
    <p>Traditional fields</p>
    <p>Sensor Networks (MEMS, SmartDust)  Long / infinite series</p>
    <p>No human intervention  black box</p>
  </div>
  <div class="page">
    <p>CIKM 2002 5</p>
    <p>Outline</p>
    <p>Introduction/Motivation  Survey and Lag Plots  Exact Problem Formulation  Proposed Method</p>
    <p>Fractal Dimensions Background  Our method</p>
    <p>Results  Conclusions</p>
  </div>
  <div class="page">
    <p>CIKM 2002 6</p>
    <p>How to forecast?</p>
    <p>ARIMA  but linearity assumption  Neural Networks  but large number</p>
    <p>of parameters and long training times [Wan/1993, Mozer/1993]</p>
    <p>Hidden Markov Models  O(N2) in number of nodes N; also fixing N is a problem [Ge+/2000]</p>
    <p>Lag Plots</p>
  </div>
  <div class="page">
    <p>CIKM 2002 7</p>
    <p>Lag Plots</p>
    <p>xt-1</p>
    <p>xxtt</p>
    <p>Interpolate these</p>
    <p>To get the final prediction</p>
    <p>Q0: Interpolation Method</p>
    <p>Q1: Lag = ?</p>
    <p>Q2: K = ?</p>
  </div>
  <div class="page">
    <p>CIKM 2002 8</p>
    <p>Q0: Interpolation</p>
    <p>Using SVD (state of the art) [Sauer/1993]</p>
    <p>Xt-1</p>
    <p>xt</p>
  </div>
  <div class="page">
    <p>CIKM 2002 9</p>
    <p>Why Lag Plots?</p>
    <p>Based on the Takens Theorem [Takens/1981]</p>
    <p>which says that delay vectors can be used for predictive purposes</p>
  </div>
  <div class="page">
    <p>CIKM 2002 10</p>
    <p>Inside Theory Example: Lotka-Volterra equations</p>
    <p>H/t = rH  aH*P P/t = bH*P  mP</p>
    <p>H is density of prey P is density of predators</p>
    <p>Suppose only H(t) is observed. Internal state is (H,P).</p>
    <p>Extra</p>
  </div>
  <div class="page">
    <p>CIKM 2002 11</p>
    <p>Outline</p>
    <p>Introduction/Motivation  Survey and Lag Plots  Exact Problem Formulation  Proposed Method</p>
    <p>Fractal Dimensions Background  Our method</p>
    <p>Results  Conclusions</p>
  </div>
  <div class="page">
    <p>CIKM 2002 12</p>
    <p>Problem at hand</p>
    <p>Given {x1, x2, , xN}  Automatically set parameters</p>
    <p>- L(opt) (from Q1) - k(opt) (from Q2)</p>
    <p>in Linear time on N  to minimise Normalized Mean</p>
    <p>Squared Error (NMSE) of forecasting</p>
  </div>
  <div class="page">
    <p>CIKM 2002 13</p>
    <p>Previous work/Alternatives</p>
    <p>Manual Setting : BUT infeasible [Sauer/1992]</p>
    <p>CrossValidation : BUT Slow; leaveone-out crossvalidation ~ O(N2logN) or more</p>
    <p>False Nearest Neighbors : BUT Unstable [Abarbanel/1996]</p>
  </div>
  <div class="page">
    <p>CIKM 2002 14</p>
    <p>Outline</p>
    <p>Introduction/Motivation  Survey and Lag Plots  Exact Problem Formulation  Proposed Method</p>
    <p>Fractal Dimensions Background  Our method</p>
    <p>Results  Conclusions</p>
  </div>
  <div class="page">
    <p>CIKM 2002 15</p>
    <p>Intuition</p>
    <p>X(t-1)</p>
    <p>X (t</p>
    <p>)</p>
    <p>The Logistic Parabola xt = axt-1(1-xt-1) + noise</p>
    <p>time</p>
    <p>x (t</p>
    <p>) Intrinsic Dimensionality</p>
    <p>Degrees of Freedom</p>
    <p>Information about Xt given Xt-1</p>
  </div>
  <div class="page">
    <p>CIKM 2002 16</p>
    <p>Intuition</p>
    <p>x(t -1)</p>
    <p>x(t)</p>
    <p>x(t-2)</p>
    <p>x(t)</p>
    <p>x(t)</p>
    <p>x(t-2)</p>
    <p>x(t-2) x(t -1)</p>
    <p>x(t -1)</p>
    <p>x(t-1)</p>
    <p>x(t)</p>
  </div>
  <div class="page">
    <p>CIKM 2002 17</p>
    <p>Intuition</p>
    <p>To find L(opt):  Go further back in time (ie., consider</p>
    <p>Xt-2, Xt-3 and so on)  Till there is no more information</p>
    <p>gained about Xt</p>
  </div>
  <div class="page">
    <p>CIKM 2002 18</p>
    <p>Outline</p>
    <p>Introduction/Motivation  Survey and Lag Plots  Exact Problem Formulation  Proposed Method</p>
    <p>Fractal Dimensions Background  Our method</p>
    <p>Results  Conclusions</p>
  </div>
  <div class="page">
    <p>CIKM 2002 19</p>
    <p>Fractal Dimensions  FD = intrinsic dimensionality</p>
    <p>Embedding dimensionality = 3</p>
    <p>Intrinsic dimensionality = 1</p>
  </div>
  <div class="page">
    <p>CIKM 2002 20</p>
    <p>Fractal Dimensions</p>
    <p>FD = intrinsic dimensionality [Belussi/1995]</p>
    <p>log(r)</p>
    <p>log( # pairs)</p>
    <p>Points to note:</p>
    <p>FD can be a noninteger</p>
    <p>There are fast methods to compute it</p>
  </div>
  <div class="page">
    <p>CIKM 2002 21</p>
    <p>Outline</p>
    <p>Introduction/Motivation  Survey and Lag Plots  Exact Problem Formulation  Proposed Method</p>
    <p>Fractal Dimensions Background  Our method</p>
    <p>Results  Conclusions</p>
  </div>
  <div class="page">
    <p>CIKM 2002 22</p>
    <p>Q1: Finding L(opt)</p>
    <p>Use Fractal Dimensions to find the optimal lag length L(opt)</p>
    <p>Lag (L)</p>
    <p>F ra</p>
    <p>ct al</p>
    <p>D im</p>
    <p>en si</p>
    <p>o n</p>
    <p>epsilon</p>
    <p>L(opt)</p>
    <p>f</p>
  </div>
  <div class="page">
    <p>CIKM 2002 23</p>
    <p>Q2: Finding k(opt)</p>
    <p>To find k(opt)</p>
    <p>Conjecture: k(opt) ~ O(f)</p>
    <p>We choose k(opt) = 2*f + 1</p>
  </div>
  <div class="page">
    <p>CIKM 2002 24</p>
    <p>Outline</p>
    <p>Introduction/Motivation  Survey and Lag Plots  Exact Problem Formulation  Proposed Method</p>
    <p>Fractal Dimensions Background  Our method</p>
    <p>Results  Conclusions</p>
  </div>
  <div class="page">
    <p>CIKM 2002 25</p>
    <p>Datasets  Logistic Parabola:</p>
    <p>xt = axt-1(1-xt-1) + noise Models population of flies [R. May/1976]</p>
    <p>Time</p>
    <p>Value</p>
  </div>
  <div class="page">
    <p>CIKM 2002 26</p>
    <p>Datasets  Logistic Parabola:</p>
    <p>xt = axt-1(1-xt-1) + noise Models population of flies [R. May/1976]</p>
    <p>LORENZ: Models convection currents in the air</p>
    <p>Time</p>
    <p>Value</p>
  </div>
  <div class="page">
    <p>CIKM 2002 27</p>
    <p>Datasets</p>
    <p>Error NMSE = (predicted-true)2/2</p>
    <p>Logistic Parabola: xt = axt-1(1-xt-1) + noise Models population of flies [R. May/1976]</p>
    <p>LORENZ: Models convection currents in the air</p>
    <p>LASER: fluctuations in a Laser over time (from the Santa Fe Time Series Competition, 1992)</p>
    <p>Time</p>
    <p>Value</p>
  </div>
  <div class="page">
    <p>CIKM 2002 28</p>
    <p>Logistic Parabola</p>
    <p>FD vs L plot flattens out</p>
    <p>L(opt) = 1</p>
    <p>Timesteps</p>
    <p>Value</p>
    <p>Lag</p>
    <p>FD</p>
  </div>
  <div class="page">
    <p>CIKM 2002 29</p>
    <p>Logistic Parabola</p>
    <p>Timesteps</p>
    <p>Value</p>
    <p>Our Prediction from here</p>
  </div>
  <div class="page">
    <p>CIKM 2002 30</p>
    <p>Logistic Parabola</p>
    <p>Timesteps</p>
    <p>Value</p>
    <p>Comparison of prediction to correct values</p>
  </div>
  <div class="page">
    <p>CIKM 2002 31</p>
    <p>Logistic Parabola</p>
    <p>Our L(opt) = 1, which exactly minimizes NMSE</p>
    <p>Lag</p>
    <p>N M</p>
    <p>S E</p>
    <p>FD</p>
  </div>
  <div class="page">
    <p>CIKM 2002 32</p>
    <p>LORENZ</p>
    <p>L(opt) = 5</p>
    <p>Timesteps</p>
    <p>Value</p>
    <p>Lag</p>
    <p>FD</p>
  </div>
  <div class="page">
    <p>CIKM 2002 33</p>
    <p>LORENZ</p>
    <p>Value</p>
    <p>Timesteps</p>
    <p>Our Prediction from here</p>
  </div>
  <div class="page">
    <p>CIKM 2002 34</p>
    <p>LORENZ</p>
    <p>Timesteps</p>
    <p>Value</p>
    <p>Comparison of prediction to correct values</p>
  </div>
  <div class="page">
    <p>CIKM 2002 35</p>
    <p>LORENZ</p>
    <p>L(opt) = 5</p>
    <p>Also NMSE is optimal at Lag = 5</p>
    <p>Lag</p>
    <p>N M</p>
    <p>S E</p>
    <p>FD</p>
  </div>
  <div class="page">
    <p>CIKM 2002 36</p>
    <p>Laser</p>
    <p>L(opt) = 7</p>
    <p>Timesteps</p>
    <p>Value</p>
    <p>Lag</p>
    <p>FD</p>
  </div>
  <div class="page">
    <p>CIKM 2002 37</p>
    <p>Laser</p>
    <p>Timesteps</p>
    <p>Value</p>
    <p>Our Prediction starts here</p>
  </div>
  <div class="page">
    <p>CIKM 2002 38</p>
    <p>Laser</p>
    <p>Timesteps</p>
    <p>Value</p>
    <p>Comparison of prediction to correct values</p>
  </div>
  <div class="page">
    <p>CIKM 2002 39</p>
    <p>Laser</p>
    <p>L(opt) = 7</p>
    <p>Corresponding NMSE is close to optimal</p>
    <p>Lag</p>
    <p>N M</p>
    <p>S E</p>
    <p>FD</p>
  </div>
  <div class="page">
    <p>CIKM 2002 40</p>
    <p>Speed and Scalability  Preprocessin</p>
    <p>g is linear in N</p>
    <p>Proportional to time taken to calculate FD</p>
  </div>
  <div class="page">
    <p>CIKM 2002 41</p>
    <p>Outline</p>
    <p>Introduction/Motivation  Survey and Lag Plots  Exact Problem Formulation  Proposed Method</p>
    <p>Fractal Dimensions Background  Our method</p>
    <p>Results  Conclusions</p>
  </div>
  <div class="page">
    <p>CIKM 2002 42</p>
    <p>Conclusions</p>
    <p>Our Method:</p>
    <p>Automatically set parameters</p>
    <p>L(opt) (answers Q1)</p>
    <p>k(opt) (answers Q2)</p>
    <p>In linear time on N</p>
  </div>
  <div class="page">
    <p>CIKM 2002 43</p>
    <p>Conclusions</p>
    <p>Black-box non-linear time series forecasting</p>
    <p>Fractal Dimensions give a fast, automated method to set all parameters</p>
    <p>So, given any time series, we can automatically build a prediction system</p>
    <p>Useful in a sensor network setting</p>
  </div>
  <div class="page">
    <p>CIKM 2002 44</p>
    <p>Snapshot http://snapdragon.cald.cs.cmu.edu/TSP</p>
    <p>Extra</p>
  </div>
  <div class="page">
    <p>CIKM 2002 45</p>
    <p>Future Work</p>
    <p>Feature Selection  Multi-sequence prediction</p>
    <p>Extra</p>
  </div>
  <div class="page">
    <p>CIKM 2002 46</p>
    <p>Discussion  Some other problems How to forecast?</p>
    <p>x1, x2, , xN</p>
    <p>L(opt)</p>
    <p>k(opt) How to find the k(opt) nearest neighbors quickly?</p>
    <p>Given:</p>
    <p>Extra</p>
  </div>
  <div class="page">
    <p>CIKM 2002 47</p>
    <p>Motivation</p>
    <p>Forecasting also allows us to</p>
    <p>Find outliers  anything that doesnt match our prediction!</p>
    <p>Find patterns  if different circumstances lead to similar predictions, they may be related.</p>
    <p>Extra</p>
  </div>
  <div class="page">
    <p>CIKM 2002 48</p>
    <p>Motivation (Examples)</p>
    <p>EEGs : Patterns of electromagnetic impulses in the brain</p>
    <p>Intensity variations of white dwarf stars</p>
    <p>Highway usage over time</p>
    <p>Traditional</p>
    <p>Sensors  Active Disks for forecasting / prefetching / buffering</p>
    <p>Smart House  sensors monitor situation in a house</p>
    <p>Volcano monitoring</p>
    <p>Extra</p>
  </div>
  <div class="page">
    <p>CIKM 2002 49</p>
    <p>General Method</p>
    <p>Store all the delay vectors {x{xt-1t-1, , x, , xt-L(opt)t-L(opt)} }</p>
    <p>and corresponding prediction xand corresponding prediction xtt</p>
    <p>Xt-1</p>
    <p>xt Find the latest delay vector</p>
    <p>L(opt) = ?</p>
    <p>Find nearest neighbors</p>
    <p>K(opt) = ?</p>
    <p>Interpolate  Interpolate</p>
    <p>Extra</p>
  </div>
  <div class="page">
    <p>CIKM 2002 50</p>
    <p>Intuition</p>
    <p>The FD vs L plot does flatten out</p>
    <p>L(opt) = 1</p>
    <p>Lag</p>
    <p>Fractal dimension</p>
    <p>Extra</p>
  </div>
  <div class="page">
    <p>CIKM 2002 51</p>
    <p>Inside Theory</p>
    <p>Internal state may be unobserved  But the delay vector space is a</p>
    <p>faithful reconstruction of the internal system state</p>
    <p>So prediction in delay vector space is as good as prediction in state space</p>
    <p>Extra</p>
  </div>
  <div class="page">
    <p>CIKM 2002 52</p>
    <p>Fractal Dimensions</p>
    <p>Many real-world datasets have fractional intrinsic dimension</p>
    <p>There exist fast (O(N)) methods to calculate the fractal dimension of a cloud of points [Belussi/1995]</p>
    <p>Extra</p>
  </div>
  <div class="page">
    <p>CIKM 2002 53</p>
    <p>Speed and Scalability</p>
    <p>Preprocessin g varies as L(opt)2</p>
    <p>Extra</p>
  </div>
</Presentation>
