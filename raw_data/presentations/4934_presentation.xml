<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>2008 Andreas Haeberlen, MPI-SWS 1</p>
    <p>Pretty Good Packet Authentication</p>
    <p>Andreas Haeberlen MPI-SWS / Rice</p>
    <p>University</p>
    <p>Rodrigo Rodrigues MPI-SWS</p>
    <p>Peter Druschel MPI-SWS</p>
    <p>Krishna Gummadi MPI-SWS</p>
  </div>
  <div class="page">
    <p>Packet authentication</p>
    <p>Internet packets cannot be authenticated  Example: Alice receives P, source address X</p>
    <p>Can Alice be sure that P was sent by the host with address X? (no, addresses can be spoofed!)</p>
    <p>Can Alice convince a third party that P was sent by this host? (no, packets can be forged!)</p>
    <p>Alice Bob</p>
    <p>Foo.ne t</p>
    <p>Foo.ne t</p>
    <p>Bar.netBar.net</p>
    <p>Internet</p>
    <p>Assigns IP address X</p>
    <p>Packet P (source address X)</p>
    <p>Admin</p>
  </div>
  <div class="page">
    <p>The Internet needs packet authentication</p>
    <p>The lack of packet authentication is causing a variety of problems, e.g.:</p>
    <p>Bypassing spam blacklists [SIGCOMM'06]</p>
    <p>Eve</p>
    <p>Bar.netBar.net</p>
    <p>Foo.ne t</p>
    <p>Foo.ne t</p>
    <p>Innoce nt.net</p>
    <p>Innoce nt.net</p>
    <p>Mail server</p>
    <p>No more mail from bar.net!</p>
    <p>Innocent.net</p>
    <p>Internet</p>
  </div>
  <div class="page">
    <p>The Internet needs packet authentication</p>
    <p>The lack of packet authentication is causing a variety of problems, e.g.:</p>
    <p>Bypassing spam blacklists [SIGCOMM'06]  False accusations [HotSec'08]</p>
    <p>Alice</p>
    <p>Eve</p>
    <p>Bar.netBar.net</p>
    <p>Foo.ne t</p>
    <p>Foo.ne t</p>
    <p>Innoce nt.net</p>
    <p>Innoce nt.net</p>
    <p>Tracker</p>
    <p>&quot;Hi, I am Alice&quot;</p>
  </div>
  <div class="page">
    <p>The Internet needs packet authentication</p>
    <p>The lack of packet authentication is causing a variety of problems, e.g.:</p>
    <p>Bypassing spam blacklists [SIGCOMM'06]  False accusations [HotSec'08]  Unverifiable complaints, plausible deniability</p>
    <p>Can we add authentication to the Internet?</p>
    <p>Alice Eve</p>
    <p>Bar.netBar.net Foo.ne</p>
    <p>t Foo.ne</p>
    <p>t</p>
    <p>Admin &quot;Alice has been portscanning me!&quot;?!?</p>
  </div>
  <div class="page">
    <p>Which properties do we want?</p>
    <p>There is a spectrum of possible solutions  Strength vs. other goals (such as privacy)  Strength vs. feasibility/practicability</p>
    <p>Can we find a good compromise?</p>
    <p>S tr</p>
    <p>o n</p>
    <p>g</p>
    <p>W e a k</p>
    <p>Internet today</p>
    <p>More ingress filtering</p>
    <p>Clean-slate designs</p>
    <p>(e.g. AIP)</p>
    <p>Crypto+ biometrics</p>
    <p>Brain scannerPGPA</p>
    <p>IP traceback</p>
    <p>Infeasible / too strongDeployment path?</p>
  </div>
  <div class="page">
    <p>Proposed solution: PGPA</p>
    <p>We propose Pretty Good Packet Authentication</p>
    <p>PGPA provides the following capability:Given a packet, a source address and timestamp, the ISP that owns the source address can verify whether the packet was sent at approximately that time</p>
    <p>Alice</p>
    <p>Bob</p>
    <p>Foo.ne t</p>
    <p>Foo.ne t</p>
    <p>Bar.netBar.net</p>
    <p>Internet</p>
    <p>Address X assigned here</p>
    <p>Packet (source address X)</p>
    <p>Judy</p>
    <p>Has X sent at 4:11pm</p>
    <p>today?</p>
    <p>YesHas X sent at 4:11pm</p>
    <p>today?</p>
  </div>
  <div class="page">
    <p>Privacy and anonymity</p>
    <p>PGPA protects users' privacy  To ask a question about a packet, the requester must</p>
    <p>already know the entire packet</p>
    <p>PGPA is compatible with anonymity  Standard techniques (such as onion routing) can</p>
    <p>still be applied</p>
    <p>Given a packet, a source address and timestamp, the ISP that owns the source address can verify whether the packet was sent at approximately that time</p>
    <p>Given a packet, a source address and timestamp, the ISP that owns the source address can verify whether the packet was sent at approximately that time</p>
    <p>Given a packet, a source address and timestamp, the ISP that owns the source address can verify whether the packet was sent at approximately that time</p>
  </div>
  <div class="page">
    <p>Outline</p>
    <p>Introduction  Pretty Good Packet Authentication</p>
    <p>(PGPA)  How PGPA could be used  A simple implementation  Conclusion</p>
  </div>
  <div class="page">
    <p>How PGPA could be used</p>
    <p>PGPA could be used to solve each of the motivating problems:</p>
    <p>Bypassing spam blacklists</p>
    <p>Eve</p>
    <p>Bar.netBar.net</p>
    <p>Foo.ne t</p>
    <p>Foo.ne t</p>
    <p>Innoce nt.net</p>
    <p>Innoce nt.net</p>
    <p>Mail server</p>
    <p>Innocent.net</p>
    <p>Was this traffic sent from</p>
    <p>Innocent.net?</p>
    <p>No</p>
  </div>
  <div class="page">
    <p>How PGPA could be used</p>
    <p>PGPA could be used to solve each of the motivating problems:</p>
    <p>Bypassing spam blacklists  False accusations</p>
    <p>Alice</p>
    <p>Eve</p>
    <p>Bar.netBar.net</p>
    <p>Foo.ne t</p>
    <p>Foo.ne t</p>
    <p>Innoce nt.net</p>
    <p>Innoce nt.net</p>
    <p>Tracker</p>
    <p>&quot;Hi, I am Alice&quot;</p>
    <p>Was this sent from 1.2.3.4?</p>
    <p>No</p>
  </div>
  <div class="page">
    <p>How PGPA could be used</p>
    <p>PGPA could be used to solve each of the motivating problems:</p>
    <p>Bypassing spam blacklists  False accusations  Unverifiable complaints, plausible deniability</p>
    <p>Alice Eve</p>
    <p>Bar.netBar.net Foo.ne</p>
    <p>t Foo.ne</p>
    <p>t</p>
    <p>Admin &quot;Alice has been portscanning me!&quot; Is that true?</p>
  </div>
  <div class="page">
    <p>PGPA tradeoffs</p>
    <p>Associates packets with addresses, not users  Reveals that packets were sent, but not why  Assumes that ISPs and users do not collude</p>
    <p>Very simple  Effective against real-world problems  Compatible with anonymity  Protects users' privacy  Straightforward implementation  Plausible deployment path</p>
    <p>Limitations:</p>
    <p>Advantages:</p>
    <p>Rest of this talk</p>
  </div>
  <div class="page">
    <p>Outline</p>
    <p>Introduction  Pretty Good Packet Authentication</p>
    <p>(PGPA)  How PGPA could be used  A simple implementation  Conclusion</p>
  </div>
  <div class="page">
    <p>Keeping records of past traffic</p>
    <p>PGPA needs to 'remember' past traffic  A set of traffic monitors keep a record of transmitted packets  Storing (timestamp, hash) per packet is sufficient</p>
    <p>Where should the traffic monitors be placed?  Natural choice: Access link  Backbone is not modified  much easier to deploy</p>
    <p>Access linksAlice</p>
    <p>Bob</p>
    <p>A.netA.net B.netB.net</p>
    <p>Internet</p>
    <p>Charlie</p>
  </div>
  <div class="page">
    <p>Where to place the traffic monitor?</p>
    <p>A.netA.net</p>
    <p>A.netA.net</p>
    <p>A.netA.net</p>
    <p>User's premises:  Inexpensive; good scalability  User can physically destroy the device</p>
    <p>At the ISP:  Easy to deploy  User has to trust the ISP</p>
    <p>Secure channel</p>
    <p>Monitor</p>
    <p>Both:  No trust userISP required  More overhead</p>
    <p>Modem</p>
    <p>Router</p>
  </div>
  <div class="page">
    <p>Calculating digests</p>
    <p>Monitor stores only a digest of each packet  Saves space; preserves privacy if monitor is compromised</p>
    <p>What if packet is transformed in the network?  Examples: TTL, ECN bits, IP fragmentation, header options  Digest must be invariant to transformations [Snoeren02]  Reassemble packet before hashing; zero out certain fields</p>
    <p>Hash: 0x4711Hash: 0xD1FF</p>
    <p>TTL: 63 CONTENT</p>
    <p>TTL: 63 CONTENT</p>
    <p>A.net</p>
  </div>
  <div class="page">
    <p>PGPA preserves users' privacy</p>
    <p>Can PGPA be used to snoop on users' traffic?  Seen earlier: PGPA only confirms specific packets  But what if the attacker tries to guess a packet?  Infeasible - attacker would have to correctly guess the</p>
    <p>transmission time plus TCP seq. no., IPID field, etc. (80 bits)</p>
    <p>What if the monitor is stolen or compromised?  Only reveals digests, not actual packets  Can include a salt in each digest (against dictionary attacks)</p>
    <p>Spy Monitor</p>
    <p>Did you send traffic to cnn.com earlier today?</p>
    <p>Did you send packet X at time t?</p>
    <p>Yes</p>
  </div>
  <div class="page">
    <p>Traffic monitors are feasible</p>
    <p>How much storage does a monitor need?  Example: DSL connection  Assume worst case: 1 Mbps upstream, fully utilized with</p>
    <p>Need 187 GB/month</p>
    <p>Single harddisk per user in the worst case  Likely to hold in the future (storage grows faster than bw)  Many set-top boxes already contain storage</p>
  </div>
  <div class="page">
    <p>Summary</p>
    <p>The Internet needs a mechanism to authenticate packets</p>
    <p>Pretty Good Packet Authentication (PGPA) is a compromise between power and feasibility</p>
    <p>PGPA is simple, easy to implement, and has a plausible deployment path</p>
    <p>Thank you!</p>
  </div>
</Presentation>
