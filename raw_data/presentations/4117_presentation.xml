<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Who Spent My EOS?</p>
    <p>On the (In)Security of Resource Management of EOS.IO Sangsup Lee, Daejun Kim, Dongkwan Kim, Sooel Son, Yongdae Kim @KAIST</p>
    <p>1</p>
  </div>
  <div class="page">
    <p>!2</p>
    <p>Abstract</p>
  </div>
  <div class="page">
    <p>!3</p>
    <p>Abstract</p>
    <p>Resource management of EOS.IO</p>
  </div>
  <div class="page">
    <p>!4</p>
    <p>Abstract</p>
    <p>Resource management of EOS.IO</p>
  </div>
  <div class="page">
    <p>!5</p>
    <p>Abstract</p>
    <p>Resource management of EOS.IO</p>
    <p>Evaluated the impact of each vulnerability</p>
  </div>
  <div class="page">
    <p>!6</p>
    <p>Background</p>
  </div>
  <div class="page">
    <p>!7</p>
    <p>Background: Blockchain</p>
    <p>Blockchain-based cryptocurrency</p>
    <p>Consensus</p>
    <p>Mining</p>
    <p>P2P Network</p>
    <p>Wallet</p>
    <p>Smart contract</p>
    <p>Overview of cryptocurrency components</p>
  </div>
  <div class="page">
    <p>!8</p>
    <p>Background: Blockchain</p>
    <p>Blockchain-based cryptocurrency</p>
    <p>Consensus</p>
    <p>Mining</p>
    <p>P2P Network</p>
    <p>Wallet</p>
    <p>Smart contract</p>
    <p>Key components</p>
  </div>
  <div class="page">
    <p>!9</p>
    <p>Background: Blockchain</p>
    <p>The fundamentals of blockchain</p>
    <p>Data (Block)</p>
  </div>
  <div class="page">
    <p>!10</p>
    <p>Background: Blockchain</p>
    <p>Consensus algorithm</p>
    <p>Creating blocks</p>
    <p>Data (Block)</p>
  </div>
  <div class="page">
    <p>!11</p>
    <p>Background: Blockchain</p>
    <p>Consensus algorithm</p>
    <p>Creating blocks</p>
    <p>Verifying blocks</p>
    <p>Data (Block)</p>
  </div>
  <div class="page">
    <p>!12</p>
    <p>Background: Blockchain</p>
    <p>Consensus algorithm</p>
    <p>Creating blocks</p>
    <p>Verifying blocks</p>
    <p>Data (Block)</p>
    <p>Agreement on blocks</p>
  </div>
  <div class="page">
    <p>Consensus algorithm (PoW)</p>
    <p>!13</p>
    <p>Numerous block producers</p>
    <p>... Data (Block)</p>
    <p>Slow</p>
    <p>Bitcoin Ethereum</p>
    <p>Background: PoW (Proof of Work)</p>
    <p>Create Agree</p>
  </div>
  <div class="page">
    <p>Background: DPoS (Delegated Proof of Stake)</p>
    <p>Elected 21 Block producers (BP)</p>
    <p>Data (Block)</p>
    <p>EOS.IO Consensus algorithm (DPoS)</p>
    <p>FAST! (0.5 sec / block)</p>
    <p>!14</p>
    <p>Create Agree</p>
  </div>
  <div class="page">
    <p>FAST! (0.5 sec / block)</p>
    <p>But, resource management matters.</p>
    <p>!15</p>
    <p>Elected 21 Block producers (BP)</p>
    <p>Data (Block)</p>
    <p>EOS.IO Consensus algorithm (DPoS)</p>
    <p>Background: DPoS (Delegated Proof of Stake)</p>
    <p>Create Agree</p>
  </div>
  <div class="page">
    <p>!16</p>
    <p>Resource management necessity</p>
    <p>Blockchain</p>
    <p>Transaction requests</p>
    <p>User</p>
    <p>Background: DPoS (Delegated Proof of Stake)</p>
  </div>
  <div class="page">
    <p>!17</p>
    <p>Resource management necessity</p>
    <p>Blockchain</p>
    <p>Transaction requests</p>
    <p>User</p>
    <p>Elected 21 Block producers (BP)</p>
    <p>Background: DPoS (Delegated Proof of Stake)</p>
  </div>
  <div class="page">
    <p>!18</p>
    <p>Resource management necessity</p>
    <p>Blockchain</p>
    <p>Transaction requests</p>
    <p>User</p>
    <p>Elected 21 Block producers (BP)</p>
    <p>Overload problem</p>
    <p>Properly process request</p>
    <p>Background: DPoS (Delegated Proof of Stake)</p>
  </div>
  <div class="page">
    <p>!19</p>
    <p>Background: Smart contract</p>
    <p>$</p>
    <p>Alice Bob</p>
    <p>Smart contract</p>
    <p>Use Case</p>
    <p>Exchange  Gambling  Auction  Funding  Bank  And so on.</p>
    <p>Transaction Transaction</p>
    <p>TransactionTransaction</p>
  </div>
  <div class="page">
    <p>Transaction</p>
    <p>Target (Ex. eBay)  Function (Ex. Bidding(), Selling())  Permission (Ex. Alice@active)</p>
    <p>$</p>
    <p>Alice BobeBay Contract</p>
    <p>!20</p>
    <p>Background: Smart contract on EOS.IO</p>
  </div>
  <div class="page">
    <p>$</p>
    <p>Alice BobeBay Contract</p>
    <p>BP</p>
    <p>Delegated execution</p>
    <p>!21</p>
    <p>Background: Smart contract on EOS.IO</p>
  </div>
  <div class="page">
    <p>$</p>
    <p>Alice BobeBay Contract</p>
    <p>BP</p>
    <p>Delegated execution</p>
    <p>!22</p>
    <p>Background: Smart contract on EOS.IO</p>
    <p>Resource management matters</p>
    <p>Delegated Execution</p>
  </div>
  <div class="page">
    <p>Transaction delivery Program execution Data storing</p>
    <p>NET CPU RAM</p>
    <p>!23</p>
    <p>Background: Resource of EOS.IO</p>
  </div>
  <div class="page">
    <p>Transaction delivery Program execution Data storing</p>
    <p>NET CPU RAM</p>
    <p>Staking</p>
    <p>Individuals Blockchain system</p>
    <p>Refreshed every day</p>
    <p>!24</p>
    <p>Background: Resource of EOS.IO</p>
  </div>
  <div class="page">
    <p>Transaction delivery Program execution Data storing</p>
    <p>NET CPU RAM</p>
    <p>Buy</p>
    <p>RAM Market</p>
    <p>Not refreshed every day.</p>
    <p>!25</p>
    <p>Background: Resource of EOS.IO</p>
    <p>Individuals</p>
  </div>
  <div class="page">
    <p>!26</p>
    <p>Why EOS?</p>
  </div>
  <div class="page">
    <p>!27</p>
    <p>Market cap</p>
    <p>#1 #2</p>
    <p>Be Selfish and Avoid Dilemmas: Fork After Withholding (FAW)</p>
    <p>Attacks on Bitcoin (ACM CCS 17)</p>
    <p>Publish or perish: A backwardcompatible defense against</p>
    <p>selfish mining in bitcoin (RSA 17)</p>
    <p>ZEUS: Analyzing Safety of Smart Contracts</p>
    <p>(NDSS '18)</p>
    <p>teether: Gnawing at ethereum to automatically exploit smart</p>
    <p>contracts (USENIX '18)</p>
    <p>Hijacking bitcoin: Routing attacks on cryptocurrencies</p>
    <p>(IEEE S&amp;P '17)</p>
    <p>Eclipse attacks on bitcoins peerto-peer network</p>
    <p>(USENIX 15)</p>
    <p>Making smart contracts smarter (ACM CCS '16)</p>
    <p>The miner's dilemma (IEEE S&amp;P '15)</p>
    <p>Porosity: A decompiler for blockchain-based smart</p>
    <p>contracts bytecode (Defcon '17)</p>
    <p>Smart contract research</p>
    <p>Consensus research</p>
    <p>Other research work</p>
    <p>Why EOS?</p>
  </div>
  <div class="page">
    <p>Rank of marketcap Name</p>
    <p>Consensus algorithm</p>
    <p>Smart contract platform</p>
    <p>User accounts ! 1.3 M</p>
    <p>But, no security research in academia.</p>
    <p>!28</p>
    <p>Why EOS?</p>
  </div>
  <div class="page">
    <p>!29</p>
    <p>In our paper</p>
  </div>
  <div class="page">
    <p>!30</p>
    <p>Transaction (SC) Transaction (User)</p>
    <p>Block producer</p>
    <p>What are new attack targets?</p>
    <p>Users</p>
    <p>program code</p>
    <p>EOS structure</p>
  </div>
  <div class="page">
    <p>!31</p>
    <p>Transaction (SC) Transaction (User)</p>
    <p>Block producer</p>
    <p>AB</p>
    <p>What are new attack targets?</p>
    <p>EOS structure</p>
    <p>Smart Contract</p>
    <p>Smart Contract</p>
  </div>
  <div class="page">
    <p>!32</p>
    <p>Transaction (SC) Transaction (User)</p>
    <p>Users</p>
    <p>Block producer</p>
    <p>AB</p>
    <p>[ ]@eosio.code</p>
    <p>What are new attack targets?</p>
    <p>EOS structure</p>
    <p>Smart Contract</p>
    <p>Smart Contract</p>
  </div>
  <div class="page">
    <p>!33</p>
    <p>Transaction (SC) Transaction (User)</p>
    <p>Users</p>
    <p>Block producer</p>
    <p>Smart Contract Provider (SCP)</p>
    <p>AB</p>
    <p>[ ]@eosio.code</p>
    <p>=</p>
    <p>What are new attack targets?</p>
    <p>EOS structure</p>
    <p>Smart Contract</p>
    <p>Smart Contract</p>
  </div>
  <div class="page">
    <p>!34</p>
    <p>Transaction (SC) Transaction (User)</p>
    <p>Users</p>
    <p>Block producer</p>
    <p>Smart Contract Provider (SCP)</p>
    <p>AB</p>
    <p>RAM RAM</p>
    <p>CPUCPU</p>
    <p>NET</p>
    <p>CPU RAM</p>
    <p>NET</p>
    <p>CPU RAM</p>
    <p>[ ]@eosio.code</p>
    <p>=</p>
    <p>What are new attack targets?</p>
    <p>EOS structure</p>
  </div>
  <div class="page">
    <p>!35</p>
    <p>block creation timeTransaction (SC) Transaction (User)</p>
    <p>Users</p>
    <p>Block producer</p>
    <p>Smart Contract Provider (SCP)</p>
    <p>AB</p>
    <p>CPU RAMCPU RAM</p>
    <p>[ ]@eosio.code</p>
    <p>=</p>
    <p>What are new attack targets?</p>
    <p>Attack Target</p>
    <p>RAM RAM</p>
    <p>CPUCPU</p>
    <p>NET NET</p>
  </div>
  <div class="page">
    <p>!36</p>
    <p>What are new attack targets?</p>
    <p>Transaction (SC) Transaction (User)</p>
    <p>Users</p>
    <p>Block producer</p>
    <p>Smart Contract Provider (SCP)</p>
    <p>AB</p>
    <p>CPU RAMCPU RAM</p>
    <p>[ ]@eosio.code</p>
    <p>=</p>
    <p>Pay for transaction</p>
    <p>block creation time</p>
    <p>RAM RAM</p>
    <p>CPUCPU</p>
    <p>NET NET</p>
    <p>Attack Target</p>
  </div>
  <div class="page">
    <p>!37</p>
    <p>Transaction (SC) Transaction (User)</p>
    <p>Users</p>
    <p>Block producer</p>
    <p>Smart Contract Provider (SCP)</p>
    <p>AB</p>
    <p>CPU RAMCPU RAM</p>
    <p>[ ]@eosio.code</p>
    <p>=</p>
    <p>Pay for transaction</p>
    <p>To save data</p>
    <p>What are new attack targets?</p>
    <p>block creation time</p>
    <p>RAM RAM</p>
    <p>CPUCPU</p>
    <p>NET NET</p>
    <p>Attack Target</p>
  </div>
  <div class="page">
    <p>!38</p>
    <p>grant permission to SCP</p>
    <p>Transaction (SC) Transaction (User)</p>
    <p>Users</p>
    <p>Block producer</p>
    <p>Smart Contract Provider (SCP)</p>
    <p>AB</p>
    <p>CPU RAMCPU RAM</p>
    <p>[ ]@eosio.code</p>
    <p>=</p>
    <p>Pay for transaction</p>
    <p>What are new attack targets?</p>
    <p>block creation time</p>
    <p>RAM RAM</p>
    <p>CPUCPU</p>
    <p>NET NET</p>
    <p>Attack Target</p>
    <p>To save data</p>
  </div>
  <div class="page">
    <p>!39</p>
    <p>We found</p>
    <p>Transaction (SC) Transaction (User)</p>
    <p>Users</p>
    <p>Block producer</p>
    <p>Smart Contract Provider (SCP)</p>
    <p>AB</p>
    <p>CPU RAMCPU RAM</p>
    <p>[ ]@eosio.code</p>
    <p>=</p>
    <p>Attack Models &amp; Threat Models &amp; Attacks!</p>
    <p>RAM RAM</p>
    <p>CPUCPU</p>
    <p>NET NET</p>
  </div>
  <div class="page">
    <p>!40</p>
    <p>We found</p>
    <p>Block delay attackTransaction (SC) Transaction (User)</p>
    <p>Users</p>
    <p>Block producer</p>
    <p>Smart Contract Provider (SCP)</p>
    <p>AB</p>
    <p>CPU RAMCPU RAM</p>
    <p>[ ]@eosio.code</p>
    <p>=</p>
    <p>Attack Models &amp; Threat Models &amp; Attacks!</p>
    <p>RAM RAM</p>
    <p>CPUCPU</p>
    <p>NET NET</p>
  </div>
  <div class="page">
    <p>!41</p>
    <p>We found</p>
    <p>Transaction (SC) Transaction (User)</p>
    <p>Users</p>
    <p>Block producer</p>
    <p>Smart Contract Provider (SCP)</p>
    <p>AB</p>
    <p>CPU RAMCPU RAM</p>
    <p>[ ]@eosio.code</p>
    <p>=</p>
    <p>Attack Models &amp; Threat Models &amp; Attacks!</p>
    <p>Block delay attack</p>
    <p>CPU-Drain attack</p>
    <p>RAM RAM</p>
    <p>CPUCPU</p>
    <p>NET NET</p>
  </div>
  <div class="page">
    <p>!42</p>
    <p>We found</p>
    <p>Transaction (SC) Transaction (User)</p>
    <p>Users</p>
    <p>Block producer</p>
    <p>Smart Contract Provider (SCP)</p>
    <p>AB</p>
    <p>CPU RAMCPU RAM</p>
    <p>[ ]@eosio.code</p>
    <p>= RAM-Drain attack</p>
    <p>Attack Models &amp; Threat Models &amp; Attacks!</p>
    <p>Block delay attack</p>
    <p>CPU-Drain attack</p>
    <p>RAM RAM</p>
    <p>CPUCPU</p>
    <p>NET NET</p>
  </div>
  <div class="page">
    <p>!43</p>
    <p>We found</p>
    <p>Attack Models &amp; Threat Models &amp; Attacks!</p>
    <p>Transaction (SC) Transaction (User)</p>
    <p>Users</p>
    <p>Block producer</p>
    <p>Smart Contract Provider (SCP)</p>
    <p>AB</p>
    <p>CPU RAMCPU RAM</p>
    <p>[ ]@eosio.code</p>
    <p>=</p>
    <p>RAMsomware attack</p>
    <p>Block delay attack</p>
    <p>RAM-Drain attackCPU-Drain attack</p>
    <p>RAM RAM</p>
    <p>CPUCPU</p>
    <p>NET NET</p>
  </div>
  <div class="page">
    <p>!44</p>
    <p>Attack</p>
  </div>
  <div class="page">
    <p>!45</p>
    <p>Transactions (trx)</p>
    <p>Succeeded state</p>
    <p>Exhausted state</p>
    <p>Timer (T)</p>
    <p>Block producer</p>
    <p>Queue Block</p>
    <p>Block delay attack | DoS by draining EOS resources | RAMsomware attack</p>
    <p>Block delay attack</p>
  </div>
  <div class="page">
    <p>!46</p>
    <p>T+0.5s</p>
    <p>Transactions (trx)</p>
    <p>Succeeded state</p>
    <p>Exhausted state</p>
    <p>T+0.5sTimer (T) T+0.5s T+0.5s T+0.5s</p>
    <p>Block producer</p>
    <p>Queue Block</p>
    <p>Block delay attack | DoS by draining EOS resources | RAMsomware attack</p>
    <p>Block delay attack</p>
  </div>
  <div class="page">
    <p>!47</p>
    <p>T+0.5s</p>
    <p>Transactions (trx)</p>
    <p>T+0.5sTimer (T) T+0.5s T+0.5s T+0.5s</p>
    <p>Block producer</p>
    <p>Block delay attack | DoS by draining EOS resources | RAMsomware attack</p>
    <p>Succeeded state</p>
    <p>Exhausted state</p>
    <p>Queue Block</p>
    <p>T+0.2 +0.2 +0.2 +0.2 +0.2</p>
    <p>Block delay attack</p>
  </div>
  <div class="page">
    <p>!48</p>
    <p>T+0.5s</p>
    <p>Transactions (trx)</p>
    <p>T+0.5sTimer (T) T+0.5s T+0.5s T+0.5s</p>
    <p>Block producer</p>
    <p>Block delay attack | DoS by draining EOS resources | RAMsomware attack</p>
    <p>Succeeded state</p>
    <p>Exhausted state</p>
    <p>Queue Block</p>
    <p>T+0.2 +0.2 +0.2 +0.2 +0.2</p>
    <p>Block delay attack</p>
  </div>
  <div class="page">
    <p>!49</p>
    <p>Block delay attack | DoS by draining EOS resources | RAMsomware attack</p>
    <p>T+0.5s</p>
    <p>Transactions (trx)</p>
    <p>Succeeded status</p>
    <p>Exhausted status</p>
    <p>T+0.5sTimer (T) T+0.5s T+0.5s T+0.5s</p>
    <p>A</p>
    <p>Block producer</p>
    <p>BlockQueue</p>
    <p>SC1 Action (sc) Action (sc)</p>
    <p>SC2 Action (sc) Action (sc)</p>
    <p>SC3 Action (sc) Action (sc)</p>
    <p>SC4 Action (sc) Action (sc)</p>
    <p>SC5 Action (sc) Action (sc)</p>
    <p>SC6 Action (sc) Action (sc)</p>
    <p>SC7 Action (sc) Action (sc)</p>
    <p>transaction Call(A)</p>
    <p>transaction Call(A)</p>
    <p>A</p>
    <p>Block delay attack</p>
  </div>
  <div class="page">
    <p>!50</p>
    <p>Block delay attack | DoS by draining EOS resources | RAMsomware attack</p>
    <p>send_deferred (A)</p>
    <p>Timer (T) T+0.5s T+0.5s T+0.5s</p>
    <p>B</p>
    <p>Queue</p>
    <p>Block producer</p>
    <p>Block</p>
    <p>N send_deferred (A)</p>
    <p>send_deferred (A)</p>
    <p>T+0.2 +0.2 +0.2 +0.2 +0.2 +0.2 * x</p>
    <p>Transactions (trx)</p>
    <p>Succeeded state</p>
    <p>Exhausted state</p>
    <p>T+0.5s</p>
    <p>delay timereal time : T = T+ 0.2 * x</p>
    <p>Expected time T = T+0.5*x</p>
    <p>Block delay attack</p>
  </div>
  <div class="page">
    <p>Attacker Victim</p>
    <p>Block Count Time (min) Eos-CPU</p>
    <p>(min) EOS-NET</p>
    <p>(MiB) Cost (EOS)</p>
    <p>Delay Time (min)</p>
    <p>Loss (EOS)</p>
    <p>!51</p>
    <p>Block delay attack | DoS by draining EOS resources | RAMsomware attack</p>
    <p>(29/7/2019)</p>
    <p>Average of EOS transfer volume (01/04/2019~30/04/2019)</p>
    <p>Block delay attack</p>
    <p>Estimated financial loss via block delay attack</p>
  </div>
  <div class="page">
    <p>Attacker Victim</p>
    <p>Block Count Time (min) Eos-CPU</p>
    <p>(min) EOS-NET</p>
    <p>(MiB) Cost (EOS)</p>
    <p>Delay Time (min)</p>
    <p>Loss (EOS)</p>
    <p>!52</p>
    <p>Block delay attack Block delay attack | DoS by draining EOS resources | RAMsomware attack</p>
    <p>5 dummy transaction  ,  9 block      .</p>
    <p>block   EOS   transaction   ,    191,518 EOS .</p>
    <p>Estimated financial loss via block delay attack</p>
    <p>We get maximum bug bounty ($10,000 USD)</p>
    <p>From EOSIO foundation</p>
  </div>
  <div class="page">
    <p>!53</p>
    <p>Block delay attack | DoS by draining EOS resources | RAMsomware attack</p>
    <p>Block producer</p>
    <p>A</p>
    <p>SAVE_DATA ram-payer =_self</p>
    <p>Users</p>
    <p>EOS-CPU: 1,000 ms EOS-RAM: 0.0 MB EOS-NET: 1,000 bps</p>
    <p>EOS-RAM is purchase resource not stake,</p>
    <p>so EOS-RAM doesnt return until finishing their propose</p>
    <p>DoS by draining EOS resources: RAM-drain attack</p>
  </div>
  <div class="page">
    <p>!54</p>
    <p>Block delay attack | DoS by draining EOS resources | RAMsomware attack</p>
    <p>Block producer</p>
    <p>A</p>
    <p>SAVE_DATA ram-payer =_self</p>
    <p>Users</p>
    <p>EOS-CPU: 1,000 ms EOS-RAM: 1 MB EOS-NET: 1,000 bps</p>
    <p>EOS-CPU: 1,000 ms EOS-RAM: 1 MB EOS-NET: 1,000 bps EOS-CPU: 1,000 ms</p>
    <p>EOS-RAM: 0.0 MB EOS-NET: 1,000 bps</p>
    <p>EOS-RAM is purchase resource not stake,</p>
    <p>so EOS-RAM doesnt return until finishing their propose</p>
    <p>DoS by draining EOS resources: RAM-drain attack</p>
  </div>
  <div class="page">
    <p>R A</p>
    <p>M (M</p>
    <p>iB )</p>
    <p>Second (s) 0 3 6 9 12 15 18 21 24 27 30</p>
    <p>Attack N Attack 2^N</p>
    <p>R A</p>
    <p>M (M</p>
    <p>iB )</p>
    <p>Second (s)</p>
    <p>1</p>
    <p>SCA SCB</p>
    <p>!55</p>
    <p>Block delay attack | DoS by draining EOS resources | RAMsomware attack</p>
    <p>The Consuming time for RAM is depends on Smart contracts source code</p>
    <p>DoS by draining EOS resources: RAM-drain attack</p>
  </div>
  <div class="page">
    <p>!56</p>
    <p>A</p>
    <p>Create new</p>
    <p>transaction</p>
    <p>Users</p>
    <p>EOS-CPU: 1,000 ms EOS-RAM: 1 MB EOS-NET: 1,000 bps</p>
    <p>EOS-CPU: 1,000 ms EOS-RAM: 1 MB EOS-NET: 1,000 bps</p>
    <p>EOS-CPU: 500 ms EOS-RAM: 1 MB EOS-NET: 500 bps</p>
    <p>Block delay attack | DoS by draining EOS resources | RAMsomware attack</p>
    <p>DoS by draining EOS resources: CPU-drain attack</p>
    <p>B</p>
  </div>
  <div class="page">
    <p>!57</p>
    <p>A Create new</p>
    <p>transaction</p>
    <p>Users</p>
    <p>EOS-CPU: 700 ms EOS-RAM: 1 MB EOS-NET: 700 bps</p>
    <p>EOS-CPU: 0 ms EOS-RAM: 1 MB EOS-NET: 0 bps</p>
    <p>Block delay attack | DoS by draining EOS resources | RAMsomware attack</p>
    <p>&lt; Cost {EOS-CPU of $B} + Cost {EOS-NET of $B}Cost {EOS-CPU of $A} + Cost {EOS-NET of $A}</p>
    <p>DoS by draining EOS resources: CPU-drain attack</p>
    <p>B</p>
  </div>
  <div class="page">
    <p>!58</p>
    <p>Attacker Victim SC provider</p>
    <p>Attack Count EOS-NET (KiB) Eos-CPU</p>
    <p>(ms) EOS-NET</p>
    <p>(KiB) EOS-CPU</p>
    <p>(ms)</p>
    <p>Block delay attack | DoS by draining EOS resources | RAMsomware attack</p>
    <p>Attacker partially make DoS to victim while a day</p>
    <p>Over x3 (times)</p>
    <p>DoS by draining EOS resources: CPU-drain attack</p>
  </div>
  <div class="page">
    <p>!59</p>
    <p>Block delay attack | DoS by draining EOS resources | RAMsomware attack</p>
    <p>Block producer</p>
    <p>Users</p>
    <p>Give EOSIO.CODE Normal Action</p>
    <p>BA</p>
    <p>Call(B)</p>
    <p>RAMsomware attack</p>
  </div>
  <div class="page">
    <p>!60</p>
    <p>UsersSmart Contract Provider (SCP)</p>
    <p>AA</p>
    <p>CPU RAMCPU RAM</p>
    <p>RAM RAM</p>
    <p>CPUCPU</p>
    <p>NET NET</p>
    <p>[User]@eosio.code[User]@eosio.code</p>
    <p>RAMsomware attack</p>
  </div>
  <div class="page">
    <p>!61</p>
    <p>Block delay attack | DoS by draining EOS resources | RAMsomware attack</p>
    <p>Block producer</p>
    <p>Users</p>
    <p>User EOS-RAM is drained</p>
    <p>Attacker demand ransom of EOS-RAM to the victim</p>
    <p>JUST SEND TRANSACTION</p>
    <p>Call(A)</p>
    <p>AA</p>
    <p>Call(A)</p>
    <p>loop</p>
    <p>SAVE DATA</p>
    <p>Use EOS-RAM</p>
    <p>RAMsomware attack</p>
  </div>
  <div class="page">
    <p>!62</p>
    <p>RAMsomware attack Block delay attack | DoS by draining EOS resources | RAMsomware attack</p>
    <p>The user who have the largest EOS-RAM have 2GB EOS RAM</p>
    <p>R A</p>
    <p>M (M</p>
    <p>iB )</p>
    <p>Seconds (s) 0 2 4 6 8 10 12 14 16 18 20 22</p>
    <p>R A</p>
    <p>M (M</p>
    <p>iB )</p>
    <p>Seconds (s) 0 2 4 6 8 10 12 14 16 18 20 22</p>
    <p>1</p>
  </div>
  <div class="page">
    <p>!63</p>
    <p>Defense</p>
  </div>
  <div class="page">
    <p>!64</p>
    <p>- Block delay attack</p>
    <p>- CPU/RAM drain attack</p>
    <p>- RAMsomware attack</p>
    <p>Defense</p>
    <p>Trivial solution</p>
    <p>- Patched by EOSIO developers</p>
    <p>- Do access control</p>
    <p>- Do check smart contract version</p>
  </div>
  <div class="page">
    <p>!65</p>
    <p>- Block delay attack</p>
    <p>- CPU/RAM drain attack</p>
    <p>- RAMsomware attack</p>
    <p>Defense</p>
    <p>- Fine graind permission : eosio.code Expire Time, Maximum EOS Coin per a transaction : EOS-CPU permission, EOS-NET permission, EOS-RAM permission etc - Totally payment of transaction fee to the first transaction creator : Every transaction that purpose a role, is payed by the users who start trx.</p>
    <p>Trivial solution</p>
    <p>Design solution</p>
    <p>- Patched by EOSIO developers</p>
    <p>- Do access control</p>
    <p>- Do check smart contract version</p>
  </div>
  <div class="page">
    <p>!66</p>
    <p>Conclusion &amp; Future work</p>
    <p>- Conclusion - Analyzed new threats from the view point of new resources in EOS.IO - Found 4 new attack methodologies and verified them - Proposed new security features to prevent our attacks</p>
    <p>- Future work - Make an automatic auditing tool for our attacks - Design a web assembly analyzer</p>
  </div>
  <div class="page">
    <p>!67</p>
    <p>Thank you</p>
    <p>{k1rh4, reset, dkay, sl.son, yongdaek}@kaist.ac.kr</p>
  </div>
</Presentation>
