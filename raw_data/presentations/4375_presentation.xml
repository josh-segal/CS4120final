<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Numeracy for Language Models:</p>
    <p>Evaluating and Improving their Ability to Predict Numbers</p>
    <p>Georgios Spithourakis, Steffen Petersen, Sebastian Riedel</p>
    <p>Machine Reading</p>
    <p>Group</p>
  </div>
  <div class="page">
    <p>words</p>
    <p>Numeracy</p>
    <p>i</p>
    <p>one</p>
    <p>two</p>
    <p>three four</p>
    <p>dog</p>
    <p>fox</p>
    <p>cat mat</p>
    <p>sat jumped</p>
    <p>brown</p>
    <p>numbers numerals</p>
    <p>the</p>
    <p>sleeping</p>
    <p>-17</p>
    <p>1</p>
  </div>
  <div class="page">
    <p>Literate Language Models</p>
    <p>I eat an appleAn apple eats meI eats an apple</p>
    <p>Plausible</p>
    <p>(semantically, grammatically,</p>
    <p>etc.)</p>
    <p>A apple eats I</p>
  </div>
  <div class="page">
    <p>Numerate Language Models</p>
    <p>John is 0 m tall John is 1.7 m tall John is 2 m tall</p>
    <p>John is 999 m tall</p>
  </div>
  <div class="page">
    <p>Numeracy Matters</p>
    <p>Patients temperature is 36.6 degrees 41.9 98.6</p>
  </div>
  <div class="page">
    <p>Q1: Are existing LMs numerate?</p>
    <p>Q2: How to improve the numeracy of LMs?</p>
  </div>
  <div class="page">
    <p>Q1: Are existing LMs numerate?</p>
    <p>Q2: How to improve the numeracy of LMs?</p>
  </div>
  <div class="page">
    <p>A Neural Language Model</p>
    <p>RNN</p>
    <p>(|)</p>
    <p>1</p>
    <p>Input</p>
    <p>1</p>
    <p>Output</p>
  </div>
  <div class="page">
    <p>A Neural Language Model</p>
    <p>RNN</p>
    <p>(|)</p>
    <p>1</p>
    <p>Input</p>
    <p>1</p>
    <p>Output</p>
    <p>= softmax</p>
    <p>()</p>
    <p>the</p>
    <p>cat</p>
    <p>mat</p>
    <p>sat</p>
    <p>UNK V</p>
    <p>UNKNUM</p>
    <p>petrichor</p>
    <p>unothrorgaphy</p>
    <p>Spithourakis</p>
    <p>ht</p>
  </div>
  <div class="page">
    <p>Evaluation: Adjusted Perplexity</p>
    <p>Perplexity</p>
    <p>John is 2.1 m tall</p>
    <p>2.1 =</p>
    <p>BUT +  0.731</p>
    <p>+  9,846,321</p>
    <p>+</p>
    <p>UNKNUM</p>
  </div>
  <div class="page">
    <p>Evaluation: Adjusted Perplexity</p>
    <p>2.1 =</p>
    <p>Perplexity Adjusted Perplexity</p>
    <p>from test data</p>
    <p>UNKNUM</p>
    <p>[Ueberla, 1994]</p>
    <p>John is 2.1 m tall</p>
    <p>2.1 =</p>
    <p>BUT +  0.731</p>
    <p>+  9,846,321</p>
    <p>+</p>
    <p>UNKNUM UNKNUM</p>
    <p>[Ahn et al., 2016]</p>
    <p>a.k.a. Unknown-Penalised Perplexity</p>
  </div>
  <div class="page">
    <p>Datasets</p>
    <p>Clinical Dataset</p>
    <p>Source: London Chest Hospital</p>
    <p>Scientific Dataset</p>
    <p>Source: ARXIV</p>
    <p>words numerals</p>
  </div>
  <div class="page">
    <p>Results: Adjusted Perplexity</p>
    <p>all tokens words numerals</p>
    <p>all tokens words numerals</p>
    <p>S ci</p>
    <p>e n</p>
    <p>ti fi</p>
    <p>c</p>
    <p>(Lower is better)</p>
    <p>C li</p>
    <p>n ic</p>
    <p>a l</p>
  </div>
  <div class="page">
    <p>Results: Adjusted Perplexity</p>
    <p>all tokens words numerals</p>
    <p>all tokens words numerals</p>
    <p>S ci</p>
    <p>e n</p>
    <p>ti fi</p>
    <p>c</p>
    <p>(Lower is better)</p>
    <p>C li</p>
    <p>n ic</p>
    <p>a l</p>
  </div>
  <div class="page">
    <p>Results: Adjusted Perplexity</p>
    <p>P M</p>
    <p>F</p>
    <p>all tokens words numerals</p>
    <p>all tokens words numerals</p>
    <p>S ci</p>
    <p>e n</p>
    <p>ti fi</p>
    <p>c</p>
    <p>softmax Assumptions Reality (?)</p>
    <p>P D</p>
    <p>F</p>
    <p>(Lower is better)</p>
    <p>UNKNUM</p>
    <p>large</p>
    <p>small</p>
    <p>large</p>
    <p>small</p>
    <p>C li</p>
    <p>n ic</p>
    <p>a l</p>
  </div>
  <div class="page">
    <p>Q1: Are existing LMs numerate?</p>
    <p>Q2: How to improve the numeracy of LMs?</p>
  </div>
  <div class="page">
    <p>Strategy: Softmax &amp; Hierarchical Softmax</p>
    <p>softmax</p>
    <p>V</p>
    <p>the</p>
    <p>cat</p>
    <p>mat</p>
    <p>sat</p>
    <p>UNK</p>
    <p>word</p>
    <p>numeral ht</p>
    <p>softmax softmax</p>
    <p>the</p>
    <p>cat</p>
    <p>mat</p>
    <p>sat</p>
    <p>UNK</p>
    <p>UNKNUM</p>
    <p>ht</p>
    <p>s</p>
    <p>(|)</p>
  </div>
  <div class="page">
    <p>Strategy: Softmax &amp; Hierarchical Softmax</p>
    <p>softmax</p>
    <p>V</p>
    <p>the</p>
    <p>cat</p>
    <p>mat</p>
    <p>sat</p>
    <p>UNK</p>
    <p>UNKNUM</p>
    <p>word</p>
    <p>numeral ht</p>
    <p>softmax softmax</p>
    <p>softmax</p>
    <p>the</p>
    <p>cat</p>
    <p>mat</p>
    <p>sat</p>
    <p>UNK</p>
    <p>UNKNUM</p>
    <p>ht</p>
    <p>s</p>
  </div>
  <div class="page">
    <p>Strategy: Softmax &amp; Hierarchical Softmax</p>
    <p>softmax</p>
    <p>V</p>
    <p>the</p>
    <p>cat</p>
    <p>mat</p>
    <p>sat</p>
    <p>UNK</p>
    <p>word</p>
    <p>numeral ht</p>
    <p>softmax softmax</p>
    <p>(|)</p>
    <p>h-softmax  digit-by-digit  from PDF  etc.</p>
    <p>the</p>
    <p>cat</p>
    <p>mat</p>
    <p>sat</p>
    <p>UNK</p>
    <p>UNKNUM</p>
    <p>ht</p>
    <p>s</p>
  </div>
  <div class="page">
    <p>Strategy: Digit-by-Digit Composition</p>
    <p>SOS 2 . 1</p>
    <p>2.1 =  2  .|2  1 2.)  2.1)</p>
    <p>d-RNN</p>
  </div>
  <div class="page">
    <p>Strategy: Digit-by-Digit Composition</p>
    <p>SOS 2 . 1</p>
    <p>2.1 =  2  .|2  1 2.)  2.1)</p>
    <p>d-RNN</p>
    <p>UNKNUM</p>
  </div>
  <div class="page">
    <p>Strategy: from continuous PDF</p>
    <p>P D</p>
    <p>F</p>
    <p>= 2.1 =  2.05 &lt;  &lt; 2.15 |precision = 1   precision = 1</p>
  </div>
  <div class="page">
    <p>Strategy: from continuous PDF</p>
    <p>P D</p>
    <p>F</p>
    <p>= 2.1 =  2.05 &lt;  &lt; 2.15 |precision = 1   precision = 1</p>
    <p>ht</p>
    <p>MoG</p>
    <p>softmax</p>
    <p>precision =</p>
    <p>Frozen s and s</p>
  </div>
  <div class="page">
    <p>Overview of Strategies</p>
    <p>&lt;SOS&gt; 2 . 1</p>
    <p>MoG</p>
    <p>d-RNN</p>
    <p>h-softmax</p>
    <p>P D</p>
    <p>F</p>
    <p>UNKNUM</p>
    <p>softmax</p>
  </div>
  <div class="page">
    <p>Overview of Strategies</p>
    <p>&lt;SOS&gt; 2 . 1</p>
    <p>MoG</p>
    <p>d-RNN</p>
    <p>h-softmax</p>
    <p>ht</p>
    <p>softmax</p>
    <p>combination</p>
    <p>P D</p>
    <p>F</p>
    <p>UNKNUM</p>
    <p>softmax</p>
  </div>
  <div class="page">
    <p>Results: Language Modelling (1)</p>
    <p>softmax h-softmax d-RNN MoG combination</p>
    <p>softmax h-softmax d-RNN MoG combination</p>
    <p>softmax h-softmax d-RNN MoG combination</p>
    <p>Clinical</p>
    <p>All Tokens</p>
    <p>Words</p>
    <p>Numerals</p>
    <p>A d</p>
    <p>ju st</p>
    <p>e d</p>
    <p>P e</p>
    <p>rp le</p>
    <p>xi ty</p>
    <p>(lower is better)</p>
  </div>
  <div class="page">
    <p>softmax h-softmax d-RNN MoG combination 51.83 49.81 48.89 48.97 48.25</p>
    <p>softmax h-softmax d-RNN MoG combination</p>
    <p>Results: Language Modelling (2)</p>
    <p>softmax h-softmax d-RNN MoG combination</p>
    <p>Scientific</p>
    <p>All Tokens</p>
    <p>Words</p>
    <p>Numerals</p>
    <p>A d</p>
    <p>ju st</p>
    <p>e d</p>
    <p>P e</p>
    <p>rp le</p>
    <p>xi ty</p>
    <p>(lower is better)</p>
  </div>
  <div class="page">
    <p>=</p>
    <p>100%</p>
    <p>Results: Number Prediction</p>
    <p>numbernumeral</p>
    <p>`2.1 2.1</p>
    <p>mean median softmax h-softmax d-RNN MoG combination</p>
    <p>(lower is better)</p>
    <p>Clinical</p>
  </div>
  <div class="page">
    <p>mean softmax d-RNN combination</p>
    <p>mean median softmax h-softmax d-RNN MoG combination</p>
    <p>Clinical</p>
    <p>Results: Number Prediction</p>
    <p>(lower is better)</p>
  </div>
  <div class="page">
    <p>Softmax versus Hierarchical Softmax</p>
    <p>1</p>
    <p>cosine similarities softmax</p>
    <p>cosine similarities h-softmax</p>
  </div>
  <div class="page">
    <p>Analysis: d-RNN and Benfords Law</p>
    <p>cosine similarities d-RNN</p>
    <p>E O</p>
    <p>S .</p>
  </div>
  <div class="page">
    <p>S ci</p>
    <p>e n</p>
    <p>ti fi</p>
    <p>c</p>
    <p>d-RNN Benford</p>
    <p>C li</p>
    <p>n ic</p>
    <p>a l</p>
    <p>Analysis: d-RNN and Benfords Law</p>
    <p>cosine similarities d-RNN</p>
    <p>E O</p>
    <p>S .</p>
  </div>
  <div class="page">
    <p>Analysis: Model Predictions</p>
    <p>MoG</p>
    <p>d-RNN</p>
    <p>h-softmax</p>
    <p>ejective fraction : ____ % ...</p>
  </div>
  <div class="page">
    <p>Analysis: Strategy Selection</p>
    <p>Ejective fraction: 27.00 % Ejective fraction: 35.00 % HIP 12961 and GL 676</p>
    <p>measured 32 x 31 mm NGC 6334 stars</p>
    <p>MoG</p>
    <p>d-RNN</p>
    <p>h-softmax</p>
    <p>ht</p>
    <p>softmax</p>
    <p>Small integers, percentiles, years</p>
    <p>reals, some ids</p>
  </div>
  <div class="page">
    <p>Conclusion (1)</p>
    <p>softmax</p>
    <p>the</p>
    <p>cat</p>
    <p>mat</p>
    <p>UNK</p>
    <p>UNKNUM</p>
    <p>ht</p>
    <p>Are existing LMs numerate?</p>
  </div>
  <div class="page">
    <p>Conclusion (1)</p>
    <p>Johns height is ___</p>
    <p>softmax</p>
    <p>the</p>
    <p>cat</p>
    <p>mat</p>
    <p>UNK</p>
    <p>UNKNUM</p>
    <p>ht</p>
    <p>UNKNUM</p>
    <p>Are existing LMs numerate?</p>
  </div>
  <div class="page">
    <p>Conclusion (2)</p>
    <p>MoG</p>
    <p>d-RNN</p>
    <p>h-softmax</p>
    <p>ht</p>
    <p>softmax</p>
    <p>combination</p>
    <p>How to improve</p>
    <p>the numeracy of LMs?</p>
  </div>
  <div class="page">
    <p>Conclusion (2)</p>
    <p>MoG</p>
    <p>d-RNN</p>
    <p>h-softmax</p>
    <p>ht</p>
    <p>softmax</p>
    <p>combination</p>
    <p>Johns height is ___</p>
    <p>How to improve</p>
    <p>the numeracy of LMs?</p>
  </div>
  <div class="page">
    <p>Thank you! 2.1</p>
    <p>-17</p>
    <p>UNKNUM</p>
  </div>
</Presentation>
