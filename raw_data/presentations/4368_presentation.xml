<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>NASH: Toward End-to-End Neural Architecture for Generative Semantic Hashing</p>
    <p>Presenter: Dinghan Shen</p>
    <p>Joint work with: Qinliang Su, Paidamoyo Chapfuwa, Wenlin Wang, Guoyin Wang, Lawrence Carin, Ricardo Henao</p>
    <p>Duke University &amp; Sun Yat-sen University</p>
    <p>July 17, 2018</p>
    <p>Equal contribution Dinghan Shen et al. NASH for fast similarity search July 17, 2018 1 / 17</p>
  </div>
  <div class="page">
    <p>Background Semantic Hashing</p>
    <p>Fast and accurate similarity search (i.e., finding documents from a large corpus that are most similar to a query of interest) is at the core of many information retrieval applications;</p>
    <p>One strategy is to represent each document as a continuous vector: such as Paragraph Vector [Le and Mikolov, 2014], Skip-thought vectors [Kiros et al., 2015], Infersent [Conneau et al., 2017], etc. Cosine similarity is typically employed to measure relatedness;</p>
    <p>Semantic hashing is an effective approach: the similarity between two documents can be evaluated by simply calculating pairwise Hamming distances between hashing (binary) codes;</p>
    <p>Dinghan Shen et al. NASH for fast similarity search July 17, 2018 2 / 17</p>
  </div>
  <div class="page">
    <p>Motivation &amp; contributions</p>
    <p>Motivation:</p>
    <p>Existing semantic hashing approaches typically require two-stage training procedures (e.g. continuous representations are crudely binarized after training);</p>
    <p>Vast amount of unlabeled data is not fully leveraged for learning binary document representations.</p>
    <p>Contributions:</p>
    <p>we propose a simple and generic neural architecture for text hashing that learns binary latent codes for documents, which be trained an end-to-end manner;</p>
    <p>We leverage a Neural Variational Inference (NVI) framework, which introduces data-dependent noises during training and makes effective use of unlabeled information.</p>
    <p>Dinghan Shen et al. NASH for fast similarity search July 17, 2018 3 / 17</p>
  </div>
  <div class="page">
    <p>Framework components Hashing under the NVI Framework</p>
    <p>Notations: let x and z denote the input document and its corresponding binary hash code, respectively;</p>
    <p>We define a generative model that simultaneously accounts for both the encoding distribution, p(z|x), and decoding distribution, p(x|z),</p>
    <p>g(x) &lt;latexit sha1_base64=&quot;4gsoFBpBBAbmyfn2ZeNA3fTqK6U=&quot;&gt;AAAB73icbVBNTwIxEJ3FL8Qv1KOXRmKCF7JrSNQb0YtHTFzBwIZ0Sxca2u6m7RrJhl/hxYMar/4db/4bC+xBwZdM8vLeTGbmhQln2rjut1NYWV1b3yhulra2d3b3yvsH9zpOFaE+iXms2iHWlDNJfcMMp+1EUSxCTlvh6Hrqtx6p0iyWd2ac0EDggWQRI9hY6WHQ6yZDVn067ZUrbs2dAS0TLycVyNHslb+6/ZikgkpDONa647mJCTKsDCOcTkrdVNMEkxEe0I6lEguqg2x28ASdWKWPoljZkgbN1N8TGRZaj0VoOwU2Q73oTcX/vE5qoosgYzJJDZVkvihKOTIxmn6P+kxRYvjYEkwUs7ciMsQKE2MzKtkQvMWXl4l/Vrusubf1SuMqT6MIR3AMVfDgHBpwA03wgYCAZ3iFN0c5L8678zFvLTj5zCH8gfP5A5/Qj9M=&lt;/latexit&gt;&lt;latexit sha1_base64=&quot;4gsoFBpBBAbmyfn2ZeNA3fTqK6U=&quot;&gt;AAAB73icbVBNTwIxEJ3FL8Qv1KOXRmKCF7JrSNQb0YtHTFzBwIZ0Sxca2u6m7RrJhl/hxYMar/4db/4bC+xBwZdM8vLeTGbmhQln2rjut1NYWV1b3yhulra2d3b3yvsH9zpOFaE+iXms2iHWlDNJfcMMp+1EUSxCTlvh6Hrqtx6p0iyWd2ac0EDggWQRI9hY6WHQ6yZDVn067ZUrbs2dAS0TLycVyNHslb+6/ZikgkpDONa647mJCTKsDCOcTkrdVNMEkxEe0I6lEguqg2x28ASdWKWPoljZkgbN1N8TGRZaj0VoOwU2Q73oTcX/vE5qoosgYzJJDZVkvihKOTIxmn6P+kxRYvjYEkwUs7ciMsQKE2MzKtkQvMWXl4l/Vrusubf1SuMqT6MIR3AMVfDgHBpwA03wgYCAZ3iFN0c5L8678zFvLTj5zCH8gfP5A5/Qj9M=&lt;/latexit&gt;&lt;latexit sha1_base64=&quot;4gsoFBpBBAbmyfn2ZeNA3fTqK6U=&quot;&gt;AAAB73icbVBNTwIxEJ3FL8Qv1KOXRmKCF7JrSNQb0YtHTFzBwIZ0Sxca2u6m7RrJhl/hxYMar/4db/4bC+xBwZdM8vLeTGbmhQln2rjut1NYWV1b3yhulra2d3b3yvsH9zpOFaE+iXms2iHWlDNJfcMMp+1EUSxCTlvh6Hrqtx6p0iyWd2ac0EDggWQRI9hY6WHQ6yZDVn067ZUrbs2dAS0TLycVyNHslb+6/ZikgkpDONa647mJCTKsDCOcTkrdVNMEkxEe0I6lEguqg2x28ASdWKWPoljZkgbN1N8TGRZaj0VoOwU2Q73oTcX/vE5qoosgYzJJDZVkvihKOTIxmn6P+kxRYvjYEkwUs7ciMsQKE2MzKtkQvMWXl4l/Vrusubf1SuMqT6MIR3AMVfDgHBpwA03wgYCAZ3iFN0c5L8678zFvLTj5zCH8gfP5A5/Qj9M=&lt;/latexit&gt;</p>
    <p>z &lt;latexit sha1_base64=&quot;WIlbTbBFLLcqOvt81zBc03GagJU=&quot;&gt;AAAB53icbVBNS8NAEJ3Ur1q/qh69LBbBU0lFUG9FLx5bMLbQhrLZTtq1m03Y3Qg19Bd48aDi1b/kzX/jts1BWx8MPN6bYWZekAiujet+O4WV1bX1jeJmaWt7Z3evvH9wr+NUMfRYLGLVDqhGwSV6hhuB7UQhjQKBrWB0M/Vbj6g0j+WdGSfoR3QgecgZNVZqPvXKFbfqzkCWSS0nFcjR6JW/uv2YpRFKwwTVulNzE+NnVBnOBE5K3VRjQtmIDrBjqaQRaj+bHTohJ1bpkzBWtqQhM/X3REYjrcdRYDsjaoZ60ZuK/3md1ISXfsZlkhqUbL4oTAUxMZl+TfpcITNibAllittbCRtSRZmx2ZRsCLXFl5eJd1a9qrrN80r9Ok+jCEdwDKdQgwuowy00wAMGCM/wCm/Og/PivDsf89aCk88cwh84nz9XU4zR&lt;/latexit&gt;&lt;latexit sha1_base64=&quot;WIlbTbBFLLcqOvt81zBc03GagJU=&quot;&gt;AAAB53icbVBNS8NAEJ3Ur1q/qh69LBbBU0lFUG9FLx5bMLbQhrLZTtq1m03Y3Qg19Bd48aDi1b/kzX/jts1BWx8MPN6bYWZekAiujet+O4WV1bX1jeJmaWt7Z3evvH9wr+NUMfRYLGLVDqhGwSV6hhuB7UQhjQKBrWB0M/Vbj6g0j+WdGSfoR3QgecgZNVZqPvXKFbfqzkCWSS0nFcjR6JW/uv2YpRFKwwTVulNzE+NnVBnOBE5K3VRjQtmIDrBjqaQRaj+bHTohJ1bpkzBWtqQhM/X3REYjrcdRYDsjaoZ60ZuK/3md1ISXfsZlkhqUbL4oTAUxMZl+TfpcITNibAllittbCRtSRZmx2ZRsCLXFl5eJd1a9qrrN80r9Ok+jCEdwDKdQgwuowy00wAMGCM/wCm/Og/PivDsf89aCk88cwh84nz9XU4zR&lt;/latexit&gt;&lt;latexit sha1_base64=&quot;WIlbTbBFLLcqOvt81zBc03GagJU=&quot;&gt;AAAB53icbVBNS8NAEJ3Ur1q/qh69LBbBU0lFUG9FLx5bMLbQhrLZTtq1m03Y3Qg19Bd48aDi1b/kzX/jts1BWx8MPN6bYWZekAiujet+O4WV1bX1jeJmaWt7Z3evvH9wr+NUMfRYLGLVDqhGwSV6hhuB7UQhjQKBrWB0M/Vbj6g0j+WdGSfoR3QgecgZNVZqPvXKFbfqzkCWSS0nFcjR6JW/uv2YpRFKwwTVulNzE+NnVBnOBE5K3VRjQtmIDrBjqaQRaj+bHTohJ1bpkzBWtqQhM/X3REYjrcdRYDsjaoZ60ZuK/3md1ISXfsZlkhqUbL4oTAUxMZl+TfpcITNibAllittbCRtSRZmx2ZRsCLXFl5eJd1a9qrrN80r9Ok+jCEdwDKdQgwuowy00wAMGCM/wCm/Og/PivDsf89aCk88cwh84nz9XU4zR&lt;/latexit&gt;</p>
    <p>x &lt;latexit sha1_base64=&quot;9fy0Mz7X/Akugg6I9ARal+HBkn4=&quot;&gt;AAAB7XicbVBNS8NAEJ3Ur1q/qh69LBbBU0lEUG9FLx4rGFtoQ9lsN+3SzSbsTsQS+iO8eFDx6v/x5r9x2+agrQ8GHu/NMDMvTKUw6LrfTmlldW19o7xZ2dre2d2r7h88mCTTjPsskYluh9RwKRT3UaDk7VRzGoeSt8LRzdRvPXJtRKLucZzyIKYDJSLBKFqp1R1SzJ8mvWrNrbszkGXiFaQGBZq96le3n7As5gqZpMZ0PDfFIKcaBZN8UulmhqeUjeiAdyxVNOYmyGfnTsiJVfokSrQthWSm/p7IaWzMOA5tZ0xxaBa9qfif18kwugxyodIMuWLzRVEmCSZk+jvpC80ZyrEllGlhbyVsSDVlaBOq2BC8xZeXiX9Wv6q7d+e1xnWRRhmO4BhOwYMLaMAtNMEHBiN4hld4c1LnxXl3PuatJaeYOYQ/cD5/ABu5j5w=&lt;/latexit&gt;&lt;latexit sha1_base64=&quot;9fy0Mz7X/Akugg6I9ARal+HBkn4=&quot;&gt;AAAB7XicbVBNS8NAEJ3Ur1q/qh69LBbBU0lEUG9FLx4rGFtoQ9lsN+3SzSbsTsQS+iO8eFDx6v/x5r9x2+agrQ8GHu/NMDMvTKUw6LrfTmlldW19o7xZ2dre2d2r7h88mCTTjPsskYluh9RwKRT3UaDk7VRzGoeSt8LRzdRvPXJtRKLucZzyIKYDJSLBKFqp1R1SzJ8mvWrNrbszkGXiFaQGBZq96le3n7As5gqZpMZ0PDfFIKcaBZN8UulmhqeUjeiAdyxVNOYmyGfnTsiJVfokSrQthWSm/p7IaWzMOA5tZ0xxaBa9qfif18kwugxyodIMuWLzRVEmCSZk+jvpC80ZyrEllGlhbyVsSDVlaBOq2BC8xZeXiX9Wv6q7d+e1xnWRRhmO4BhOwYMLaMAtNMEHBiN4hld4c1LnxXl3PuatJaeYOYQ/cD5/ABu5j5w=&lt;/latexit&gt;&lt;latexit sha1_base64=&quot;9fy0Mz7X/Akugg6I9ARal+HBkn4=&quot;&gt;AAAB7XicbVBNS8NAEJ3Ur1q/qh69LBbBU0lEUG9FLx4rGFtoQ9lsN+3SzSbsTsQS+iO8eFDx6v/x5r9x2+agrQ8GHu/NMDMvTKUw6LrfTmlldW19o7xZ2dre2d2r7h88mCTTjPsskYluh9RwKRT3UaDk7VRzGoeSt8LRzdRvPXJtRKLucZzyIKYDJSLBKFqp1R1SzJ8mvWrNrbszkGXiFaQGBZq96le3n7As5gqZpMZ0PDfFIKcaBZN8UulmhqeUjeiAdyxVNOYmyGfnTsiJVfokSrQthWSm/p7IaWzMOA5tZ0xxaBa9qfif18kwugxyodIMuWLzRVEmCSZk+jvpC80ZyrEllGlhbyVsSDVlaBOq2BC8xZeXiX9Wv6q7d+e1xnWRRhmO4BhOwYMLaMAtNMEHBiN4hld4c1LnxXl3PuatJaeYOYQ/cD5/ABu5j5w=&lt;/latexit&gt;</p>
    <p>x &lt;latexit sha1_base64=&quot;wrYRrS9nqr2/jTKdHNfdRLtLB0k=&quot;&gt;AAAB53icbVBNS8NAEJ3Ur1q/qh69LBbBU0lFUG9FLx5bMLbQhrLZTtq1m03Y3Ygl9Bd48aDi1b/kzX/jts1BWx8MPN6bYWZekAiujet+O4WV1bX1jeJmaWt7Z3evvH9wr+NUMfRYLGLVDqhGwSV6hhuB7UQhjQKBrWB0M/Vbj6g0j+WdGSfoR3QgecgZNVZqPvXKFbfqzkCWSS0nFcjR6JW/uv2YpRFKwwTVulNzE+NnVBnOBE5K3VRjQtmIDrBjqaQRaj+bHTohJ1bpkzBWtqQhM/X3REYjrcdRYDsjaoZ60ZuK/3md1ISXfsZlkhqUbL4oTAUxMZl+TfpcITNibAllittbCRtSRZmx2ZRsCLXFl5eJd1a9qrrN80r9Ok+jCEdwDKdQgwuowy00wAMGCM/wCm/Og/PivDsf89aCk88cwh84nz9UTYzP&lt;/latexit&gt;&lt;latexit sha1_base64=&quot;wrYRrS9nqr2/jTKdHNfdRLtLB0k=&quot;&gt;AAAB53icbVBNS8NAEJ3Ur1q/qh69LBbBU0lFUG9FLx5bMLbQhrLZTtq1m03Y3Ygl9Bd48aDi1b/kzX/jts1BWx8MPN6bYWZekAiujet+O4WV1bX1jeJmaWt7Z3evvH9wr+NUMfRYLGLVDqhGwSV6hhuB7UQhjQKBrWB0M/Vbj6g0j+WdGSfoR3QgecgZNVZqPvXKFbfqzkCWSS0nFcjR6JW/uv2YpRFKwwTVulNzE+NnVBnOBE5K3VRjQtmIDrBjqaQRaj+bHTohJ1bpkzBWtqQhM/X3REYjrcdRYDsjaoZ60ZuK/3md1ISXfsZlkhqUbL4oTAUxMZl+TfpcITNibAllittbCRtSRZmx2ZRsCLXFl5eJd1a9qrrN80r9Ok+jCEdwDKdQgwuowy00wAMGCM/wCm/Og/PivDsf89aCk88cwh84nz9UTYzP&lt;/latexit&gt;&lt;latexit sha1_base64=&quot;wrYRrS9nqr2/jTKdHNfdRLtLB0k=&quot;&gt;AAAB53icbVBNS8NAEJ3Ur1q/qh69LBbBU0lFUG9FLx5bMLbQhrLZTtq1m03Y3Ygl9Bd48aDi1b/kzX/jts1BWx8MPN6bYWZekAiujet+O4WV1bX1jeJmaWt7Z3evvH9wr+NUMfRYLGLVDqhGwSV6hhuB7UQhjQKBrWB0M/Vbj6g0j+WdGSfoR3QgecgZNVZqPvXKFbfqzkCWSS0nFcjR6JW/uv2YpRFKwwTVulNzE+NnVBnOBE5K3VRjQtmIDrBjqaQRaj+bHTohJ1bpkzBWtqQhM/X3REYjrcdRYDsjaoZ60ZuK/3md1ISXfsZlkhqUbL4oTAUxMZl+TfpcITNibAllittbCRtSRZmx2ZRsCLXFl5eJd1a9qrrN80r9Ok+jCEdwDKdQgwuowy00wAMGCM/wCm/Og/PivDsf89aCk88cwh84nz9UTYzP&lt;/latexit&gt; log 2</p>
    <p>&lt;latexit sha1_base64=&quot;7fXReuSi2AGXHQbFX8oagcVUXco=&quot;&gt;AAAB83icbVBNS8NAEJ34WetX1aOXxSJ4KkkR1FvRi8cKxhaaWDbbTbp0Nxt3N4VS+ju8eFDx6p/x5r9x2+agrQ8GHu/NMDMvyjjTxnW/nZXVtfWNzdJWeXtnd2+/cnD4oGWuCPWJ5FK1I6wpZyn1DTOctjNFsYg4bUWDm6nfGlKlmUzvzSijocBJymJGsLFSGHCZoECzRODHerdSdWvuDGiZeAWpQoFmt/IV9CTJBU0N4VjrjudmJhxjZRjhdFIOck0zTAY4oR1LUyyoDsezoyfo1Co9FEtlKzVopv6eGGOh9UhEtlNg09eL3lT8z+vkJr4MxyzNckNTMl8U5xwZiaYJoB5TlBg+sgQTxeytiPSxwsTYnMo2BG/x5WXi12tXNffuvNq4LtIowTGcwBl4cAENuIUm+EDgCZ7hFd6cofPivDsf89YVp5g5gj9wPn8AnmWRig==&lt;/latexit&gt;&lt;latexit sha1_base64=&quot;7fXReuSi2AGXHQbFX8oagcVUXco=&quot;&gt;AAAB83icbVBNS8NAEJ34WetX1aOXxSJ4KkkR1FvRi8cKxhaaWDbbTbp0Nxt3N4VS+ju8eFDx6p/x5r9x2+agrQ8GHu/NMDMvyjjTxnW/nZXVtfWNzdJWeXtnd2+/cnD4oGWuCPWJ5FK1I6wpZyn1DTOctjNFsYg4bUWDm6nfGlKlmUzvzSijocBJymJGsLFSGHCZoECzRODHerdSdWvuDGiZeAWpQoFmt/IV9CTJBU0N4VjrjudmJhxjZRjhdFIOck0zTAY4oR1LUyyoDsezoyfo1Co9FEtlKzVopv6eGGOh9UhEtlNg09eL3lT8z+vkJr4MxyzNckNTMl8U5xwZiaYJoB5TlBg+sgQTxeytiPSxwsTYnMo2BG/x5WXi12tXNffuvNq4LtIowTGcwBl4cAENuIUm+EDgCZ7hFd6cofPivDsf89YVp5g5gj9wPn8AnmWRig==&lt;/latexit&gt;&lt;latexit sha1_base64=&quot;7fXReuSi2AGXHQbFX8oagcVUXco=&quot;&gt;AAAB83icbVBNS8NAEJ34WetX1aOXxSJ4KkkR1FvRi8cKxhaaWDbbTbp0Nxt3N4VS+ju8eFDx6p/x5r9x2+agrQ8GHu/NMDMvyjjTxnW/nZXVtfWNzdJWeXtnd2+/cnD4oGWuCPWJ5FK1I6wpZyn1DTOctjNFsYg4bUWDm6nfGlKlmUzvzSijocBJymJGsLFSGHCZoECzRODHerdSdWvuDGiZeAWpQoFmt/IV9CTJBU0N4VjrjudmJhxjZRjhdFIOck0zTAY4oR1LUyyoDsezoyfo1Co9FEtlKzVopv6eGGOh9UhEtlNg09eL3lT8z+vkJr4MxyzNckNTMl8U5xwZiaYJoB5TlBg+sgQTxeytiPSxwsTYnMo2BG/x5WXi12tXNffuvNq4LtIowTGcwBl4cAENuIUm+EDgCZ7hFd6cofPivDsf89YVp5g5gj9wPn8AnmWRig==&lt;/latexit&gt;</p>
    <p>MLP z0  N (z, I)</p>
    <p>&lt;latexit sha1_base64=&quot;oL/kS60CrA7r8ceuyOQmklSUP/Y=&quot;&gt;AAACD3icbVBNS8NAEN3Ur1q/oh69LBaxgpREBPVW9KIXqWBsoYlls922S3eTsLsR2pCf4MW/4sWDilev3vw3btoctPXBwOO9GWbm+RGjUlnWt1GYm19YXCoul1ZW19Y3zM2tOxnGAhMHhywUTR9JwmhAHEUVI81IEMR9Rhr+4CLzGw9ESBoGt2oYEY+jXkC7FCOlpba5P7pP3EhQTlJXUg5djlQfI5Zcp5XRIdRajyN4ddA2y1bVGgPOEjsnZZCj3ja/3E6IY04ChRmSsmVbkfISJBTFjKQlN5YkQniAeqSlaYA4kV4yfiiFe1rpwG4odAUKjtXfEwniUg65rzuze+W0l4n/ea1YdU+9hAZRrEiAJ4u6MYMqhFk6sEMFwYoNNUFYUH0rxH0kEFY6w5IOwZ5+eZY4R9WzqnVzXK6d52kUwQ7YBRVggxNQA5egDhyAwSN4Bq/gzXgyXox342PSWjDymW3wB8bnD54+nHs=&lt;/latexit&gt;&lt;latexit sha1_base64=&quot;oL/kS60CrA7r8ceuyOQmklSUP/Y=&quot;&gt;AAACD3icbVBNS8NAEN3Ur1q/oh69LBaxgpREBPVW9KIXqWBsoYlls922S3eTsLsR2pCf4MW/4sWDilev3vw3btoctPXBwOO9GWbm+RGjUlnWt1GYm19YXCoul1ZW19Y3zM2tOxnGAhMHhywUTR9JwmhAHEUVI81IEMR9Rhr+4CLzGw9ESBoGt2oYEY+jXkC7FCOlpba5P7pP3EhQTlJXUg5djlQfI5Zcp5XRIdRajyN4ddA2y1bVGgPOEjsnZZCj3ja/3E6IY04ChRmSsmVbkfISJBTFjKQlN5YkQniAeqSlaYA4kV4yfiiFe1rpwG4odAUKjtXfEwniUg65rzuze+W0l4n/ea1YdU+9hAZRrEiAJ4u6MYMqhFk6sEMFwYoNNUFYUH0rxH0kEFY6w5IOwZ5+eZY4R9WzqnVzXK6d52kUwQ7YBRVggxNQA5egDhyAwSN4Bq/gzXgyXox342PSWjDymW3wB8bnD54+nHs=&lt;/latexit&gt;&lt;latexit sha1_base64=&quot;oL/kS60CrA7r8ceuyOQmklSUP/Y=&quot;&gt;AAACD3icbVBNS8NAEN3Ur1q/oh69LBaxgpREBPVW9KIXqWBsoYlls922S3eTsLsR2pCf4MW/4sWDilev3vw3btoctPXBwOO9GWbm+RGjUlnWt1GYm19YXCoul1ZW19Y3zM2tOxnGAhMHhywUTR9JwmhAHEUVI81IEMR9Rhr+4CLzGw9ESBoGt2oYEY+jXkC7FCOlpba5P7pP3EhQTlJXUg5djlQfI5Zcp5XRIdRajyN4ddA2y1bVGgPOEjsnZZCj3ja/3E6IY04ChRmSsmVbkfISJBTFjKQlN5YkQniAeqSlaYA4kV4yfiiFe1rpwG4odAUKjtXfEwniUg65rzuze+W0l4n/ea1YdU+9hAZRrEiAJ4u6MYMqhFk6sEMFwYoNNUFYUH0rxH0kEFY6w5IOwZ5+eZY4R9WzqnVzXK6d52kUwQ7YBRVggxNQA5egDhyAwSN4Bq/gzXgyXox342PSWjDymW3wB8bnD54+nHs=&lt;/latexit&gt;</p>
    <p>We define approximations q(z|x) and q(x|z) via inference and generative networks, parameterized by  and , respectively.</p>
    <p>Dinghan Shen et al. NASH for fast similarity search July 17, 2018 4 / 17</p>
  </div>
  <div class="page">
    <p>Framework components Training with Binary Latent Variables</p>
    <p>The generative term provides a natural training objective for semantic hashing: with the decoder network modeling p(x|z), the key semantic information from x is naturally encapsulated.</p>
    <p>To tailor the NVI framework for semantic hashing, we cast z as a binary latent variable and assume a multivariate Bernoulli prior on z:</p>
    <p>z : p(z)  Bernoulli() = l</p>
    <p>i=1</p>
    <p>zi i (1 i )</p>
    <p>The encoding (approximate posterior) distribution q(z|x) is restricted to take the form q(z|x) = Bernoulli(h), where h is inferred from x with the encoder network.</p>
    <p>Dinghan Shen et al. NASH for fast similarity search July 17, 2018 5 / 17</p>
  </div>
  <div class="page">
    <p>Framework components Training with Binary Latent Variables</p>
    <p>We can obtain samples from the Bernoulli posterior either deterministically or stochastically:</p>
    <p>Suppose z is a l-bit hash code, the deterministic binarization is defined as (for i = 1, 2, ......, l):</p>
    <p>zi = 1(g i  (x))&gt;0.5 =</p>
    <p>sign((g i(x)  0.5) + 1 2</p>
    <p>(2)</p>
    <p>stochastic binarization (where i  Uniform(0, 1)):</p>
    <p>zi = 1(g i  (x))&gt;i</p>
    <p>= sign((g i(x)) i ) + 1</p>
    <p>Dinghan Shen et al. NASH for fast similarity search July 17, 2018 6 / 17</p>
  </div>
  <div class="page">
    <p>Framework components Training with Binary Latent Variables</p>
    <p>To estimate the parameters of the encoder and decoder networks, we maximize a variational lower bound:</p>
    <p>Lvae = Eq(z|x) [</p>
    <p>log q(x|z)p(z) q(z|x)</p>
    <p>] ,</p>
    <p>= Eq(z|x)[log q(x|z)] DKL(q(z|x)||p(z)), (4)</p>
    <p>The KL-divergence DKL(q(z|x)||p(z)) encourages the approximate posterior q(z|x) to be close to the multivariate Bernoulli prior p(z);</p>
    <p>DKL(q(z|x)||p(z)) can be written in closed-form.</p>
    <p>Dinghan Shen et al. NASH for fast similarity search July 17, 2018 7 / 17</p>
  </div>
  <div class="page">
    <p>Framework components Training with Binary Latent Variables</p>
    <p>It is challenging to backpropagate gradients through the discrete (binary) latent variable, since the derivative of the sign function is zero for almost all input values;</p>
    <p>Instead, we utilize the straight-through (ST) estimator, which was first introduced by [Hinton (2012)]. It simply backpropagates through the hard threshold by approximating the gradient z/(g i(x)) as 1:</p>
    <p>dEq(z|x)[log q(x|z)]</p>
    <p>= dEq(z|x)[log q(x|z)]</p>
    <p>dz</p>
    <p>dz</p>
    <p>d(g i(x))</p>
    <p>d(g i(x))</p>
    <p>d</p>
    <p>dEq(z|x)[log q(x|z)]</p>
    <p>dz</p>
    <p>d(g i(x))</p>
    <p>d (5)</p>
    <p>Dinghan Shen et al. NASH for fast similarity search July 17, 2018 8 / 17</p>
  </div>
  <div class="page">
    <p>Framework components Injecting Data-dependent Noise to z</p>
    <p>We found that injecting random Gaussian noise into z makes the decoder a more favorable regularizer for the binary codes;</p>
    <p>g(x) &lt;latexit sha1_base64=&quot;4gsoFBpBBAbmyfn2ZeNA3fTqK6U=&quot;&gt;AAAB73icbVBNTwIxEJ3FL8Qv1KOXRmKCF7JrSNQb0YtHTFzBwIZ0Sxca2u6m7RrJhl/hxYMar/4db/4bC+xBwZdM8vLeTGbmhQln2rjut1NYWV1b3yhulra2d3b3yvsH9zpOFaE+iXms2iHWlDNJfcMMp+1EUSxCTlvh6Hrqtx6p0iyWd2ac0EDggWQRI9hY6WHQ6yZDVn067ZUrbs2dAS0TLycVyNHslb+6/ZikgkpDONa647mJCTKsDCOcTkrdVNMEkxEe0I6lEguqg2x28ASdWKWPoljZkgbN1N8TGRZaj0VoOwU2Q73oTcX/vE5qoosgYzJJDZVkvihKOTIxmn6P+kxRYvjYEkwUs7ciMsQKE2MzKtkQvMWXl4l/Vrusubf1SuMqT6MIR3AMVfDgHBpwA03wgYCAZ3iFN0c5L8678zFvLTj5zCH8gfP5A5/Qj9M=&lt;/latexit&gt;&lt;latexit sha1_base64=&quot;4gsoFBpBBAbmyfn2ZeNA3fTqK6U=&quot;&gt;AAAB73icbVBNTwIxEJ3FL8Qv1KOXRmKCF7JrSNQb0YtHTFzBwIZ0Sxca2u6m7RrJhl/hxYMar/4db/4bC+xBwZdM8vLeTGbmhQln2rjut1NYWV1b3yhulra2d3b3yvsH9zpOFaE+iXms2iHWlDNJfcMMp+1EUSxCTlvh6Hrqtx6p0iyWd2ac0EDggWQRI9hY6WHQ6yZDVn067ZUrbs2dAS0TLycVyNHslb+6/ZikgkpDONa647mJCTKsDCOcTkrdVNMEkxEe0I6lEguqg2x28ASdWKWPoljZkgbN1N8TGRZaj0VoOwU2Q73oTcX/vE5qoosgYzJJDZVkvihKOTIxmn6P+kxRYvjYEkwUs7ciMsQKE2MzKtkQvMWXl4l/Vrusubf1SuMqT6MIR3AMVfDgHBpwA03wgYCAZ3iFN0c5L8678zFvLTj5zCH8gfP5A5/Qj9M=&lt;/latexit&gt;&lt;latexit sha1_base64=&quot;4gsoFBpBBAbmyfn2ZeNA3fTqK6U=&quot;&gt;AAAB73icbVBNTwIxEJ3FL8Qv1KOXRmKCF7JrSNQb0YtHTFzBwIZ0Sxca2u6m7RrJhl/hxYMar/4db/4bC+xBwZdM8vLeTGbmhQln2rjut1NYWV1b3yhulra2d3b3yvsH9zpOFaE+iXms2iHWlDNJfcMMp+1EUSxCTlvh6Hrqtx6p0iyWd2ac0EDggWQRI9hY6WHQ6yZDVn067ZUrbs2dAS0TLycVyNHslb+6/ZikgkpDONa647mJCTKsDCOcTkrdVNMEkxEe0I6lEguqg2x28ASdWKWPoljZkgbN1N8TGRZaj0VoOwU2Q73oTcX/vE5qoosgYzJJDZVkvihKOTIxmn6P+kxRYvjYEkwUs7ciMsQKE2MzKtkQvMWXl4l/Vrusubf1SuMqT6MIR3AMVfDgHBpwA03wgYCAZ3iFN0c5L8678zFvLTj5zCH8gfP5A5/Qj9M=&lt;/latexit&gt;</p>
    <p>z &lt;latexit sha1_base64=&quot;WIlbTbBFLLcqOvt81zBc03GagJU=&quot;&gt;AAAB53icbVBNS8NAEJ3Ur1q/qh69LBbBU0lFUG9FLx5bMLbQhrLZTtq1m03Y3Qg19Bd48aDi1b/kzX/jts1BWx8MPN6bYWZekAiujet+O4WV1bX1jeJmaWt7Z3evvH9wr+NUMfRYLGLVDqhGwSV6hhuB7UQhjQKBrWB0M/Vbj6g0j+WdGSfoR3QgecgZNVZqPvXKFbfqzkCWSS0nFcjR6JW/uv2YpRFKwwTVulNzE+NnVBnOBE5K3VRjQtmIDrBjqaQRaj+bHTohJ1bpkzBWtqQhM/X3REYjrcdRYDsjaoZ60ZuK/3md1ISXfsZlkhqUbL4oTAUxMZl+TfpcITNibAllittbCRtSRZmx2ZRsCLXFl5eJd1a9qrrN80r9Ok+jCEdwDKdQgwuowy00wAMGCM/wCm/Og/PivDsf89aCk88cwh84nz9XU4zR&lt;/latexit&gt;&lt;latexit sha1_base64=&quot;WIlbTbBFLLcqOvt81zBc03GagJU=&quot;&gt;AAAB53icbVBNS8NAEJ3Ur1q/qh69LBbBU0lFUG9FLx5bMLbQhrLZTtq1m03Y3Qg19Bd48aDi1b/kzX/jts1BWx8MPN6bYWZekAiujet+O4WV1bX1jeJmaWt7Z3evvH9wr+NUMfRYLGLVDqhGwSV6hhuB7UQhjQKBrWB0M/Vbj6g0j+WdGSfoR3QgecgZNVZqPvXKFbfqzkCWSS0nFcjR6JW/uv2YpRFKwwTVulNzE+NnVBnOBE5K3VRjQtmIDrBjqaQRaj+bHTohJ1bpkzBWtqQhM/X3REYjrcdRYDsjaoZ60ZuK/3md1ISXfsZlkhqUbL4oTAUxMZl+TfpcITNibAllittbCRtSRZmx2ZRsCLXFl5eJd1a9qrrN80r9Ok+jCEdwDKdQgwuowy00wAMGCM/wCm/Og/PivDsf89aCk88cwh84nz9XU4zR&lt;/latexit&gt;&lt;latexit sha1_base64=&quot;WIlbTbBFLLcqOvt81zBc03GagJU=&quot;&gt;AAAB53icbVBNS8NAEJ3Ur1q/qh69LBbBU0lFUG9FLx5bMLbQhrLZTtq1m03Y3Qg19Bd48aDi1b/kzX/jts1BWx8MPN6bYWZekAiujet+O4WV1bX1jeJmaWt7Z3evvH9wr+NUMfRYLGLVDqhGwSV6hhuB7UQhjQKBrWB0M/Vbj6g0j+WdGSfoR3QgecgZNVZqPvXKFbfqzkCWSS0nFcjR6JW/uv2YpRFKwwTVulNzE+NnVBnOBE5K3VRjQtmIDrBjqaQRaj+bHTohJ1bpkzBWtqQhM/X3REYjrcdRYDsjaoZ60ZuK/3md1ISXfsZlkhqUbL4oTAUxMZl+TfpcITNibAllittbCRtSRZmx2ZRsCLXFl5eJd1a9qrrN80r9Ok+jCEdwDKdQgwuowy00wAMGCM/wCm/Og/PivDsf89aCk88cwh84nz9XU4zR&lt;/latexit&gt;</p>
    <p>x &lt;latexit sha1_base64=&quot;9fy0Mz7X/Akugg6I9ARal+HBkn4=&quot;&gt;AAAB7XicbVBNS8NAEJ3Ur1q/qh69LBbBU0lEUG9FLx4rGFtoQ9lsN+3SzSbsTsQS+iO8eFDx6v/x5r9x2+agrQ8GHu/NMDMvTKUw6LrfTmlldW19o7xZ2dre2d2r7h88mCTTjPsskYluh9RwKRT3UaDk7VRzGoeSt8LRzdRvPXJtRKLucZzyIKYDJSLBKFqp1R1SzJ8mvWrNrbszkGXiFaQGBZq96le3n7As5gqZpMZ0PDfFIKcaBZN8UulmhqeUjeiAdyxVNOYmyGfnTsiJVfokSrQthWSm/p7IaWzMOA5tZ0xxaBa9qfif18kwugxyodIMuWLzRVEmCSZk+jvpC80ZyrEllGlhbyVsSDVlaBOq2BC8xZeXiX9Wv6q7d+e1xnWRRhmO4BhOwYMLaMAtNMEHBiN4hld4c1LnxXl3PuatJaeYOYQ/cD5/ABu5j5w=&lt;/latexit&gt;&lt;latexit sha1_base64=&quot;9fy0Mz7X/Akugg6I9ARal+HBkn4=&quot;&gt;AAAB7XicbVBNS8NAEJ3Ur1q/qh69LBbBU0lEUG9FLx4rGFtoQ9lsN+3SzSbsTsQS+iO8eFDx6v/x5r9x2+agrQ8GHu/NMDMvTKUw6LrfTmlldW19o7xZ2dre2d2r7h88mCTTjPsskYluh9RwKRT3UaDk7VRzGoeSt8LRzdRvPXJtRKLucZzyIKYDJSLBKFqp1R1SzJ8mvWrNrbszkGXiFaQGBZq96le3n7As5gqZpMZ0PDfFIKcaBZN8UulmhqeUjeiAdyxVNOYmyGfnTsiJVfokSrQthWSm/p7IaWzMOA5tZ0xxaBa9qfif18kwugxyodIMuWLzRVEmCSZk+jvpC80ZyrEllGlhbyVsSDVlaBOq2BC8xZeXiX9Wv6q7d+e1xnWRRhmO4BhOwYMLaMAtNMEHBiN4hld4c1LnxXl3PuatJaeYOYQ/cD5/ABu5j5w=&lt;/latexit&gt;&lt;latexit sha1_base64=&quot;9fy0Mz7X/Akugg6I9ARal+HBkn4=&quot;&gt;AAAB7XicbVBNS8NAEJ3Ur1q/qh69LBbBU0lEUG9FLx4rGFtoQ9lsN+3SzSbsTsQS+iO8eFDx6v/x5r9x2+agrQ8GHu/NMDMvTKUw6LrfTmlldW19o7xZ2dre2d2r7h88mCTTjPsskYluh9RwKRT3UaDk7VRzGoeSt8LRzdRvPXJtRKLucZzyIKYDJSLBKFqp1R1SzJ8mvWrNrbszkGXiFaQGBZq96le3n7As5gqZpMZ0PDfFIKcaBZN8UulmhqeUjeiAdyxVNOYmyGfnTsiJVfokSrQthWSm/p7IaWzMOA5tZ0xxaBa9qfif18kwugxyodIMuWLzRVEmCSZk+jvpC80ZyrEllGlhbyVsSDVlaBOq2BC8xZeXiX9Wv6q7d+e1xnWRRhmO4BhOwYMLaMAtNMEHBiN4hld4c1LnxXl3PuatJaeYOYQ/cD5/ABu5j5w=&lt;/latexit&gt;</p>
    <p>x &lt;latexit sha1_base64=&quot;wrYRrS9nqr2/jTKdHNfdRLtLB0k=&quot;&gt;AAAB53icbVBNS8NAEJ3Ur1q/qh69LBbBU0lFUG9FLx5bMLbQhrLZTtq1m03Y3Ygl9Bd48aDi1b/kzX/jts1BWx8MPN6bYWZekAiujet+O4WV1bX1jeJmaWt7Z3evvH9wr+NUMfRYLGLVDqhGwSV6hhuB7UQhjQKBrWB0M/Vbj6g0j+WdGSfoR3QgecgZNVZqPvXKFbfqzkCWSS0nFcjR6JW/uv2YpRFKwwTVulNzE+NnVBnOBE5K3VRjQtmIDrBjqaQRaj+bHTohJ1bpkzBWtqQhM/X3REYjrcdRYDsjaoZ60ZuK/3md1ISXfsZlkhqUbL4oTAUxMZl+TfpcITNibAllittbCRtSRZmx2ZRsCLXFl5eJd1a9qrrN80r9Ok+jCEdwDKdQgwuowy00wAMGCM/wCm/Og/PivDsf89aCk88cwh84nz9UTYzP&lt;/latexit&gt;&lt;latexit sha1_base64=&quot;wrYRrS9nqr2/jTKdHNfdRLtLB0k=&quot;&gt;AAAB53icbVBNS8NAEJ3Ur1q/qh69LBbBU0lFUG9FLx5bMLbQhrLZTtq1m03Y3Ygl9Bd48aDi1b/kzX/jts1BWx8MPN6bYWZekAiujet+O4WV1bX1jeJmaWt7Z3evvH9wr+NUMfRYLGLVDqhGwSV6hhuB7UQhjQKBrWB0M/Vbj6g0j+WdGSfoR3QgecgZNVZqPvXKFbfqzkCWSS0nFcjR6JW/uv2YpRFKwwTVulNzE+NnVBnOBE5K3VRjQtmIDrBjqaQRaj+bHTohJ1bpkzBWtqQhM/X3REYjrcdRYDsjaoZ60ZuK/3md1ISXfsZlkhqUbL4oTAUxMZl+TfpcITNibAllittbCRtSRZmx2ZRsCLXFl5eJd1a9qrrN80r9Ok+jCEdwDKdQgwuowy00wAMGCM/wCm/Og/PivDsf89aCk88cwh84nz9UTYzP&lt;/latexit&gt;&lt;latexit sha1_base64=&quot;wrYRrS9nqr2/jTKdHNfdRLtLB0k=&quot;&gt;AAAB53icbVBNS8NAEJ3Ur1q/qh69LBbBU0lFUG9FLx5bMLbQhrLZTtq1m03Y3Ygl9Bd48aDi1b/kzX/jts1BWx8MPN6bYWZekAiujet+O4WV1bX1jeJmaWt7Z3evvH9wr+NUMfRYLGLVDqhGwSV6hhuB7UQhjQKBrWB0M/Vbj6g0j+WdGSfoR3QgecgZNVZqPvXKFbfqzkCWSS0nFcjR6JW/uv2YpRFKwwTVulNzE+NnVBnOBE5K3VRjQtmIDrBjqaQRaj+bHTohJ1bpkzBWtqQhM/X3REYjrcdRYDsjaoZ60ZuK/3md1ISXfsZlkhqUbL4oTAUxMZl+TfpcITNibAllittbCRtSRZmx2ZRsCLXFl5eJd1a9qrrN80r9Ok+jCEdwDKdQgwuowy00wAMGCM/wCm/Og/PivDsf89aCk88cwh84nz9UTYzP&lt;/latexit&gt; log 2</p>
    <p>&lt;latexit sha1_base64=&quot;7fXReuSi2AGXHQbFX8oagcVUXco=&quot;&gt;AAAB83icbVBNS8NAEJ34WetX1aOXxSJ4KkkR1FvRi8cKxhaaWDbbTbp0Nxt3N4VS+ju8eFDx6p/x5r9x2+agrQ8GHu/NMDMvyjjTxnW/nZXVtfWNzdJWeXtnd2+/cnD4oGWuCPWJ5FK1I6wpZyn1DTOctjNFsYg4bUWDm6nfGlKlmUzvzSijocBJymJGsLFSGHCZoECzRODHerdSdWvuDGiZeAWpQoFmt/IV9CTJBU0N4VjrjudmJhxjZRjhdFIOck0zTAY4oR1LUyyoDsezoyfo1Co9FEtlKzVopv6eGGOh9UhEtlNg09eL3lT8z+vkJr4MxyzNckNTMl8U5xwZiaYJoB5TlBg+sgQTxeytiPSxwsTYnMo2BG/x5WXi12tXNffuvNq4LtIowTGcwBl4cAENuIUm+EDgCZ7hFd6cofPivDsf89YVp5g5gj9wPn8AnmWRig==&lt;/latexit&gt;&lt;latexit sha1_base64=&quot;7fXReuSi2AGXHQbFX8oagcVUXco=&quot;&gt;AAAB83icbVBNS8NAEJ34WetX1aOXxSJ4KkkR1FvRi8cKxhaaWDbbTbp0Nxt3N4VS+ju8eFDx6p/x5r9x2+agrQ8GHu/NMDMvyjjTxnW/nZXVtfWNzdJWeXtnd2+/cnD4oGWuCPWJ5FK1I6wpZyn1DTOctjNFsYg4bUWDm6nfGlKlmUzvzSijocBJymJGsLFSGHCZoECzRODHerdSdWvuDGiZeAWpQoFmt/IV9CTJBU0N4VjrjudmJhxjZRjhdFIOck0zTAY4oR1LUyyoDsezoyfo1Co9FEtlKzVopv6eGGOh9UhEtlNg09eL3lT8z+vkJr4MxyzNckNTMl8U5xwZiaYJoB5TlBg+sgQTxeytiPSxwsTYnMo2BG/x5WXi12tXNffuvNq4LtIowTGcwBl4cAENuIUm+EDgCZ7hFd6cofPivDsf89YVp5g5gj9wPn8AnmWRig==&lt;/latexit&gt;&lt;latexit sha1_base64=&quot;7fXReuSi2AGXHQbFX8oagcVUXco=&quot;&gt;AAAB83icbVBNS8NAEJ34WetX1aOXxSJ4KkkR1FvRi8cKxhaaWDbbTbp0Nxt3N4VS+ju8eFDx6p/x5r9x2+agrQ8GHu/NMDMvyjjTxnW/nZXVtfWNzdJWeXtnd2+/cnD4oGWuCPWJ5FK1I6wpZyn1DTOctjNFsYg4bUWDm6nfGlKlmUzvzSijocBJymJGsLFSGHCZoECzRODHerdSdWvuDGiZeAWpQoFmt/IV9CTJBU0N4VjrjudmJhxjZRjhdFIOck0zTAY4oR1LUyyoDsezoyfo1Co9FEtlKzVopv6eGGOh9UhEtlNg09eL3lT8z+vkJr4MxyzNckNTMl8U5xwZiaYJoB5TlBg+sgQTxeytiPSxwsTYnMo2BG/x5WXi12tXNffuvNq4LtIowTGcwBl4cAENuIUm+EDgCZ7hFd6cofPivDsf89YVp5g5gj9wPn8AnmWRig==&lt;/latexit&gt;</p>
    <p>MLP z0  N (z, I)</p>
    <p>&lt;latexit sha1_base64=&quot;oL/kS60CrA7r8ceuyOQmklSUP/Y=&quot;&gt;AAACD3icbVBNS8NAEN3Ur1q/oh69LBaxgpREBPVW9KIXqWBsoYlls922S3eTsLsR2pCf4MW/4sWDilev3vw3btoctPXBwOO9GWbm+RGjUlnWt1GYm19YXCoul1ZW19Y3zM2tOxnGAhMHhywUTR9JwmhAHEUVI81IEMR9Rhr+4CLzGw9ESBoGt2oYEY+jXkC7FCOlpba5P7pP3EhQTlJXUg5djlQfI5Zcp5XRIdRajyN4ddA2y1bVGgPOEjsnZZCj3ja/3E6IY04ChRmSsmVbkfISJBTFjKQlN5YkQniAeqSlaYA4kV4yfiiFe1rpwG4odAUKjtXfEwniUg65rzuze+W0l4n/ea1YdU+9hAZRrEiAJ4u6MYMqhFk6sEMFwYoNNUFYUH0rxH0kEFY6w5IOwZ5+eZY4R9WzqnVzXK6d52kUwQ7YBRVggxNQA5egDhyAwSN4Bq/gzXgyXox342PSWjDymW3wB8bnD54+nHs=&lt;/latexit&gt;&lt;latexit sha1_base64=&quot;oL/kS60CrA7r8ceuyOQmklSUP/Y=&quot;&gt;AAACD3icbVBNS8NAEN3Ur1q/oh69LBaxgpREBPVW9KIXqWBsoYlls922S3eTsLsR2pCf4MW/4sWDilev3vw3btoctPXBwOO9GWbm+RGjUlnWt1GYm19YXCoul1ZW19Y3zM2tOxnGAhMHhywUTR9JwmhAHEUVI81IEMR9Rhr+4CLzGw9ESBoGt2oYEY+jXkC7FCOlpba5P7pP3EhQTlJXUg5djlQfI5Zcp5XRIdRajyN4ddA2y1bVGgPOEjsnZZCj3ja/3E6IY04ChRmSsmVbkfISJBTFjKQlN5YkQniAeqSlaYA4kV4yfiiFe1rpwG4odAUKjtXfEwniUg65rzuze+W0l4n/ea1YdU+9hAZRrEiAJ4u6MYMqhFk6sEMFwYoNNUFYUH0rxH0kEFY6w5IOwZ5+eZY4R9WzqnVzXK6d52kUwQ7YBRVggxNQA5egDhyAwSN4Bq/gzXgyXox342PSWjDymW3wB8bnD54+nHs=&lt;/latexit&gt;&lt;latexit sha1_base64=&quot;oL/kS60CrA7r8ceuyOQmklSUP/Y=&quot;&gt;AAACD3icbVBNS8NAEN3Ur1q/oh69LBaxgpREBPVW9KIXqWBsoYlls922S3eTsLsR2pCf4MW/4sWDilev3vw3btoctPXBwOO9GWbm+RGjUlnWt1GYm19YXCoul1ZW19Y3zM2tOxnGAhMHhywUTR9JwmhAHEUVI81IEMR9Rhr+4CLzGw9ESBoGt2oYEY+jXkC7FCOlpba5P7pP3EhQTlJXUg5djlQfI5Zcp5XRIdRajyN4ddA2y1bVGgPOEjsnZZCj3ja/3E6IY04ChRmSsmVbkfISJBTFjKQlN5YkQniAeqSlaYA4kV4yfiiFe1rpwG4odAUKjtXfEwniUg65rzuze+W0l4n/ea1YdU+9hAZRrEiAJ4u6MYMqhFk6sEMFwYoNNUFYUH0rxH0kEFY6w5IOwZ5+eZY4R9WzqnVzXK6d52kUwQ7YBRVggxNQA5egDhyAwSN4Bq/gzXgyXox342PSWjDymW3wB8bnD54+nHs=&lt;/latexit&gt;</p>
    <p>The objective function in (4) can be written in a form similar to the rate-distortion tradeoff:</p>
    <p>min Eq(z|x)</p>
    <p>log q(z|x)</p>
    <p>Rate</p>
    <p>+ 1</p>
    <p>||x Ez||22   Distortion</p>
    <p>+C</p>
    <p>, (6)</p>
    <p>Dinghan Shen et al. NASH for fast similarity search July 17, 2018 9 / 17</p>
  </div>
  <div class="page">
    <p>Framework components Extension to Supervised Hashing</p>
    <p>While labeled data are available, we can explicitly learn a mapping from latent variable z to labels y, here parametrized by a two-layer MLP followed by a fully-connected softmax layer.</p>
    <p>As a result, the loss function is a combination of variational lower bound and discriminative (cross-entropy) loss:</p>
    <p>L = Lvae(,; x) + Ldis(; z,y). (7)</p>
    <p>Dinghan Shen et al. NASH for fast similarity search July 17, 2018 10 / 17</p>
  </div>
  <div class="page">
    <p>Experiments Datasets &amp; Experimental Setup</p>
    <p>Datasets: we evaluate the proposed method on three benchmarks: Reuters21578, 20Newsgroups, TMC (SIAM text mining competition);</p>
    <p>TFIDF features are utilized as the input x for documents;</p>
    <p>we set the dimension of z, i.e., the number of bits within the hashing code, as 8, 16, 32, 64, or 128;</p>
    <p>We employed precision as the evaluation metric: the percentage of documents among the top 100 retrieved ones that belong to the same label (topic) with the query document.</p>
    <p>Dinghan Shen et al. NASH for fast similarity search July 17, 2018 11 / 17</p>
  </div>
  <div class="page">
    <p>Experiments Semantic Hashing Evaluation</p>
    <p>Table: Precision of the top 100 retrieved documents on Reuters dataset (Unsupervised hashing).</p>
    <p>Figure: Precision of the top 100 retrieved documents on Reuters dataset (Supervised hashing).</p>
    <p>Fast similarity search:</p>
    <p>Consistently outperform several strong baseline methods;</p>
    <p>Enjoy the attractive property of end-to-end training;</p>
    <p>Same observations on other benchmarks.</p>
    <p>Dinghan Shen et al. NASH for fast similarity search July 17, 2018 12 / 17</p>
  </div>
  <div class="page">
    <p>Experiments Ablation study</p>
    <p>Figure: The precisions of the top 100 retrieved documents for NASH-DN with stochastic or deterministic binary latent variables.</p>
    <p>Table: Ablation study with different encoder/decoder networks.</p>
    <p>Leveraging stochastically sampling during training generalizes better;</p>
    <p>Linear decoder networks gives rise to better empirical results.</p>
    <p>Dinghan Shen et al. NASH for fast similarity search July 17, 2018 13 / 17</p>
  </div>
  <div class="page">
    <p>Experiments Qualitative Analysis</p>
    <p>Figure: Examples of learned compact hashing codes on 20Newsgroups dataset.</p>
    <p>NASH typically compresses documents with shared topics into very similar binary codes.</p>
    <p>Dinghan Shen et al. NASH for fast similarity search July 17, 2018 14 / 17</p>
  </div>
  <div class="page">
    <p>Conclusions Take away</p>
    <p>This paper presents a first step towards end-to-end semantic hashing;</p>
    <p>A neural variational framework is introduced to optimize the hash function during training;</p>
    <p>The connections between the proposed method and rate-distortion theory are established.</p>
    <p>Dinghan Shen et al. NASH for fast similarity search July 17, 2018 15 / 17</p>
  </div>
  <div class="page">
    <p>Dinghan Shen et al. NASH for fast similarity search July 17, 2018 16 / 17</p>
  </div>
  <div class="page">
    <p>References</p>
    <p>Distributed Representations of Sentences and Documents ICML 2014;</p>
    <p>Skip-thought vectors NIPS 2015;</p>
    <p>Supervised Learning of Universal Sentence Representations from Natural Language Inference Data EMNLP 2017;</p>
    <p>Geoffrey Hinton. 2012. Neural networks for ma- chine learning, coursera. URL: http://coursera. org/course/neuralnets;</p>
    <p>Dinghan Shen et al. NASH for fast similarity search July 17, 2018 17 / 17</p>
  </div>
</Presentation>
