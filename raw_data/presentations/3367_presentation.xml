<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Detecting Credential Spearphishing Attacks in Enterprise Settings</p>
    <p>Grant Ho UC Berkeley</p>
    <p>Aashish Sharma, Mobin Javed, Vern Paxson, David Wagner</p>
  </div>
  <div class="page">
    <p>Spear Phishing Targeted email that tricks victim into giving attacker privileged capabilities</p>
  </div>
  <div class="page">
    <p>Our Focus: Enterprise Credential Spearphishing</p>
    <p>Credentials are king - Rob Joyce, Director of NSAs Tailored Access Operations</p>
    <p>Wealth of access &amp; lower barrier than 0-day malicious attachments</p>
    <p>What about 2FA?  Cost, usability , incomplete deployment, often still phish-able</p>
    <p>Detection today: user reporting, phish-able 2FA, post-mortem forensics 3</p>
  </div>
  <div class="page">
    <p>Our Work</p>
    <p>Practical detection system for an enterprises security team</p>
  </div>
  <div class="page">
    <p>Our Work</p>
    <p>Worked with the Lawrence Berkeley National Laboratory (LBL)  US DoE National Lab w/ 5,000 employees</p>
    <p>Anonymized datasets:  SMTP header information (From and RCPT-TO headers)  URLs in emails  Network traffic logs  LDAP logs</p>
  </div>
  <div class="page">
    <p>Key Challenges</p>
  </div>
  <div class="page">
    <p>Structure-Driven Features</p>
  </div>
  <div class="page">
    <p>Spearphishing Attack Taxonomy  Successful spearphishing attacks have two necessary stages:</p>
  </div>
  <div class="page">
    <p>Spearphishing Attack Taxonomy  Successful spearphishing attacks have two necessary stages:</p>
  </div>
  <div class="page"/>
  <div class="page">
    <p>Lure 1. Attacker sends catchy email under trusted/authoritative identity</p>
    <p>Modern Credential Spearphishing: The Lure</p>
    <p>From: Berkeley IT Staff &lt;security@berkeley.net&gt;</p>
  </div>
  <div class="page">
    <p>Exploit 1. Victim clicks on embedded link 2. Victim arrives at phishing website &amp; submits credentials</p>
    <p>Modern Credential Spearphishing: The Exploit</p>
    <p>Actual Destination for linked text: auth.berkeley.netne.net</p>
  </div>
  <div class="page">
    <p>Lure Features: Suspicious Sender Present</p>
    <p>Common lure: impersonate a trusted or authoritative entity</p>
    <p>Four impersonation classes - each has own set of lure features 1. Name spoofing attacker 2. Address spoofing attacker 3. Previously unseen attacker 4. Lateral attacker</p>
    <p>This talk: lateral attackers</p>
  </div>
  <div class="page">
    <p>Lure Features (Cont.): Suspicious Sender Present</p>
    <p>Lateral spearphishing lure: attacker compromises trusted entitys account</p>
    <p>Feature intuition: email = suspicious if employee sent it during a suspicious login session</p>
    <p>Lure features for lateral spearphishing:  was email sent in a session where sender logged in w/ new IP address?  # prior logins by the sender from the geolocated city of login IP addr  # of other employees whove also logged in from city of login IP addr</p>
  </div>
  <div class="page">
    <p>Exploit Features: Suspicious Action Occurred</p>
    <p>Winnow pool of candidate alerts to: Emails where recipient clicked on embedded URL (a click-in-email action)</p>
    <p>Exploit features: URLs Fully-qualified domain (hostname) is suspicious  # of prior visits to FQDN across all enterprises network traffic  # of days between 1st employees visit to FQDN &amp; current emails arrival</p>
  </div>
  <div class="page">
    <p>Using Features for Detection</p>
  </div>
  <div class="page">
    <p>How do we leverage our features?  Combine lure + exploit features to get FVs for emails</p>
    <p>How do we use these features for detecting attacks?</p>
    <p>Approach 1: Manual rules  Problems: soundly choosing thresholds &amp; generalizability Approach 2: Supervised ML  Problems: tiny # of labeled attacks and base rate</p>
  </div>
  <div class="page">
    <p>Limitations of Standard Techniques Approach 3: Unsupervised learning/anomaly detection</p>
    <p>Clustering/Distance Based: kNN  Density-based: KDE, GMM  Many others...</p>
    <p>Three common problems: 1. Require hyperparameter tuning</p>
  </div>
  <div class="page">
    <p>Classical Anomaly Detection: Limitations Three thematic problems: 1. Parametric and/or</p>
    <p>hyperparameter tuning 2. Direction-agnostic</p>
    <p>(standard dev of +3 just as anomalous as -3)</p>
    <p>Feature: # prior logins by current employee from</p>
    <p>city of new IP addr</p>
    <p>Mean</p>
  </div>
  <div class="page">
    <p>Classical Anomaly Detection: Limitations Three thematic problems: 1. Parametric and/or</p>
    <p>hyperparameter tuning 2. Direction-agnostic 3. Alert if anomalous in</p>
    <p>only one dimension</p>
    <p>M O R E</p>
    <p>B E N I G N</p>
    <p>MORE BENIGN</p>
  </div>
  <div class="page">
    <p>Classical Anomaly Detection: Limitations Three thematic problems: 1. Parametric and/or</p>
    <p>hyperparameter tuning 2. Direction-agonistic 3. Alert if anomalous in only</p>
    <p>one dimension</p>
    <p>DAS: simple, new method that overcomes these 3 problems</p>
    <p>M O R E</p>
    <p>B E N I G N</p>
    <p>MORE BENIGN</p>
  </div>
  <div class="page">
    <p>DAS: Directed Anomaly Scoring</p>
  </div>
  <div class="page">
    <p>DAS: Directed Anomaly Scoring  Score(Event X) = # of other events that are as benign as X in every dimension</p>
    <p>i.e., Large score = many other events are more benign than X</p>
    <p>M O R E</p>
    <p>B E N I G N</p>
    <p>MORE BENIGN</p>
  </div>
  <div class="page">
    <p>DAS: Directed Anomaly Scoring  Score(Event X) = # of other events that are as benign as X in every dimension</p>
    <p>M O R E</p>
    <p>B E N I G N</p>
    <p>MORE BENIGN</p>
    <p>D</p>
    <p>A</p>
    <p>B C</p>
  </div>
  <div class="page">
    <p>DAS: Directed Anomaly Scoring  Score(Event X) = # of other events that are as benign as X in every dimension</p>
    <p>M O R E</p>
    <p>B E N I G N</p>
    <p>MORE BENIGN</p>
    <p>A</p>
    <p>B</p>
  </div>
  <div class="page">
    <p>Detection Results</p>
    <p>Real-time detector on 370 million emails over ~4 years</p>
    <p>Ran detector w/ total budget of 10 alerts/day  Practical for LBLs security team (~240 alerts/day typical)</p>
    <p>Detected 17 / 19 spearphishing attacks (89% TP)  2 / 17 detected attacks were previously undiscovered</p>
    <p>Best classical anomaly detection: 4/19 attacks for same budget  Need budget &gt;= 91 alerts/day to detect same # of attacks as DAS</p>
  </div>
  <div class="page">
    <p>Results: Cost of False Positives  10 alarms / day: How much time does this cost the security team?</p>
    <p>LBLs security staff manually investigated all our alerts  24 alerts / minute (avg rate for one analyst)  &lt; 15 minutes for 1 analyst to investigate alerts from an entire month</p>
    <p>Subject + URL + From: = quick semantic filter  Never Lose Your Keys, Wallet, or Purse Again!  Invitation to Speak at Summit for Energy...</p>
  </div>
  <div class="page">
    <p>Conclusion  Real-time system for detecting credential spearphishing attacks</p>
    <p>TP = 89%: detects known + previously undiscovered attacks  FP = 0.004%: 10 alerts / day (alerts processed in &lt; minutes per day)</p>
    <p>Key ideas 1. Leverage lure + exploit structure of spearphishing to design features 2. DAS: unsupervised, non-parametric technique for anomaly detection</p>
    <p>grantho@cs.berkeley.edu</p>
  </div>
</Presentation>
