<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>One Car, Two Frames:</p>
    <p>Attacks on Hitag-2 RKE Systems Revisited</p>
    <p>Ryad BENADJILA1 Mathieu RENARD2</p>
    <p>Jose LOPES-ESTEVES2 Chaouki KASMI2</p>
    <p>August 15, 2017</p>
    <p>Vancouver, BC, Canada</p>
    <p>W00T17 11th USENIX Workshop on Offensive Technologies</p>
    <p>One Car, Two Frames:</p>
    <p>Attacks on Hitag-2 Remote Keyless Entry Systems Revisited</p>
  </div>
  <div class="page">
    <p>Introduction</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|Car access control</p>
    <p>Car locking systems</p>
    <p>Used to open/close a car and for anti-theft immobilizers.</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)1/24</p>
    <p>M e c h a n ic a l</p>
    <p>S m a rt -k e y</p>
    <p>R e m o te</p>
    <p>K e y le s s</p>
    <p>E n tr y</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|Car access control</p>
    <p>Car locking systems</p>
    <p>Used to open/close a car and for anti-theft immobilizers.</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)1/24</p>
    <p>M e c h a n ic a l</p>
    <p>S m a rt -k e y</p>
    <p>R e m o te</p>
    <p>K e y le s s</p>
    <p>E n tr y</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|Car access control</p>
    <p>Car locking systems</p>
    <p>Used to open/close a car and for anti-theft immobilizers.</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)1/24</p>
    <p>M e c h a n ic a l</p>
    <p>S m a rt -k e y</p>
    <p>R e m o te</p>
    <p>K e y le s s</p>
    <p>E n tr y</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|Car access control</p>
    <p>Car locking systems</p>
    <p>This talk: focus on open/close Remote Keyless Entry systems.</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)1/24</p>
    <p>M e c h a n ic a l</p>
    <p>S m a rt -k e y</p>
    <p>R e m o te</p>
    <p>K e y le s s</p>
    <p>E n tr y</p>
  </div>
  <div class="page">
    <p>Context</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|Remote Keyless Entry</p>
    <p>Remote Keyless Entry</p>
    <p>RKE:</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)2/24</p>
    <p>RADIO FRAME</p>
    <p>R E C O R D I N G</p>
    <p>RA DI O FR AM E</p>
    <p>R A D I O F R A M E</p>
    <p>RADIO FRAME</p>
    <p>RA DI O FR AM E</p>
    <p>R A D I O F R A M E</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|Remote Keyless Entry</p>
    <p>Remote Keyless Entry</p>
    <p>RKE:</p>
    <p>replaying, jamming, spoofing.</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)2/24</p>
    <p>RADIO FRAME</p>
    <p>R E C O R D I N G</p>
    <p>RA DI O FR AM E</p>
    <p>R A D I O F R A M E</p>
    <p>RADIO FRAME</p>
    <p>RA DI O FR AM E</p>
    <p>R A D I O F R A M E</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|Remote Keyless Entry</p>
    <p>Remote Keyless Entry</p>
    <p>RKE:</p>
    <p>jamming, spoofing.</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)2/24</p>
    <p>RADIO FRAME</p>
    <p>R E C O R D I N G</p>
    <p>RA DI O FR AM E</p>
    <p>R A D I O F R A M E</p>
    <p>RADIO FRAME</p>
    <p>RA DI O FR AM E</p>
    <p>R A D I O F R A M E</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|Remote Keyless Entry</p>
    <p>Remote Keyless Entry</p>
    <p>RKE:</p>
    <p>spoofing.</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)2/24</p>
    <p>RADIO FRAME</p>
    <p>R E C O R D I N G</p>
    <p>RA DI O FR AM E</p>
    <p>R A D I O F R A M E</p>
    <p>RADIO FRAME</p>
    <p>RA DI O FR AM E</p>
    <p>R A D I O F R A M E</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|Remote Keyless Entry</p>
    <p>Remote Keyless Entry</p>
    <p>RKE:</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)2/24</p>
    <p>RADIO FRAME</p>
    <p>R E C O R D I N G</p>
    <p>RA DI O FR AM E</p>
    <p>R A D I O F R A M E</p>
    <p>RADIO FRAME</p>
    <p>RA DI O FR AM E</p>
    <p>R A D I O F R A M E</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|Remote Keyless Entry</p>
    <p>Remote Keyless Entry</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)3/24</p>
    <p>KEY 1</p>
    <p>CRYPTO K1</p>
    <p>CNTR1UID1 BTN1</p>
    <p>AUTH1</p>
    <p>UID1, CNTR1, BTN1, AUTH1</p>
    <p>KEY 2</p>
    <p>CRYPTO K2</p>
    <p>CNTR2UID2 BTN2</p>
    <p>AUTH2</p>
    <p>UID2, CNTR2,</p>
    <p>BTN2, AUTH2</p>
    <p>ECU</p>
    <p>UID Key Counter Button</p>
    <p>UID1 K1 10 0,1,5,6</p>
    <p>UID2 K2 200 0,1,2</p>
    <p>. . . . . . . . . . . .</p>
    <p>UID Key Counter Button</p>
    <p>UID1 K1 11 0,1,5,6</p>
    <p>UID2 K2 200 0,1,2</p>
    <p>. . . . . . . . . . . .</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|Remote Keyless Entry</p>
    <p>Remote Keyless Entry</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)3/24</p>
    <p>KEY 1</p>
    <p>CRYPTO K1</p>
    <p>CNTR1UID1 BTN1</p>
    <p>AUTH1</p>
    <p>UID1, CNTR1, BTN1, AUTH1</p>
    <p>KEY 2</p>
    <p>CRYPTO K2</p>
    <p>CNTR2UID2 BTN2</p>
    <p>AUTH2</p>
    <p>UID2, CNTR2,</p>
    <p>BTN2, AUTH2</p>
    <p>ECU</p>
    <p>UID Key Counter Button</p>
    <p>UID1 K1 10 0,1,5,6</p>
    <p>UID2 K2 200 0,1,2</p>
    <p>. . . . . . . . . . . .</p>
    <p>UID Key Counter Button</p>
    <p>UID1 K1 11 0,1,5,6</p>
    <p>UID2 K2 200 0,1,2</p>
    <p>. . . . . . . . . . . .</p>
    <p>CRYPTOK1</p>
    <p>CNTR1UID1 BTN1</p>
    <p>AUTH ECU =?= AUTH1</p>
    <p>BTN1  {0,1,5,6} ? CNTR1  [10, 10 + ]?</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|Remote Keyless Entry</p>
    <p>Remote Keyless Entry</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)3/24</p>
    <p>KEY 1</p>
    <p>CRYPTO K1</p>
    <p>CNTR1UID1 BTN1</p>
    <p>AUTH1</p>
    <p>UID1, CNTR1, BTN1, AUTH1</p>
    <p>KEY 2</p>
    <p>CRYPTO K2</p>
    <p>CNTR2UID2 BTN2</p>
    <p>AUTH2</p>
    <p>UID2, CNTR2,</p>
    <p>BTN2, AUTH2</p>
    <p>ECU</p>
    <p>UID Key Counter Button</p>
    <p>UID1 K1 10 0,1,5,6</p>
    <p>UID2 K2 200 0,1,2</p>
    <p>. . . . . . . . . . . .</p>
    <p>UID Key Counter Button</p>
    <p>UID1 K1 11 0,1,5,6</p>
    <p>UID2 K2 200 0,1,2</p>
    <p>. . . . . . . . . . . .</p>
    <p>CRYPTOK1</p>
    <p>CNTR1UID1 BTN1</p>
    <p>AUTH ECU =?= AUTH1</p>
    <p>BTN1  {0,1,5,6} ? CNTR1  [10, 10 + ]?</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|Remote Keyless Entry</p>
    <p>USENIX 2016: attacks on RKE systems</p>
    <p>USENIX 2016 article: Lock It and Still Lose It - On the (In)Security of Automotive Remote Keyless Entry Systems.</p>
    <p>Two attacks are discussed:</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)4/24</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|Remote Keyless Entry</p>
    <p>USENIX 2016: attacks on RKE systems</p>
    <p>Goal: setup the attack targeting the PCF7946.</p>
    <p>Constraints: black-box approach.</p>
    <p>Breaking the car was not an option!  Neither invasive nor semi-invasive attacks on the PCF7946 considered.</p>
    <p>I Time and resource costly!</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)5/24</p>
  </div>
  <div class="page">
    <p>Radio signal analysis</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|PCF7946 radio frames |Demodulation |Decoding</p>
    <p>From RF signal to bits</p>
    <p>Useful information to be gathered:  Central frequency and channel bandwidth.  Modulation.  Channel encoding.  Packet format.</p>
    <p>White-box analysis:</p>
    <p>Parameter Value</p>
    <p>Working frequency ISM 433 MHz</p>
    <p>Modulation ASK/FSK</p>
    <p>Channel encoding Manchester/NRZ</p>
    <p>Packet format see USENIX 2016</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)6/24</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|PCF7946 radio frames |Demodulation |Decoding</p>
    <p>Demodulation: spectral analysis</p>
    <p>Modulation: ASK (Amplitude Shift Keying).</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)7/24</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|PCF7946 radio frames |Demodulation |Decoding</p>
    <p>Decoding</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)8/24</p>
    <p>PREAMBLE PACKET 1 PACKET 2</p>
    <p>SYNC</p>
    <p>Symbol period</p>
    <p>DATA</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|PCF7946 radio frames |Demodulation |Decoding</p>
    <p>Decoding</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)8/24</p>
    <p>PREAMBLE PACKET 1 PACKET 2</p>
    <p>SYNC</p>
    <p>Symbol period</p>
    <p>DATA</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|PCF7946 radio frames |Demodulation |Decoding</p>
    <p>Decoding</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)8/24</p>
    <p>PREAMBLE PACKET 1 PACKET 2</p>
    <p>SYNC</p>
    <p>Symbol period</p>
    <p>DATA</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|PCF7946 radio frames |Demodulation |Decoding</p>
    <p>Decoding</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)8/24</p>
    <p>PREAMBLE PACKET 1 PACKET 2</p>
    <p>SYNC</p>
    <p>Symbol period</p>
    <p>DATA</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|PCF7946 radio frames |Demodulation |Decoding</p>
    <p>Decoding</p>
    <p>Results:  Modulation: ASK.  Channel encoding: Manchester.  Observing invariants to get back to the data.  Using the checksum for sanity check.</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)8/24</p>
    <p>SYNC 0x0001 UID BTN CNTRL KS 10 CHK</p>
    <p>PREAMBLE PACKET 1 PACKET 2</p>
    <p>SYNC</p>
    <p>Symbol period</p>
    <p>DATA</p>
  </div>
  <div class="page">
    <p>Hitag-2</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|The algorithm |Attack implementation</p>
    <p>The Hitag-2 algorithm</p>
    <p>Late 90s stream cipher from Philips (NXP).</p>
    <p>Hardware reverse engineered in 2007.</p>
    <p>Using the algorithm in a RKE context:</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)9/24</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|The algorithm |Attack implementation</p>
    <p>The Hitag-2 algorithm</p>
    <p>Late 90s stream cipher from Philips (NXP).</p>
    <p>Hardware reverse engineered in 2007.</p>
    <p>Using the algorithm in a RKE context:</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)9/24</p>
    <p>SYNC 0x0001 UID BTN CNTRL KS 10 CHK</p>
    <p>PCF7946</p>
    <p>Hitag-2Key</p>
    <p>CNTRLUID BTN</p>
    <p>CNTRH (18 secret bits)</p>
    <p>KS ECU =?= KS</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|The algorithm |Attack implementation</p>
    <p>The Hitag-2 algorithm</p>
    <p>Late 90s stream cipher from Philips (NXP).</p>
    <p>Hardware reverse engineered in 2007.</p>
    <p>Using the algorithm in a RKE context:</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)9/24</p>
    <p>Hitag-2 k 0 47</p>
    <p>BTN</p>
    <p>CNTRHCNTRL</p>
    <p>iv</p>
    <p>id=UID</p>
    <p>ks=KS</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|The algorithm |Attack implementation</p>
    <p>Hitag-2: initialization phase</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)10/24</p>
    <p>uid = uid0 . . .uid31 (32 bits) klow = k0 . . .k16 (16 bits)</p>
    <p>Internal state Hitag-2 (48 bits)</p>
    <p>-1</p>
    <p>C</p>
    <p>YC LES</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|The algorithm |Attack implementation</p>
    <p>Hitag-2: initialization phase</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)10/24</p>
    <p>uid = uid0 . . .uid31 (32 bits) klow = k0 . . .k16 (16 bits)</p>
    <p>Internal state Hitag-2 (48 bits)</p>
    <p>C</p>
    <p>YC LES</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|The algorithm |Attack implementation</p>
    <p>Hitag-2: randomization phase</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)11/24</p>
    <p>fa(i) = (0xA63C)i fb(i) = (0xA770)i fb(i) = (0xA770)i fb(i) = (0xA770)i fa(i) = (0xA63C)i</p>
    <p>fc(i) = (0xD949CBB0)i</p>
    <p>iv = iv0 . . . iv31 (32 bits)</p>
    <p>khigh = k16 . . .k47 (32 bits)</p>
    <p>Shift Register</p>
    <p>C</p>
    <p>YC LES</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|The algorithm |Attack implementation</p>
    <p>Hitag-2: randomization phase</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)11/24</p>
    <p>fa(i) = (0xA63C)i fb(i) = (0xA770)i fb(i) = (0xA770)i fb(i) = (0xA770)i fa(i) = (0xA63C)i</p>
    <p>fc(i) = (0xD949CBB0)i</p>
    <p>iv = iv0 . . . iv31 (32 bits)</p>
    <p>khigh = k16 . . .k47 (32 bits)</p>
    <p>Shift Register</p>
    <p>C</p>
    <p>YC LES</p>
    <p>C</p>
    <p>YC LES</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|The algorithm |Attack implementation</p>
    <p>Hitag-2: randomization phase</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)11/24</p>
    <p>fa(i) = (0xA63C)i fb(i) = (0xA770)i fb(i) = (0xA770)i fb(i) = (0xA770)i fa(i) = (0xA63C)i</p>
    <p>fc(i) = (0xD949CBB0)i</p>
    <p>iv = iv0 . . . iv31 (32 bits)</p>
    <p>khigh = k16 . . .k47 (32 bits)</p>
    <p>Shift Register</p>
    <p>C</p>
    <p>YC LES</p>
    <p>C</p>
    <p>YC LES</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|The algorithm |Attack implementation</p>
    <p>Hitag-2: randomization phase</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)11/24</p>
    <p>fa(i) = (0xA63C)i fb(i) = (0xA770)i fb(i) = (0xA770)i fb(i) = (0xA770)i fa(i) = (0xA63C)i</p>
    <p>fc(i) = (0xD949CBB0)i</p>
    <p>iv = iv0 . . . iv31 (32 bits)</p>
    <p>khigh = k16 . . .k47 (32 bits)</p>
    <p>Shift Register</p>
    <p>C</p>
    <p>YC LES</p>
    <p>C</p>
    <p>YC LES</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|The algorithm |Attack implementation</p>
    <p>Hitag-2: randomization phase</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)11/24</p>
    <p>fa(i) = (0xA63C)i fb(i) = (0xA770)i fb(i) = (0xA770)i fb(i) = (0xA770)i fa(i) = (0xA63C)i</p>
    <p>fc(i) = (0xD949CBB0)i</p>
    <p>iv = iv0 . . . iv31 (32 bits)</p>
    <p>khigh = k16 . . .k47 (32 bits)</p>
    <p>Shift Register</p>
    <p>C</p>
    <p>YC LES</p>
    <p>C</p>
    <p>YC LES</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|The algorithm |Attack implementation</p>
    <p>Hitag-2: randomization phase</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)11/24</p>
    <p>fa(i) = (0xA63C)i fb(i) = (0xA770)i fb(i) = (0xA770)i fb(i) = (0xA770)i fa(i) = (0xA63C)i</p>
    <p>fc(i) = (0xD949CBB0)i</p>
    <p>iv = iv0 . . . iv31 (32 bits)</p>
    <p>khigh = k16 . . .k47 (32 bits)</p>
    <p>Shift Register</p>
    <p>C</p>
    <p>YC LES</p>
    <p>C</p>
    <p>YC LES</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|The algorithm |Attack implementation</p>
    <p>Hitag-2: randomization phase</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)11/24</p>
    <p>fa(i) = (0xA63C)i fb(i) = (0xA770)i fb(i) = (0xA770)i fb(i) = (0xA770)i fa(i) = (0xA63C)i</p>
    <p>fc(i) = (0xD949CBB0)i</p>
    <p>iv = iv0 . . . iv31 (32 bits)</p>
    <p>khigh = k16 . . .k47 (32 bits)</p>
    <p>Shift Register</p>
    <p>C</p>
    <p>YC LES</p>
    <p>C</p>
    <p>YC LES</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|The algorithm |Attack implementation</p>
    <p>Hitag-2: randomization phase</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)11/24</p>
    <p>fa(i) = (0xA63C)i fb(i) = (0xA770)i fb(i) = (0xA770)i fb(i) = (0xA770)i fa(i) = (0xA63C)i</p>
    <p>fc(i) = (0xD949CBB0)i</p>
    <p>iv = iv0 . . . iv31 (32 bits)</p>
    <p>khigh = k16 . . .k47 (32 bits)</p>
    <p>Shift Register</p>
    <p>C</p>
    <p>YC LES</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|The algorithm |Attack implementation</p>
    <p>Hitag-2: nominal phase</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)12/24</p>
    <p>L(state)</p>
    <p>fa(i) = (0xA63C)i fb(i) = (0xA770)i fb(i) = (0xA770)i fb(i) = (0xA770)i fa(i) = (0xA63C)i</p>
    <p>fc(i) = (0xD949CBB0)i</p>
    <p>ks0. . .</p>
    <p>keystream</p>
    <p>C</p>
    <p>YC LES</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|The algorithm |Attack implementation</p>
    <p>Hitag-2: nominal phase</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)12/24</p>
    <p>L(state)</p>
    <p>fa(i) = (0xA63C)i fb(i) = (0xA770)i fb(i) = (0xA770)i fb(i) = (0xA770)i fa(i) = (0xA63C)i</p>
    <p>fc(i) = (0xD949CBB0)i</p>
    <p>ks1ks0. . .</p>
    <p>keystream</p>
    <p>C</p>
    <p>YC LES</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|The algorithm |Attack implementation</p>
    <p>Hitag-2: nominal phase</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)12/24</p>
    <p>L(state)</p>
    <p>fa(i) = (0xA63C)i fb(i) = (0xA770)i fb(i) = (0xA770)i fb(i) = (0xA770)i fa(i) = (0xA63C)i</p>
    <p>fc(i) = (0xD949CBB0)i</p>
    <p>ks15ks14ks13ks12ks11ks10ks9ks8ks7ks6ks5. . .</p>
    <p>keystream</p>
    <p>C</p>
    <p>YC LES</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|The algorithm |Attack implementation</p>
    <p>Hitag-2: nominal phase</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)12/24</p>
    <p>L(state)</p>
    <p>fa(i) = (0xA63C)i fb(i) = (0xA770)i fb(i) = (0xA770)i fb(i) = (0xA770)i fa(i) = (0xA63C)i</p>
    <p>fc(i) = (0xD949CBB0)i</p>
    <p>ks16ks15ks14ks13ks12ks11ks10ks9ks8ks7ks6. . .</p>
    <p>keystream</p>
    <p>C</p>
    <p>YC LES</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|The algorithm |Attack implementation</p>
    <p>Hitag-2: the correlation attack</p>
    <p>Introduced by the USENIX 2016 article:</p>
    <p>Key recovery with 4 to 8 radio frames.  The key search space is significantly reduced.  Uses key candidates scoring deduced from the observed keystream.</p>
    <p>Solving the unknown CNTRH issue:</p>
    <p>Supposed to be set to zero at manufacturing time.  Authors suggest to estimate the vehicles age.</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)13/24</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|The algorithm |Attack implementation</p>
    <p>Hitag-2: the correlation attack</p>
    <p>Introduced by the USENIX 2016 article:</p>
    <p>Key recovery with 4 to 8 radio frames.  The key search space is significantly reduced.  Uses key candidates scoring deduced from the observed keystream.</p>
    <p>Solving the unknown CNTRH issue:</p>
    <p>Supposed to be set to zero at manufacturing time.  Authors suggest to estimate the vehicles age.</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)13/24</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|The algorithm |Attack implementation</p>
    <p>Implementing the correlation based cryptanalysis</p>
    <p>Tests on emulated radio frames.  Our implementation works.  The key is found in a few minutes.</p>
    <p>Tests on real radio frames (with unknown CNTRH).  Cryptanalysis does not converge towards a proper key.</p>
    <p>Our Hitag-2 RKE system might be different!  We need to understand the discrepancies.</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)14/24</p>
    <p>Emulated radio frames</p>
    <p>Correlation attack Key</p>
    <p>Recovery</p>
    <p>Captured/decoded radio frames</p>
    <p>Correlation attack No</p>
    <p>Result</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|The algorithm |Attack implementation</p>
    <p>Implementing the correlation based cryptanalysis</p>
    <p>Tests on emulated radio frames.  Our implementation works.  The key is found in a few minutes.</p>
    <p>Tests on real radio frames (with unknown CNTRH).  Cryptanalysis does not converge towards a proper key.</p>
    <p>Our Hitag-2 RKE system might be different!  We need to understand the discrepancies.</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)14/24</p>
    <p>Emulated radio frames</p>
    <p>Correlation attack Key</p>
    <p>Recovery</p>
    <p>Captured/decoded radio frames</p>
    <p>Correlation attack No</p>
    <p>Result</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|The algorithm |Attack implementation</p>
    <p>Implementing the correlation based cryptanalysis</p>
    <p>Tests on emulated radio frames.  Our implementation works.  The key is found in a few minutes.</p>
    <p>Tests on real radio frames (with unknown CNTRH).  Cryptanalysis does not converge towards a proper key.</p>
    <p>Our Hitag-2 RKE system might be different!  We need to understand the discrepancies.</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)14/24</p>
    <p>Emulated radio frames</p>
    <p>Correlation attack Key</p>
    <p>Recovery</p>
    <p>Captured/decoded radio frames</p>
    <p>Correlation attack No</p>
    <p>Result</p>
  </div>
  <div class="page">
    <p>New attacks</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|Blank keys |Discrepancies |Attacks</p>
    <p>Black box reverse engineering</p>
    <p>How can it be performed?  We had access to the vehicle but no access to the ECU.  No NDA with NXP: neither datasheets nor SDKs.</p>
    <p>We found programmable blank keys containing the PCF7946!</p>
    <p>They use the manufacturing default key 0x4f4e4d494b52.</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)15/24</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|Blank keys |Discrepancies |Attacks</p>
    <p>Black box reverse engineering</p>
    <p>How can it be performed?  We had access to the vehicle but no access to the ECU.  No NDA with NXP: neither datasheets nor SDKs.</p>
    <p>We found programmable blank keys containing the PCF7946!</p>
    <p>They use the manufacturing default key 0x4f4e4d494b52.</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)15/24</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|Blank keys |Discrepancies |Attacks</p>
    <p>Finding the iv format: a black box approach</p>
    <p>Brute forcing the 232 iv and finding explicit patterns for observed ks, with fixed and known id and k.</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)16/24</p>
    <p>Hitag-2 k 0 47</p>
    <p>iv 0 31</p>
    <p>id=UID</p>
    <p>ks=KS</p>
    <p>... 00000010100010010000100001000111 00110100010000000000000001000101</p>
    <p>...</p>
    <p>E x h</p>
    <p>a u</p>
    <p>st iv</p>
    <p>e</p>
    <p>O b</p>
    <p>se rv</p>
    <p>ed k s</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|Blank keys |Discrepancies |Attacks</p>
    <p>Finding the iv format: the discrepancies</p>
    <p>Explains why the USENIX 2016 correlation attack fails.</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)17/24</p>
    <p>Hitag-2 k 0 47</p>
    <p>BTN</p>
    <p>CNTRLCNTRH</p>
    <p>CNTRH</p>
    <p>Fixed value  Minor modifications</p>
    <p>of ks0</p>
    <p>Modified for</p>
    <p>each frame</p>
    <p>Found iv</p>
    <p>BTN</p>
    <p>CNTRHCNTRL</p>
    <p>USENIX 2016 iv</p>
    <p>id=UID</p>
    <p>ks=KS</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|Blank keys |Discrepancies |Attacks</p>
    <p>Finding the iv format: the discrepancies</p>
    <p>Explains why the USENIX 2016 correlation attack fails.</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)17/24</p>
    <p>Hitag-2 k 0 47</p>
    <p>BTN</p>
    <p>CNTRL</p>
    <p>CNTRH</p>
    <p>CNTRH</p>
    <p>Fixed value  Minor modifications</p>
    <p>of ks0</p>
    <p>Modified for</p>
    <p>each frame</p>
    <p>Found iv</p>
    <p>BTN</p>
    <p>CNTRHCNTRL</p>
    <p>USENIX 2016 iv</p>
    <p>id=UID</p>
    <p>ks=KS</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|Blank keys |Discrepancies |Attacks</p>
    <p>Uncovering an ECU mitigation</p>
    <p>Resynchronization with near-field 125 KHz when starting the engine.</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)18/24</p>
    <p>UID1, CNTRL1 = 9, BTN1, AUTH1</p>
    <p>ECU</p>
    <p>UID Key Counter Button</p>
    <p>UID1 K1 10 0,1,5,6</p>
    <p>UID2 K2 200 0,1,2</p>
    <p>. . . . . . . . . . . .</p>
    <p>UID Key Counter Button</p>
    <p>UID1 K1 10 0,1,5,6</p>
    <p>UID2 K2 200 0,1,2</p>
    <p>. . . . . . . . . . . .</p>
    <p>CNTR1 = 9 &lt; 10</p>
    <p>BTNCNTRLCNTRH</p>
    <p>RANDOM</p>
    <p>E C</p>
    <p>U resy</p>
    <p>n ch</p>
    <p>ro n</p>
    <p>iza tio</p>
    <p>n</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|Blank keys |Discrepancies |Attacks</p>
    <p>Uncovering an ECU mitigation</p>
    <p>Resynchronization with near-field 125 KHz when starting the engine.</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)18/24</p>
    <p>UID1, CNTRL1 = 9, BTN1, AUTH1</p>
    <p>ECU</p>
    <p>UID Key Counter Button</p>
    <p>UID1 K1 10 0,1,5,6</p>
    <p>UID2 K2 200 0,1,2</p>
    <p>. . . . . . . . . . . .</p>
    <p>UID Key Counter Button</p>
    <p>UID1 K1 10 0,1,5,6</p>
    <p>UID2 K2 200 0,1,2</p>
    <p>. . . . . . . . . . . .</p>
    <p>CNTR1 = 9 &lt; 10</p>
    <p>BTNCNTRLCNTRH</p>
    <p>RANDOM</p>
    <p>E C</p>
    <p>U resy</p>
    <p>n ch</p>
    <p>ro n</p>
    <p>iza tio</p>
    <p>n</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|Blank keys |Discrepancies |Attacks</p>
    <p>Uncovering an ECU mitigation</p>
    <p>Resynchronization with near-field 125 KHz when starting the engine.</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)18/24</p>
    <p>UID1, CNTRL1 = 9, BTN1, AUTH1</p>
    <p>ECU</p>
    <p>UID Key Counter Button</p>
    <p>UID1 K1 10 0,1,5,6</p>
    <p>UID2 K2 200 0,1,2</p>
    <p>. . . . . . . . . . . .</p>
    <p>UID Key Counter Button</p>
    <p>UID1 K1 10 0,1,5,6</p>
    <p>UID2 K2 200 0,1,2</p>
    <p>. . . . . . . . . . . .</p>
    <p>CNTR1 = 9 &lt; 10</p>
    <p>BTNCNTRLCNTRH</p>
    <p>RANDOM</p>
    <p>E C</p>
    <p>U resy</p>
    <p>n ch</p>
    <p>ro n</p>
    <p>iza tio</p>
    <p>n</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|Blank keys |Discrepancies |Attacks</p>
    <p>Optimized exhaustive search</p>
    <p>Uses two triplets (id, iv, ks):  Searches over 248 keys the one realizing the observed keystreams.  Implementation of a heavily parallelized and optimized brute-forcer</p>
    <p>on CPU and GPU (in OpenCL).</p>
    <p>Tested on Amazon EC2 instances:</p>
    <p>Platform Time</p>
    <p>GeForce GTX 780Ti 18 hours</p>
    <p>One Amazon EC2 instance 45 minutes</p>
    <p>Three Amazon EC2 instances 15 minutes</p>
    <p>p2.16xlarge: 16 Tesla K80, 128 CPU</p>
    <p>How to deal with the unknown part of CNTRH?</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)19/24</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|Blank keys |Discrepancies |Attacks</p>
    <p>Optimized exhaustive search</p>
    <p>Uses two triplets (id, iv, ks):  Searches over 248 keys the one realizing the observed keystreams.  Implementation of a heavily parallelized and optimized brute-forcer</p>
    <p>on CPU and GPU (in OpenCL).</p>
    <p>Tested on Amazon EC2 instances:</p>
    <p>Platform Time</p>
    <p>GeForce GTX 780Ti 18 hours</p>
    <p>One Amazon EC2 instance 45 minutes</p>
    <p>Three Amazon EC2 instances 15 minutes</p>
    <p>p2.16xlarge: 16 Tesla K80, 128 CPU</p>
    <p>How to deal with the unknown part of CNTRH?</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)19/24</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|Blank keys |Discrepancies |Attacks</p>
    <p>Optimized exhaustive search</p>
    <p>Uses two triplets (id, iv, ks):  Searches over 248 keys the one realizing the observed keystreams.  Implementation of a heavily parallelized and optimized brute-forcer</p>
    <p>on CPU and GPU (in OpenCL).</p>
    <p>Tested on Amazon EC2 instances:</p>
    <p>Platform Time</p>
    <p>GeForce GTX 780Ti 18 hours</p>
    <p>One Amazon EC2 instance 45 minutes</p>
    <p>Three Amazon EC2 instances 15 minutes</p>
    <p>p2.16xlarge: 16 Tesla K80, 128 CPU</p>
    <p>How to deal with the unknown part of CNTRH?</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)19/24</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|Blank keys |Discrepancies |Attacks</p>
    <p>Hitag-2 equivalent keys</p>
    <p>Masking can be inserted during the randomization phase.</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)20/24</p>
    <p>M(mask)</p>
    <p>fa(i) = (0xA63C)i fb(i) = (0xA770)i fb(i) = (0xA770)i fb(i) = (0xA770)i fa(i) = (0xA63C)i</p>
    <p>fc(i) = (0xD949CBB0)i</p>
    <p>iv = iv M</p>
    <p>khigh = khigh M</p>
    <p>Shift Register</p>
    <p>C</p>
    <p>YC LES</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|Blank keys |Discrepancies |Attacks</p>
    <p>Hitag-2 equivalent keys</p>
    <p>Many equivalent keys generating the same keystream can be exposed through iv masking.</p>
    <p>An exhaustive search with equivalent iv produces an equivalent key k masked with CNTRH.</p>
    <p>No need to find the real key k to craft legitimate frames!</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)21/24</p>
    <p>Hitag-2</p>
    <p>k</p>
    <p>= kBTN 31</p>
    <p>CNTRLCNTRH</p>
    <p>iv</p>
    <p>k0...15 k16...33 M1 k34...47 0 47</p>
    <p>= k1</p>
    <p>CNTRHM1 0</p>
    <p>k0...15 k16...33 M2 k34...47 0 47</p>
    <p>= k2</p>
    <p>CNTRHM2 0</p>
    <p>k0...15 k16...33 M3 k34...47 0 47</p>
    <p>= k3</p>
    <p>CNTRHM3 0</p>
    <p>.. .</p>
    <p>.. .</p>
    <p>id=UID</p>
    <p>ks=KS</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|Blank keys |Discrepancies |Attacks</p>
    <p>Hitag-2 equivalent keys</p>
    <p>Many equivalent keys generating the same keystream can be exposed through iv masking.</p>
    <p>An exhaustive search with equivalent iv produces an equivalent key k masked with CNTRH.</p>
    <p>No need to find the real key k to craft legitimate frames!</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)21/24</p>
    <p>Hitag-2</p>
    <p>k</p>
    <p>= kBTN 31</p>
    <p>CNTRLCNTRH</p>
    <p>iv</p>
    <p>k0...15 k16...33 M1 k34...47 0 47</p>
    <p>= k1</p>
    <p>CNTRHM1 0</p>
    <p>k0...15 k16...33 M2 k34...47 0 47</p>
    <p>= k2</p>
    <p>CNTRHM2 0</p>
    <p>k0...15 k16...33 M3 k34...47 0 47</p>
    <p>= k3</p>
    <p>CNTRHM3 0</p>
    <p>.. .</p>
    <p>.. .</p>
    <p>id=UID</p>
    <p>ks=KS</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|Blank keys |Discrepancies |Attacks</p>
    <p>Hitag-2 equivalent keys</p>
    <p>Many equivalent keys generating the same keystream can be exposed through iv masking.</p>
    <p>Particular case of interest: when the mask is CNTRH.</p>
    <p>An exhaustive search with equivalent iv produces an equivalent key k masked with CNTRH.</p>
    <p>No need to find the real key k to craft legitimate frames!</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)21/24</p>
    <p>Hitag-2</p>
    <p>k</p>
    <p>= kBTN 31</p>
    <p>CNTRLCNTRH</p>
    <p>iv</p>
    <p>k0...15 k16...33 CNTRH k34...47 0 47</p>
    <p>= k 31</p>
    <p>id=UID</p>
    <p>ks=KS</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|Blank keys |Discrepancies |Attacks</p>
    <p>Hitag-2 equivalent keys</p>
    <p>Many equivalent keys generating the same keystream can be exposed through iv masking.</p>
    <p>An exhaustive search with equivalent iv produces an equivalent key k masked with CNTRH.</p>
    <p>No need to find the real key k to craft legitimate frames!</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)21/24</p>
    <p>SYNC 0x0001 UID BTN1 CNTRL1 KS1 10 CHK1</p>
    <p>Captured RF frame 1</p>
    <p>BTN1CNTRL1</p>
    <p>iv1000000000000000000</p>
    <p>SYNC 0x0001 UID BTN2 CNTRL2 KS2 10 CHK2</p>
    <p>Captured RF frame 2</p>
    <p>BTN2CNTRL2</p>
    <p>iv2000000000000000000</p>
    <p>k = k  (016CNTRH014)</p>
    <p>Exhaustive search</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|Blank keys |Discrepancies |Attacks</p>
    <p>Hitag-2 equivalent keys</p>
    <p>Many equivalent keys generating the same keystream can be exposed through iv masking.</p>
    <p>An exhaustive search with equivalent iv produces an equivalent key k masked with CNTRH.</p>
    <p>No need to find the real key k to craft legitimate frames!</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)21/24</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|Blank keys |Discrepancies |Attacks</p>
    <p>New attacks 1/2: capture two frames and guess</p>
    <p>Without ECU resynchronization.</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)22/24</p>
    <p>FRAME1</p>
    <p>FRAME2</p>
    <p>C A P T U R E</p>
    <p>k = Exhaustive search of 248</p>
    <p>15 minutes on Amazon EC2</p>
    <p>F R A M E S</p>
    <p>k</p>
    <p>(1024 CNTRL) frames OK &gt; (1024 CNTRL)  increment</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|Blank keys |Discrepancies |Attacks</p>
    <p>New attacks 1/2: capture two frames and guess</p>
    <p>Without ECU resynchronization.</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)22/24</p>
    <p>FRAME1</p>
    <p>FRAME2</p>
    <p>C A P T U R E</p>
    <p>k = Exhaustive search of 248</p>
    <p>15 minutes on Amazon EC2</p>
    <p>F R A M E S</p>
    <p>k</p>
    <p>(1024 CNTRL) frames OK &gt; (1024 CNTRL)  increment</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|Blank keys |Discrepancies |Attacks</p>
    <p>New attacks 1/2: capture two frames and guess</p>
    <p>Without ECU resynchronization.</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)22/24</p>
    <p>FRAME1</p>
    <p>FRAME2</p>
    <p>C A P T U R E</p>
    <p>k = Exhaustive search of 248</p>
    <p>15 minutes on Amazon EC2</p>
    <p>F R A M E S</p>
    <p>k</p>
    <p>(1024 CNTRL) frames OK &gt; (1024 CNTRL)  increment</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|Blank keys |Discrepancies |Attacks</p>
    <p>New attacks 2/2: recapture and adapt</p>
    <p>With ECU resynchronization.</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)23/24</p>
    <p>C A P T U R E</p>
    <p>k</p>
    <p>k k</p>
    <p>k = Exhaustive search of 218</p>
    <p>15 minutes on a laptop</p>
    <p>F R A M E</p>
    <p>k</p>
    <p>(1024 CNTRL) frames OK &gt; (1024 CNTRL)  increment</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|Blank keys |Discrepancies |Attacks</p>
    <p>New attacks 2/2: recapture and adapt</p>
    <p>With ECU resynchronization.</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)23/24</p>
    <p>C A P T U R E</p>
    <p>k</p>
    <p>k k</p>
    <p>k = Exhaustive search of 218</p>
    <p>15 minutes on a laptop</p>
    <p>F R A M E</p>
    <p>k</p>
    <p>(1024 CNTRL) frames OK &gt; (1024 CNTRL)  increment</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>|Blank keys |Discrepancies |Attacks</p>
    <p>New attacks 2/2: recapture and adapt</p>
    <p>With ECU resynchronization.</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)23/24</p>
    <p>C A P T U R E</p>
    <p>kk k</p>
    <p>k = Exhaustive search of 218</p>
    <p>15 minutes on a laptop</p>
    <p>F R A M E</p>
    <p>k</p>
    <p>(1024 CNTRL) frames OK &gt; (1024 CNTRL)  increment</p>
  </div>
  <div class="page">
    <p>Conclusion</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>Conclusion</p>
    <p>Results:</p>
    <p>A hardened RKE Hitag-2 exposed. I Mitigation through ECU resynchronization.</p>
    <p>Attack cost  20 + 45 + 100 e.</p>
    <p>Attack complexity = 2 RF frames, +1 with the ECU mitigation.</p>
    <p>RTL-SDR (capture)</p>
    <p>Cloud brute force (find equivalent key)</p>
    <p>YARD Stick One (forge frames)</p>
    <p>Obsolete and proprietary cryptography is broken:  Time to make a change!</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)24/24</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>Conclusion</p>
    <p>Results:</p>
    <p>A hardened RKE Hitag-2 exposed. I Mitigation through ECU resynchronization.</p>
    <p>Attack cost  20 + 45 + 100 e.</p>
    <p>Attack complexity = 2 RF frames, +1 with the ECU mitigation.</p>
    <p>RTL-SDR (capture)</p>
    <p>Cloud brute force (find equivalent key)</p>
    <p>YARD Stick One (forge frames)</p>
    <p>Obsolete and proprietary cryptography is broken:  Time to make a change!</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)24/24</p>
  </div>
  <div class="page">
    <p>|Introduction |Context |Radio signal analysis |Hitag-2 |New attacks |Conclusion</p>
    <p>Conclusion</p>
    <p>Results:</p>
    <p>A hardened RKE Hitag-2 exposed. I Mitigation through ECU resynchronization.</p>
    <p>Attack cost  20 + 45 + 100 e.</p>
    <p>Attack complexity = 2 RF frames, +1 with the ECU mitigation.</p>
    <p>RTL-SDR (capture)</p>
    <p>Cloud brute force (find equivalent key)</p>
    <p>YARD Stick One (forge frames)</p>
    <p>Obsolete and proprietary cryptography is broken:  Time to make a change!</p>
    <p>One Car, Two Frames - WOOT17 (August 15, 2017 - Vancouver, BC, Canada)24/24</p>
  </div>
  <div class="page">
    <p>W00T17 11th USENIX Workshop on Offensive Technologies</p>
    <p>One Car, Two Frames: Attacks on Hitag-2 Remote Keyless Entry Systems Revisited</p>
  </div>
</Presentation>
