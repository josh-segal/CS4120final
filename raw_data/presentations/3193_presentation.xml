<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Revisiting SSL/TLS Implementations New Bleichenbacher Side Channels and Attacks</p>
    <p>Christopher Meyer, Juraj Somorovsky, Eugen Weiss, Jrg</p>
    <p>Schwenk, Sebastian Schinzel, Erik Tews</p>
    <p>[ Source http://www.cafe-reichard.de ]</p>
  </div>
  <div class="page">
    <p>[ Source http://www.cafe-reichard.de ]</p>
    <p>TLS</p>
    <p>is Like Intelligent Glas</p>
  </div>
  <div class="page">
    <p>[ Source http://www.cafe-reichard.de ]</p>
    <p>TLS</p>
    <p>because Privacy and Confidentiality Matters.</p>
  </div>
  <div class="page">
    <p>[ Source http://thebruinclub.files.wordpress.com/ ]</p>
    <p>Oracle Attacks Are Back Again</p>
    <p>Exploiting SSL/TLS Stacks</p>
  </div>
  <div class="page">
    <p>Horst Grtz Institute for IT-Security</p>
    <p>Chair for Network and Data Security</p>
    <p>Revisiting SSL/TLS Implementations - New Bleichenbacher Side Channels and Attacks 23rd USENIX Security Symposium | San Diego, CA | August, 20-22, 2014</p>
    <p>Bleichenbachers Attack Restoring the Key Material</p>
  </div>
  <div class="page">
    <p>Horst Grtz Institute for IT-Security</p>
    <p>Chair for Network and Data Security</p>
    <p>Revisiting SSL/TLS Implementations - New Bleichenbacher Side Channels and Attacks 23rd USENIX Security Symposium | San Diego, CA | August, 20-22, 2014</p>
    <p>Preconditions</p>
    <p>RSA-Based Key Exchange</p>
    <p>Previously Recorded SSL/TLS Session</p>
    <p>Connection to Target Server Possible</p>
    <p>Bleichenbachers Attack Restoring the Key Material</p>
  </div>
  <div class="page">
    <p>Horst Grtz Institute for IT-Security</p>
    <p>Chair for Network and Data Security</p>
    <p>Revisiting SSL/TLS Implementations - New Bleichenbacher Side Channels and Attacks 23rd USENIX Security Symposium | San Diego, CA | August, 20-22, 2014</p>
    <p>Bleichenbachers Attack Restoring the Key Material</p>
  </div>
  <div class="page">
    <p>Horst Grtz Institute for IT-Security</p>
    <p>Chair for Network and Data Security</p>
    <p>Revisiting SSL/TLS Implementations - New Bleichenbacher Side Channels and Attacks 23rd USENIX Security Symposium | San Diego, CA | August, 20-22, 2014</p>
    <p>Handshake Protocol</p>
    <p>Recap</p>
  </div>
  <div class="page">
    <p>Horst Grtz Institute for IT-Security</p>
    <p>Chair for Network and Data Security</p>
    <p>Revisiting SSL/TLS Implementations - New Bleichenbacher Side Channels and Attacks 23rd USENIX Security Symposium | San Diego, CA | August, 20-22, 2014</p>
    <p>Handshake Protocol</p>
    <p>Recap</p>
  </div>
  <div class="page">
    <p>Horst Grtz Institute for IT-Security</p>
    <p>Chair for Network and Data Security</p>
    <p>Revisiting SSL/TLS Implementations - New Bleichenbacher Side Channels and Attacks 23rd USENIX Security Symposium | San Diego, CA | August, 20-22, 2014</p>
    <p>Handshake Protocol</p>
    <p>Content of a ClientKeyExchange Message (RSA Case)</p>
    <p>Encrypted Payload when using RSA for Key Exchange</p>
    <p>PMS = PreMasterSecret</p>
  </div>
  <div class="page">
    <p>Horst Grtz Institute for IT-Security</p>
    <p>Chair for Network and Data Security</p>
    <p>Revisiting SSL/TLS Implementations - New Bleichenbacher Side Channels and Attacks 23rd USENIX Security Symposium | San Diego, CA | August, 20-22, 2014</p>
    <p>Key Derivation</p>
    <p>Why is the PMS so Sensitive?</p>
    <p>Unknown</p>
    <p>Known</p>
    <p>Known</p>
  </div>
  <div class="page">
    <p>Horst Grtz Institute for IT-Security</p>
    <p>Chair for Network and Data Security</p>
    <p>Revisiting SSL/TLS Implementations - New Bleichenbacher Side Channels and Attacks 23rd USENIX Security Symposium | San Diego, CA | August, 20-22, 2014</p>
    <p>Handshake Protocol</p>
    <p>Content of a ClientKeyExchange Message (RSA Case)</p>
    <p>Encrypted Payload when using RSA for Key Exchange</p>
    <p>Structure Violations Cause Different Response Messages!</p>
  </div>
  <div class="page">
    <p>Horst Grtz Institute for IT-Security</p>
    <p>Chair for Network and Data Security</p>
    <p>Revisiting SSL/TLS Implementations - New Bleichenbacher Side Channels and Attacks 23rd USENIX Security Symposium | San Diego, CA | August, 20-22, 2014</p>
    <p>Bleichenbachers Attack Restoring the Key Material</p>
  </div>
  <div class="page">
    <p>Horst Grtz Institute for IT-Security</p>
    <p>Chair for Network and Data Security</p>
    <p>Revisiting SSL/TLS Implementations - New Bleichenbacher Side Channels and Attacks 23rd USENIX Security Symposium | San Diego, CA | August, 20-22, 2014</p>
    <p>Bleichenbachers Attack Adjusting the ClientKeyExchange Payload</p>
  </div>
  <div class="page">
    <p>Horst Grtz Institute for IT-Security</p>
    <p>Chair for Network and Data Security</p>
    <p>Revisiting SSL/TLS Implementations - New Bleichenbacher Side Channels and Attacks 23rd USENIX Security Symposium | San Diego, CA | August, 20-22, 2014</p>
    <p>Bleichenbachers Attack Adjusting the ClientKeyExchange Payload</p>
    <p>RSA Homomorphic-Property</p>
    <p>encn, e ( m1 ) * encn, e ( m2 )</p>
    <p>= encn, e ( m1 * m2 )</p>
  </div>
  <div class="page">
    <p>Horst Grtz Institute for IT-Security</p>
    <p>Chair for Network and Data Security</p>
    <p>Revisiting SSL/TLS Implementations - New Bleichenbacher Side Channels and Attacks 23rd USENIX Security Symposium | San Diego, CA | August, 20-22, 2014</p>
    <p>Bleichenbachers Attack Adjusting the ClientKeyExchange Payload</p>
    <p>RSA Homomorphic-Property</p>
    <p>encn, e ( m1 ) * encn, e ( m2 )</p>
    <p>= encn, e ( m1 * m2 )</p>
    <p>Explanation:</p>
    <p>encn, e ( m1 ) * encn, e ( m2 )</p>
    <p>m1 e * m2</p>
    <p>e mod n  ( m1 * m2 ) e mod n</p>
    <p>= encn, e ( m1 * m2 )</p>
  </div>
  <div class="page">
    <p>Horst Grtz Institute for IT-Security</p>
    <p>Chair for Network and Data Security</p>
    <p>Revisiting SSL/TLS Implementations - New Bleichenbacher Side Channels and Attacks 23rd USENIX Security Symposium | San Diego, CA | August, 20-22, 2014</p>
    <p>Bleichenbachers Attack Adjusting the ClientKeyExchange Payload</p>
    <p>s: Value Chosen by Attacker</p>
    <p>c: Eavesdropped, Encrypted Content of a ClientKeyExchange Msg</p>
    <p>m: (Unknown) Plainext of c</p>
    <p>encn, e ( s ) * c</p>
    <p>s e * c mod n</p>
    <p>( s * m ) e mod n</p>
    <p>= encn, e ( s * m )</p>
  </div>
  <div class="page">
    <p>Horst Grtz Institute for IT-Security</p>
    <p>Chair for Network and Data Security</p>
    <p>Revisiting SSL/TLS Implementations - New Bleichenbacher Side Channels and Attacks 23rd USENIX Security Symposium | San Diego, CA | August, 20-22, 2014</p>
    <p>TLS 1.0 Defines Countermeasures</p>
    <p>Bleichenbachers Attack Restoring the Key Material</p>
  </div>
  <div class="page">
    <p>Horst Grtz Institute for IT-Security</p>
    <p>Chair for Network and Data Security</p>
    <p>Revisiting SSL/TLS Implementations - New Bleichenbacher Side Channels and Attacks 23rd USENIX Security Symposium | San Diego, CA | August, 20-22, 2014</p>
    <p>TLS 1.0 Defines Countermeasures</p>
    <p>Bleichenbachers Attack Restoring the Key Material</p>
    <p>Create a random PMSR if theres anything wrong with the one we received and continue with PMSR</p>
  </div>
  <div class="page">
    <p>Horst Grtz Institute for IT-Security</p>
    <p>Chair for Network and Data Security</p>
    <p>Revisiting SSL/TLS Implementations - New Bleichenbacher Side Channels and Attacks 23rd USENIX Security Symposium | San Diego, CA | August, 20-22, 2014</p>
    <p>Bleichenbachers Attack New Side-Channels</p>
  </div>
  <div class="page">
    <p>Horst Grtz Institute for IT-Security</p>
    <p>Chair for Network and Data Security</p>
    <p>Revisiting SSL/TLS Implementations - New Bleichenbacher Side Channels and Attacks 23rd USENIX Security Symposium | San Diego, CA | August, 20-22, 2014</p>
    <p>Bleichenbachers Attack New Side-Channels</p>
    <p>Force Different Error Messages</p>
  </div>
  <div class="page">
    <p>Horst Grtz Institute for IT-Security</p>
    <p>Chair for Network and Data Security</p>
    <p>Revisiting SSL/TLS Implementations - New Bleichenbacher Side Channels and Attacks 23rd USENIX Security Symposium | San Diego, CA | August, 20-22, 2014</p>
    <p>Bleichenbachers Attack New Side-Channels</p>
    <p>Force Different Error Messages</p>
    <p>Implementation Bug</p>
  </div>
  <div class="page">
    <p>Horst Grtz Institute for IT-Security</p>
    <p>Chair for Network and Data Security</p>
    <p>Revisiting SSL/TLS Implementations - New Bleichenbacher Side Channels and Attacks 23rd USENIX Security Symposium | San Diego, CA | August, 20-22, 2014</p>
    <p>Bleichenbachers Attack New Side-Channels</p>
    <p>Force Different Error Messages</p>
    <p>Implementation Bug</p>
  </div>
  <div class="page">
    <p>Horst Grtz Institute for IT-Security</p>
    <p>Chair for Network and Data Security</p>
    <p>Revisiting SSL/TLS Implementations - New Bleichenbacher Side Channels and Attacks 23rd USENIX Security Symposium | San Diego, CA | August, 20-22, 2014</p>
    <p>Bleichenbachers Attack New Side-Channels</p>
    <p>Force Different Error Messages</p>
    <p>Implementation Bug</p>
    <p>ArrayIndexOutOfBoundsException causes an</p>
    <p>INTERNAL_ERROR alert instead of HANDSHAKE_FAILURE</p>
  </div>
  <div class="page">
    <p>Horst Grtz Institute for IT-Security</p>
    <p>Chair for Network and Data Security</p>
    <p>Revisiting SSL/TLS Implementations - New Bleichenbacher Side Channels and Attacks 23rd USENIX Security Symposium | San Diego, CA | August, 20-22, 2014</p>
    <p>Bleichenbachers Attack JSSE  Different Error Messages</p>
    <p>Root Cause of Bug: com.sun.crypto.provider.TlsPrfGenerator.expand(..)</p>
  </div>
  <div class="page">
    <p>Horst Grtz Institute for IT-Security</p>
    <p>Chair for Network and Data Security</p>
    <p>Revisiting SSL/TLS Implementations - New Bleichenbacher Side Channels and Attacks 23rd USENIX Security Symposium | San Diego, CA | August, 20-22, 2014</p>
    <p>Real-World Bleichenbacher</p>
    <p>~ 12 hours and ~177k queries later....</p>
  </div>
  <div class="page">
    <p>Horst Grtz Institute for IT-Security</p>
    <p>Chair for Network and Data Security</p>
    <p>Revisiting SSL/TLS Implementations - New Bleichenbacher Side Channels and Attacks 23rd USENIX Security Symposium | San Diego, CA | August, 20-22, 2014</p>
    <p>Java Total Breach of RSA-based TLS Internal Flaws Resurrected Bleichenbachers Attack</p>
    <p>Pre Master Secret 03 01 is protocol version of TLS 1.0</p>
  </div>
  <div class="page">
    <p>Horst Grtz Institute for IT-Security</p>
    <p>Chair for Network and Data Security</p>
    <p>Revisiting SSL/TLS Implementations - New Bleichenbacher Side Channels and Attacks 23rd USENIX Security Symposium | San Diego, CA | August, 20-22, 2014</p>
    <p>Bleichenbachers Attack New Side-Channels</p>
    <p>Force Different Error Messages</p>
    <p>Implementation Bug</p>
    <p>Force Different Processing Time</p>
  </div>
  <div class="page">
    <p>Horst Grtz Institute for IT-Security</p>
    <p>Chair for Network and Data Security</p>
    <p>Revisiting SSL/TLS Implementations - New Bleichenbacher Side Channels and Attacks 23rd USENIX Security Symposium | San Diego, CA | August, 20-22, 2014</p>
    <p>Measurement Setup How to Measure Different Processing Times</p>
  </div>
  <div class="page">
    <p>Horst Grtz Institute for IT-Security</p>
    <p>Chair for Network and Data Security</p>
    <p>Revisiting SSL/TLS Implementations - New Bleichenbacher Side Channels and Attacks 23rd USENIX Security Symposium | San Diego, CA | August, 20-22, 2014</p>
    <p>Bleichenbachers Attack New Side-Channels</p>
    <p>Force Different Error Messages</p>
    <p>Implementation Bug</p>
    <p>Force Different Processing Time</p>
    <p>Random Number Generation</p>
  </div>
  <div class="page">
    <p>Horst Grtz Institute for IT-Security</p>
    <p>Chair for Network and Data Security</p>
    <p>Revisiting SSL/TLS Implementations - New Bleichenbacher Side Channels and Attacks 23rd USENIX Security Symposium | San Diego, CA | August, 20-22, 2014</p>
    <p>Bleichenbachers Attack New Side-Channels</p>
    <p>Force Different Error Messages</p>
    <p>Implementation Bug</p>
    <p>Force Different Processing Time</p>
    <p>Random Number Generation</p>
    <p>Only create a random PMSR if theres anything wrong with the received one and continue with PMSR</p>
    <p>VS.</p>
    <p>Always create a random PMSR, but only continue with PMSR if theres anything wrong with the received one</p>
  </div>
  <div class="page">
    <p>Horst Grtz Institute for IT-Security</p>
    <p>Chair for Network and Data Security</p>
    <p>Revisiting SSL/TLS Implementations - New Bleichenbacher Side Channels and Attacks 23rd USENIX Security Symposium | San Diego, CA | August, 20-22, 2014</p>
    <p>Bleichenbachers Attack OpenSSL  Different Processing Times</p>
    <p>~ 1,5 -2 s</p>
  </div>
  <div class="page">
    <p>Horst Grtz Institute for IT-Security</p>
    <p>Chair for Network and Data Security</p>
    <p>Revisiting SSL/TLS Implementations - New Bleichenbacher Side Channels and Attacks 23rd USENIX Security Symposium | San Diego, CA | August, 20-22, 2014</p>
    <p>Bleichenbachers Attack New Side-Channels</p>
    <p>Force Different Error Messages</p>
    <p>Implementation Bug</p>
    <p>Force Different Processing Time</p>
    <p>Random Number Generation</p>
    <p>No attack possible (so far) timing differences very small and oracle due to strict PKCS#1 checks very weak</p>
  </div>
  <div class="page">
    <p>Horst Grtz Institute for IT-Security</p>
    <p>Chair for Network and Data Security</p>
    <p>Revisiting SSL/TLS Implementations - New Bleichenbacher Side Channels and Attacks 23rd USENIX Security Symposium | San Diego, CA | August, 20-22, 2014</p>
    <p>Bleichenbachers Attack New Side-Channels</p>
    <p>Force Different Error Messages</p>
    <p>Implementation Bug</p>
    <p>Force Different Processing Time</p>
    <p>Random Number Generation</p>
    <p>Exceptions</p>
  </div>
  <div class="page">
    <p>Horst Grtz Institute for IT-Security</p>
    <p>Chair for Network and Data Security</p>
    <p>Revisiting SSL/TLS Implementations - New Bleichenbacher Side Channels and Attacks 23rd USENIX Security Symposium | San Diego, CA | August, 20-22, 2014</p>
    <p>Bleichenbachers Attack JSSE  Exceptions Cause Different Processing Time</p>
    <p>private byte [] unpadV15 (byte[] padded) throws</p>
    <p>BadPaddingException {</p>
    <p>if (not PKCS compliant) {</p>
    <p>throw new BadPaddingException();</p>
    <p>} else {</p>
    <p>return unpadded text;</p>
    <p>}</p>
    <p>}</p>
    <p>Unpadding Function Used to Remove PKCS#1 Overhead</p>
  </div>
  <div class="page">
    <p>Horst Grtz Institute for IT-Security</p>
    <p>Chair for Network and Data Security</p>
    <p>Revisiting SSL/TLS Implementations - New Bleichenbacher Side Channels and Attacks 23rd USENIX Security Symposium | San Diego, CA | August, 20-22, 2014</p>
    <p>Bleichenbachers Attack JSSE  Exceptions Cause Different Processing Time</p>
    <p>~ 20 s</p>
  </div>
  <div class="page">
    <p>Horst Grtz Institute for IT-Security</p>
    <p>Chair for Network and Data Security</p>
    <p>Revisiting SSL/TLS Implementations - New Bleichenbacher Side Channels and Attacks 23rd USENIX Security Symposium | San Diego, CA | August, 20-22, 2014</p>
    <p>Bleichenbachers Attack JSSE  Exceptions Cause Different Processing Time</p>
    <p>Optimized Algorithm (Bardou et al.)</p>
    <p>2048 bit</p>
    <p>Strong Oracle (no TLS Version Check)</p>
    <p>Optimized PKCS#1 v1.5 Structure to Speed up Algorithm</p>
    <p>~ 19,5 hours and ~18,6k queries</p>
  </div>
  <div class="page">
    <p>Horst Grtz Institute for IT-Security</p>
    <p>Chair for Network and Data Security</p>
    <p>Revisiting SSL/TLS Implementations - New Bleichenbacher Side Channels and Attacks 23rd USENIX Security Symposium | San Diego, CA | August, 20-22, 2014</p>
    <p>Bleichenbachers Attack New Side-Channels</p>
    <p>Force Different Error Messages</p>
    <p>Implementation Bug</p>
    <p>Force Different Processing Time</p>
    <p>Random Number Generation</p>
    <p>Exceptions</p>
    <p>Special Behaviour</p>
  </div>
  <div class="page">
    <p>Horst Grtz Institute for IT-Security</p>
    <p>Chair for Network and Data Security</p>
    <p>Revisiting SSL/TLS Implementations - New Bleichenbacher Side Channels and Attacks 23rd USENIX Security Symposium | San Diego, CA | August, 20-22, 2014</p>
    <p>Bleichenbachers Attack Cavium  Misbehaving Hardware Accelerators</p>
    <p>Hardware did not check the first bytes value</p>
  </div>
  <div class="page">
    <p>Horst Grtz Institute for IT-Security</p>
    <p>Chair for Network and Data Security</p>
    <p>Revisiting SSL/TLS Implementations - New Bleichenbacher Side Channels and Attacks 23rd USENIX Security Symposium | San Diego, CA | August, 20-22, 2014</p>
    <p>Bleichenbachers Attack Cavium  Misbehaving Hardware Accelerators</p>
    <p>~ 15 s</p>
  </div>
  <div class="page">
    <p>Horst Grtz Institute for IT-Security</p>
    <p>Chair for Network and Data Security</p>
    <p>Revisiting SSL/TLS Implementations - New Bleichenbacher Side Channels and Attacks 23rd USENIX Security Symposium | San Diego, CA | August, 20-22, 2014</p>
    <p>Bleichenbachers Attack Cavium  Misbehaving Hardware Accelerators</p>
    <p>Missing First Byte Check Requires Algorithm Changes (Oracle is Much</p>
    <p>Weaker)</p>
    <p>2048 bit</p>
    <p>~ 40 hours and ~7371 queries</p>
  </div>
  <div class="page">
    <p>Horst Grtz Institute for IT-Security</p>
    <p>Chair for Network and Data Security</p>
    <p>Revisiting SSL/TLS Implementations - New Bleichenbacher Side Channels and Attacks 23rd USENIX Security Symposium | San Diego, CA | August, 20-22, 2014</p>
    <p>Result Summary</p>
  </div>
  <div class="page">
    <p>Horst Grtz Institute for IT-Security</p>
    <p>Chair for Network and Data Security</p>
    <p>Revisiting SSL/TLS Implementations - New Bleichenbacher Side Channels and Attacks 23rd USENIX Security Symposium | San Diego, CA | August, 20-22, 2014</p>
    <p>Chris Meyer</p>
    <p>christopher.meyer@rub.de</p>
    <p>@armoredbarista</p>
    <p>armoredbarista.blogspot.com</p>
    <p>[ Source https://twitter.com/ ]</p>
  </div>
</Presentation>
