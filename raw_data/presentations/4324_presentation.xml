<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>A Model of BGP Routing for Network Engineering</p>
    <p>Nick Feamster, MIT Jared Winick, Lockheed Martin</p>
    <p>Jennifer Rexford, AT&amp;T Labs--Research</p>
  </div>
  <div class="page">
    <p>Problem: Network operators must tune routing protocols to provide good performace in the face of changing conditions.</p>
    <p>Today: Tweak configuration and pray. Our Solution: Compute how a configuration</p>
    <p>change will affect traffic flow before deployment.</p>
  </div>
  <div class="page">
    <p>Overview</p>
    <p>Internet composed of autonomous systems (ASes) Multiple connections between ASes</p>
  </div>
  <div class="page">
    <p>Network Operators Must Respond to Events</p>
    <p>Changes in Traffic Volume</p>
    <p>Congestion!</p>
  </div>
  <div class="page">
    <p>Network Operators Must Respond to Events</p>
    <p>Changes in Traffic Volume</p>
    <p>Note: The network does not adapt automatically!</p>
    <p>Policy Change!</p>
  </div>
  <div class="page">
    <p>Network Operators Must Respond to Events</p>
    <p>Changes in Link Capacity</p>
    <p>Increased Capacity</p>
  </div>
  <div class="page">
    <p>Network Operators Must Respond to Events</p>
    <p>Changes in Link Capacity</p>
    <p>Increased CapacityPolicy Change</p>
  </div>
  <div class="page">
    <p>Predicting Traffic Flow: Many Requirements</p>
    <p>Knowledge about traffic volumes Information about available routes Prediction of paths between routers within the AS</p>
    <p>Our contribution: Modeling how each router within one autonomous system (AS)</p>
    <p>will select routes to external destinations.</p>
    <p>Implemented in a accurate and fast tool that has been evaluated and tested on the AT&amp;T IP backbone.</p>
  </div>
  <div class="page">
    <p>Strawman #1: Simulation</p>
    <p>Observation: If a routing system converges to a unique outcome, the</p>
    <p>outcome is independent of the order that routers exchange messages and select paths.</p>
    <p>Advantages Time ordering of messages does not affect outcome. Simulation will arrive at correct answer. Disadvantages Operators must know outcomes, not dynamics. Many possible message orderings: potentially slow.</p>
    <p>Simulation: Accurate, but slow.</p>
  </div>
  <div class="page">
    <p>Strawman #2: Rank Routes, Pick the Best One</p>
    <p>Problem Incorrect answer! Two Artifacts of Border Gateway Protocol (BGP) Impossible to impose a complete ranking of routes</p>
    <p>at a single router. Ranking between two routes can depend on presence (or absence)</p>
    <p>of other routes.</p>
    <p>All routes may not be visible at every router. Set of routes learned at one router depend on route selection at</p>
    <p>other routers.</p>
    <p>Note: These &quot;artifacts&quot; provide flexibility and scalability!</p>
  </div>
  <div class="page">
    <p>Instead: Model a Certain Message Ordering</p>
    <p>Step 1: Egress routers compute best routes. Outcome: A set of egress routers for each destination.</p>
    <p>&quot;Egress&quot; Routers</p>
    <p>Step 2: Egress routers propagate these routes to other routers within the AS.</p>
    <p>Outcome: Each router in the AS selects a egress router.</p>
  </div>
  <div class="page">
    <p>Instead: Model a Certain Message Ordering</p>
    <p>Step 1: Egress routers compute best routes. Outcome: A set of egress routers for each destination.</p>
    <p>Operators adjust BGP policies at egress routers to affect this set.</p>
    <p>Step 2: Egress routers propagate these routes to other routers within the AS.</p>
    <p>Outcome: Each router in the AS selects a egress router.</p>
    <p>Operators adjust internal routing to affect exit point selection.</p>
  </div>
  <div class="page">
    <p>Step 1: Egress Routers Compute Best Routes</p>
    <p>Problem: Ranking of routes at one router can depend on</p>
    <p>routes learned at other routers.</p>
    <p>Green BlueGreen</p>
    <p>&gt; &gt; Red</p>
    <p>&gt;BlueGreenRed &gt; When green present:</p>
    <p>&gt;RedBlue When green not present:</p>
    <p>MED=10MED=20</p>
    <p>A B</p>
    <p>Solution: Compute best local routes where possible, and propagate the effects.</p>
  </div>
  <div class="page">
    <p>Step 1: Egress Routers Compute Best Routes</p>
    <p>Algorithm: 1. Consider locally-best route at one router. 2. Eliminate routes as follows: If the route is worse than the locally-best route at another router,</p>
    <p>eliminate it.</p>
    <p>Else, select it, and eliminate all other routes at that router.</p>
    <p>Green</p>
    <p>BlueGreen &gt; &gt; Red</p>
    <p>&gt;BlueGreenRed &gt; When green present:</p>
    <p>&gt;RedBlue When green not present:</p>
    <p>MED=10MED=20</p>
    <p>A B</p>
  </div>
  <div class="page">
    <p>Step 1: Egress Routers Compute Best Routes</p>
    <p>Algorithm: 1. Consider locally-best route at one router. 2. Eliminate routes as follows: If the route is worse than the locally-best route at another router,</p>
    <p>eliminate it.</p>
    <p>Else, select it, and eliminate all other routes at that router.</p>
    <p>Green</p>
    <p>BlueGreen &gt; &gt; Red</p>
    <p>&gt;BlueGreenRed &gt; When green present:</p>
    <p>&gt;RedBlue When green not present:</p>
    <p>MED=10MED=20</p>
    <p>A B</p>
  </div>
  <div class="page">
    <p>Model a Certain Message Ordering</p>
    <p>Step 1: Egress routers compute best routes. Outcome: Each egress router has a route to the destination.</p>
    <p>Step 2: Egress routers propagate these routes to other routers within the AS.</p>
    <p>Outcome: Each router in the AS selects a egress router.</p>
  </div>
  <div class="page">
    <p>Step 2: Choosing the Best Egress Router</p>
    <p>Problem: Route at closest egress may not be visible.</p>
    <p>RR1 RR2</p>
    <p>CA B</p>
  </div>
  <div class="page">
    <p>Step 2: Choosing the Best Egress Router</p>
    <p>Problem: Route at closest egress may not be visible.</p>
    <p>RR1 RR2</p>
    <p>CA B</p>
  </div>
  <div class="page">
    <p>Step 2: Choosing the Best Egress Router</p>
    <p>Problem: Route at closest egress may not be visible.</p>
    <p>RR1 RR2</p>
    <p>C</p>
    <p>Closest Egress</p>
    <p>A B</p>
  </div>
  <div class="page">
    <p>Step 2: Choosing the Best Egress Router</p>
    <p>Problem: Route at closest egress may not be visible.</p>
    <p>Closest Egress</p>
    <p>RR1 RR2</p>
    <p>CA BRR1s closest egress is A.</p>
    <p>RR2 and C select A.</p>
    <p>Solution: First, compute routes at routers for which available</p>
    <p>routes are known. Propagate effects.</p>
  </div>
  <div class="page">
    <p>Step 2: Choosing the Best Egress Router</p>
    <p>Algorithm (Graph Walk): 1. Assign routes to egress routers. (done in Step 1) 2. Assign routes to the parents of these routers. Once at top level of the hierarchy, proceed down.</p>
    <p>RR1 RR2</p>
    <p>CA B</p>
  </div>
  <div class="page">
    <p>Step 2: Choosing the Best Egress Router</p>
    <p>Algorithm (Graph Walk): 1. Assign routes to egress routers. (done in Step 1) 2. Assign routes to the parents of these routers. Once at top level of the hierarchy, proceed down.</p>
    <p>RR1 RR2</p>
    <p>CA B</p>
  </div>
  <div class="page">
    <p>Step 2: Choosing the Best Egress Router</p>
    <p>Algorithm (Graph Walk): 1. Assign routes to egress routers. (done in Step 1) 2. Assign routes to the parents of these routers. Once at top level of the hierarchy, proceed down.</p>
    <p>RR1 RR2</p>
    <p>CA B</p>
  </div>
  <div class="page">
    <p>Step 2: Choosing the Best Egress Router</p>
    <p>Constraints: 1. No partitions in the internal BGP graph. 2. Routers are &quot;closer&quot; to clients than non-clients. 3. No cycles in the internal BGP graph.</p>
    <p>These constraints can be checked with static analysis.</p>
  </div>
  <div class="page">
    <p>Summary: Model of BGP Route Selection</p>
    <p>Step 1: Egress routers compute best routes. Outcome: Each egress router has a route to the destination.</p>
    <p>r2 r3r1 r4</p>
    <p>(r1, r2, r3, r4)</p>
    <p>Output:</p>
    <p>Input:</p>
    <p>(r1, r4)</p>
    <p>Step 2: Intra-AS propagation. Outcome: Each router in the AS selects a egress router.</p>
    <p>Output:</p>
    <p>Input: (r1, r4)</p>
    <p>A &gt; r1 B &gt; r4 C &gt; r4</p>
    <p>r1 r4</p>
    <p>A B</p>
    <p>C</p>
  </div>
  <div class="page">
    <p>Summary: Model of BGP Route Selection</p>
    <p>Step 1: Egress routers compute best routes. Outcome: Each egress router has a route to the destination.</p>
    <p>r2 r3r1 r4</p>
    <p>(r1, r2, r3, r4)</p>
    <p>Output:</p>
    <p>Input:</p>
    <p>(r1, r4)</p>
    <p>Step 2: Intra-AS propagation. Outcome: Each router in the AS selects a egress router.</p>
    <p>Output:</p>
    <p>Input: (r1, r4)</p>
    <p>A &gt; r1 B &gt; r4 C &gt; r4</p>
    <p>r1 r4</p>
    <p>A B</p>
    <p>C</p>
  </div>
  <div class="page">
    <p>Implementation is Efficient and Accurate</p>
    <p>&lt; 1 second to compute effects of a policy change on</p>
    <p>AT&amp;T network. (100s of routers, ~ 90k destinations) Could be used as the &quot;inner loop&quot; for optimization. Model is accurate in more than 99% of all cases.</p>
    <p>Router # Predictions Total Errors</p>
    <p>RR1 89,343 554 (0.620%)</p>
    <p>RR2 88,647 394 (0.444%)</p>
    <p>AR1 88,649 391 (0.441%)</p>
    <p>AR2 76,733 511 (0.666%)</p>
  </div>
  <div class="page">
    <p>Conclusion</p>
    <p>Operators must tune routing protocols as network</p>
    <p>conditions change. Unfortunately, predicting the effects of these changes is difficult. We present a model of BGP routing. Useful for offline computation Fast and accurate Two artifacts complicate modeling BGP No total ordering (MED attribute) Limited route visibility (route reflection)</p>
    <p>In the future, we should design distributed routing protocols in ways that facilitate modeling.</p>
  </div>
</Presentation>
