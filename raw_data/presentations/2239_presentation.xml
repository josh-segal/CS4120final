<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Filesystem Aging: Its More Usage than Fullness</p>
    <p>Alex Conway, Eric Knorr, Yizheng Jiao, Michael A. Bender, William Jannen, Rob Johnson, Donald Porter, and Martin Farach-Colton</p>
  </div>
  <div class="page">
    <p>What is filesystem aging?</p>
    <p>Aging is fragmentation over time</p>
  </div>
  <div class="page">
    <p>What is filesystem aging?</p>
    <p>Aging is fragmentation over time</p>
  </div>
  <div class="page">
    <p>What is filesystem aging?</p>
    <p>Aging is fragmentation over time</p>
    <p>Performance</p>
    <p>Fi le</p>
    <p>S ys</p>
    <p>te m</p>
    <p>S pe</p>
    <p>ed</p>
    <p>Time</p>
  </div>
  <div class="page">
    <p>Is aging a problem?</p>
  </div>
  <div class="page">
    <p>Is aging a problem?</p>
  </div>
  <div class="page">
    <p>Chris Hoffman at howtogeek.com says:</p>
    <p>Linuxs ext2, ext3, and ext4 file systems [are] designed to avoid fragmentation in normal use.</p>
    <p>If you do have problems with fragmentation on Linux, you probably need a larger hard disk.</p>
    <p>Is aging a problem?</p>
  </div>
  <div class="page">
    <p>Chris Hoffman at howtogeek.com says:</p>
    <p>Linuxs ext2, ext3, and ext4 file systems [are] designed to avoid fragmentation in normal use.</p>
    <p>If you do have problems with fragmentation on Linux, you probably need a larger hard disk.</p>
    <p>Modern Linux filesystems keep fragmentation at a minimumTherefore it</p>
    <p>is not necessary to worry about fragmentation in a Linux system.</p>
    <p>Is aging a problem?</p>
  </div>
  <div class="page">
    <p>Chris Hoffman at howtogeek.com says:</p>
    <p>Linuxs ext2, ext3, and ext4 file systems [are] designed to avoid fragmentation in normal use.</p>
    <p>If you do have problems with fragmentation on Linux, you probably need a larger hard disk.</p>
    <p>Modern Linux filesystems keep fragmentation at a minimumTherefore it</p>
    <p>is not necessary to worry about fragmentation in a Linux system.</p>
    <p>Is aging a problem?</p>
    <p>Aging is not a problem</p>
    <p>(unless your disk is full)</p>
  </div>
  <div class="page">
    <p>Chris Hoffman at howtogeek.com says:</p>
    <p>Linuxs ext2, ext3, and ext4 file systems [are] designed to avoid fragmentation in normal use.</p>
    <p>If you do have problems with fragmentation on Linux, you probably need a larger hard disk.</p>
    <p>Modern Linux filesystems keep fragmentation at a minimumTherefore it</p>
    <p>is not necessary to worry about fragmentation in a Linux system.</p>
    <p>Is aging a problem?</p>
    <p>Aging is not a problem</p>
    <p>(unless your disk is full)</p>
  </div>
  <div class="page">
    <p>Recent work: Aging is a problem!</p>
  </div>
  <div class="page">
    <p>Recent work on aging</p>
  </div>
  <div class="page">
    <p>Recent work on aging</p>
    <p>File Systems Fated for Senescence? Nonsense, says Science! Conway et. al. FAST 2017</p>
  </div>
  <div class="page">
    <p>Recent work on aging</p>
    <p>File Systems Fated for Senescence? Nonsense, says Science! Conway et. al. FAST 2017</p>
    <p>On modern filesystems, aging is severe and happens quickly even if your disk is almost empty.</p>
  </div>
  <div class="page">
    <p>Recent work on aging</p>
    <p>File Systems Fated for Senescence? Nonsense, says Science! Conway et. al. FAST 2017</p>
    <p>Geriatrix: Aging what you see and what you dont see. A file system aging approach for modern storage systems Kadekodi et. al. ATC 2018</p>
    <p>On modern filesystems, aging is severe and happens quickly even if your disk is almost empty.</p>
  </div>
  <div class="page">
    <p>Recent work on aging</p>
    <p>File Systems Fated for Senescence? Nonsense, says Science! Conway et. al. FAST 2017</p>
    <p>Geriatrix: Aging what you see and what you dont see. A file system aging approach for modern storage systems Kadekodi et. al. ATC 2018</p>
    <p>On modern filesystems, aging is severe and happens quickly even if your disk is almost empty.</p>
    <p>Real world file systems show a lot of aging, as well as free space fragmentation.</p>
  </div>
  <div class="page">
    <p>Recent work on aging</p>
    <p>File Systems Fated for Senescence? Nonsense, says Science! Conway et. al. FAST 2017</p>
    <p>Geriatrix: Aging what you see and what you dont see. A file system aging approach for modern storage systems Kadekodi et. al. ATC 2018</p>
    <p>On modern filesystems, aging is severe and happens quickly even if your disk is almost empty.</p>
    <p>Real world file systems show a lot of aging, as well as free space fragmentation.</p>
    <p>Claim: Only happens when</p>
    <p>the disk is full</p>
  </div>
  <div class="page">
    <p>Recent work on aging</p>
    <p>File Systems Fated for Senescence? Nonsense, says Science! Conway et. al. FAST 2017</p>
    <p>Geriatrix: Aging what you see and what you dont see. A file system aging approach for modern storage systems Kadekodi et. al. ATC 2018</p>
    <p>On modern filesystems, aging is severe and happens quickly even if your disk is almost empty.</p>
    <p>Real world file systems show a lot of aging, as well as free space fragmentation.</p>
    <p>Aging is a problem</p>
    <p>Disk fullness ????</p>
    <p>Claim: Only happens when</p>
    <p>the disk is full</p>
  </div>
  <div class="page">
    <p>Recent work on aging</p>
    <p>File Systems Fated for Senescence? Nonsense, says Science! Conway et. al. FAST 2017</p>
    <p>Geriatrix: Aging what you see and what you dont see. A file system aging approach for modern storage systems Kadekodi et. al. ATC 2018</p>
    <p>On modern filesystems, aging is severe and happens quickly even if your disk is almost empty.</p>
    <p>Real world file systems show a lot of aging, as well as free space fragmentation.</p>
    <p>Aging is a problem</p>
    <p>Disk fullness ????</p>
    <p>Claim: Only happens when</p>
    <p>the disk is full</p>
  </div>
  <div class="page">
    <p>Flavors of Aging</p>
  </div>
  <div class="page">
    <p>Flavors of Aging</p>
    <p>Read Aging Write Aging Free Space Fragmentation</p>
  </div>
  <div class="page">
    <p>Flavors of Aging</p>
    <p>Read Aging Write Aging Free Space Fragmentation</p>
    <p>Fragmentation of pages which are read together</p>
    <p>Fragmentation of pages which are written together</p>
    <p>Fragmentation of the available free space</p>
    <p>OR Additional work when writing</p>
  </div>
  <div class="page">
    <p>Flavors of Aging</p>
    <p>Different types of aging interact</p>
    <p>Free Space Fragmentation</p>
    <p>Fragmentation of the available free space</p>
  </div>
  <div class="page">
    <p>Flavors of Aging</p>
    <p>Different types of aging interact</p>
    <p>Free Space Fragmentation</p>
    <p>Fragmentation of the available free space</p>
    <p>A filesystem: each square represents a page, different colors are different files</p>
  </div>
  <div class="page">
    <p>Flavors of Aging</p>
    <p>Different types of aging interact</p>
    <p>Free Space Fragmentation</p>
    <p>Fragmentation of the available free space</p>
    <p>A filesystem: each square represents a page, different colors are different files</p>
    <p>How do we write this large file?</p>
  </div>
  <div class="page">
    <p>Flavors of Aging</p>
    <p>Different types of aging interact</p>
    <p>Free Space Fragmentation</p>
    <p>Fragmentation of the available free space</p>
    <p>A filesystem: each square represents a page, different colors are different files</p>
    <p>How do we write this large file?</p>
    <p>write it to available blocks</p>
  </div>
  <div class="page">
    <p>Flavors of Aging</p>
    <p>Different types of aging interact</p>
    <p>Free Space Fragmentation</p>
    <p>Fragmentation of the available free space</p>
    <p>A filesystem: each square represents a page, different colors are different files</p>
    <p>How do we write this large file?</p>
    <p>write it to available blocks both read and write aging</p>
  </div>
  <div class="page">
    <p>Flavors of Aging</p>
    <p>Different types of aging interact</p>
    <p>Free Space Fragmentation</p>
    <p>Fragmentation of the available free space</p>
    <p>A filesystem: each square represents a page, different colors are different files</p>
    <p>How do we write this large file?</p>
  </div>
  <div class="page">
    <p>Flavors of Aging</p>
    <p>Different types of aging interact</p>
    <p>Free Space Fragmentation</p>
    <p>Fragmentation of the available free space</p>
    <p>A filesystem: each square represents a page, different colors are different files</p>
    <p>How do we write this large file?</p>
    <p>defragment the free space</p>
  </div>
  <div class="page">
    <p>Flavors of Aging</p>
    <p>Different types of aging interact</p>
    <p>Free Space Fragmentation</p>
    <p>Fragmentation of the available free space</p>
    <p>A filesystem: each square represents a page, different colors are different files</p>
    <p>How do we write this large file?</p>
    <p>defragment the free space lots of write aging</p>
  </div>
  <div class="page">
    <p>How much aging is caused by disk fullness?</p>
  </div>
  <div class="page">
    <p>This Work</p>
    <p>This work tries to answer: How much aging is caused by disk fullness?</p>
  </div>
  <div class="page">
    <p>This Work</p>
    <p>This work tries to answer: How much aging is caused by disk fullness?</p>
    <p>Hypothesis: A lot</p>
  </div>
  <div class="page">
    <p>This Work</p>
    <p>This work tries to answer: How much aging is caused by disk fullness?</p>
    <p>Hypothesis: A lot</p>
    <p>We need a workload that:  reflects actual use over many years  can be generated and replayed quickly  can operate on a nearly full disk</p>
  </div>
  <div class="page">
    <p>Git Replay Benchmark</p>
  </div>
  <div class="page">
    <p>We need a workload that:  reflects actual use over many years  can be generated and replayed quickly  can operate on a nearly full disk</p>
    <p>Lets model a very simple case: Developers</p>
    <p>Git Replay Benchmark</p>
  </div>
  <div class="page">
    <p>Git Replay Benchmark</p>
    <p>get coffee</p>
    <p>We need a workload that:  reflects actual use over many years  can be generated and replayed quickly  can operate on a nearly full disk</p>
    <p>Lets model a very simple case: Developers</p>
  </div>
  <div class="page">
    <p>Git Replay Benchmark</p>
    <p>git pull</p>
    <p>get coffee git pull</p>
    <p>We need a workload that:  reflects actual use over many years  can be generated and replayed quickly  can operate on a nearly full disk</p>
    <p>Lets model a very simple case: Developers</p>
  </div>
  <div class="page">
    <p>Git Replay Benchmark</p>
    <p>git pull</p>
    <p>make</p>
    <p>get coffee git pull make</p>
    <p>We need a workload that:  reflects actual use over many years  can be generated and replayed quickly  can operate on a nearly full disk</p>
    <p>Lets model a very simple case: Developers</p>
  </div>
  <div class="page">
    <p>Git Replay Benchmark</p>
    <p>git pull</p>
    <p>make</p>
    <p>get coffee git pull make get coffee</p>
    <p>We need a workload that:  reflects actual use over many years  can be generated and replayed quickly  can operate on a nearly full disk</p>
    <p>Lets model a very simple case: Developers</p>
  </div>
  <div class="page">
    <p>Git Replay Benchmark</p>
    <p>git pull</p>
    <p>make</p>
    <p>get coffee git pull make get coffee git pull</p>
    <p>We need a workload that:  reflects actual use over many years  can be generated and replayed quickly  can operate on a nearly full disk</p>
    <p>Lets model a very simple case: Developers</p>
  </div>
  <div class="page">
    <p>Git Replay Benchmark</p>
    <p>git pull</p>
    <p>make</p>
    <p>git pull</p>
    <p>make</p>
    <p>get coffee git pull make get coffee git pull add awesome features</p>
    <p>We need a workload that:  reflects actual use over many years  can be generated and replayed quickly  can operate on a nearly full disk</p>
    <p>Lets model a very simple case: Developers</p>
  </div>
  <div class="page">
    <p>Git Replay Benchmark</p>
    <p>git pull</p>
    <p>make</p>
    <p>git pull</p>
    <p>make</p>
    <p>get coffee git pull make get coffee git pull add awesome features get coffee</p>
    <p>We need a workload that:  reflects actual use over many years  can be generated and replayed quickly  can operate on a nearly full disk</p>
    <p>Lets model a very simple case: Developers</p>
  </div>
  <div class="page">
    <p>Git Replay Benchmark</p>
    <p>git pull</p>
    <p>make</p>
    <p>git pull</p>
    <p>make</p>
    <p>get coffee git pull make get coffee git pull add awesome features get coffee git pull</p>
    <p>We need a workload that:  reflects actual use over many years  can be generated and replayed quickly  can operate on a nearly full disk</p>
    <p>Lets model a very simple case: Developers</p>
  </div>
  <div class="page">
    <p>Git Replay Benchmark</p>
    <p>get coffee git pull make get coffee git pull add awesome features get coffee git pull fix bugs . . .</p>
    <p>git pull</p>
    <p>make</p>
    <p>git pull</p>
    <p>make</p>
    <p>We need a workload that:  reflects actual use over many years  can be generated and replayed quickly  can operate on a nearly full disk</p>
    <p>Lets model a very simple case: Developers</p>
  </div>
  <div class="page">
    <p>Git Replay Benchmark</p>
    <p>get coffee git pull make get coffee git pull add awesome features get coffee git pull fix bugs . . .</p>
    <p>git pull</p>
    <p>make</p>
    <p>git pull</p>
    <p>make</p>
    <p>We need a workload that:  reflects actual use over many years  can be generated and replayed quickly  can operate on a nearly full disk</p>
    <p>Lets model a very simple case: Developers</p>
  </div>
  <div class="page">
    <p>Git Replay Benchmark</p>
    <p>get coffee git pull make get coffee git pull add awesome features get coffee git pull fix bugs . . .</p>
    <p>git pull</p>
    <p>make</p>
    <p>git pull</p>
    <p>make</p>
    <p>We need a workload that:  reflects actual use over many years  can be generated and replayed quickly  can operate on a nearly full disk</p>
    <p>Lets model a very simple case: Developers</p>
  </div>
  <div class="page">
    <p>Git Replay Benchmark</p>
    <p>get coffee git pull make get coffee git pull add awesome features get coffee git pull fix bugs . . .</p>
    <p>git pull</p>
    <p>make</p>
    <p>git pull</p>
    <p>make</p>
    <p>We can simulate a developer by replaying Git histories</p>
  </div>
  <div class="page">
    <p>Git Replay Benchmark</p>
    <p>Use the Linux kernel repo from github.com</p>
    <p>Do 100 git pulls</p>
    <p>Measure Performance</p>
  </div>
  <div class="page">
    <p>How to Measure Aging</p>
  </div>
  <div class="page">
    <p>Measuring Aging</p>
    <p>time grep -r random_string /path/to/filesystem</p>
    <p>dir</p>
    <p>file1 file2 file3 file4</p>
    <p>Measure read aging by reading through all the files in directory order</p>
    <p>How to measure read aging</p>
  </div>
  <div class="page">
    <p>Measuring Aging</p>
    <p>time grep -r random_string /path/to/filesystem</p>
    <p>dir</p>
    <p>file1 file2 file3 file4</p>
    <p>Measure read aging by reading through all the files in directory order</p>
    <p>How to measure read aging</p>
  </div>
  <div class="page">
    <p>Measuring Aging</p>
    <p>time grep -r random_string /path/to/filesystem</p>
    <p>dir</p>
    <p>file1 file2 file3 file4</p>
    <p>Measure read aging by reading through all the files in directory order</p>
    <p>How to measure read aging</p>
  </div>
  <div class="page">
    <p>Measuring Aging</p>
    <p>time grep -r random_string /path/to/filesystem</p>
    <p>dir</p>
    <p>file1 file2 file3 file4</p>
    <p>Measure read aging by reading through all the files in directory order</p>
    <p>How to measure read aging</p>
  </div>
  <div class="page">
    <p>Measuring Aging</p>
    <p>time grep -r random_string /path/to/filesystem</p>
    <p>dir</p>
    <p>file1 file2 file3 file4</p>
    <p>Measure read aging by reading through all the files in directory order</p>
    <p>How to measure read aging</p>
  </div>
  <div class="page">
    <p>Measuring Aging</p>
    <p>time grep -r random_string /path/to/filesystem</p>
    <p>dir</p>
    <p>file1 file2 file3 file4</p>
    <p>Measure read aging by reading through all the files in directory order</p>
    <p>How to measure read aging</p>
  </div>
  <div class="page">
    <p>Measuring Aging</p>
    <p>time grep -r random_string /path/to/filesystem</p>
    <p>dir</p>
    <p>file1 file2 file3 file4</p>
    <p>Measure read aging by reading through all the files in directory order</p>
    <p>How to measure read aging</p>
  </div>
  <div class="page">
    <p>Measuring Aging</p>
    <p>time grep -r random_string /path/to/filesystem</p>
    <p>dir</p>
    <p>file1 file2 file3 file4</p>
    <p>Measure read aging by reading through all the files in directory order</p>
    <p>How to measure read aging</p>
  </div>
  <div class="page">
    <p>Measuring Aging</p>
    <p>time grep -r random_string /path/to/filesystem</p>
    <p>dir</p>
    <p>file1 file2 file3 file4</p>
    <p>Measure read aging by reading through all the files in directory order</p>
    <p>How to measure read aging</p>
  </div>
  <div class="page">
    <p>Measuring Aging</p>
    <p>time grep -r random_string /path/to/filesystem</p>
    <p>dir</p>
    <p>file1 file2 file3 file4</p>
    <p>Measure read aging by reading through all the files in directory order</p>
    <p>How to measure read aging</p>
  </div>
  <div class="page">
    <p>Measuring Aging</p>
    <p>time grep -r random_string /path/to/filesystem</p>
    <p>dir</p>
    <p>file1 file2 file3 file4</p>
    <p>Measure read aging by reading through all the files in directory order</p>
    <p>Normalize by filesystem size</p>
    <p>How to measure read aging</p>
  </div>
  <div class="page">
    <p>Git Replay Benchmark</p>
    <p>Use the Linux kernel repo from github.com</p>
    <p>Do 100 git pulls</p>
    <p>Measure Performance</p>
  </div>
  <div class="page">
    <p>Git Replay Benchmark</p>
    <p>Use the Linux kernel repo from github.com</p>
    <p>Do 100 git pulls</p>
    <p>Measure Performance</p>
    <p>But what about when the disk fills up?</p>
  </div>
  <div class="page">
    <p>Git Replay Benchmark (full disk edition)</p>
  </div>
  <div class="page">
    <p>Git Replay Benchmark (full disk edition)</p>
    <p>But what about when the disk fills up?</p>
    <p>Use multiple copies of the repo</p>
    <p>Linux1 Linux2</p>
    <p>Linux4Linux3</p>
  </div>
  <div class="page">
    <p>Git Replay Benchmark (full disk edition)</p>
    <p>But what about when the disk fills up?</p>
    <p>Use multiple copies of the repo</p>
    <p>Linux1 Linux2</p>
    <p>Linux4Linux3</p>
    <p>git pull</p>
  </div>
  <div class="page">
    <p>Git Replay Benchmark (full disk edition)</p>
    <p>But what about when the disk fills up?</p>
    <p>Use multiple copies of the repo</p>
    <p>Linux1 Linux2</p>
    <p>Linux4Linux3</p>
    <p>git pull git pull</p>
  </div>
  <div class="page">
    <p>Git Replay Benchmark (full disk edition)</p>
    <p>But what about when the disk fills up?</p>
    <p>Use multiple copies of the repo</p>
    <p>Linux1 Linux2</p>
    <p>Linux4Linux3</p>
    <p>git pull git pull git pull</p>
  </div>
  <div class="page">
    <p>Git Replay Benchmark (full disk edition)</p>
    <p>But what about when the disk fills up?</p>
    <p>Use multiple copies of the repo</p>
    <p>Linux1 Linux2</p>
    <p>Linux4Linux3</p>
    <p>git pull git pull git pull git pull</p>
  </div>
  <div class="page">
    <p>Git Replay Benchmark (full disk edition)</p>
    <p>But what about when the disk fills up?</p>
    <p>Use multiple copies of the repo</p>
    <p>Linux1 Linux2</p>
    <p>Linux4Linux3</p>
    <p>git pull git pull git pull</p>
    <p>git pull git pull</p>
    <p>FAIL</p>
  </div>
  <div class="page">
    <p>Git Replay Benchmark (full disk edition)</p>
    <p>But what about when the disk fills up?</p>
    <p>Use multiple copies of the repo</p>
    <p>Linux1 Linux2</p>
    <p>Linux4Linux3</p>
    <p>git pull git pull git pull</p>
    <p>git pull git pull</p>
    <p>FAIL</p>
    <p>When the disk fills and a pull fails, delete one</p>
  </div>
  <div class="page">
    <p>Full Disk Git Aging on HDD</p>
  </div>
  <div class="page">
    <p>gr ep</p>
    <p>ti m</p>
    <p>e (s</p>
    <p>ec on</p>
    <p>ds /</p>
    <p>G iB</p>
    <p>)</p>
    <p>number of pulls performed 0 1000 2000 3000 4000 5000 6000 7000 8000 9000 10000</p>
    <p>ext4 full aged</p>
    <p>Full Disk Git Aging on HDD (ext4)</p>
    <p>Full: Empty: Unaged:</p>
    <p>System Details:</p>
    <p>Dell PowerEdge T130</p>
    <p>Ubuntu version 18.04 LTS Linux kernel v 4.15</p>
  </div>
  <div class="page">
    <p>gr ep</p>
    <p>ti m</p>
    <p>e (s</p>
    <p>ec on</p>
    <p>ds /</p>
    <p>G iB</p>
    <p>)</p>
    <p>number of pulls performed 0 1000 2000 3000 4000 5000 6000 7000 8000 9000 10000</p>
    <p>ext4 full aged</p>
    <p>Full Disk Git Aging on HDD (ext4)</p>
    <p>Full: Empty: Unaged:</p>
    <p>System Details:</p>
    <p>Dell PowerEdge T130</p>
    <p>Ubuntu version 18.04 LTS Linux kernel v 4.15</p>
    <p>The git replay benchmark quickly generates a big</p>
    <p>drop in performance</p>
  </div>
  <div class="page">
    <p>gr ep</p>
    <p>ti m</p>
    <p>e (s</p>
    <p>ec on</p>
    <p>ds /</p>
    <p>G iB</p>
    <p>)</p>
    <p>number of pulls performed 0 1000 2000 3000 4000 5000 6000 7000 8000 9000 10000</p>
    <p>ext4 full aged</p>
    <p>Full Disk Git Aging on HDD (ext4)</p>
    <p>Full: Empty: Unaged:</p>
    <p>System Details:</p>
    <p>Dell PowerEdge T130</p>
    <p>Ubuntu version 18.04 LTS Linux kernel v 4.15</p>
    <p>The git replay benchmark quickly generates a big</p>
    <p>drop in performance</p>
    <p>But how much is from disk fullness?</p>
  </div>
  <div class="page">
    <p>Need to compare to non-full disks</p>
  </div>
  <div class="page">
    <p>How to compare to non-full disks</p>
    <p>Linux1 Linux2</p>
    <p>Linux4Linux3</p>
    <p>We cant just use a larger disk with the git replay benchmark</p>
    <p>Linux6Linux5</p>
    <p>Linux8Linux7</p>
    <p>Itll still just be full!</p>
  </div>
  <div class="page">
    <p>How to compare to non-full disks</p>
    <p>Linux1 Linux2</p>
    <p>Linux4Linux3</p>
    <p>We cant just use a larger disk with the git replay benchmark</p>
    <p>Itll still just be full!</p>
    <p>We record the operations on the small disk and replay them on the larger disk</p>
  </div>
  <div class="page">
    <p>How to compare to non-full disks</p>
    <p>Linux1 Linux2</p>
    <p>Linux4Linux3</p>
    <p>We cant just use a larger disk with the git replay benchmark</p>
    <p>Itll still just be full!</p>
    <p>We record the operations on the small disk and replay them on the larger disk</p>
  </div>
  <div class="page">
    <p>How to compare to non-full disks</p>
    <p>Linux1 Linux2</p>
    <p>Linux4Linux3</p>
    <p>We cant just use a larger disk with the git replay benchmark</p>
    <p>Itll still just be full!</p>
    <p>We record the operations on the small disk and replay them on the larger disk</p>
  </div>
  <div class="page">
    <p>How to compare to non-full disks</p>
    <p>Linux1 Linux2</p>
    <p>Linux4Linux3</p>
    <p>We cant just use a larger disk with the git replay benchmark</p>
    <p>Itll still just be full!</p>
    <p>We record the operations on the small disk and replay them on the larger disk</p>
  </div>
  <div class="page">
    <p>How to compare to non-full disks</p>
    <p>Linux1 Linux2</p>
    <p>Linux4Linux3</p>
    <p>We cant just use a larger disk with the git replay benchmark</p>
    <p>Itll still just be full!</p>
    <p>We record the operations on the small disk and replay them on the larger disk</p>
  </div>
  <div class="page">
    <p>How to compare to non-full disks</p>
    <p>Linux1 Linux2</p>
    <p>Linux4Linux3</p>
    <p>We cant just use a larger disk with the git replay benchmark</p>
    <p>Itll still just be full!</p>
    <p>We record the operations on the small disk and replay them on the larger disk</p>
  </div>
  <div class="page">
    <p>gr ep</p>
    <p>ti m</p>
    <p>e (s</p>
    <p>ec on</p>
    <p>ds /</p>
    <p>G iB</p>
    <p>)</p>
    <p>number of pulls performed 0 1000 2000 3000 4000 5000 6000 7000 8000 9000 10000</p>
    <p>ext4 full aged ext4 empty aged</p>
    <p>Full Disk Git Aging on HDD (ext4)</p>
    <p>Full: Empty: Unaged:</p>
    <p>System Details:</p>
    <p>Dell PowerEdge T130</p>
    <p>Ubuntu version 18.04 LTS Linux kernel v 4.15</p>
  </div>
  <div class="page">
    <p>gr ep</p>
    <p>ti m</p>
    <p>e (s</p>
    <p>ec on</p>
    <p>ds /</p>
    <p>G iB</p>
    <p>)</p>
    <p>number of pulls performed 0 1000 2000 3000 4000 5000 6000 7000 8000 9000 10000</p>
    <p>ext4 full aged ext4 empty aged</p>
    <p>Full Disk Git Aging on HDD (ext4)</p>
    <p>Full: Empty: Unaged:</p>
    <p>System Details:</p>
    <p>Dell PowerEdge T130</p>
    <p>Ubuntu version 18.04 LTS Linux kernel v 4.15</p>
    <p>aging from fullness</p>
  </div>
  <div class="page">
    <p>gr ep</p>
    <p>ti m</p>
    <p>e (s</p>
    <p>ec on</p>
    <p>ds /</p>
    <p>G iB</p>
    <p>)</p>
    <p>number of pulls performed 0 1000 2000 3000 4000 5000 6000 7000 8000 9000 10000</p>
    <p>ext4 full aged ext4 empty aged</p>
    <p>Full Disk Git Aging on HDD (ext4)</p>
    <p>Full: Empty: Unaged:</p>
    <p>System Details:</p>
    <p>Dell PowerEdge T130</p>
    <p>Ubuntu version 18.04 LTS Linux kernel v 4.15</p>
    <p>aging from fullness</p>
    <p>How can we be sure the performance drop is aging?</p>
  </div>
  <div class="page">
    <p>How to isolate aging</p>
  </div>
  <div class="page">
    <p>Unaged Baseline</p>
    <p>Want an unaged baseline</p>
  </div>
  <div class="page">
    <p>Unaged Baseline</p>
    <p>Want an unaged baseline</p>
    <p>What the file system would do if the data had always been there</p>
  </div>
  <div class="page">
    <p>Unaged Baseline</p>
    <p>Want an unaged baseline</p>
    <p>What the file system would do if the data had always been there</p>
    <p>Unaged baseline: Copy logical state to</p>
    <p>empty filesystem</p>
  </div>
  <div class="page">
    <p>Unaged Baseline</p>
    <p>Want an unaged baseline</p>
    <p>What the file system would do if the data had always been there</p>
    <p>Unaged baseline: Copy logical state to</p>
    <p>empty filesystem</p>
    <p>Do 100 git pulls</p>
    <p>Measure (aged) performance</p>
  </div>
  <div class="page">
    <p>Unaged Baseline</p>
    <p>Want an unaged baseline</p>
    <p>What the file system would do if the data had always been there</p>
    <p>Unaged baseline: Copy logical state to</p>
    <p>empty filesystem</p>
    <p>Do 100 git pulls</p>
    <p>Measure (aged) performance</p>
    <p>cp -a /mnt/aged/* /mnt/unaged/</p>
  </div>
  <div class="page">
    <p>Unaged Baseline</p>
    <p>Want an unaged baseline</p>
    <p>What the file system would do if the data had always been there</p>
    <p>Unaged baseline: Copy logical state to</p>
    <p>empty filesystem</p>
    <p>Do 100 git pulls</p>
    <p>Measure (aged) performance</p>
    <p>cp -a /mnt/aged/* /mnt/unaged/</p>
    <p>Measure (unaged) performance</p>
  </div>
  <div class="page">
    <p>Unaged Baseline</p>
    <p>Want an unaged baseline</p>
    <p>What the file system would do if the data had always been there</p>
    <p>Unaged baseline: Copy logical state to</p>
    <p>empty filesystem</p>
    <p>Do 100 git pulls</p>
    <p>Measure (aged) performance</p>
    <p>cp -a /mnt/aged/* /mnt/unaged/</p>
    <p>Measure (unaged) performance</p>
  </div>
  <div class="page">
    <p>gr ep</p>
    <p>ti m</p>
    <p>e (s</p>
    <p>ec on</p>
    <p>ds /</p>
    <p>G iB</p>
    <p>)</p>
    <p>number of pulls performed 0 1000 2000 3000 4000 5000 6000 7000 8000 9000 10000</p>
    <p>ext4 full aged ext4 empty aged ext4 unaged</p>
    <p>Full Disk Git Aging on HDD (ext4)</p>
    <p>Full: Empty: Unaged:</p>
    <p>System Details:</p>
    <p>Dell PowerEdge T130</p>
    <p>Ubuntu version 18.04 LTS Linux kernel v 4.15</p>
  </div>
  <div class="page">
    <p>gr ep</p>
    <p>ti m</p>
    <p>e (s</p>
    <p>ec on</p>
    <p>ds /</p>
    <p>G iB</p>
    <p>)</p>
    <p>number of pulls performed 0 1000 2000 3000 4000 5000 6000 7000 8000 9000 10000</p>
    <p>ext4 full aged ext4 empty aged ext4 unaged</p>
    <p>Full Disk Git Aging on HDD (ext4)</p>
    <p>Full: Empty: Unaged:</p>
    <p>System Details:</p>
    <p>Dell PowerEdge T130</p>
    <p>Ubuntu version 18.04 LTS Linux kernel v 4.15</p>
    <p>usage aging</p>
  </div>
  <div class="page">
    <p>gr ep</p>
    <p>ti m</p>
    <p>e (s</p>
    <p>ec on</p>
    <p>ds /</p>
    <p>G iB</p>
    <p>)</p>
    <p>number of pulls performed 0 1000 2000 3000 4000 5000 6000 7000 8000 9000 10000</p>
    <p>ext4 full aged ext4 empty aged ext4 unaged</p>
    <p>Full Disk Git Aging on HDD (ext4)</p>
    <p>Full: Empty: Unaged:</p>
    <p>System Details:</p>
    <p>Dell PowerEdge T130</p>
    <p>Ubuntu version 18.04 LTS Linux kernel v 4.15</p>
    <p>usage aging</p>
    <p>aging from fullness</p>
  </div>
  <div class="page">
    <p>Full Disk Git Aging on HDD (XFS and BTRFS) gr</p>
    <p>ep ti</p>
    <p>m e</p>
    <p>(s ec</p>
    <p>on ds</p>
    <p>/ G</p>
    <p>iB )</p>
    <p>number of pulls performed 0 2000 4000 6000 8000 10000</p>
    <p>XFS full aged XFS empty aged XFS unaged</p>
    <p>number of pulls performed 0 2000 4000 6000 8000 10000</p>
    <p>BTRFS full aged BTRFS empty aged BTRFS unaged</p>
    <p>XFS BTRFS</p>
  </div>
  <div class="page">
    <p>Full Disk Git Aging on SSD</p>
  </div>
  <div class="page">
    <p>gr ep</p>
    <p>ti m</p>
    <p>e (s</p>
    <p>ec on</p>
    <p>ds /</p>
    <p>G iB</p>
    <p>)</p>
    <p>number of pulls performed 0 1000 2000 3000 4000 5000 6000 7000 8000 9000 10000</p>
    <p>ext4 full aged ext4 empty aged ext4 unaged</p>
    <p>Full Disk Git Aging on SSD (ext4)</p>
    <p>Full: Empty: Unaged:</p>
    <p>System Details:</p>
    <p>Dell PowerEdge T130</p>
    <p>Ubuntu version 14.04 LTS Linux kernel v 3.11</p>
  </div>
  <div class="page">
    <p>gr ep</p>
    <p>ti m</p>
    <p>e (s</p>
    <p>ec on</p>
    <p>ds /</p>
    <p>G iB</p>
    <p>)</p>
    <p>number of pulls performed 0 1000 2000 3000 4000 5000 6000 7000 8000 9000 10000</p>
    <p>ext4 full aged ext4 empty aged ext4 unaged</p>
    <p>Full Disk Git Aging on SSD (ext4)</p>
    <p>Full: Empty: Unaged:</p>
    <p>System Details:</p>
    <p>Dell PowerEdge T130</p>
    <p>Ubuntu version 14.04 LTS Linux kernel v 3.11</p>
  </div>
  <div class="page">
    <p>ext4 full aged ext4 empty aged ext4 unaged</p>
    <p>Full Disk Git Aging on SSD (ext4) ext4</p>
    <p>BTRFS full aged BTRFS empty aged BTRFS unaged</p>
    <p>BTRFS</p>
    <p>XFS full aged XFS empty aged XFS unaged</p>
    <p>XFS</p>
    <p>F2FS full aged F2FS empty aged F2FS unaged</p>
    <p>F2FS</p>
  </div>
  <div class="page">
    <p>What About Free Space Fragmentation?</p>
  </div>
  <div class="page">
    <p>Measuring Aging How to measure free space fragmentation</p>
  </div>
  <div class="page">
    <p>Measuring Aging</p>
    <p>e2freefrag on ext4</p>
    <p>How to measure free space fragmentation</p>
  </div>
  <div class="page">
    <p>Measuring Aging</p>
    <p>e2freefrag on ext4</p>
    <p>How to measure free space fragmentation</p>
    <p>histogram over time</p>
    <p>M iB</p>
    <p>in e</p>
    <p>xt en</p>
    <p>ts o</p>
    <p>f g iv</p>
    <p>en s</p>
    <p>iz e</p>
  </div>
  <div class="page">
    <p>Measuring Aging</p>
    <p>e2freefrag on ext4</p>
    <p>How to measure free space fragmentation</p>
    <p>histogram over time</p>
    <p>M iB</p>
    <p>in e</p>
    <p>xt en</p>
    <p>ts o</p>
    <p>f g iv</p>
    <p>en s</p>
    <p>iz e</p>
    <p>time</p>
  </div>
  <div class="page">
    <p>Measuring Aging</p>
    <p>e2freefrag on ext4</p>
    <p>How to measure free space fragmentation</p>
    <p>histogram over time</p>
    <p>M iB</p>
    <p>in e</p>
    <p>xt en</p>
    <p>ts o</p>
    <p>f g iv</p>
    <p>en s</p>
    <p>iz e</p>
    <p>time</p>
  </div>
  <div class="page">
    <p>Git Replay Benchmark: Free Space Fragmentation</p>
  </div>
  <div class="page">
    <p>Full Disk Git Aging Free Space Fragmentation on ext4 M</p>
    <p>iB in</p>
    <p>e xt</p>
    <p>en ts</p>
    <p>o f g</p>
    <p>iv en</p>
    <p>s iz</p>
    <p>e</p>
    <p>number of pulls performed 0 1000 2000 3000 4000 5000 6000 7000 8000 9000 10000</p>
  </div>
  <div class="page">
    <p>Full Disk Git Aging Free Space Fragmentation on ext4 M</p>
    <p>iB in</p>
    <p>e xt</p>
    <p>en ts</p>
    <p>o f g</p>
    <p>iv en</p>
    <p>s iz</p>
    <p>e</p>
    <p>number of pulls performed 0 1000 2000 3000 4000 5000 6000 7000 8000 9000 10000</p>
    <p>Empty</p>
  </div>
  <div class="page">
    <p>Full Disk Git Aging Free Space Fragmentation on ext4 M</p>
    <p>iB in</p>
    <p>e xt</p>
    <p>en ts</p>
    <p>o f g</p>
    <p>iv en</p>
    <p>s iz</p>
    <p>e</p>
    <p>number of pulls performed 0 1000 2000 3000 4000 5000 6000 7000 8000 9000 10000</p>
    <p>Unaged</p>
  </div>
  <div class="page">
    <p>What we learned</p>
  </div>
  <div class="page">
    <p>What we learned</p>
    <p>Aging due to use &gt;&gt; aging due to fullness</p>
    <p>Git benchmark:</p>
  </div>
  <div class="page">
    <p>What we learned</p>
    <p>Aging due to use &gt;= aging due to fullness</p>
    <p>Worst case benchmark (see paper):</p>
    <p>Aging due to use &gt;&gt; aging due to fullness</p>
    <p>Git benchmark:</p>
  </div>
  <div class="page">
    <p>What we learned</p>
    <p>Aging due to use &gt;= aging due to fullness</p>
    <p>Worst case benchmark (see paper):</p>
    <p>Aging due to use &gt;&gt; aging due to fullness</p>
    <p>Git benchmark:</p>
    <p>Suggests that for most workloads, use aging is the first-order effect</p>
  </div>
  <div class="page">
    <p>What we learned</p>
    <p>Aging due to use &gt;= aging due to fullness</p>
    <p>Worst case benchmark (see paper):</p>
    <p>Aging due to use &gt;&gt; aging due to fullness</p>
    <p>Git benchmark:</p>
    <p>Suggests that for most workloads, use aging is the first-order effect</p>
    <p>Disk Fullness</p>
  </div>
  <div class="page">
    <p>What we learned</p>
    <p>Aging due to use &gt;= aging due to fullness</p>
    <p>Worst case benchmark (see paper):</p>
    <p>Free-space fragmentation</p>
    <p>Aging due to use &gt;&gt; aging due to fullness</p>
    <p>Git benchmark:</p>
    <p>Suggests that for most workloads, use aging is the first-order effect</p>
    <p>Disk Fullness</p>
  </div>
  <div class="page">
    <p>What we learned</p>
    <p>Aging due to use &gt;= aging due to fullness</p>
    <p>Worst case benchmark (see paper):</p>
    <p>Free-space fragmentation</p>
    <p>Aging due to use &gt;&gt; aging due to fullness</p>
    <p>Git benchmark:</p>
    <p>Suggests that for most workloads, use aging is the first-order effect</p>
    <p>Disk Fullness File System Aging ?</p>
  </div>
</Presentation>
