<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Experimental Challenges in Cyber Security: A Story of Provenance and Lineage for Malware</p>
    <p>Tudor Dumitra Iulian Neam=u Symantec Research Labs UC Riverside</p>
    <p>The IROP Keyboard [Zeller, 2011]</p>
    <p>Dumitra &amp; Neam=u :: Experimental Challenges in Cyber Security 2</p>
    <p>To prevent bugs, remove the keystrokes that predict 74% of failure-prone modules in Eclipse</p>
  </div>
  <div class="page">
    <p>Dumitra &amp; Neam=u :: Experimental Challenges in Cyber Security 3</p>
    <p>Sample C</p>
    <p>Sample D</p>
    <p>Sample E</p>
    <p>V1 ? V2 ?</p>
    <p>V3 ?</p>
    <p>Does this work?</p>
    <p>What am I measuring?</p>
    <p>How well does this work in the real world?</p>
    <p>Will this work tomorrow?</p>
    <p>D</p>
    <p>E</p>
    <p>F</p>
    <p>C</p>
    <p>G</p>
    <p>N</p>
    <p>S T</p>
    <p>Reconstruct Lineage</p>
    <p>Korgo worm family</p>
    <p>Goal</p>
    <p>Dumitra &amp; Neam=u :: Experimental Challenges in Cyber Security 4</p>
    <p>Overcome common threats to validity in cyber security experiments</p>
  </div>
  <div class="page">
    <p>Our Approach  Provenance and lineage reconstruc=on through sta/c, dynamic, and contextual analysis</p>
    <p>Key idea: Evolu=on of open source binaries = Training data</p>
    <p>Use the WINE benchmark for valida=on</p>
    <p>Dumitra &amp; Neam=u :: Experimental Challenges in Cyber Security 5</p>
    <p>Linux:  20 years of evolu=on  70+ versions</p>
    <p>FreeBSD:  18 years of evolu=on  22+ versions</p>
    <p>Lineage and Provenance Lineage: establish the ancestors and descendants</p>
    <p>of a binary ar=fact Provenance: determine the compiler, development</p>
    <p>environment, tes=ng methods, release schedule</p>
    <p>Dumitra &amp; Neam=u :: Experimental Challenges in Cyber Security 6</p>
  </div>
  <div class="page">
    <p>...</p>
    <p>...</p>
    <p>...</p>
    <p>...</p>
    <p>...</p>
    <p>...</p>
    <p>...</p>
    <p>...</p>
    <p>...</p>
    <p>...</p>
    <p>Function foo()</p>
    <p>basic blocks</p>
    <p>Dumitra &amp; Neam=u :: Experimental Challenges in Cyber Security</p>
    <p>...</p>
    <p>Other traits  system calls  dataflow  memory accesses</p>
    <p>StaQc Analysis</p>
    <p>Linux</p>
    <p>Contextual Analysis  Obfusca=on techniques (e.g., packing, randomiza/on) reduce effec=veness of sta=c / dynamic analyses</p>
    <p>Idea: use contextual informa=on  Network traces  Infec=on reports</p>
    <p>Answers ques=ons such as  When has a malware ar=fact first appeared?  Where has it spread?  How has gained access?</p>
    <p>Dumitra &amp; Neam=u :: Experimental Challenges in Cyber Security 8</p>
  </div>
  <div class="page">
    <p>Threats to Validity  Lineage</p>
    <p>Lack of ground truth on malware families  Lack of contextual data: e.g., date and =me of appearance</p>
    <p>Provenance  Different informa=on provided by compilers and assemblers  Lack of contextual data: e.g., origin geoloca=on, dissemina=on pakerns</p>
    <p>Dumitra &amp; Neam=u :: Experimental Challenges in Cyber Security 9</p>
    <p>Illustrate general threats to validity in experimental cyber security</p>
    <p>Dumitra &amp; Neam=u :: Experimental Challenges in Cyber Security 10</p>
    <p>Construct validity: use metrics that model the hypothesis</p>
    <p>Internal validity: establish causal connec=on</p>
    <p>Content validity: include only and all relevant data</p>
    <p>External validity: generalize results beyond experimental data</p>
    <p>Does it work? What am I measuring?</p>
    <p>Will it work in the real world? Will it work</p>
    <p>tomorrow? Will it work tomorrow?</p>
  </div>
  <div class="page">
    <p>Candidate Approaches  Testbeds for repeatable experimenta=on (Emulab, DETER)  Representa=ve data sets are also needed</p>
    <p>Synthe=c test data genera=on [Lippmann, 2000]</p>
    <p>Short-lived relevance  Field-gathered data [DHS PREDICT; Leita, 2010; Bilge, 2011]  Honeypots: instrumenta=on could alter results  Network traces: reveal only part of malware behavior  Lack of metadata on collec=on process [Camp, 2009; CSET 2009]</p>
    <p>Dumitra &amp; Neam=u :: Experimental Challenges in Cyber Security 11</p>
    <p>External Internal</p>
    <p>Content</p>
    <p>Validity</p>
    <p>Mul=ple</p>
    <p>WINE: Benchmark for Computer Security http://www.symantec.com/WINE</p>
    <p>Dumitra &amp; Neam=u :: Experimental Challenges in Cyber Security 12</p>
    <p>Symantecs worldwide sensors</p>
    <p>Plaqorm for experimental reproducibility</p>
  </div>
  <div class="page">
    <p>The Worldwide Intelligence Network Environment (WINE)</p>
    <p>Goal: reproducible experiments in cyber security</p>
    <p>Data collected on millions of end-hosts</p>
    <p>Data sampled from Symantecs opera/onal data sets</p>
    <p>Access WINE on SRL site: Culver City, CA or Herndon, VA  Fee required</p>
    <p>Store reference data sets used in prior experiments</p>
    <p>Maintain lab book Dumitra &amp; Neam=u :: Experimental Challenges in Cyber Security 13</p>
    <p>WINE: Cover all Phases of Cyber Threat Lifecycle</p>
    <p>Dumitra &amp; Neam=u :: Experimental Challenges in Cyber Security 14</p>
    <p>New Akacks</p>
    <p>Vulnerability</p>
    <p>Dissemina=on &amp; Concealment</p>
    <p>Zero-Day Akacks</p>
    <p>Exploit Tes =ng</p>
    <p>Patch Advisory</p>
    <p>Remedia=on Malware Samples</p>
    <p>Binary Reputa=on</p>
    <p>A/V Telemetry</p>
    <p>Spam URL Reputa=on</p>
  </div>
  <div class="page">
    <p>New Akacks</p>
    <p>Vulnerability</p>
    <p>Dissemina=on &amp; Concealment</p>
    <p>Zero-Day Akacks</p>
    <p>Exploit Tes =ng</p>
    <p>Patch Advisory</p>
    <p>Remedia=on Malware Samples</p>
    <p>Binary ReputaQon</p>
    <p>A/V Telemetry</p>
    <p>Spam URL Reputa=on</p>
    <p>Traits for Contextual Analysis: Binary Reputa8on</p>
    <p>Dumitra &amp; Neam=u :: Experimental Challenges in Cyber Security 15</p>
    <p>Norton Insight (opt-in program)</p>
    <p>Submissions Queries MachineID Timestamp</p>
    <p>MD5 of binary SHA2 of binary Download URL Protocol version</p>
    <p>Distributed Data CollecQon</p>
    <p>Dumitra &amp; Neam=u :: Experimental Challenges in Cyber Security 16</p>
    <p>Binary reputaQon: 35M machines</p>
    <p>Malware: 7M samples</p>
    <p>Spam: 2.5M decoys</p>
    <p>URL reputaQon: 10M domains</p>
    <p>A/V telemetry: 130M machines</p>
  </div>
  <div class="page">
    <p>Collec=on metadata: data is self-descrip=ve  When: =mestamp  Where: machine ID, geoloca=on, URL  How: protocol version, known bugs</p>
    <p>Enables defining relevant data sets (content validity)  Enables reasoning if results generalize (external validity)</p>
    <p>WINE Experiments: Threats to Validity (1)</p>
    <p>Dumitra &amp; Neam=u :: Experimental Challenges in Cyber Security 17</p>
    <p>WINE</p>
    <p>Submission Gateways</p>
    <p>Con=nuous Updates</p>
    <p>WINE Experiments: Threats to Validity (2)  Experiment metadata: recorded in lab book</p>
    <p>External researcher describes experiment in proposal  Research hypothesis  Input/output data</p>
    <p>Researcher develops script to run experiment from end to end</p>
    <p>Hypothesis, data and script are documented on a wiki</p>
    <p>Enables independent verifica=on of experimental design (internal and construct validity)</p>
    <p>Dumitra &amp; Neam=u :: Experimental Challenges in Cyber Security 18</p>
  </div>
  <div class="page">
    <p>Conclusions  Rigorous experiments give us an edge in the security arms race  Develop techniques that are likely to keep working tomorrow</p>
    <p>Challenges  Ground truth  Relevant data sets  Rigorous analysis</p>
    <p>WINE: first step toward a rigorous benchmark for cyber security</p>
    <p>Dumitra &amp; Neam=u :: Experimental Challenges in Cyber Security 19</p>
    <p>Thank you!</p>
    <p>Dumitra &amp; Neam=u :: Experimental Challenges in Cyber Security 20</p>
    <p>Tudor Dumitra http://www.ece.cmu.edu/~tdumitra tudor_dumitras@symantec.com @tudor_dumitras</p>
  </div>
</Presentation>
