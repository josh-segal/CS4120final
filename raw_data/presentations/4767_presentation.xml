<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Analysis of Rate-distortion Functions and Congestion Control in Scalable Internet Video Streaming</p>
    <p>Min Dai Electrical Engineering, Texas A&amp;M University</p>
    <p>Dmitri Loguinov Computer Science, Texas A&amp;M University</p>
  </div>
  <div class="page">
    <p>Motivation</p>
    <p>Scalable coding is widely applied in Internet streaming.  Fine Granular Scalability (FGS) has been chosen in</p>
    <p>MPEG-4 standard</p>
    <p>Study the statistical properties of FGS encoder and propose a more accurate statistical model for it</p>
    <p>The Rate-distortion (R-D) theory is a powerful tool in Internet streaming.  Choose appropriate compression schemes</p>
    <p>Optimally allocate bits in joint source-channel coding</p>
    <p>Rate adaptation in the Internet</p>
  </div>
  <div class="page">
    <p>Motivation (cont.)</p>
    <p>R-D theory (cont.):  No current closed-form R-D model has been developed</p>
    <p>for scalable coding  Derive an R-D model for scalable video coding</p>
    <p>Constant quality control:  Another application of R-D model in Internet streaming  Human eyes are sensitive to quality fluctuation  Many video sequences have severe quality fluctuations</p>
  </div>
  <div class="page">
    <p>Motivation (cont.)</p>
    <p>Most existing CQ methods in scalable streaming are limited to the constant bitrate (CBR) case.  Channel bandwidth is varying in a real network</p>
    <p>Congestion control is necessary to allow fair and efficient usage of network bandwidth</p>
    <p>Most existing congestion control methods (e.g., AIMD) are not proven to be asymptotically stable.  Kellys continuous-feedback congestion control</p>
    <p>Combine our R-D model with Kellys control in Internet streaming</p>
  </div>
  <div class="page">
    <p>Overview of this Talk</p>
    <p>Background on rate-distortion theory and FGS scalable coding</p>
    <p>A big picture of this work  R-D modeling of an FGS encoder</p>
    <p>Kellys control</p>
    <p>Constant quality control</p>
    <p>Experimental results</p>
    <p>Conclusion</p>
  </div>
  <div class="page">
    <p>Background  Rate-distortion (R-D) theory</p>
    <p>The theoretical discipline that treats data compression from the viewpoint of information theory</p>
    <p>A typical R-D curve</p>
    <p>R Theoretical R(D)</p>
    <p>D</p>
    <p>Operational R(D)</p>
    <p>Theoretical R-D model:  A lower bound for any encoder given a statistical</p>
    <p>distribution of the source  Often unachievable in the real world</p>
    <p>Operational R-D model  An achievable bound for a practical encoder</p>
  </div>
  <div class="page">
    <p>Background (cont.)</p>
    <p>Scalable coding:  Provides the capability of recovering image or video</p>
    <p>information by partially decoding the compressed bitstream</p>
    <p>Fine granular scalability (FGS):  One low bitrate base layer (BL) to provide a low but</p>
    <p>guaranteed level of quality</p>
    <p>One high bitrate enhancement layer (EL) to provide finer quality improvement</p>
    <p>EL can be truncated at any codeword</p>
  </div>
  <div class="page">
    <p>Background (cont.)</p>
    <p>FGS at the Server FGS at the DecoderFGS at the Encoder</p>
    <p>BL</p>
    <p>EL</p>
    <p>Portion of the FGS EL transmitted in the Internet</p>
  </div>
  <div class="page">
    <p>A Big Picture</p>
    <p>Statistical Model of FGS EL input</p>
    <p>Distortion Model of FGS EL</p>
    <p>R-D Model of FGS EL</p>
    <p>Congestion Control</p>
    <p>Constant Quality Control</p>
  </div>
  <div class="page">
    <p>Related work on Statistical Models  Input to FGS EL:</p>
    <p>DCT residue between the original image and the reconstructed image from BL</p>
    <p>The two most popular models for DCT residue:  Zero-mean Gaussian distribution:</p>
    <p>)(</p>
    <p>=</p>
    <p>x</p>
    <p>exf</p>
    <p>Laplacian distribution (double exponential):</p>
    <p>||</p>
    <p>=</p>
  </div>
  <div class="page">
    <p>Related work on Statistical Models</p>
    <p>-15 -10 -5 0 5 10 15</p>
    <p>DCT residue</p>
    <p>P ro</p>
    <p>ba bi</p>
    <p>lit y</p>
    <p>real PMF Gaussian Laplacian</p>
    <p>P ro</p>
    <p>ba bi</p>
    <p>lit y</p>
    <p>real PMF Gaussian Laplacian</p>
    <p>The PMF of DCT residue with Gaussian and Laplacian estimations (left). Logarithmic scale of PMFs for the positive residue (right). All testing sequences shown in this paper are coded at 10fps and 128 kb/s in the base layer</p>
  </div>
  <div class="page">
    <p>Proposed Statistical Model  Mixture Laplacian model:</p>
    <p>||1||0 10</p>
    <p>+</p>
    <p>=</p>
    <p>where 0 denotes the small variance Laplacian distribution and 1 denotes the large variance Laplacian distribution</p>
    <p>Use Expectation-Maximization (EM) algorithm to give Maximum-likelihood (ML) estimation for parameters { p, 0, 1 }</p>
  </div>
  <div class="page">
    <p>Proposed Statistical Model (cont.)</p>
    <p>Real PMF and mixture Laplacian (left) and Logarithmic scale of the positive part (right)</p>
    <p>-20 -10 0 10 20 DCT residue</p>
    <p>P ro</p>
    <p>ba bi</p>
    <p>lit y</p>
    <p>real PMF mixture</p>
    <p>DCT residue</p>
    <p>P ro</p>
    <p>ba bi</p>
    <p>lit y</p>
    <p>real PMF mixture</p>
  </div>
  <div class="page">
    <p>More Results</p>
    <p>The weighted absolute error of estimations in Foreman CIF (left) and Coastguard CIF (right)</p>
    <p>er ro</p>
    <p>r</p>
    <p>Gaussian Laplacian mixture</p>
    <p>er ro</p>
    <p>r</p>
    <p>Gaussian</p>
    <p>Laplacian</p>
    <p>mixture</p>
  </div>
  <div class="page">
    <p>A Big Picture</p>
    <p>Statistical Model of FGS EL input</p>
    <p>Distortion Model of FGS EL</p>
    <p>R-D Model of FGS EL</p>
    <p>Congestion Control</p>
    <p>Constant Quality Control</p>
  </div>
  <div class="page">
    <p>Current Distortion Models</p>
    <p>Classical model: R</p>
    <p>XD 222 2 =</p>
    <p>where 2 is a signal-dependent constant, X2 denotes the signal variance and R is the bitrate</p>
    <p>A variation of the classical model ( proposed by Chiang et al. in 1997):</p>
  </div>
  <div class="page">
    <p>Current Distortion Models (cont.)</p>
    <p>Distortion model for Uniform Quantizer (UQ):</p>
    <p>= 2</p>
    <p>)(D</p>
    <p>where  is quantization parameter (QP) and  equals 12</p>
  </div>
  <div class="page">
    <p>Current Distortion Models (cont.)</p>
    <p>Performances of current models in frame 0 (left) and frame 252 of Foreman CIF (right)</p>
    <p>FGS EL bits</p>
    <p>P S</p>
    <p>N R</p>
    <p>(d B</p>
    <p>)</p>
    <p>Chiang et al. real PSNR UQ classical</p>
    <p>FGS EL bits</p>
    <p>P S</p>
    <p>N R</p>
    <p>(d B</p>
    <p>)</p>
    <p>Chiang et al. real PSNR UQ classical</p>
  </div>
  <div class="page">
    <p>A more Accurate Distortion Model</p>
    <p>For each Laplacian component in the mixture Laplacian model, the distortion is:</p>
    <p>+</p>
    <p>+</p>
    <p>=   22</p>
    <p>)1( 1</p>
    <p>)( nnn</p>
    <p>n n</p>
    <p>n e</p>
    <p>e D</p>
    <p>Final version: )()1()()( 10 += DpDpD</p>
    <p>where  is the quantization step of each bitplane in the FGS EL and p is the probability of related Laplacian component</p>
  </div>
  <div class="page">
    <p>Results of Distortion Model</p>
    <p>The average absolute errors in Foreman CIF (left) and Coastguard CIF (right)</p>
    <p>av g</p>
    <p>ab s</p>
    <p>er ro</p>
    <p>r (d</p>
    <p>B )</p>
    <p>classical UQ model our model</p>
    <p>av eg</p>
    <p>a bs</p>
    <p>e rr</p>
    <p>or (d</p>
    <p>B )</p>
    <p>classical UQ model our model</p>
  </div>
  <div class="page">
    <p>A Big Picture</p>
    <p>Statistical Model of FGS EL input</p>
    <p>Distortion Model of FGS EL</p>
    <p>R-D Model of FGS EL</p>
    <p>Congestion Control</p>
    <p>Constant Quality Control</p>
  </div>
  <div class="page">
    <p>Operational R-D model</p>
    <p>Peak Signal-to-Noise Ratio (PSNR) is the most popular quality measurement in video coding</p>
    <p>)/255(log10 210 DPSNR =</p>
    <p>Based on our distortion model, we found that PSNR could be described with a quadratic function of bitplane number z ( z= log2() )</p>
  </div>
  <div class="page">
    <p>Operational R-D model (cont.)</p>
    <p>In traditional R-D models, bitrate R is a linear function of the bitplane number z</p>
    <p>bitplane z</p>
    <p>bi ts</p>
    <p>p er</p>
    <p>p ix</p>
    <p>el</p>
    <p>actual quadratic linear</p>
    <p>bitplane z</p>
    <p>bi ts</p>
    <p>p er</p>
    <p>p ix</p>
    <p>el</p>
    <p>actual quadratic linear</p>
    <p>Experimental results show that a quadratic function of z is a much better model of R</p>
    <p>bazzR +=)(</p>
  </div>
  <div class="page">
    <p>Operational R-D model (cont.)</p>
    <p>Distortion model D()</p>
    <p>Quality PSNR (z) = = d1z2 + d2z + d3</p>
    <p>PSNR ~ log(D)</p>
    <p>Rate R(z) = a1z2 + a2z + a3</p>
    <p>CRBARPSNR ++=</p>
    <p>cRbaRRD ++= 2)(</p>
  </div>
  <div class="page">
    <p>Operational R-D model (cont.)</p>
    <p>The proposed R-D function is:</p>
    <p>where a, b, c are constants</p>
    <p>Notice that the classical model is a special case of our model with a = -2 and b=0.</p>
    <p>cRbaRRD ++= 2)(</p>
    <p>)(log2 2222)( xRRD +=</p>
  </div>
  <div class="page">
    <p>Results of R-D models (1)</p>
    <p>The average absolute errors in Foreman CIF (left) and Coastguard CIF (right)</p>
    <p>av g</p>
    <p>ab s</p>
    <p>er ro</p>
    <p>r( dB</p>
    <p>)</p>
    <p>classical</p>
    <p>UQ</p>
    <p>our model</p>
    <p>av g</p>
    <p>ab s</p>
    <p>er ro</p>
    <p>r (d</p>
    <p>B )</p>
    <p>classical UQ our model</p>
  </div>
  <div class="page">
    <p>Results of R-D models (2)</p>
    <p>The maximum absolute errors in Foreman CIF (left) and Coastguard CIF (right)</p>
    <p>Frame number</p>
    <p>m ax</p>
    <p>a bs</p>
    <p>e rr</p>
    <p>or (d</p>
    <p>B )</p>
    <p>classical UQ our model</p>
    <p>m ax</p>
    <p>a bs</p>
    <p>e rr</p>
    <p>or (d</p>
    <p>B )</p>
    <p>classical UQ our model</p>
  </div>
  <div class="page">
    <p>A Big Picture</p>
    <p>Statistical Model of FGS EL input</p>
    <p>Distortion Model of FGS EL</p>
    <p>R-D Model of FGS EL</p>
    <p>Congestion Control</p>
    <p>Constant Quality Control</p>
  </div>
  <div class="page">
    <p>Constant Quality in CBR</p>
    <p>time (s)</p>
    <p>P S</p>
    <p>N R</p>
    <p>(d B</p>
    <p>)</p>
    <p>base layer</p>
    <p>P S</p>
    <p>N R</p>
    <p>(d B</p>
    <p>)</p>
    <p>Ours Classical JPEG2000</p>
    <p>Notice that most CQ papers stop here, while the available bandwidth is varying in the real case</p>
  </div>
  <div class="page">
    <p>A Big Picture</p>
    <p>Statistical Model of FGS EL input</p>
    <p>Distortion Model of FGS EL</p>
    <p>R-D Model of FGS EL</p>
    <p>Congestion Control</p>
    <p>Constant Quality Control</p>
  </div>
  <div class="page">
    <p>Congestion Control</p>
    <p>Current status:  AIMD, TFRC and binomial algorithms oscillate around</p>
    <p>the average rate</p>
    <p>Continuous-feedback controller is proposed by Kelly et al. in 1998 :</p>
    <p>)log()(,))(( )(</p>
    <p>rrUwhereprUr dt tdr</p>
    <p>Pl l ==</p>
    <p>where r is the current sending rate and ,  are constants. U is the utility function of the end user and pl is the price that the flow pays for using router l along the end-to-end path P</p>
  </div>
  <div class="page">
    <p>Congestion Control (cont.)</p>
    <p>An application-friendly version:</p>
    <p>)()( )(</p>
    <p>trtp dt tdr</p>
    <p>=</p>
    <p>Bottleneck packet loss p is used as the feedback instead of prices</p>
    <p>= i i</p>
    <p>i li l tr</p>
    <p>Ctr tp</p>
    <p>)( )(</p>
    <p>)(</p>
    <p>where ri is the sending rate of the i-th flow passing through the bottleneck router l, Cl is the speed of router l</p>
  </div>
  <div class="page">
    <p>A Big Picture</p>
    <p>Statistical Model of FGS EL input</p>
    <p>Distortion Model of FGS EL</p>
    <p>R-D Model of FGS EL</p>
    <p>Congestion Control</p>
    <p>Constant Quality Control</p>
  </div>
  <div class="page">
    <p>Experimental Results (1)</p>
    <p>Comparison between a single AIMD flow and a single Kellys flow. Bottleneck bandwidth C is 1mb/s and RTT=100ms</p>
    <p>P S</p>
    <p>N R</p>
    <p>(d B</p>
    <p>)</p>
    <p>K e lly A IM D</p>
  </div>
  <div class="page">
    <p>Experimental Results (2)</p>
    <p>Two Kelly flows are sharing the same bottleneck link C under identical delay</p>
    <p>P S</p>
    <p>N R</p>
    <p>(d B</p>
    <p>) flow1 flow2 base</p>
  </div>
  <div class="page">
    <p>Experimental Results (3)</p>
    <p>Examine the effect of different round-trip delays (fixed and random) on fairness</p>
    <p>D</p>
    <p>P S</p>
    <p>N R</p>
    <p>(d B</p>
    <p>)</p>
    <p>D=100 ms D=400 ms base</p>
    <p>P S</p>
    <p>N R</p>
    <p>(d B</p>
    <p>)</p>
    <p>flow1 flow2 base</p>
  </div>
  <div class="page">
    <p>Experimental Results (4)</p>
    <p>Examine the situation n flows sharing the bottleneck bandwidth and each flow has a random delay</p>
    <p>P S</p>
    <p>N R</p>
    <p>( d</p>
    <p>B )</p>
    <p>flow base</p>
    <p>time (s)</p>
    <p>d el</p>
    <p>ay D</p>
    <p>( m</p>
    <p>s)</p>
    <p>A single-flow PSNR when n = 10 flows share a 10 mb/s bottleneck link (left), Random delay for the flow (right)</p>
  </div>
  <div class="page">
    <p>Conclusion to this Work</p>
    <p>This paper derives a simple but accurate operational R-D model based on the properties of FGS encoders</p>
    <p>Based on this R-D model, we show a simple algorithm that can achieve better constant quality in CBR for scalable streaming than many other CQ methods</p>
    <p>Another contribution of this work is the successful combination of our R-D model with Kellys congestion control in Internet streaming</p>
  </div>
  <div class="page">
    <p>Thank You!</p>
  </div>
</Presentation>
