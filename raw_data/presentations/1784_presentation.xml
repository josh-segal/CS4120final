<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Trustworthy Information Systems for Healthcare</p>
    <p>Electronic Prescriptions for Controlled Substances:</p>
    <p>A Cybersecurity Perspective</p>
    <p>Samuel Tan samueltan@gmail.com</p>
    <p>Rebecca Shapiro bx@cs.dartmouth.edu</p>
    <p>Sean W. Smith sws@cs.dartmouth.edu</p>
  </div>
  <div class="page">
    <p>Introduction</p>
    <p>What did we do?</p>
    <p>o Examined regulations</p>
    <p>o Understood rules and mandated process</p>
    <p>o Identified potential areas of weaknesses</p>
    <p>o Highlighted potential attacks</p>
    <p>o Suggested possible mitigations</p>
    <p>Samuel Tan, Rebecca Shapiro, Sean W. Smith, Dartmouth College</p>
  </div>
  <div class="page">
    <p>Introduction</p>
    <p>What is Electronic Prescriptions for</p>
    <p>Controlled Substances (EPCS)?</p>
    <p>o Set of rules published the DEA</p>
    <p>o providethe ability to use[electronic]</p>
    <p>controlled substance prescriptions while</p>
    <p>maintaining the closed system of controls on</p>
    <p>controlled substances</p>
    <p>o Regulates process of issuing and receiving</p>
    <p>electronic prescriptions</p>
    <p>o Applicable to healthcare institutions, practitioners</p>
    <p>and pharmacies Samuel Tan, Rebecca Shapiro, Sean W. Smith, Dartmouth College</p>
  </div>
  <div class="page">
    <p>EPCS-Mandated Process</p>
    <p>OR</p>
    <p>* Clipart from Kootation.com, iPharMD.net, halfelf.org, drabdolkarim.com, 123rf.com, wikipedia.com, sweetclipart.com,</p>
    <p>todaysseniorsnetwork.com</p>
    <p>Write prescription</p>
    <p>Two-factor</p>
    <p>authentication</p>
    <p>Sign with digital</p>
    <p>certificate</p>
    <p>Sign with application</p>
    <p>Verify signature and certificate</p>
    <p>Sign on receipt and archive</p>
    <p>Process</p>
    <p>prescription</p>
    <p>Samuel Tan, Rebecca Shapiro, Sean W. Smith, Dartmouth College</p>
    <p>PRACTITIONER PHARMACY</p>
  </div>
  <div class="page">
    <p>Security Metrics</p>
    <p>How do we assess EPCS?</p>
    <p>o Correctness</p>
    <p>o Integrity</p>
    <p>o Confidentiality</p>
    <p>o Availability</p>
    <p>Samuel Tan, Rebecca Shapiro, Sean W. Smith, Dartmouth College</p>
    <p>providethe ability to</p>
    <p>use[electronic] controlled</p>
    <p>substance prescriptions</p>
    <p>while maintaining the</p>
    <p>closed system of controls</p>
    <p>on controlled substances</p>
  </div>
  <div class="page">
    <p>Points of attack</p>
    <p>Other</p>
    <p>applications</p>
    <p>Authentication</p>
    <p>Two-factor</p>
    <p>Authentication</p>
    <p>Electronic Transmission</p>
    <p>Internet</p>
    <p>Practitioner System</p>
    <p>Cryptographic</p>
    <p>module</p>
    <p>Operating</p>
    <p>System</p>
    <p>Password</p>
    <p>Biometrics</p>
    <p>Hard token</p>
    <p>Organizational</p>
    <p>Network</p>
    <p>Other</p>
    <p>applications</p>
    <p>Pharmacy System</p>
    <p>Cryptographic</p>
    <p>module</p>
    <p>Operating</p>
    <p>System</p>
    <p>Organizational</p>
    <p>Network</p>
    <p>Samuel Tan, Rebecca Shapiro, Sean W. Smith, Dartmouth College</p>
  </div>
  <div class="page">
    <p>Software Security</p>
    <p>Other</p>
    <p>applications</p>
    <p>Authentication</p>
    <p>Two-factor</p>
    <p>Authentication</p>
    <p>Electronic Transmission</p>
    <p>Internet</p>
    <p>Practitioner System</p>
    <p>Cryptographic</p>
    <p>module</p>
    <p>Operating</p>
    <p>System</p>
    <p>Password</p>
    <p>Biometrics</p>
    <p>Hard token</p>
    <p>Organizational</p>
    <p>Network</p>
    <p>Other</p>
    <p>applications</p>
    <p>Pharmacy System</p>
    <p>Cryptographic</p>
    <p>module</p>
    <p>Operating</p>
    <p>System</p>
    <p>Organizational</p>
    <p>Network</p>
    <p>Samuel Tan, Rebecca Shapiro, Sean W. Smith, Dartmouth College</p>
  </div>
  <div class="page">
    <p>Software Security</p>
    <p>Other</p>
    <p>applications</p>
    <p>Authentication</p>
    <p>Two-factor</p>
    <p>Authentication</p>
    <p>Electronic Transmission</p>
    <p>Internet</p>
    <p>Practitioner System</p>
    <p>Cryptographic</p>
    <p>module</p>
    <p>Operating</p>
    <p>System</p>
    <p>Password</p>
    <p>Biometrics</p>
    <p>Hard token</p>
    <p>Organizational</p>
    <p>Network</p>
    <p>Other</p>
    <p>applications</p>
    <p>Pharmacy System</p>
    <p>Cryptographic</p>
    <p>module</p>
    <p>Operating</p>
    <p>System</p>
    <p>Organizational</p>
    <p>Network</p>
    <p>Samuel Tan, Rebecca Shapiro, Sean W. Smith, Dartmouth College</p>
  </div>
  <div class="page">
    <p>Software Security</p>
    <p>Whats in the EPCS standard?</p>
    <p>o Logical access controls</p>
    <p>o FIPS 140-2 Security Level 1</p>
    <p>validated cryptographic signing modules</p>
    <p>OS restricted to single operator mode of operation</p>
    <p>OS protects private keys from other processes</p>
    <p>OS source code and binaries cannot be viewed or changed</p>
    <p>Threats</p>
    <p>o FIPS 140-2 Security Level 1 an inadequate guarantee</p>
    <p>o No other requirements!</p>
    <p>o Compromise of other services</p>
    <p>o Compromise of operating system itself</p>
    <p>Samuel Tan, Rebecca Shapiro, Sean W. Smith, Dartmouth College</p>
  </div>
  <div class="page">
    <p>Software Security</p>
    <p>Potential Attacks</p>
    <p>o Detect OS/software vulnerabilities</p>
    <p>using remote security scanners,</p>
    <p>port scanners or packet sniffers</p>
    <p>o Weaponize vulnerabilities (e.g. using Metasploit)</p>
    <p>Possible Mitigation</p>
    <p>o Disable unnecessary applications</p>
    <p>o Frequent patching of OS and applications</p>
    <p>o Configuring user permissions and access privileges</p>
    <p>o Frequent security audits</p>
    <p>Samuel Tan, Rebecca Shapiro, Sean W. Smith, Dartmouth College</p>
  </div>
  <div class="page">
    <p>Network Security</p>
    <p>Other</p>
    <p>applications</p>
    <p>Authentication</p>
    <p>Two-factor</p>
    <p>Authentication</p>
    <p>Electronic Transmission</p>
    <p>Internet</p>
    <p>Practitioner System</p>
    <p>Cryptographic</p>
    <p>module</p>
    <p>Operating</p>
    <p>System</p>
    <p>Password</p>
    <p>Biometrics</p>
    <p>Hard token</p>
    <p>Organizational</p>
    <p>Network</p>
    <p>Other</p>
    <p>applications</p>
    <p>Pharmacy System</p>
    <p>Cryptographic</p>
    <p>module</p>
    <p>Operating</p>
    <p>System</p>
    <p>Organizational</p>
    <p>Network</p>
    <p>Samuel Tan, Rebecca Shapiro, Sean W. Smith, Dartmouth College</p>
  </div>
  <div class="page">
    <p>Network Security</p>
    <p>Other</p>
    <p>applications</p>
    <p>Authentication</p>
    <p>Two-factor</p>
    <p>Authentication</p>
    <p>Electronic Transmission</p>
    <p>Internet</p>
    <p>Practitioner System</p>
    <p>Cryptographic</p>
    <p>module</p>
    <p>Operating</p>
    <p>System</p>
    <p>Password</p>
    <p>Biometrics</p>
    <p>Hard token</p>
    <p>Organizational</p>
    <p>Network</p>
    <p>Other</p>
    <p>applications</p>
    <p>Pharmacy System</p>
    <p>Cryptographic</p>
    <p>module</p>
    <p>Operating</p>
    <p>System</p>
    <p>Organizational</p>
    <p>Network</p>
    <p>Samuel Tan, Rebecca Shapiro, Sean W. Smith, Dartmouth College</p>
  </div>
  <div class="page">
    <p>Network Security</p>
    <p>Whats in the EPCS standard?</p>
    <p>o No requirements for</p>
    <p>practitioner or pharmacy system</p>
    <p>o No requirements for networks either</p>
    <p>is connected to</p>
    <p>Second-order problem</p>
    <p>Threats</p>
    <p>o Attacks via networks</p>
    <p>o Attacks on networks themselves</p>
    <p>Samuel Tan, Rebecca Shapiro, Sean W. Smith, Dartmouth College</p>
  </div>
  <div class="page">
    <p>Network Security</p>
    <p>Potential attacks</p>
    <p>o Vulnerability sniffing and</p>
    <p>delivery of weaponized</p>
    <p>exploits through open ports</p>
    <p>o Man-in-the-middle attacks</p>
    <p>E.g. DNS spoofing, ARP cache poisoning</p>
    <p>Possible Mitigation</p>
    <p>o Secure organizational network layout</p>
    <p>o Proper firewall configuration</p>
    <p>o Intrusion detection and prevention systems Samuel Tan, Rebecca Shapiro, Sean W. Smith, Dartmouth College</p>
  </div>
  <div class="page">
    <p>Physical (Key) Security</p>
    <p>Other</p>
    <p>applications</p>
    <p>Authentication</p>
    <p>Two-factor</p>
    <p>Authentication</p>
    <p>Electronic Transmission</p>
    <p>Internet</p>
    <p>Practitioner System</p>
    <p>Cryptographic</p>
    <p>module</p>
    <p>Operating</p>
    <p>System</p>
    <p>Password</p>
    <p>Biometrics</p>
    <p>Hard token</p>
    <p>Organizational</p>
    <p>Network</p>
    <p>Other</p>
    <p>applications</p>
    <p>Pharmacy System</p>
    <p>Cryptographic</p>
    <p>module</p>
    <p>Operating</p>
    <p>System</p>
    <p>Organizational</p>
    <p>Network</p>
    <p>Samuel Tan, Rebecca Shapiro, Sean W. Smith, Dartmouth College</p>
  </div>
  <div class="page">
    <p>Physical (Key) Security</p>
    <p>Other</p>
    <p>applications</p>
    <p>Authentication</p>
    <p>Two-factor</p>
    <p>Authentication</p>
    <p>Electronic Transmission</p>
    <p>Internet</p>
    <p>Practitioner System</p>
    <p>Cryptographic</p>
    <p>module</p>
    <p>Operating</p>
    <p>System</p>
    <p>Password</p>
    <p>Biometrics</p>
    <p>Hard token</p>
    <p>Organizational</p>
    <p>Network</p>
    <p>Other</p>
    <p>applications</p>
    <p>Pharmacy System</p>
    <p>Cryptographic</p>
    <p>module</p>
    <p>Operating</p>
    <p>System</p>
    <p>Organizational</p>
    <p>Network</p>
    <p>Samuel Tan, Rebecca Shapiro, Sean W. Smith, Dartmouth College</p>
  </div>
  <div class="page">
    <p>Physical (Key) Security</p>
    <p>Whats in the EPCS standard?</p>
    <p>o Cryptographic signing</p>
    <p>modules must be FIPS 140-2</p>
    <p>Security Level 1</p>
    <p>o Hard token (if used) must be separate and FIPS 140-2</p>
    <p>Security Level 1</p>
    <p>Made of Production grade equipment</p>
    <p>Zeroize keys if maintenance/debugging mode is accessed</p>
    <p>Threats</p>
    <p>o FIPS 140-2 Security Level 1 requirement too weak</p>
    <p>Samuel Tan, Rebecca Shapiro, Sean W. Smith, Dartmouth College</p>
  </div>
  <div class="page">
    <p>Physical (Key) Security</p>
    <p>Potential Attacks</p>
    <p>o Attacks on the debugging</p>
    <p>access interface</p>
    <p>o Side-channel attacks (Joye &amp; Oliver)</p>
    <p>E.g. Power analysis attacks</p>
    <p>o Cold boot attacks (Halderman et. al)</p>
    <p>Possible Mitigation</p>
    <p>o FIPS 140-2 Security Level 3 requirement</p>
    <p>o Power analysis attack countermeasures (Joye &amp; Oliver)</p>
    <p>E.g. blur signal using smoothing techniques, dual-rail logic</p>
    <p>o Regular clearing of private keys from memory</p>
    <p>Samuel Tan, Rebecca Shapiro, Sean W. Smith, Dartmouth College</p>
  </div>
  <div class="page">
    <p>Transmission</p>
    <p>Other</p>
    <p>applications</p>
    <p>Authentication</p>
    <p>Two-factor</p>
    <p>Authentication</p>
    <p>Electronic Transmission</p>
    <p>Internet</p>
    <p>Practitioner System</p>
    <p>Cryptographic</p>
    <p>module</p>
    <p>Operating</p>
    <p>System</p>
    <p>Password</p>
    <p>Biometrics</p>
    <p>Hard token</p>
    <p>Organizational</p>
    <p>Network</p>
    <p>Other</p>
    <p>applications</p>
    <p>Pharmacy System</p>
    <p>Cryptographic</p>
    <p>module</p>
    <p>Operating</p>
    <p>System</p>
    <p>Organizational</p>
    <p>Network</p>
    <p>Samuel Tan, Rebecca Shapiro, Sean W. Smith, Dartmouth College</p>
  </div>
  <div class="page">
    <p>Transmission</p>
    <p>Other</p>
    <p>applications</p>
    <p>Authentication</p>
    <p>Two-factor</p>
    <p>Authentication</p>
    <p>Electronic Transmission</p>
    <p>Internet</p>
    <p>Practitioner System</p>
    <p>Cryptographic</p>
    <p>module</p>
    <p>Operating</p>
    <p>System</p>
    <p>Password</p>
    <p>Biometrics</p>
    <p>Hard token</p>
    <p>Organizational</p>
    <p>Network</p>
    <p>Other</p>
    <p>applications</p>
    <p>Pharmacy System</p>
    <p>Cryptographic</p>
    <p>module</p>
    <p>Operating</p>
    <p>System</p>
    <p>Organizational</p>
    <p>Network</p>
    <p>Samuel Tan, Rebecca Shapiro, Sean W. Smith, Dartmouth College</p>
  </div>
  <div class="page">
    <p>Transmission</p>
    <p>Whats in the EPCS standard?</p>
    <p>o Protection from modification</p>
    <p>Threat/Potential attack</p>
    <p>o Eavesdropping on unencrypted</p>
    <p>transmitted electronic prescriptions</p>
    <p>Potential Mitigation</p>
    <p>o Use TLS protocol during transmission</p>
    <p>Samuel Tan, Rebecca Shapiro, Sean W. Smith, Dartmouth College</p>
  </div>
  <div class="page">
    <p>Other Security Weaknesses</p>
    <p>Biometric subsystem</p>
    <p>Password policy</p>
    <p>o Read paper for in-depth discussions</p>
    <p>Samuel Tan, Rebecca Shapiro, Sean W. Smith, Dartmouth College</p>
  </div>
  <div class="page">
    <p>Conclusions</p>
    <p>Current regulations insufficient</p>
    <p>Many easy fixes</p>
    <p>Increase attacker cost for attacks that are</p>
    <p>harder to defend against</p>
    <p>Tradeoff between cost and security</p>
    <p>Samuel Tan, Rebecca Shapiro, Sean W. Smith, Dartmouth College</p>
  </div>
  <div class="page">
    <p>Lessons Learnt</p>
    <p>Establish security goals from the start</p>
    <p>o providethe ability to use[electronic]</p>
    <p>controlled substance prescriptions while</p>
    <p>maintaining the closed system of controls on</p>
    <p>controlled substances</p>
    <p>Accepted standards &gt; secure system</p>
    <p>Regulations should be conservative</p>
    <p>Be specific where it counts</p>
    <p>Samuel Tan, Rebecca Shapiro, Sean W. Smith, Dartmouth College</p>
  </div>
  <div class="page">
    <p>Q&amp;A</p>
    <p>Samuel Tan, Rebecca Shapiro, Sean W. Smith, Dartmouth College</p>
    <p>Samuel Tan samueltan@gmail.com</p>
    <p>Rebecca Shapiro bx@cs.dartmouth.edu</p>
    <p>Sean W. Smith sws@cs.dartmouth.edu</p>
  </div>
</Presentation>
