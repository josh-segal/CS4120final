<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Serge Abiteboul 1, T.-H. Hubert Chan 2, Evgeny Kharlamov 1,3</p>
    <p>Werner Nutt 3, Pierre Senellart 4</p>
    <p>Agrgation de documents XML probabilistes</p>
  </div>
  <div class="page">
    <p>BDA Namur - 21/10/2009Agrgation de documents XML probabilistes 2</p>
    <p>Incomplete Databases</p>
    <p>An incomplete database D contains many instances D = { d1,..., dn,...}</p>
    <p>Query q(x), constant c</p>
    <p>c is a certain answer for q if c  q(di) for all di  D</p>
    <p>c is a possible answer for q if c  q(di) for some di  D</p>
    <p>Many ways to represent incomplete databases</p>
  </div>
  <div class="page">
    <p>BDA Namur - 21/10/2009Agrgation de documents XML probabilistes 3</p>
    <p>Probabilistic Databases Incomplete database D = { d1,..., dn }  with probabilities Pr(di) &gt; 0 for each instance  such that Pr(d1) + ... + Pr(dn) = 1</p>
    <p>Query q returns constant c with probability p if</p>
    <p>p =  Pr(di) cq(di)</p>
    <p>Mainly studied in the relational setting  Imprecise data on the Web  Probabilistic XML</p>
  </div>
  <div class="page">
    <p>BDA Namur - 21/10/2009Agrgation de documents XML probabilistes 4</p>
    <p>Personnel Data, Instance 1</p>
    <p>IT-personnel</p>
    <p>person</p>
    <p>name bonus bonusname</p>
    <p>person</p>
    <p>Mary PDALaptop</p>
    <p>John</p>
  </div>
  <div class="page">
    <p>BDA Namur - 21/10/2009Agrgation de documents XML probabilistes 5</p>
    <p>Personnel Data, Instance 2</p>
    <p>IT-personnel</p>
    <p>person</p>
    <p>name bonus bonusname</p>
    <p>person</p>
    <p>Mary PDARick</p>
    <p>PDA</p>
  </div>
  <div class="page">
    <p>BDA Namur - 21/10/2009Agrgation de documents XML probabilistes 6</p>
    <p>Example: Personnel Queries</p>
    <p>What are the names of the IT personnel?</p>
    <p>What bonuses were paid for the PDA project?</p>
    <p>What is the sum of bonuses paid to all employees?&quot;</p>
  </div>
  <div class="page">
    <p>BDA Namur - 21/10/2009Agrgation de documents XML probabilistes 7</p>
    <p>Personnel DB: Certain/Possible Answers</p>
    <p>What are the names of the IT personnel? Mary: certain Rick: possible</p>
    <p>What bonuses were paid for the PDA project? 44: certain 15: possible</p>
    <p>What is the sum of bonuses paid to all employees? no certain answer 161, 119: possible</p>
    <p>Aggregate queries depend on the presence of many data</p>
  </div>
  <div class="page">
    <p>BDA Namur - 21/10/2009Agrgation de documents XML probabilistes 8</p>
    <p>If We Had Probabilities</p>
    <p>we could ask</p>
    <p>What is the probability that the sum of bonuses = 161?</p>
    <p>What are all possible sums of bonuses? And what is each ones probability?</p>
    <p>What is the expected value of the sum of bonuses? And what the variance?</p>
    <p>Distribution of sums of bonuses</p>
    <p>Moments</p>
  </div>
  <div class="page">
    <p>BDA Namur - 21/10/2009Agrgation de documents XML probabilistes 9</p>
    <p>The Problem Space</p>
    <p>Probabilistic XML Document Models</p>
    <p>Aggregate Function</p>
    <p>Query Language</p>
    <p>Distributional Nodes</p>
    <p>(MUX-DET)</p>
    <p>Events</p>
    <p>COUNT SUM MIN COUNTD AVG</p>
    <p>Single Path Queries</p>
    <p>Tree Pattern Queries</p>
    <p>Tree Pattern Queries with Joins</p>
    <p>Our focus</p>
  </div>
  <div class="page">
    <p>BDA Namur - 21/10/2009Agrgation de documents XML probabilistes 10</p>
    <p>Probabilistic XML: Events</p>
    <p>J: John hired for Laptop project</p>
    <p>M: Mary worked overtime</p>
    <p>Independent Events</p>
    <p>Pr(J) = 0.3</p>
    <p>Pr(M) = 0.6</p>
    <p>Probabilities of Events</p>
    <p>IT-personnel</p>
    <p>person</p>
    <p>name bonus bonusname</p>
    <p>person</p>
    <p>Mary PDALaptop</p>
    <p>John Rick</p>
    <p>PDA</p>
    <p>J J JJ</p>
    <p>J, M M M</p>
    <p>[Abiteboul/Senellart]</p>
  </div>
  <div class="page">
    <p>BDA Namur - 21/10/2009Agrgation de documents XML probabilistes 11</p>
    <p>John was hired, Mary worked overtime</p>
    <p>J: John hired for Laptop project</p>
    <p>M: Mary worked overtime</p>
    <p>Pr(J) = 0.3</p>
    <p>Pr(M) = 0.6</p>
    <p>IT-personnel</p>
    <p>person</p>
    <p>name bonus bonusname</p>
    <p>person</p>
    <p>Mary PDALaptop</p>
    <p>John Rick</p>
    <p>PDA</p>
    <p>J J JJ</p>
    <p>J, M M M</p>
  </div>
  <div class="page">
    <p>BDA Namur - 21/10/2009Agrgation de documents XML probabilistes 12</p>
    <p>John was hired, Mary worked overtime</p>
    <p>J: John hired for Laptop project</p>
    <p>M: Mary worked overtime</p>
    <p>IT-personnel</p>
    <p>person</p>
    <p>name bonus bonusname</p>
    <p>person</p>
    <p>Mary PDALaptop</p>
    <p>John</p>
    <p>Pr(J) = 0.3</p>
    <p>Pr(M) = 0.6</p>
    <p>Pr(d1) = 0.3 x 0.6</p>
  </div>
  <div class="page">
    <p>BDA Namur - 21/10/2009Agrgation de documents XML probabilistes 13</p>
    <p>John wasnt hired, Mary worked overtime</p>
    <p>J: John hired for Laptop project</p>
    <p>M: Mary worked overtime</p>
    <p>Pr(J) = 0.3</p>
    <p>Pr(M) = 0.6</p>
    <p>Pr(d2) = 0.7 x 0.6</p>
    <p>IT-personnel</p>
    <p>person</p>
    <p>name bonus bonusname</p>
    <p>person</p>
    <p>Mary PDALaptop</p>
    <p>John Rick</p>
    <p>PDA</p>
    <p>J J JJ</p>
    <p>J, M M M</p>
  </div>
  <div class="page">
    <p>BDA Namur - 21/10/2009Agrgation de documents XML probabilistes 14</p>
    <p>John wasnt hired, Mary worked overtime</p>
    <p>J: John hired for Laptop project</p>
    <p>M: Mary worked overtime</p>
    <p>IT-personnel</p>
    <p>person</p>
    <p>name bonus bonusname</p>
    <p>person</p>
    <p>Mary PDARick</p>
    <p>PDA</p>
    <p>Pr(J) = 0.3</p>
    <p>Pr(M) = 0.6</p>
    <p>Pr(d2) = 0.7 x 0.6</p>
  </div>
  <div class="page">
    <p>BDA Namur - 21/10/2009Agrgation de documents XML probabilistes 15</p>
    <p>Probabilistic XML: MUX and DET Nodes IT-personnel</p>
    <p>person</p>
    <p>bonusname</p>
    <p>person</p>
    <p>Mary PDA</p>
    <p>name bonus</p>
    <p>John Rick</p>
    <p>MUX</p>
    <p>Laptop</p>
    <p>PDA</p>
    <p>MUX</p>
    <p>MUX</p>
    <p>DET</p>
    <p>MUX</p>
    <p>DET</p>
    <p>Children represent mutually exclusive choices, choices for different mux-nodes are independent</p>
    <p>Deterministic nodes, children are combined</p>
    <p>[Nierman/ Jagadish, Kimelfeld/ Sagiv]</p>
  </div>
  <div class="page">
    <p>BDA Namur - 21/10/2009Agrgation de documents XML probabilistes 16</p>
    <p>Probabilistic XML: MUX and DET Nodes IT-personnel</p>
    <p>person</p>
    <p>bonusname</p>
    <p>person</p>
    <p>Mary PDA</p>
    <p>name bonus</p>
    <p>John Rick</p>
    <p>MUX</p>
    <p>PDA</p>
    <p>MUX</p>
    <p>MUX</p>
    <p>DET</p>
    <p>John PDA</p>
    <p>Pr = 0.3 x 0.7 x 0.6</p>
  </div>
  <div class="page">
    <p>BDA Namur - 21/10/2009Agrgation de documents XML probabilistes 17</p>
    <p>Probabilistic XML (PXML)  A PXML document D</p>
    <p>represents (exponentially) many document instances d  each with a probability Pr(d)</p>
    <p>PXML document models  CIE: long-distance dependencies  MUX-DET: only hierarchical dependencies  MUX-DET can be expressed by CIE,</p>
    <p>but not (concisely) the other way round</p>
    <p>Other models can be reduced to the ones above, or behave similarly</p>
  </div>
  <div class="page">
    <p>BDA Namur - 21/10/2009Agrgation de documents XML probabilistes 18</p>
    <p>Aggregate Functions</p>
    <p>: finite bags of values  domain</p>
    <p>Examples:  count, countd: finite bags of anything N  sum, avg: finite bags of rational numbers  Q</p>
    <p>Similarly: min, max, parity, top K, ...</p>
  </div>
  <div class="page">
    <p>BDA Namur - 21/10/2009Agrgation de documents XML probabilistes 19</p>
    <p>Aggregate Queries</p>
    <p>Q = (q)</p>
    <p>Two Layers  nonaggregate query q(x)</p>
    <p>returns set of nodes q(d) over instance d</p>
    <p>aggregate function   applied to the labels of nodes in q(d)  returns single value</p>
    <p>(q(d))</p>
  </div>
  <div class="page">
    <p>BDA Namur - 21/10/2009Agrgation de documents XML probabilistes 20</p>
    <p>Single Path Queries</p>
    <p>Simple form of tree pattern queries</p>
    <p>Paths of node labels or *, connected by child and descendant edges</p>
    <p>Return the set of leaf nodes reachable from the root along such a path</p>
    <p>IT-personnel</p>
    <p>bonus</p>
    <p>*</p>
    <p>Which bonuses have been paid?</p>
    <p>qbonus</p>
  </div>
  <div class="page">
    <p>BDA Namur - 21/10/2009Agrgation de documents XML probabilistes 21</p>
    <p>Single Path Aggregate Queries: Examples</p>
    <p>SUM(qbonus)</p>
    <p>What is the sum of all bonuses?</p>
    <p>MAX(qbonus)</p>
    <p>What is maximal bonus that was paid?</p>
  </div>
  <div class="page">
    <p>BDA Namur - 21/10/2009Agrgation de documents XML probabilistes 22</p>
    <p>Answer Distributions PXML document D, instances {d1,, dn}</p>
    <p>SUM(qbonus) returns exactly one number for every di  SUM(qbonus) is a random variable</p>
    <p>SUM(qbonus) induces a probability distribution over D</p>
    <p>f(s) =  Pr(di), SUM(qbonus)(di) = s</p>
    <p>the answer distribution</p>
    <p>Notation: SUM(qbonus)(D) or (q)(D) abstractly</p>
  </div>
  <div class="page">
    <p>BDA Namur - 21/10/2009Agrgation de documents XML probabilistes 23</p>
    <p>Special Case: Document Aggregation</p>
    <p>D with instances {d1,, dn},</p>
    <p>Applying  to a regular document di :</p>
    <p>(di) := ({| c | c is a value on a leaf of di |})</p>
    <p>Applying  to the probabilistic document D:</p>
    <p>(D)(c) =  Pr(di) (di) = c</p>
    <p>yields again a distribution (D)</p>
  </div>
  <div class="page">
    <p>BDA Namur - 21/10/2009Agrgation de documents XML probabilistes 24</p>
    <p>Reduction to Document Aggregation</p>
    <p>(q)(D) = ?</p>
    <p>Step 1: Compute a smaller PXML document</p>
    <p>D' = q(D)</p>
    <p>containing only matching paths</p>
    <p>Step 2: Apply  to D'</p>
    <p>Theorem: (q)(D) = (D')</p>
    <p>Depends on document models and simple path queries</p>
  </div>
  <div class="page">
    <p>BDA Namur - 21/10/2009Agrgation de documents XML probabilistes 25</p>
    <p>Applying qbonus</p>
    <p>qbonus( ) IT-personnel</p>
    <p>person</p>
    <p>bonus bonus</p>
    <p>person</p>
    <p>PDALaptop</p>
    <p>PDA</p>
    <p>name</p>
    <p>Mary</p>
    <p>name</p>
    <p>John Rick</p>
    <p>J J JJ</p>
    <p>J, M M M</p>
    <p>= keep only the paths that match</p>
    <p>analogous for MUX-DET</p>
  </div>
  <div class="page">
    <p>BDA Namur - 21/10/2009Agrgation de documents XML probabilistes 26</p>
    <p>Evaluating Single Path Queries/2 IT-personnel</p>
    <p>person</p>
    <p>bonus</p>
    <p>person</p>
    <p>PDA</p>
    <p>bonus</p>
    <p>Laptop</p>
    <p>PDA</p>
    <p>MUX</p>
    <p>MUX</p>
    <p>DET</p>
    <p>name</p>
    <p>Mary</p>
    <p>name</p>
    <p>John Rick</p>
    <p>MUX</p>
    <p>qbonus( )</p>
  </div>
  <div class="page">
    <p>BDA Namur - 21/10/2009Agrgation de documents XML probabilistes 27</p>
    <p>Problems Investigated</p>
    <p>PXML document D, constant c</p>
    <p>Possible Value: Decide Pr((D) = c) &gt; 0</p>
    <p>Probability Computation: Compute Pr((D) = c)</p>
    <p>Moment Computation: Compute E((D)k)</p>
    <p>E is expected value</p>
  </div>
  <div class="page">
    <p>BDA Namur - 21/10/2009Agrgation de documents XML probabilistes 28</p>
    <p>Aggregation over CIE</p>
    <p>FP#P-cFP#P-cFP#P-cPP Moment Computation</p>
    <p>FP#P-cFP#P-cFP#P-cin FP#Pin FP#P Probability Computation</p>
    <p>NP-cNP-cNP-cNP-cNP-c Possible Value</p>
    <p>AVGCOUNTDMINSUMCOUNT</p>
  </div>
  <div class="page">
    <p>BDA Namur - 21/10/2009Agrgation de documents XML probabilistes 29</p>
    <p>Aggregation over CIE/2  Possible Value: Too much propositional logic present</p>
    <p>Probability Computation: cannot be easier</p>
    <p>Moment Computation:  Difficult for MIN, COUNTD, AVG  Easy for COUNT and SUM:</p>
    <p>Moments are sums, moments of COUNT and SUM are sums of sums, which can be rearranged</p>
  </div>
  <div class="page">
    <p>BDA Namur - 21/10/2009Agrgation de documents XML probabilistes 30</p>
    <p>Aggregation over MUX-DET</p>
    <p>PPPPP Moment Computation</p>
    <p>FP#P-cFP#P-cP P</p>
    <p>in |input| + |distribution|</p>
    <p>P Probability Computation</p>
    <p>In NPNP-cPNP-cP Possible Value</p>
    <p>AVGCOUNTDMINSUMCOUNT</p>
  </div>
  <div class="page">
    <p>BDA Namur - 21/10/2009Agrgation de documents XML probabilistes 31</p>
    <p>COUNT, SUM, MIN are Easy ...</p>
    <p>because they allow for divide and conquer evaluation:</p>
    <p>SUM {| a,b,c,d |} = SUM {| a,b |} + SUM {| c,d |}</p>
    <p>is a monoid aggregate function if</p>
    <p>({| a1,..., an |} = ({| a1 |}) ...  ({| an |})</p>
    <p>for some commutative monoid (M, ) and all a1,..., an in M</p>
    <p>Examples:  count, sum, min, parity, top K  countd, avg</p>
  </div>
  <div class="page">
    <p>BDA Namur - 21/10/2009Agrgation de documents XML probabilistes 32</p>
    <p>Convex Sums and Convolutions</p>
    <p>MUX p q</p>
    <p>( ) = p ( ) + q ( )</p>
    <p>Other node</p>
    <p>( ) = ( )  ( )</p>
    <p>If  is a monoid function, answer distributions can be computed bottom up, using two operations:</p>
    <p>Convex Sum:</p>
    <p>Convolution:</p>
    <p>depends on the monoid</p>
  </div>
  <div class="page">
    <p>BDA Namur - 21/10/2009Agrgation de documents XML probabilistes 33</p>
    <p>Convolution of Distributions</p>
    <p>(M, ) monoid</p>
    <p>(D1), (D2) distributions of subdocuments</p>
    <p>(((D1)  (D2)) (c) =  (D1)(c1) (D2)(c2) c1  c2 = c</p>
  </div>
  <div class="page">
    <p>BDA Namur - 21/10/2009Agrgation de documents XML probabilistes 34</p>
    <p>Approximating Query Answers</p>
    <p>Over CIE, probability and moment computation can be hard How good are Monte-Carlo methods?</p>
    <p>Classical results (Hoeffding) imply: To achieve</p>
    <p>| E((D)k)  Estimate | &lt;  with probability 1</p>
    <p>at most O(R2k -2 log 1/) samples are needed, where R = max |(d)|.</p>
    <p>Consequence: Given  and , at most quadratically many samples are needed for E(COUNTD(D)).</p>
  </div>
  <div class="page">
    <p>BDA Namur - 21/10/2009Agrgation de documents XML probabilistes 35</p>
    <p>Probabilistic Aggregation: Related Work</p>
    <p>Tree pattern queries over MUX-DET with HAVING constraints [Cohen/Kimelfeld/Sagiv]</p>
    <p>Conjunctive queries with HAVING constraints over relational probabilistic databases [Re/Suciu]</p>
    <p>Work on various special topics in the relational setting  probabilistic data streams  uncertain schema mappings</p>
  </div>
  <div class="page">
    <p>BDA Namur - 21/10/2009Agrgation de documents XML probabilistes 36</p>
    <p>Aggregates over PXML: Conclusion First results of an ongoing project  Map of the problem space  Largely complete investigation for single path queries:</p>
    <p>Intractability for CIE  Hierarchical dependencies in MUX-DET can be</p>
    <p>exploited for monoid aggregation functions</p>
    <p>Some results carry over to other models, e.g.,  Uncertain schema mappings (Dong/Halevy/Yu)</p>
    <p>Current work:  richer query languages, continuous distributions on leaves</p>
  </div>
</Presentation>
