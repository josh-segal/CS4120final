<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>,</p>
    <p>Faculty of computer science</p>
    <p>Transparent Microsegmentation in Smart Home IoT Networks</p>
    <p>Amr Osman1 Armin Wasicek2 Stefan Kpsell1 Thorsten Strufe1</p>
    <p>rstname.lastname@tu-dresden.de 2Avast Inc.</p>
    <p>HotEdge20</p>
  </div>
  <div class="page">
    <p>Outline</p>
    <p>HotEdge20 Transparent Microsegmentation in Smart Home IoT Networks slide 1 of 27</p>
  </div>
  <div class="page">
    <p>HotEdge20 Transparent Microsegmentation in Smart Home IoT Networks slide 2 of 27</p>
  </div>
  <div class="page">
    <p>Smart home IoT networks</p>
    <p>[1]HotEdge20 Transparent Microsegmentation in Smart Home IoT Networks slide 3 of 27</p>
  </div>
  <div class="page">
    <p>HotEdge20 Transparent Microsegmentation in Smart Home IoT Networks slide 4 of 27</p>
  </div>
  <div class="page">
    <p>Problem statement</p>
    <p>Communication setting:</p>
    <p>Mixed wired + wireless connectivity  TCP/IP Protocol suite  Ethernet as a L2 protocol (802.11 MAC</p>
    <p>addresses)</p>
    <p>Threat model:</p>
    <p>Internal attacker  Active  Laterally moving  Seeks: Reconnaissance, Data exitration,</p>
    <p>Unauthorized access, DoS, .. etc) Internet</p>
    <p>HotEdge20 Transparent Microsegmentation in Smart Home IoT Networks slide 5 of 27</p>
  </div>
  <div class="page">
    <p>Problem statement</p>
    <p>Communication setting:</p>
    <p>Mixed wired + wireless connectivity  TCP/IP Protocol suite  Ethernet as a L2 protocol (802.11 MAC</p>
    <p>addresses)</p>
    <p>Threat model:</p>
    <p>Internal attacker  Active  Laterally moving  Seeks: Reconnaissance, Data exitration,</p>
    <p>Unauthorized access, DoS, .. etc) Internet</p>
    <p>HotEdge20 Transparent Microsegmentation in Smart Home IoT Networks slide 5 of 27</p>
  </div>
  <div class="page">
    <p>HotEdge20 Transparent Microsegmentation in Smart Home IoT Networks slide 6 of 27</p>
  </div>
  <div class="page">
    <p>Requirements</p>
    <p>Isolation: controlling communication between devices within each microsegment, between microsegments, and external endpoints in the cloud or internet.</p>
    <p>Scalability: sustaining a large number of microsegments, IoT devices and home networks.  Edge-readiness: virtual network functions in the edge cloud must seamlessly augment the home network.  Automatic segment allocation: newly connected devices should be automatically recognized, identied</p>
    <p>and appropriately put into a microsegment.</p>
    <p>Adaptability: dynamically changing the current set of microsegments conguration at runtime as new devices are added to the smart home.</p>
    <p>0-conf: require no manual congurations for the residential gateway and the IoT end devices.</p>
    <p>HotEdge20 Transparent Microsegmentation in Smart Home IoT Networks slide 7 of 27</p>
  </div>
  <div class="page">
    <p>Requirements</p>
    <p>Isolation: controlling communication between devices within each microsegment, between microsegments, and external endpoints in the cloud or internet.</p>
    <p>Scalability: sustaining a large number of microsegments, IoT devices and home networks.  Edge-readiness: virtual network functions in the edge cloud must seamlessly augment the home network.  Automatic segment allocation: newly connected devices should be automatically recognized, identied</p>
    <p>and appropriately put into a microsegment.</p>
    <p>Adaptability: dynamically changing the current set of microsegments conguration at runtime as new devices are added to the smart home.</p>
    <p>0-conf: require no manual congurations for the residential gateway and the IoT end devices.</p>
    <p>HotEdge20 Transparent Microsegmentation in Smart Home IoT Networks slide 7 of 27</p>
  </div>
  <div class="page">
    <p>Requirements</p>
    <p>Isolation: controlling communication between devices within each microsegment, between microsegments, and external endpoints in the cloud or internet.</p>
    <p>Scalability: sustaining a large number of microsegments, IoT devices and home networks.  Edge-readiness: virtual network functions in the edge cloud must seamlessly augment the home network.  Automatic segment allocation: newly connected devices should be automatically recognized, identied</p>
    <p>and appropriately put into a microsegment.</p>
    <p>Adaptability: dynamically changing the current set of microsegments conguration at runtime as new devices are added to the smart home.</p>
    <p>0-conf: require no manual congurations for the residential gateway and the IoT end devices.</p>
    <p>HotEdge20 Transparent Microsegmentation in Smart Home IoT Networks slide 7 of 27</p>
  </div>
  <div class="page">
    <p>Requirements</p>
    <p>Isolation: controlling communication between devices within each microsegment, between microsegments, and external endpoints in the cloud or internet.</p>
    <p>Scalability: sustaining a large number of microsegments, IoT devices and home networks.  Edge-readiness: virtual network functions in the edge cloud must seamlessly augment the home network.  Automatic segment allocation: newly connected devices should be automatically recognized, identied</p>
    <p>and appropriately put into a microsegment.</p>
    <p>Adaptability: dynamically changing the current set of microsegments conguration at runtime as new devices are added to the smart home.</p>
    <p>0-conf: require no manual congurations for the residential gateway and the IoT end devices.</p>
    <p>HotEdge20 Transparent Microsegmentation in Smart Home IoT Networks slide 7 of 27</p>
  </div>
  <div class="page">
    <p>Requirements</p>
    <p>Isolation: controlling communication between devices within each microsegment, between microsegments, and external endpoints in the cloud or internet.</p>
    <p>Scalability: sustaining a large number of microsegments, IoT devices and home networks.  Edge-readiness: virtual network functions in the edge cloud must seamlessly augment the home network.  Automatic segment allocation: newly connected devices should be automatically recognized, identied</p>
    <p>and appropriately put into a microsegment.</p>
    <p>Adaptability: dynamically changing the current set of microsegments conguration at runtime as new devices are added to the smart home.</p>
    <p>0-conf: require no manual congurations for the residential gateway and the IoT end devices.</p>
    <p>HotEdge20 Transparent Microsegmentation in Smart Home IoT Networks slide 7 of 27</p>
  </div>
  <div class="page">
    <p>Requirements</p>
    <p>Isolation: controlling communication between devices within each microsegment, between microsegments, and external endpoints in the cloud or internet.</p>
    <p>Scalability: sustaining a large number of microsegments, IoT devices and home networks.  Edge-readiness: virtual network functions in the edge cloud must seamlessly augment the home network.  Automatic segment allocation: newly connected devices should be automatically recognized, identied</p>
    <p>and appropriately put into a microsegment.</p>
    <p>Adaptability: dynamically changing the current set of microsegments conguration at runtime as new devices are added to the smart home.</p>
    <p>0-conf: require no manual congurations for the residential gateway and the IoT end devices.</p>
    <p>HotEdge20 Transparent Microsegmentation in Smart Home IoT Networks slide 7 of 27</p>
  </div>
  <div class="page">
    <p>Requirements</p>
    <p>Isolation: controlling communication between devices within each microsegment, between microsegments, and external endpoints in the cloud or internet.</p>
    <p>Scalability: sustaining a large number of microsegments, IoT devices and home networks.  Edge-readiness: virtual network functions in the edge cloud must seamlessly augment the home network.  Automatic segment allocation: newly connected devices should be automatically recognized, identied</p>
    <p>and appropriately put into a microsegment.</p>
    <p>Adaptability: dynamically changing the current set of microsegments conguration at runtime as new devices are added to the smart home.</p>
    <p>0-conf: require no manual congurations for the residential gateway and the IoT end devices.</p>
    <p>HotEdge20 Transparent Microsegmentation in Smart Home IoT Networks slide 7 of 27</p>
  </div>
  <div class="page">
    <p>HotEdge20 Transparent Microsegmentation in Smart Home IoT Networks slide 8 of 27</p>
  </div>
  <div class="page">
    <p>Existing solutions Categories: Firewalls, VLANs, Overlays, Multiple APs, NAC-Servers, IP Subnets</p>
    <p>Solution Isolation Scalability Edge-ready? Auto-alloc. Adaptability 0-conf</p>
    <p>Firewall Can No No No Can No</p>
    <p>VLAN Yes 4096 No No Can No</p>
    <p>VxLAN Yes 224 No No Can No</p>
    <p>Multi-AP Yes ~10 No No No No</p>
    <p>RADIUS Can No No No Yes No</p>
    <p>Subnetsv4 Can ~230  2 No No No No MUD Can No No Yes Can No</p>
    <p>Ours Yes 264 Yes Yes Yes Yes</p>
    <p>Notes:  VLANs are not well-suited for WLANs  All existing solutions require complex manual conguration on the residential gateway, prior knowledge</p>
    <p>about the topology and are not transparent to the end user  Some of the existing solutions require complex congurations for the IoT end devices and the infrastructure</p>
    <p>(e.g. RADIUS, Multi-AP, MUD)</p>
    <p>HotEdge20 Transparent Microsegmentation in Smart Home IoT Networks slide 9 of 27</p>
  </div>
  <div class="page">
    <p>Existing solutions Categories: Firewalls, VLANs, Overlays, Multiple APs, NAC-Servers, IP Subnets</p>
    <p>Solution Isolation Scalability Edge-ready? Auto-alloc. Adaptability 0-conf</p>
    <p>Firewall Can No No No Can No</p>
    <p>VLAN Yes 4096 No No Can No</p>
    <p>VxLAN Yes 224 No No Can No</p>
    <p>Multi-AP Yes ~10 No No No No</p>
    <p>RADIUS Can No No No Yes No</p>
    <p>Subnetsv4 Can ~230  2 No No No No MUD Can No No Yes Can No</p>
    <p>Ours Yes 264 Yes Yes Yes Yes</p>
    <p>Notes:  VLANs are not well-suited for WLANs  All existing solutions require complex manual conguration on the residential gateway, prior knowledge</p>
    <p>about the topology and are not transparent to the end user  Some of the existing solutions require complex congurations for the IoT end devices and the infrastructure</p>
    <p>(e.g. RADIUS, Multi-AP, MUD)</p>
    <p>HotEdge20 Transparent Microsegmentation in Smart Home IoT Networks slide 9 of 27</p>
  </div>
  <div class="page">
    <p>HotEdge20 Transparent Microsegmentation in Smart Home IoT Networks slide 10 of 27</p>
  </div>
  <div class="page">
    <p>Microsegmentation Two edge cloud VNFs are implemented: Network Inventory &amp; Microsegmenter</p>
    <p>Network Inventory: Automatically ngerprints, scans and classies devices based on functionality and security vulnerabilities</p>
    <p>Microsegmenter: Allocates devices to microsegments based on Network Inventory results Strategy: Classify and isolate devices based on functionalities, i.e. Printers, Mobile Devices, Laptop/PCs, Cameras, ... etc)</p>
    <p>Network InventoryMicrosegmenter</p>
    <p>HotEdge20 Transparent Microsegmentation in Smart Home IoT Networks slide 11 of 27</p>
  </div>
  <div class="page">
    <p>HotEdge20 Transparent Microsegmentation in Smart Home IoT Networks slide 12 of 27</p>
  </div>
  <div class="page">
    <p>System design</p>
    <p>vIoT1</p>
    <p>MQTT broker</p>
    <p>IoT Analytics</p>
    <p>IoT honeypot</p>
    <p>REST/HTTPS</p>
    <p>Microsegmenter</p>
    <p>OFlow/SSL</p>
    <p>Network Inventory Instance</p>
    <p>L2/Secure VPN</p>
    <p>REST/HTTPS</p>
    <p>Network Inventory</p>
    <p>Virtual Private Edge Cloud Smart Home Network Edge Cloud</p>
    <p>Control traffic</p>
    <p>Internet</p>
    <p>Microsegment</p>
    <p>HotEdge20 Transparent Microsegmentation in Smart Home IoT Networks slide 13 of 27</p>
  </div>
  <div class="page">
    <p>HotEdge20 Transparent Microsegmentation in Smart Home IoT Networks slide 14 of 27</p>
  </div>
  <div class="page">
    <p>Transparent microsegmentation</p>
    <p>SHG Micro-segmenter Network inventory</p>
    <p>Network Inventory Instance</p>
    <p>New IoT Device</p>
    <p>connect new device</p>
    <p>HTTP 200 OK new device</p>
    <p>HTTP 200 OK</p>
    <p>scan results</p>
    <p>scan new device</p>
    <p>updated net. inventory</p>
    <p>assign device to segment</p>
    <p>HTTP 200 OK</p>
    <p>ACK</p>
    <p>Automatic microsegment allocation</p>
    <p>HotEdge20 Transparent Microsegmentation in Smart Home IoT Networks slide 15 of 27</p>
  </div>
  <div class="page">
    <p>Transparent microsegmentation</p>
    <p>vIoT1</p>
    <p>MQTT broker</p>
    <p>IoT Analytics</p>
    <p>IoT honeypot</p>
    <p>Microsegmenter</p>
    <p>Network Inventory Instance</p>
    <p>L2/Secure VPN</p>
    <p>Network Inventory</p>
    <p>Virtual Private Edge Cloud Smart Home Network</p>
    <p>Edge Cloud</p>
    <p>Control traffic</p>
    <p>Internet</p>
    <p>Microsegment</p>
    <p>Automatic microsegment allocation</p>
    <p>HotEdge20 Transparent Microsegmentation in Smart Home IoT Networks slide 16 of 27</p>
  </div>
  <div class="page">
    <p>Transparent microsegmentation</p>
    <p>Internet</p>
    <p>Network ows isolation inter- and intra- segments</p>
    <p>HotEdge20 Transparent Microsegmentation in Smart Home IoT Networks slide 17 of 27</p>
  </div>
  <div class="page">
    <p>HotEdge20 Transparent Microsegmentation in Smart Home IoT Networks slide 18 of 27</p>
  </div>
  <div class="page">
    <p>Evaluation</p>
    <p>Used 3 dierent smart home network topologies with more than 28 dierent IoT devices from dierent vendors [1, 2, 3].</p>
    <p>Used well-known packet traces and IoT network vulnerability metrics from past literature.  Measured: Scalability, Eectiveness, Impact on functionality  Case study: Mirai infected webcam (65.85% attack surface reduction)</p>
    <p>HotEdge20 Transparent Microsegmentation in Smart Home IoT Networks slide 19 of 27</p>
  </div>
  <div class="page">
    <p>Evaluation</p>
    <p>Used 3 dierent smart home network topologies with more than 28 dierent IoT devices from dierent vendors [1, 2, 3].</p>
    <p>Used well-known packet traces and IoT network vulnerability metrics from past literature.  Measured: Scalability, Eectiveness, Impact on functionality  Case study: Mirai infected webcam (65.85% attack surface reduction)</p>
    <p>HotEdge20 Transparent Microsegmentation in Smart Home IoT Networks slide 19 of 27</p>
  </div>
  <div class="page">
    <p>Evaluation</p>
    <p>Used 3 dierent smart home network topologies with more than 28 dierent IoT devices from dierent vendors [1, 2, 3].</p>
    <p>Used well-known packet traces and IoT network vulnerability metrics from past literature.  Measured: Scalability, Eectiveness, Impact on functionality  Case study: Mirai infected webcam (65.85% attack surface reduction)</p>
    <p>HotEdge20 Transparent Microsegmentation in Smart Home IoT Networks slide 19 of 27</p>
  </div>
  <div class="page">
    <p>Evaluation</p>
    <p>Used 3 dierent smart home network topologies with more than 28 dierent IoT devices from dierent vendors [1, 2, 3].</p>
    <p>Used well-known packet traces and IoT network vulnerability metrics from past literature.  Measured: Scalability, Eectiveness, Impact on functionality  Case study: Mirai infected webcam (65.85% attack surface reduction)</p>
    <p>HotEdge20 Transparent Microsegmentation in Smart Home IoT Networks slide 19 of 27</p>
  </div>
  <div class="page">
    <p>Evaluation</p>
    <p>Used 3 dierent smart home network topologies with more than 28 dierent IoT devices from dierent vendors [1, 2, 3].</p>
    <p>Used well-known packet traces and IoT network vulnerability metrics from past literature.  Measured: Scalability, Eectiveness, Impact on functionality  Case study: Mirai infected webcam (65.85% attack surface reduction)</p>
    <p>HotEdge20 Transparent Microsegmentation in Smart Home IoT Networks slide 19 of 27</p>
  </div>
  <div class="page">
    <p>Scalability</p>
    <p>Number of... Count</p>
    <p>Smart homes 264</p>
    <p>Segments per home 264</p>
    <p>Devices per segment 248  2 OF rules required s[n(n + 1)  2] + 8</p>
    <p>Where:</p>
    <p>s is the total number of segments  n is the number of devices in a microsegment</p>
    <p>HotEdge20 Transparent Microsegmentation in Smart Home IoT Networks slide 20 of 27</p>
  </div>
  <div class="page">
    <p>Eectiveness</p>
    <p>Without segmentation</p>
    <p>Segment HP Inkjet</p>
    <p>Segment Ring</p>
    <p>Segment Google Home</p>
    <p>Full isolation 0.70</p>
    <p>Exploitability score</p>
    <p>Without segmentation</p>
    <p>Chinese Webcam</p>
    <p>Amazon Echo</p>
    <p>Belkin WeMo Switch</p>
    <p>Full isolation 0.00</p>
    <p>Network exposure</p>
    <p>HotEdge20 Transparent Microsegmentation in Smart Home IoT Networks slide 21 of 27</p>
  </div>
  <div class="page">
    <p>Case study: Mirai</p>
    <p>Bas elin</p>
    <p>e</p>
    <p>Bel kin</p>
    <p>Cam era</p>
    <p>HP Env</p>
    <p>y Pr inte</p>
    <p>r</p>
    <p>Am azo</p>
    <p>n E cho Full</p>
    <p>HotEdge20 Transparent Microsegmentation in Smart Home IoT Networks slide 22 of 27</p>
  </div>
  <div class="page">
    <p>Transparency</p>
    <p>From To</p>
    <p>HP Envy Printer Laptop Samsung Smart Cam Belkin Motion Sensor Samsung Smart Cam Samsung Galaxy Tab Belkin Motion Sensor Samsung Smart Cam</p>
    <p>Insteon Camera Samsung Galaxy Tab Samsung Galaxy Tab Samsung Smart Cam</p>
    <p>Only 2.16% of the network ows were blocked due to functional microsegmentation</p>
    <p>We also identied some ows in dataset that are likely malicious:</p>
    <p>HP Envy Printer  Laptop  Insteon Camera  Samsung Galaxy Tab  Belkin Motion Sensor  Samsung Smart Cam (?)</p>
    <p>HotEdge20 Transparent Microsegmentation in Smart Home IoT Networks slide 23 of 27</p>
  </div>
  <div class="page">
    <p>HotEdge20 Transparent Microsegmentation in Smart Home IoT Networks slide 24 of 27</p>
  </div>
  <div class="page">
    <p>Conclusion</p>
    <p>Introduced a novel edge cloud architecture to secure smarthome IoT networks against an internal adversary via microsegmentation.</p>
    <p>Implemented one transparent microsegmentation strategy according to functional groups.  Evaluated our approach on 3 dierent topologies using dierent network exploitability metrics.  In the best case, we acheived a 65.85% attack surface reduction against a Mirai-infected webcam</p>
    <p>at the cost of blocking 2.16% of the otherwise-accepted ows in the network.</p>
    <p>HotEdge20 Transparent Microsegmentation in Smart Home IoT Networks slide 25 of 27</p>
  </div>
  <div class="page">
    <p>Conclusion</p>
    <p>Introduced a novel edge cloud architecture to secure smarthome IoT networks against an internal adversary via microsegmentation.</p>
    <p>Implemented one transparent microsegmentation strategy according to functional groups.  Evaluated our approach on 3 dierent topologies using dierent network exploitability metrics.  In the best case, we acheived a 65.85% attack surface reduction against a Mirai-infected webcam</p>
    <p>at the cost of blocking 2.16% of the otherwise-accepted ows in the network.</p>
    <p>HotEdge20 Transparent Microsegmentation in Smart Home IoT Networks slide 25 of 27</p>
  </div>
  <div class="page">
    <p>Conclusion</p>
    <p>Introduced a novel edge cloud architecture to secure smarthome IoT networks against an internal adversary via microsegmentation.</p>
    <p>Implemented one transparent microsegmentation strategy according to functional groups.  Evaluated our approach on 3 dierent topologies using dierent network exploitability metrics.  In the best case, we acheived a 65.85% attack surface reduction against a Mirai-infected webcam</p>
    <p>at the cost of blocking 2.16% of the otherwise-accepted ows in the network.</p>
    <p>HotEdge20 Transparent Microsegmentation in Smart Home IoT Networks slide 25 of 27</p>
  </div>
  <div class="page">
    <p>Conclusion</p>
    <p>Introduced a novel edge cloud architecture to secure smarthome IoT networks against an internal adversary via microsegmentation.</p>
    <p>Implemented one transparent microsegmentation strategy according to functional groups.  Evaluated our approach on 3 dierent topologies using dierent network exploitability metrics.  In the best case, we acheived a 65.85% attack surface reduction against a Mirai-infected webcam</p>
    <p>at the cost of blocking 2.16% of the otherwise-accepted ows in the network.</p>
    <p>HotEdge20 Transparent Microsegmentation in Smart Home IoT Networks slide 25 of 27</p>
  </div>
  <div class="page">
    <p>Conclusion</p>
    <p>Introduced a novel edge cloud architecture to secure smarthome IoT networks against an internal adversary via microsegmentation.</p>
    <p>Implemented one transparent microsegmentation strategy according to functional groups.  Evaluated our approach on 3 dierent topologies using dierent network exploitability metrics.  In the best case, we acheived a 65.85% attack surface reduction against a Mirai-infected webcam</p>
    <p>at the cost of blocking 2.16% of the otherwise-accepted ows in the network.</p>
    <p>HotEdge20 Transparent Microsegmentation in Smart Home IoT Networks slide 25 of 27</p>
  </div>
  <div class="page">
    <p>References</p>
    <p>References I</p>
    <p>A. Sivanathan, H. H. Gharakheili, F. Loi, A. Radford, C. Wijenayake, A. Vishwanath, and V. Sivaraman, Classifying IoT devices in smart</p>
    <p>environments using network trac characteristics, IEEE Trans. Mobile Comput., vol. 18, no. 8, 2019.</p>
    <p>J. Payne, K. Budhraja, and A. Kundu, How secure is your IoT network? in IEEE ICIOT, jul 2019.</p>
    <p>O. Alrawi, C. Lever, M. Antonakakis, and F. Monrose, SoK: Security evaluation of home-based IoT deployments, in IEEE S&amp;P, 2019.</p>
    <p>HotEdge20 Transparent Microsegmentation in Smart Home IoT Networks slide 26 of 27</p>
  </div>
  <div class="page">
    <p>. . . . . . . . . . . . . . . . Thanks! . . . . . . . . . . . . . . . .</p>
    <p>HotEdge20 Transparent Microsegmentation in Smart Home IoT Networks slide 27 of 27</p>
  </div>
</Presentation>
