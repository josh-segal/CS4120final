<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
    <p>Sergej Schumilo1, Cornelius Aschermann1, Robert Gawlik1, Sebastian Schinzel2, Thorsten Holz1 1Ruhr-Universitt Bochum, 2Mnster University of Applied Sciences</p>
  </div>
  <div class="page">
    <p>Motivation IJG jpeg libjpeg-turbo libpng libtiff mozjpeg PHP Mozilla Firefox Internet Explorer PCRE sqlite OpenSSL LibreOffice poppler freetype GnuTLS GnuPG PuTTY ntpd nginx bash tcpdump JavaScriptCore pdfium ffmpeg libmatroska libarchive ImageMagick BIND QEMU lcms Adobe Flash Oracle BerkeleyDB Android libstagefright iOS ImageIO FLAC audio library libsndfile less lesspipe strings file dpkg rcs systemd-resolved libyaml Info-Zip unzip libtasn1OpenBSD pfctl NetBSD bpf man mandocIDA Pro clamav</p>
    <p>libxml2glibc clang llvmnasm ctags mutt procmail fontconfig pdksh Qt wavpack OpenSSH redis lua-cmsgpack taglib privoxy perl libxmp radare2 SleuthKit fwknop X.Org exifprobe jhead capnproto Xerces-C metacam djvulibre exiv Linux btrfs Knot DNS curl</p>
    <p>wpa_supplicant Apple Safari libde265 dnsmasq libbpg lame libwmf uudecode MuPDF imlib2 libraw libbson libsass yara W3C tidyhtml5 VLC FreeBSD syscons John the Ripper screen tmux mosh UPX indent openjpeg MMIX OpenMPT rxvt dhcpcd Mozilla NSS Nettle mbed TLS Linux netlink Linux ext4 Linux xfs botan expat Adobe Reader libav libical OpenBSD kernel collectd libidn</p>
    <p>MatrixSSL jasperMaraDNS w3m Xen OpenH232 irssi cmark OpenCV Malheur gstreamer Tor gdk-pixbuf audiofilezstd lz4 stb cJSON libpcre MySQL gnulib openexr libmad ettercap lrzip freetds Asterisk ytnefraptor mpg123 exempi libgmime pev v8 sed awk make</p>
    <p>m4 yacc PHP ImageMagick freedesktop.org patch libtasn1 libvorbis zsh lua ninja ruby busybox gcrypt vim Tor poppler libopus BSD sh gcc qemu w3m zsh dropbear wireshark libtorrent git rust gravity e2fsprogs parrot lodepng json-glib cabextract libmspack qprint gpsbabel dmg2img antiword arj unrar unace zoo rzip lrzip libiso libtta duktape splint zpaq assimp cppcheck fasm catdoc pngcrush cmark p7zip libjbig2 aaphoto t1utils apngopt sqlparser mdp libtinyxml freexl bgpparser testdisk photorec btcd gumbo chaiscript teseq colcrt pttbbs capstone dex2oat pillow elftoolchain aribas universal-ctags uriparser jq lha xdelta gnuplot libwpd</p>
    <p>teseq cimg libiberty policycoreutils libsemanage renoise metapixel openclone mp3splt podofo Apache httpd glslang UEFITool libcbor lldpd pngquant muparserx mochilo pyhocon sysdig Overpass-API fish-shell gumbo-parser mapbox-gl-native rapidjson</p>
    <p>libjson FLIF MultiMarkdown astyle pax-utils zziplib PyPDF spiffing apk pgpdump icoutils msitools dosfstools</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Motivation IJG jpeg libjpeg-turbo libpng libtiff mozjpeg PHP Mozilla Firefox Internet Explorer PCRE sqlite OpenSSL LibreOffice poppler freetype GnuTLS GnuPG PuTTY ntpd nginx bash tcpdump JavaScriptCore pdfium ffmpeg libmatroska libarchive ImageMagick BIND QEMU lcms Adobe Flash Oracle BerkeleyDB Android libstagefright iOS ImageIO FLAC audio library libsndfile less lesspipe strings file dpkg rcs systemd-resolved libyaml Info-Zip unzip libtasn1OpenBSD pfctl NetBSD bpf man mandocIDA Pro clamav</p>
    <p>libxml2glibc clang llvmnasm ctags mutt procmail fontconfig pdksh Qt wavpack OpenSSH redis lua-cmsgpack taglib privoxy perl libxmp radare2 SleuthKit fwknop X.Org exifprobe jhead capnproto Xerces-C metacam djvulibre exiv Linux btrfs Knot DNS curl</p>
    <p>wpa_supplicant Apple Safari libde265 dnsmasq libbpg lame libwmf uudecode MuPDF imlib2 libraw libbson libsass yara W3C tidyhtml5 VLC FreeBSD syscons John the Ripper screen tmux mosh UPX indent openjpeg MMIX OpenMPT rxvt dhcpcd Mozilla NSS Nettle mbed TLS Linux netlink Linux ext4 Linux xfs botan expat Adobe Reader libav libical OpenBSD kernel collectd libidn</p>
    <p>MatrixSSL jasperMaraDNS w3m Xen OpenH232 irssi cmark OpenCV Malheur gstreamer Tor gdk-pixbuf audiofilezstd lz4 stb cJSON libpcre MySQL gnulib openexr libmad ettercap lrzip freetds Asterisk ytnefraptor mpg123 exempi libgmime pev v8 sed awk make</p>
    <p>m4 yacc PHP ImageMagick freedesktop.org patch libtasn1 libvorbis zsh lua ninja ruby busybox gcrypt vim Tor poppler libopus BSD sh gcc qemu w3m zsh dropbear wireshark libtorrent git rust gravity e2fsprogs parrot lodepng json-glib cabextract libmspack qprint gpsbabel dmg2img antiword arj unrar unace zoo rzip lrzip libiso libtta duktape splint zpaq assimp cppcheck fasm catdoc pngcrush cmark p7zip libjbig2 aaphoto t1utils apngopt sqlparser mdp libtinyxml freexl bgpparser testdisk photorec btcd gumbo chaiscript teseq colcrt pttbbs capstone dex2oat pillow elftoolchain aribas universal-ctags uriparser jq lha xdelta gnuplot libwpd</p>
    <p>teseq cimg libiberty policycoreutils libsemanage renoise metapixel openclone mp3splt podofo Apache httpd glslang UEFITool libcbor lldpd pngquant muparserx mochilo pyhocon sysdig Overpass-API fish-shell gumbo-parser mapbox-gl-native rapidjson</p>
    <p>libjson FLIF MultiMarkdown astyle pax-utils zziplib PyPDF spiffing apk pgpdump icoutils msitools dosfstools</p>
    <p>Internet Explorer</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Motivation IJG jpeg libjpeg-turbo libpng libtiff mozjpeg PHP Mozilla Firefox Internet Explorer PCRE sqlite OpenSSL LibreOffice poppler freetype GnuTLS GnuPG PuTTY ntpd nginx bash tcpdump JavaScriptCore pdfium ffmpeg libmatroska libarchive ImageMagick BIND QEMU lcms Adobe Flash Oracle BerkeleyDB Android libstagefright iOS ImageIO FLAC audio library libsndfile less lesspipe strings file dpkg rcs systemd-resolved libyaml Info-Zip unzip libtasn1OpenBSD pfctl NetBSD bpf man mandocIDA Pro clamav</p>
    <p>libxml2glibc clang llvmnasm ctags mutt procmail fontconfig pdksh Qt wavpack OpenSSH redis lua-cmsgpack taglib privoxy perl libxmp radare2 SleuthKit fwknop X.Org exifprobe jhead capnproto Xerces-C metacam djvulibre exiv Linux btrfs Knot DNS curl</p>
    <p>wpa_supplicant Apple Safari libde265 dnsmasq libbpg lame libwmf uudecode MuPDF imlib2 libraw libbson libsass yara W3C tidyhtml5 VLC FreeBSD syscons John the Ripper screen tmux mosh UPX indent openjpeg MMIX OpenMPT rxvt dhcpcd Mozilla NSS Nettle mbed TLS Linux netlink Linux ext4 Linux xfs botan expat Adobe Reader libav libical OpenBSD kernel collectd libidn</p>
    <p>MatrixSSL jasperMaraDNS w3m Xen OpenH232 irssi cmark OpenCV Malheur gstreamer Tor gdk-pixbuf audiofilezstd lz4 stb cJSON libpcre MySQL gnulib openexr libmad ettercap lrzip freetds Asterisk ytnefraptor mpg123 exempi libgmime pev v8 sed awk make</p>
    <p>m4 yacc PHP ImageMagick freedesktop.org patch libtasn1 libvorbis zsh lua ninja ruby busybox gcrypt vim Tor poppler libopus BSD sh gcc qemu w3m zsh dropbear wireshark libtorrent git rust gravity e2fsprogs parrot lodepng json-glib cabextract libmspack qprint gpsbabel dmg2img antiword arj unrar unace zoo rzip lrzip libiso libtta duktape splint zpaq assimp cppcheck fasm catdoc pngcrush cmark p7zip libjbig2 aaphoto t1utils apngopt sqlparser mdp libtinyxml freexl bgpparser testdisk photorec btcd gumbo chaiscript teseq colcrt pttbbs capstone dex2oat pillow elftoolchain aribas universal-ctags uriparser jq lha xdelta gnuplot libwpd</p>
    <p>teseq cimg libiberty policycoreutils libsemanage renoise metapixel openclone mp3splt podofo Apache httpd glslang UEFITool libcbor lldpd pngquant muparserx mochilo pyhocon sysdig Overpass-API fish-shell gumbo-parser mapbox-gl-native rapidjson</p>
    <p>libjson FLIF MultiMarkdown astyle pax-utils zziplib PyPDF spiffing apk pgpdump icoutils msitools dosfstools</p>
    <p>Internet Explorer Adobe Flash</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Motivation IJG jpeg libjpeg-turbo libpng libtiff mozjpeg PHP Mozilla Firefox Internet Explorer PCRE sqlite OpenSSL LibreOffice poppler freetype GnuTLS GnuPG PuTTY ntpd nginx bash tcpdump JavaScriptCore pdfium ffmpeg libmatroska libarchive ImageMagick BIND QEMU lcms Adobe Flash Oracle BerkeleyDB Android libstagefright iOS ImageIO FLAC audio library libsndfile less lesspipe strings file dpkg rcs systemd-resolved libyaml Info-Zip unzip libtasn1OpenBSD pfctl NetBSD bpf man mandocIDA Pro clamav</p>
    <p>libxml2glibc clang llvmnasm ctags mutt procmail fontconfig pdksh Qt wavpack OpenSSH redis lua-cmsgpack taglib privoxy perl libxmp radare2 SleuthKit fwknop X.Org exifprobe jhead capnproto Xerces-C metacam djvulibre exiv Linux btrfs Knot DNS curl</p>
    <p>wpa_supplicant Apple Safari libde265 dnsmasq libbpg lame libwmf uudecode MuPDF imlib2 libraw libbson libsass yara W3C tidyhtml5 VLC FreeBSD syscons John the Ripper screen tmux mosh UPX indent openjpeg MMIX OpenMPT rxvt dhcpcd Mozilla NSS Nettle mbed TLS Linux netlink Linux ext4 Linux xfs botan expat Adobe Reader libav libical OpenBSD kernel collectd libidn</p>
    <p>MatrixSSL jasperMaraDNS w3m Xen OpenH232 irssi cmark OpenCV Malheur gstreamer Tor gdk-pixbuf audiofilezstd lz4 stb cJSON libpcre MySQL gnulib openexr libmad ettercap lrzip freetds Asterisk ytnefraptor mpg123 exempi libgmime pev v8 sed awk make</p>
    <p>m4 yacc PHP ImageMagick freedesktop.org patch libtasn1 libvorbis zsh lua ninja ruby busybox gcrypt vim Tor poppler libopus BSD sh gcc qemu w3m zsh dropbear wireshark libtorrent git rust gravity e2fsprogs parrot lodepng json-glib cabextract libmspack qprint gpsbabel dmg2img antiword arj unrar unace zoo rzip lrzip libiso libtta duktape splint zpaq assimp cppcheck fasm catdoc pngcrush cmark p7zip libjbig2 aaphoto t1utils apngopt sqlparser mdp libtinyxml freexl bgpparser testdisk photorec btcd gumbo chaiscript teseq colcrt pttbbs capstone dex2oat pillow elftoolchain aribas universal-ctags uriparser jq lha xdelta gnuplot libwpd</p>
    <p>teseq cimg libiberty policycoreutils libsemanage renoise metapixel openclone mp3splt podofo Apache httpd glslang UEFITool libcbor lldpd pngquant muparserx mochilo pyhocon sysdig Overpass-API fish-shell gumbo-parser mapbox-gl-native rapidjson</p>
    <p>libjson FLIF MultiMarkdown astyle pax-utils zziplib PyPDF spiffing apk pgpdump icoutils msitools dosfstools</p>
    <p>OpenSSH</p>
    <p>Internet Explorer Adobe Flash</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Motivation IJG jpeg libjpeg-turbo libpng libtiff mozjpeg PHP Mozilla Firefox Internet Explorer PCRE sqlite OpenSSL LibreOffice poppler freetype GnuTLS GnuPG PuTTY ntpd nginx bash tcpdump JavaScriptCore pdfium ffmpeg libmatroska libarchive ImageMagick BIND QEMU lcms Adobe Flash Oracle BerkeleyDB Android libstagefright iOS ImageIO FLAC audio library libsndfile less lesspipe strings file dpkg rcs systemd-resolved libyaml Info-Zip unzip libtasn1OpenBSD pfctl NetBSD bpf man mandocIDA Pro clamav</p>
    <p>libxml2glibc clang llvmnasm ctags mutt procmail fontconfig pdksh Qt wavpack OpenSSH redis lua-cmsgpack taglib privoxy perl libxmp radare2 SleuthKit fwknop X.Org exifprobe jhead capnproto Xerces-C metacam djvulibre exiv Linux btrfs Knot DNS curl</p>
    <p>wpa_supplicant Apple Safari libde265 dnsmasq libbpg lame libwmf uudecode MuPDF imlib2 libraw libbson libsass yara W3C tidyhtml5 VLC FreeBSD syscons John the Ripper screen tmux mosh UPX indent openjpeg MMIX OpenMPT rxvt dhcpcd Mozilla NSS Nettle mbed TLS Linux netlink Linux ext4 Linux xfs botan expat Adobe Reader libav libical OpenBSD kernel collectd libidn</p>
    <p>MatrixSSL jasperMaraDNS w3m Xen OpenH232 irssi cmark OpenCV Malheur gstreamer Tor gdk-pixbuf audiofilezstd lz4 stb cJSON libpcre MySQL gnulib openexr libmad ettercap lrzip freetds Asterisk ytnefraptor mpg123 exempi libgmime pev v8 sed awk make</p>
    <p>m4 yacc PHP ImageMagick freedesktop.org patch libtasn1 libvorbis zsh lua ninja ruby busybox gcrypt vim Tor poppler libopus BSD sh gcc qemu w3m zsh dropbear wireshark libtorrent git rust gravity e2fsprogs parrot lodepng json-glib cabextract libmspack qprint gpsbabel dmg2img antiword arj unrar unace zoo rzip lrzip libiso libtta duktape splint zpaq assimp cppcheck fasm catdoc pngcrush cmark p7zip libjbig2 aaphoto t1utils apngopt sqlparser mdp libtinyxml freexl bgpparser testdisk photorec btcd gumbo chaiscript teseq colcrt pttbbs capstone dex2oat pillow elftoolchain aribas universal-ctags uriparser jq lha xdelta gnuplot libwpd</p>
    <p>teseq cimg libiberty policycoreutils libsemanage renoise metapixel openclone mp3splt podofo Apache httpd glslang UEFITool libcbor lldpd pngquant muparserx mochilo pyhocon sysdig Overpass-API fish-shell gumbo-parser mapbox-gl-native rapidjson</p>
    <p>libjson FLIF MultiMarkdown astyle pax-utils zziplib PyPDF spiffing apk pgpdump icoutils msitools dosfstools</p>
    <p>OpenSSH</p>
    <p>Internet Explorer</p>
    <p>Apple Safari</p>
    <p>Adobe Flash</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Motivation IJG jpeg libjpeg-turbo libpng libtiff mozjpeg PHP Mozilla Firefox Internet Explorer PCRE sqlite OpenSSL LibreOffice poppler freetype GnuTLS GnuPG PuTTY ntpd nginx bash tcpdump JavaScriptCore pdfium ffmpeg libmatroska libarchive ImageMagick BIND QEMU lcms Adobe Flash Oracle BerkeleyDB Android libstagefright iOS ImageIO FLAC audio library libsndfile less lesspipe strings file dpkg rcs systemd-resolved libyaml Info-Zip unzip libtasn1OpenBSD pfctl NetBSD bpf man mandocIDA Pro clamav</p>
    <p>libxml2glibc clang llvmnasm ctags mutt procmail fontconfig pdksh Qt wavpack OpenSSH redis lua-cmsgpack taglib privoxy perl libxmp radare2 SleuthKit fwknop X.Org exifprobe jhead capnproto Xerces-C metacam djvulibre exiv Linux btrfs Knot DNS curl</p>
    <p>wpa_supplicant Apple Safari libde265 dnsmasq libbpg lame libwmf uudecode MuPDF imlib2 libraw libbson libsass yara W3C tidyhtml5 VLC FreeBSD syscons John the Ripper screen tmux mosh UPX indent openjpeg MMIX OpenMPT rxvt dhcpcd Mozilla NSS Nettle mbed TLS Linux netlink Linux ext4 Linux xfs botan expat Adobe Reader libav libical OpenBSD kernel collectd libidn</p>
    <p>MatrixSSL jasperMaraDNS w3m Xen OpenH232 irssi cmark OpenCV Malheur gstreamer Tor gdk-pixbuf audiofilezstd lz4 stb cJSON libpcre MySQL gnulib openexr libmad ettercap lrzip freetds Asterisk ytnefraptor mpg123 exempi libgmime pev v8 sed awk make</p>
    <p>m4 yacc PHP ImageMagick freedesktop.org patch libtasn1 libvorbis zsh lua ninja ruby busybox gcrypt vim Tor poppler libopus BSD sh gcc qemu w3m zsh dropbear wireshark libtorrent git rust gravity e2fsprogs parrot lodepng json-glib cabextract libmspack qprint gpsbabel dmg2img antiword arj unrar unace zoo rzip lrzip libiso libtta duktape splint zpaq assimp cppcheck fasm catdoc pngcrush cmark p7zip libjbig2 aaphoto t1utils apngopt sqlparser mdp libtinyxml freexl bgpparser testdisk photorec btcd gumbo chaiscript teseq colcrt pttbbs capstone dex2oat pillow elftoolchain aribas universal-ctags uriparser jq lha xdelta gnuplot libwpd</p>
    <p>teseq cimg libiberty policycoreutils libsemanage renoise metapixel openclone mp3splt podofo Apache httpd glslang UEFITool libcbor lldpd pngquant muparserx mochilo pyhocon sysdig Overpass-API fish-shell gumbo-parser mapbox-gl-native rapidjson</p>
    <p>libjson FLIF MultiMarkdown astyle pax-utils zziplib PyPDF spiffing apk pgpdump icoutils msitools dosfstools</p>
    <p>OpenSSH</p>
    <p>Internet Explorer</p>
    <p>Apple Safari Adobe Reader</p>
    <p>Adobe Flash</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Motivation IJG jpeg libjpeg-turbo libpng libtiff mozjpeg PHP Mozilla Firefox Internet Explorer PCRE sqlite OpenSSL LibreOffice poppler freetype GnuTLS GnuPG PuTTY ntpd nginx bash tcpdump JavaScriptCore pdfium ffmpeg libmatroska libarchive ImageMagick BIND QEMU lcms Adobe Flash Oracle BerkeleyDB Android libstagefright iOS ImageIO FLAC audio library libsndfile less lesspipe strings file dpkg rcs systemd-resolved libyaml Info-Zip unzip libtasn1OpenBSD pfctl NetBSD bpf man mandocIDA Pro clamav</p>
    <p>libxml2glibc clang llvmnasm ctags mutt procmail fontconfig pdksh Qt wavpack OpenSSH redis lua-cmsgpack taglib privoxy perl libxmp radare2 SleuthKit fwknop X.Org exifprobe jhead capnproto Xerces-C metacam djvulibre exiv Linux btrfs Knot DNS curl</p>
    <p>wpa_supplicant Apple Safari libde265 dnsmasq libbpg lame libwmf uudecode MuPDF imlib2 libraw libbson libsass yara W3C tidyhtml5 VLC FreeBSD syscons John the Ripper screen tmux mosh UPX indent openjpeg MMIX OpenMPT rxvt dhcpcd Mozilla NSS Nettle mbed TLS Linux netlink Linux ext4 Linux xfs botan expat Adobe Reader libav libical OpenBSD kernel collectd libidn</p>
    <p>MatrixSSL jasperMaraDNS w3m Xen OpenH232 irssi cmark OpenCV Malheur gstreamer Tor gdk-pixbuf audiofilezstd lz4 stb cJSON libpcre MySQL gnulib openexr libmad ettercap lrzip freetds Asterisk ytnefraptor mpg123 exempi libgmime pev v8 sed awk make</p>
    <p>m4 yacc PHP ImageMagick freedesktop.org patch libtasn1 libvorbis zsh lua ninja ruby busybox gcrypt vim Tor poppler libopus BSD sh gcc qemu w3m zsh dropbear wireshark libtorrent git rust gravity e2fsprogs parrot lodepng json-glib cabextract libmspack qprint gpsbabel dmg2img antiword arj unrar unace zoo rzip lrzip libiso libtta duktape splint zpaq assimp cppcheck fasm catdoc pngcrush cmark p7zip libjbig2 aaphoto t1utils apngopt sqlparser mdp libtinyxml freexl bgpparser testdisk photorec btcd gumbo chaiscript teseq colcrt pttbbs capstone dex2oat pillow elftoolchain aribas universal-ctags uriparser jq lha xdelta gnuplot libwpd</p>
    <p>teseq cimg libiberty policycoreutils libsemanage renoise metapixel openclone mp3splt podofo Apache httpd glslang UEFITool libcbor lldpd pngquant muparserx mochilo pyhocon sysdig Overpass-API fish-shell gumbo-parser mapbox-gl-native rapidjson</p>
    <p>libjson FLIF MultiMarkdown astyle pax-utils zziplib PyPDF spiffing apk pgpdump icoutils msitools dosfstools</p>
    <p>OpenSSH</p>
    <p>Internet Explorer</p>
    <p>Apple Safari Adobe Reader</p>
    <p>Wireshark</p>
    <p>Adobe Flash</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Motivation IJG jpeg libjpeg-turbo libpng libtiff mozjpeg PHP Mozilla Firefox Internet Explorer PCRE sqlite OpenSSL LibreOffice poppler freetype GnuTLS GnuPG PuTTY ntpd nginx bash tcpdump JavaScriptCore pdfium ffmpeg libmatroska libarchive ImageMagick BIND QEMU lcms Adobe Flash Oracle BerkeleyDB Android libstagefright iOS ImageIO FLAC audio library libsndfile less lesspipe strings file dpkg rcs systemd-resolved libyaml Info-Zip unzip libtasn1OpenBSD pfctl NetBSD bpf man mandocIDA Pro clamav</p>
    <p>libxml2glibc clang llvmnasm ctags mutt procmail fontconfig pdksh Qt wavpack OpenSSH redis lua-cmsgpack taglib privoxy perl libxmp radare2 SleuthKit fwknop X.Org exifprobe jhead capnproto Xerces-C metacam djvulibre exiv Linux btrfs Knot DNS curl</p>
    <p>wpa_supplicant Apple Safari libde265 dnsmasq libbpg lame libwmf uudecode MuPDF imlib2 libraw libbson libsass yara W3C tidyhtml5 VLC FreeBSD syscons John the Ripper screen tmux mosh UPX indent openjpeg MMIX OpenMPT rxvt dhcpcd Mozilla NSS Nettle mbed TLS Linux netlink Linux ext4 Linux xfs botan expat Adobe Reader libav libical OpenBSD kernel collectd libidn</p>
    <p>MatrixSSL jasperMaraDNS w3m Xen OpenH232 irssi cmark OpenCV Malheur gstreamer Tor gdk-pixbuf audiofilezstd lz4 stb cJSON libpcre MySQL gnulib openexr libmad ettercap lrzip freetds Asterisk ytnefraptor mpg123 exempi libgmime pev v8 sed awk make</p>
    <p>m4 yacc PHP ImageMagick freedesktop.org patch libtasn1 libvorbis zsh lua ninja ruby busybox gcrypt vim Tor poppler libopus BSD sh gcc qemu w3m zsh dropbear wireshark libtorrent git rust gravity e2fsprogs parrot lodepng json-glib cabextract libmspack qprint gpsbabel dmg2img antiword arj unrar unace zoo rzip lrzip libiso libtta duktape splint zpaq assimp cppcheck fasm catdoc pngcrush cmark p7zip libjbig2 aaphoto t1utils apngopt sqlparser mdp libtinyxml freexl bgpparser testdisk photorec btcd gumbo chaiscript teseq colcrt pttbbs capstone dex2oat pillow elftoolchain aribas universal-ctags uriparser jq lha xdelta gnuplot libwpd</p>
    <p>teseq cimg libiberty policycoreutils libsemanage renoise metapixel openclone mp3splt podofo Apache httpd glslang UEFITool libcbor lldpd pngquant muparserx mochilo pyhocon sysdig Overpass-API fish-shell gumbo-parser mapbox-gl-native rapidjson</p>
    <p>libjson FLIF MultiMarkdown astyle pax-utils zziplib PyPDF spiffing apk pgpdump icoutils msitools dosfstools</p>
    <p>OpenSSH</p>
    <p>Internet Explorer</p>
    <p>Apple Safari Adobe Reader</p>
    <p>Wireshark</p>
    <p>Apache httpd</p>
    <p>Adobe Flash</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Stephens, Nick, et al. &quot;Driller: Augmenting Fuzzing Through Selective Symbolic Execution.&quot; Proceedings of the Network and Distributed System Security Symposium (NDSS). 2016.</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
    <p>Rawat, Sanjay, et al. &quot;Vuzzer: Application-aware evolutionary fuzzing. Proceedings of the Network and Distributed System Security Symposium (NDSS). 2017.</p>
    <p>Bhme, Marcel, et al. &quot;Coverage-based greybox fuzzing as markov chain.&quot; Proceedings of the 2016 ACM SIGSAC Conference on Computer and Communications Security. ACM. 2016.</p>
    <p>Motivation</p>
  </div>
  <div class="page">
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels4</p>
    <p>Motivation</p>
    <p>What about Kernel Security?</p>
  </div>
  <div class="page">
    <p>Related Work</p>
    <p>Fast Crash Tolerant OS Independent Binary Only</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Related Work</p>
    <p>Fast Crash Tolerant OS Independent Binary Only</p>
    <p>TriforceAFL (Jesse Hertz &amp; Tim Newsham, NCC Group)</p>
    <p>~</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Related Work</p>
    <p>Fast Crash Tolerant OS Independent Binary Only</p>
    <p>TriforceAFL (Jesse Hertz &amp; Tim Newsham, NCC Group)</p>
    <p>~</p>
    <p>Syzkaller (Dmitry Vyukov)</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Related Work</p>
    <p>Fast Crash Tolerant OS Independent Binary Only</p>
    <p>TriforceAFL (Jesse Hertz &amp; Tim Newsham, NCC Group)</p>
    <p>~</p>
    <p>Syzkaller (Dmitry Vyukov)     AFL Filesystem Fuzzer (Vegard Nossum &amp; Quentin Casanovas, Oracle)</p>
    <p>~</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Related Work</p>
    <p>Fast Crash Tolerant OS Independent Binary Only</p>
    <p>TriforceAFL (Jesse Hertz &amp; Tim Newsham, NCC Group)</p>
    <p>~</p>
    <p>Syzkaller (Dmitry Vyukov)     AFL Filesystem Fuzzer (Vegard Nossum &amp; Quentin Casanovas, Oracle)</p>
    <p>~   PT Kernel Fuzzer (Richard Johnson, Talos)</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Goal</p>
    <p>Build a kernel fuzzer that is all of this:</p>
    <p>Fast Reliable (mostly) OS independent No source level access required</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Fuzzing in a nutshell</p>
  </div>
  <div class="page">
    <p>Fuzzing in a nutshell</p>
    <p>Fuzzer Target</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Fuzzing in a nutshell</p>
    <p>Fuzzer Target</p>
    <p>Inputs</p>
    <p>Grammar</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Fuzzing in a nutshell</p>
    <p>Fuzzer Target</p>
    <p>Inputs</p>
    <p>Grammar</p>
    <p>Randomized Inputs</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Fuzzing in a nutshell</p>
    <p>Fuzzer Target</p>
    <p>Inputs</p>
    <p>Grammar</p>
    <p>Randomized Inputs</p>
    <p>Feedback</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Blackbox Fuzzing</p>
    <p>Target</p>
    <p>exit</p>
    <p>&quot;EFG&quot;</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Blackbox Fuzzing</p>
    <p>Target</p>
    <p>exit</p>
    <p>&quot;TZG&quot;</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Blackbox Fuzzing</p>
    <p>Target</p>
    <p>&quot;ABC&quot;</p>
    <p>Crash kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Coverage-Guided Fuzzing</p>
  </div>
  <div class="page">
    <p>Coverage-Guided Fuzzing</p>
    <p>input[0] == 'A'</p>
    <p>input[2] == 'C'</p>
    <p>exit()</p>
    <p>input[1] == 'B'</p>
    <p>crash()</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Coverage-Guided Fuzzing</p>
    <p>input[0] == 'A'</p>
    <p>input[2] == 'C'</p>
    <p>exit()</p>
    <p>input[1] == 'B'</p>
    <p>crash() exit()</p>
    <p>input[0] == 'A' ZZZZ</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Coverage-Guided Fuzzing</p>
    <p>input[0] == 'A'</p>
    <p>input[2] == 'C'</p>
    <p>exit()</p>
    <p>input[1] == 'B'</p>
    <p>crash() exit()</p>
    <p>input[1] == 'B'</p>
    <p>input[0] == 'A'AAAA</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Coverage-Guided Fuzzing</p>
    <p>input[0] == 'A'</p>
    <p>input[2] == 'C'</p>
    <p>exit()</p>
    <p>input[1] == 'B'</p>
    <p>crash() exit()</p>
    <p>input[2] == 'C'</p>
    <p>input[1] == 'B'</p>
    <p>input[0] == 'A'ABBG</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Coverage-Guided Fuzzing</p>
    <p>input[0] == 'A'</p>
    <p>input[2] == 'C'</p>
    <p>exit()</p>
    <p>input[1] == 'B'</p>
    <p>crash()crash()</p>
    <p>input[2] == 'C'</p>
    <p>input[1] == 'B'</p>
    <p>input[0] == 'A'ABCJ</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Coverage-Guided Fuzzing</p>
    <p>input[0] == 'A'</p>
    <p>input[2] == 'C'</p>
    <p>exit()</p>
    <p>input[1] == 'B'</p>
    <p>crash()</p>
    <p>AFL stores transitions in a bitmap</p>
    <p>crash()</p>
    <p>input[2] == 'C'</p>
    <p>input[1] == 'B'</p>
    <p>input[0] == 'A'ABCJ</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Feedback Mechanism Closed-Source Kernel Stable Fast</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Feedback Mechanism Closed-Source Kernel Stable Fast</p>
    <p>Compile-Time Instrumentation    ++</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Feedback Mechanism Closed-Source Kernel Stable Fast</p>
    <p>Compile-Time Instrumentation    ++ Static Rewriting  -  ++</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Feedback Mechanism Closed-Source Kernel Stable Fast</p>
    <p>Compile-Time Instrumentation    ++ Static Rewriting  -  ++ Dynamic Binary Instrumentation  -*</p>
    <p>* Peter Feiner, et al., DRK: DynamoRIO as a Linux Kernel Module</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Feedback Mechanism Closed-Source Kernel Stable Fast</p>
    <p>Compile-Time Instrumentation    ++ Static Rewriting  -  ++ Dynamic Binary Instrumentation  -*  Emulation    -</p>
    <p>* Peter Feiner, et al., DRK: DynamoRIO as a Linux Kernel Module</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Feedback Mechanism Closed-Source Kernel Stable Fast</p>
    <p>Compile-Time Instrumentation    ++ Static Rewriting  -  ++ Dynamic Binary Instrumentation  -*  Emulation    - Intel Branch Trace Store    +</p>
    <p>* Peter Feiner, et al., DRK: DynamoRIO as a Linux Kernel Module</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Feedback Mechanism Closed-Source Kernel Stable Fast</p>
    <p>Compile-Time Instrumentation    ++ Static Rewriting  -  ++ Dynamic Binary Instrumentation  -*  Emulation    - Intel Branch Trace Store    + Intel Processor Trace    +++</p>
    <p>* Peter Feiner, et al., DRK: DynamoRIO as a Linux Kernel Module</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Intel Processor Trace</p>
  </div>
  <div class="page">
    <p>Intel Processor Trace</p>
    <p>Instruction Intel PT Packet</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Intel Processor Trace</p>
    <p>Instruction Intel PT Packet</p>
    <p>jmp/call loc_b Inferable from disassembly</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Intel Processor Trace</p>
    <p>Instruction Intel PT Packet</p>
    <p>jmp/call loc_b Inferable from disassembly</p>
    <p>jnz loc_a Taken / Not Taken</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Intel Processor Trace</p>
    <p>Instruction Intel PT Packet</p>
    <p>jmp/call loc_b Inferable from disassembly</p>
    <p>jnz loc_a Taken / Not Taken</p>
    <p>jmp/call [eax] Target IP</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Intel Processor Trace</p>
    <p>Instruction Intel PT Packet</p>
    <p>jmp/call loc_b Inferable from disassembly</p>
    <p>jnz loc_a Taken / Not Taken</p>
    <p>jmp/call [eax] Target IP</p>
    <p>ret Target IP (if required)</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Intel Processor Trace</p>
    <p>Intel PT Data</p>
    <p>Not Taken Target IP (0x1009) Target IP (0x1055)</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Intel Processor Trace</p>
    <p>Intel PT Data</p>
    <p>Not Taken Target IP (0x1009) Target IP (0x1055)</p>
    <p>Target Binary</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Intel Processor Trace</p>
    <p>Intel PT Data</p>
    <p>Not Taken Target IP (0x1009) Target IP (0x1055)</p>
    <p>Target Binary</p>
    <p>Traces</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Intel Processor Trace</p>
    <p>Intel PT Data</p>
    <p>Not Taken Target IP (0x1009) Target IP (0x1055)</p>
    <p>Target Binary</p>
    <p>Traces</p>
    <p>Transitions</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Intel Processor Trace</p>
    <p>Intel PT Data</p>
    <p>Not Taken Target IP (0x1009) Target IP (0x1055)</p>
    <p>Target Binary</p>
    <p>Traces</p>
    <p>Transitions</p>
    <p>AFL Bitmap</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Architecture</p>
  </div>
  <div class="page">
    <p>Architecture</p>
    <p>Kernel</p>
    <p>AgentFuzzer</p>
    <p>Host</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Architecture</p>
    <p>Kernel</p>
    <p>AgentFuzzer</p>
    <p>Intel PT Driver</p>
    <p>coverage</p>
    <p>Benefits: Coverage</p>
    <p>Host</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Architecture</p>
    <p>Kernel</p>
    <p>AgentFuzzer</p>
    <p>Intel PT Driver</p>
    <p>coverage</p>
    <p>Benefits: Coverage</p>
    <p>Host</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Architecture</p>
    <p>Kernel</p>
    <p>AgentFuzzer</p>
    <p>Intel PT Driver</p>
    <p>coverage</p>
    <p>Benefits: Coverage</p>
    <p>Host</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Architecture</p>
    <p>Virtual Machine</p>
    <p>Kernel</p>
    <p>AgentFuzzer</p>
    <p>Intel PT Driver</p>
    <p>coverage</p>
    <p>Benefits: Coverage Crash Tolerance</p>
    <p>Host</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Architecture</p>
    <p>Virtual Machine</p>
    <p>Kernel</p>
    <p>AgentFuzzer</p>
    <p>Intel PT Driver</p>
    <p>coverage</p>
    <p>Benefits: Coverage Crash Tolerance OS Independence</p>
    <p>Host</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Architecture</p>
    <p>Virtual Machine</p>
    <p>Kernel</p>
    <p>AgentFuzzer</p>
    <p>Intel PT Driver</p>
    <p>coverage</p>
    <p>Benefits: Coverage Crash Tolerance OS Independence Scalable</p>
    <p>Host</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Trace Filtering</p>
    <p>Virtual Machine</p>
    <p>Kernel</p>
    <p>AgentFuzzer</p>
    <p>Intel PT Driver</p>
    <p>coverage</p>
    <p>Host</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Trace Filtering</p>
    <p>Virtual Machine</p>
    <p>Kernel</p>
    <p>AgentFuzzer</p>
    <p>Intel PT Driver</p>
    <p>coverage</p>
    <p>Host</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
    <p>Full System Tracing</p>
  </div>
  <div class="page">
    <p>Trace Filtering</p>
    <p>Virtual Machine</p>
    <p>Kernel</p>
    <p>AgentFuzzer</p>
    <p>Intel PT Driver</p>
    <p>coverage</p>
    <p>Intel PT aware Hypervisor</p>
    <p>Host</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
    <p>vCPU Filter-Mechanisms:</p>
    <p>vCPU Tracing</p>
  </div>
  <div class="page">
    <p>Trace Filtering</p>
    <p>Virtual Machine</p>
    <p>Kernel</p>
    <p>AgentFuzzer</p>
    <p>Intel PT Driver</p>
    <p>coverage</p>
    <p>Intel PT aware Hypervisor</p>
    <p>Host</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
    <p>vCPU Supervisor</p>
    <p>Filter-Mechanisms:</p>
    <p>Guest Ring-0 Tracing</p>
  </div>
  <div class="page">
    <p>Trace Filtering</p>
    <p>Virtual Machine</p>
    <p>Kernel</p>
    <p>AgentFuzzer</p>
    <p>Intel PT Driver</p>
    <p>coverage</p>
    <p>Intel PT aware Hypervisor</p>
    <p>Host</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
    <p>vCPU Supervisor</p>
    <p>Filter-Mechanisms:</p>
    <p>Guest Ring-0 Tracing</p>
    <p>Kernel Space</p>
    <p>User Space</p>
    <p>syscall</p>
  </div>
  <div class="page">
    <p>Trace Filtering</p>
    <p>Virtual Machine</p>
    <p>Kernel</p>
    <p>AgentFuzzer</p>
    <p>Intel PT Driver</p>
    <p>coverage</p>
    <p>Intel PT aware Hypervisor</p>
    <p>Host</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
    <p>vCPU Supervisor CR3</p>
    <p>Filter-Mechanisms:</p>
    <p>Guest Ring-0 Tracing (Fuzzing-Process)</p>
  </div>
  <div class="page">
    <p>Trace Filtering</p>
    <p>Virtual Machine</p>
    <p>Kernel</p>
    <p>AgentFuzzer</p>
    <p>Intel PT Driver</p>
    <p>coverage</p>
    <p>Intel PT aware Hypervisor</p>
    <p>Host</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
    <p>vCPU Supervisor CR3 IP-Range</p>
    <p>Filter-Mechanisms:</p>
    <p>Guest Ring-0 Tracing (Fuzzing-Process &amp; Target Range)</p>
  </div>
  <div class="page">
    <p>Inter-VM Communication</p>
    <p>Virtual Machine</p>
    <p>Intel PT Driver</p>
    <p>coverage</p>
    <p>Host</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
    <p>Kernel</p>
    <p>AgentFuzzer</p>
    <p>Intel PT aware Hypervisor</p>
  </div>
  <div class="page">
    <p>Inter-VM Communication</p>
    <p>Virtual Machine</p>
    <p>Intel PT Driver</p>
    <p>coverage</p>
    <p>Host</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
    <p>Kernel</p>
    <p>AgentFuzzer</p>
    <p>Intel PT aware Hypervisor</p>
  </div>
  <div class="page">
    <p>Inter-VM Communication</p>
    <p>Virtual Machine</p>
    <p>Intel PT Driver</p>
    <p>coverage</p>
    <p>Host</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
    <p>Guest to Host:</p>
    <p>Kernel</p>
    <p>AgentFuzzer</p>
    <p>Intel PT aware Hypervisor</p>
  </div>
  <div class="page">
    <p>Inter-VM Communication</p>
    <p>Virtual Machine</p>
    <p>Intel PT Driver</p>
    <p>coverage</p>
    <p>Host</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
    <p>Guest to Host: Synchronization</p>
    <p>Kernel</p>
    <p>AgentFuzzer</p>
    <p>Intel PT aware Hypervisor</p>
  </div>
  <div class="page">
    <p>Inter-VM Communication</p>
    <p>Virtual Machine</p>
    <p>Intel PT Driver</p>
    <p>coverage</p>
    <p>Host</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
    <p>Guest to Host: Synchronization Next payload</p>
    <p>Kernel</p>
    <p>AgentFuzzer</p>
    <p>Intel PT aware Hypervisor</p>
  </div>
  <div class="page">
    <p>Inter-VM Communication</p>
    <p>Virtual Machine</p>
    <p>Intel PT Driver</p>
    <p>coverage</p>
    <p>Host</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
    <p>Guest to Host: Synchronization Next payload Disclose CR3 value</p>
    <p>Kernel</p>
    <p>AgentFuzzer</p>
    <p>Intel PT aware Hypervisor</p>
  </div>
  <div class="page">
    <p>Inter-VM Communication</p>
    <p>Virtual Machine</p>
    <p>Intel PT Driver</p>
    <p>coverage</p>
    <p>Host</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
    <p>Guest to Host: Synchronization Next payload Disclose CR3 value Panic handler address Kernel</p>
    <p>AgentFuzzer</p>
    <p>Intel PT aware Hypervisor</p>
  </div>
  <div class="page">
    <p>Inter-VM Communication</p>
    <p>Virtual Machine</p>
    <p>Intel PT Driver</p>
    <p>coverage</p>
    <p>Host</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
    <p>Guest to Host: Synchronization Next payload Disclose CR3 value Panic handler address Signal kernel panic</p>
    <p>Kernel</p>
    <p>AgentFuzzer</p>
    <p>Intel PT aware Hypervisor</p>
  </div>
  <div class="page">
    <p>Inter-VM Communication</p>
    <p>Virtual Machine</p>
    <p>Intel PT Driver</p>
    <p>coverage</p>
    <p>Host</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
    <p>Guest to Host: Synchronization Next payload Disclose CR3 value Panic handler address Signal kernel panic</p>
    <p>Host to Guest:</p>
    <p>Kernel</p>
    <p>AgentFuzzer</p>
    <p>Intel PT aware Hypervisor</p>
  </div>
  <div class="page">
    <p>Inter-VM Communication</p>
    <p>Virtual Machine</p>
    <p>Intel PT Driver</p>
    <p>coverage</p>
    <p>Host</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
    <p>Guest to Host: Synchronization Next payload Disclose CR3 value Panic handler address Signal kernel panic</p>
    <p>Host to Guest: Agent</p>
    <p>Kernel</p>
    <p>AgentFuzzer</p>
    <p>Intel PT aware Hypervisor</p>
  </div>
  <div class="page">
    <p>Inter-VM Communication</p>
    <p>Virtual Machine</p>
    <p>Intel PT Driver</p>
    <p>coverage</p>
    <p>Host</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
    <p>Guest to Host: Synchronization Next payload Disclose CR3 value Panic handler address Signal kernel panic</p>
    <p>Host to Guest: Agent Payloads</p>
    <p>Kernel</p>
    <p>AgentFuzzer</p>
    <p>Intel PT aware Hypervisor</p>
  </div>
  <div class="page">
    <p>Inter-VM Communication</p>
    <p>Virtual Machine</p>
    <p>Intel PT Driver</p>
    <p>coverage</p>
    <p>Host</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
    <p>Guest to Host: Synchronization Next payload Disclose CR3 value Panic handler address Signal kernel panic</p>
    <p>Host to Guest: Agent Payloads Overwrite panic handler</p>
    <p>Kernel</p>
    <p>AgentFuzzer</p>
    <p>Intel PT aware Hypervisor</p>
  </div>
  <div class="page">
    <p>Implementation</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Implementation</p>
    <p>CPU: generates raw Intel-PT data writes data to main memory</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Implementation</p>
    <p>KVM-PT: configures Intel PT via MSRs enables tracing during VM-Entry transition disables tracing during VM-Exit transition</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Implementation</p>
    <p>QEMU-PT: usermode counterpart decodes Intel PT data on-the-fly</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Implementation</p>
    <p>kAFL Fuzzer: generates new fuzz payloads detects new behavior</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Evaluation</p>
  </div>
  <div class="page">
    <p>New Vulnerabilities Windows: NTFS (DoS)</p>
    <p>macOS: HFS (DoS, Memory Corruption) APFS (Memory Corruption)</p>
    <p>Linux: EXT4 (DoS, Memory Corruption) Keyctl (Nullpointer Dereference)</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Evaluation Driver</p>
    <p>Linux: keyctl Null Pointer Dereference5 (CVE2016-86506)</p>
    <p>Linux: ext4 Memory Corruption7</p>
    <p>Linux: ext4 Error Handling8</p>
    <p>Windows: NTFS Div-by-Zero9</p>
    <p>macOS: HFS Div-by-Zero10</p>
    <p>macOS: HFS Assertion Fail10</p>
    <p>macOS: HFS Use-After-Free10</p>
    <p>macOS: APFS Memory Corruption10</p>
    <p>Red Hat has assigned a CVE number for the first reported security flaw, which triggers a null pointer deference and a partial memory corruption in the kernel ASN.1 parser if an RSA certificate with a zero exponent is presented. For the second reported vulnerability, which triggers a memory corruption in the ext4 file</p>
    <p>system, a mainline patch was proposed. The last reported Linux vulnerability, which calls in the ext4 error handling routine panic() and hence results in a kernel panic, was at the time of writing not investigated any further. The NTFS bug in Windows 10 is a non-recoverable error condition which leads to a blue screen. This bug was reported to Microsoft, but has not been confirmed yet. Similarly, Apple has not yet verified or confirmed our reported macOS bugs.</p>
    <p>start; 9 int s = tokens [0]. start;</p>
    <p>Listing 2: The JSON parser kernel module used for the coverage benchmarks.</p>
    <p>We performed five repeated experiments for each operating system. Additionally we tested TriforceAFL with the Linux target driver. TriforceAFL is unable to fuzz Windows and macOS. To compare TriforceAFL with kAFL, the associated TriforceLinuxSyscallFuzzer was slightly modified to work with our vulnerable Linux kernel module. Unfortunately, it was not possible to compare kAFL against Oracles file system fuzzer [34] due to technical issues with its setup.</p>
    <p>During each run, we fuzzed the JSON parser for 30 minutes. The averaged and rounded results are displayed in Table 1. As we can see, the performance of kAFL is very similar across different systems. It should be remarked that the variance in this experiment is rather high</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Evaluation Driver</p>
    <p>Linux: keyctl Null Pointer Dereference5 (CVE2016-86506)</p>
    <p>Linux: ext4 Memory Corruption7</p>
    <p>Linux: ext4 Error Handling8</p>
    <p>Windows: NTFS Div-by-Zero9</p>
    <p>macOS: HFS Div-by-Zero10</p>
    <p>macOS: HFS Assertion Fail10</p>
    <p>macOS: HFS Use-After-Free10</p>
    <p>macOS: APFS Memory Corruption10</p>
    <p>Red Hat has assigned a CVE number for the first reported security flaw, which triggers a null pointer deference and a partial memory corruption in the kernel ASN.1 parser if an RSA certificate with a zero exponent is presented. For the second reported vulnerability, which triggers a memory corruption in the ext4 file</p>
    <p>system, a mainline patch was proposed. The last reported Linux vulnerability, which calls in the ext4 error handling routine panic() and hence results in a kernel panic, was at the time of writing not investigated any further. The NTFS bug in Windows 10 is a non-recoverable error condition which leads to a blue screen. This bug was reported to Microsoft, but has not been confirmed yet. Similarly, Apple has not yet verified or confirmed our reported macOS bugs.</p>
    <p>start; 9 int s = tokens [0]. start;</p>
    <p>Listing 2: The JSON parser kernel module used for the coverage benchmarks.</p>
    <p>We performed five repeated experiments for each operating system. Additionally we tested TriforceAFL with the Linux target driver. TriforceAFL is unable to fuzz Windows and macOS. To compare TriforceAFL with kAFL, the associated TriforceLinuxSyscallFuzzer was slightly modified to work with our vulnerable Linux kernel module. Unfortunately, it was not possible to compare kAFL against Oracles file system fuzzer [34] due to technical issues with its setup.</p>
    <p>During each run, we fuzzed the JSON parser for 30 minutes. The averaged and rounded results are displayed in Table 1. As we can see, the performance of kAFL is very similar across different systems. It should be remarked that the variance in this experiment is rather high</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Evaluation Driver</p>
    <p>Linux: keyctl Null Pointer Dereference5 (CVE2016-86506)</p>
    <p>Linux: ext4 Memory Corruption7</p>
    <p>Linux: ext4 Error Handling8</p>
    <p>Windows: NTFS Div-by-Zero9</p>
    <p>macOS: HFS Div-by-Zero10</p>
    <p>macOS: HFS Assertion Fail10</p>
    <p>macOS: HFS Use-After-Free10</p>
    <p>macOS: APFS Memory Corruption10</p>
    <p>Red Hat has assigned a CVE number for the first reported security flaw, which triggers a null pointer deference and a partial memory corruption in the kernel ASN.1 parser if an RSA certificate with a zero exponent is presented. For the second reported vulnerability, which triggers a memory corruption in the ext4 file</p>
    <p>system, a mainline patch was proposed. The last reported Linux vulnerability, which calls in the ext4 error handling routine panic() and hence results in a kernel panic, was at the time of writing not investigated any further. The NTFS bug in Windows 10 is a non-recoverable error condition which leads to a blue screen. This bug was reported to Microsoft, but has not been confirmed yet. Similarly, Apple has not yet verified or confirmed our reported macOS bugs.</p>
    <p>start; 9 int s = tokens [0]. start;</p>
    <p>Listing 2: The JSON parser kernel module used for the coverage benchmarks.</p>
    <p>We performed five repeated experiments for each operating system. Additionally we tested TriforceAFL with the Linux target driver. TriforceAFL is unable to fuzz Windows and macOS. To compare TriforceAFL with kAFL, the associated TriforceLinuxSyscallFuzzer was slightly modified to work with our vulnerable Linux kernel module. Unfortunately, it was not possible to compare kAFL against Oracles file system fuzzer [34] due to technical issues with its setup.</p>
    <p>During each run, we fuzzed the JSON parser for 30 minutes. The averaged and rounded results are displayed in Table 1. As we can see, the performance of kAFL is very similar across different systems. It should be remarked that the variance in this experiment is rather high</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Evaluation Driver</p>
    <p>Linux: keyctl Null Pointer Dereference5 (CVE2016-86506)</p>
    <p>Linux: ext4 Memory Corruption7</p>
    <p>Linux: ext4 Error Handling8</p>
    <p>Windows: NTFS Div-by-Zero9</p>
    <p>macOS: HFS Div-by-Zero10</p>
    <p>macOS: HFS Assertion Fail10</p>
    <p>macOS: HFS Use-After-Free10</p>
    <p>macOS: APFS Memory Corruption10</p>
    <p>Red Hat has assigned a CVE number for the first reported security flaw, which triggers a null pointer deference and a partial memory corruption in the kernel ASN.1 parser if an RSA certificate with a zero exponent is presented. For the second reported vulnerability, which triggers a memory corruption in the ext4 file</p>
    <p>system, a mainline patch was proposed. The last reported Linux vulnerability, which calls in the ext4 error handling routine panic() and hence results in a kernel panic, was at the time of writing not investigated any further. The NTFS bug in Windows 10 is a non-recoverable error condition which leads to a blue screen. This bug was reported to Microsoft, but has not been confirmed yet. Similarly, Apple has not yet verified or confirmed our reported macOS bugs.</p>
    <p>start; 9 int s = tokens [0]. start;</p>
    <p>Listing 2: The JSON parser kernel module used for the coverage benchmarks.</p>
    <p>We performed five repeated experiments for each operating system. Additionally we tested TriforceAFL with the Linux target driver. TriforceAFL is unable to fuzz Windows and macOS. To compare TriforceAFL with kAFL, the associated TriforceLinuxSyscallFuzzer was slightly modified to work with our vulnerable Linux kernel module. Unfortunately, it was not possible to compare kAFL against Oracles file system fuzzer [34] due to technical issues with its setup.</p>
    <p>During each run, we fuzzed the JSON parser for 30 minutes. The averaged and rounded results are displayed in Table 1. As we can see, the performance of kAFL is very similar across different systems. It should be remarked that the variance in this experiment is rather high</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Evaluation Driver</p>
    <p>Linux: keyctl Null Pointer Dereference5 (CVE2016-86506)</p>
    <p>Linux: ext4 Memory Corruption7</p>
    <p>Linux: ext4 Error Handling8</p>
    <p>Windows: NTFS Div-by-Zero9</p>
    <p>macOS: HFS Div-by-Zero10</p>
    <p>macOS: HFS Assertion Fail10</p>
    <p>macOS: HFS Use-After-Free10</p>
    <p>macOS: APFS Memory Corruption10</p>
    <p>Red Hat has assigned a CVE number for the first reported security flaw, which triggers a null pointer deference and a partial memory corruption in the kernel ASN.1 parser if an RSA certificate with a zero exponent is presented. For the second reported vulnerability, which triggers a memory corruption in the ext4 file</p>
    <p>system, a mainline patch was proposed. The last reported Linux vulnerability, which calls in the ext4 error handling routine panic() and hence results in a kernel panic, was at the time of writing not investigated any further. The NTFS bug in Windows 10 is a non-recoverable error condition which leads to a blue screen. This bug was reported to Microsoft, but has not been confirmed yet. Similarly, Apple has not yet verified or confirmed our reported macOS bugs.</p>
    <p>start; 9 int s = tokens [0]. start;</p>
    <p>Listing 2: The JSON parser kernel module used for the coverage benchmarks.</p>
    <p>We performed five repeated experiments for each operating system. Additionally we tested TriforceAFL with the Linux target driver. TriforceAFL is unable to fuzz Windows and macOS. To compare TriforceAFL with kAFL, the associated TriforceLinuxSyscallFuzzer was slightly modified to work with our vulnerable Linux kernel module. Unfortunately, it was not possible to compare kAFL against Oracles file system fuzzer [34] due to technical issues with its setup.</p>
    <p>During each run, we fuzzed the JSON parser for 30 minutes. The averaged and rounded results are displayed in Table 1. As we can see, the performance of kAFL is very similar across different systems. It should be remarked that the variance in this experiment is rather high</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Evaluation Driver</p>
    <p>Linux: keyctl Null Pointer Dereference5 (CVE2016-86506)</p>
    <p>Linux: ext4 Memory Corruption7</p>
    <p>Linux: ext4 Error Handling8</p>
    <p>Windows: NTFS Div-by-Zero9</p>
    <p>macOS: HFS Div-by-Zero10</p>
    <p>macOS: HFS Assertion Fail10</p>
    <p>macOS: HFS Use-After-Free10</p>
    <p>macOS: APFS Memory Corruption10</p>
    <p>Red Hat has assigned a CVE number for the first reported security flaw, which triggers a null pointer deference and a partial memory corruption in the kernel ASN.1 parser if an RSA certificate with a zero exponent is presented. For the second reported vulnerability, which triggers a memory corruption in the ext4 file</p>
    <p>system, a mainline patch was proposed. The last reported Linux vulnerability, which calls in the ext4 error handling routine panic() and hence results in a kernel panic, was at the time of writing not investigated any further. The NTFS bug in Windows 10 is a non-recoverable error condition which leads to a blue screen. This bug was reported to Microsoft, but has not been confirmed yet. Similarly, Apple has not yet verified or confirmed our reported macOS bugs.</p>
    <p>start; 9 int s = tokens [0]. start;</p>
    <p>Listing 2: The JSON parser kernel module used for the coverage benchmarks.</p>
    <p>We performed five repeated experiments for each operating system. Additionally we tested TriforceAFL with the Linux target driver. TriforceAFL is unable to fuzz Windows and macOS. To compare TriforceAFL with kAFL, the associated TriforceLinuxSyscallFuzzer was slightly modified to work with our vulnerable Linux kernel module. Unfortunately, it was not possible to compare kAFL against Oracles file system fuzzer [34] due to technical issues with its setup.</p>
    <p>During each run, we fuzzed the JSON parser for 30 minutes. The averaged and rounded results are displayed in Table 1. As we can see, the performance of kAFL is very similar across different systems. It should be remarked that the variance in this experiment is rather high</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Evaluation Driver</p>
    <p>Linux: keyctl Null Pointer Dereference5 (CVE2016-86506)</p>
    <p>Linux: ext4 Memory Corruption7</p>
    <p>Linux: ext4 Error Handling8</p>
    <p>Windows: NTFS Div-by-Zero9</p>
    <p>macOS: HFS Div-by-Zero10</p>
    <p>macOS: HFS Assertion Fail10</p>
    <p>macOS: HFS Use-After-Free10</p>
    <p>macOS: APFS Memory Corruption10</p>
    <p>Red Hat has assigned a CVE number for the first reported security flaw, which triggers a null pointer deference and a partial memory corruption in the kernel ASN.1 parser if an RSA certificate with a zero exponent is presented. For the second reported vulnerability, which triggers a memory corruption in the ext4 file</p>
    <p>system, a mainline patch was proposed. The last reported Linux vulnerability, which calls in the ext4 error handling routine panic() and hence results in a kernel panic, was at the time of writing not investigated any further. The NTFS bug in Windows 10 is a non-recoverable error condition which leads to a blue screen. This bug was reported to Microsoft, but has not been confirmed yet. Similarly, Apple has not yet verified or confirmed our reported macOS bugs.</p>
    <p>start; 9 int s = tokens [0]. start;</p>
    <p>Listing 2: The JSON parser kernel module used for the coverage benchmarks.</p>
    <p>We performed five repeated experiments for each operating system. Additionally we tested TriforceAFL with the Linux target driver. TriforceAFL is unable to fuzz Windows and macOS. To compare TriforceAFL with kAFL, the associated TriforceLinuxSyscallFuzzer was slightly modified to work with our vulnerable Linux kernel module. Unfortunately, it was not possible to compare kAFL against Oracles file system fuzzer [34] due to technical issues with its setup.</p>
    <p>During each run, we fuzzed the JSON parser for 30 minutes. The averaged and rounded results are displayed in Table 1. As we can see, the performance of kAFL is very similar across different systems. It should be remarked that the variance in this experiment is rather high</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Performance</p>
    <p>Intel i7-6700 / 32GB DDR4</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Coverage</p>
    <p>Intel i7-6700 / 32GB DDR4</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Coverage</p>
    <p>Intel i7-6700 / 32GB DDR4</p>
    <p>kAFL: 5-7 minutes</p>
    <p>TriforceAFL: ~2 hours</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
  <div class="page">
    <p>Conclusion</p>
    <p>Intel PT and virtualization for feedback fuzzing Fast OS independence (x86-64) Reliable and long-term Fully extensible</p>
    <p>High bug yield for kernel fuzzing Opportunities for further fuzzing</p>
    <p>https://github.com/RUB-SysSec/kAFL</p>
    <p>kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</p>
  </div>
</Presentation>
