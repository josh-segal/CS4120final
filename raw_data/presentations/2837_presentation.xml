<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>TimeCrypt: Encrypted Data Stream Processing at Scale with Cryptographic Access Control</p>
    <p>Lukas Burkhalter, Anwar Hithnawi, Alexander Viand, Hossein Shafagh, Sylvia Ratnasamy</p>
  </div>
  <div class="page">
    <p>Time Series Data</p>
    <p>Monitoring, Telemetry, Internet of Things</p>
    <p>Time</p>
    <p>Analytics</p>
    <p>is Emerging Everywhere</p>
    <p>Problem: High resolution sensitive data! Server compromise results in privacy risks</p>
  </div>
  <div class="page">
    <p>&gt; 45 billion records</p>
    <p>*since 2004</p>
    <p>Data Breaches</p>
  </div>
  <div class="page">
    <p>Keep data encrypted while in-use  preserve confidentiality and functionality  Encrypted Databases  relational databases, graph databases, key-value stores</p>
    <p>E.g., CryptDB [SOSP11], BlindBox [SIGCOMM15], Seabed [OSDI16], Talos [SenSys15]</p>
    <p>Encrypted Data Processing</p>
    <p>$</p>
    <p>$(1) $()</p>
  </div>
  <div class="page">
    <p>Can we enable encrypted data processing for time series workloads?</p>
  </div>
  <div class="page">
    <p>Challenge I Scalability and Interactivity</p>
  </div>
  <div class="page">
    <p>Time Series Databases Time series workloads are different:  Primarily INSERTS to recent time interval</p>
    <p>(append)  Statistical queries over time ranges</p>
    <p>Requirements:  High throughput writes  Large volumes of data  Support for time-based queries</p>
  </div>
  <div class="page">
    <p>Time Series Databases Time series workloads are different:  Primarily INSERTS to recent time interval</p>
    <p>(append)  Statistical queries over time ranges</p>
    <p>Requirements:  High throughput writes  Large volumes of data  Support for time-based queries</p>
    <p>Scalability and Latency  Memory Expansion (~100x)  Enc/Dec Time (~milliseconds)  Ciphertext Aggregation (~1000x)</p>
  </div>
  <div class="page">
    <p>Challenge II Secure Sharing</p>
  </div>
  <div class="page">
    <p>Insurance</p>
    <p>Doctor</p>
    <p>Trainer</p>
    <p>Time</p>
    <p>Minute</p>
    <p>Policy( )</p>
    <p>Policy( )</p>
    <p>Policy( )</p>
    <p>Selective Data Sharing</p>
    <p>Daily</p>
  </div>
  <div class="page">
    <p>Duration of Sickness</p>
    <p>Time</p>
    <p>Minute</p>
    <p>Selective Data Sharing</p>
    <p>Policy( )</p>
    <p>Policy( )</p>
    <p>Policy( )</p>
    <p>Insurance</p>
    <p>Doctor</p>
    <p>Trainer</p>
  </div>
  <div class="page">
    <p>How to enable users to selectively share their encrypted data? Enforce access control semantics cryptographically</p>
    <p>Time</p>
    <p>Minute</p>
    <p>Selective Data Sharing</p>
    <p>Policy( )</p>
    <p>Policy( )</p>
    <p>Policy( )</p>
    <p>Insurance</p>
    <p>Doctor</p>
    <p>Trainer</p>
    <p>Run Durations</p>
    <p>Hourly</p>
  </div>
  <div class="page">
    <p>TimeCrypt in a Nutshell</p>
    <p>Data is encrypted end-to-end:  Scalable computation over large volumes of encrypted data  Key time-series data functionalities, analytics, lifecycle operations  Cryptographic access control  selective access to encrypted data  Verifiable computation</p>
  </div>
  <div class="page">
    <p>Semi-Trusted: Data access according to an access policy</p>
    <p>Trusted: Full data access Untrusted: Confidentiality + Integrity</p>
    <p>Overview and Threat Model</p>
    <p>Data Consumer</p>
    <p>Data Producer</p>
    <p>Time Series Storage</p>
    <p>Data Owner</p>
    <p>Client Module</p>
    <p>Data Encryption/ Decryption</p>
    <p>Encrypted Indices</p>
  </div>
  <div class="page">
    <p>Data producer Time window</p>
    <p>chunking</p>
    <p>Server</p>
    <p>Writing Data Streams</p>
    <p>blob</p>
    <p>Aggregatable Digest</p>
    <p>Encrypted Index</p>
    <p>Storage</p>
    <p>Aggregatable Digest</p>
    <p>raw chunk</p>
    <p>Sum</p>
    <p>Count</p>
    <p>blob</p>
  </div>
  <div class="page">
    <p>Aggregatable Digest</p>
    <p>Sum</p>
    <p>Count</p>
    <p>Sum of squares</p>
    <p>Sum</p>
    <p>Count</p>
    <p>Sum of squares</p>
    <p>+  Additive homomorphic encryption is the underlying construction</p>
    <p>m1 + m2 = Dec(Enc(m1) Enc(m2))</p>
    <p>How to support statistics and analytics beyond addition?</p>
  </div>
  <div class="page">
    <p>Aggregatable Digest</p>
    <p>Sum</p>
    <p>Count</p>
    <p>Sum of squares</p>
    <p>Sum</p>
    <p>Count</p>
    <p>Sum of squares</p>
    <p>+  Additive homomorphic encryption is the underlying construction</p>
    <p>m1 + m2 = Dec(Enc(m1) Enc(m2))</p>
    <p>Leverage known encoding techniques  If we can compute sum privately, then we can compute f() privately  average, sum, count, variance, min/max (approx.), histograms (approx.), least</p>
    <p>squares regression,</p>
  </div>
  <div class="page">
    <p>Homomorphic Encryption</p>
    <p>Aggregatable Digest Aggregatable Digest+</p>
    <p>Problem: Homomorphic encryption based on asymmetric cryptography is expensive (e.g., Paillier, EC-ElGamal)</p>
    <p>plaintext</p>
    <p>ciphertext</p>
    <p>ciphertext expansion</p>
    <p>ciphertext ciphertext+</p>
    <p>addition time</p>
    <p>plaintext</p>
    <p>ciphertext</p>
    <p>enc/decryption</p>
    <p>milliseconds</p>
  </div>
  <div class="page">
    <p>TimeCrypt Encryption k0 ,k1, k2, k3, k4, k5, Given a key stream:</p>
    <p>m1 + m0 + k0 m1 + m1 + k1</p>
    <p>m0 +  + mN + k0  k1 + k1   +   k(N+1)</p>
    <p>+/- is addition modulo M</p>
    <p>m1 + m0 + m1 + k0  k1 + k1  k2</p>
    <p>+  k1  k2</p>
    <p>[Castelluccia et al. 05] Symmetric homomorphic encryption</p>
    <p>No ciphertext expansion + fast ciphertext aggregation</p>
    <p>time</p>
  </div>
  <div class="page">
    <p>Key Stream to Time Encoding</p>
    <p>k1 k2</p>
    <p>t0 t1 t2 t3 Time</p>
    <p>k0</p>
    <p>Query statistics from t0 to t3</p>
    <p>m0 m1 m2</p>
    <p>k3+ - + - +</p>
    <p>m0 + m1 + m2</p>
    <p>k0 + k3</p>
    <p>The query time range translates to the used keys</p>
  </div>
  <div class="page">
    <p>Time Interval Access Restriction</p>
    <p>k0 k3k1 k2 k4 k5 k6 k7Key Stream:</p>
  </div>
  <div class="page">
    <p>Tree-based Key Derivation</p>
    <p>k0 k3k1 k2 k4 k5 k6 k7Key Stream:</p>
    <p>Master SecretThe one-way property of the function allows for access control (Interval)</p>
    <p>PRG( )</p>
    <p>t0 t3 t6</p>
  </div>
  <div class="page">
    <p>How to share aggregated information of a certain granularity?</p>
    <p>Access Restriction at Resolution Level</p>
    <p>Per hour aggregates Per day aggregatesvs</p>
  </div>
  <div class="page">
    <p>Digest</p>
    <p>t0 t1 t2 t3</p>
    <p>+ k0  k1 + k1  k2</p>
    <p>k0, k2, k4, . Only share the outer keys of the desired granularity</p>
    <p>Digest Digest Digest</p>
    <p>t4</p>
    <p>+ k2  k3 + k3  k4</p>
    <p>Digest</p>
    <p>+ k0  k2 + k2  k4 Digest</p>
  </div>
  <div class="page">
    <p>TimeCrypt Implementation Cassandra</p>
    <p>storage TimeCrypt</p>
    <p>Server node library (Java Netty framework)</p>
    <p>Aggregation Trees</p>
    <p>Caches</p>
    <p>Time Series API</p>
    <p>TimeCrypt Client</p>
    <p>(Java, C)</p>
    <p>Key Management</p>
    <p>Enc/Decryption</p>
    <p>Serialization / Query logic</p>
    <p>Access Policies</p>
  </div>
  <div class="page">
    <p>Evaluation Health Dashboard Application</p>
    <p>Medical Sensor Data</p>
    <p>m5.xlarge 4-CPU 16GB</p>
    <p>m5.2xlarge 8-CPU 32GB</p>
    <p>m5.xlarge 4-CPU 16GB</p>
  </div>
  <div class="page">
    <p>System Performance</p>
    <p>Throughput under heavy load of 4/1 read-write ratio, 49k streams</p>
    <p>Ingest Statistical Range Queries</p>
    <p>TiPHCrySt+ A6+E</p>
    <p>T hr</p>
    <p>ou gh</p>
    <p>Su t [</p>
    <p>rH co</p>
    <p>rG s/</p>
    <p>s]</p>
    <p>TiPHCrySt+ AS+E</p>
    <p>T hr</p>
    <p>ou gh</p>
    <p>Su t [</p>
    <p>oS s/</p>
    <p>s]</p>
  </div>
  <div class="page">
    <p>Health Dashboard Queries</p>
    <p>Latency for statistical queries over one month, based on our health app</p>
    <p>PLnute hour day week Ponth 0.1</p>
    <p>L at</p>
    <p>en cy</p>
    <p>Ln [</p>
    <p>P s] PlaLnte[t TLPeCrypt TLPeCrypt+</p>
  </div>
  <div class="page">
    <p>Summary  TimeCrypt is an efficient system that augments time series datastores</p>
    <p>with encrypted data processing capabilities  Protects confidentiality of sensitive time series data  Supports computation integrity on encrypted data</p>
    <p>TimeCrypts Encryption: Efficient construction that couples encrypted data processing with crypto-enforced access-control for time series streams</p>
    <p>Source code available at: https://timecrypt.io/</p>
  </div>
</Presentation>
