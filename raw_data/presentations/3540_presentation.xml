<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>A Systematic Evaluation of Transient Execution</p>
    <p>Attacks and Defenses</p>
    <p>Claudio Canella (@cc0x1f)1, Jo Van Bulck2, Michael Schwarz1, Moritz Lipp1, Benjamin</p>
    <p>von Berg1, Philipp Ortner1, Frank Piessens2, Dmitry Evtyushkin, Daniel Gruss1</p>
    <p>August 14, 2019</p>
  </div>
  <div class="page">
    <p>Motivation www.tugraz.at</p>
    <p>Clear up naming confusion</p>
    <p>Systematic analysis shows new variants  Show defenses cost performance and do not fully work  Gadget prevalence in Linux kernel</p>
  </div>
  <div class="page">
    <p>Motivation www.tugraz.at</p>
    <p>Clear up naming confusion  Systematic analysis shows new variants</p>
    <p>Show defenses cost performance and do not fully work  Gadget prevalence in Linux kernel</p>
  </div>
  <div class="page">
    <p>Motivation www.tugraz.at</p>
    <p>Clear up naming confusion  Systematic analysis shows new variants  Show defenses cost performance and do not fully work</p>
    <p>Gadget prevalence in Linux kernel</p>
  </div>
  <div class="page">
    <p>Motivation www.tugraz.at</p>
    <p>Clear up naming confusion  Systematic analysis shows new variants  Show defenses cost performance and do not fully work  Gadget prevalence in Linux kernel</p>
  </div>
  <div class="page">
    <p>Meltdown www.tugraz.at</p>
    <p>CPU uses data in out-of-order execution before permission check</p>
    <p>Meltdown can read any kernel address  Physical memory is usually mapped in kernel  Read arbitrary memory</p>
  </div>
  <div class="page">
    <p>Meltdown www.tugraz.at</p>
    <p>CPU uses data in out-of-order execution before permission check  Meltdown can read any kernel address</p>
    <p>Physical memory is usually mapped in kernel  Read arbitrary memory</p>
  </div>
  <div class="page">
    <p>Meltdown www.tugraz.at</p>
    <p>CPU uses data in out-of-order execution before permission check  Meltdown can read any kernel address  Physical memory is usually mapped in kernel</p>
    <p>Read arbitrary memory</p>
  </div>
  <div class="page">
    <p>Meltdown www.tugraz.at</p>
    <p>CPU uses data in out-of-order execution before permission check  Meltdown can read any kernel address  Physical memory is usually mapped in kernel  Read arbitrary memory</p>
  </div>
  <div class="page">
    <p>Problem Solved? www.tugraz.at</p>
    <p>Meltdown fully mitigated in software</p>
    <p>Problem seemed to be solved  No attack surface left  That is what everyone thought</p>
  </div>
  <div class="page">
    <p>Problem Solved? www.tugraz.at</p>
    <p>Meltdown fully mitigated in software  Problem seemed to be solved</p>
    <p>No attack surface left  That is what everyone thought</p>
  </div>
  <div class="page">
    <p>Problem Solved? www.tugraz.at</p>
    <p>Meltdown fully mitigated in software  Problem seemed to be solved  No attack surface left</p>
    <p>That is what everyone thought</p>
  </div>
  <div class="page">
    <p>Problem Solved? www.tugraz.at</p>
    <p>Meltdown fully mitigated in software  Problem seemed to be solved  No attack surface left  That is what everyone thought</p>
  </div>
  <div class="page">
    <p>Generalization www.tugraz.at</p>
    <p>Meltdown is a whole category of vulnerabilities</p>
    <p>Not only the user-accessible check</p>
  </div>
  <div class="page">
    <p>Generalization www.tugraz.at</p>
    <p>Meltdown is a whole category of vulnerabilities  Not only the user-accessible check</p>
  </div>
  <div class="page">
    <p>Page Table Entry www.tugraz.at</p>
    <p>P RW US WT UC R D S G Ignored</p>
    <p>Physical Page Number Ignored PK X</p>
    <p>User/Supervisor bit defines in which privilege level the page can be accessed</p>
  </div>
  <div class="page">
    <p>Meltdown Variants www.tugraz.at</p>
    <p>Pagefault</p>
  </div>
  <div class="page">
    <p>Meltdown Variants www.tugraz.at</p>
    <p>Pagefault Meltdown-US</p>
  </div>
  <div class="page">
    <p>Meltdown Variants www.tugraz.at</p>
    <p>Pagefault Meltdown-US Meltdown-US-L1</p>
    <p>Meltdown-US-L3</p>
    <p>Meltdown-US-LFB</p>
  </div>
  <div class="page">
    <p>Meltdown Variants www.tugraz.at</p>
    <p>Pagefault Meltdown-US</p>
    <p>Meltdown-P</p>
    <p>Meltdown-US-L1</p>
    <p>Meltdown-US-L3</p>
    <p>Meltdown-US-LFB</p>
  </div>
  <div class="page">
    <p>Meltdown Variants www.tugraz.at</p>
    <p>Pagefault Meltdown-US</p>
    <p>Meltdown-P</p>
    <p>Meltdown-RW</p>
    <p>Meltdown-PK</p>
    <p>Meltdown-XD</p>
    <p>Meltdown-SM</p>
    <p>Meltdown-US-L1</p>
    <p>Meltdown-US-L3</p>
    <p>Meltdown-US-LFB</p>
  </div>
  <div class="page">
    <p>Meltdown Variants www.tugraz.at</p>
    <p>Pagefault Meltdown-US</p>
    <p>Meltdown-P</p>
    <p>Meltdown-RW</p>
    <p>Meltdown-PK</p>
    <p>Meltdown-XD</p>
    <p>Meltdown-SM</p>
    <p>Meltdown-US-L1</p>
    <p>Meltdown-US-L3</p>
    <p>Meltdown-US-LFB</p>
  </div>
  <div class="page">
    <p>Meltdown Root Cause www.tugraz.at</p>
    <p>operation #n</p>
    <p>time</p>
  </div>
  <div class="page">
    <p>Meltdown Root Cause www.tugraz.at</p>
    <p>operation #n</p>
    <p>data</p>
    <p>time</p>
  </div>
  <div class="page">
    <p>Meltdown Root Cause www.tugraz.at</p>
    <p>operation #n</p>
    <p>operation #n+2</p>
    <p>data dependency</p>
    <p>data</p>
    <p>time</p>
  </div>
  <div class="page">
    <p>Meltdown Root Cause www.tugraz.at</p>
    <p>operation #n</p>
    <p>re ti re</p>
    <p>operation #n+2</p>
    <p>data dependency</p>
    <p>data</p>
    <p>possibly</p>
    <p>architectural transient execution</p>
    <p>exception</p>
    <p>time</p>
  </div>
  <div class="page">
    <p>Meltdown Root Cause www.tugraz.at</p>
    <p>operation #n</p>
    <p>re ti re</p>
    <p>operation #n+2</p>
    <p>data dependency</p>
    <p>data</p>
    <p>possibly</p>
    <p>architectural transient execution</p>
    <p>exception</p>
    <p>time</p>
  </div>
  <div class="page">
    <p>Meltdown Root Cause www.tugraz.at</p>
    <p>operation #n</p>
    <p>re ti re</p>
    <p>operation #n+2</p>
    <p>data dependency</p>
    <p>data Meltdown</p>
    <p>possibly</p>
    <p>architectural transient execution</p>
    <p>exception</p>
    <p>time</p>
  </div>
  <div class="page">
    <p>Meltdown Root Cause www.tugraz.at</p>
    <p>operation #n</p>
    <p>re ti re</p>
    <p>re ti re</p>
    <p>operation #n+2</p>
    <p>data dependency</p>
    <p>data Meltdown</p>
    <p>possibly</p>
    <p>architectural transient execution</p>
    <p>exception raise</p>
    <p>time</p>
  </div>
  <div class="page">
    <p>Meltdown Tree www.tugraz.at</p>
    <p>Transient</p>
    <p>cause?</p>
  </div>
  <div class="page">
    <p>Meltdown Tree www.tugraz.at</p>
    <p>Transient</p>
    <p>cause?</p>
    <p>Meltdown-type</p>
    <p>fault</p>
  </div>
  <div class="page">
    <p>Meltdown Tree www.tugraz.at</p>
    <p>Transient</p>
    <p>cause?</p>
    <p>Meltdown-type</p>
    <p>fault type</p>
    <p>Meltdown-NM</p>
    <p>Meltdown-AC</p>
    <p>Meltdown-DE</p>
    <p>Meltdown-PF</p>
    <p>Meltdown-UD</p>
    <p>Meltdown-SS</p>
    <p>Meltdown-BR</p>
    <p>Meltdown-GP</p>
    <p>fault</p>
  </div>
  <div class="page">
    <p>Meltdown Tree www.tugraz.at</p>
    <p>Transient</p>
    <p>cause?</p>
    <p>Meltdown-type</p>
    <p>fault type</p>
    <p>Meltdown-NM</p>
    <p>Meltdown-AC</p>
    <p>Meltdown-DE</p>
    <p>Meltdown-PF</p>
    <p>Meltdown-UD</p>
    <p>Meltdown-SS</p>
    <p>Meltdown-BR</p>
    <p>Meltdown-GP</p>
    <p>Meltdown-US</p>
    <p>Meltdown-P</p>
    <p>Meltdown-RW</p>
    <p>Meltdown-PK</p>
    <p>Meltdown-XD</p>
    <p>Meltdown-SM</p>
    <p>Meltdown-US-L1</p>
    <p>Meltdown-US-L3</p>
    <p>Meltdown-US-LFB</p>
    <p>fault</p>
  </div>
  <div class="page">
    <p>Meltdown Tree www.tugraz.at</p>
    <p>Transient</p>
    <p>cause?</p>
    <p>Meltdown-type</p>
    <p>fault type</p>
    <p>Meltdown-NM</p>
    <p>Meltdown-AC</p>
    <p>Meltdown-DE</p>
    <p>Meltdown-PF</p>
    <p>Meltdown-UD</p>
    <p>Meltdown-SS</p>
    <p>Meltdown-BR</p>
    <p>Meltdown-GP</p>
    <p>Meltdown-US</p>
    <p>Meltdown-P</p>
    <p>Meltdown-RW</p>
    <p>Meltdown-PK</p>
    <p>Meltdown-XD</p>
    <p>Meltdown-SM</p>
    <p>Meltdown-US-L1</p>
    <p>Meltdown-US-L3</p>
    <p>Meltdown-US-LFB</p>
    <p>Meltdown-MPX</p>
    <p>Meltdown-BND</p>
    <p>fault</p>
  </div>
  <div class="page">
    <p>Spectre www.tugraz.at</p>
    <p>Spectre is a second class of transient execution attack</p>
    <p>Instead of faults, exploit control (or data) flow predictions</p>
  </div>
  <div class="page">
    <p>Spectre www.tugraz.at</p>
    <p>Spectre is a second class of transient execution attack  Instead of faults, exploit control (or data) flow predictions</p>
  </div>
  <div class="page">
    <p>Spectre Root Cause www.tugraz.at</p>
    <p>operation #n</p>
    <p>time</p>
  </div>
  <div class="page">
    <p>Spectre Root Cause www.tugraz.at</p>
    <p>operation #n</p>
    <p>prediction</p>
    <p>time</p>
  </div>
  <div class="page">
    <p>Spectre Root Cause www.tugraz.at</p>
    <p>operation #n</p>
    <p>prediction</p>
    <p>operation #n+2pr e d ic t</p>
    <p>C F / D F</p>
    <p>time</p>
  </div>
  <div class="page">
    <p>Spectre Root Cause www.tugraz.at</p>
    <p>operation #n</p>
    <p>prediction</p>
    <p>operation #n+2pr e d ic t</p>
    <p>C F / D F</p>
    <p>possibly</p>
    <p>architectural transient execution</p>
    <p>time</p>
  </div>
  <div class="page">
    <p>Spectre Root Cause www.tugraz.at</p>
    <p>operation #n</p>
    <p>re ti re</p>
    <p>prediction</p>
    <p>operation #n+2pr e d ic t</p>
    <p>C F / D F</p>
    <p>possibly</p>
    <p>architectural transient execution</p>
    <p>time</p>
  </div>
  <div class="page">
    <p>Spectre Root Cause www.tugraz.at</p>
    <p>operation #n</p>
    <p>re ti re</p>
    <p>prediction</p>
    <p>re ti re</p>
    <p>operation #n+2pr e d ic t</p>
    <p>C F / D F</p>
    <p>possibly</p>
    <p>architectural transient execution</p>
    <p>flush pipeline on wrong prediction</p>
    <p>time</p>
  </div>
  <div class="page">
    <p>Spectre Root Cause www.tugraz.at</p>
    <p>operation #n</p>
    <p>re ti re</p>
    <p>prediction</p>
    <p>re ti re</p>
    <p>operation #n+2</p>
    <p>re ti re</p>
    <p>p re d ic t</p>
    <p>C F / D F</p>
    <p>possibly</p>
    <p>architectural transient execution</p>
    <p>flush pipeline on wrong prediction</p>
    <p>time</p>
  </div>
  <div class="page">
    <p>Spectre Root Cause www.tugraz.at</p>
    <p>Many predictors in modern CPUs</p>
    <p>Branch taken/not taken (PHT)  Call/Jump destination (BTB)  Function return destination (RSB)  Load matches previous store (STL)</p>
    <p>Most are even shared among processes</p>
  </div>
  <div class="page">
    <p>Spectre Root Cause www.tugraz.at</p>
    <p>Many predictors in modern CPUs  Branch taken/not taken (PHT)</p>
    <p>Call/Jump destination (BTB)  Function return destination (RSB)  Load matches previous store (STL)</p>
    <p>Most are even shared among processes</p>
  </div>
  <div class="page">
    <p>Spectre Root Cause www.tugraz.at</p>
    <p>Many predictors in modern CPUs  Branch taken/not taken (PHT)  Call/Jump destination (BTB)</p>
    <p>Function return destination (RSB)  Load matches previous store (STL)</p>
    <p>Most are even shared among processes</p>
  </div>
  <div class="page">
    <p>Spectre Root Cause www.tugraz.at</p>
    <p>Many predictors in modern CPUs  Branch taken/not taken (PHT)  Call/Jump destination (BTB)  Function return destination (RSB)</p>
    <p>Load matches previous store (STL)</p>
    <p>Most are even shared among processes</p>
  </div>
  <div class="page">
    <p>Spectre Root Cause www.tugraz.at</p>
    <p>Many predictors in modern CPUs  Branch taken/not taken (PHT)  Call/Jump destination (BTB)  Function return destination (RSB)  Load matches previous store (STL)</p>
    <p>Most are even shared among processes</p>
  </div>
  <div class="page">
    <p>Spectre Root Cause www.tugraz.at</p>
    <p>Many predictors in modern CPUs  Branch taken/not taken (PHT)  Call/Jump destination (BTB)  Function return destination (RSB)  Load matches previous store (STL)</p>
    <p>Most are even shared among processes</p>
  </div>
  <div class="page">
    <p>Spectre Mistraining www.tugraz.at</p>
    <p>same address space/</p>
    <p>in place</p>
    <p>Victim</p>
    <p>Victim</p>
    <p>branch</p>
  </div>
  <div class="page">
    <p>Spectre Mistraining www.tugraz.at</p>
    <p>same address space/</p>
    <p>in place</p>
    <p>same address space/</p>
    <p>out of place</p>
    <p>Victim</p>
    <p>Victim</p>
    <p>branch</p>
    <p>Congruent</p>
    <p>branch</p>
    <p>A d d re ss</p>
    <p>c o ll is io n</p>
  </div>
  <div class="page">
    <p>Spectre Mistraining www.tugraz.at</p>
    <p>same address space/</p>
    <p>in place</p>
    <p>same address space/</p>
    <p>out of place</p>
    <p>Victim</p>
    <p>Victim</p>
    <p>branch</p>
    <p>Congruent</p>
    <p>branch</p>
    <p>A d d re ss</p>
    <p>c o ll is io n</p>
    <p>Shared Branch Prediction State</p>
  </div>
  <div class="page">
    <p>Spectre Mistraining www.tugraz.at</p>
    <p>same address space/</p>
    <p>in place</p>
    <p>same address space/</p>
    <p>out of place</p>
    <p>Victim</p>
    <p>Victim</p>
    <p>branch</p>
    <p>Congruent</p>
    <p>branch</p>
    <p>A d d re ss</p>
    <p>c o ll is io n</p>
    <p>Attacker</p>
    <p>Shared Branch Prediction State</p>
  </div>
  <div class="page">
    <p>Spectre Mistraining www.tugraz.at</p>
    <p>same address space/</p>
    <p>in place</p>
    <p>same address space/</p>
    <p>out of place</p>
    <p>Victim</p>
    <p>Victim</p>
    <p>branch</p>
    <p>Congruent</p>
    <p>branch</p>
    <p>A d d re ss</p>
    <p>c o ll is io n</p>
    <p>cross address space/</p>
    <p>in place</p>
    <p>Attacker</p>
    <p>Shadow</p>
    <p>branch</p>
    <p>Shared Branch Prediction State</p>
  </div>
  <div class="page">
    <p>Spectre Mistraining www.tugraz.at</p>
    <p>same address space/</p>
    <p>in place</p>
    <p>same address space/</p>
    <p>out of place</p>
    <p>Victim</p>
    <p>Victim</p>
    <p>branch</p>
    <p>Congruent</p>
    <p>branch</p>
    <p>A d d re ss</p>
    <p>c o ll is io n</p>
    <p>cross address space/</p>
    <p>in place</p>
    <p>cross address space/</p>
    <p>out of place</p>
    <p>Attacker</p>
    <p>Shadow</p>
    <p>branch</p>
    <p>Congruent</p>
    <p>branch</p>
    <p>A d d re ss</p>
    <p>c o ll is io n</p>
    <p>Shared Branch Prediction State</p>
  </div>
  <div class="page">
    <p>Spectre Variants www.tugraz.at</p>
    <p>Transient</p>
    <p>cause?</p>
  </div>
  <div class="page">
    <p>Spectre Variants www.tugraz.at</p>
    <p>Transient</p>
    <p>cause?</p>
    <p>Spectre-type</p>
    <p>prediction</p>
  </div>
  <div class="page">
    <p>Spectre Variants www.tugraz.at</p>
    <p>Transient</p>
    <p>cause?</p>
    <p>Spectre-type</p>
    <p>microarchitec</p>
    <p>tural buffer Spectre-PHT</p>
    <p>Spectre-BTB</p>
    <p>Spectre-RSB</p>
    <p>Spectre-STL</p>
    <p>prediction</p>
  </div>
  <div class="page">
    <p>Spectre Variants www.tugraz.at</p>
    <p>Transient</p>
    <p>cause?</p>
    <p>Spectre-type</p>
    <p>microarchitec</p>
    <p>tural buffer Spectre-PHT</p>
    <p>Spectre-BTB</p>
    <p>Spectre-RSB</p>
    <p>Spectre-STL</p>
    <p>mistraining</p>
    <p>strategy Cross-address-space</p>
    <p>Same-address-space</p>
    <p>Cross-address-space</p>
    <p>Same-address-space</p>
    <p>Cross-address-space</p>
    <p>Same-address-space</p>
    <p>prediction</p>
  </div>
  <div class="page">
    <p>Spectre Variants www.tugraz.at</p>
    <p>Transient</p>
    <p>cause?</p>
    <p>Spectre-type</p>
    <p>microarchitec</p>
    <p>tural buffer Spectre-PHT</p>
    <p>Spectre-BTB</p>
    <p>Spectre-RSB</p>
    <p>Spectre-STL</p>
    <p>mistraining</p>
    <p>strategy Cross-address-space</p>
    <p>Same-address-space</p>
    <p>PHT-CA-IP</p>
    <p>PHT-CA-OP</p>
    <p>PHT-SA-IP</p>
    <p>PHT-SA-OP</p>
    <p>in-place (IP) vs., out-of-place (OP)</p>
    <p>Cross-address-space</p>
    <p>Same-address-space</p>
    <p>BTB-CA-IP</p>
    <p>BTB-CA-OP</p>
    <p>BTB-SA-IP</p>
    <p>BTB-SA-OP</p>
    <p>Cross-address-space</p>
    <p>Same-address-space</p>
    <p>RSB-CA-IP</p>
    <p>RSB-CA-OP</p>
    <p>RSB-SA-IP</p>
    <p>RSB-SA-OP</p>
    <p>prediction</p>
  </div>
  <div class="page">
    <p>Spectre Fix www.tugraz.at</p>
    <p>Spectre is not a bug</p>
    <p>It is an useful optimization  Cannot simply fix it (as with Meltdown)  Workarounds for critical code parts</p>
  </div>
  <div class="page">
    <p>Spectre Fix www.tugraz.at</p>
    <p>Spectre is not a bug  It is an useful optimization</p>
    <p>Cannot simply fix it (as with Meltdown)  Workarounds for critical code parts</p>
  </div>
  <div class="page">
    <p>Spectre Fix www.tugraz.at</p>
    <p>Spectre is not a bug  It is an useful optimization  Cannot simply fix it (as with Meltdown)</p>
    <p>Workarounds for critical code parts</p>
  </div>
  <div class="page">
    <p>Spectre Fix www.tugraz.at</p>
    <p>Spectre is not a bug  It is an useful optimization  Cannot simply fix it (as with Meltdown)  Workarounds for critical code parts</p>
  </div>
  <div class="page">
    <p>Spectre Defense Categorization www.tugraz.at</p>
    <p>Spectre defenses in 3 categories:</p>
    <p>C1 Mitigating or reducing</p>
    <p>the accuracy of covert</p>
    <p>channels</p>
    <p>C2 Mitigating or aborting</p>
    <p>speculation</p>
    <p>C3 Ensuring secret data</p>
    <p>cannot be reached</p>
  </div>
  <div class="page">
    <p>Spectre Misconceptions www.tugraz.at</p>
    <p>Many countermeasures only consider the cache to get data...</p>
    <p>...but there are other possibilities, e.g.,  Port contention (SMoTherSpectre)  AVX (NetSpectre)</p>
    <p>Cache is just the easiest</p>
  </div>
  <div class="page">
    <p>Spectre Misconceptions www.tugraz.at</p>
    <p>Many countermeasures only consider the cache to get data...  ...but there are other possibilities, e.g.,</p>
    <p>Port contention (SMoTherSpectre)  AVX (NetSpectre)</p>
    <p>Cache is just the easiest</p>
  </div>
  <div class="page">
    <p>Spectre Misconceptions www.tugraz.at</p>
    <p>Many countermeasures only consider the cache to get data...  ...but there are other possibilities, e.g.,</p>
    <p>Port contention (SMoTherSpectre)</p>
    <p>AVX (NetSpectre)</p>
    <p>Cache is just the easiest</p>
  </div>
  <div class="page">
    <p>Spectre Misconceptions www.tugraz.at</p>
    <p>Many countermeasures only consider the cache to get data...  ...but there are other possibilities, e.g.,</p>
    <p>Port contention (SMoTherSpectre)  AVX (NetSpectre)</p>
    <p>Cache is just the easiest</p>
  </div>
  <div class="page">
    <p>Spectre Misconceptions www.tugraz.at</p>
    <p>Many countermeasures only consider the cache to get data...  ...but there are other possibilities, e.g.,</p>
    <p>Port contention (SMoTherSpectre)  AVX (NetSpectre)</p>
    <p>Cache is just the easiest</p>
  </div>
  <div class="page">
    <p>Spectre Defenses: Microarchitectural Target www.tugraz.at</p>
    <p>Defense In vi</p>
    <p>si S</p>
    <p>p ec</p>
    <p>S af</p>
    <p>eS p ec</p>
    <p>D A</p>
    <p>W G</p>
    <p>T ai</p>
    <p>nt T</p>
    <p>ra ck</p>
    <p>in g</p>
    <p>T im</p>
    <p>er R</p>
    <p>ed uc</p>
    <p>ti on</p>
    <p>R S</p>
    <p>B S</p>
    <p>tu ffi</p>
    <p>ng R</p>
    <p>et p ol</p>
    <p>in e</p>
    <p>S L H</p>
    <p>Y S</p>
    <p>N B</p>
    <p>IB R</p>
    <p>S S</p>
    <p>T IP</p>
    <p>B IB</p>
    <p>P B</p>
    <p>S er</p>
    <p>ia liz</p>
    <p>at io</p>
    <p>n S</p>
    <p>lo th</p>
    <p>S S</p>
    <p>B D</p>
    <p>/S S</p>
    <p>B B</p>
    <p>P oi</p>
    <p>so n</p>
    <p>V al</p>
    <p>ue In</p>
    <p>de x</p>
    <p>M as</p>
    <p>ki ng</p>
    <p>S it</p>
    <p>e Is</p>
    <p>ol at</p>
    <p>io n</p>
    <p>M ic ro a rc h it e c tu ra l E le m e n t</p>
    <p>Cache</p>
    <p>TLB</p>
    <p>BTB</p>
    <p>BHB</p>
    <p>PHT</p>
    <p>RSB</p>
    <p>AVX</p>
    <p>FPU</p>
    <p>Execution Ports</p>
    <p>Category: C1 C2 C3</p>
    <p>Considers element( ), partially considers it/same technique possible ( ), or does not consider it( ).</p>
  </div>
  <div class="page">
    <p>Spectre Defenses: Microarchitectural Target www.tugraz.at</p>
    <p>Defense In vi</p>
    <p>si S</p>
    <p>p ec</p>
    <p>S af</p>
    <p>eS p ec</p>
    <p>D A</p>
    <p>W G</p>
    <p>T ai</p>
    <p>nt T</p>
    <p>ra ck</p>
    <p>in g</p>
    <p>T im</p>
    <p>er R</p>
    <p>ed uc</p>
    <p>ti on</p>
    <p>R S</p>
    <p>B S</p>
    <p>tu ffi</p>
    <p>ng R</p>
    <p>et p ol</p>
    <p>in e</p>
    <p>S L H</p>
    <p>Y S</p>
    <p>N B</p>
    <p>IB R</p>
    <p>S S</p>
    <p>T IP</p>
    <p>B IB</p>
    <p>P B</p>
    <p>S er</p>
    <p>ia liz</p>
    <p>at io</p>
    <p>n S</p>
    <p>lo th</p>
    <p>S S</p>
    <p>B D</p>
    <p>/S S</p>
    <p>B B</p>
    <p>P oi</p>
    <p>so n</p>
    <p>V al</p>
    <p>ue In</p>
    <p>de x</p>
    <p>M as</p>
    <p>ki ng</p>
    <p>S it</p>
    <p>e Is</p>
    <p>ol at</p>
    <p>io n</p>
    <p>M ic ro a rc h it e c tu ra l E le m e n t</p>
    <p>Cache</p>
    <p>TLB</p>
    <p>BTB</p>
    <p>BHB</p>
    <p>PHT</p>
    <p>RSB</p>
    <p>AVX</p>
    <p>FPU</p>
    <p>Execution Ports</p>
    <p>Category: C1 C2 C3</p>
    <p>Considers element( ), partially considers it/same technique possible ( ), or does not consider it( ).</p>
  </div>
  <div class="page">
    <p>Spectre Defenses: Microarchitectural Target www.tugraz.at</p>
    <p>Defense In vi</p>
    <p>si S</p>
    <p>p ec</p>
    <p>S af</p>
    <p>eS p ec</p>
    <p>D A</p>
    <p>W G</p>
    <p>T ai</p>
    <p>nt T</p>
    <p>ra ck</p>
    <p>in g</p>
    <p>T im</p>
    <p>er R</p>
    <p>ed uc</p>
    <p>ti on</p>
    <p>R S</p>
    <p>B S</p>
    <p>tu ffi</p>
    <p>ng R</p>
    <p>et p ol</p>
    <p>in e</p>
    <p>S L H</p>
    <p>Y S</p>
    <p>N B</p>
    <p>IB R</p>
    <p>S S</p>
    <p>T IP</p>
    <p>B IB</p>
    <p>P B</p>
    <p>S er</p>
    <p>ia liz</p>
    <p>at io</p>
    <p>n S</p>
    <p>lo th</p>
    <p>S S</p>
    <p>B D</p>
    <p>/S S</p>
    <p>B B</p>
    <p>P oi</p>
    <p>so n</p>
    <p>V al</p>
    <p>ue In</p>
    <p>de x</p>
    <p>M as</p>
    <p>ki ng</p>
    <p>S it</p>
    <p>e Is</p>
    <p>ol at</p>
    <p>io n</p>
    <p>M ic ro a rc h it e c tu ra l E le m e n t</p>
    <p>Cache</p>
    <p>TLB</p>
    <p>BTB</p>
    <p>BHB</p>
    <p>PHT</p>
    <p>RSB</p>
    <p>AVX</p>
    <p>FPU</p>
    <p>Execution Ports</p>
    <p>Category: C1 C2 C3</p>
    <p>Considers element( ), partially considers it/same technique possible ( ), or does not consider it( ).</p>
  </div>
  <div class="page">
    <p>Spectre Defenses: Microarchitectural Target www.tugraz.at</p>
    <p>Defense In vi</p>
    <p>si S</p>
    <p>p ec</p>
    <p>S af</p>
    <p>eS p ec</p>
    <p>D A</p>
    <p>W G</p>
    <p>T ai</p>
    <p>nt T</p>
    <p>ra ck</p>
    <p>in g</p>
    <p>T im</p>
    <p>er R</p>
    <p>ed uc</p>
    <p>ti on</p>
    <p>R S</p>
    <p>B S</p>
    <p>tu ffi</p>
    <p>ng R</p>
    <p>et p ol</p>
    <p>in e</p>
    <p>S L H</p>
    <p>Y S</p>
    <p>N B</p>
    <p>IB R</p>
    <p>S S</p>
    <p>T IP</p>
    <p>B IB</p>
    <p>P B</p>
    <p>S er</p>
    <p>ia liz</p>
    <p>at io</p>
    <p>n S</p>
    <p>lo th</p>
    <p>S S</p>
    <p>B D</p>
    <p>/S S</p>
    <p>B B</p>
    <p>P oi</p>
    <p>so n</p>
    <p>V al</p>
    <p>ue In</p>
    <p>de x</p>
    <p>M as</p>
    <p>ki ng</p>
    <p>S it</p>
    <p>e Is</p>
    <p>ol at</p>
    <p>io n</p>
    <p>M ic ro a rc h it e c tu ra l E le m e n t</p>
    <p>Cache</p>
    <p>TLB</p>
    <p>BTB</p>
    <p>BHB</p>
    <p>PHT</p>
    <p>RSB</p>
    <p>AVX</p>
    <p>FPU</p>
    <p>Execution Ports</p>
    <p>Category: C1 C2 C3</p>
    <p>Considers element( ), partially considers it/same technique possible ( ), or does not consider it( ).</p>
  </div>
  <div class="page">
    <p>Spectre: Defense Analysis www.tugraz.at</p>
    <p>Attack</p>
    <p>Defense</p>
    <p>In vi</p>
    <p>si S</p>
    <p>p ec</p>
    <p>S af</p>
    <p>eS p</p>
    <p>ec D</p>
    <p>A W</p>
    <p>G R</p>
    <p>S B</p>
    <p>S tu</p>
    <p>ffi n</p>
    <p>g R</p>
    <p>et p</p>
    <p>o lin</p>
    <p>e P</p>
    <p>o is</p>
    <p>o n</p>
    <p>V al</p>
    <p>u e</p>
    <p>In d</p>
    <p>ex M</p>
    <p>as k in</p>
    <p>g S</p>
    <p>it e</p>
    <p>Is o la</p>
    <p>ti o n</p>
    <p>S L</p>
    <p>H</p>
    <p>Y S</p>
    <p>N B</p>
    <p>IB R</p>
    <p>S</p>
    <p>S T</p>
    <p>IP B</p>
    <p>IB P</p>
    <p>B</p>
    <p>S er</p>
    <p>ia liz</p>
    <p>at io</p>
    <p>n T</p>
    <p>ai n</p>
    <p>t T</p>
    <p>ra ck</p>
    <p>in g</p>
    <p>T im</p>
    <p>er R</p>
    <p>ed u</p>
    <p>ct io</p>
    <p>n S</p>
    <p>lo th</p>
    <p>S S</p>
    <p>B D</p>
    <p>/ S</p>
    <p>S B</p>
    <p>B</p>
    <p>Intel</p>
    <p>Spectre-PHT</p>
    <p>Spectre-BTB</p>
    <p>Spectre-RSB</p>
    <p>Spectre-STL</p>
    <p>ARM</p>
    <p>Spectre-PHT</p>
    <p>Spectre-BTB</p>
    <p>Spectre-RSB</p>
    <p>Spectre-STL</p>
    <p>AMD</p>
    <p>Spectre-PHT</p>
    <p>Spectre-BTB</p>
    <p>Spectre-RSB</p>
    <p>Spectre-STL</p>
    <p>Symbols show if an attack is mitigated ( ), partially mitigated ( ), not mitigated ( ), theoretically</p>
    <p>mitigated ( ), theoretically impeded ( ), not theoretically impeded ( ), or out of scope ( ).</p>
  </div>
  <div class="page">
    <p>Spectre: Defense Analysis www.tugraz.at</p>
    <p>Attack</p>
    <p>Defense</p>
    <p>In vi</p>
    <p>si S</p>
    <p>p ec</p>
    <p>S af</p>
    <p>eS p</p>
    <p>ec D</p>
    <p>A W</p>
    <p>G R</p>
    <p>S B</p>
    <p>S tu</p>
    <p>ffi n</p>
    <p>g R</p>
    <p>et p</p>
    <p>o lin</p>
    <p>e P</p>
    <p>o is</p>
    <p>o n</p>
    <p>V al</p>
    <p>u e</p>
    <p>In d</p>
    <p>ex M</p>
    <p>as k in</p>
    <p>g S</p>
    <p>it e</p>
    <p>Is o la</p>
    <p>ti o n</p>
    <p>S L</p>
    <p>H</p>
    <p>Y S</p>
    <p>N B</p>
    <p>IB R</p>
    <p>S</p>
    <p>S T</p>
    <p>IP B</p>
    <p>IB P</p>
    <p>B</p>
    <p>S er</p>
    <p>ia liz</p>
    <p>at io</p>
    <p>n T</p>
    <p>ai n</p>
    <p>t T</p>
    <p>ra ck</p>
    <p>in g</p>
    <p>T im</p>
    <p>er R</p>
    <p>ed u</p>
    <p>ct io</p>
    <p>n S</p>
    <p>lo th</p>
    <p>S S</p>
    <p>B D</p>
    <p>/ S</p>
    <p>S B</p>
    <p>B</p>
    <p>Intel</p>
    <p>Spectre-PHT</p>
    <p>Spectre-BTB</p>
    <p>Spectre-RSB</p>
    <p>Spectre-STL</p>
    <p>ARM</p>
    <p>Spectre-PHT</p>
    <p>Spectre-BTB</p>
    <p>Spectre-RSB</p>
    <p>Spectre-STL</p>
    <p>AMD</p>
    <p>Spectre-PHT</p>
    <p>Spectre-BTB</p>
    <p>Spectre-RSB</p>
    <p>Spectre-STL</p>
    <p>Symbols show if an attack is mitigated ( ), partially mitigated ( ), not mitigated ( ), theoretically</p>
    <p>mitigated ( ), theoretically impeded ( ), not theoretically impeded ( ), or out of scope ( ).</p>
  </div>
  <div class="page">
    <p>Spectre: Defense Analysis www.tugraz.at</p>
    <p>Attack</p>
    <p>Defense</p>
    <p>In vi</p>
    <p>si S</p>
    <p>p ec</p>
    <p>S af</p>
    <p>eS p</p>
    <p>ec D</p>
    <p>A W</p>
    <p>G R</p>
    <p>S B</p>
    <p>S tu</p>
    <p>ffi n</p>
    <p>g R</p>
    <p>et p</p>
    <p>o lin</p>
    <p>e P</p>
    <p>o is</p>
    <p>o n</p>
    <p>V al</p>
    <p>u e</p>
    <p>In d</p>
    <p>ex M</p>
    <p>as k in</p>
    <p>g S</p>
    <p>it e</p>
    <p>Is o la</p>
    <p>ti o n</p>
    <p>S L</p>
    <p>H</p>
    <p>Y S</p>
    <p>N B</p>
    <p>IB R</p>
    <p>S</p>
    <p>S T</p>
    <p>IP B</p>
    <p>IB P</p>
    <p>B</p>
    <p>S er</p>
    <p>ia liz</p>
    <p>at io</p>
    <p>n T</p>
    <p>ai n</p>
    <p>t T</p>
    <p>ra ck</p>
    <p>in g</p>
    <p>T im</p>
    <p>er R</p>
    <p>ed u</p>
    <p>ct io</p>
    <p>n S</p>
    <p>lo th</p>
    <p>S S</p>
    <p>B D</p>
    <p>/ S</p>
    <p>S B</p>
    <p>B</p>
    <p>Intel</p>
    <p>Spectre-PHT</p>
    <p>Spectre-BTB</p>
    <p>Spectre-RSB</p>
    <p>Spectre-STL</p>
    <p>ARM</p>
    <p>Spectre-PHT</p>
    <p>Spectre-BTB</p>
    <p>Spectre-RSB</p>
    <p>Spectre-STL</p>
    <p>AMD</p>
    <p>Spectre-PHT</p>
    <p>Spectre-BTB</p>
    <p>Spectre-RSB</p>
    <p>Spectre-STL</p>
    <p>Symbols show if an attack is mitigated ( ), partially mitigated ( ), not mitigated ( ), theoretically</p>
    <p>mitigated ( ), theoretically impeded ( ), not theoretically impeded ( ), or out of scope ( ).</p>
  </div>
  <div class="page">
    <p>Spectre: Defense Analysis www.tugraz.at</p>
    <p>Attack</p>
    <p>Defense</p>
    <p>In vi</p>
    <p>si S</p>
    <p>p ec</p>
    <p>S af</p>
    <p>eS p</p>
    <p>ec D</p>
    <p>A W</p>
    <p>G R</p>
    <p>S B</p>
    <p>S tu</p>
    <p>ffi n</p>
    <p>g R</p>
    <p>et p</p>
    <p>o lin</p>
    <p>e P</p>
    <p>o is</p>
    <p>o n</p>
    <p>V al</p>
    <p>u e</p>
    <p>In d</p>
    <p>ex M</p>
    <p>as k in</p>
    <p>g S</p>
    <p>it e</p>
    <p>Is o la</p>
    <p>ti o n</p>
    <p>S L</p>
    <p>H</p>
    <p>Y S</p>
    <p>N B</p>
    <p>IB R</p>
    <p>S</p>
    <p>S T</p>
    <p>IP B</p>
    <p>IB P</p>
    <p>B</p>
    <p>S er</p>
    <p>ia liz</p>
    <p>at io</p>
    <p>n T</p>
    <p>ai n</p>
    <p>t T</p>
    <p>ra ck</p>
    <p>in g</p>
    <p>T im</p>
    <p>er R</p>
    <p>ed u</p>
    <p>ct io</p>
    <p>n S</p>
    <p>lo th</p>
    <p>S S</p>
    <p>B D</p>
    <p>/ S</p>
    <p>S B</p>
    <p>B</p>
    <p>Intel</p>
    <p>Spectre-PHT</p>
    <p>Spectre-BTB</p>
    <p>Spectre-RSB</p>
    <p>Spectre-STL</p>
    <p>ARM</p>
    <p>Spectre-PHT</p>
    <p>Spectre-BTB</p>
    <p>Spectre-RSB</p>
    <p>Spectre-STL</p>
    <p>AMD</p>
    <p>Spectre-PHT</p>
    <p>Spectre-BTB</p>
    <p>Spectre-RSB</p>
    <p>Spectre-STL</p>
    <p>Symbols show if an attack is mitigated ( ), partially mitigated ( ), not mitigated ( ), theoretically</p>
    <p>mitigated ( ), theoretically impeded ( ), not theoretically impeded ( ), or out of scope ( ).</p>
  </div>
  <div class="page">
    <p>Spectre: Defense Analysis www.tugraz.at</p>
    <p>Attack</p>
    <p>Defense</p>
    <p>In vi</p>
    <p>si S</p>
    <p>p ec</p>
    <p>S af</p>
    <p>eS p</p>
    <p>ec D</p>
    <p>A W</p>
    <p>G R</p>
    <p>S B</p>
    <p>S tu</p>
    <p>ffi n</p>
    <p>g R</p>
    <p>et p</p>
    <p>o lin</p>
    <p>e P</p>
    <p>o is</p>
    <p>o n</p>
    <p>V al</p>
    <p>u e</p>
    <p>In d</p>
    <p>ex M</p>
    <p>as k in</p>
    <p>g S</p>
    <p>it e</p>
    <p>Is o la</p>
    <p>ti o n</p>
    <p>S L</p>
    <p>H</p>
    <p>Y S</p>
    <p>N B</p>
    <p>IB R</p>
    <p>S</p>
    <p>S T</p>
    <p>IP B</p>
    <p>IB P</p>
    <p>B</p>
    <p>S er</p>
    <p>ia liz</p>
    <p>at io</p>
    <p>n T</p>
    <p>ai n</p>
    <p>t T</p>
    <p>ra ck</p>
    <p>in g</p>
    <p>T im</p>
    <p>er R</p>
    <p>ed u</p>
    <p>ct io</p>
    <p>n S</p>
    <p>lo th</p>
    <p>S S</p>
    <p>B D</p>
    <p>/ S</p>
    <p>S B</p>
    <p>B</p>
    <p>Intel</p>
    <p>Spectre-PHT</p>
    <p>Spectre-BTB</p>
    <p>Spectre-RSB</p>
    <p>Spectre-STL</p>
    <p>ARM</p>
    <p>Spectre-PHT</p>
    <p>Spectre-BTB</p>
    <p>Spectre-RSB</p>
    <p>Spectre-STL</p>
    <p>AMD</p>
    <p>Spectre-PHT</p>
    <p>Spectre-BTB</p>
    <p>Spectre-RSB</p>
    <p>Spectre-STL</p>
    <p>Symbols show if an attack is mitigated ( ), partially mitigated ( ), not mitigated ( ), theoretically</p>
    <p>mitigated ( ), theoretically impeded ( ), not theoretically impeded ( ), or out of scope ( ).</p>
  </div>
  <div class="page">
    <p>Spectre: Defense Analysis www.tugraz.at</p>
    <p>Attack</p>
    <p>Defense</p>
    <p>In vi</p>
    <p>si S</p>
    <p>p ec</p>
    <p>S af</p>
    <p>eS p</p>
    <p>ec D</p>
    <p>A W</p>
    <p>G R</p>
    <p>S B</p>
    <p>S tu</p>
    <p>ffi n</p>
    <p>g R</p>
    <p>et p</p>
    <p>o lin</p>
    <p>e P</p>
    <p>o is</p>
    <p>o n</p>
    <p>V al</p>
    <p>u e</p>
    <p>In d</p>
    <p>ex M</p>
    <p>as k in</p>
    <p>g S</p>
    <p>it e</p>
    <p>Is o la</p>
    <p>ti o n</p>
    <p>S L</p>
    <p>H</p>
    <p>Y S</p>
    <p>N B</p>
    <p>IB R</p>
    <p>S</p>
    <p>S T</p>
    <p>IP B</p>
    <p>IB P</p>
    <p>B</p>
    <p>S er</p>
    <p>ia liz</p>
    <p>at io</p>
    <p>n T</p>
    <p>ai n</p>
    <p>t T</p>
    <p>ra ck</p>
    <p>in g</p>
    <p>T im</p>
    <p>er R</p>
    <p>ed u</p>
    <p>ct io</p>
    <p>n S</p>
    <p>lo th</p>
    <p>S S</p>
    <p>B D</p>
    <p>/ S</p>
    <p>S B</p>
    <p>B</p>
    <p>Intel</p>
    <p>Spectre-PHT</p>
    <p>Spectre-BTB</p>
    <p>Spectre-RSB</p>
    <p>Spectre-STL</p>
    <p>ARM</p>
    <p>Spectre-PHT</p>
    <p>Spectre-BTB</p>
    <p>Spectre-RSB</p>
    <p>Spectre-STL</p>
    <p>AMD</p>
    <p>Spectre-PHT</p>
    <p>Spectre-BTB</p>
    <p>Spectre-RSB</p>
    <p>Spectre-STL</p>
    <p>Symbols show if an attack is mitigated ( ), partially mitigated ( ), not mitigated ( ), theoretically</p>
    <p>mitigated ( ), theoretically impeded ( ), not theoretically impeded ( ), or out of scope ( ).</p>
  </div>
  <div class="page">
    <p>Spectre: Defense Analysis www.tugraz.at</p>
    <p>Attack</p>
    <p>Defense</p>
    <p>In vi</p>
    <p>si S</p>
    <p>p ec</p>
    <p>S af</p>
    <p>eS p</p>
    <p>ec D</p>
    <p>A W</p>
    <p>G R</p>
    <p>S B</p>
    <p>S tu</p>
    <p>ffi n</p>
    <p>g R</p>
    <p>et p</p>
    <p>o lin</p>
    <p>e P</p>
    <p>o is</p>
    <p>o n</p>
    <p>V al</p>
    <p>u e</p>
    <p>In d</p>
    <p>ex M</p>
    <p>as k in</p>
    <p>g S</p>
    <p>it e</p>
    <p>Is o la</p>
    <p>ti o n</p>
    <p>S L</p>
    <p>H</p>
    <p>Y S</p>
    <p>N B</p>
    <p>IB R</p>
    <p>S</p>
    <p>S T</p>
    <p>IP B</p>
    <p>IB P</p>
    <p>B</p>
    <p>S er</p>
    <p>ia liz</p>
    <p>at io</p>
    <p>n T</p>
    <p>ai n</p>
    <p>t T</p>
    <p>ra ck</p>
    <p>in g</p>
    <p>T im</p>
    <p>er R</p>
    <p>ed u</p>
    <p>ct io</p>
    <p>n S</p>
    <p>lo th</p>
    <p>S S</p>
    <p>B D</p>
    <p>/ S</p>
    <p>S B</p>
    <p>B</p>
    <p>Intel</p>
    <p>Spectre-PHT</p>
    <p>Spectre-BTB</p>
    <p>Spectre-RSB</p>
    <p>Spectre-STL</p>
    <p>ARM</p>
    <p>Spectre-PHT</p>
    <p>Spectre-BTB</p>
    <p>Spectre-RSB</p>
    <p>Spectre-STL</p>
    <p>AMD</p>
    <p>Spectre-PHT</p>
    <p>Spectre-BTB</p>
    <p>Spectre-RSB</p>
    <p>Spectre-STL</p>
    <p>Symbols show if an attack is mitigated ( ), partially mitigated ( ), not mitigated ( ), theoretically</p>
    <p>mitigated ( ), theoretically impeded ( ), not theoretically impeded ( ), or out of scope ( ).</p>
  </div>
  <div class="page">
    <p>Spectre: Defense Analysis www.tugraz.at</p>
    <p>Attack</p>
    <p>Defense</p>
    <p>In vi</p>
    <p>si S</p>
    <p>p ec</p>
    <p>S af</p>
    <p>eS p</p>
    <p>ec D</p>
    <p>A W</p>
    <p>G R</p>
    <p>S B</p>
    <p>S tu</p>
    <p>ffi n</p>
    <p>g R</p>
    <p>et p</p>
    <p>o lin</p>
    <p>e P</p>
    <p>o is</p>
    <p>o n</p>
    <p>V al</p>
    <p>u e</p>
    <p>In d</p>
    <p>ex M</p>
    <p>as k in</p>
    <p>g S</p>
    <p>it e</p>
    <p>Is o la</p>
    <p>ti o n</p>
    <p>S L</p>
    <p>H</p>
    <p>Y S</p>
    <p>N B</p>
    <p>IB R</p>
    <p>S</p>
    <p>S T</p>
    <p>IP B</p>
    <p>IB P</p>
    <p>B</p>
    <p>S er</p>
    <p>ia liz</p>
    <p>at io</p>
    <p>n T</p>
    <p>ai n</p>
    <p>t T</p>
    <p>ra ck</p>
    <p>in g</p>
    <p>T im</p>
    <p>er R</p>
    <p>ed u</p>
    <p>ct io</p>
    <p>n S</p>
    <p>lo th</p>
    <p>S S</p>
    <p>B D</p>
    <p>/ S</p>
    <p>S B</p>
    <p>B</p>
    <p>Intel</p>
    <p>Spectre-PHT</p>
    <p>Spectre-BTB</p>
    <p>Spectre-RSB</p>
    <p>Spectre-STL</p>
    <p>ARM</p>
    <p>Spectre-PHT</p>
    <p>Spectre-BTB</p>
    <p>Spectre-RSB</p>
    <p>Spectre-STL</p>
    <p>AMD</p>
    <p>Spectre-PHT</p>
    <p>Spectre-BTB</p>
    <p>Spectre-RSB</p>
    <p>Spectre-STL</p>
    <p>Symbols show if an attack is mitigated ( ), partially mitigated ( ), not mitigated ( ), theoretically</p>
    <p>mitigated ( ), theoretically impeded ( ), not theoretically impeded ( ), or out of scope ( ).</p>
  </div>
  <div class="page">
    <p>Spectre Mitigating: Performance www.tugraz.at</p>
    <p>Defense Evaluation Penalty Benchmark</p>
    <p>KAISER/KPTI 02.6 % System call rates</p>
    <p>Retpoline 510 % Real-world workload servers</p>
    <p>Site Isolation 1013 % Memory overhead</p>
    <p>InvisiSpec 22 % SPEC</p>
    <p>SafeSpec -3 % SPEC on MARSSx86</p>
    <p>DAWG 115 % PARSEC , GAPBS</p>
    <p>SLH 2936.4 % Google microbenchmark suite</p>
    <p>YSNB 60 % Phoenix</p>
    <p>IBRS 2030 % Sysbench 1.0.11</p>
    <p>STIBP 3050 % Rodinia OpenMP, DaCapo</p>
    <p>Serialization 6274.8 % Google microbenchmark suite</p>
    <p>SSBD/SSBB 28 % SYSmark 2018, SPEC integer</p>
    <p>L1TF Mitigations -331 % SPEC</p>
  </div>
  <div class="page">
    <p>Spectre: Linux Kernel Gadget Prevalence www.tugraz.at</p>
    <p>Gadget Example (Spectre-PHT) #Occurrences</p>
    <p>Prefetch if(i&lt;LEN A){a[i];} 172 Compare if(i&lt;LEN A){if(a[i]==k){};} 127 Index if(i&lt;LEN A){y = b[a[i]*x];} 0 Execute if(i&lt;LEN A){a[i](void);} 16</p>
  </div>
  <div class="page">
    <p>Proof-of-Concept www.tugraz.at</p>
    <p>You can find our proof-of-concept implementation and classification</p>
    <p>tree on:</p>
    <p>https://github.com/IAIK/transientfail  http://transient.fail/</p>
  </div>
  <div class="page">
    <p>Recap www.tugraz.at</p>
    <p>Introduced a new naming scheme</p>
    <p>Discovered new attack variants  Showed that defenses cost too much performance for little effect  Showed prevalence of gadgets in Linux kernel</p>
  </div>
  <div class="page">
    <p>Recap www.tugraz.at</p>
    <p>Introduced a new naming scheme  Discovered new attack variants</p>
    <p>Showed that defenses cost too much performance for little effect  Showed prevalence of gadgets in Linux kernel</p>
  </div>
  <div class="page">
    <p>Recap www.tugraz.at</p>
    <p>Introduced a new naming scheme  Discovered new attack variants  Showed that defenses cost too much performance for little effect</p>
    <p>Showed prevalence of gadgets in Linux kernel</p>
  </div>
  <div class="page">
    <p>Recap www.tugraz.at</p>
    <p>Introduced a new naming scheme  Discovered new attack variants  Showed that defenses cost too much performance for little effect  Showed prevalence of gadgets in Linux kernel</p>
  </div>
  <div class="page">
    <p>Conclusion www.tugraz.at</p>
    <p>Transient Execution Attacks are...</p>
    <p>...a novel class of attacks  ...extremely powerful  ...only at the beginning</p>
    <p>Many optimizations introduce side channels  now exploitable</p>
  </div>
  <div class="page">
    <p>Conclusion www.tugraz.at</p>
    <p>Transient Execution Attacks are...  ...a novel class of attacks</p>
    <p>...extremely powerful  ...only at the beginning</p>
    <p>Many optimizations introduce side channels  now exploitable</p>
  </div>
  <div class="page">
    <p>Conclusion www.tugraz.at</p>
    <p>Transient Execution Attacks are...  ...a novel class of attacks  ...extremely powerful</p>
    <p>...only at the beginning</p>
    <p>Many optimizations introduce side channels  now exploitable</p>
  </div>
  <div class="page">
    <p>Conclusion www.tugraz.at</p>
    <p>Transient Execution Attacks are...  ...a novel class of attacks  ...extremely powerful  ...only at the beginning</p>
    <p>Many optimizations introduce side channels  now exploitable</p>
  </div>
  <div class="page">
    <p>Conclusion www.tugraz.at</p>
    <p>Transient Execution Attacks are...  ...a novel class of attacks  ...extremely powerful  ...only at the beginning</p>
    <p>Many optimizations introduce side channels  now exploitable</p>
  </div>
  <div class="page">
    <p>A Systematic Evaluation of Transient Execution</p>
    <p>Attacks and Defenses</p>
    <p>Claudio Canella (@cc0x1f)1, Jo Van Bulck2, Michael Schwarz1, Moritz Lipp1, Benjamin</p>
    <p>von Berg1, Philipp Ortner1, Frank Piessens2, Dmitry Evtyushkin, Daniel Gruss1</p>
    <p>August 14, 2019</p>
  </div>
  <div class="page">
    <p>Acknowledgments www.tugraz.at</p>
    <p>We want to thank our shepherd, Jonathan McCune, for his helpful comments and suggestions that</p>
    <p>substantially helped in improving the paper. This work has been supported by the Austrian Research</p>
    <p>Promotion Agency (FFG) via the K-project DeSSnet, which is funded in the context of COMET</p>
    <p>Competence Centers for Excellent Technologies by BMVIT, BMWFW, Styria and Carinthia. This work</p>
    <p>has been supported by the Austrian Research Promotion Agency (FFG) via the project ESPRESSO,</p>
    <p>which is funded by the province of Styria and the Business Promotion Agencies of Styria and Carinthia.</p>
    <p>This project has received funding from the European Research Council (ERC) under the European</p>
    <p>Unions Horizon 2020 research and innovation programme (grant agreement No 681402). This</p>
    <p>research received funding from the Research Fund KU Leuven, and Jo Van Bulck is supported by the</p>
    <p>Research Foundation  Flanders (FWO). Evtyushkin acknowledges the start-up grant from the College</p>
    <p>of William and Mary. Additional funding was provided by generous gifts from ARM and Intel. Any</p>
    <p>opinions, findings, and conclusions or recommendations expressed in this paper are those of the authors</p>
    <p>and do not necessarily reflect the views of the funding parties.</p>
  </div>
</Presentation>
