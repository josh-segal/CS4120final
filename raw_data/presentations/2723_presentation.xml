<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Jonathan Perry, Hari Balakrishnan and Devavrat Shah</p>
    <p>Flowtune</p>
    <p>Flowlet Control for</p>
    <p>Datacenter Networks</p>
  </div>
  <div class="page">
    <p>Software in the Datacenter</p>
  </div>
  <div class="page">
    <p>Response Time: Productivity, Revenue, Reputation</p>
    <p>microservices  develop  network is central deploy scale</p>
    <p>Software in the Datacenter</p>
  </div>
  <div class="page">
    <p>Traditional approach is packet-centric</p>
    <p>Switch Mechanisms</p>
    <p>Server Mechanisms</p>
    <p>Implicit Allocation</p>
    <p>Several RTT to converge</p>
    <p>Changes many components</p>
  </div>
  <div class="page">
    <p>Implicit Allocation</p>
    <p>Several RTT to converge</p>
    <p>Changes many components</p>
    <p>Allocate network resources  Explicitly (maximize utility)</p>
    <p>Quickly, Consitently</p>
    <p>Flexibly (in software)</p>
  </div>
  <div class="page">
    <p>Flowtunes approach</p>
    <p>send()  flowlet</p>
  </div>
  <div class="page">
    <p>Example</p>
    <p>AB</p>
    <p>Allocator</p>
    <p>R2R1</p>
    <p>C</p>
    <p>Hadoop on Server A has data for B:</p>
  </div>
  <div class="page">
    <p>Example</p>
    <p>A  Allocator Hadoop on A has data for B</p>
    <p>AB</p>
    <p>Allocator</p>
    <p>R2R1</p>
    <p>C</p>
    <p>Hadoop on Server A has data for B:</p>
  </div>
  <div class="page">
    <p>Example</p>
    <p>A  Allocator Hadoop on A has data for B</p>
    <p>Allocator Assign rates</p>
    <p>AB</p>
    <p>Allocator</p>
    <p>R2R1</p>
    <p>C</p>
    <p>Hadoop on Server A has data for B:</p>
  </div>
  <div class="page">
    <p>Example</p>
    <p>A  Allocator Hadoop on A has data for B</p>
    <p>Allocator Assign rates</p>
    <p>Allocator  A Send at 40Gbps</p>
    <p>AB</p>
    <p>Allocator</p>
    <p>R2R1</p>
    <p>C</p>
    <p>Hadoop on Server A has data for B:</p>
  </div>
  <div class="page">
    <p>Example</p>
    <p>Now say ad_server on Server C has data for B:</p>
    <p>AB</p>
    <p>Allocator</p>
    <p>R2R1</p>
    <p>C</p>
  </div>
  <div class="page">
    <p>Example</p>
    <p>Now say ad_server on Server C has data for B:</p>
    <p>C  Allocator ad_server on C has data for B</p>
    <p>AB</p>
    <p>Allocator</p>
    <p>R2R1</p>
    <p>C</p>
  </div>
  <div class="page">
    <p>Example</p>
    <p>Now say ad_server on Server C has data for B:</p>
    <p>C  Allocator ad_server on C has data for B</p>
    <p>Allocator Assign rates</p>
    <p>AB</p>
    <p>Allocator</p>
    <p>R2R1</p>
    <p>C</p>
  </div>
  <div class="page">
    <p>Example</p>
    <p>Now say ad_server on Server C has data for B:</p>
    <p>C  Allocator ad_server on C has data for B</p>
    <p>Allocator Assign rates</p>
    <p>Allocator  A Send at 5Gbps</p>
    <p>Allocator  C Send at 35Gbps</p>
    <p>AB</p>
    <p>Allocator</p>
    <p>R2R1</p>
    <p>C</p>
  </div>
  <div class="page">
    <p>Hadoop flowlet rate 2x  $0.05 Ads flowlet rate 2x  $0.20</p>
    <p>Network Utility Maximization (NUM)</p>
    <p>Ads flowlet:Hadoop flowlet:</p>
    <p>Kelly et al., Journal of the Operational Research Society, 1998</p>
  </div>
  <div class="page">
    <p>NUM Iterative Optimizer</p>
    <p>- =</p>
    <p>SupplyDemand</p>
    <p>flow rates on   link capacity</p>
  </div>
  <div class="page">
    <p>Adjusting prices</p>
  </div>
  <div class="page">
    <p>Adjusting prices</p>
    <p>Newton Exact</p>
    <p>Diagonal (NED)</p>
  </div>
  <div class="page">
    <p>Increasing responsiveness</p>
    <p>Solution 1: Update inputs</p>
    <p>Run 100 iterations</p>
    <p>Output rates</p>
    <p>But: too slow!</p>
  </div>
  <div class="page">
    <p>Increasing responsiveness</p>
    <p>Solution 1:</p>
    <p>Solution 2:</p>
    <p>Update inputs</p>
    <p>Run 100 iterations</p>
    <p>Output rates</p>
    <p>But: too slow!</p>
    <p>Update inputs</p>
    <p>Run 1 iteration</p>
    <p>Output rates</p>
    <p>$0.01 $0.05 $0.09</p>
  </div>
  <div class="page">
    <p>Increasing responsiveness</p>
    <p>Solution 1:</p>
    <p>Solution 2:</p>
    <p>Update inputs</p>
    <p>Run 100 iterations</p>
    <p>Output rates</p>
    <p>But: too slow!</p>
    <p>But: queueing, packet drops!</p>
    <p>Update inputs</p>
    <p>Run 1 iteration</p>
    <p>Output rates</p>
  </div>
  <div class="page">
    <p>Increasing responsiveness</p>
    <p>Solution 1:</p>
    <p>Solution 2:</p>
    <p>Solution 3:</p>
    <p>Update inputs</p>
    <p>Run 100 iterations</p>
    <p>Output rates</p>
    <p>But: too slow!</p>
    <p>But: queueing, packet drops!</p>
    <p>Update inputs</p>
    <p>Run 1 iteration</p>
    <p>Output rates</p>
    <p>Update inputs</p>
    <p>Run 1 iteration</p>
    <p>Normalize rates</p>
    <p>Output rates</p>
  </div>
  <div class="page">
    <p>Flowtune normalizes rates</p>
  </div>
  <div class="page">
    <p>Flowtune normalizes rates</p>
    <p>= allocation</p>
    <p>capacity</p>
  </div>
  <div class="page">
    <p>Flowtune normalizes rates</p>
    <p>=</p>
    <p>max</p>
    <p>= allocation</p>
    <p>capacity</p>
  </div>
  <div class="page">
    <p>Flowtune normalizes rates</p>
    <p>throughput</p>
    <p>=</p>
    <p>max</p>
    <p>= allocation</p>
    <p>capacity</p>
  </div>
  <div class="page">
    <p>Architecture</p>
    <p>Endpoints</p>
    <p>Optimizer</p>
    <p>Normalizer</p>
    <p>rates</p>
    <p>flowlet start/end</p>
    <p>normalized rates</p>
    <p>Allocator</p>
  </div>
  <div class="page">
    <p>Multicore</p>
    <p>Core 1: 1 2 3 4</p>
    <p>Core 2: 5 6 7 8 1 2 3 4</p>
  </div>
  <div class="page">
    <p>Multicore</p>
    <p>Core 1: 1 2 3 4</p>
    <p>Core 2: 5 6 7 8 1 2 3 4</p>
  </div>
  <div class="page">
    <p>Multicore</p>
    <p>Core 1: 1 2 3 4</p>
    <p>Core 2: 5 6 7 8 1 2 3 4</p>
  </div>
  <div class="page">
    <p>Multicore</p>
    <p>For each flow  compute (links  traverses)</p>
    <p>For each link  compute (flows on )</p>
    <p>Core 1: 1 2 3 4</p>
    <p>Core 2: 5 6 7 8 1 2 3 4</p>
  </div>
  <div class="page">
    <p>S o u rce</p>
    <p>B lo</p>
    <p>ck 1</p>
    <p>core</p>
    <p>B lo</p>
    <p>ck 2</p>
    <p>core</p>
    <p>B lo</p>
    <p>ck 3</p>
    <p>core</p>
    <p>B lo</p>
    <p>ck 4</p>
    <p>core</p>
    <p>Destination</p>
    <p>Block 1 Block 2 Block 3 Block 4</p>
    <p>Multicore</p>
  </div>
  <div class="page">
    <p>S o</p>
    <p>u rce</p>
    <p>B lo</p>
    <p>ck 1</p>
    <p>core</p>
    <p>B lo</p>
    <p>ck 2</p>
    <p>core</p>
    <p>B lo</p>
    <p>ck 3</p>
    <p>core</p>
    <p>B lo</p>
    <p>ck 4</p>
    <p>core</p>
    <p>Destination</p>
    <p>Block 1 Block 2 Block 3 Block 4</p>
    <p>Multicore</p>
  </div>
  <div class="page">
    <p>S o</p>
    <p>u rce</p>
    <p>B lo</p>
    <p>ck 1</p>
    <p>core</p>
    <p>B lo</p>
    <p>ck 2</p>
    <p>core</p>
    <p>B lo</p>
    <p>ck 3</p>
    <p>core</p>
    <p>B lo</p>
    <p>ck 4</p>
    <p>core</p>
    <p>Destination</p>
    <p>Block 1 Block 2 Block 3 Block 4</p>
    <p>Multicore</p>
  </div>
  <div class="page">
    <p>S o</p>
    <p>u rce</p>
    <p>B lo</p>
    <p>ck 1</p>
    <p>core</p>
    <p>B lo</p>
    <p>ck 2</p>
    <p>core</p>
    <p>B lo</p>
    <p>ck 3</p>
    <p>core</p>
    <p>B lo</p>
    <p>ck 4</p>
    <p>core</p>
    <p>Destination</p>
    <p>Block 1 Block 2 Block 3 Block 4</p>
    <p>Multicore</p>
  </div>
  <div class="page">
    <p>S o</p>
    <p>u rce</p>
    <p>B lo</p>
    <p>ck 1</p>
    <p>core</p>
    <p>B lo</p>
    <p>ck 2</p>
    <p>core</p>
    <p>B lo</p>
    <p>ck 3</p>
    <p>core</p>
    <p>B lo</p>
    <p>ck 4</p>
    <p>core</p>
    <p>Destination</p>
    <p>Block 1 Block 2 Block 3 Block 4</p>
    <p>Multicore</p>
  </div>
  <div class="page">
    <p>S o</p>
    <p>u rce</p>
    <p>B lo</p>
    <p>ck 1</p>
    <p>core</p>
    <p>B lo</p>
    <p>ck 2</p>
    <p>core</p>
    <p>B lo</p>
    <p>ck 3</p>
    <p>core</p>
    <p>B lo</p>
    <p>ck 4</p>
    <p>core</p>
    <p>Destination</p>
    <p>Block 1 Block 2 Block 3 Block 4</p>
    <p>Multicore</p>
  </div>
  <div class="page">
    <p>S o</p>
    <p>u rce</p>
    <p>B lo</p>
    <p>ck 1</p>
    <p>core</p>
    <p>B lo</p>
    <p>ck 2</p>
    <p>core</p>
    <p>B lo</p>
    <p>ck 3</p>
    <p>core</p>
    <p>B lo</p>
    <p>ck 4</p>
    <p>core</p>
    <p>Destination</p>
    <p>Block 1 Block 2 Block 3 Block 4</p>
    <p>Multicore</p>
  </div>
  <div class="page">
    <p>S o</p>
    <p>u rce</p>
    <p>B lo</p>
    <p>ck 1</p>
    <p>core</p>
    <p>B lo</p>
    <p>ck 2</p>
    <p>core</p>
    <p>B lo</p>
    <p>ck 3</p>
    <p>core</p>
    <p>B lo</p>
    <p>ck 4</p>
    <p>core</p>
    <p>Destination</p>
    <p>Block 1 Block 2 Block 3 Block 4</p>
    <p>Multicore</p>
  </div>
  <div class="page">
    <p>S o</p>
    <p>u rce</p>
    <p>B lo</p>
    <p>ck 1</p>
    <p>core</p>
    <p>B lo</p>
    <p>ck 2</p>
    <p>core</p>
    <p>B lo</p>
    <p>ck 3</p>
    <p>core</p>
    <p>B lo</p>
    <p>ck 4</p>
    <p>core</p>
    <p>Destination</p>
    <p>Block 1 Block 2 Block 3 Block 4</p>
    <p>Multicore</p>
  </div>
  <div class="page">
    <p>S o</p>
    <p>u rce</p>
    <p>B lo</p>
    <p>ck 1</p>
    <p>core</p>
    <p>B lo</p>
    <p>ck 2</p>
    <p>core</p>
    <p>B lo</p>
    <p>ck 3</p>
    <p>core</p>
    <p>B lo</p>
    <p>ck 4</p>
    <p>core</p>
    <p>Destination</p>
    <p>Block 1 Block 2 Block 3 Block 4</p>
    <p>Multicore</p>
  </div>
  <div class="page">
    <p>S o</p>
    <p>u rce</p>
    <p>B lo</p>
    <p>ck 1</p>
    <p>core</p>
    <p>B lo</p>
    <p>ck 2</p>
    <p>core</p>
    <p>B lo</p>
    <p>ck 3</p>
    <p>core</p>
    <p>B lo</p>
    <p>ck 4</p>
    <p>core</p>
    <p>Destination</p>
    <p>Block 1 Block 2 Block 3 Block 4</p>
    <p>Multicore</p>
  </div>
  <div class="page">
    <p>S o</p>
    <p>u rce</p>
    <p>B lo</p>
    <p>ck 1</p>
    <p>core</p>
    <p>B lo</p>
    <p>ck 2</p>
    <p>core</p>
    <p>B lo</p>
    <p>ck 3</p>
    <p>core</p>
    <p>B lo</p>
    <p>ck 4</p>
    <p>core</p>
    <p>Destination</p>
    <p>Block 1 Block 2 Block 3 Block 4</p>
    <p>Multicore</p>
  </div>
  <div class="page">
    <p>In the paper</p>
    <p>core</p>
    <p>core</p>
    <p>core</p>
    <p>core</p>
    <p>core</p>
    <p>core</p>
    <p>core</p>
    <p>core</p>
    <p>core</p>
    <p>core</p>
    <p>core</p>
    <p>Flow view Link view</p>
  </div>
  <div class="page">
    <p>Communication</p>
    <p>&gt; 1</p>
  </div>
  <div class="page">
    <p>EC2: Resource Allocation</p>
    <p>senders</p>
    <p>receiver</p>
  </div>
  <div class="page">
    <p>Ns-2: Flowtune converges quickly to a fair allocation</p>
    <p>Every 10 milliseconds:</p>
    <p>senders</p>
    <p>receiver</p>
  </div>
  <div class="page">
    <p>Overhead is low F</p>
    <p>ra ct</p>
    <p>io n</p>
    <p>o f</p>
    <p>n e</p>
    <p>tw o</p>
    <p>rk c</p>
    <p>a p</p>
    <p>a ci</p>
    <p>ty</p>
    <p>Inside the Social Networks (Datacenter) Network, Roy et al., SIGCOMM15</p>
  </div>
  <div class="page">
    <p>Open Questions</p>
    <p>Handling mice  Bypass the allocator? Fastpass?</p>
    <p>External traffic  Measure &amp; react?</p>
    <p>Deadlines, Co-flow  Market?</p>
    <p>Multicore: 3-tier Clos, WAN</p>
  </div>
  <div class="page">
    <p>Flowtune</p>
    <p>Give application developers control over network transport</p>
    <p>Explicit Policy Application</p>
    <p>Developers Network Engineers</p>
  </div>
</Presentation>
