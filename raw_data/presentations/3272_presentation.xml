<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>EvilCohort: Detecting Communities of Malicious Accounts on</p>
    <p>Online Services</p>
    <p>Gianluca Stringhini1, Pierre Mourlanne2, Gregoire Jacob3,</p>
    <p>Manuel Egele4, Christopher Kruegel2,3, and Giovanni Vigna2,3</p>
    <p>University College London1 UC Santa Barbara2 Lastline Inc. 3 Boston University4</p>
  </div>
  <div class="page">
    <p>Online services are abused by cybercriminals</p>
    <p>EvilCohort: Detecting Communities of Malicious Accounts on Online Services 2</p>
    <p>Spam  Crawling sensitive information / documents  Storing illegal content  Running DoS attacks / hosting C&amp;C servers</p>
  </div>
  <div class="page">
    <p>State of the art in malicious account detection Current techniques leverage domain-specific elements to detect malicious activity on one type of service</p>
    <p>Examples:</p>
    <p>Forums [Niu2007]</p>
    <p>Blogs [Thomason2007]</p>
    <p>Youtube [Benevenuto2009]</p>
    <p>Social Networks [Mittal2009], [Grier2010], [Stringhini2010]</p>
    <p>Webmail accounts [Taylor2006], [Stringhini2015]</p>
    <p>EvilCohort: Detecting Communities of Malicious Accounts on Online Services 3</p>
    <p>There are elements that are common to malicious activity on all online services!</p>
  </div>
  <div class="page">
    <p>Botnets accessing online accounts</p>
    <p>EvilCohort: Detecting Communities of Malicious Accounts on Online Services 4</p>
    <p>Performance reasons  Resilience reasons</p>
    <p>Communities of accounts</p>
  </div>
  <div class="page">
    <p>Advantages of community detection</p>
    <p>EvilCohort: Detecting Communities of Malicious Accounts on Online Services 5</p>
    <p>Service-agnostic Can be done on any service that uses accounts</p>
    <p>Activity-agnostic We only look at how accounts are accessed</p>
    <p>Different types of cybercriminal operations  Crawl the online service  Use the service as C&amp;C channel  Use the service as a drop service</p>
  </div>
  <div class="page">
    <p>Distributed access is prevalent</p>
    <p>Web-based email service logs, 1 day period</p>
    <p>66k accounts accessed by a single IP address</p>
    <p>104k accounts accessed by multiple IP addresses</p>
    <p>Just looking at accounts that are accessed by many IP addresses does not work (32% FPs for accounts accessed by 10+ IPs)</p>
    <p>EvilCohort: Detecting Communities of Malicious Accounts on Online Services 6</p>
  </div>
  <div class="page">
    <p>Our system: EvilCohort</p>
    <p>Phase I: data collection</p>
    <p>Phase II: building the graph representation</p>
    <p>Phase III: finding communities</p>
    <p>Phase IV (optional): characterizing communities</p>
    <p>EvilCohort: Detecting Communities of Malicious Accounts on Online Services 7</p>
  </div>
  <div class="page">
    <p>Phase I: data collection</p>
    <p>EvilCohort: Detecting Communities of Malicious Accounts on Online Services 8</p>
    <p>Timestamp_1, IP_address_1, Account_1 Timestamp_2, IP_address_2, Account_2 Timestamp_3, IP_address_3, Account_3 Timestamp_4, IP_address_4, Account_1</p>
  </div>
  <div class="page">
    <p>Phase II: building graph representation</p>
    <p>EvilCohort: Detecting Communities of Malicious Accounts on Online Services 9</p>
    <p>Vertices are online accounts  Edges weight is number of shared IP addresses</p>
  </div>
  <div class="page">
    <p>Phase III: finding communities</p>
    <p>We apply the ``Louvain method for clustering:</p>
    <p>Iterative method</p>
    <p>Based on modularity optimization</p>
    <p>We can prune edges with low weight to improve precision (threshold s)</p>
    <p>EvilCohort: Detecting Communities of Malicious Accounts on Online Services 10</p>
  </div>
  <div class="page">
    <p>Phase IV (optional): characterizing communities</p>
    <p>User agent correlation</p>
    <p>Event-based time series</p>
    <p>IP address and account usage</p>
    <p>These filters can be used to further prune false positives</p>
    <p>EvilCohort: Detecting Communities of Malicious Accounts on Online Services 11</p>
  </div>
  <div class="page">
    <p>s = 65 1,331 accounts</p>
    <p>Grown knowledge: 84 accounts (~0.08%)</p>
    <p>s = 10 25,490 accounts</p>
    <p>Grown knowledge: 8,864 accounts (~7.7%)</p>
    <p>s = 5 77,910 accounts</p>
    <p>Grown knowledge: 26,042 accounts (~25%)Grown knowledge: 40,728 accounts (~39%)</p>
    <p>s = 2 135,602 accounts</p>
    <p>Selection of s Ground truth: 103k spam accounts accessed by 2+ IPs</p>
    <p>False positive if  10% of the accounts sent spam</p>
    <p>EvilCohort: Detecting Communities of Malicious Accounts on Online Services 12</p>
    <p>We decided to set s to 10 for our experiments</p>
  </div>
  <div class="page">
    <p>Results in the wild</p>
    <p>Webmail activity dataset: email events</p>
    <p>EvilCohort: Detecting Communities of Malicious Accounts on Online Services 13</p>
    <p>Online social network dataset: login events</p>
  </div>
  <div class="page">
    <p>Analysis of the results</p>
    <p>EvilCohort: Detecting Communities of Malicious Accounts on Online Services 14</p>
    <p>Very small communities (&lt; 8 accounts)</p>
    <p>Huge community (5,272 accounts)</p>
    <p>What is Charlie?</p>
    <p>Charlie</p>
  </div>
  <div class="page">
    <p>Event-based time series</p>
    <p>EvilCohort: Detecting Communities of Malicious Accounts on Online Services 15</p>
    <p>Regular accounts show diurnal patterns</p>
    <p>Malicious accounts show bursts in activity</p>
    <p>Charlie shows a weird behavior</p>
  </div>
  <div class="page">
    <p>Account usage over time</p>
    <p>EvilCohort: Detecting Communities of Malicious Accounts on Online Services 16</p>
    <p>Legitimate accounts: still diurnal patterns</p>
    <p>Malicious accounts: synchronized access</p>
    <p>Charlie: regular + synchronized access</p>
    <p>We conclude that Charlie is likely composed of compromised accounts</p>
  </div>
  <div class="page">
    <p>EvilCohort: discussion</p>
    <p>Service and activity independent Accounts do not need to perform malicious activity to be detected</p>
    <p>EvilCohort: Detecting Communities of Malicious Accounts on Online Services 17</p>
    <p>Limitations  Only works on accounts accessed by multiple IP addresses  Does not distinguish between fake and compromised accounts</p>
    <p>Our system detects botnet-like activity, legitimate accounts are unlikely to form communities</p>
  </div>
  <div class="page">
    <p>Conclusions</p>
    <p>I presented EvilCohort, a system that detects malicious accounts on online services by identifying communities of accounts that are accessed by a common set of IP addresses</p>
    <p>We ran EvilCohort on two real-world datasets, and detected more than one million malicious accounts</p>
    <p>EvilCohort: Detecting Communities of Malicious Accounts on Online Services 18</p>
  </div>
  <div class="page">
    <p>Questions? g.stringhini@ucl.ac.uk</p>
    <p>@gianluca_string</p>
  </div>
</Presentation>
