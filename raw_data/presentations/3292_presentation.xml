<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Tracing Information Flows Between Ad Exchanges Using Retargeted Ads</p>
    <p>Muhammad Ahmad Bashir, Sajjad Arshad, William Robertson, Christo Wilson</p>
    <p>Northeastern University</p>
  </div>
  <div class="page">
    <p>Your Privacy Footprint</p>
  </div>
  <div class="page">
    <p>Your Privacy Footprint</p>
  </div>
  <div class="page">
    <p>Your Privacy Footprint</p>
  </div>
  <div class="page">
    <p>Your Privacy Footprint</p>
  </div>
  <div class="page">
    <p>Your Privacy Footprint</p>
  </div>
  <div class="page">
    <p>Your Privacy Footprint</p>
  </div>
  <div class="page">
    <p>Real Time Bidding</p>
  </div>
  <div class="page">
    <p>Real Time Bidding</p>
    <p>RTB brings more flexibility in the ad ecosystem.  Ad request managed by an Ad Exchange which holds an auction.</p>
    <p>Advertisers bid on each ad impression.</p>
  </div>
  <div class="page">
    <p>Real Time Bidding</p>
    <p>RTB brings more flexibility in the ad ecosystem.  Ad request managed by an Ad Exchange which holds an auction.</p>
    <p>Advertisers bid on each ad impression.</p>
    <p>Exchange Advertiser</p>
    <p>Cookie matching is a prerequisite.</p>
  </div>
  <div class="page">
    <p>Real Time Bidding</p>
    <p>RTB brings more flexibility in the ad ecosystem.  Ad request managed by an Ad Exchange which holds an auction.</p>
    <p>Advertisers bid on each ad impression.</p>
    <p>RTB spending to cross $20B by 2017[1].  49% annual growth.</p>
    <p>Will account for 80% of US Display Ad spending by 2022.</p>
    <p>[1] http://www.prnewswire.com/news-releases/new-idc-study-shows-real-time-bidding-rtb-display-adspend-to-grow-worldwide-to-208-billion-by-2017-228061051.html</p>
    <p>Exchange Advertiser</p>
    <p>Cookie matching is a prerequisite.</p>
  </div>
  <div class="page">
    <p>User Publisher Ad Exchange Advertisers</p>
  </div>
  <div class="page">
    <p>GET, CNNs Cookie</p>
    <p>User Publisher Ad Exchange Advertisers</p>
  </div>
  <div class="page">
    <p>GET, CNNs Cookie</p>
    <p>GET, DoubleClicks Cookie</p>
    <p>User Publisher Ad Exchange Advertisers</p>
  </div>
  <div class="page">
    <p>GET, CNNs Cookie</p>
    <p>GET, DoubleClicks Cookie</p>
    <p>User Publisher Ad Exchange Advertisers</p>
    <p>Solicit bids, DoubleClicks Cookie</p>
    <p>Bid</p>
  </div>
  <div class="page">
    <p>Real Time Bidding (RTB)</p>
    <p>GET, CNNs Cookie</p>
    <p>GET, DoubleClicks Cookie</p>
    <p>User Publisher Ad Exchange Advertisers</p>
    <p>Solicit bids, DoubleClicks Cookie</p>
    <p>Bid</p>
  </div>
  <div class="page">
    <p>Real Time Bidding (RTB)</p>
    <p>GET, CNNs Cookie</p>
    <p>GET, DoubleClicks Cookie</p>
    <p>User Publisher Ad Exchange Advertisers</p>
    <p>Solicit bids, DoubleClicks Cookie</p>
    <p>GET, RightMedias Cookie</p>
    <p>Advertisement</p>
    <p>Bid</p>
  </div>
  <div class="page">
    <p>Real Time Bidding (RTB)</p>
    <p>GET, CNNs Cookie</p>
    <p>GET, DoubleClicks Cookie</p>
    <p>User Publisher Ad Exchange Advertisers</p>
    <p>Solicit bids, DoubleClicks Cookie</p>
    <p>GET, RightMedias Cookie</p>
    <p>Advertisement</p>
    <p>Bid</p>
    <p>Advertisers cannot read their cookie!</p>
  </div>
  <div class="page">
    <p>Cookie Matching</p>
    <p>Key problem: Advertisers cannot read their cookies in the RTB auction  How can they submit reasonable bids if they cannot identify the user?</p>
    <p>Solution: cookie matching  Also known as cookie synching</p>
    <p>Process of linking the identifiers used by two ad exchanges</p>
  </div>
  <div class="page">
    <p>Cookie Matching</p>
    <p>Key problem: Advertisers cannot read their cookies in the RTB auction  How can they submit reasonable bids if they cannot identify the user?</p>
    <p>Solution: cookie matching  Also known as cookie synching</p>
    <p>Process of linking the identifiers used by two ad exchanges</p>
    <p>GET, Cookie=12345</p>
  </div>
  <div class="page">
    <p>Cookie Matching</p>
    <p>Key problem: Advertisers cannot read their cookies in the RTB auction  How can they submit reasonable bids if they cannot identify the user?</p>
    <p>Solution: cookie matching  Also known as cookie synching</p>
    <p>Process of linking the identifiers used by two ad exchanges</p>
    <p>GET, Cookie=12345</p>
  </div>
  <div class="page">
    <p>Cookie Matching</p>
    <p>Key problem: Advertisers cannot read their cookies in the RTB auction  How can they submit reasonable bids if they cannot identify the user?</p>
    <p>Solution: cookie matching  Also known as cookie synching</p>
    <p>Process of linking the identifiers used by two ad exchanges</p>
    <p>GET, Cookie=12345</p>
    <p>GET ?dblclk_id=12345, Cookie=ABCDE</p>
  </div>
  <div class="page">
    <p>Cookie Matching</p>
    <p>Key problem: Advertisers cannot read their cookies in the RTB auction  How can they submit reasonable bids if they cannot identify the user?</p>
    <p>Solution: cookie matching  Also known as cookie synching</p>
    <p>Process of linking the identifiers used by two ad exchanges</p>
    <p>GET, Cookie=12345</p>
    <p>GET ?dblclk_id=12345, Cookie=ABCDE</p>
  </div>
  <div class="page">
    <p>Cookie Matching</p>
    <p>Key problem: Advertisers cannot read their cookies in the RTB auction  How can they submit reasonable bids if they cannot identify the user?</p>
    <p>Solution: cookie matching  Also known as cookie synching</p>
    <p>Process of linking the identifiers used by two ad exchanges</p>
    <p>GET, Cookie=12345</p>
    <p>GET ?dblclk_id=12345, Cookie=ABCDE</p>
  </div>
  <div class="page">
    <p>Prior Work</p>
    <p>Several studies have examined cookie matching  Acar et al. found hundreds of domains passing identifiers to each other</p>
    <p>Olejnik et al. found 125 exchanges matching cookies</p>
    <p>Falahrastegar et al. analyzed clusters of exchanges that share the exact same cookies</p>
  </div>
  <div class="page">
    <p>Prior Work</p>
    <p>Several studies have examined cookie matching  Acar et al. found hundreds of domains passing identifiers to each other</p>
    <p>Olejnik et al. found 125 exchanges matching cookies</p>
    <p>Falahrastegar et al. analyzed clusters of exchanges that share the exact same cookies</p>
    <p>These studies rely on studying HTTP requests/responses.</p>
  </div>
  <div class="page">
    <p>Challenge 1: Server Side Matching</p>
  </div>
  <div class="page">
    <p>Challenge 1: Server Side Matching</p>
    <p>Criteo observes the user.</p>
    <p>(IP: 207.91.160.7)</p>
  </div>
  <div class="page">
    <p>Challenge 1: Server Side Matching</p>
    <p>Criteo observes the user.</p>
    <p>(IP: 207.91.160.7)</p>
    <p>RightMedia observes the user.</p>
    <p>(IP: 207.91.160.7)</p>
  </div>
  <div class="page">
    <p>Challenge 1: Server Side Matching</p>
    <p>Criteo observes the user.</p>
    <p>(IP: 207.91.160.7)</p>
    <p>RightMedia observes the user.</p>
    <p>(IP: 207.91.160.7)</p>
    <p>Behind the scene, RightMedia and Criteo sync up.</p>
    <p>(IP: 207.91.160.7)</p>
  </div>
  <div class="page">
    <p>Challenge 2: Obfuscation</p>
  </div>
  <div class="page">
    <p>Challenge 2: Obfuscation</p>
  </div>
  <div class="page">
    <p>Challenge 2: Obfuscation</p>
    <p>amazon.com</p>
  </div>
  <div class="page">
    <p>Challenge 2: Obfuscation</p>
    <p>amazon.com</p>
    <p>dbclk.js</p>
  </div>
  <div class="page">
    <p>Challenge 2: Obfuscation</p>
    <p>GET %^$ck#&amp;93#&amp;, Cookie=XYZYX</p>
    <p>amazon.com</p>
    <p>dbclk.js</p>
  </div>
  <div class="page">
    <p>Challenge 2: Obfuscation</p>
    <p>GET %^$ck#&amp;93#&amp;, Cookie=XYZYX</p>
    <p>amazon.com</p>
    <p>dbclk.js</p>
  </div>
  <div class="page">
    <p>Challenge 2: Obfuscation</p>
    <p>GET %^$ck#&amp;93#&amp;, Cookie=XYZYX</p>
    <p>amazon.com</p>
    <p>dbclk.js</p>
  </div>
  <div class="page">
    <p>Challenge 2: Obfuscation</p>
    <p>GET %^$ck#&amp;93#&amp;, Cookie=XYZYX</p>
    <p>amazon.com</p>
    <p>dbclk.js</p>
  </div>
  <div class="page">
    <p>Challenge 2: Obfuscation</p>
    <p>GET %^$ck#&amp;93#&amp;, Cookie=XYZYX</p>
    <p>amazon.com</p>
    <p>dbclk.js</p>
  </div>
  <div class="page">
    <p>Goal</p>
    <p>Develop a method to identify information flows (cookie matching) between ad exchanges</p>
    <p>Mechanism agnostic: resilient to obfuscation</p>
    <p>Platform agnostic: detect sharing on the client- and server-side</p>
  </div>
  <div class="page">
    <p>Goal</p>
    <p>Develop a method to identify information flows (cookie matching) between ad exchanges</p>
    <p>Mechanism agnostic: resilient to obfuscation</p>
    <p>Platform agnostic: detect sharing on the client- and server-side</p>
    <p>?</p>
  </div>
  <div class="page">
    <p>Key Insight: Use Retargeted Ads</p>
    <p>Retargeted ads are the most highly targeted form of online ads</p>
    <p>$15.99</p>
  </div>
  <div class="page">
    <p>Key Insight: Use Retargeted Ads</p>
    <p>Retargeted ads are the most highly targeted form of online ads</p>
    <p>$15.99</p>
  </div>
  <div class="page">
    <p>Key Insight: Use Retargeted Ads</p>
    <p>Retargeted ads are the most highly targeted form of online ads</p>
    <p>Key insight: because retargets are so specific, they can be used to conduct controlled experiments</p>
    <p>Information must be shared between ad exchanges to serve retargeted ads</p>
    <p>$15.99</p>
  </div>
  <div class="page">
    <p>Contributions</p>
  </div>
  <div class="page">
    <p>Contributions</p>
  </div>
  <div class="page">
    <p>Data Collection Classifying Ad Network Flows Results</p>
  </div>
  <div class="page">
    <p>Using Retargets as an Experimental Tool</p>
    <p>Key observation: retargets are only served under very specific circumstances</p>
  </div>
  <div class="page">
    <p>Using Retargets as an Experimental Tool</p>
    <p>Key observation: retargets are only served under very specific circumstances</p>
  </div>
  <div class="page">
    <p>Using Retargets as an Experimental Tool</p>
    <p>Key observation: retargets are only served under very specific circumstances</p>
    <p>Advertiser observes the user at a shop</p>
  </div>
  <div class="page">
    <p>Using Retargets as an Experimental Tool</p>
    <p>Key observation: retargets are only served under very specific circumstances</p>
    <p>Advertiser observes the user at a shop</p>
    <p>Advertiser and the exchange must have matched cookies</p>
  </div>
  <div class="page">
    <p>Using Retargets as an Experimental Tool</p>
    <p>This implies a causal flow of information from Exchange  Advertiser</p>
    <p>Key observation: retargets are only served under very specific circumstances</p>
    <p>Advertiser observes the user at a shop</p>
    <p>Advertiser and the exchange must have matched cookies</p>
  </div>
  <div class="page">
    <p>Data Collection Overview</p>
  </div>
  <div class="page">
    <p>Data Collection Overview</p>
    <p>Single Persona 10 websites/persona 10 products/website</p>
    <p>Visit Persona</p>
  </div>
  <div class="page">
    <p>Data Collection Overview</p>
    <p>Single Persona 10 websites/persona 10 products/website</p>
    <p>Visit Persona Visit Publishers</p>
  </div>
  <div class="page">
    <p>Data Collection Overview</p>
    <p>Single Persona 10 websites/persona 10 products/website</p>
    <p>Visit Persona Visit Publishers</p>
    <p>Store Images, Inclusion Chains, HTTP requests/</p>
    <p>responses</p>
  </div>
  <div class="page">
    <p>Data Collection Overview</p>
    <p>Single Persona 10 websites/persona 10 products/website</p>
    <p>Visit Persona Visit Publishers</p>
    <p>Store Images, Inclusion Chains, HTTP requests/</p>
    <p>responses</p>
  </div>
  <div class="page">
    <p>Data Collection Overview</p>
    <p>Single Persona 10 websites/persona 10 products/website</p>
    <p>Visit Persona Visit Publishers</p>
    <p>Store Images, Inclusion Chains, HTTP requests/</p>
    <p>responses</p>
    <p>P e</p>
    <p>rs o</p>
    <p>n a</p>
    <p>s</p>
    <p>{</p>
  </div>
  <div class="page">
    <p>Data Collection Overview</p>
    <p>Single Persona 10 websites/persona 10 products/website</p>
    <p>Visit Persona Visit Publishers</p>
    <p>Store Images, Inclusion Chains, HTTP requests/</p>
    <p>responses Potential Targeted</p>
    <p>Ads 31,850</p>
    <p>Ad Detection</p>
    <p>Filter Images which appeared in &gt; 1 persona</p>
    <p>P e</p>
    <p>rs o</p>
    <p>n a</p>
    <p>s</p>
    <p>{</p>
  </div>
  <div class="page">
    <p>Data Collection Overview</p>
    <p>Single Persona 10 websites/persona 10 products/website</p>
    <p>Visit Persona Visit Publishers</p>
    <p>Store Images, Inclusion Chains, HTTP requests/</p>
    <p>responses Potential Targeted</p>
    <p>Ads 31,850</p>
    <p>Ad DetectionIsolated Retargeted Ads</p>
    <p>Filter Images which appeared in &gt; 1 persona</p>
    <p>P e</p>
    <p>rs o</p>
    <p>n a</p>
    <p>s</p>
    <p>Crowd Sourcing</p>
    <p>{</p>
  </div>
  <div class="page">
    <p>Crowd Sourcing</p>
    <p>We used Amazon Mechanical Turk (AMT) to label 31,850 ads.</p>
  </div>
  <div class="page">
    <p>Crowd Sourcing</p>
    <p>We used Amazon Mechanical Turk (AMT) to label 31,850 ads.</p>
    <p>Total 1,142 Tasks.</p>
    <p>30 ads / Task.</p>
    <p>27 unlabeled.</p>
    <p>3 labeled by us.</p>
    <p>2 workers per ad.</p>
    <p>$415 spent.</p>
  </div>
  <div class="page">
    <p>Crowd Sourcing</p>
    <p>We used Amazon Mechanical Turk (AMT) to label 31,850 ads.</p>
    <p>Total 1,142 Tasks.</p>
    <p>30 ads / Task.</p>
    <p>27 unlabeled.</p>
    <p>3 labeled by us.</p>
    <p>2 workers per ad.</p>
    <p>$415 spent.</p>
  </div>
  <div class="page">
    <p>Crowd Sourcing</p>
    <p>We used Amazon Mechanical Turk (AMT) to label 31,850 ads.</p>
    <p>Total 1,142 Tasks.</p>
    <p>30 ads / Task.</p>
    <p>27 unlabeled.</p>
    <p>3 labeled by us.</p>
    <p>2 workers per ad.</p>
    <p>$415 spent.</p>
  </div>
  <div class="page">
    <p>Crowd Sourcing</p>
    <p>We used Amazon Mechanical Turk (AMT) to label 31,850 ads.</p>
    <p>Total 1,142 Tasks.</p>
    <p>30 ads / Task.</p>
    <p>27 unlabeled.</p>
    <p>3 labeled by us.</p>
    <p>2 workers per ad.</p>
    <p>$415 spent.</p>
  </div>
  <div class="page">
    <p>Final Dataset</p>
  </div>
  <div class="page">
    <p>Data Collection Classifying Ad Network Flows Results</p>
  </div>
  <div class="page">
    <p>A look at Publisher Chains</p>
  </div>
  <div class="page">
    <p>A look at Publisher Chains</p>
    <p>E xa</p>
    <p>m p</p>
    <p>le</p>
    <p>Publisher-side chain</p>
  </div>
  <div class="page">
    <p>A look at Publisher Chains</p>
    <p>E xa</p>
    <p>m p</p>
    <p>le</p>
    <p>Shopper-side chain Publisher-side chain</p>
  </div>
  <div class="page">
    <p>A look at Publisher Chains</p>
    <p>E xa</p>
    <p>m p</p>
    <p>le</p>
    <p>Shopper-side chain Publisher-side chain</p>
    <p>How does Criteo know to serve ad on BBC?</p>
  </div>
  <div class="page">
    <p>A look at Publisher Chains</p>
    <p>E xa</p>
    <p>m p</p>
    <p>le</p>
    <p>Shopper-side chain Publisher-side chain</p>
    <p>How does Criteo know to serve ad on BBC?  In this case it is pretty trivial.  Criteo observed us on the shopper.</p>
  </div>
  <div class="page">
    <p>A look at Publisher Chains</p>
    <p>E xa</p>
    <p>m p</p>
    <p>le</p>
    <p>Shopper-side chain Publisher-side chain</p>
    <p>How does Criteo know to serve ad on BBC?  In this case it is pretty trivial.  Criteo observed us on the shopper.</p>
    <p>Can we classify all such publisher-side chains?</p>
  </div>
  <div class="page">
    <p>What is a Chain?</p>
  </div>
  <div class="page">
    <p>What is a Chain?</p>
  </div>
  <div class="page">
    <p>What is a Chain?</p>
  </div>
  <div class="page">
    <p>What is a Chain?</p>
  </div>
  <div class="page">
    <p>What is a Chain?</p>
  </div>
  <div class="page">
    <p>What is a Chain?</p>
  </div>
  <div class="page">
    <p>What is a Chain?</p>
  </div>
  <div class="page">
    <p>What is a Chain?</p>
  </div>
  <div class="page">
    <p>What is a Chain?</p>
  </div>
  <div class="page">
    <p>What is a Chain?</p>
  </div>
  <div class="page">
    <p>What is a Chain?</p>
  </div>
  <div class="page">
    <p>What is a Chain?</p>
    <p>a</p>
    <p>a</p>
    <p>e</p>
    <p>e</p>
  </div>
  <div class="page">
    <p>What is a Chain?</p>
    <p>^pub .* e a$</p>
    <p>a</p>
    <p>a</p>
    <p>e</p>
    <p>e</p>
  </div>
  <div class="page">
    <p>Four Classifications</p>
    <p>Four possible ways for a retargeted ad to be served 1. Direct (Trivial) Matching</p>
  </div>
  <div class="page">
    <p>Four Classifications</p>
    <p>Four possible ways for a retargeted ad to be served 1. Direct (Trivial) Matching</p>
  </div>
  <div class="page">
    <p>Shopper-side Publisher-side</p>
    <p>E xa</p>
    <p>m p</p>
    <p>le R</p>
    <p>u le</p>
  </div>
  <div class="page">
    <p>Shopper-side Publisher-side</p>
    <p>E xa</p>
    <p>m p</p>
    <p>le R</p>
    <p>u le</p>
    <p>^shop .* a .*$ ^pub a$</p>
  </div>
  <div class="page">
    <p>Shopper-side Publisher-side</p>
    <p>E xa</p>
    <p>m p</p>
    <p>le R</p>
    <p>u le</p>
    <p>^shop .* a .*$ ^pub a$</p>
    <p>a is the advertiser that</p>
    <p>serves the retarget</p>
  </div>
  <div class="page">
    <p>Shopper-side Publisher-side</p>
    <p>E xa</p>
    <p>m p</p>
    <p>le R</p>
    <p>u le</p>
    <p>^shop .* a .*$ ^pub a$</p>
    <p>a is the advertiser that</p>
    <p>serves the retarget</p>
    <p>a must appear on the shopper</p>
    <p>side</p>
    <p>but other trackers may also appear</p>
  </div>
  <div class="page">
    <p>Shopper-side Publisher-side</p>
    <p>E xa</p>
    <p>m p</p>
    <p>le R</p>
    <p>u le</p>
  </div>
  <div class="page">
    <p>Shopper-side Publisher-side</p>
    <p>E xa</p>
    <p>m p</p>
    <p>le R</p>
    <p>u le</p>
    <p>^shop .* a .*$ ^pub .* e a$</p>
  </div>
  <div class="page">
    <p>Shopper-side Publisher-side</p>
    <p>E xa</p>
    <p>m p</p>
    <p>le R</p>
    <p>u le</p>
    <p>^shop .* a .*$ ^pub .* e a$</p>
    <p>e precedes a, which implies an</p>
    <p>RTB auction</p>
  </div>
  <div class="page">
    <p>Shopper-side Publisher-side</p>
    <p>E xa</p>
    <p>m p</p>
    <p>le R</p>
    <p>u le</p>
    <p>^shop .* a .*$</p>
    <p>a must appear on the</p>
    <p>shopper-side</p>
    <p>^pub .* e a$</p>
    <p>e precedes a, which implies an</p>
    <p>RTB auction</p>
  </div>
  <div class="page">
    <p>Shopper-side Publisher-side</p>
    <p>E xa</p>
    <p>m p</p>
    <p>le R</p>
    <p>u le</p>
    <p>^shop .* a .*$</p>
    <p>a must appear on the</p>
    <p>shopper-side</p>
    <p>^pub .* e a$^* .* e a .*$</p>
    <p>Anywhere</p>
    <p>e precedes a, which implies an</p>
    <p>RTB auction</p>
    <p>Transition ea is where cookie match occurs</p>
  </div>
  <div class="page">
    <p>Shopper-side Publisher-side</p>
    <p>E xa</p>
    <p>m p</p>
    <p>le R</p>
    <p>u le</p>
  </div>
  <div class="page">
    <p>Shopper-side Publisher-side</p>
    <p>E xa</p>
    <p>m p</p>
    <p>le R</p>
    <p>u le</p>
    <p>^shop [^ea]$ ^pub .* e a$</p>
  </div>
  <div class="page">
    <p>Shopper-side Publisher-side</p>
    <p>E xa</p>
    <p>m p</p>
    <p>le R</p>
    <p>u le</p>
    <p>^shop [^ea]$</p>
    <p>Neither e nor a appears on the shopper-side</p>
    <p>^pub .* e a$</p>
  </div>
  <div class="page">
    <p>Shopper-side Publisher-side</p>
    <p>E xa</p>
    <p>m p</p>
    <p>le R</p>
    <p>u le</p>
    <p>^shop [^ea]$</p>
    <p>Neither e nor a appears on the shopper-side</p>
    <p>^pub .* e a$</p>
    <p>a must receive information from some shopper-side tracker</p>
  </div>
  <div class="page">
    <p>Shopper-side Publisher-side</p>
    <p>E xa</p>
    <p>m p</p>
    <p>le R</p>
    <p>u le</p>
    <p>^shop [^ea]$</p>
    <p>Neither e nor a appears on the shopper-side</p>
    <p>^pub .* e a$</p>
    <p>a must receive information from some shopper-side tracker</p>
    <p>We find latent matches in practice!</p>
  </div>
  <div class="page">
    <p>Data Collection Classifying Ad Network Flows Results</p>
  </div>
  <div class="page">
    <p>Categorizing Chains</p>
    <p>Type Chains % Chains %</p>
    <p>Direct (Trivial) Match 1770 5 8449 24</p>
    <p>Cookie Match 25049 71 25873 73</p>
    <p>Latent (Server-side) Match 5362 15 343 1</p>
    <p>No Match 775 2 183 1</p>
    <p>ClusteredRaw Chains</p>
  </div>
  <div class="page">
    <p>Categorizing Chains</p>
    <p>Type Chains % Chains %</p>
    <p>Direct (Trivial) Match 1770 5 8449 24</p>
    <p>Cookie Match 25049 71 25873 73</p>
    <p>Latent (Server-side) Match 5362 15 343 1</p>
    <p>No Match 775 2 183 1</p>
    <p>Clustered</p>
    <p>Take away:</p>
    <p>Raw Chains</p>
  </div>
  <div class="page">
    <p>Categorizing Chains</p>
    <p>Type Chains % Chains %</p>
    <p>Direct (Trivial) Match 1770 5 8449 24</p>
    <p>Cookie Match 25049 71 25873 73</p>
    <p>Latent (Server-side) Match 5362 15 343 1</p>
    <p>No Match 775 2 183 1</p>
    <p>Clustered</p>
    <p>Take away: 1- As expected, most retargets are due to cookie matching</p>
    <p>Raw Chains</p>
  </div>
  <div class="page">
    <p>Categorizing Chains</p>
    <p>Type Chains % Chains %</p>
    <p>Direct (Trivial) Match 1770 5 8449 24</p>
    <p>Cookie Match 25049 71 25873 73</p>
    <p>Latent (Server-side) Match 5362 15 343 1</p>
    <p>No Match 775 2 183 1</p>
    <p>Clustered</p>
    <p>Take away: 1- As expected, most retargets are due to cookie matching</p>
    <p>Suggests low false positive rate of AMT image labeling task</p>
    <p>Raw Chains</p>
  </div>
  <div class="page">
    <p>Categorizing Chains</p>
    <p>Type Chains % Chains %</p>
    <p>Direct (Trivial) Match 1770 5 8449 24</p>
    <p>Cookie Match 25049 71 25873 73</p>
    <p>Latent (Server-side) Match 5362 15 343 1</p>
    <p>No Match 775 2 183 1</p>
    <p>Clustered</p>
    <p>Take away: 1- As expected, most retargets are due to cookie matching</p>
    <p>Suggests low false positive rate of AMT image labeling task</p>
    <p>Raw Chains</p>
  </div>
  <div class="page">
    <p>Categorizing Chains</p>
    <p>Type Chains % Chains %</p>
    <p>Direct (Trivial) Match 1770 5 8449 24</p>
    <p>Cookie Match 25049 71 25873 73</p>
    <p>Latent (Server-side) Match 5362 15 343 1</p>
    <p>No Match 775 2 183 1</p>
    <p>Raw Chains Clustered</p>
    <p>Chains</p>
    <p>Cluster together domains by owner  E.g. google.com, doubleclick.com, googlesyndication.com</p>
  </div>
  <div class="page">
    <p>Categorizing Chains</p>
    <p>Type Chains % Chains %</p>
    <p>Direct (Trivial) Match 1770 5 8449 24</p>
    <p>Cookie Match 25049 71 25873 73</p>
    <p>Latent (Server-side) Match 5362 15 343 1</p>
    <p>No Match 775 2 183 1</p>
    <p>Raw Chains Clustered</p>
    <p>Chains</p>
    <p>Cluster together domains by owner  E.g. google.com, doubleclick.com, googlesyndication.com</p>
    <p>Latent matches essentially disappear  The vast majority of these chains involve Google</p>
    <p>Suggests that Google shares tracking data across their services</p>
  </div>
  <div class="page">
    <p>Who is Cookie Matching?</p>
    <p>Participant 1 Participant 2 Chains Ads Heuristics</p>
    <p>criteo  googlesyndication 9090 1887  P</p>
    <p>criteo  doubleclick 3610 1144  E, P  DC, P</p>
    <p>criteo  adnxs 3263 1066  E, P</p>
    <p>criteo  rubiconproject 1586 749  E, P</p>
    <p>criteo  servedbyopenx 707 460  P</p>
    <p>doubleclick  steelhousemedia 362 27  P  E, P</p>
    <p>mathtag  mediaforge 360 124  E, P</p>
    <p>netmng  scene7 267 119  E  ?</p>
    <p>googlesyndication  adsrvr 107 29  P</p>
    <p>rubiconproject  steelhousemedia 86 30  E</p>
    <p>googlesyndication  steelhousemedia 47 22 ?</p>
    <p>adtechus  adacado 36 18 ?</p>
    <p>atwola  adacado 32 6 ?</p>
    <p>adroll  adnxs 31 8 ? 27</p>
    <p>Heuristics Key (used by prior work)</p>
    <p>E  share exact cookies</p>
    <p>P  special URL parameters</p>
    <p>DC  DoubleClick URL parameters</p>
    <p>?  Unknown sharing method</p>
  </div>
  <div class="page">
    <p>Who is Cookie Matching?</p>
    <p>Participant 1 Participant 2 Chains Ads Heuristics</p>
    <p>criteo  googlesyndication 9090 1887  P</p>
    <p>criteo  doubleclick 3610 1144  E, P  DC, P</p>
    <p>criteo  adnxs 3263 1066  E, P</p>
    <p>criteo  rubiconproject 1586 749  E, P</p>
    <p>criteo  servedbyopenx 707 460  P</p>
    <p>doubleclick  steelhousemedia 362 27  P  E, P</p>
    <p>mathtag  mediaforge 360 124  E, P</p>
    <p>netmng  scene7 267 119  E  ?</p>
    <p>googlesyndication  adsrvr 107 29  P</p>
    <p>rubiconproject  steelhousemedia 86 30  E</p>
    <p>googlesyndication  steelhousemedia 47 22 ?</p>
    <p>adtechus  adacado 36 18 ?</p>
    <p>atwola  adacado 32 6 ?</p>
    <p>adroll  adnxs 31 8 ? 27</p>
    <p>Heuristics Key (used by prior work)</p>
    <p>E  share exact cookies</p>
    <p>P  special URL parameters</p>
    <p>DC  DoubleClick URL parameters</p>
    <p>?  Unknown sharing method</p>
  </div>
  <div class="page">
    <p>Who is Cookie Matching?</p>
    <p>Participant 1 Participant 2 Chains Ads Heuristics</p>
    <p>criteo  googlesyndication 9090 1887  P</p>
    <p>criteo  doubleclick 3610 1144  E, P  DC, P</p>
    <p>criteo  adnxs 3263 1066  E, P</p>
    <p>criteo  rubiconproject 1586 749  E, P</p>
    <p>criteo  servedbyopenx 707 460  P</p>
    <p>doubleclick  steelhousemedia 362 27  P  E, P</p>
    <p>mathtag  mediaforge 360 124  E, P</p>
    <p>netmng  scene7 267 119  E  ?</p>
    <p>googlesyndication  adsrvr 107 29  P</p>
    <p>rubiconproject  steelhousemedia 86 30  E</p>
    <p>googlesyndication  steelhousemedia 47 22 ?</p>
    <p>adtechus  adacado 36 18 ?</p>
    <p>atwola  adacado 32 6 ?</p>
    <p>adroll  adnxs 31 8 ? 27</p>
    <p>Heuristics Key (used by prior work)</p>
    <p>E  share exact cookies</p>
    <p>P  special URL parameters</p>
    <p>DC  DoubleClick URL parameters</p>
    <p>?  Unknown sharing method</p>
  </div>
  <div class="page">
    <p>Who is Cookie Matching?</p>
    <p>Participant 1 Participant 2 Chains Ads Heuristics</p>
    <p>criteo  googlesyndication 9090 1887  P</p>
    <p>criteo  doubleclick 3610 1144  E, P  DC, P</p>
    <p>criteo  adnxs 3263 1066  E, P</p>
    <p>criteo  rubiconproject 1586 749  E, P</p>
    <p>criteo  servedbyopenx 707 460  P</p>
    <p>doubleclick  steelhousemedia 362 27  P  E, P</p>
    <p>mathtag  mediaforge 360 124  E, P</p>
    <p>netmng  scene7 267 119  E  ?</p>
    <p>googlesyndication  adsrvr 107 29  P</p>
    <p>rubiconproject  steelhousemedia 86 30  E</p>
    <p>googlesyndication  steelhousemedia 47 22 ?</p>
    <p>adtechus  adacado 36 18 ?</p>
    <p>atwola  adacado 32 6 ?</p>
    <p>adroll  adnxs 31 8 ? 27</p>
    <p>Heuristics Key (used by prior work)</p>
    <p>E  share exact cookies</p>
    <p>P  special URL parameters</p>
    <p>DC  DoubleClick URL parameters</p>
    <p>?  Unknown sharing method</p>
  </div>
  <div class="page">
    <p>Who is Cookie Matching?</p>
    <p>Participant 1 Participant 2 Chains Ads Heuristics</p>
    <p>criteo  googlesyndication 9090 1887  P</p>
    <p>criteo  doubleclick 3610 1144  E, P  DC, P</p>
    <p>criteo  adnxs 3263 1066  E, P</p>
    <p>criteo  rubiconproject 1586 749  E, P</p>
    <p>criteo  servedbyopenx 707 460  P</p>
    <p>doubleclick  steelhousemedia 362 27  P  E, P</p>
    <p>mathtag  mediaforge 360 124  E, P</p>
    <p>netmng  scene7 267 119  E  ?</p>
    <p>googlesyndication  adsrvr 107 29  P</p>
    <p>rubiconproject  steelhousemedia 86 30  E</p>
    <p>googlesyndication  steelhousemedia 47 22 ?</p>
    <p>adtechus  adacado 36 18 ?</p>
    <p>atwola  adacado 32 6 ?</p>
    <p>adroll  adnxs 31 8 ? 27</p>
    <p>Heuristics Key (used by prior work)</p>
    <p>E  share exact cookies</p>
    <p>P  special URL parameters</p>
    <p>DC  DoubleClick URL parameters</p>
    <p>?  Unknown sharing method</p>
  </div>
  <div class="page">
    <p>Who is Cookie Matching?</p>
    <p>Participant 1 Participant 2 Chains Ads Heuristics</p>
    <p>criteo  googlesyndication 9090 1887  P</p>
    <p>criteo  doubleclick 3610 1144  E, P  DC, P</p>
    <p>criteo  adnxs 3263 1066  E, P</p>
    <p>criteo  rubiconproject 1586 749  E, P</p>
    <p>criteo  servedbyopenx 707 460  P</p>
    <p>doubleclick  steelhousemedia 362 27  P  E, P</p>
    <p>mathtag  mediaforge 360 124  E, P</p>
    <p>netmng  scene7 267 119  E  ?</p>
    <p>googlesyndication  adsrvr 107 29  P</p>
    <p>rubiconproject  steelhousemedia 86 30  E</p>
    <p>googlesyndication  steelhousemedia 47 22 ?</p>
    <p>adtechus  adacado 36 18 ?</p>
    <p>atwola  adacado 32 6 ?</p>
    <p>adroll  adnxs 31 8 ? 27</p>
    <p>Heuristics Key (used by prior work)</p>
    <p>E  share exact cookies</p>
    <p>P  special URL parameters</p>
    <p>DC  DoubleClick URL parameters</p>
    <p>?  Unknown sharing method</p>
  </div>
  <div class="page">
    <p>Who is Cookie Matching?</p>
    <p>Participant 1 Participant 2 Chains Ads Heuristics</p>
    <p>criteo  googlesyndication 9090 1887  P</p>
    <p>criteo  doubleclick 3610 1144  E, P  DC, P</p>
    <p>criteo  adnxs 3263 1066  E, P</p>
    <p>criteo  rubiconproject 1586 749  E, P</p>
    <p>criteo  servedbyopenx 707 460  P</p>
    <p>doubleclick  steelhousemedia 362 27  P  E, P</p>
    <p>mathtag  mediaforge 360 124  E, P</p>
    <p>netmng  scene7 267 119  E  ?</p>
    <p>googlesyndication  adsrvr 107 29  P</p>
    <p>rubiconproject  steelhousemedia 86 30  E</p>
    <p>googlesyndication  steelhousemedia 47 22 ?</p>
    <p>adtechus  adacado 36 18 ?</p>
    <p>atwola  adacado 32 6 ?</p>
    <p>adroll  adnxs 31 8 ? 27</p>
    <p>Heuristics Key (used by prior work)</p>
    <p>E  share exact cookies</p>
    <p>P  special URL parameters</p>
    <p>DC  DoubleClick URL parameters</p>
    <p>?  Unknown sharing method</p>
  </div>
  <div class="page">
    <p>Summary</p>
    <p>We develop a novel methodology to detect information flows between ad exchanges</p>
    <p>Controlled methodology enables causal inference</p>
    <p>Defeats obfuscation attempts</p>
    <p>Detects client- and server-side flows</p>
    <p>Dataset gives a better picture of ad ecosystem  Reveals which ad exchanges are linking information about users</p>
    <p>Allows us to reason about how information is being transferred</p>
  </div>
  <div class="page">
    <p>Questions? Muhammad Ahmad Bashir</p>
    <p>ahmad@ccs.neu.edu</p>
  </div>
  <div class="page">
    <p>Inclusion Chains</p>
    <p>Instrumented Chromium binary that records the provenance of page elements  Uses Information Flow Analysis techniques (IFA)</p>
    <p>Handles Flash, exec(), setTimeout(), cross-frame, inline scripts, etc.</p>
  </div>
  <div class="page">
    <p>Inclusion Chains</p>
    <p>Instrumented Chromium binary that records the provenance of page elements  Uses Information Flow Analysis techniques (IFA)</p>
    <p>Handles Flash, exec(), setTimeout(), cross-frame, inline scripts, etc.</p>
    <p>&lt;html&gt; &lt;body&gt;</p>
    <p>&lt;script src=b.com/adlib.js&gt;&lt;/script&gt; &lt;iframe src=c.net/adbox.html&gt;</p>
    <p>&lt;html&gt; &lt;script src=code.js&gt;&lt;/script&gt; &lt;object data=d.org/flash.swf&gt; &lt;/object&gt;</p>
    <p>&lt;/html&gt; &lt;/iframe&gt;</p>
    <p>&lt;/body&gt; &lt;/html&gt;</p>
    <p>DOM: a.com/index.html</p>
  </div>
  <div class="page">
    <p>Inclusion Chains</p>
    <p>Instrumented Chromium binary that records the provenance of page elements  Uses Information Flow Analysis techniques (IFA)</p>
    <p>Handles Flash, exec(), setTimeout(), cross-frame, inline scripts, etc.</p>
    <p>&lt;html&gt; &lt;body&gt;</p>
    <p>&lt;script src=b.com/adlib.js&gt;&lt;/script&gt; &lt;iframe src=c.net/adbox.html&gt;</p>
    <p>&lt;html&gt; &lt;script src=code.js&gt;&lt;/script&gt; &lt;object data=d.org/flash.swf&gt; &lt;/object&gt;</p>
    <p>&lt;/html&gt; &lt;/iframe&gt;</p>
    <p>&lt;/body&gt; &lt;/html&gt;</p>
    <p>DOM: a.com/index.html Inclusion Chain</p>
    <p>a.com/index.html</p>
    <p>b.com/adlib.js</p>
    <p>c.net/adbox.html</p>
    <p>c.net/code.js</p>
    <p>d.org/flash.swf</p>
  </div>
  <div class="page">
    <p>Shopper-side Publisher-side</p>
    <p>E xa</p>
    <p>m p</p>
    <p>le R</p>
    <p>u le</p>
  </div>
  <div class="page">
    <p>[^a]</p>
    <p>Shopper-side Publisher-side</p>
    <p>E xa</p>
    <p>m p</p>
    <p>le R</p>
    <p>u le</p>
    <p>^shop e [^a]$ ^pub .* e a$</p>
  </div>
  <div class="page">
    <p>[^a]</p>
    <p>Shopper-side Publisher-side</p>
    <p>E xa</p>
    <p>m p</p>
    <p>le R</p>
    <p>u le</p>
    <p>^shop e [^a]$</p>
    <p>Only the exchange e appears on the shopper-side</p>
    <p>^pub .* e a$</p>
  </div>
  <div class="page">
    <p>[^a]</p>
    <p>Shopper-side Publisher-side</p>
    <p>E xa</p>
    <p>m p</p>
    <p>le R</p>
    <p>u le</p>
    <p>^shop e [^a]$</p>
    <p>Only the exchange e appears on the shopper-side</p>
    <p>^pub .* e a$</p>
    <p>e must pass browsing history data to participants in the auction, thus no</p>
    <p>cookie matching is necessary</p>
  </div>
  <div class="page">
    <p>[^a]</p>
    <p>Shopper-side Publisher-side</p>
    <p>E xa</p>
    <p>m p</p>
    <p>le R</p>
    <p>u le</p>
    <p>^shop e [^a]$</p>
    <p>Only the exchange e appears on the shopper-side</p>
    <p>^pub .* e a$</p>
    <p>e must pass browsing history data to participants in the auction, thus no</p>
    <p>cookie matching is necessary</p>
    <p>We do not expect to find indirect matches in the data.</p>
  </div>
  <div class="page">
    <p>References</p>
    <p>Gunes Acar, Christian Eubank, Steven Englehardt, Marc Juarez, Arvind Narayanan, Claudia Diaz. The web never forgets: Persistent tracking mechanisms in the wild. CCS, 2014.</p>
    <p>Muhammad Ahmad Bashir, Sajjad Arshad, William Robertson, Christo Wilson. Tracing Information Flows Between Ad Exchanges Using Retargeted Ads. Usenix Security, 2016.</p>
    <p>Marjan Falahrastegar, Hamed Haddadi, Steve Uhlig, Richard Mortier. Tracking personal identifiers across the web. PAM, 2016.</p>
    <p>Lukasz Olejnik, Tran Minh-Dung, Claude Castelluccia. Selling off privacy at auction. NDSS, 2014.</p>
  </div>
  <div class="page">
    <p>Filtering Images</p>
    <p>Filter Total Unique Images</p>
    <p>All images from the crawlers 571,636</p>
    <p>Use EasyList to identify advertisements 93,726</p>
    <p>Remove ads that are shown to &gt;1 persona 31,850</p>
    <p>Use crowdsourcing to locate retargets 5,102</p>
  </div>
  <div class="page">
    <p>Filtering Images</p>
    <p>Filter Total Unique Images</p>
    <p>All images from the crawlers 571,636</p>
    <p>Use EasyList to identify advertisements 93,726</p>
    <p>Remove ads that are shown to &gt;1 persona 31,850</p>
    <p>Use crowdsourcing to locate retargets 5,102</p>
  </div>
  <div class="page">
    <p>Filtering Images</p>
    <p>Filter Total Unique Images</p>
    <p>All images from the crawlers 571,636</p>
    <p>Use EasyList to identify advertisements 93,726</p>
    <p>Remove ads that are shown to &gt;1 persona 31,850</p>
    <p>Use crowdsourcing to locate retargets 5,102</p>
    <p>Personas visited non-overlapping retailers  By definition, retargets should only be shown to a single persona</p>
  </div>
  <div class="page">
    <p>Filtering Images</p>
    <p>Filter Total Unique Images</p>
    <p>All images from the crawlers 571,636</p>
    <p>Use EasyList to identify advertisements 93,726</p>
    <p>Remove ads that are shown to &gt;1 persona 31,850</p>
    <p>Use crowdsourcing to locate retargets 5,102</p>
    <p>Personas visited non-overlapping retailers  By definition, retargets should only be shown to a single persona</p>
    <p>Spent $415 uploading 1,142 HITs to Amazon Mechanical Turk  Each HIT asked the worker to label 30 ad images</p>
    <p>27 were unlabeled, 3 were known retargets (control images)</p>
    <p>All ads were labeled by 2 workers</p>
    <p>Any ad identified as targeted was also manually inspected by us</p>
  </div>
</Presentation>
