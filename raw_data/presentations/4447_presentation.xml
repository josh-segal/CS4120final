<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Dont Secure Routing, Secure Data Delivery</p>
    <p>Dan Wendlandt (CMU) With:</p>
    <p>Ioannis Avramopoulos (Princeton), David G. Andersen (CMU), and Jennifer Rexford</p>
    <p>(Princeton)</p>
    <p>Availability Centric Routing (ACR): A Multipath Alternative</p>
    <p>to Secure BGP Protocols.</p>
  </div>
  <div class="page">
    <p>Availability Centric Routing (ACR)</p>
    <p>The point of this talk:</p>
    <p>You dont need to secure BGP!</p>
    <p>Instead:</p>
    <p>=&gt; More bang for your security buck!</p>
  </div>
  <div class="page">
    <p>Requirements for Secure Communication?</p>
    <p>Needs end-to-end security</p>
    <p>(e.g., SSL &amp; IPsec).</p>
    <p>Secrecy of Data</p>
    <p>Authenticity of Data</p>
    <p>Availability of the Communication Channel</p>
    <p>Depends on routing and forwarding.</p>
  </div>
  <div class="page">
    <p>Requirements for Routing &amp; Forwarding?</p>
    <p>Claim:</p>
    <p>The routing and forwarding infrastructure need only ensure availability.</p>
    <p>Any additional security should be end-to-end.</p>
    <p>Define: Availability</p>
    <p>A source can learn about and use a working network path to the destination if such a path exists.</p>
    <p>Control plane</p>
    <p>Data plane</p>
  </div>
  <div class="page">
    <p>S*BGP is too much AND too little!</p>
    <p>Too Much:</p>
    <p>Too Little:</p>
    <p>Deployment Requirements:</p>
    <p>Global agreement on a protocol + PKI,</p>
    <p>Heavy-weight, Internet-wide router upgrades.</p>
    <p>Limited Protection:</p>
    <p>Cannot avoid data plane attacks or outages on valid BGP paths.</p>
  </div>
  <div class="page">
    <p>Achieving Availability</p>
    <p>Achieving availability is easier than securing the routing protocol:</p>
    <p>Multi-path routing</p>
    <p>+ check that path works</p>
    <p>+ alternate path selection</p>
    <p>= Availability</p>
    <p>Even if the routing protocol is insecure!</p>
    <p>Traffic Sources provide end-toend check (e.g., SSL or IPSec)</p>
  </div>
  <div class="page">
    <p>Realizing ACR</p>
    <p>Collect &amp; offer multiple routes.</p>
    <p>Availability Provider (AP): Expose path diversity</p>
    <p>Traffic Source: Select &amp; use routes.</p>
    <p>Host or Edge Router</p>
    <p>Deflect packets on alternate paths.</p>
    <p>Control Plane</p>
    <p>Data Plane</p>
    <p>Selecting from set of alternate paths</p>
    <p>Monitor quality of current path.</p>
  </div>
  <div class="page">
    <p>AS Z</p>
    <p>Egress #2</p>
    <p>APs Offer Alternate Path Deflections</p>
    <p>AS A</p>
    <p>AS D</p>
    <p>AS X AS Y</p>
    <p>Host A</p>
    <p>Host B</p>
    <p>Egress #1 AP</p>
    <p>Deflections use IP-in-IP to</p>
    <p>traverse alternate BGP paths learned</p>
    <p>by the AP</p>
  </div>
  <div class="page">
    <p>APs Offer Alternate Path Deflections</p>
    <p>AS A</p>
    <p>AS D</p>
    <p>AS X AS Y</p>
    <p>Route Monitor</p>
    <p>information learned by border routers.</p>
    <p>Host B</p>
    <p>Host A</p>
    <p>Egress #1 Egress #2</p>
    <p>AS Z</p>
    <p>AP</p>
  </div>
  <div class="page">
    <p>Y D via Egress #2</p>
    <p>APs Offer Alternate Path Deflections</p>
    <p>AS A</p>
    <p>AS D</p>
    <p>AS X AS Y</p>
    <p>Route Monitor</p>
    <p>Host B</p>
    <p>Host A</p>
    <p>Egress #1 Egress #2</p>
    <p>AS A</p>
    <p>AS Z</p>
    <p>AP</p>
  </div>
  <div class="page">
    <p>APs Offer Alternate Path Deflections</p>
    <p>AS A</p>
    <p>AS D</p>
    <p>AS X AS Y</p>
    <p>Route Monitor</p>
    <p>Egress #2</p>
    <p>Host B</p>
    <p>Host A</p>
    <p>Egress #1</p>
    <p>AS Z</p>
    <p>AP</p>
  </div>
  <div class="page">
    <p>point, includes deflection ID.</p>
    <p>SRC: Host A</p>
    <p>Data</p>
    <p>APs Offer Alternate Path Deflections</p>
    <p>DST: Egress #2</p>
    <p>SRC: Host A</p>
    <p>DST: Host B</p>
    <p>Deflection ID: Y</p>
    <p>AS A</p>
    <p>AS D</p>
    <p>AS X AS Y</p>
    <p>Route Monitor</p>
    <p>Egress #2</p>
    <p>Host B</p>
    <p>Host A</p>
    <p>Egress #1</p>
    <p>AS Z</p>
    <p>AP</p>
  </div>
  <div class="page">
    <p>SRC: Host A</p>
    <p>Data</p>
    <p>APs Offer Alternate Path Deflections</p>
    <p>DST: Egress #2</p>
    <p>SRC: Host A</p>
    <p>DST: Host B</p>
    <p>Deflection ID: Y</p>
    <p>AS A</p>
    <p>AS D</p>
    <p>AS X AS Y</p>
    <p>Route Monitor</p>
    <p>Egress #2</p>
    <p>Host B</p>
    <p>Host A</p>
    <p>Egress #1</p>
    <p>AS Z</p>
    <p>AP</p>
  </div>
  <div class="page">
    <p>packet, sends it to alternate next-hop AS based on ID.</p>
    <p>APs Offer Alternate Path Deflections</p>
    <p>Data</p>
    <p>SRC: Host A</p>
    <p>DST: Host B</p>
    <p>Deflection ID: Y</p>
    <p>AS A</p>
    <p>AS D</p>
    <p>AS X AS Y</p>
    <p>Route Monitor</p>
    <p>Egress #2</p>
    <p>Host B</p>
    <p>Host A</p>
    <p>Egress #1</p>
    <p>AS Z</p>
    <p>AP</p>
  </div>
  <div class="page">
    <p>APs Offer Alternate Path Deflections</p>
    <p>Data</p>
    <p>SRC: 10.1.1.1</p>
    <p>DST: 20.2.2.2</p>
    <p>AS A</p>
    <p>AS D</p>
    <p>AS X AS Y</p>
    <p>Route Monitor</p>
    <p>Egress #2</p>
    <p>Host B</p>
    <p>Host A</p>
    <p>Egress #1</p>
    <p>AS Z</p>
    <p>AP</p>
  </div>
  <div class="page">
    <p>Properties of Routing Deflections</p>
    <p>APs can easily limit or deny access to any path.</p>
  </div>
  <div class="page">
    <p>Functionality Implemented at Source</p>
    <p>Traffic Source: Select &amp; use routes.</p>
    <p>Host or Edge Router</p>
    <p>Selecting from set of alternate paths</p>
    <p>Monitor quality of current path.</p>
  </div>
  <div class="page">
    <p>Sources Monitoring Path Quality</p>
    <p>(e.g., IPSec, SSL)</p>
    <p>Was initial destination authentication valid?</p>
    <p>Are packets being corrupted on the path?</p>
    <p>(e.g., detect TCP-failures, NetFlow)</p>
    <p>Is loss rate, etc., sufficient to consider this path usable?</p>
    <p>Two criteria for a working path:</p>
  </div>
  <div class="page">
    <p>Selecting Alternate Paths</p>
    <p>=&gt; Internet outages become brief delays in connection setup.</p>
    <p>Key Insight: Single-path BGP limits bogus paths from attackers!</p>
    <p>Evaluation of Shortest AS-Path Hueristic: Hosts will explore several a few bad paths per attacking AS before finding a legit path.</p>
  </div>
  <div class="page">
    <p>Optimizing Path Selection: History</p>
    <p>the past.  Also prefer similar paths.</p>
    <p>Past work suggests that AS-paths change infrequently in practice:</p>
    <p>Rexford, et al. (IMW 02)</p>
    <p>Chang, et al. (ICNP 03)</p>
    <p>Butler, et al. (CCS 06)</p>
  </div>
  <div class="page">
    <p>Optimizing Path Selection: Hints</p>
    <p>AP</p>
    <p>AS C</p>
    <p>AS Z AS X</p>
    <p>AS D</p>
    <p>If bank.com provides NO hints</p>
  </div>
  <div class="page">
    <p>Optimizing Path Selection: Hints</p>
    <p>AP</p>
    <p>AS C</p>
    <p>AS Z AS X</p>
    <p>AS D</p>
    <p>If bank.com provides hint:</p>
    <p>D</p>
    <p>AS D</p>
  </div>
  <div class="page">
    <p>Optimizing Path Selection: Hints</p>
    <p>AP</p>
    <p>AS C</p>
    <p>AS Z AS X</p>
    <p>AS D</p>
    <p>If bank.com provides hint:</p>
    <p>C D</p>
    <p>AS C AS D</p>
  </div>
  <div class="page">
    <p>Hints are Simple and Effective</p>
    <p>No additional PKI required</p>
    <p>Hints verified using end-to-end authentication mechanism.</p>
    <p>Evaluation of simple hints:</p>
    <p>Only a few TOTAL paths must be explored regardless of the number of attackers!</p>
  </div>
  <div class="page">
    <p>Evaluation: Resistance to BGP Hijacks</p>
    <p>Realistic simulation on inferred AS topology:</p>
    <p>A single tier-1 ISP acts as an availability provider.</p>
    <p>Vary number of attackers, placed in random ASes.</p>
    <p>Test each AS to see if it receives a valid route.</p>
    <p>What attack resistance can this offer, even with only one AS participating?</p>
  </div>
  <div class="page">
    <p>Resistance to BGP Hijacks</p>
    <p>Evaluate how often three source types have a path to the valid destination, while varying the number of attackers.</p>
    <p>offers a valid route.</p>
    <p>learned routes.</p>
  </div>
  <div class="page">
    <p>ACR Resists BGP Hijacks</p>
  </div>
  <div class="page">
    <p>ACR Resists BGP Hijacks</p>
  </div>
  <div class="page">
    <p>Preventing BGP Availability Attacks</p>
    <p>Single-Path BGP ACR</p>
    <p>Requirements for a successful BGP availability</p>
    <p>attack</p>
    <p>Attacker must get victim to</p>
    <p>hear a path that is better than its current path.</p>
    <p>Attacker must prevent AP</p>
    <p>from hearing any valid path</p>
  </div>
  <div class="page">
    <p>Adoptability Advantages</p>
    <p>Low Barriers to Entry</p>
    <p>Strong Deployment Incentives</p>
    <p>Drives Incremental Control Plane Security</p>
    <p>Performance Benefits of Multipath</p>
  </div>
  <div class="page">
    <p>Adoptability Advantages</p>
    <p>Low Barriers to Entry</p>
    <p>No routing PKI, registries, or S*BGP standardization.  End-to-end security is already widely deployed.  Router hardware already supports deflections.</p>
    <p>Strong Deployment Incentives</p>
    <p>Drives Incremental Control Plane Security</p>
    <p>Performance Benefits of Multipath</p>
  </div>
  <div class="page">
    <p>Adoptability Advantages</p>
    <p>Low Barriers to Entry</p>
    <p>Strong Deployment Incentives</p>
    <p>Drives Incremental Control Plane Security</p>
    <p>Performance Benefits of Multipath</p>
    <p>Large ISPs can sell path diversity as a service.  Edge networks receive immediate security benefits.</p>
  </div>
  <div class="page">
    <p>Adoptability Advantages</p>
    <p>Low Barriers to Entry</p>
    <p>Strong Deployment Incentives</p>
    <p>Drives Incremental Control Plane Security</p>
    <p>Performance Benefits of Multipath</p>
    <p>Path selection optimizations (e.g., hints) provide incentives for additional routing security.</p>
  </div>
  <div class="page">
    <p>Adoptability Advantages</p>
    <p>Low Barriers to Entry</p>
    <p>Strong Deployment Incentives</p>
    <p>Drives Incremental Control Plane Security</p>
    <p>Performance Benefits of Multipath</p>
    <p>Multipath also supports selection of high performance (e.g., low latency) paths.</p>
  </div>
  <div class="page">
    <p>Contributions of ACR</p>
  </div>
  <div class="page">
    <p>Thanks!</p>
    <p>Joint work with: Ioannis Avramopoulos (Princeton)</p>
    <p>David G. Andersen (CMU) Jennifer Rexford (Princeton)</p>
    <p>Contact:</p>
    <p>Dan Wendlandt (CMU)</p>
    <p>dwendlan@cs.cmu.edu</p>
    <p>Questions &amp; Comments Please!</p>
  </div>
  <div class="page">
    <p>Handling Traffic Analysis Attacks?</p>
    <p>S*BGP ACR</p>
    <p>Cryptographic path attestation makes it difficult for attacker</p>
    <p>to get on path</p>
    <p>Path selection heuristics like route history and hints</p>
    <p>avoid new and suspicious paths</p>
    <p>Is it worth the added complexity of S*BGP?</p>
    <p>S*BGP provides stronger protection against malicious ASes getting on path, but both are vulnerable to traffic</p>
    <p>analysis by well-connected ASes. Only end-to-end techniques (e.g., mix-nets) offer strong protection.</p>
  </div>
  <div class="page">
    <p>Handling Hijacks of Unused Address Space?</p>
    <p>S*BGP ACR</p>
    <p>Cryptographic database of prefix</p>
    <p>ownership has routers reject invalid</p>
    <p>announcements.</p>
    <p>Routers accept all announcements.</p>
    <p>Is it worth the added complexity of S*BGP?</p>
    <p>Unused hijacks are a lesser threat, as they do not compromise availability. Those needing to block traffic</p>
    <p>from such addresses can easily use bogon-like filters.</p>
  </div>
  <div class="page">
    <p>What about stupid users?</p>
    <p>Single-Path: If an e2e authentication check fails, the only alternative is no reachability. Thus, they prompt the user as a last resort.</p>
    <p>Multi-Path: If one check fails, explore alternates until authentication works. No need to prompt the user unless all paths fail.</p>
  </div>
  <div class="page">
    <p>But Youre Just Asking for More From Sources!</p>
    <p>Yes! But consider that: 1) End-to-end security is already widely</p>
    <p>deployed for many types of traffic. 2) Deploying changes on the edge is easier</p>
    <p>(look at speed of SSL/IPSec adoption!) 3) No need for global agreement on a single</p>
    <p>best approach 4) Immediate benefits for any application that</p>
    <p>adds end-to-end security.</p>
  </div>
  <div class="page">
    <p>Sure, But Isnt This Just a Stop-gap?</p>
    <p>Not really: It would likely solve the problem more quickly than S*BGP, but:</p>
    <p>=&gt; ACR offers evolving adoptability path.</p>
  </div>
  <div class="page">
    <p>Compromised routers in AP network?</p>
    <p>Attacks on APs internal routes possible, but prevention &amp; detection is significantly easier</p>
    <p>Internal network probing can easily be done securely.</p>
    <p>Defenses can use knowledge of complete true network topology</p>
    <p>Link-state routing protocols are significantly easier to secure.</p>
    <p>Highest robustness from having multiple independent tier-1s as availability providers.</p>
    <p>Paths through other egress routers will still be valid.</p>
  </div>
  <div class="page">
    <p>Q1: Resistance to Attacks</p>
    <p>Tier-1 AP protection degrades slightly with</p>
    <p>local attackers.</p>
  </div>
  <div class="page">
    <p>Q1: Adding Customer-Only Filters</p>
  </div>
  <div class="page">
    <p>Q2: Path Exploration with Intelligent Attacker</p>
  </div>
  <div class="page">
    <p>Handling Availability Attacks?</p>
    <p>S*BGP ACR</p>
    <p>Control Plane</p>
    <p>Availability</p>
    <p>Data Plane Availability</p>
    <p>Single-Path, PKI, registry &amp; signatures</p>
    <p>Multi-Path, probing to</p>
    <p>find working pathsNone</p>
  </div>
  <div class="page">
    <p>Two Views</p>
    <p>The Optimist:</p>
    <p>It will be YEARS before S*BGP is in</p>
    <p>full use.</p>
    <p>The Pessimist:</p>
    <p>This is NEVER going to happen.</p>
    <p>Members of both sides are asking:</p>
    <p>- How will everyone agree on one protocol, and one PKI?</p>
    <p>- What incentives are there for ISPs to invest in adoption?</p>
    <p>- What can we do in the mean time?</p>
    <p>- What is the real problem here???</p>
  </div>
  <div class="page">
    <p>Progress with Secure Routing Protocols</p>
    <p>97: S-BGP started</p>
    <p>93: Kumar, authenticated inter-domain route updates</p>
    <p>96: Smith, path and origin</p>
    <p>validation</p>
    <p>98: Bates, DNS to</p>
    <p>verify AS origin</p>
    <p>02: so-BGP</p>
    <p>03: IRV</p>
    <p>04: SPV</p>
    <p>04: Listen &amp; Whisper</p>
    <p>05: psBGP</p>
    <p>06: APNIC begins cert. generation software</p>
    <p>dev.</p>
    <p>Still, no agreement on a protocol or a PKI</p>
  </div>
</Presentation>
