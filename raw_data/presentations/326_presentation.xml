<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Are Text-Only Data Formats Safe? Stephen Checkoway, Hovav Shacham, Eric Rescorla</p>
  </div>
  <div class="page">
    <p>Intuitive data-safety scale</p>
    <p>Unsafe Safe</p>
    <p>Executables ASCII TextMedia</p>
    <p>Web Applications Documents</p>
  </div>
  <div class="page">
    <p>TEX</p>
    <p>Document preparation language</p>
    <p>7-bit ASCII text</p>
    <p>Understands boxes and glue</p>
    <p>Makes pretty equations</p>
    <p>D(H!R) = !</p>
    <p>x,y!X</p>
    <p>H(x, y) log H(x, y)</p>
    <p>R(x, y)</p>
    <p>boxes and glue</p>
  </div>
  <div class="page">
    <p>How we use TEX</p>
    <p>TEX</p>
  </div>
  <div class="page">
    <p>Intuitive data-safety scale</p>
    <p>Unsafe Safe</p>
    <p>Executables ASCII TextMedia</p>
    <p>Web Applications Documents TEX</p>
  </div>
  <div class="page">
    <p>More TEX</p>
    <p>Turing-complete, macro language: \def</p>
    <p>Read/write files: \read, \write</p>
    <p>Extremely malleable syntax: \catcode</p>
  </div>
  <div class="page">
    <p>Taking control with TEX</p>
    <p>Distribution Operating System</p>
    <p>How</p>
    <p>Write to Startup</p>
    <p>TEX Live Write to web</p>
    <p>directory</p>
  </div>
  <div class="page">
    <p>LATEX virus lifecycle</p>
    <p>Compile sploit.tex</p>
    <p>C:\DOCUME~1\ADMINI~1\STARTM~1 \PROGRAMS\STARTUP\sploit.js</p>
    <p>Restart computer</p>
    <p>sploit.js finds .tex files; inserts the virus</p>
  </div>
  <div class="page">
    <p>Data exfiltration</p>
    <p>Read sensitive files</p>
    <p>\input, \include</p>
    <p>\read, \readline</p>
    <p>Typeset data in output PDF</p>
  </div>
  <div class="page">
    <p>Input filtering</p>
    <p>Filter out dangerous control sequences</p>
    <p>Math mode</p>
  </div>
  <div class="page">
    <p>TEXniques to bypass filters  Macros like \input</p>
    <p>\@input, \@iinput, \@input@, \@@input</p>
    <p>\lstinputlisting, \verbatiminput</p>
    <p>Bypass filters</p>
    <p>\csname, \begin, ^^xy, \catcode</p>
    <p>Escape math mode</p>
    <p>\end{eqnarray}, \end{align} 11Tuesday, April 27, 2010</p>
  </div>
  <div class="page"/>
  <div class="page">
    <p>TEXs malleability</p>
    <p>Category codes control functionality</p>
    <p>Can be changed by \catcode \catcode`Z=0 ZTeX</p>
  </div>
  <div class="page">
    <p>An example: xii.tex \let~\catcode~`76~`A13~`F1~`j00~`P2jdefA71F~`7113jdefPALLF PA''FwPA;;FPAZZFLaLPA//71F71iPAHHFLPAzzFenPASSFthP;A$$FevP A@@FfPARR717273F737271P;ADDFRgniPAWW71FPATTFvePA**FstRsamP AGGFRruoPAqq71.72.F717271PAYY7172F727171PA??Fi*LmPA&amp;&amp;71jfi Fjfi71PAVVFjbigskipRPWGAUU71727374 75,76Fjpar71727375Djifx :76jelse&amp;U76jfiPLAKK7172F71l7271PAXX71FVLnOSeL71SLRyadR@oL RrhC?yLRurtKFeLPFovPgaTLtReRomL;PABB71 72,73:Fjif.73.jelse B73:jfiXF71PU71 72,73:PWs;AMM71F71diPAJJFRdriPAQQFRsreLPAI I71Fo71dPA!!FRgiePBt'el@ lTLqdrYmu.Q.,Ke;vz vzLqpip.Q.,tz; ;Lql.IrsZ.eap,qn.i. i.eLlMaesLdRcna,;!;h htLqm.MRasZ.ilk,% s$;z zLqs'.ansZ.Ymi,/sx ;LYegseZRyal,@i;@ TLRlogdLrDsW,@;G LcYlaDLbJsW,SWXJW ree @rzchLhzsW,;WERcesInW qt.'oL.Rtrul;e doTsW,Wk;Rri@stW aHAHHFndZPpqar.tridgeLinZpe.LtYer.W,:jbye</p>
    <p>By David Carlisle</p>
  </div>
  <div class="page">
    <p>Conclusions</p>
    <p>Binary/text distinction not a good classifier</p>
    <p>Arbitrary code execution</p>
    <p>Exfiltrate sensitive data</p>
  </div>
  <div class="page">
    <p>Questions?</p>
    <p>Owning people through a typesetting language; it seems unsporting, somehow.  Keaton Mowery</p>
  </div>
</Presentation>
