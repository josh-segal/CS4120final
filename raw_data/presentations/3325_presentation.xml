<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>DGArchive A Comprehensive Measurement Study of Domain Generating Malware</p>
    <p>Daniel Plohmann, Khaled Yakdan, Michael Klatt, Johannes Bader, Elmar Padilla</p>
  </div>
  <div class="page">
    <p>Agenda</p>
    <p>Intro: Domain Generation Algorithms</p>
    <p>Summary of Findings</p>
    <p>Data Set</p>
    <p>DGA Taxonomy</p>
    <p>DGA Registrations &amp; Collisions</p>
    <p>Conclusion</p>
  </div>
  <div class="page">
    <p>Intro</p>
    <p>Domain Generation Algorithms</p>
  </div>
  <div class="page">
    <p>Domain Generation Algorithms Definitions</p>
    <p>Concept first described ~2008: Domain Flux</p>
    <p>Domain Generation Algorithm (DGA)  An algorithm producing Command &amp; Control rendezvous points dynamically</p>
    <p>Shared secret between malware running on compromised host and botmaster</p>
    <p>Seeds  Collection of parameters influencing the output of the algorithm</p>
    <p>Algorithmically-Generated Domain (AGD)  Domains resulting from a DGA</p>
  </div>
  <div class="page">
    <p>Domain Generation Algorithms Motivation for Usage</p>
    <p>Aggravation of Analysis  No hardcoded domains / dumping -&gt; code analysis needed</p>
    <p>Evasion  Many DGAs have short-lived domains -&gt; avoid blacklisting</p>
    <p>Backup  Registration only when needed</p>
    <p>Asymmetry  Attacker needs one domain, defender needs to prohibit access to all</p>
    <p>Feasability of DGAs  Domains are cheap</p>
  </div>
  <div class="page">
    <p>TL;DR</p>
    <p>Key Findings</p>
  </div>
  <div class="page">
    <p>Key Findings What we did</p>
    <p>Recovered 43 DGA implementations through reverse engineering  Average effort: 1 day per DGA, 1 hour per seed</p>
    <p>We used 253 seeds to generate 159,712,234 unique AGDs  Derived characteristics and a taxonomy</p>
    <p>Analyzed collisions between DGAs</p>
    <p>Checked WHOIS records for 18,446,125 domains of 38 families  Analyzed registration status and behavior over time</p>
    <p>Analyzed collisions with benign domains</p>
  </div>
  <div class="page">
    <p>Key Findings What we found out</p>
    <p>3/43 DGAs compose their domains based on wordlists  Previous detection methodology for DGA identification remains relevant,</p>
    <p>e.g. Detecting the Rise of DGA based malware, Antonakakis et al., 2012.</p>
    <p>DGAs increase in relevance:  25/43 DGAs appeared 2013 and later (first DGA spotted in 2008)</p>
    <p>From a botmaster perspective, DGAs are effective  AGDs rarely / barely mitigated in time</p>
    <p>Previous takedowns had significant financial efforts for domain purchase</p>
    <p>DGA domains barely collide (with other DGAs or benign domains)  DGA domains are a great feature to identify the malware family &amp; campaign</p>
    <p>Lists of DGA domains can be used for blocking with basically zero FPs</p>
  </div>
  <div class="page">
    <p>DGArchive</p>
    <p>Data Set</p>
  </div>
  <div class="page">
    <p>DGArchive The idea</p>
    <p>Core idea:  Reverse engineer DGAs, then generate and archive all possible domains since first</p>
    <p>spotting of the respective malware family</p>
    <p>DGArchive</p>
    <p>Domain Lookups</p>
    <p>Blocklist Generation</p>
    <p>pcxeyx.biz?</p>
    <p>Nymaim!</p>
    <p>Valid on: 2014-04-19 2014-03-20 2015-12-11</p>
    <p>[...] &quot;qetyxeg.com&quot;,&quot;simda&quot; &quot;puvywup.com&quot;,&quot;simda&quot; &quot;gahyfow.com&quot;,&quot;simda&quot; &quot;lyryxen.com&quot;,&quot;simda&quot; &quot;vocyquc.com&quot;,&quot;simda&quot; &quot;qegyfil.com&quot;,&quot;simda&quot; &quot;puryxag.com&quot;,&quot;simda&quot; &quot;gacyqys.com&quot;,&quot;simda&quot; [...]</p>
  </div>
  <div class="page">
    <p>Finding DGAs Mining a Sandbox DNS feed</p>
    <p>Remix of academic approaches and common sense  Input: Lists of domains, as queried during a sandbox runs</p>
    <p>DNS Feed by THANK YOU!!!</p>
    <p>Paper: 1,235,443 sandbox runs; 15,660,256 DNS queries (959,607 unique)</p>
    <p>By now: 8,800,652 sandbox runs; 81,661,353 DNS queries (4,782,015 unique)</p>
    <p>Known Patterns of DGAs 1. Length 2. Alphabets 3. TLDs</p>
    <p>New Seed?</p>
    <p>New DGA?</p>
    <p>Ma tch</p>
    <p>?</p>
    <p>No Match / Inconsistency</p>
  </div>
  <div class="page">
    <p>DGArchive Status</p>
    <p>Data set used in this paper (September 2015)  43 families/variants, 253 seeds, 20+ million domains</p>
    <p>DGArchive Today  59 families/variants, 511 seeds, 49+ million domains</p>
    <p>Web-service used by 300+ parties, including ISPs, financial institutions, CERTs, LEA, AVs, researchers</p>
  </div>
  <div class="page">
    <p>DGA Taxonomy</p>
  </div>
  <div class="page">
    <p>DGA Features Taxonomy and Generation Schemes</p>
    <p>DGA Classes (cp. Barabosch et al. [1]):</p>
    <p>Generation Schemes</p>
    <p>Type Time dependent Deterministic Example</p>
    <p>TID   Kraken, TinyBanker</p>
    <p>TDD   Conficker, Gameover Zeus</p>
    <p>TDN   Torpig, Bedep</p>
    <p>TIN</p>
    <p>[1] https://net.cs.uni-bonn.de/fileadmin/user_upload/wichmann/Extraction_DNGA_Malware.pdf</p>
    <p>Type Example Family Example Domain</p>
    <p>Arithmetic (A) DirCrypt pibqzedhzwt.com</p>
    <p>Wordlist (W) Matsnu termacceptyear.com</p>
    <p>Hashing (H) Bamital b83ed4877eec1997fcc39b7ae590007a.info</p>
    <p>Permutation (P) VolatileCedar dotnetexplorer.info</p>
  </div>
  <div class="page">
    <p>DGA</p>
    <p>Domain Usage</p>
  </div>
  <div class="page">
    <p>DGA Domain Space as seen by DGArchive</p>
    <p>What we were interested in:  How many potential DGA domains are there?</p>
    <p>How many of these domains are registered?</p>
    <p>Are there collisions between DGAs / benign domains?</p>
    <p>Are there recognizable patterns when TD* DGA domains are registered?</p>
    <p>How effective have been mitigations against DGA malware in the past?</p>
  </div>
  <div class="page">
    <p>DGA Domain Space as seen by DGArchive</p>
    <p>Data set fixed on 22nd September 2015  AGDs generated from malwares first spotting until 31.12.2015</p>
    <p>DomainTools provided historic WHOIS data for this study</p>
    <p>Evaluation of WHOIS features for majority of DGAs  Sinkholes</p>
    <p>Mitigations (registration turned to sinkhole at later point)</p>
    <p>Pre-registrations (registration before appearence of the family)</p>
    <p>Domain Parking</p>
  </div>
  <div class="page">
    <p>Bamital</p>
    <p>Banjori</p>
    <p>Bedep</p>
    <p>Conficker</p>
    <p>Cryptolocker</p>
    <p>DirCrypt</p>
    <p>Dyre</p>
    <p>Fobber</p>
    <p>Geodo</p>
    <p>Gameover DGA</p>
    <p>Gameover P2P</p>
    <p>Gozi</p>
    <p>Hesperbot</p>
    <p>Kraken</p>
    <p>Matsnu</p>
    <p>Mewsei</p>
    <p>Murofet 1</p>
    <p>Murofet 2</p>
    <p>Necurs</p>
    <p>Nymaim</p>
    <p>Pushdo</p>
    <p>Pushdo TID</p>
    <p>Pykspa 1</p>
    <p>Pykspa 2</p>
    <p>QakBot</p>
    <p>Ramdo</p>
    <p>Ramnit</p>
    <p>Ranbyus</p>
    <p>Redyms</p>
    <p>Rovnix</p>
    <p>Shifu</p>
    <p>Simda</p>
    <p>Suppobox</p>
    <p>Szribi</p>
    <p>Tempedreve</p>
    <p>TinyBanker</p>
    <p>Torpig</p>
    <p>UrlZone</p>
    <p>Virut</p>
    <p>CoreBot</p>
    <p>Generated Domains?</p>
  </div>
  <div class="page">
    <p>Bamital</p>
    <p>Banjori</p>
    <p>Bedep</p>
    <p>Conficker</p>
    <p>Cryptolocker</p>
    <p>DirCrypt</p>
    <p>Dyre</p>
    <p>Fobber</p>
    <p>Geodo</p>
    <p>Gameover DGA</p>
    <p>Gameover P2P</p>
    <p>Gozi</p>
    <p>Hesperbot</p>
    <p>Kraken</p>
    <p>Matsnu</p>
    <p>Mewsei</p>
    <p>Murofet 1</p>
    <p>Murofet 2</p>
    <p>Necurs</p>
    <p>Nymaim</p>
    <p>Pushdo</p>
    <p>Pushdo TID</p>
    <p>Pykspa 1</p>
    <p>Pykspa 2</p>
    <p>QakBot</p>
    <p>Ramdo</p>
    <p>Ramnit</p>
    <p>Ranbyus</p>
    <p>Redyms</p>
    <p>Rovnix</p>
    <p>Shifu</p>
    <p>Simda</p>
    <p>Suppobox</p>
    <p>Szribi</p>
    <p>Tempedreve</p>
    <p>TinyBanker</p>
    <p>Torpig</p>
    <p>UrlZone</p>
    <p>Virut</p>
    <p>CoreBot</p>
    <p>DDNS 18,160</p>
    <p>DDNS 1,984</p>
    <p>DDNS 300</p>
    <p>Registrations: 115,079 (0.62%) of 18,465,427 unique domains we had data for.Registrations?</p>
  </div>
  <div class="page">
    <p>Bamital</p>
    <p>Cryptolocker</p>
    <p>Gameover P2P</p>
    <p>Takedowns actually account for 72,56% of all considered DGA registrations. 78,326 of 115,387 total registrations</p>
    <p>#domains</p>
    <p>percent</p>
    <p>Non-Takedown: 31,884</p>
    <p>Pre-registered: 9,646 30.25% Mitigated: 1,199 3.76% Sinkhole: 5,177 16.24% Remainder: 15,862 49.75%</p>
  </div>
  <div class="page">
    <p>DGA Domain Space Domain Collisions</p>
    <p>DGA domains may collide  With other DGAs</p>
    <p>With benign domains</p>
  </div>
  <div class="page">
    <p>Bamital</p>
    <p>Banjori</p>
    <p>Bedep</p>
    <p>Conficker</p>
    <p>Cryptolocker</p>
    <p>DirCrypt</p>
    <p>Dyre</p>
    <p>Fobber</p>
    <p>Geodo</p>
    <p>Gameover DGA</p>
    <p>Gameover P2P</p>
    <p>Gozi</p>
    <p>Hesperbot</p>
    <p>Kraken</p>
    <p>Matsnu</p>
    <p>Mewsei</p>
    <p>Murofet 1</p>
    <p>Murofet 2</p>
    <p>Necurs</p>
    <p>Nymaim</p>
    <p>Pushdo</p>
    <p>Pushdo TID</p>
    <p>Pykspa 1</p>
    <p>Pykspa 2</p>
    <p>QakBot</p>
    <p>Ramdo</p>
    <p>Ramnit</p>
    <p>Ranbyus</p>
    <p>Redyms</p>
    <p>Rovnix</p>
    <p>Shifu</p>
    <p>Simda</p>
    <p>Suppobox</p>
    <p>Szribi</p>
    <p>Tempedreve</p>
    <p>TinyBanker</p>
    <p>Torpig</p>
    <p>UrlZone</p>
    <p>Virut</p>
    <p>CoreBot</p>
    <p>How many domain collisions between Conficker+Virut and the other DGAs?</p>
  </div>
  <div class="page">
    <p>Conficker Necurs</p>
    <p>Nymaim</p>
    <p>Pykspa 2</p>
    <p>Considerably low (3,301 / 159,712,234).</p>
    <p>Virut</p>
  </div>
  <div class="page">
    <p>Bamital</p>
    <p>Banjori</p>
    <p>Bedep</p>
    <p>Conficker</p>
    <p>Cryptolocker</p>
    <p>DirCrypt</p>
    <p>Dyre</p>
    <p>Fobber</p>
    <p>Geodo</p>
    <p>Gameover DGA</p>
    <p>Gameover P2P</p>
    <p>Gozi</p>
    <p>Hesperbot</p>
    <p>Kraken</p>
    <p>Matsnu</p>
    <p>Mewsei</p>
    <p>Murofet 1</p>
    <p>Murofet 2</p>
    <p>Necurs</p>
    <p>Nymaim</p>
    <p>Pushdo</p>
    <p>Pushdo TID</p>
    <p>Pykspa 1</p>
    <p>Pykspa 2</p>
    <p>QakBot</p>
    <p>Ramdo</p>
    <p>Ramnit</p>
    <p>Ranbyus</p>
    <p>Redyms</p>
    <p>Rovnix</p>
    <p>Shifu</p>
    <p>Simda</p>
    <p>Suppobox</p>
    <p>Szribi</p>
    <p>Tempedreve</p>
    <p>TinyBanker</p>
    <p>Torpig</p>
    <p>UrlZone</p>
    <p>Virut</p>
    <p>CoreBot</p>
    <p>And now without Conficker &amp; Virut?</p>
  </div>
  <div class="page">
    <p>Nymaim</p>
    <p>Pykspa 2</p>
    <p>One single collision!</p>
    <p>One single collision between Nymaim and Pykspa2</p>
    <p>wttttf.net!</p>
  </div>
  <div class="page">
    <p>Bamital</p>
    <p>Banjori</p>
    <p>Bedep</p>
    <p>Conficker</p>
    <p>Cryptolocker</p>
    <p>DirCrypt</p>
    <p>Dyre</p>
    <p>Fobber</p>
    <p>Geodo</p>
    <p>Gameover DGA</p>
    <p>Gameover P2P</p>
    <p>Gozi</p>
    <p>Hesperbot</p>
    <p>Kraken</p>
    <p>Matsnu</p>
    <p>Mewsei</p>
    <p>Murofet 1</p>
    <p>Murofet 2</p>
    <p>Necurs</p>
    <p>Nymaim</p>
    <p>Pushdo</p>
    <p>Pushdo TID</p>
    <p>Pykspa 1</p>
    <p>Pykspa 2</p>
    <p>QakBot</p>
    <p>Ramdo</p>
    <p>Ramnit</p>
    <p>Ranbyus</p>
    <p>Redyms</p>
    <p>Rovnix</p>
    <p>Shifu</p>
    <p>Simda</p>
    <p>Suppobox</p>
    <p>Szribi</p>
    <p>Tempedreve</p>
    <p>TinyBanker</p>
    <p>Torpig</p>
    <p>UrlZone</p>
    <p>VolatileCedar</p>
    <p>CoreBot</p>
    <p>Inter-DGA domain collisions: Basically non-existent!</p>
    <p>Conclusions:</p>
    <p>So if there are so few collisions between DGAs  using pre-calculated AGDs to tag malware is extremely accurate!</p>
    <p>For both family and campaign</p>
    <p>Effectively NO False Positives for domain length 7+</p>
  </div>
  <div class="page">
    <p>Bamital</p>
    <p>Banjori</p>
    <p>Bedep</p>
    <p>Conficker</p>
    <p>Cryptolocker</p>
    <p>DirCrypt</p>
    <p>Dyre</p>
    <p>Fobber</p>
    <p>Geodo</p>
    <p>Gameover DGA</p>
    <p>Gameover P2P</p>
    <p>Gozi</p>
    <p>Hesperbot</p>
    <p>Kraken</p>
    <p>Matsnu</p>
    <p>Mewsei</p>
    <p>Murofet 1</p>
    <p>Murofet 2</p>
    <p>Necurs</p>
    <p>Nymaim</p>
    <p>Pushdo</p>
    <p>Pushdo TID</p>
    <p>Pykspa 1</p>
    <p>Pykspa 2</p>
    <p>QakBot</p>
    <p>Ramdo</p>
    <p>Ramnit</p>
    <p>Ranbyus</p>
    <p>Redyms</p>
    <p>Rovnix</p>
    <p>Shifu</p>
    <p>Simda</p>
    <p>Suppobox</p>
    <p>Szribi</p>
    <p>Tempedreve</p>
    <p>TinyBanker</p>
    <p>Torpig</p>
    <p>UrlZone</p>
    <p>Virut</p>
    <p>CoreBot</p>
    <p>Pre-Registrations: Wordlist-DGAs and short domains cause the most collisions.</p>
  </div>
  <div class="page">
    <p>Bamital</p>
    <p>Banjori</p>
    <p>Bedep</p>
    <p>Conficker</p>
    <p>Cryptolocker</p>
    <p>DirCrypt</p>
    <p>Dyre</p>
    <p>Fobber</p>
    <p>Geodo</p>
    <p>Gameover DGA</p>
    <p>Gameover P2P</p>
    <p>Gozi</p>
    <p>Hesperbot</p>
    <p>Kraken</p>
    <p>Matsnu</p>
    <p>Mewsei</p>
    <p>Murofet 1</p>
    <p>Murofet 2</p>
    <p>Necurs</p>
    <p>Nymaim</p>
    <p>Pushdo</p>
    <p>Pushdo TID</p>
    <p>Pykspa 1</p>
    <p>Pykspa 2</p>
    <p>QakBot</p>
    <p>Ramdo</p>
    <p>Ramnit</p>
    <p>Ranbyus</p>
    <p>Redyms</p>
    <p>Rovnix</p>
    <p>Shifu</p>
    <p>Simda</p>
    <p>Suppobox</p>
    <p>Szribi</p>
    <p>Tempedreve</p>
    <p>TinyBanker</p>
    <p>Torpig</p>
    <p>UrlZone</p>
    <p>VolatileCedar</p>
    <p>CoreBot</p>
    <p>Pre-Registrations: With some exclusions basically non-existent.</p>
    <p>Conclusions:</p>
    <p>Breakdown of Pre-Registrations (9,646)  Wordlist-DGAs: 8,726 (90.46%)</p>
    <p>Remainder: 920</p>
    <p>Short</p>
    <p>domains</p>
    <p>(length</p>
    <p>Remainder:</p>
    <p>Accidentally real words: veterans.kz</p>
    <p>Pronounceable words: kankanana.com</p>
    <p>kandilmed.com</p>
    <p>Basically no collisions with non-Wordlist DGAs or 7char+ domains  Using DGArchive for blocking -&gt; very low FP rate for blocking!</p>
    <p>jmp 69</p>
  </div>
  <div class="page">
    <p>DGA Domain Space Registration Timings</p>
    <p>Consider time-dependent DGAs  Sets of domains have a window of validity!</p>
    <p>What is registration lookahead?  Relative offset between start of validity and registration time</p>
    <p>In the following: Evaluation of registration lookaheads  For sinkholes</p>
    <p>For non-sinkholes</p>
    <p>jmp 69</p>
  </div>
  <div class="page">
    <p>Overview of registration lookaheads</p>
  </div>
  <div class="page">
    <p>Domains registered ON the first day they became valid in the DGA</p>
  </div>
  <div class="page">
    <p>Domains registered BEFORE they become valid in the DGA</p>
  </div>
  <div class="page">
    <p>Domains registered AFTER they become valid in the DGA</p>
  </div>
  <div class="page">
    <p>However, red bars show how long domains REMAIN valid</p>
  </div>
  <div class="page">
    <p>Observation: Sinkholes are often registered earlier than non-sinkholes</p>
  </div>
  <div class="page">
    <p>Observation: Some domains are registered far into the future Bamital: Same day</p>
    <p>registrations</p>
    <p>for</p>
    <p>domains</p>
    <p>in advance</p>
    <p>Nymaim: Same day registrations</p>
    <p>for</p>
    <p>domains</p>
    <p>in advance</p>
    <p>Murofet: Same day registrations</p>
    <p>for</p>
    <p>domains</p>
    <p>in advance</p>
  </div>
  <div class="page">
    <p>Observation: Reversing Fail by some sinkholer? 32 domains registered exactly one month after validity?</p>
  </div>
  <div class="page">
    <p>Wrapping up</p>
    <p>Conclusion</p>
  </div>
  <div class="page">
    <p>Conclusion Wrapping it up</p>
    <p>DGAs are a prevalent malware issue  Many active families have a DGA; 25/43 analyzed DGAs surfaced 2013+</p>
    <p>Low collisions between DGAs or with existing benign domains  Domains can be blocked with almost no FPs</p>
    <p>AGDs serve well for identifying malware family based on domains</p>
    <p>With regard to botnet takedowns  Botnet operators can be caught off-guard as they register mostly short-termed or</p>
    <p>on demand</p>
    <p>Rigorously blocking AGDs would have negliable impact on benign users, as there are close to no collisions with desirable domains</p>
    <p>We are in contact with ICANN, VeriSign, and Nominum to look into how our data can be put to good use at scale</p>
  </div>
  <div class="page">
    <p>Conclusion Wrapping it up</p>
    <p>DGArchive  Looking for more users / contributors!</p>
    <p>Request free access: daniel.plohmann@fkie.fraunhofer.de</p>
    <p>Required: basic proof of identity (e.g. no freemailer) or vetting</p>
  </div>
</Presentation>
