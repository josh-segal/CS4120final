<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Exploiting Half-Wits: Smarter Storage for Low-Power Devices</p>
    <p>Mastooreh (Negin) Salajegheh, Yue Wang Kevin Fu, Andrew Jiang, Erik Learned-Miller</p>
    <p>Supported in part by a Sloan Research Fellowship and NSF CCF-0747415, CNS-0627476, CNS-0627529, CNS-0845874, CNS-0923313, ECCS-0802107. Any opinions, findings, and conclusions expressed in this material are those of the authors and do not necessarily reflect the views of the NSF.</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11 2figure: treehugger.com</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11 2figure: treehugger.com</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>Storage on Embedded Devices</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>Storage on Embedded Devices</p>
    <p>&gt;$10 billion</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>Storage on Embedded Devices</p>
    <p>&gt;$10 billion</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>Storage on Embedded Devices</p>
    <p>&gt;$10 billion</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>On-chip Flash</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>Microcontroller with 8KB Embedded Flash</p>
    <p>Memory</p>
    <p>On-chip Flash</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>Microcontroller with 8KB Embedded Flash</p>
    <p>Memory</p>
    <p>On-chip Flash</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>CPU</p>
    <p>Flash</p>
    <p>Ideal</p>
    <p>Energy Workload 2.2 V</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>Energy  Worst case</p>
    <p>CPU</p>
    <p>Flash</p>
    <p>Ideal Actual</p>
    <p>CPU</p>
    <p>Flash</p>
    <p>Energy Workload 2.2 V</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11 7</p>
    <p>Goal of this work</p>
    <p>To reduce the wasted energy consumption for embedded storage.</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>Contribution</p>
    <p>Software for using flash memory at low voltage</p>
    <p>- Quantifying the impact on reliability - Measuring the energy savings</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>State of the Art</p>
    <p>Pick the highest voltage...Excessive power</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>State of the Art</p>
    <p>Pick the highest voltage...Excessive power  Add hardware...$$</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>State of the Art</p>
    <p>I cant remember a</p>
    <p>thing</p>
    <p>Pick the highest voltage...Excessive power  Add hardware...$$  Dont use flash memory...Ugh!</p>
    <p>[Sample:08]</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>State of the Art</p>
    <p>I cant remember a</p>
    <p>thing</p>
    <p>Pick the highest voltage...Excessive power  Add hardware...$$  Dont use flash memory...Ugh!</p>
    <p>[Sample:08]</p>
    <p>Time (ms)</p>
    <p>Vo lt ag</p>
    <p>e</p>
    <p>[Ransford: ASPLOS11]</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>Our Approach</p>
    <p>Savings: Low-voltage</p>
    <p>Write to flash memory at low voltage.</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>Our Approach</p>
    <p>Cost: Errors</p>
    <p>How hard is it to correct the errors?</p>
    <p>Savings: Low-voltage</p>
    <p>Write to flash memory at low voltage.</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11 11</p>
    <p>Write once bits (Wits)</p>
    <p>figure: http://arcweb.archives.gov</p>
    <p>[Rivest:82]</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>Partial Failure at Low Voltage</p>
    <p>Example:</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>Partial Failure at Low Voltage</p>
    <p>Example:</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>Partial Failure at Low Voltage</p>
    <p>Example:</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>Partial Failure at Low Voltage</p>
    <p>Example:</p>
    <p>Input:</p>
    <p>Result:</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>Partial Failure at Low Voltage</p>
    <p>Example:</p>
    <p>Input:</p>
    <p>Result:</p>
    <p>Error</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>Transitions at low voltage</p>
    <p>10 might fail with P0.  11 never fails (P=0).</p>
    <p>Z 1 1</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>What might influence the error rate</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>What might influence the error rate</p>
    <p>Operating voltage level</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>What might influence the error rate</p>
    <p>Operating voltage level Hamming weight of data</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>What might influence the error rate</p>
    <p>Operating voltage level Hamming weight of data Wear-out history</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>What might influence the error rate</p>
    <p>Operating voltage level Hamming weight of data Wear-out history - Neighbor cells</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>What might influence the error rate</p>
    <p>Operating voltage level Hamming weight of data Wear-out history - Neighbor cells - Permutation of 0s</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11 15</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11 15</p>
    <p>Test Platform</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11 15</p>
    <p>MonitorTest Platform</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11 15</p>
    <p>MonitorTest Platform</p>
    <p>Voltage Supply</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11 15</p>
    <p>JTAG</p>
    <p>MonitorTest Platform</p>
    <p>Voltage Supply</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11 16</p>
    <p>Er ro</p>
    <p>r ra</p>
    <p>te (</p>
    <p>% )</p>
    <p>Operating Voltage (V) M</p>
    <p>C U</p>
    <p>-a</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11 17</p>
    <p>Er ro</p>
    <p>r ra</p>
    <p>te (</p>
    <p>% )</p>
    <p>Operating Voltage (V)</p>
    <p>MCU-A</p>
    <p>M C</p>
    <p>U -a</p>
    <p>Tw o c</p>
    <p>hip s</p>
    <p>of the</p>
    <p>sam e m</p>
    <p>od el</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11 18</p>
    <p>Er ro</p>
    <p>r ra</p>
    <p>te (</p>
    <p>% ) MCU-A</p>
    <p>M C</p>
    <p>U -a</p>
    <p>M C</p>
    <p>U -B</p>
    <p>MCU-b</p>
    <p>Operating Voltage (V) Friday, March 4, 2011</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>Data Hamming Weight</p>
    <p>Hamming weight</p>
    <p>E rr</p>
    <p>or ra</p>
    <p>te (%</p>
    <p>)</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>Data Hamming Weight</p>
    <p>Hamming weight</p>
    <p>E rr</p>
    <p>or ra</p>
    <p>te (%</p>
    <p>)</p>
    <p>The heavier the better.</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11 20</p>
    <p>Voltage = 1.850 V</p>
    <p>r o w</p>
    <p>s (m</p>
    <p>em o ry</p>
    <p>le ng</p>
    <p>th )</p>
    <p>Error (%)</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11 20</p>
    <p>More often used</p>
    <p>Voltage = 1.850 V</p>
    <p>r o w</p>
    <p>s (m</p>
    <p>em o ry</p>
    <p>le ng</p>
    <p>th )</p>
    <p>Error (%)</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11 21</p>
    <p>Accumulative Behavior</p>
    <p>figure: steynian.wordpress.com</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>Design of a Low-voltage Storage</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>Modeling Flash Memory</p>
    <p>A set of cells  Cell state:   Initial state:  Update: set a subset of to 0  Once then a write cannot  Write Once Bits: Wits</p>
    <p>&lt; c1, ..., cn &gt;</p>
    <p>ci ! {0, 1}</p>
    <p>!i, ci = 1</p>
    <p>&lt; c1, ..., cn &gt;</p>
    <p>n</p>
    <p>ci ! 1ci = 0</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>At low voltage:</p>
    <p>might fail and remains . [Pavan:97]  There might not be enough charge stored</p>
    <p>in a cell to represent a 0: Half-Wits</p>
    <p>Modeling Flash Memory</p>
    <p>ci ! 0 ci 1</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>Design Goals</p>
    <p>Energy consumption  Error rate  Delay</p>
    <p>Minimize:</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>Proposed Techniques</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11 27</p>
    <p>Initialization: 1</p>
    <p>Negative Logic</p>
    <p>}Cell</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11 27</p>
    <p>Initialization: 1 Written: 0</p>
    <p>Negative Logic</p>
    <p>Charge</p>
    <p>}Cell</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>Repeatedly attempt a write to the same location.</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>Repeatedly attempt a write to the same location.  Example: One bit over time</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>Repeatedly attempt a write to the same location.  Example: One bit over time</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>Repeatedly attempt a write to the same location.  Example: One bit over time</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>Repeatedly attempt a write to the same location.  Example: One bit over time</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>In-place writes</p>
    <p>Er ro</p>
    <p>r ra</p>
    <p>te (</p>
    <p>% )</p>
    <p>Ineffective</p>
    <p>Effective</p>
    <p># sequential in-place writes</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>In-place writes</p>
    <p>Er ro</p>
    <p>r ra</p>
    <p>te (</p>
    <p>% )</p>
    <p>Ineffective</p>
    <p>Effective</p>
    <p># sequential in-place writes</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11 31</p>
    <p>Er ro</p>
    <p>r ra</p>
    <p>te (</p>
    <p>% ) 1.87</p>
    <p>In-place writes</p>
    <p># sequential in-place writes</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>Ce ll 1</p>
    <p>Encoding: Write to more than one location.</p>
    <p>Ce ll 2</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>Ce ll 1</p>
    <p>Encoding: Write to more than one location.</p>
    <p>Ce ll 2</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>Ce ll 1</p>
    <p>Encoding: Write to more than one location.</p>
    <p>Decoding: AND all of the values at read time.</p>
    <p>&amp; Ce</p>
    <p>ll 2</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>Ce ll 1</p>
    <p>Encoding: Write to more than one location.</p>
    <p>Decoding: AND all of the values at read time.</p>
    <p>Ce ll 2</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>Multiple-place writes</p>
    <p>Er ro</p>
    <p>r ra</p>
    <p>te (</p>
    <p>% )</p>
    <p># places to store data</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>Design Goals</p>
    <p>Energy consumption</p>
    <p>Delay  Error rate</p>
    <p>Minimize:</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>Comparison at 1.9 V</p>
    <p>Store: Accelerometer trace Repeating the writes 2 times/ locations</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>Comparison at 1.9 V</p>
    <p>Method Time (ms) Energy (J)</p>
    <p>In-place 15.43 38</p>
    <p>Multiple-place 16.85 40</p>
    <p>Store: Accelerometer trace Repeating the writes 2 times/ locations</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>Comparison at 1.9 V</p>
    <p>Method Time (ms) Energy (J)</p>
    <p>In-place 15.43 38</p>
    <p>Multiple-place 16.85 40</p>
    <p>Store: Accelerometer trace Repeating the writes 2 times/ locations</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11 36</p>
    <p>Micro-benchmarks:</p>
    <p>Standard approach</p>
    <p>at</p>
    <p>high voltage</p>
    <p>In-Place writes</p>
    <p>at</p>
    <p>low voltage</p>
    <p>vs</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11 37</p>
    <p>Retrieve StoreN o rm</p>
    <p>al iz</p>
    <p>ed e</p>
    <p>ne rg</p>
    <p>y co</p>
    <p>ns um</p>
    <p>pt io</p>
    <p>n</p>
    <p>RC5</p>
    <p>in-place 1.8 V in-place 1.9 V Standard 2.2 V Standard 3.0 V</p>
    <p>[Rivest:94]</p>
    <p>Half-wits Vs. Wits</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>RC5 38</p>
    <p>StoreN o rm</p>
    <p>al iz</p>
    <p>ed e</p>
    <p>ne rg</p>
    <p>y co</p>
    <p>ns um</p>
    <p>pt io</p>
    <p>n in-place 1.8 V in-place 1.9 V Standard 2.2 V Standard 3.0 V</p>
    <p>Retrieve</p>
    <p>Half-wits Vs. Wits</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>RetrieveRC5 39</p>
    <p>N o rm</p>
    <p>al iz</p>
    <p>ed e</p>
    <p>ne rg</p>
    <p>y co</p>
    <p>ns um</p>
    <p>pt io</p>
    <p>n in-place 1.8 V in-place 1.9 V Standard 2.2 V Standard 3.0 V</p>
    <p>Store</p>
    <p>Half-wits Vs. Wits</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>RetrieveRC5</p>
    <p>Half-wits Vs. Wits</p>
    <p>N o rm</p>
    <p>al iz</p>
    <p>ed e</p>
    <p>ne rg</p>
    <p>y co</p>
    <p>ns um</p>
    <p>pt io</p>
    <p>n in-place 1.8 V in-place 1.9 V Standard 2.2 V Standard 3.0 V</p>
    <p>Store</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>Hypothesis</p>
    <p>For CPU-bound workloads:</p>
    <p>Energy of high-voltage</p>
    <p>system</p>
    <p>Energy of low-voltage</p>
    <p>system &lt;</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>Monitoring application</p>
    <p>Read 256 bytes of accelerometer data  Aggregate data: Min, Max, Mean, Std. dev.  Write the aggregation of 256 bytes of data</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11 43</p>
    <p>--- --</p>
    <p>--</p>
    <p>-</p>
    <p>In-place Writes</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>Monitoring application</p>
    <p>Method In-place</p>
    <p>Energy (J) 270 300 410 760</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>Monitoring application</p>
    <p>Method In-place</p>
    <p>Energy (J) 270 300 410 760</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>Monitoring application</p>
    <p>Method In-place</p>
    <p>Energy (J) 270 300 410 760</p>
    <p>In-place 1.9 V</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>Further improvements</p>
    <p>[Papirla:09]</p>
  </div>
  <div class="page">
    <p>Mastooreh Salajegheh, USENIX FAST 11</p>
    <p>Summary: Exploiting Half-Wits</p>
    <p>In-place writes on half-wits is an effective way to reduce wasted energy.</p>
    <p>Microcontrollers can work at a lower voltage and get more work done with the same amount of energy.</p>
    <p>The digital abstractions pay a higher price than necessary to provide reliability.</p>
  </div>
</Presentation>
