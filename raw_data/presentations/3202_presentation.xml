<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Local Context in Nonlinear Deformation Models for Handwritten Character Recognition</p>
    <p>Daniel Keysers  Christian Gollan  Hermann Ney</p>
    <p>Lehrstuhl fr Informatik VI Human Language Technology and Pattern Recognition</p>
    <p>Computer Science Department RWTH Aachen University</p>
    <p>D-52056 Aachen, Germany</p>
    <p>Keysers / Context in Nonlinear Deformation Models 1 August 26, 2004</p>
  </div>
  <div class="page">
    <p>Overview</p>
    <p>Introduction</p>
    <p>State-of-the-Art</p>
    <p>Nonlinear Matching</p>
    <p>Local Context</p>
    <p>Experiments and Results</p>
    <p>Conclusion</p>
    <p>Keysers / Context in Nonlinear Deformation Models 2 August 26, 2004</p>
  </div>
  <div class="page">
    <p>Introduction</p>
    <p>object recognition  suitable models of image transformation important</p>
    <p>recognition of handwritten characters is prototypical:  different writing styles  varying appearances  reference model for each class is well-defined</p>
    <p>evaluate two-dimensional nonlinear deformation models (true two-dimensional, pseudo-two-dimensional, zero-order) using local image context of each pixel</p>
    <p>hope: fewer 2D constraints can be compensated by using local context  confirmed by experimental results</p>
    <p>very competitive results across five different tasks (e.g. 0.54% on MNIST)</p>
    <p>Keysers / Context in Nonlinear Deformation Models 3 August 26, 2004</p>
  </div>
  <div class="page">
    <p>State-of-the-Art in Character Recognition</p>
    <p>Belongie &amp; Malik+ 2002 (Berkeley)  shape context matching: shape contexts = log-polar histograms of contour points iterative matching with 2D-splines and the Hungarian algorithm</p>
    <p>DeCoste &amp; Schlkopf+ 2002 (Caltech / MPI Tbingen)  invariant SVM: use virtual data and kernel jittering in support vector machine</p>
    <p>Simard 2003 (Microsoft Research)  convolutional neural net: generate large amount of virtual data on the fly (e.g. factor 1000) during training of a well-designed neural network</p>
    <p>Keysers / Context in Nonlinear Deformation Models 4 August 26, 2004</p>
  </div>
  <div class="page">
    <p>Nonlinear Matching</p>
    <p>test image A = {aij} reference image B = {bxy} aij, bxy  IRU</p>
    <p>image deformation mapping (xIJ11 , y IJ 11 ) : (i, j) 7 (xij, yij)</p>
    <p>mappings must fulfill constraints: (xIJ11 , y IJ 11 )  M</p>
    <p>decision rule:</p>
    <p>r(A) = arg min k</p>
    <p>{ min</p>
    <p>n=1,...,Nk d(A, Bnk)</p>
    <p>}</p>
    <p>d(A, B) = min (xIJ11 ,y</p>
    <p>IJ 11 )M</p>
    <p>{ d</p>
    <p>( A, B(xIJ11 ,y</p>
    <p>IJ 11 )</p>
    <p>)}</p>
    <p>d ( A, B(xIJ11 ,y</p>
    <p>IJ 11 )</p>
    <p>) =</p>
    <p>i,j</p>
    <p>u</p>
    <p>||auij  b u xijyij</p>
    <p>||2</p>
    <p>Keysers / Context in Nonlinear Deformation Models 5 August 26, 2004</p>
  </div>
  <div class="page">
    <p>image deformation mapping (xIJ11 , y IJ 11 )  M : (i, j) 7 (xij, yij)</p>
    <p>i</p>
    <p>j y</p>
    <p>xij</p>
    <p>ij</p>
    <p>Keysers / Context in Nonlinear Deformation Models 6 August 26, 2004</p>
  </div>
  <div class="page">
    <p>Models</p>
    <p>informal descriptions of the used models:</p>
    <p>P2DHMM Pseudo 2-Dimensional Hidden Markov Model (order 1) match columns on columns, regard columns as independent</p>
    <p>P2DHMDM Pseudo 2-Dimensional Hidden Markov Distortion Model (order 1) allow additional horizontal displacements in P2DHMM</p>
    <p>IDM Image Distortion Model (order 0) disregard relative displacements of neighboring pixels restrict absolute displacement</p>
    <p>Keysers / Context in Nonlinear Deformation Models 7 August 26, 2004</p>
  </div>
  <div class="page">
    <p>Examples</p>
    <p>different classes same class</p>
    <p>P2DHMM</p>
    <p>P2DHMDM</p>
    <p>IDM</p>
    <p>Keysers / Context in Nonlinear Deformation Models 8 August 26, 2004</p>
  </div>
  <div class="page">
    <p>Local Context 1: Image Gradient</p>
    <p>error rate on USPS for P2DHMM using gray values and image gradients (Sobel)</p>
    <p>e rr</p>
    <p>o r</p>
    <p>ra te</p>
    <p>[ %</p>
    <p>]</p>
    <p>relative weight of gray values vs. gradient</p>
    <p>Keysers / Context in Nonlinear Deformation Models 9 August 26, 2004</p>
  </div>
  <div class="page">
    <p>Local Context 2: Windows</p>
    <p>Keysers / Context in Nonlinear Deformation Models 10 August 26, 2004</p>
  </div>
  <div class="page">
    <p>Experiments: Character Corpora</p>
    <p>name example images size # train # test</p>
    <p>USPS 1616 7 291 2 007</p>
    <p>UCI 88 3 823 1 797</p>
    <p>MCEDAR 88 11 000 2 711</p>
    <p>MNIST 2828 60 000 10 000</p>
    <p>ETL6A    6463 15 600 13 000</p>
    <p>all matching experiments use 33 context of gradients</p>
    <p>Keysers / Context in Nonlinear Deformation Models 11 August 26, 2004</p>
  </div>
  <div class="page">
    <p>USPS</p>
    <p>name example images size # train # test</p>
    <p>USPS 1616 7 291 2 007</p>
    <p>method ER[%] no matching, 1-NN 5.6 . . . . . . invariant SVM external 3.0 2DW, 1-NN RWTH 2.7 tangent distance, KD, virtual data RWTH 2.4 IDM, 1-NN RWTH 2.4 extended SVM training external 2.2 local features + tangent distance RWTH 2.0 P2DHMDM, 3-NN RWTH 1.9</p>
    <p>Keysers / Context in Nonlinear Deformation Models 12 August 26, 2004</p>
  </div>
  <div class="page">
    <p>UCI</p>
    <p>name example images size # train # test</p>
    <p>UCI 88 3 823 1 797</p>
    <p>method ER[%] no matching, 1-NN 2.0 PCA mixture external 1.5 P2DHMDM, 1-NN RWTH 0.8 IDM, 1-NN RWTH 0.8</p>
    <p>Keysers / Context in Nonlinear Deformation Models 13 August 26, 2004</p>
  </div>
  <div class="page">
    <p>MCEDAR</p>
    <p>name example images size # train # test</p>
    <p>MCEDAR 88 11 000 2 711</p>
    <p>method ER[%] no matching, 1-NN 5.7 PCA external 4.9 factor analysis external 4.7 probabilistic PCA external 4.6 IDM, 3-NN RWTH 3.5 P2DHMDM, 3-NN RWTH 3.3</p>
    <p>Keysers / Context in Nonlinear Deformation Models 14 August 26, 2004</p>
  </div>
  <div class="page">
    <p>MNIST</p>
    <p>name example images size # train # test</p>
    <p>MNIST 2828 60 000 10 000</p>
    <p>method ER[%] no matching, 1-NN 3.1 deslant, Euclidean distance, k-NN external 2.4 tangent distance, KD, virtual data RWTH 1.0 distortions, neural net, boosting external 0.7</p>
    <p>shape context matching, 3-NN external 0.63 invariant SVM external 0.56 IDM, 3-NN RWTH 0.54 distortions+, neural net external 0.42</p>
    <p>combination of best four systems 0.35</p>
    <p>: differences not statistically significant according to bootstrap analysis</p>
    <p>Keysers / Context in Nonlinear Deformation Models 15 August 26, 2004</p>
  </div>
  <div class="page">
    <p>ETL6A</p>
    <p>name example images size # train # test</p>
    <p>ETL6A    6463 15 600 13 000</p>
    <p>method ER[%] no matching, 1-NN 4.5 piece-wise linear 2D-HMM external 0.9 Eigen-deformations external 0.5 IDM, 3-NN RWTH 0.5</p>
    <p>Keysers / Context in Nonlinear Deformation Models 16 August 26, 2004</p>
  </div>
  <div class="page">
    <p>Learning Prototypes</p>
    <p>means without deformation</p>
    <p>means with deformation</p>
    <p>USPS error rates [%] in key experiment distance deformation in mean calculation</p>
    <p>no yes no deformation 18.6 26.1 P2DHMDM 25.3 4.9</p>
    <p>best other single-prototype result: 5.7% (Gaussian single densities, discriminative training, no deformation)</p>
    <p>Keysers / Context in Nonlinear Deformation Models 17 August 26, 2004</p>
  </div>
  <div class="page">
    <p>Conclusions</p>
    <p>Conclusions  performance increase with local context for all models  context information  very good results even with simple distortion models  excellent results for handwritten character recognition, generalizes across tasks  [combination of four best systems: 0.35% on MNIST]</p>
    <p>software + parameter examples can be downloaded from: http://www-i6.informatik.rwth-aachen.de/keysers</p>
    <p>Keysers / Context in Nonlinear Deformation Models 18 August 26, 2004</p>
  </div>
  <div class="page">
    <p>Thank you for your attention.</p>
    <p>http://www-i6.informatik.rwth-aachen.de/keysers</p>
    <p>Keysers / Context in Nonlinear Deformation Models 19 August 26, 2004</p>
  </div>
  <div class="page">
    <p>Matching Constraints</p>
    <p>model (order) restrictions on (xIJ11 , y IJ 11 )</p>
    <p>x1j = 1, xIj = X, yi1 = 1, yiJ = Y , 2DW (2) xi+1,j  xij  {0, 1, 2}, xi,j+1  xij  {1, 0, 1},</p>
    <p>yi,j+1  yij  {0, 1, 2}, yi+1,j  yij  {1, 0, 1} x1j = 1, xIj = X, yi1 = 1, yiJ = Y ,</p>
    <p>P2DHMM (1) {x1, . . . , xI} : xi+1  xi  {0, 1, 2}, xij  xi = 0, yi,j+1  yij  {0, 1, 2} x1j = 1, xIj = X, yi1 = 1, yiJ = Y ,</p>
    <p>P2DHMDM (1-) {x1, . . . , xI} : xi+1  xi  {0, 1, 2}, xij  xi  {1, 0, 1}, yi,j+1  yij  {0, 1, 2}</p>
    <p>xij  {1, . . . , X}  {i  w, . . . , i + w}, i = [ iX</p>
    <p>I</p>
    <p>] ,</p>
    <p>IDM (0) yij  {1, . . . , Y }  {j  w, . . . , j + w}, j = [ j Y</p>
    <p>J</p>
    <p>] ,</p>
    <p>with warp range w, e.g. w = 3</p>
    <p>IDM: image distortion model; P2DHM(D)M: pseudo 2D hidden Markov (distortion) model; 2DW: 2D warping (NP-complete)</p>
    <p>hierarchical search in nearest neighbor: first use Euclidean distance, then more costly distance on set of closest references</p>
    <p>Keysers / Context in Nonlinear Deformation Models 20 August 26, 2004</p>
  </div>
</Presentation>
