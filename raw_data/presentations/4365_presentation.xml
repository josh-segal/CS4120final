<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Semi-supervised Geolocation via Graph Convolutional Networks</p>
    <p>Afshin Rahimi, Trevor Cohn and Tim Baldwin</p>
    <p>July 16, 2018</p>
  </div>
  <div class="page">
    <p>Location Lost in Translation</p>
    <p>SocietySocial Media</p>
    <p>impacts</p>
    <p>impacts</p>
  </div>
  <div class="page">
    <p>Applications: Public Health Monitoring</p>
    <p>Allergy Rates (Paul and Dredze, 2011)</p>
  </div>
  <div class="page">
    <p>Applications: Emergency Situation Awareness: Bushfires, Floods and Earthquakes</p>
    <p>Fight bushfire with #fire: Alert hospital before anybody calls (Cameron et al., 2012)</p>
  </div>
  <div class="page">
    <p>Location Location Location</p>
    <p>Profile field is noisy (Hecht et. al, 2011), GPS data is scarce (Hecht and Stephens, 2014), and biased toward younger urban</p>
    <p>users (Pavalanathan and Eisenstein, 2015)</p>
  </div>
  <div class="page">
    <p>Geolocation: The three Ls</p>
    <p>Aint this place a geographical oddity; two weeks away from everywhere!</p>
    <p>Link</p>
    <p>Location</p>
    <p>Language Geolocation</p>
    <p>User geolocation is the task of identifying the home location of a social media user using contextual information such as geographical variation in language use and in social interactions.</p>
  </div>
  <div class="page">
    <p>Huge amounts of unlabelled data, little labelled data</p>
    <p>Multiple views of Data: Text, Network</p>
  </div>
  <div class="page">
    <p>Previous Work (not exhaustive)</p>
    <p>Text-based Supervised Classification</p>
    <p>Backstrom et al. (2008)</p>
    <p>Cheng et al. (2010)</p>
    <p>Wing and Baldridge (2011, 2014)</p>
    <p>Network-based Semi-supervised Regression</p>
    <p>Backstrom et al. (2010)</p>
    <p>Davis Jr et al. (2011)</p>
    <p>Jurgens (2013)</p>
    <p>No Text No NetworkJoint/Hybrid Text+Network</p>
    <p>Rahimi et al. (2015)</p>
    <p>Do et al. (2017)</p>
    <p>Miura et al. (2017) Dont utilise unlabelled text data</p>
    <p>Our work: Text+Network Semi-supervised Geolocation 8 / 25</p>
  </div>
  <div class="page">
    <p>Twitter Geolocation Datasets</p>
    <p>GeoText TwitterUS TwitterWorld 103</p>
  </div>
  <div class="page">
    <p>Discretisation of Labels</p>
    <p>Cluster continuous lat/lon: cluster ids are labels.</p>
    <p>Use the median training point of the predicted region as the final continuous prediction.</p>
    <p>Evaluate using Mean and Median errors between the known and the predicted coordinates.</p>
  </div>
  <div class="page">
    <p>Text and Network Views of Data</p>
    <p>@-mention Graph StevenTrevor</p>
    <p>MarkTim Karin</p>
    <p>Normalised Adj. Matrix: A</p>
    <p>Karin</p>
    <p>Mark</p>
    <p>Steven</p>
    <p>Tim</p>
    <p>Trevor</p>
    <p>K ar</p>
    <p>in</p>
    <p>M ar</p>
    <p>k</p>
    <p>St ev</p>
    <p>en</p>
    <p>T im</p>
    <p>T re</p>
    <p>vo r</p>
    <p>Karin</p>
    <p>Mark</p>
    <p>Steven</p>
    <p>Tim</p>
    <p>Trevor</p>
    <p>...</p>
    <p>...</p>
    <p>...</p>
    <p>...</p>
    <p>.</p>
    <p>M el</p>
    <p>b o</p>
    <p>u rn</p>
    <p>e</p>
    <p>#A C</p>
    <p>L 20</p>
    <p>Text BoW: X</p>
    <p>Two users are connected if they have a common @-mention.</p>
  </div>
  <div class="page">
    <p>Baseline 1: FeatConcat</p>
    <p>Concatenate A and X , and feed them to a DNN: Y = f ([X,A])</p>
    <p>The dimensions of A, and consequently the number of parameters grow with the number of samples.</p>
  </div>
  <div class="page">
    <p>Baseline 2: DCCA</p>
    <p>maximally correlated</p>
    <p>FC sigmoid</p>
    <p>FC softmax</p>
    <p>X: text BoW A: Neighbours</p>
    <p>predicted location: y</p>
    <p>FC linear</p>
    <p>Unsupervised DCCA Supervised Geolocation</p>
    <p>FC ReLU</p>
    <p>CCA loss backprop</p>
    <p>Learn a shared representation using Deep Canonical Correlation Analysis (Andrew et al., 2013):</p>
    <p>= corr(f1(X ), f2(A)) = cov(f1(X),f2(A))</p>
    <p>var(f1(X)).var(f2(A))</p>
    <p>Y = f ([f1(X ), f 2(A)])</p>
  </div>
  <div class="page">
    <p>Proposed Model: GCN</p>
    <p>Highway GCN:</p>
    <p>Highway GCN: ,</p>
    <p>Output GCN:</p>
    <p>X</p>
    <p>A</p>
    <p>A</p>
    <p>A tanh</p>
    <p>tanh</p>
    <p>softmax</p>
    <p>H0</p>
    <p>H1</p>
    <p>Hl1</p>
    <p>Hl</p>
    <p>predicted location: y</p>
    <p>W l1, bl1, W l1 h</p>
    <p>, bl1 h</p>
    <p>W 1, b1, W 1 h , b1</p>
    <p>h</p>
    <p>W l , bl</p>
    <p>GCN Layer: H(l+1) = ReLU ( AH(l)W (l) + b</p>
    <p>) Adding more layers results in expanded neighbourhood smoothing: control with highway gates W lh,b</p>
    <p>l h</p>
  </div>
  <div class="page">
    <p>Highway GCN: Control Neighbourhood Smoothing</p>
    <p>#layers</p>
    <p>m ed</p>
    <p>ia n</p>
    <p>er ro</p>
    <p>r (k</p>
    <p>m )</p>
    <p>-highway +highway</p>
    <p>layer gates: T (~hl ) =  ( W lh</p>
    <p>~hl + blh</p>
    <p>) layer output: ~hl+1 = ~hl+1 T (~hl ) + ~hl  (1 T (~hl ))</p>
    <p>weighted sum of layer input and output</p>
  </div>
  <div class="page">
    <p>Neighbourhood Smoothing</p>
    <p>Karin</p>
    <p>Mark</p>
    <p>Steven</p>
    <p>Tim</p>
    <p>Trevor</p>
    <p>K ar</p>
    <p>in</p>
    <p>M ar</p>
    <p>k</p>
    <p>St ev</p>
    <p>en</p>
    <p>T im</p>
    <p>T re</p>
    <p>vo r</p>
    <p>...</p>
    <p>...</p>
    <p>...</p>
    <p>...</p>
    <p>.</p>
    <p>Text BoW: X</p>
    <p>Karin</p>
    <p>Mark</p>
    <p>Steven</p>
    <p>Tim</p>
    <p>Trevor</p>
    <p>Normalised Adj. Matrix: A</p>
    <p>Smoothing immediate neighbourhood: A X smoothing expanded neighbourhood: A A X</p>
  </div>
  <div class="page">
    <p>Sample Representation using t-SNE</p>
    <p>FeatConcat [X, A]</p>
    <p>DCCA</p>
  </div>
  <div class="page">
    <p>Test Results: Median Error</p>
    <p>GeoText TwitterUS TwitterWorld 0</p>
    <p>ed ia</p>
    <p>n E</p>
    <p>rr or</p>
    <p>in k</p>
    <p>m</p>
    <p>Text Social Hybrid</p>
  </div>
  <div class="page">
    <p>Test Results: Median Error</p>
    <p>GeoText TwitterUS TwitterWorld 0</p>
    <p>ed ia</p>
    <p>n E</p>
    <p>rr or</p>
    <p>in k</p>
    <p>m</p>
    <p>Text Social Hybrid Joint DCCA Joint FeatConcat Joint GCN</p>
  </div>
  <div class="page">
    <p>Test Results: Median Error</p>
    <p>GeoText TwitterUS TwitterWorld 0</p>
    <p>ed ia</p>
    <p>n E</p>
    <p>rr or</p>
    <p>in k</p>
    <p>m</p>
    <p>Text Social Hybrid Joint DCCA Joint FeatConcat Joint GCN Joint Miura et. al (2017) Joint Do et. al (2017)</p>
  </div>
  <div class="page">
    <p>Top Features Learnt from Unlabelled Data (1% Supervision)</p>
    <p>Seattle, WA Austin, TX Jacksonville, FL Columbus, OH</p>
    <p>#goseahawks stubb unf laffayette smock gsd ribault #weareohio traffuck #meatsweats wahoowa #arcgis ferran lanterna wjct #slammin promissory pupper fscj #ouhc chowdown effaced floridian #cow ckrib #austin #jacksonville mommyhood #uwhuskies lmfbo #mer beering</p>
    <p>Top terms for a few regions detected by GCN using only 1% of Twitter-US for supervision. The terms that existed in labelled data are removed.</p>
  </div>
  <div class="page">
    <p>Dev. Results: How much labelled data do we really have?</p>
    <p>labelled data (%samples)</p>
    <p>m ed</p>
    <p>ia n</p>
    <p>er ro</p>
    <p>r (k</p>
    <p>m )</p>
    <p>GCN DCCA</p>
    <p>FeatConcat</p>
    <p>GeoText</p>
    <p>labelled data (%samples)</p>
    <p>m e d ia n e rr o r (k m )</p>
    <p>GCN</p>
    <p>DCCA</p>
    <p>FeatConcat</p>
    <p>Twitter-World</p>
    <p>labelled data (%samples)</p>
    <p>m ed</p>
    <p>ia n</p>
    <p>er ro</p>
    <p>r (k</p>
    <p>m )</p>
    <p>GCN DCCA</p>
    <p>FeatConcat</p>
    <p>Twitter-US</p>
    <p>GeoText TwitterUS TwitterWorld 0</p>
    <p>M ed</p>
    <p>ia n</p>
    <p>E rr</p>
    <p>or in</p>
    <p>k m</p>
    <p>Joint DCCA 1% Joint FeatConcat 1% Joint GCN 1%</p>
    <p>Test results with 1% labelled data</p>
  </div>
  <div class="page">
    <p>Confusion Matrix Between True Location and Predicted Location</p>
    <p>M E</p>
    <p>M A RI NH V T CT NY N J</p>
    <p>DE M D PA VA NC SC W V</p>
    <p>O H FL G A M I</p>
    <p>KY IN A L</p>
    <p>TN W I IL M</p>
    <p>S LA M O AR M N IA KS NE O K TX SD ND W Y</p>
    <p>CO NM U T</p>
    <p>M T AZ ID NV CA W A</p>
    <p>O R</p>
    <p>Predicted</p>
    <p>OR</p>
    <p>WA</p>
    <p>CA</p>
    <p>NV</p>
    <p>ID</p>
    <p>AZ</p>
    <p>MT</p>
    <p>UT</p>
    <p>NM</p>
    <p>CO</p>
    <p>WY</p>
    <p>ND</p>
    <p>SD</p>
    <p>TX</p>
    <p>OK</p>
    <p>NE</p>
    <p>KS</p>
    <p>IA</p>
    <p>MN</p>
    <p>AR</p>
    <p>MO</p>
    <p>LA</p>
    <p>MS</p>
    <p>IL</p>
    <p>WI</p>
    <p>TN</p>
    <p>AL</p>
    <p>IN</p>
    <p>KY</p>
    <p>MI</p>
    <p>GA</p>
    <p>FL</p>
    <p>OH</p>
    <p>WV</p>
    <p>SC</p>
    <p>NC</p>
    <p>VA</p>
    <p>PA</p>
    <p>MD</p>
    <p>DE</p>
    <p>NJ</p>
    <p>NY</p>
    <p>CT</p>
    <p>VT</p>
    <p>NH</p>
    <p>RI</p>
    <p>MA</p>
    <p>ME</p>
    <p>Tr ue</p>
    <p>Users from smaller states are misclassified in nearby larger states such as TX, NY, CA, and OH.</p>
    <p>Users from FL are misclassified in several other states possibly because they are not born in FL, and are well connected to their hometowns in other states.</p>
  </div>
  <div class="page">
    <p>Conclusion</p>
    <p>Simple concatenation in FeatConcat is a strong baseline with large amounts of labelled data.</p>
    <p>GCN performs well with both large and small amounts of labelled data by effectively using unlabelled data.</p>
    <p>Gating mechanisms (e.g. highway gates) are essential for controlling neighbourhood smoothing in GCN with multiple layers.</p>
    <p>The models proposed here are applicable to other demographic inference tasks.</p>
  </div>
  <div class="page">
    <p>Thank you!</p>
    <p>Code available at: https://github.com/afshinrahimi/geographconv</p>
  </div>
</Presentation>
