<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>C o</p>
    <p>m p</p>
    <p>u te</p>
    <p>r S c</p>
    <p>ie n</p>
    <p>c e</p>
    <p>, Te</p>
    <p>x a</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U n</p>
    <p>iv e</p>
    <p>Optimizing Capacity-Heterogeneous</p>
    <p>Unstructured P2P Networks for</p>
    <p>Random-Walk Traffic</p>
    <p>Chandan Rama Reddy Microsoft</p>
    <p>Joint work with Derek Leonard and Dmitri Loguinov</p>
    <p>Internet Research Lab Department of Computer Science and Engineering Texas A&amp;M University, College Station, TX 77843</p>
    <p>Sep 09, 2009</p>
  </div>
  <div class="page">
    <p>C o</p>
    <p>m p</p>
    <p>u te</p>
    <p>r S c</p>
    <p>ie n</p>
    <p>c e</p>
    <p>, Te</p>
    <p>x a</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U n</p>
    <p>iv e</p>
    <p>Introduction</p>
    <p>Terminology, related work, and motivation</p>
    <p>Proposed System</p>
    <p>Proposed Metrics</p>
    <p>Evaluation</p>
    <p>Wrap-up</p>
    <p>Agenda</p>
  </div>
  <div class="page">
    <p>C o</p>
    <p>m p</p>
    <p>u te</p>
    <p>r S c</p>
    <p>ie n</p>
    <p>c e</p>
    <p>, Te</p>
    <p>x a</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U n</p>
    <p>iv e</p>
    <p>Introduction  Key Components</p>
    <p>Overlay topology</p>
    <p>Determined by the neighbor selection policy</p>
    <p>Influences the distribution of traffic among nodes</p>
    <p>Search methodology</p>
    <p>Defines how queries are propagated in the overlay</p>
    <p>Directly influences the outcome of queries</p>
    <p>Replication strategy</p>
    <p>Determines how a node selects peers in the</p>
    <p>network for replication</p>
    <p>Ensures availability of files in the search path</p>
  </div>
  <div class="page">
    <p>C o</p>
    <p>m p</p>
    <p>u te</p>
    <p>r S c</p>
    <p>ie n</p>
    <p>c e</p>
    <p>, Te</p>
    <p>x a</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U n</p>
    <p>iv e</p>
    <p>Introduction  Random walks</p>
    <p>Build walk</p>
    <p>Node seeking a neighbor starts a walk with TTL=kb</p>
    <p>Peer at the end of the walk is selected as a neighbor</p>
    <p>Search walk</p>
    <p>Node looking for a file starts a walk with TTL=ks</p>
    <p>Required file is searched on nodes at every hop</p>
    <p>Replication walk</p>
    <p>Node i starts a random walk with TTL=kr</p>
    <p>Nodes along the walk are selected as replicas</p>
  </div>
  <div class="page">
    <p>C o</p>
    <p>m p</p>
    <p>u te</p>
    <p>r S c</p>
    <p>ie n</p>
    <p>c e</p>
    <p>, Te</p>
    <p>x a</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U n</p>
    <p>iv e</p>
    <p>Introduction  Capacity-Heterogeneity</p>
    <p>P2P networks rely on collaboration between nodes</p>
    <p>Capacity indicates the amount of service provided by a</p>
    <p>node to other peers in the network</p>
    <p>Node capacity can be defined in terms of the available</p>
    <p>bandwidth and local resources of a node such as its</p>
    <p>processing power</p>
    <p>Measurement studies show that P2P networks are</p>
    <p>capacity-heterogeneous</p>
  </div>
  <div class="page">
    <p>C o</p>
    <p>m p</p>
    <p>u te</p>
    <p>r S c</p>
    <p>ie n</p>
    <p>c e</p>
    <p>, Te</p>
    <p>x a</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U n</p>
    <p>iv e</p>
    <p>Related Work</p>
    <p>Involves replacing</p>
    <p>existing neighbors with</p>
    <p>better ones to satisfy</p>
    <p>capacity constraints</p>
    <p>Existing Systems</p>
    <p>Topology Adaptation Special Topology</p>
    <p>Creating overlays with</p>
    <p>node degree linearly</p>
    <p>proportional to capacity</p>
    <p>Gia</p>
    <p>Chawathe 2003</p>
    <p>Swaplinks</p>
    <p>Vishnumurthy 2006</p>
    <p>Swaplinks</p>
    <p>Vishnumurthy 2006</p>
  </div>
  <div class="page">
    <p>C o</p>
    <p>m p</p>
    <p>u te</p>
    <p>r S c</p>
    <p>ie n</p>
    <p>c e</p>
    <p>, Te</p>
    <p>x a</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U n</p>
    <p>iv e</p>
    <p>Motivation</p>
    <p>Existing systems have following drawbacks</p>
    <p>Rely on topology adaptation which causes high</p>
    <p>overhead during churn</p>
    <p>Use node degree linearly proportional to capacity</p>
    <p>which results in high overhead to maintain large</p>
    <p>neighbor set</p>
    <p>The objective of this research is to design an</p>
    <p>unstructured P2P system which overcomes the</p>
    <p>above drawbacks and utilizes capacity-heterogeneity</p>
    <p>to improve search performance in the system</p>
  </div>
  <div class="page">
    <p>C o</p>
    <p>m p</p>
    <p>u te</p>
    <p>r S c</p>
    <p>ie n</p>
    <p>c e</p>
    <p>, Te</p>
    <p>x a</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U n</p>
    <p>iv e</p>
    <p>Introduction</p>
    <p>Proposed System</p>
    <p>Proposed Metrics</p>
    <p>Evaluation</p>
    <p>Wrap-up</p>
    <p>Agenda</p>
  </div>
  <div class="page">
    <p>C o</p>
    <p>m p</p>
    <p>u te</p>
    <p>r S c</p>
    <p>ie n</p>
    <p>c e</p>
    <p>, Te</p>
    <p>x a</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U n</p>
    <p>iv e</p>
    <p>Proposed System  Optimal Network</p>
    <p>Maximum rate of processing of messages at node i = Ci</p>
    <p>If incoming traffic Ti &gt; Ci, messages are added to an</p>
    <p>infinite queue</p>
    <p>Given number of nodes n, set of capacities {C1,,Cn},</p>
    <p>fixed average degree d, and random walk length k</p>
    <p>We define a network N with a search algorithm S to be</p>
    <p>throughput-optimal if (N, S) achieves the maximum rate</p>
    <p>of completion of random walks</p>
    <p>Majority of the traffic in the network is due to random</p>
    <p>walks and hence throughput of the system is rate of</p>
    <p>completion of random walks 9</p>
  </div>
  <div class="page">
    <p>C o</p>
    <p>m p</p>
    <p>u te</p>
    <p>r S c</p>
    <p>ie n</p>
    <p>c e</p>
    <p>, Te</p>
    <p>x a</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U n</p>
    <p>iv e</p>
    <p>Proposed System  Optimal Network</p>
    <p>Lemma 1: Assume that random walks are started at each node with rate i and proceed according to a</p>
    <p>positive irreducible Markov chain with transition matrix P. If k is larger than the mixing time of P, the following</p>
    <p>holds</p>
    <p>where  is the unique solution to  =  P</p>
    <p>Theorem 1: Assuming k is sufficiently large, the optimal</p>
    <p>stationary distribution of random walks is</p>
  </div>
  <div class="page">
    <p>C o</p>
    <p>m p</p>
    <p>u te</p>
    <p>r S c</p>
    <p>ie n</p>
    <p>c e</p>
    <p>, Te</p>
    <p>x a</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U n</p>
    <p>iv e</p>
    <p>Proposed System  CPMH Framework</p>
    <p>A framework to achieve the optimal</p>
    <p>Applies the Metropolis-Hastings algorithm to find</p>
    <p>transition probability of random walks having optimal</p>
    <p>We first choose candidate transition probability q(i,j)</p>
    <p>Random walk then makes this transition with probability</p>
    <p>Achieves Capacity-Proportional  using Metropolis</p>
    <p>Hastings algorithm, hence the name CPMH 11</p>
  </div>
  <div class="page">
    <p>C o</p>
    <p>m p</p>
    <p>u te</p>
    <p>r S c</p>
    <p>ie n</p>
    <p>c e</p>
    <p>, Te</p>
    <p>x a</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U n</p>
    <p>iv e</p>
    <p>Proposed System  CSOD Topology</p>
    <p>A new node i joining the system will start dout(i)</p>
    <p>unbiased random walks for selecting its neighbors</p>
    <p>Desired out-degree a, b are constants (a = 4 and b = 15 in simulations)</p>
    <p>Out-degree is scalable with capacity hence called</p>
    <p>Capacity Scalable Out Degree (CSOD)</p>
    <p>CSOD achieved fastest convergence to optimal</p>
    <p>Capacity-unaware</p>
    <p>networks</p>
  </div>
  <div class="page">
    <p>C o</p>
    <p>m p</p>
    <p>u te</p>
    <p>r S c</p>
    <p>ie n</p>
    <p>c e</p>
    <p>, Te</p>
    <p>x a</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U n</p>
    <p>iv e</p>
    <p>Proposed System  CSOD Topology</p>
    <p>CPMH walks on CSOD</p>
    <p>10,000 node network was constructed</p>
    <p>Walks of TTL = 1024 started at  = 50 qps 13</p>
  </div>
  <div class="page">
    <p>C o</p>
    <p>m p</p>
    <p>u te</p>
    <p>r S c</p>
    <p>ie n</p>
    <p>c e</p>
    <p>, Te</p>
    <p>x a</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U n</p>
    <p>iv e</p>
    <p>CPMH walks are used for query propagation</p>
    <p>Achieve capacity-proportional traffic</p>
    <p>A query is propagated for ks hops or till the</p>
    <p>specified number of query-hits are achieved</p>
    <p>CPMH queries are run on CSOD topology hence</p>
    <p>the proposed system is called CSOD-CPMH</p>
    <p>Proposed System  CPMH Search</p>
  </div>
  <div class="page">
    <p>C o</p>
    <p>m p</p>
    <p>u te</p>
    <p>r S c</p>
    <p>ie n</p>
    <p>c e</p>
    <p>, Te</p>
    <p>x a</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U n</p>
    <p>iv e</p>
    <p>Proposed System  CPMH Replication</p>
    <p>Maximum number of replicas stored in a node = Ci</p>
    <p>We propose random walk replication scheme using</p>
    <p>CPMH walks</p>
    <p>To achieve a replication factor r, a node starts one</p>
    <p>CPMH walk with TTL=kr  Walk transitions for first hf hops without replication</p>
    <p>Subsequently, replication is done at every unique node visited till r replicas are created or TTL is</p>
    <p>reduced to 0</p>
    <p>In simulations, we use kr = 200, hf = 50 and r = 20</p>
  </div>
  <div class="page">
    <p>C o</p>
    <p>m p</p>
    <p>u te</p>
    <p>r S c</p>
    <p>ie n</p>
    <p>c e</p>
    <p>, Te</p>
    <p>x a</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U n</p>
    <p>iv e</p>
    <p>Introduction</p>
    <p>Proposed System : CSOD-CPMH</p>
    <p>Proposed Metrics</p>
    <p>Evaluation</p>
    <p>Wrap-up</p>
    <p>Agenda</p>
  </div>
  <div class="page">
    <p>C o</p>
    <p>m p</p>
    <p>u te</p>
    <p>r S c</p>
    <p>ie n</p>
    <p>c e</p>
    <p>, Te</p>
    <p>x a</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U n</p>
    <p>iv e</p>
    <p>Proposed Metrics</p>
    <p>End-to-end query metrics such as success rate</p>
    <p>additionally depend on replication strategy</p>
    <p>Need metrics to evaluate the topology of the system</p>
    <p>for supporting random walks</p>
    <p>Propose 2 topology metrics</p>
    <p>Build Saturation Point (BSP)</p>
    <p>Search Saturation Point (SSP)</p>
  </div>
  <div class="page">
    <p>C o</p>
    <p>m p</p>
    <p>u te</p>
    <p>r S c</p>
    <p>ie n</p>
    <p>c e</p>
    <p>, Te</p>
    <p>x a</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U n</p>
    <p>iv e</p>
    <p>Proposed Metrics  BSP</p>
    <p>BSP quantifies an overlays ability to handle churn</p>
    <p>Churn involves nodes leaving the network and new</p>
    <p>ones joining the system</p>
    <p>Churn rate rc = departure rate of nodes</p>
    <p>BSP is defined as the maximum rc for which the</p>
    <p>expected queue length E[Q]&lt;c, after certain fixed time</p>
    <p>t, where c is a constant</p>
  </div>
  <div class="page">
    <p>C o</p>
    <p>m p</p>
    <p>u te</p>
    <p>r S c</p>
    <p>ie n</p>
    <p>c e</p>
    <p>, Te</p>
    <p>x a</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U n</p>
    <p>iv e</p>
    <p>Proposed Metrics  SSP</p>
    <p>Quantifies an overlays ability to handle search walks</p>
    <p>Consider an overlay graph G with n nodes, capacity</p>
    <p>distribution {Ci} and average degree d</p>
    <p>Random walks of length k2 are started from</p>
    <p>randomly selected nodes</p>
    <p>As input rate  of walks increases, completion rate M</p>
    <p>increases till the network is saturated</p>
    <p>Beyond saturation, message backlog increases and M decreases</p>
    <p>SSP: Unique maximum completion of walks achieved 19</p>
  </div>
  <div class="page">
    <p>C o</p>
    <p>m p</p>
    <p>u te</p>
    <p>r S c</p>
    <p>ie n</p>
    <p>c e</p>
    <p>, Te</p>
    <p>x a</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U n</p>
    <p>iv e</p>
    <p>Proposed Metrics  OPT Network</p>
    <p>Acts as an upper bound while comparing overlays</p>
    <p>using SSP</p>
    <p>To add a comparative measure to SSP numbers</p>
    <p>We propose a centralized algorithm for construction</p>
    <p>of OPT</p>
    <p>Node i in OPT has di=2Ci</p>
    <p>On OPT, unbiased random walks are run to get</p>
    <p>capacity-proportional traffic through nodes</p>
  </div>
  <div class="page">
    <p>C o</p>
    <p>m p</p>
    <p>u te</p>
    <p>r S c</p>
    <p>ie n</p>
    <p>c e</p>
    <p>, Te</p>
    <p>x a</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U n</p>
    <p>iv e</p>
    <p>Introduction</p>
    <p>Proposed System : CSOD-CPMH</p>
    <p>Proposed Metrics : BSP, SSP</p>
    <p>Evaluation</p>
    <p>Wrap-up</p>
    <p>Agenda</p>
  </div>
  <div class="page">
    <p>C o</p>
    <p>m p</p>
    <p>u te</p>
    <p>r S c</p>
    <p>ie n</p>
    <p>c e</p>
    <p>, Te</p>
    <p>x a</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U n</p>
    <p>iv e</p>
    <p>Evaluation</p>
    <p>Evaluate the proposed CSOD-CPMH against OPT</p>
    <p>unbiased, Gia-biased, CSOD-biased</p>
    <p>Naming convention: {topology}-{search walk}</p>
    <p>e.g., Gia-biased has Gia topology and uses capacity</p>
    <p>biased search walks</p>
    <p>CSOD-biased is considered to show the need for</p>
    <p>CPMH search walks</p>
  </div>
  <div class="page">
    <p>C o</p>
    <p>m p</p>
    <p>u te</p>
    <p>r S c</p>
    <p>ie n</p>
    <p>c e</p>
    <p>, Te</p>
    <p>x a</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U n</p>
    <p>iv e</p>
    <p>Evaluation  Static Network</p>
    <p>SSP is the maximum rate of completion M of</p>
    <p>search walks</p>
    <p>TTL ks=1024 23</p>
  </div>
  <div class="page">
    <p>C o</p>
    <p>m p</p>
    <p>u te</p>
    <p>r S c</p>
    <p>ie n</p>
    <p>c e</p>
    <p>, Te</p>
    <p>x a</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U n</p>
    <p>iv e</p>
    <p>Evaluation  Static Network</p>
    <p>CPMH replication is compared with 1-hop</p>
    <p>Gia-biased CSOD-CPMH</p>
    <p>TTL kr = 200, hf = 50, r = E[di] = 20</p>
    <p>CPMH-rep is up to 20% better than 1-hop in Gia</p>
    <p>biased 24</p>
  </div>
  <div class="page">
    <p>C o</p>
    <p>m p</p>
    <p>u te</p>
    <p>r S c</p>
    <p>ie n</p>
    <p>c e</p>
    <p>, Te</p>
    <p>x a</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U n</p>
    <p>iv e</p>
    <p>Evaluation  Churn Model  Nodes have Pareto lifetime L</p>
    <p>Shape parameter =3, E[L]=10000 s</p>
    <p>New nodes arrive as a Poisson process</p>
    <p>Arrival rate = Departure rate</p>
    <p>Inter-arrival delay X, E[X] = 1/rc = E[L]/n</p>
  </div>
  <div class="page">
    <p>C o</p>
    <p>m p</p>
    <p>u te</p>
    <p>r S c</p>
    <p>ie n</p>
    <p>c e</p>
    <p>, Te</p>
    <p>x a</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U n</p>
    <p>iv e</p>
    <p>rs it y  BSP is the maximum  for which E[Q]c, after time t</p>
    <p>In Simulation, backlog threshold c = 1 s and t = 1000 s</p>
    <p>CSOD node starts 10 unbiased build walks with kb = 8</p>
    <p>Gia undergoes continuous topology adaptation</p>
    <p>Evaluation  Dynamic Network</p>
  </div>
  <div class="page">
    <p>C o</p>
    <p>m p</p>
    <p>u te</p>
    <p>r S c</p>
    <p>ie n</p>
    <p>c e</p>
    <p>, Te</p>
    <p>x a</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U n</p>
    <p>iv e</p>
    <p>Evaluation  Dynamic Network</p>
    <p>Query success rate is the percentage of queries with</p>
    <p>one or more query-hits</p>
    <p>CSOD-CPMH has 20% higher success rate than</p>
    <p>Gia-biased 27</p>
  </div>
  <div class="page">
    <p>C o</p>
    <p>m p</p>
    <p>u te</p>
    <p>r S c</p>
    <p>ie n</p>
    <p>c e</p>
    <p>, Te</p>
    <p>x a</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U n</p>
    <p>iv e</p>
    <p>Evaluation  Dynamic Network</p>
    <p>Query Latency is the time to get the first query result</p>
    <p>CSOD-CPMH has 50% lower query latency than</p>
    <p>Gia-biased 28</p>
  </div>
  <div class="page">
    <p>C o</p>
    <p>m p</p>
    <p>u te</p>
    <p>r S c</p>
    <p>ie n</p>
    <p>c e</p>
    <p>, Te</p>
    <p>x a</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U n</p>
    <p>iv e</p>
    <p>Evaluation  Dynamic Network</p>
    <p>Query Hits is the total number of query responses</p>
    <p>CSOD-CPMH gets 50% more query hits than</p>
    <p>Gia-biased 29</p>
  </div>
  <div class="page">
    <p>C o</p>
    <p>m p</p>
    <p>u te</p>
    <p>r S c</p>
    <p>ie n</p>
    <p>c e</p>
    <p>, Te</p>
    <p>x a</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U n</p>
    <p>iv e</p>
    <p>Wrap-up</p>
    <p>Capacity-heterogeneity in a P2P network can be</p>
    <p>utilized without</p>
    <p>Performing topology adaptation</p>
    <p>Constructing topologies with di=Ci</p>
    <p>CSOD-CPMH performs better than Gia under both</p>
    <p>saturation metrics and all the end-to-end query</p>
    <p>parameters</p>
    <p>CPMH framework is topology-agnostic</p>
    <p>Enables incremental deployment of proposed system</p>
    <p>into existing networks such as Gnutella</p>
  </div>
</Presentation>
