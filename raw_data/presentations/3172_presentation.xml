<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>USENIX Security 14  San Diego, CA August 20, 2014</p>
    <p>An Internet-Wide View of Internet-Wide Scanning</p>
    <p>Zakir Durumeric, Michael Bailey, J. Alex Halderman University of Michigan</p>
  </div>
  <div class="page">
    <p>Internet-Wide Scanning</p>
    <p>We released ZMap at USENIX Security last year  TCP Scan of full IPv4 in &lt; 45 minutes</p>
    <p>! Internet-Wide scanning appears to be useful  15 studies based on ZMap data</p>
    <p>masscan</p>
  </div>
  <div class="page">
    <p>Internet-Wide Scanning</p>
    <p>We released ZMap at USENIX Security last year  TCP Scan of full IPv4 in &lt; 45 minutes</p>
    <p>! Internet-Wide scanning appears to be useful  15 studies based on ZMap data</p>
    <p>! Who is using ZMap? ! Did ZMap alter the scanning landscape? ! Are operators now blocking Internet scans?</p>
    <p>masscan</p>
  </div>
  <div class="page">
    <p>Talk Outline</p>
    <p>home routers, Heartbleed, and NTP vulnerabiliWes ! 3. Defensive reacWons against scanning !</p>
  </div>
  <div class="page">
    <p>Detecting Internet-Wide Scan Traffic</p>
    <p>Data Collec:on !  Collected background traffic from a large</p>
    <p>network telescope at Merit Network during 20132014</p>
    <p>!  Darknet does not host any services  probes</p>
    <p>are likely part of Internet-wide scans !  Approach will likely miss targeted scanning</p>
    <p>Merit&amp;</p>
    <p>PCAP&amp;</p>
  </div>
  <div class="page">
    <p>Detecting Internet-Wide Scan Traffic</p>
    <p>Data Collec:on !  Collected background traffic from a large</p>
    <p>network telescope at Merit Network during 20132014</p>
    <p>!  Darknet does not host any services  probes</p>
    <p>are likely part of Internet-wide scans !  Approach will likely miss targeted scanning</p>
    <p>! Es:ma:ng Actual Scans !  Assume that scan targets are ordered</p>
    <p>by a uniform random distribuWon !</p>
    <p>EsWmate coverage and scan rate using binomial distribuWon</p>
    <p>Merit&amp;</p>
    <p>PCAP&amp;</p>
  </div>
  <div class="page">
    <p>How do we define a scan?</p>
  </div>
  <div class="page">
    <p>Merit Darknet</p>
    <p>SYN Scan  TCP/443</p>
    <p>Des:na:on Source Rate Size</p>
    <p>targeWng a single protocol on a single port set of conWguous IPs within a single AS sending at an esWmated rate of 10 pps reaching 100 hosts in our darknet</p>
    <p>Defining a Scan</p>
  </div>
  <div class="page">
    <p>Fingerprinting Scanners</p>
    <p>We invesWgated open source network scanners and created fingerprints for ZMap and masscan ! ZMap !  IP ID staWcally set to 54321</p>
    <p>! Masscan !  IP ID = dest addr  dest port  tcp seqnum masscan</p>
  </div>
  <div class="page">
    <p>Network Telescope Traffic Overview</p>
    <p>January 2014 !</p>
    <p>Darknet received an average 1.4 billion packets (55 GB) per day !</p>
    <p>Detected 10.8 million scans from 1.8 million unique hosts !</p>
    <p>2,013 ZMap scans and 1,326 masscan scans</p>
  </div>
  <div class="page">
    <p>Targeted Services</p>
    <p>ICM P</p>
    <p>SSH HTTP RDP DNS Alt-HTTP M</p>
    <p>SSQ L</p>
    <p>Telnet HTTPS CHARG</p>
    <p>EN SIP VNC M</p>
    <p>ySQ L</p>
    <p>VLC pcANYW</p>
    <p>HERE NTP SM</p>
    <p>TP Linksys SNM</p>
    <p>P P</p>
    <p>ro be</p>
    <p>P ac</p>
    <p>ke ts</p>
  </div>
  <div class="page">
    <p>ICM P</p>
    <p>SSH HTTP RDP DNS Alt-HTTP M</p>
    <p>SSQ L</p>
    <p>Telnet HTTPS CHARG</p>
    <p>EN SIP VNC M</p>
    <p>ySQ L</p>
    <p>VLC pcANYW</p>
    <p>HERE NTP SM</p>
    <p>TP Linksys SNM</p>
    <p>P P</p>
    <p>ro be</p>
    <p>P ac</p>
    <p>ke ts</p>
    <p>Targeted Services</p>
    <p>Conficker Traffic</p>
  </div>
  <div class="page">
    <p>Targeted Services</p>
    <p>ICM P</p>
    <p>SSH HTTP RDP DNS Alt-HTTP (8080)</p>
    <p>M SSQ</p>
    <p>L Telnet HTTPS CHARG</p>
    <p>EN SIP VNC M</p>
    <p>ySQ L</p>
    <p>VLC pcANYW</p>
    <p>HERE NTP SM</p>
    <p>TP Linksys SNM</p>
    <p>P 139/NetBIO</p>
    <p>S P</p>
    <p>ro be</p>
    <p>P ac</p>
    <p>ke ts</p>
  </div>
  <div class="page">
    <p>Targeted Services</p>
    <p>ICM P</p>
    <p>SSH HTTP RDP DNS Alt-HTTP (8080)</p>
    <p>M SSQ</p>
    <p>L Telnet HTTPS CHARG</p>
    <p>EN SIP VNC M</p>
    <p>ySQ L</p>
    <p>VLC pcANYW</p>
    <p>HERE NTP SM</p>
    <p>TP Linksys SNM</p>
    <p>P 139/NetBIO</p>
    <p>S P</p>
    <p>ro be</p>
    <p>P ac</p>
    <p>ke ts</p>
    <p>&lt;.1% .1-1%</p>
  </div>
  <div class="page">
    <p>Large Scans</p>
    <p>C D</p>
    <p>F of</p>
    <p>P ro</p>
    <p>be P</p>
    <p>ac ke</p>
    <p>ts</p>
    <p>Estimated Scan Coverage</p>
    <p>Non-Conficker Scanning</p>
  </div>
  <div class="page">
    <p>Large Scans</p>
    <p>C D</p>
    <p>F of</p>
    <p>P ro</p>
    <p>be P</p>
    <p>ac ke</p>
    <p>ts</p>
    <p>Estimated Scan Coverage</p>
    <p>Non-Conficker Scanning</p>
  </div>
  <div class="page">
    <p>Scan Dynamics</p>
    <p>January 2014 !</p>
    <p>18,000 scans (0.28%) targeted 1% of the IPv4 address space !</p>
    <p>2,700 scans (0.04%) targeted 10% of the IPv4 address space !</p>
    <p>100 ASes responsible for 85% of this scan traffic</p>
  </div>
  <div class="page">
    <p>Scan Dynamics</p>
    <p>January 2014 !</p>
    <p>18,000 scans (0.28%) targeted 1% of the IPv4 address space !</p>
    <p>2,700 scans (0.04%) targeted 10% of the IPv4 address space !</p>
    <p>100 ASes responsible for 85% of this scan traffic ! Four types of scanning stand out:</p>
    <p>Academic and industry research groups !</p>
    <p>Regularly scheduled scans from Chinese ASes !</p>
    <p>UnidenWfiable scans from bullet-proof hosWng providers !</p>
    <p>ShodanHQ Search Engine</p>
  </div>
  <div class="page">
    <p>Many of the networks responsible for the most scan traffic are academic insWtuWons and consultants performing regular scans ! Primarily focused on amplificaWon alacks (NTP, DNS) and cryptographic ecosystems (SSH, HTTPS) ! In almost all cases, studies appear to be conducted responsibly and allowed easy exclusion</p>
    <p>Research Groups and Security Consultants</p>
  </div>
  <div class="page">
    <p>Regular Chinese Scans</p>
    <p>Regular daily scans of ICMP, SSH, SQL Server, and TCP/0 ! TCP/0  non-standard-compliant port frequently used to fingerprint network stacks and bypass firewalls ! Responsible for the majority of ICMP, SQL Server, MySQL, and ICMP traffic  far more than other countries</p>
    <p>SSH ICM</p>
    <p>P M</p>
    <p>SSQ L</p>
    <p>RDP HTTP-alt TCP/0 M</p>
    <p>ySQ L</p>
    <p>PPTP M</p>
    <p>SSQ L</p>
    <p>Ja nu</p>
    <p>ar y</p>
    <p>S ca</p>
    <p>ns</p>
    <p>China United States</p>
    <p>Netherlands Others</p>
  </div>
  <div class="page">
    <p>Large Hosting Providers</p>
    <p>!  Scanning for almost every common protocol</p>
    <p>!  Very rarely any idenWfiable informaWon about owners</p>
    <p>Top Scanning Providers</p>
    <p>Ecatel Network (NL)</p>
    <p>Plus Server (DE)</p>
    <p>Slask Data Center (PL)</p>
    <p>Single Hop (US)</p>
    <p>CariNet, Inc. (US)</p>
    <p>Server4You (DE)</p>
    <p>OVH Systems (UK)</p>
    <p>Thor Data Center (IS)</p>
    <p>Psychz Networks (US)</p>
  </div>
  <div class="page">
    <p>Talk Outline</p>
    <p>home routers, Heartbleed, and NTP vulnerabili:es ! 3. Defensive reacWons against scanning !</p>
  </div>
  <div class="page">
    <p>Linksys Router Backdoor</p>
    <p>Li nk</p>
    <p>sy s</p>
    <p>B ac</p>
    <p>kd oo</p>
    <p>r P ro</p>
    <p>be s</p>
    <p>Date</p>
    <p>Public Disclosure</p>
    <p>&lt;1% Scans &gt;=1% Scans</p>
  </div>
  <div class="page">
    <p>Linksys Router Backdoor</p>
    <p>Li nk</p>
    <p>sy s</p>
    <p>B ac</p>
    <p>kd oo</p>
    <p>r P ro</p>
    <p>be s</p>
    <p>Date</p>
    <p>Public Disclosure</p>
    <p>&lt;1% Scans &gt;=1% Scans</p>
    <p>All non-Shodan scans used ZMap (71%) or masscan (29%)</p>
  </div>
  <div class="page">
    <p>Open NTP Resolvers</p>
    <p>#yolo</p>
    <p>#lulz</p>
    <p>Openbomb Drone Project</p>
    <p>http://ra.pe</p>
  </div>
  <div class="page">
    <p>Heartbleed Vulnerability</p>
    <p>Scans began &lt;24 hours aver disclosure ! 53 scans from 27 hosts in the week following disclosure ! 38% of scans originated from China ! Scans occurring from bulletproof hosWng providers ! 95% of scans used ZMap or Masscan</p>
  </div>
  <div class="page">
    <p>Heartbleed Vulnerability</p>
    <p>Scans began &lt;24 hours aver disclosure ! 53 scans from 27 hosts in the week following disclosure ! 38% of scans originated from China ! Scans occurring from bulletproof hosWng providers ! 95% of scans used ZMap or Masscan</p>
    <p>Matter of Heartbleed</p>
    <p>IMC14, Vancouver</p>
  </div>
  <div class="page">
    <p>So what about ZMap?</p>
    <p>SSH DNS HTTP RDP M</p>
    <p>SSQ L</p>
    <p>ICM P</p>
    <p>HTTP-alt HTTPS CHARG</p>
    <p>EN VNC SIP M</p>
    <p>ySQ L</p>
    <p>pcAnywhere NTP VLC SM</p>
    <p>TP Linksys Vuln SNM</p>
    <p>P PPTP Radm</p>
    <p>in EPM</p>
    <p>AP M</p>
    <p>SSQ L</p>
    <p>Aidra Bot Squid SpyBot</p>
    <p>S ca</p>
    <p>n P</p>
    <p>ro be</p>
    <p>s</p>
    <p>ZMap Masscan</p>
    <p>Other</p>
    <p>The majority of scan traffic is not generated by ZMap ! Research groups are using ZMap responsibly ! Evidence that alackers are starWng to take advantage of ZMap and Masscan ! UlWmately lowers the barrier of entry for both groups</p>
  </div>
  <div class="page">
    <p>Talk Outline</p>
    <p>home routers, Heartbleed, and NTP vulnerabiliWes ! 3. Defensive reac:ons against scanning !</p>
  </div>
  <div class="page">
    <p>Do networks drop scan traffic?</p>
    <p>Michigan Engineering AS is responsible for 3rd most scan traffic ! Performed simultaneous scans from Georgia Tech and Michigan to detect blocked traffic ! Scanned using same randomizaWon seed reduce hosts lost due to churn</p>
  </div>
  <div class="page">
    <p>Do networks drop scan traffic?</p>
    <p>EsWmated 0.05% of IPv4 address space is no longer accessible ! 208 exclusion requests  0.15% of IPv4 address space ! Dropped traffic and excluded networks have a minuscule impact</p>
  </div>
  <div class="page">
    <p>When do networks drop scan traffic?</p>
    <p>IP A</p>
    <p>dd re</p>
    <p>ss es</p>
    <p>Total Blacklisted Address Space Est. Inaccessible Address Space</p>
  </div>
  <div class="page">
    <p>How are organizations noticing?</p>
    <p>Detec:on Mechanism Organiza:ons</p>
    <p>Firewall Logs 22 (34%)</p>
    <p>Web Server Logs 14 (22%)</p>
    <p>IDS Logs 10 (16%)</p>
    <p>Invalid SSH or OpenVPN Handhshake 10 (16%)</p>
    <p>Public Blacklists 2 (3%)</p>
    <p>Other 6 (9%)</p>
  </div>
  <div class="page">
    <p>Future Work</p>
    <p>Exclusion standard ! Understand defensive reacWons ! ! CorrelaWng distributed scanners ! Determining scan intent</p>
  </div>
  <div class="page">
    <p>Conclusion</p>
    <p>Scanning landscape has shived  large horizontal scans are now common ! Internet-Wide scanning is a combinaWon of both researchers and alackers taking advantage of new tools ! Network operators have been slow to respond to scanning despite scanning being easy to detect ! Internet-Wide scanning remains a valid methodology</p>
  </div>
  <div class="page">
    <p>USENIX Security 14  San Diego, CA August 20, 2014</p>
    <p>Questions?</p>
    <p>Zakir Durumeric, Michael Bailey, J. Alex Halderman University of Michigan</p>
    <p>An Internet-Wide View of Internet-Wide Scanning</p>
    <p>scanning-team@umich.edu</p>
  </div>
</Presentation>
