<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Should one compute the Temporal Dierence x point or minimize the Bellman Residual ?</p>
    <p>The unied oblique projection view</p>
    <p>Bruno Scherrer</p>
    <p>INRIA - LORIA - Maia Team</p>
    <p>June 2010</p>
    <p>Bruno Scherrer INRIA - LORIA - Maia Team 1/28</p>
  </div>
  <div class="page">
    <p>Markov Decision Processes (Puterman, 1994; Bertsekas &amp; Tsitsiklis, 1996; Sutton &amp; Barto, 1998)</p>
    <p>reward r action a  A</p>
    <p>Agent Policy  : X  A</p>
    <p>Reward function r(i, a)</p>
    <p>Environment Transition probabilities pij(a)</p>
    <p>state i  X</p>
    <p>Goal : Given a policy  : X  A, compute</p>
    <p>v(i) = E</p>
    <p>[  k=0</p>
    <p>kr(ik,(ik ))</p>
    <p>i0 = i ]</p>
    <p>(0 &lt;  &lt; 1)</p>
    <p>Bruno Scherrer INRIA - LORIA - Maia Team 2/28</p>
  </div>
  <div class="page">
    <p>The value v satises</p>
    <p>v = r + Pv  v = T v</p>
    <p>Thus v = L1r with L = I P</p>
    <p>Look for a linear approximation v(i) = m</p>
    <p>j=1 wjj (i) or v = w</p>
    <p>=</p>
    <p>(1)</p>
    <p>... (N)</p>
    <p>= (1 . . . m</p>
    <p>linearly independent</p>
    <p>) and w =</p>
    <p>w1...</p>
    <p>wm</p>
    <p>Bruno Scherrer INRIA - LORIA - Maia Team 3/28</p>
  </div>
  <div class="page">
    <p>Projection onto span () = {w; w  Rm} Let  &gt; 0 be a distribution on the state space {1,    ,N} Quadratic weighted norm : v =</p>
    <p>i (i)v(i)2</p>
    <p>Orthogonal projection : (v) = arg minvspan() v v Linear projection in closed form :  = diag()</p>
    <p>=  with  = ()1</p>
    <p>Properties : w = v  w = v,  = Im,  = ,  =</p>
    <p>Ideally, one would like to compute the best approximation</p>
    <p>vbest = wbest with wbest = v = L 1 r.</p>
    <p>Solution : TD(1), full trajectories, high variance Alternatives based on one-step samples : v 'T v</p>
    <p>Bruno Scherrer INRIA - LORIA - Maia Team 4/28</p>
  </div>
  <div class="page">
    <p>TD(0) x point method</p>
    <p>One looks for vTD  span () satisfying vTD = T vTD.</p>
    <p>When the inverse exists (Schoknecht, 2002), it can be proved that vTD = wTD with</p>
    <p>wTD = ( L)1r</p>
    <p>This is equivalent to minimizing for v  span () the TD error ETD (v) := v  T v down to 0. (Antos et al., 2008; Farahmand et al., 2008; Sutton et al., 2009)</p>
    <p>Bruno Scherrer INRIA - LORIA - Maia Team 5/28</p>
  </div>
  <div class="page">
    <p>Bellman Residual minimization method</p>
    <p>One looks for v  span () minimizing EBR (v) := v T v.</p>
    <p>Since EBR (w) = w Pw   w</p>
    <p>r,  = (I P) = L ,</p>
    <p>it can be seen that vBR = wBR with</p>
    <p>wBR = ( )1r = (LL)1Lr.</p>
    <p>The above inverse always exists (Schoknecht, 2002).</p>
    <p>Bruno Scherrer INRIA - LORIA - Maia Team 6/28</p>
  </div>
  <div class="page">
    <p>Bruno Scherrer INRIA - LORIA - Maia Team 7/28</p>
  </div>
  <div class="page">
    <p>Example 1 (Sutton et al., 2009)</p>
    <p>=</p>
    <p>( 1 0 0 1 0 0 0 1 0 0 0 1</p>
    <p>) ,  =</p>
    <p>( .25 .25 .25 .25</p>
    <p>) ,</p>
    <p>v(1) = w1, v(2) = w1, v(3) = w2, v(4) = w3</p>
    <p>We have vTD = vbest while vBR 6= vbest.</p>
    <p>Bruno Scherrer INRIA - LORIA - Maia Team 8/28</p>
  </div>
  <div class="page">
    <p>Example 2</p>
    <p>= (</p>
    <p>) ,  =</p>
    <p>( .5 .5</p>
    <p>) , v(1) = w, v(2) = 2w,</p>
    <p>v  vbest, vTD, vBR  e(v) = vv vbestv</p>
    <p>TD BR</p>
    <p>theta 0.1</p>
    <p>err ratio</p>
    <p>e rr</p>
    <p>r a tio</p>
    <p>gamma</p>
    <p>TD BR</p>
    <p>Bruno Scherrer INRIA - LORIA - Maia Team 9/28</p>
  </div>
  <div class="page">
    <p>Bruno Scherrer INRIA - LORIA - Maia Team 10/28</p>
  </div>
  <div class="page">
    <p>Guarantee when minimizing BR</p>
    <p>Proposition (Williams &amp; Baird, 1993)</p>
    <p>v, v  v  1</p>
    <p>Proposition</p>
    <p>v, v  v   C ()</p>
    <p>where C () := maxi,j pij i</p>
    <p>is a concentration coecient (Munos, 2003)</p>
    <p>Bruno Scherrer INRIA - LORIA - Maia Team 11/28</p>
  </div>
  <div class="page">
    <p>Relation between the 2 criteria</p>
    <p>Proposition</p>
    <p>The BR is an upper bound of the TD error, and more precisely :</p>
    <p>v  span () ,EBR (v)2 = ETD (v)2 + T v  T v2.</p>
    <p>The adequacy term T v  T v matters ! Bruno Scherrer INRIA - LORIA - Maia Team 12/28</p>
  </div>
  <div class="page">
    <p>Bruno Scherrer INRIA - LORIA - Maia Team 13/28</p>
  </div>
  <div class="page">
    <p>Oblique projections</p>
    <p>Projection onto span () orthogonally to span (X ) A linear projection ( = ) is dened by its range span () (dim. m) and its null</p>
    <p>space (dim. N m), of which the orthogonal complement (dim. m) is span (X ).</p>
    <p>X = X , X = (X )1X</p>
    <p>Properties : w = X v  w = X v, X  = Im, X X = X</p>
    <p>When X =  : Euclidean orthogonal projection When X =  : Orthogonal projection w.r.t.  .</p>
    <p>Bruno Scherrer INRIA - LORIA - Maia Team 14/28</p>
  </div>
  <div class="page">
    <p>Main result</p>
    <p>Proposition</p>
    <p>For any X, the solution of the projected equation</p>
    <p>vX = XT vX</p>
    <p>is the oblique projection of v onto span () orthogonally to span (LX ), i.e. vX = LX v.</p>
    <p>The TD x point and the BR minimizer respectively corredpond to the cases X = XTD =  and X = XBR = L.</p>
    <p>TD/BR are oblique projections of the value</p>
    <p>BR is a xed point method</p>
    <p>Neither TD nor BR is optimal for   (X = L1 is)</p>
    <p>Bruno Scherrer INRIA - LORIA - Maia Team 15/28</p>
  </div>
  <div class="page">
    <p>Proof</p>
    <p>One solves : wX = X (r + PwX ).</p>
    <p>Multiplying on both sides by X , one obtains :</p>
    <p>wX = X (r + PwX )</p>
    <p>wX = (I X P)1X r.</p>
    <p>Hence, wX = (I (X )1X P)1(X )1X r =</p>
    <p>[ (X )(I (X )1X P)</p>
    <p>]1 X  r</p>
    <p>= (X (I P))1X r = (X L)1X Lv</p>
    <p>= LX v</p>
    <p>wTD = (</p>
    <p>XTD</p>
    <p>L)1  XTD</p>
    <p>Lv and wBR = (  L</p>
    <p>XBR</p>
    <p>L)1 L   XBR</p>
    <p>Lv.</p>
    <p>Bruno Scherrer INRIA - LORIA - Maia Team 16/28</p>
  </div>
  <div class="page">
    <p>Related works</p>
    <p>Proposition (Schoknecht, 2002)</p>
    <p>The TD x point and the BR minimizer are orthogonal projections of the value v respectively induced by the seminorm  QTD with QTD = L</p>
    <p>L and by the norm  QBR with QBR = L L.</p>
    <p>Proposition (revisiting (Yu &amp; Bertsekas, 2008))</p>
    <p>For any choice of X, the approximation error satises :</p>
    <p>v  vX  LXv  vbest =</p>
    <p>(ABCB)v  vbest</p>
    <p>where A = , B = (X L)1 and C = XL1LX are matrices of size m m.</p>
    <p>Bruno Scherrer INRIA - LORIA - Maia Team 17/28</p>
  </div>
  <div class="page">
    <p>Bruno Scherrer INRIA - LORIA - Maia Team 18/28</p>
  </div>
  <div class="page">
    <p>Model</p>
    <p>Spaces of dimension n = 2,3, ...,30</p>
    <p>Projections of dimension k = 1,2, ...,n</p>
    <p>For each (n,k)</p>
    <p>Bruno Scherrer INRIA - LORIA - Maia Team 19/28</p>
  </div>
  <div class="page">
    <p>TD win ratio</p>
    <p>E[TD wins] 0.5</p>
    <p>proj. space dim.</p>
    <p>space dim.</p>
    <p>Bruno Scherrer INRIA - LORIA - Maia Team 20/28</p>
  </div>
  <div class="page">
    <p>Expectation of e(vTD)/e(vBR)</p>
    <p>E[TD_err/BR_err] 1</p>
    <p>proj. space dim.</p>
    <p>space dim.</p>
    <p>Bruno Scherrer INRIA - LORIA - Maia Team 21/28</p>
  </div>
  <div class="page">
    <p>Expectation of e(vTD)</p>
    <p>E[TD_err/err]</p>
    <p>proj. space dim.</p>
    <p>space dim.</p>
    <p>Bruno Scherrer INRIA - LORIA - Maia Team 22/28</p>
  </div>
  <div class="page">
    <p>Expectation of e(vBR)</p>
    <p>E[BR_err/err]</p>
    <p>proj. space dim.</p>
    <p>space dim.</p>
    <p>Bruno Scherrer INRIA - LORIA - Maia Team 23/28</p>
  </div>
  <div class="page">
    <p>Prediction of the best method through bounds</p>
    <p>E[good prediction] 0.5</p>
    <p>proj. space dim.</p>
    <p>space dim.</p>
    <p>Bruno Scherrer INRIA - LORIA - Maia Team 24/28</p>
  </div>
  <div class="page">
    <p>Conclusion and future work</p>
    <p>TD x point and BR methods</p>
    <p>Two examples, where each method outperforms the other</p>
    <p>A unied view in terms of oblique projection :</p>
    <p>Both methods solve a x point equation (new for BR) Both amounts to do an oblique projection of v Related to/extends (Schoknecht, 2002) and (Yu &amp; Bertsekas, 2008)</p>
    <p>Bruno Scherrer INRIA - LORIA - Maia Team 25/28</p>
  </div>
  <div class="page">
    <p>Conclusion and future work</p>
    <p>Which method ?</p>
    <p>BR is sounder than TD Extensive simulations suggest :</p>
    <p>TD is more often better than BR Sometimes, TD fails dramatically BR is better on average</p>
    <p>Some reasons to use TD :</p>
    <p>When sampling, BR requires double samples TD() with  big enough solves the stability issue</p>
    <p>Future work :</p>
    <p>TD() vs BR() for  &gt; 0 New to RL, the idea of oblique projection is well established in the Numerical Analysis community (Saad, 2003)</p>
    <p>Bruno Scherrer INRIA - LORIA - Maia Team 26/28</p>
  </div>
  <div class="page">
    <p>References I</p>
    <p>Antos, A., Szepesvri, C., &amp; Munos, R. 2008. Learning near-optimal policies with Bellman-residual minimization based tted policy iteration and a single sample path. Machine Learning, 71(1), 89129.</p>
    <p>Bertsekas, D.P., &amp; Tsitsiklis, J.N. 1996. Neurodynamic Programming. Athena Scientic.</p>
    <p>Farahmand, A.M., Ghavamzadeh, M., Szepesvri, C., &amp; Mannor, S. 2008. Regularized Policy Iteration. In : NIPS.</p>
    <p>Munos, R. 2003. Error Bounds for Approximate Policy Iteration. In : ICML.</p>
    <p>Puterman, M. 1994. Markov Decision Processes. Wiley, New York.</p>
    <p>Saad, Y. 2003. Iterative Methods for Sparse Linear Systems, 2nd edition. Philadelpha, PA : SIAM.</p>
    <p>Bruno Scherrer INRIA - LORIA - Maia Team 27/28</p>
  </div>
  <div class="page">
    <p>References II</p>
    <p>Schoknecht, R. 2002. Optimality of Reinforcement Learning Algorithms with Linear Function Approximation. Pages 15551562 of : NIPS.</p>
    <p>Sutton, R. S., Maei, H. R., Precup, D., Bhatnagar, S., Silver, D., Szepesvri, C., &amp; Wiewiora, E. 2009. Fast Gradient-Descent Methods for Temporal-Dierence Learning with Linear Function Approximation. In : ICML.</p>
    <p>Sutton, R.S., &amp; Barto, A.G. 1998. Reinforcement Learning, An introduction. BradFord Book. The MIT Press.</p>
    <p>Williams, R. J., &amp; Baird, L. C. 1993. Tight performance bounds on greedy policies based on imperfect value functions. Tech. rept. College of Computer Science, Northeastern University.</p>
    <p>Yu, H., &amp; Bertsekas, D.P. 2008 (July). New Error Bounds for Approximations from Projected Linear Equations. Tech. rept. C-2008-43. Dept. Computer Science, Univ. of Helsinki.</p>
    <p>Bruno Scherrer INRIA - LORIA - Maia Team 28/28</p>
  </div>
</Presentation>
