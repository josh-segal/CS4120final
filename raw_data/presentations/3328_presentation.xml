<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Flip Feng Shui: Hammering a Needle in the Software Stack</p>
    <p>Kaveh Razavi Ben Gras Erik Bosman Bart Preneel1 Cristiano Giuffrida Herbert Bos</p>
    <p>August 10, 2016</p>
  </div>
  <div class="page">
    <p>Teaser</p>
    <p>I OpenSSH compromise</p>
    <p>I apt-get compromise by GPG signature forgery</p>
    <p>I No software bug</p>
    <p>I Weak assumptions</p>
    <p>I Demo!</p>
  </div>
  <div class="page">
    <p>Contribution</p>
    <p>Flip Feng Shui is a novel exploitation structure</p>
    <p>I Hardware glitch</p>
    <p>I Memory massaging primitive</p>
    <p>Makes the glitch</p>
    <p>I Easy to target precisely</p>
    <p>I Reliable</p>
    <p>We demonstrate FFS = Rowhammer + Memory Deduplication</p>
  </div>
  <div class="page">
    <p>Outline</p>
    <p>Flip Feng Shui At Work</p>
    <p>Flip Feng Shui Mechanics</p>
    <p>OpenSSH Attack</p>
    <p>GPG/APT Updates Attack Demo</p>
    <p>Notification, Conclusion &amp; Further Resources</p>
  </div>
  <div class="page">
    <p>Outline</p>
    <p>Flip Feng Shui At Work</p>
    <p>Flip Feng Shui Mechanics</p>
    <p>OpenSSH Attack</p>
    <p>GPG/APT Updates Attack Demo</p>
    <p>Notification, Conclusion &amp; Further Resources</p>
  </div>
  <div class="page">
    <p>Outline</p>
    <p>Flip Feng Shui At Work</p>
    <p>Flip Feng Shui Mechanics</p>
    <p>OpenSSH Attack</p>
    <p>GPG/APT Updates Attack Demo</p>
    <p>Notification, Conclusion &amp; Further Resources</p>
  </div>
  <div class="page">
    <p>Outline</p>
    <p>Flip Feng Shui At Work</p>
    <p>Flip Feng Shui Mechanics</p>
    <p>OpenSSH Attack</p>
    <p>GPG/APT Updates Attack Demo</p>
    <p>Notification, Conclusion &amp; Further Resources</p>
  </div>
  <div class="page">
    <p>Outline</p>
    <p>Flip Feng Shui At Work</p>
    <p>Flip Feng Shui Mechanics</p>
    <p>OpenSSH Attack</p>
    <p>GPG/APT Updates Attack Demo</p>
    <p>Notification, Conclusion &amp; Further Resources</p>
  </div>
  <div class="page">
    <p>Section 1</p>
    <p>Flip Feng Shui At Work</p>
  </div>
  <div class="page">
    <p>Flip Feng Shui I Flip one bit per page in a co-hosted victim VM</p>
    <p>I Whenever you know its contents</p>
    <p>I Organised bitflip</p>
    <p>I DRAM glitch</p>
    <p>I Breaks CPU virtualization isolation</p>
  </div>
  <div class="page">
    <p>Section 2</p>
    <p>Flip Feng Shui Mechanics</p>
  </div>
  <div class="page">
    <p>Flip Feng Shui Mechanics</p>
    <p>I Co-hosted VMs</p>
    <p>I Memory deduplication</p>
    <p>I Rowhammer</p>
    <p>I RSA</p>
  </div>
  <div class="page">
    <p>Memory deduplication</p>
  </div>
  <div class="page">
    <p>Memory deduplication</p>
  </div>
  <div class="page">
    <p>Memory deduplication</p>
  </div>
  <div class="page">
    <p>Memory deduplication</p>
  </div>
  <div class="page">
    <p>Memory deduplication</p>
  </div>
  <div class="page">
    <p>Rowhammer</p>
    <p>I Causes charge to leak in DRAM</p>
    <p>I DRAM row activations cause flips</p>
  </div>
  <div class="page">
    <p>Rowhammer</p>
    <p>I Causes charge to leak in DRAM</p>
    <p>I DRAM row activations cause flips</p>
  </div>
  <div class="page">
    <p>Rowhammer</p>
    <p>I Causes charge to leak in DRAM</p>
    <p>I DRAM row activations cause flips</p>
  </div>
  <div class="page">
    <p>Rowhammer</p>
    <p>I Causes charge to leak in DRAM</p>
    <p>I DRAM row activations cause flips</p>
  </div>
  <div class="page">
    <p>Rowhammer</p>
    <p>I Causes charge to leak in DRAM</p>
    <p>I DRAM row activations cause flips</p>
  </div>
  <div class="page">
    <p>Rowhammer</p>
    <p>I Causes charge to leak in DRAM</p>
    <p>I DRAM row activations cause flips</p>
  </div>
  <div class="page">
    <p>Rowhammer</p>
    <p>I Causes charge to leak in DRAM</p>
    <p>I DRAM row activations cause flips</p>
  </div>
  <div class="page">
    <p>Rowhammer</p>
    <p>I Causes charge to leak in DRAM</p>
    <p>I DRAM row activations cause flips</p>
  </div>
  <div class="page">
    <p>Rowhammer</p>
    <p>I Causes charge to leak in DRAM</p>
    <p>I DRAM row activations cause flips</p>
  </div>
  <div class="page">
    <p>Memory deduplication + Rowhammer = FFS</p>
  </div>
  <div class="page">
    <p>Memory deduplication + Rowhammer = FFS</p>
  </div>
  <div class="page">
    <p>Memory deduplication + Rowhammer = FFS</p>
  </div>
  <div class="page">
    <p>Memory deduplication + Rowhammer = FFS</p>
    <p>I FFS breaks COW</p>
  </div>
  <div class="page">
    <p>RSA</p>
    <p>I Public key cryptosystem</p>
    <p>I Two keys: public and private</p>
    <p>I Compute secret private from factorization</p>
  </div>
  <div class="page">
    <p>FFS - What now? Break weakened RSA.</p>
    <p>F a c to</p>
    <p>ri z a ti</p>
    <p>o n S</p>
    <p>u c c e ss</p>
    <p>P ro</p>
    <p>b a b il it</p>
    <p>y</p>
    <p>Available Templates</p>
  </div>
  <div class="page">
    <p>Section 3</p>
    <p>OpenSSH Attack</p>
  </div>
  <div class="page">
    <p>authorized keys file</p>
    <p>Looks like this: ssh -rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDX y7MdVToVAvKB0/Xven/kqBzfRZm+GITl6sB0u+Aa 3/ UTC3x+eKjB2jf +48 kTP7AvsdbSwg9Q5upN77xX 3mNGwwj1RUQpOPPc99XH09M84iCydE +9 smYseySf bJQnrov5Ricz2Z18Neuy5ZUH/Ldrf1NSwWoo5NZL 6tj0E9JvZurMPPk2EqEyHltEFC6OetJwEfaPq9kO glmzFtBWLHR4dF1796JeVkFiWcmMaykAoN+JRF2n MlayPlUxdWR0JwxZ2cJ9la/QLXvv8x0tsORGP9ZG 5BWqOcD781evuSS3i91BNg6Osl7mlxo6Mc3oUbew /7 ddV08WjdRBn7iQF9WN beng@mymachine</p>
    <p>I RSA public key</p>
    <p>I Attacker writes this to memory</p>
    <p>I We need the private key</p>
  </div>
  <div class="page">
    <p>OpenSSH FFS attack</p>
  </div>
  <div class="page">
    <p>OpenSSH FFS attack</p>
  </div>
  <div class="page">
    <p>OpenSSH FFS attack</p>
  </div>
  <div class="page">
    <p>OpenSSH FFS attack</p>
  </div>
  <div class="page">
    <p>OpenSSH Attack</p>
    <p>C D</p>
    <p>F</p>
    <p>Attack time (mins)</p>
    <p>successful attacks</p>
    <p>I Could retry</p>
  </div>
  <div class="page">
    <p>Section 4</p>
    <p>GPG/APT Updates Attack Demo</p>
  </div>
  <div class="page">
    <p>GPG/APT Updates</p>
    <p>I With FFS we flip /etc/apt/sources.list</p>
    <p>I With FFS we flip /etc/apt/trusted.gpg</p>
    <p>I Use computed private key</p>
    <p>I Long term RSA Ubuntu signing keys</p>
  </div>
  <div class="page">
    <p>Section 5</p>
    <p>Notification, Conclusion &amp; Further</p>
    <p>Resources</p>
  </div>
  <div class="page">
    <p>Notification I Notified: Red Hat, Oracle, Xen, VMware, Debian,</p>
    <p>Ubuntu, OpenSSH, GnuPG, some hosting companies</p>
    <p>I Thank you NCSC</p>
    <p>I GnuPG commit</p>
  </div>
  <div class="page">
    <p>Conclusion</p>
    <p>I Flip Feng Shui breaks isolation</p>
    <p>I Co-hosting VMs is risky</p>
    <p>I Disable memory dedup</p>
    <p>https://www.vusec.net/projects/flip-feng-shui</p>
  </div>
</Presentation>
