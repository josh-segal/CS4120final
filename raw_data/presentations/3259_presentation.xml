<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>UIPicker: User-Input Privacy Identification in</p>
    <p>Mobile Applications</p>
    <p>Yuhong Nan, Min Yang, Zhemin Yang, Shunfan Zhou</p>
    <p>Fudan University</p>
    <p>Guofei Gu Xiaofeng Wang</p>
    <p>Texas A&amp;M University Indiana University at Bloomington</p>
  </div>
  <div class="page">
    <p>Page 2</p>
    <p>Privacy leakage</p>
    <p>Apps insecure implementation</p>
    <p>Vulnerabilities in system</p>
    <p>Motivation</p>
  </div>
  <div class="page">
    <p>Page 3</p>
    <p>Existing Works</p>
    <p>Dynamic/Static taint analysis</p>
    <p>TaintDroid [OSDI 10]</p>
    <p>FlowDroid [PLDI 14]</p>
    <p>Motivation</p>
    <p>Access control mechanisms</p>
    <p>SELinux on Android</p>
    <p>Auriasium [SECURITY12]</p>
  </div>
  <div class="page">
    <p>Page 4</p>
    <p>But wait</p>
    <p>Location</p>
    <p>Contact</p>
    <p>SMS</p>
    <p>Phone Number</p>
    <p>LocationManager. getLastKnownLocation()</p>
    <p>ContentResolver.query(CONTACT_URI)</p>
    <p>SmsMessage. getMessageBody ()</p>
    <p>TelephonyManager. getLine1Number()</p>
    <p>System Centric Privacy Data</p>
  </div>
  <div class="page">
    <p>Page 5</p>
    <p>User-Input Centric Privacy Data (UIP Data)</p>
    <p>But wait</p>
    <p>Account Credentials &amp; Profiles</p>
    <p>Location</p>
    <p>Financial</p>
  </div>
  <div class="page">
    <p>Page 6</p>
    <p>UIP data cannot be found without parsing the context and semantic of UIs</p>
    <p>Label all input as sensitive</p>
    <p>Large number of false positives</p>
    <p>Manually specify such contents need to be protected</p>
    <p>Intensive human intervention</p>
    <p>Challenges</p>
  </div>
  <div class="page">
    <p>Page 7</p>
    <p>UIPicker</p>
    <p>Novel framework for automatic, large-scale User-Input Privacy</p>
    <p>(UIP data) identification within Android apps.</p>
    <p>Runtime Security-Enhancement Mechanism</p>
    <p>Protect insecure UIP data transmission in apps runtime</p>
    <p>Our Work</p>
  </div>
  <div class="page">
    <p>Page 8</p>
    <p>Privacy-related semantics exist in</p>
    <p>UI Screens</p>
    <p>Layout resource files</p>
    <p>&lt;TextView android:text=&quot;@string/opl_new_payment_credit_card_number&quot; /&gt;</p>
    <p>&lt;EditText android:id=&quot;@id/opl_credit_card_number&quot; android:inputType=&quot;number&quot; /&gt;</p>
    <p>Key Observation</p>
  </div>
  <div class="page">
    <p>Page 9</p>
    <p>How to get complete privacy-related texts</p>
    <p>Highly unstructured semantics</p>
    <p>E.g. password, pass, pwd,</p>
    <p>Sparsely distributed in different UIs</p>
    <p>Impractical for manual collecting</p>
    <p>To what extent, a layout element could be UIP data</p>
    <p>Keyword based search? imprecise results</p>
    <p>E.g. Split Username into user &amp; name</p>
    <p>Technical challenges</p>
  </div>
  <div class="page">
    <p>Page 10</p>
    <p>UIPicker Overview</p>
    <p>APP Private-related Text Analysis</p>
    <p>UIP Data Identification</p>
    <p>Behavior Based Result</p>
    <p>Filtering</p>
    <p>Result</p>
    <p>Pre-ProcessingPre-Processing</p>
    <p>Private-related Text Analysis</p>
    <p>UIP Data Identification</p>
    <p>Behavior Based Result</p>
    <p>Filtering</p>
    <p>describing UIP data 3. Identify UIP data from textual</p>
    <p>semantics 4. Confirm UIP data with application</p>
    <p>code behaviors</p>
  </div>
  <div class="page">
    <p>Page 11</p>
    <p>Resource Extraction</p>
    <p>Word splitting  Delimiter/Letter-separated words</p>
    <p>Redundant content removal  Non-English strings/Stop words</p>
    <p>Stemming  Reduce the number of texts</p>
    <p>E.g. Change secured, security into secure</p>
    <p>Pre-Processing</p>
    <p>@id/opl_credit_card_number @string/opl_new_credit_card_expiration_date_month @string/opl_new_credit_card_save_button</p>
    <p>UI Texts</p>
    <p>Layout Descriptions</p>
  </div>
  <div class="page">
    <p>Page 12</p>
    <p>Privacy-related Texts Analysis</p>
    <p>Privacy-related layout Selection</p>
    <p>E.g. Login, Registration, settings page.</p>
    <p>By initial seeds with heuristic rules</p>
    <p>Privacy-related texts clustering</p>
    <p>Words appeared most in privacyrelated layouts rather than normal layouts.</p>
    <p>By applying Chi-Square test.</p>
    <p>Initial seeds</p>
    <p>Inferred texts</p>
  </div>
  <div class="page">
    <p>Page 13</p>
    <p>UIP Data Identification</p>
    <p>Classifier: Support Vector Machine</p>
    <p>Features</p>
    <p>Privacy-related texts</p>
    <p>Sibling elements</p>
    <p>E.g. Short phrase for describing the input field.</p>
    <p>Training Data</p>
    <p>Subset of UIP data element</p>
    <p>Text fields with sensitive inputtype.</p>
    <p>Manual labelled element for Financial inputs</p>
    <p>&lt;EditText android:id=&quot;@id/password_edittext&quot; android:inputType=&quot;textPassword&quot; /&gt;</p>
  </div>
  <div class="page">
    <p>Page 14</p>
    <p>Behavior Based Result Filtering</p>
    <p>Matching UIP data behaviors reflected in</p>
    <p>applications program code</p>
    <p>Filter out static labels which only contain</p>
    <p>privacy-related semantics</p>
    <p>Recover Input fields other than EditText  Implicit user input</p>
    <p>E.g. Drop down list</p>
    <p>Customized input</p>
    <p>E.g. com.alipay.inputBox</p>
  </div>
  <div class="page">
    <p>Page 15</p>
    <p>Activity.setContentView(R.layout.add_credit_card.xml)</p>
    <p>Void OnCreate(Bundle bundle){</p>
    <p>InputBox IB = findViewById(2131231511);</p>
    <p>submitBtn = findViewById(2131623982);</p>
    <p>submitBtn.setOnClickListener(new addCardListener());</p>
    <p>}</p>
    <p>addCardListener.onClick(View v) {  creditCard = IB.getText(); sendContent(creditCard) ..</p>
    <p>}</p>
    <p>UIP Data Elements</p>
    <p>Behavior Based Result Filtering</p>
  </div>
  <div class="page">
    <p>Page 16</p>
    <p>Runtime Security Enhancement</p>
    <p>Bank of China(Credit Card)</p>
    <p>Expire Date</p>
    <p>Security Code</p>
    <p>Card Holders Name</p>
    <p>Identity Number</p>
    <p>Phone Number</p>
    <p>Verify Code</p>
    <p>Taint Tracking based on UIPicker</p>
    <p>Plain Text transmission  Runtime checking</p>
    <p>Insecure SSL implementation  Offline analysis with MalloDroid [CCS 12]</p>
    <p>TaintDroid</p>
  </div>
  <div class="page">
    <p>Page 17</p>
    <p>UIPicker Evaluation</p>
    <p>Dataset</p>
    <p>17,425 apps crawled from Google-Play in Oct.2014</p>
    <p>35 categories, 500 apps for each</p>
  </div>
  <div class="page">
    <p>Page 18</p>
    <p>UIP Data Distribution</p>
    <p>6,179 (35.46%) contain UIP data in 17,425 Apps</p>
    <p>Exist in more than half of apps in 9 out of 35 categories.</p>
    <p>Account Credentials &amp; User Profile Location Financial</p>
  </div>
  <div class="page">
    <p>Page 19</p>
    <p>Effectiveness</p>
    <p>Compare with System Defined APIs (# Apps)</p>
    <p>Category System Defined APIs UIPicker Overlap</p>
    <p>Account Credentials &amp; User Profile</p>
    <p>Location 15,221 2,883 2,282</p>
    <p>Financial - 1,318</p>
    <p>Total 15,632 6,179</p>
    <p>TelephonyManager.getLine1Number() AccountManager.getAccounts()</p>
    <p>LocationManager.getLastKnownLocation() Location.getLongitude() Location.getLatitude()</p>
  </div>
  <div class="page">
    <p>Page 20</p>
    <p>Effectiveness</p>
    <p>Compare with Sensitive Attributes(# Elements)</p>
    <p>Category InputType UIPicker Incremental</p>
    <p>Account Credentials &amp; User Profile</p>
    <p>Location 941 14,311 13,370</p>
    <p>Financial - 6,353</p>
    <p>Total 24,962 71,224 46,262</p>
    <p>textEmailAddress textPersonName textPassword textVisiblePassword password/email/phoneNumber textPostalAddress</p>
  </div>
  <div class="page">
    <p>Page 21</p>
    <p>Type # Elements % in UIP Data</p>
    <p>TextView 10,582 14.86%</p>
    <p>Customized 5,075 7.13%</p>
    <p>Spinner 1,962 2.75%</p>
    <p>Others 784 1.10%</p>
    <p>Total 18,403 25.84%</p>
    <p>Effectiveness</p>
    <p>Compare with Sensitive Attributes(# Elements)</p>
  </div>
  <div class="page">
    <p>Page 22</p>
    <p>Precision</p>
    <p>Manual Validation</p>
    <p>200 random selected apps in 10 categories (20 in each)</p>
    <p>False Positives: 67/1042 elements</p>
    <p>False Negatives: 107 elements</p>
    <p>Overall: 93.6% Precision and 90.1% Recall</p>
  </div>
  <div class="page">
    <p>Page 23</p>
    <p>Conclusion</p>
    <p>UIPicker: Identify UIP data based on novel combination of</p>
    <p>NLP, machine-learning approach, and static analysis</p>
    <p>techniques</p>
    <p>Runtime security enhancement based on UIPicker</p>
    <p>Easily be deployed for other existing mechanisms for</p>
    <p>privacy analysis/protection.</p>
  </div>
  <div class="page">
    <p>Page 24</p>
    <p>Thanks Questions?</p>
  </div>
</Presentation>
