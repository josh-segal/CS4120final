<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>An Ever-evolving Game: Evaluation of Real-world Attacks and</p>
    <p>Defenses in Ethereum Ecosystem</p>
    <p>Shunfan Zhou, Zhemin Yang, Jie Xiang, Yinzhi Cao, Min Yang, and Yuan Zhang</p>
    <p>Fudan University,  Johns Hopkins University</p>
    <p>USENIX Security</p>
  </div>
  <div class="page">
    <p>Smart Contract Incidents</p>
    <p>https://blog.ethereum.org/2016/07/20/hard-fork-completed/ https://www.parity.io/security-alert-2/</p>
  </div>
  <div class="page">
    <p>Are they exploited?</p>
    <p>Vulnerable contracts reported  8.8k by Oyente, CCS 16  5k by Securify, CCS 18  21k by ZEUS, NDSS 18</p>
    <p>Perez and Livshits, arXiv:1902.06710  at most 504 out of 21,270 contracts have been subjected to exploits</p>
    <p>Gap exists between vulnerable contracts and real-world attacks!</p>
  </div>
  <div class="page">
    <p>Questions</p>
    <p>What contracts have been attacked? and</p>
    <p>What attacks have been prevented?</p>
  </div>
  <div class="page">
    <p>From contracts to transactions</p>
    <p>Task: Examine all the transactions in Ethereum  420m transactions from August 2015 to March 2019</p>
  </div>
  <div class="page">
    <p>Measurement Workflow</p>
  </div>
  <div class="page">
    <p>Airdrop Hunting Example</p>
  </div>
  <div class="page">
    <p>An attack transaction</p>
  </div>
  <div class="page">
    <p>An attack transaction</p>
    <p>ControllerAttacker Action Tree NULL</p>
    <p>Bot1 0</p>
    <p>Victim 0, 0</p>
    <p>Bot49</p>
    <p>Victim</p>
    <p>Controller</p>
  </div>
  <div class="page">
    <p>An attack transaction</p>
    <p>ControllerAttacker Action Tree call</p>
    <p>Bot1 create</p>
    <p>Victim call</p>
    <p>Bot49</p>
    <p>create Controller</p>
    <p>suicide</p>
    <p>Victim</p>
    <p>Controller</p>
    <p>call</p>
    <p>suicide</p>
  </div>
  <div class="page">
    <p>An attack transaction</p>
    <p>Result Graph</p>
    <p>Controller</p>
    <p>Bot1</p>
    <p>Bot49</p>
    <p>token transfer 1,000,000</p>
    <p>token transfer 1,000,000</p>
    <p>ControllerAttacker Action Tree call</p>
    <p>Bot1 create</p>
    <p>Victim call</p>
    <p>Bot49</p>
    <p>create Controller</p>
    <p>suicide</p>
    <p>Victim</p>
    <p>Controller</p>
    <p>call</p>
    <p>suicide</p>
  </div>
  <div class="page">
    <p>Signature Matching</p>
    <p>Result Graph</p>
    <p>Controller</p>
    <p>Bot1</p>
    <p>Bot49</p>
    <p>token transfer 1,000,000</p>
    <p>token transfer 1,000,000</p>
    <p>ControllerAttacker Action Tree call</p>
    <p>Bot1 create</p>
    <p>Victim call</p>
    <p>Bot49</p>
    <p>create Controller</p>
    <p>suicide</p>
    <p>Victim</p>
    <p>Controller</p>
    <p>call</p>
    <p>suicide</p>
    <p>Action Clause Result Clause C0</p>
    <p>create C1</p>
    <p>Cn</p>
    <p>create</p>
    <p>call token transfer</p>
    <p>call token transfer</p>
    <p>C1</p>
    <p>Cn</p>
    <p>C0</p>
    <p>token transfer</p>
    <p>token transfer</p>
  </div>
  <div class="page">
    <p>Signature Matching</p>
    <p>Result Graph</p>
    <p>Controller</p>
    <p>Bot1</p>
    <p>Bot49</p>
    <p>token transfer 1,000,000</p>
    <p>token transfer 1,000,000</p>
    <p>ControllerAttacker Action Tree call</p>
    <p>Bot1 create</p>
    <p>Victim call</p>
    <p>Bot49</p>
    <p>create Controller</p>
    <p>suicide</p>
    <p>Victim</p>
    <p>Controller</p>
    <p>call</p>
    <p>suicide</p>
    <p>Action Clause Result Clause C0</p>
    <p>create C1</p>
    <p>Cn</p>
    <p>create</p>
    <p>call token transfer</p>
    <p>call token transfer</p>
    <p>C1</p>
    <p>Cn</p>
    <p>C0</p>
    <p>token transfer</p>
    <p>token transfer</p>
    <p>Attempted Adversarial</p>
  </div>
  <div class="page">
    <p>Signature Matching</p>
    <p>Result Graph</p>
    <p>Controller</p>
    <p>Bot1</p>
    <p>Bot49</p>
    <p>token transfer 1,000,000</p>
    <p>token transfer 1,000,000</p>
    <p>ControllerAttacker Action Tree call</p>
    <p>Bot1 create</p>
    <p>Victim call</p>
    <p>Bot49</p>
    <p>create Controller</p>
    <p>suicide</p>
    <p>Victim</p>
    <p>Controller</p>
    <p>call</p>
    <p>suicide</p>
    <p>Action Clause Result Clause C0</p>
    <p>create C1</p>
    <p>Cn</p>
    <p>create</p>
    <p>call token transfer</p>
    <p>call token transfer</p>
    <p>C1</p>
    <p>Cn</p>
    <p>C0</p>
    <p>token transfer</p>
    <p>token transfer</p>
    <p>Attempted Adversarial  Confirmed Adversarial</p>
  </div>
  <div class="page">
    <p>Failed attack transaction</p>
  </div>
  <div class="page">
    <p>Defense Examples</p>
  </div>
  <div class="page">
    <p>Evaluation: False Positive</p>
  </div>
  <div class="page">
    <p>Evaluation: False Negative</p>
  </div>
  <div class="page">
    <p>Real-world Defenses</p>
  </div>
  <div class="page">
    <p>Gap between vulnerable contracts and attacks</p>
    <p>Only 285 of 112,570 (0.25%) reported vulnerable contracts are really attacked</p>
  </div>
  <div class="page">
    <p>Gap between vulnerable contracts and attacks</p>
    <p>344 Zero-day contracts, missed by previous works due to  Lacking of inter-contract dataflow analysis  Code coverage</p>
  </div>
  <div class="page">
    <p>Gap between vulnerable contracts and attacks</p>
    <p>A conservative estimation of losses (excluding well-known incidents)</p>
  </div>
  <div class="page">
    <p>Advice</p>
    <p>Attack Strategy Shift  2016: Reentrancy  2017: Call injection  2018: Honeypot  2019: Airdrop hunting  And 2020?</p>
  </div>
  <div class="page">
    <p>Thank you! Q &amp; A</p>
    <p>Shunfan Zhou mail: sfzhou17@fudan.edu.cn</p>
    <p>USENIX Security</p>
  </div>
</Presentation>
