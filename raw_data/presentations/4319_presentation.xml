<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Domain Adaptation with Adversarial Training and Graph</p>
    <p>Embeddings</p>
    <p>Qatar Computing Research Institute (QCRI), HBKU, Qatar School of Computer Science and Engineering</p>
    <p>Nanyang Technological University (NTU), Singapore</p>
    <p>Firoj Alam @ firojalam 04</p>
    <p>Shafiq Joty M uhammad Imran @ m im ran15</p>
    <p>@ aidr_qcri</p>
  </div>
  <div class="page">
    <p>Time Critical Events</p>
    <p>Disaster events (earthquake, flood) Urgent needs for affected people</p>
    <p>Info. Info. Info.</p>
    <p>Information gatheringInformation gathering in real-time is the most</p>
    <p>challenging part</p>
    <p>Relief operations</p>
    <p>- Food, w ater - Shelter - M edical assistance - D onations - Service and utilities</p>
    <p>Humanitarian organizations and local administration need information to help and</p>
    <p>launch response</p>
  </div>
  <div class="page">
    <p>Artificial Intelligence for Digital Response (AIDR)</p>
    <p>- Delayed decision-making - Delayed crisis response</p>
    <p>- Early decision-making - Rapid crisis response</p>
    <p>Target</p>
    <p>Response time-line today Response time-line our target</p>
    <p>Target</p>
  </div>
  <div class="page">
    <p>Artificial Intelligence for Digital Response</p>
    <p>http://aidr.qcri.org</p>
    <p>Expert/User/Crisis M anager</p>
    <p>(Crowd Volunteers)</p>
    <p>Facilitates decision m akers</p>
    <p>Hurricane Irma</p>
    <p>Hurricane Harvey</p>
    <p>Hurricane Maria</p>
    <p>California wildfires</p>
    <p>Mexico earthquake</p>
    <p>Iraq &amp; Iran earthquake</p>
    <p>Sri Lanka floods</p>
    <p>Informative Not informative Dont know or cant judge</p>
    <p>Te xt</p>
    <p>Im ag</p>
    <p>e</p>
  </div>
  <div class="page">
    <p>Artificial Intelligence for Digital Response</p>
    <p>http://aidr.qcri.org</p>
    <p>Expert/User/Crisis M anager</p>
    <p>(Crowd Volunteers)</p>
    <p>Facilitates decision m akers</p>
    <p>Hurricane Irma</p>
    <p>Hurricane Harvey</p>
    <p>Hurricane Maria</p>
    <p>California wildfires</p>
    <p>Mexico earthquake</p>
    <p>Iraq &amp; Iran earthquake</p>
    <p>Sri Lanka floods</p>
    <p>Informative Not informative Dont know or cant judge</p>
    <p>Te xt</p>
    <p>Im ag</p>
    <p>e</p>
  </div>
  <div class="page">
    <p>Artificial Intelligence for Digital Response</p>
    <p>http://aidr.qcri.org</p>
    <p>Expert/User/Crisis M anager</p>
    <p>(Crowd Volunteers)</p>
    <p>Facilitates decision m akers</p>
    <p>Hurricane Irma</p>
    <p>Hurricane Harvey</p>
    <p>Hurricane Maria</p>
    <p>California wildfires</p>
    <p>Mexico earthquake</p>
    <p>Iraq &amp; Iran earthquake</p>
    <p>Sri Lanka floods</p>
    <p>Informative Not informative Dont know or cant judge</p>
    <p>Te xt</p>
    <p>Im ag</p>
    <p>e</p>
    <p>Small amount of labeled data and large amount of unlabeled data at the beginning of the event</p>
    <p>Labeled data from the past event. Can we use them? What about domain shift?</p>
  </div>
  <div class="page">
    <p>Our Solutions/Contributions</p>
    <p>How to use large amount of unlabeled data and small amount of labeled data from the same event?  Graph-based semi-supervised</p>
  </div>
  <div class="page">
    <p>Our Solutions/Contributions</p>
    <p>How to use large amount of unlabeled data and small amount of labeled data from the same event?  Graph-based semi-supervised</p>
    <p>How to transfer knowledge from the past events =&gt; Adversarial domain adaptions</p>
  </div>
  <div class="page">
    <p>Domain Adaptation with Adversarial Training and Graph Embeddings</p>
  </div>
  <div class="page">
    <p>Supervised Learning</p>
  </div>
  <div class="page">
    <p>Semi-Supervised component Semi-Supervised Learning</p>
  </div>
  <div class="page">
    <p>Semi-Supervised Learning</p>
    <p>L: number of labeled instances (x1:L, y1:L)  U: number of unlabeled instances (xL+1:L+U)  Design a classifier f: x  y</p>
  </div>
  <div class="page">
    <p>Graph based Semi-Supervised Learning</p>
    <p>Positive Negative</p>
    <p>Similarity</p>
    <p>Assumption: If two instances are similar according to the graph, then class labels should be similar</p>
    <p>D1</p>
    <p>D2 D3</p>
    <p>D4</p>
  </div>
  <div class="page">
    <p>Graph based Semi-Supervised Learning</p>
    <p>Positive Negative</p>
    <p>Similarity</p>
    <p>Positive Negative</p>
    <p>Two Steps:  Graph Construction  Classification</p>
    <p>D1</p>
    <p>D2 D3</p>
    <p>D4</p>
  </div>
  <div class="page">
    <p>Graph Representation  Nodes: Instances (labeled and unlabeled)  Edges: n x n similarity matrix  Each entry ai,j indicates a similarity between instance i and j</p>
    <p>Graph based Semi-Supervised Learning</p>
  </div>
  <div class="page">
    <p>Graph Construction  We construct the graph using k-nearest neighbor (k=10)</p>
    <p>Euclidian distance  Requires n(n-1)/2 distance computation  K-d tree data structure to reduce the computational complexity</p>
    <p>O(logN)  Feature Vector: taking the averaging of the word2vec vectors</p>
    <p>Graph based Semi-Supervised Learning</p>
  </div>
  <div class="page">
    <p>Semi-Supervised component: Loss function</p>
    <p>Graph based Semi-Supervised Learning</p>
    <p>Graph context loss</p>
    <p>Learns the internal representations (embedding) by predicting a node in the graph context</p>
    <p>(Yang et al., 2016)</p>
  </div>
  <div class="page">
    <p>Semi-Supervised component: Loss function</p>
    <p>Graph based Semi-Supervised Learning</p>
    <p>(Yang et al., 2016)</p>
    <p>Two types of context 1. Context is based on the graph to encode structural</p>
    <p>(distributional) information</p>
  </div>
  <div class="page">
    <p>Semi-Supervised component: Loss function</p>
    <p>Graph based Semi-Supervised Learning</p>
    <p>(Yang et al., 2016)</p>
    <p>Two types of context 1. Context is based on the graph to encode structural</p>
    <p>(distributional) information 2. Context is based on the labels to inject label</p>
    <p>information into the embeddings</p>
  </div>
  <div class="page">
    <p>Semi-Supervised component: Loss function</p>
    <p>Graph based Semi-Supervised Learning</p>
    <p>={U,V} Convolution filters and dense layer parameters</p>
    <p>={Vc,W} Parameters specific to the supervised part</p>
    <p>={Vg,C} Parameters specific to the semi-supervised part</p>
  </div>
  <div class="page">
    <p>Domain Adaptation with Adversarial Training and Graph Embeddings</p>
  </div>
  <div class="page">
    <p>Domain Adaptation with Adversarial Training Domain discriminator is defined by:</p>
    <p>Negative log probability of the discriminator loss:</p>
    <p>Domain adversary loss is defined by:</p>
    <p>={U,V} Convolution filters and dense layer parameters  ={Vd,wd} Parameters specific to the domain discriminator part</p>
    <p>d  {0,1} represents the domain of the input tweet t</p>
  </div>
  <div class="page">
    <p>Domain Adaptation with Adversarial Training and Graph Embeddings</p>
    <p>Combined loss Supervised</p>
    <p>Semi-Supervised</p>
    <p>Domain adversarial loss</p>
    <p>We seek parameters that minimizes the classification loss of the class labels and maximizes domain discriminator loss</p>
    <p>={U,V} Convolution filters and dense layer parameters ={Vc,W} Parameters specific to the supervised part ={Vg,C} Parameters specific to the semi-supervised part  ={Vd,wd} Parameters specific to the domain discriminator part</p>
  </div>
  <div class="page">
    <p>Model Training</p>
  </div>
  <div class="page">
    <p>Corpus  Collected during:</p>
    <p>2015 Nepal earthquake  2013 Queensland flood</p>
    <p>A small part of the tweets has been annotated using crowdflower  Relevant: injured or dead people, infrastructure damage, urgent needs</p>
    <p>of affected people, donation requests  Irrelevant: otherwise</p>
    <p>Dataset Relevant Irrelevant Train (60%)</p>
    <p>Dev (20%)</p>
    <p>Test (20%)</p>
    <p>Nepal earthquake 5,527 6,141 7,000 1,167 3,503 Queensland flood 5,414 4,619 6,019 1,003 3,011</p>
    <p>Unlabeled Instances Nepal earthquake: 50K Queensland flood: 21K</p>
  </div>
  <div class="page">
    <p>Experiments and Results  Supervised baseline:  Model trained using Convolution Neural Network (CNN)</p>
    <p>Semi-Supervised baseline (Self-training):  Model trained using CNN were used to automatically label</p>
    <p>unlabeled data  Instances with classifier confidence &gt;=0.75 were used to</p>
    <p>retrain a new model</p>
  </div>
  <div class="page">
    <p>Experiments and Results</p>
    <p>Experiments AUC P R F1 Nepal Earthquake</p>
    <p>Supervised 61.22 62.42 62.31 60.89 Semi-Supervised (Self-training) 61.15 61.53 61.53 61.26 Semi-Supervised (Graph-based) 64.81 64.58 64.63 65.11</p>
    <p>Queensland Flood Supervised 80.14 80.08 80.16 80.16 Semi-Supervised (Self-training) 81.04 80.78 80.84 81.08 Semi-Supervised (Graph-based) 92.20 92.60 94.49 93.54</p>
    <p>Semi-Supervised baseline (Self-training)</p>
  </div>
  <div class="page">
    <p>Experiments and Results  Domain Adaptation Baseline (Transfer Baseline):</p>
    <p>Trained CNN model on source (an event) and tested on target (another event) Source Target AUC P R F1</p>
    <p>In-Domain Supervised Model Nepal Nepal 61.22 62.42 62.31 60.89 Queensland Queensland 80.14 80.08 80.16 80.16</p>
    <p>Transfer Baseline Nepal Queensland 58.99 59.62 60.03 59.10 Queensland Nepal 54.86 56.00 56.21 53.63</p>
  </div>
  <div class="page">
    <p>Experiments and Results  Domain Adaptation</p>
    <p>Source Target AUC P R F1 In-Domain Supervised Model</p>
    <p>Nepal Nepal 61.22 62.42 62.31 60.89 Queensland Queensland 80.14 80.08 80.16 80.16</p>
    <p>Transfer Baseline Nepal Queensland 58.99 59.62 60.03 59.10 Queensland Nepal 54.86 56.00 56.21 53.63</p>
    <p>Domain Adversarial Nepal Queensland 60.15 60.62 60.71 60.94 Queensland Nepal 57.63 58.05 58.05 57.79</p>
  </div>
  <div class="page">
    <p>Experiments and Results Combining all the components of the network</p>
    <p>Source Target AUC P R F1 In-Domain Supervised Model</p>
    <p>Nepal Nepal 61.22 62.42 62.31 60.89 Queensland Queensland 80.14 80.08 80.16 80.16</p>
    <p>Transfer Baseline Nepal Queensland 58.99 59.62 60.03 59.10</p>
    <p>Queensland Nepal 54.86 56.00 56.21 53.63 Domain Adversarial</p>
    <p>Nepal Queensland 60.15 60.62 60.71 60.94 Queensland Nepal 57.63 58.05 58.05 57.79</p>
    <p>Domain Adversarial with Graph Embedding Nepal Queensland 66.49 67.48 65.90 65.92 Queensland Nepal 58.81 58.63 59 59.05</p>
  </div>
  <div class="page">
    <p>Summary  We have seen how graph-embedding based</p>
    <p>semi-supervised approach can be useful for small labeled data scenario</p>
    <p>How can we use existing data and apply domain adaptation technique</p>
    <p>We propose how both techniques can be combined</p>
  </div>
  <div class="page">
    <p>Limitation and Future Study Limitations:  Graph embedding is computationally expensive  Graph constructed using averaged vector from</p>
    <p>word2vec  Explored binary class problem</p>
    <p>Future Study  Convoluted feature for graph construction  Hyper-parameter tuning  Domain adaptation: labeled and unlabeled data from</p>
    <p>target</p>
  </div>
  <div class="page">
    <p>Thank you!</p>
    <p>Firoj Alam, Shafiq Joty, M uhammad Imran. Domain Adaptation with Adversarial Training and Graph Embeddings. ACL, 2018, M elbourne, Australia.</p>
    <p>Please follow us @aidr_qcri</p>
    <p>To get the data: http://crisisnlp.qcri.org/</p>
  </div>
</Presentation>
