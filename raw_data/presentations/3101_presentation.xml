<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>On the Security of Election Audits with</p>
    <p>Low Entropy Randomness</p>
    <p>Eric Rescorla</p>
    <p>ekr@rtfm.com</p>
    <p>EVT/WOTE 2009 On the Security of Election Audits with Low Entropy Randomness 1</p>
  </div>
  <div class="page">
    <p>Overview</p>
    <p>Secure auditing requires random sampling</p>
    <p>The units to be audited must be verifiably unpredictable</p>
    <p>Simple physical methods (dice, coins, etc.) are expensive</p>
    <p>Stretching approaches</p>
    <p>Randomness tables [CWD06]</p>
    <p>Cryptographic pseudorandom number generators</p>
    <p>(CSPRNGs) [CHF08]</p>
    <p>These techniques must be seeded with verifiably random values</p>
    <p>Small (but natural) seeds give the attacker an advantage</p>
    <p>EVT/WOTE 2009 On the Security of Election Audits with Low Entropy Randomness 2</p>
  </div>
  <div class="page">
    <p>Formalizing the Problem: The Auditing Game</p>
    <p>Audit units</p>
    <p>(U)</p>
    <p>Attacked</p>
    <p>(K)</p>
    <p>Audited</p>
    <p>(V)</p>
    <p>VK = /0: Attacker wins</p>
    <p>Audit units</p>
    <p>(U)</p>
    <p>Attacked</p>
    <p>(K)</p>
    <p>Audited</p>
    <p>(V)</p>
    <p>VK 6= /0: Attacker loses</p>
    <p>Two players: Attacker and Auditor</p>
    <p>U audit units (U0,U1, ...UN1)</p>
    <p>Attacker selects K  U to attack (|K| = k)  Selection is made before preliminary results are posted</p>
    <p>Auditor selects V  U to audit (|V| = v)</p>
    <p>EVT/WOTE 2009 On the Security of Election Audits with Low Entropy Randomness 3</p>
  </div>
  <div class="page">
    <p>Auditing Game Strategy</p>
    <p>If the auditors selections are random and i.i.d then:</p>
    <p>Pr(detection) = 1 v1</p>
    <p>i=0</p>
    <p>(N ik) N i</p>
    <p>No matter how the attacker chooses K</p>
    <p>This is the auditors optimal strategy</p>
    <p>What about intermediate cases?</p>
    <p>Attacker has incomplete information about V</p>
    <p>EVT/WOTE 2009 On the Security of Election Audits with Low Entropy Randomness 4</p>
  </div>
  <div class="page">
    <p>Example: A Million Random Digits [RAN02]</p>
    <p>Pick a random starting group and read forward</p>
    <p>This process has log2(#entries) bits of entropy</p>
    <p>EVT/WOTE 2009 On the Security of Election Audits with Low Entropy Randomness 5</p>
  </div>
  <div class="page">
    <p>Random Number Tables Bias and Attacker Advantage</p>
    <p>Random number tables arent the same as random numbers</p>
    <p>The attacker knows the table</p>
    <p>But not the starting point</p>
    <p>Two effects give the attacker an advantage</p>
    <p>Natural variation in the occurrences of each value</p>
    <p>Clustering of values</p>
    <p>EVT/WOTE 2009 On the Security of Election Audits with Low Entropy Randomness 6</p>
  </div>
  <div class="page">
    <p>Natural Variation</p>
    <p>Number of occurrences (n)</p>
    <p>P ro</p>
    <p>b a b ili</p>
    <p>ty</p>
    <p>Binomially distributed counts</p>
    <p>Expected value = T /N</p>
    <p>EVT/WOTE 2009 On the Security of Election Audits with Low Entropy Randomness 7</p>
  </div>
  <div class="page">
    <p>Natural Variation</p>
    <p>Number of occurrences (n)</p>
    <p>P ro</p>
    <p>b a b ili</p>
    <p>ty</p>
    <p>Area=k/N</p>
    <p>Binomially distributed counts</p>
    <p>Expected value = T /N</p>
    <p>Attacker selects k least frequent units</p>
    <p>EVT/WOTE 2009 On the Security of Election Audits with Low Entropy Randomness 8</p>
  </div>
  <div class="page">
    <p>Natural Variation</p>
    <p>Number of occurrences (n)</p>
    <p>P ro</p>
    <p>b a b ili</p>
    <p>ty</p>
    <p>Area=k/N</p>
    <p>n_k  Binomially distributed counts</p>
    <p>Expected value = T /N</p>
    <p>Attacker selects k least frequent units</p>
    <p>The kth least frequent unit appears nk times</p>
    <p>nk = min {</p>
    <p>n : cdf(n)  k N</p>
    <p>}</p>
    <p>EVT/WOTE 2009 On the Security of Election Audits with Low Entropy Randomness 9</p>
  </div>
  <div class="page">
    <p>Auditing with Natural Variation</p>
    <p>Total entries in table corresponding to k least frequent units:</p>
    <p>Tbad = N nk</p>
    <p>n=0</p>
    <p>n(n)</p>
    <p>This is just a standard sampling problem</p>
    <p>Each good sample removes approximately F entries:</p>
    <p>F = T Tbad</p>
    <p>N k  Probability of detection of least frequent k units:</p>
    <p>Pr(detection) = 1 v1</p>
    <p>i=0</p>
    <p>T iF Tbad T iF</p>
    <p>Semi-accurate approximation; see paper.</p>
    <p>EVT/WOTE 2009 On the Security of Election Audits with Low Entropy Randomness 10</p>
  </div>
  <div class="page">
    <p>Clustering Effects</p>
    <p>Were not really sampling the table randomly</p>
    <p>We read entries in sequence</p>
    <p>The order of the entries matters</p>
    <p>A table constructed to minimize detection</p>
    <p>A table constructed to maximize detection</p>
    <p>EVT/WOTE 2009 On the Security of Election Audits with Low Entropy Randomness 11</p>
  </div>
  <div class="page">
    <p>Simulation Studies</p>
    <p>No good analytic model for clustering effect</p>
    <p>Though some potential avenues</p>
    <p>Easiest to study via simulation</p>
    <p>Generate a random table (using CSPRNG)</p>
    <p>Generate an attack set of size k</p>
    <p>Determine which offsets will sample at least one element of K</p>
    <p>Two kinds of attack sets</p>
    <p>Random (should have expected statistics)</p>
    <p>Randomly selected from least frequent 2k units</p>
    <p>Results averaged over multiple tables (525) This is heuristic. We dont have a good algorithm here either.</p>
    <p>EVT/WOTE 2009 On the Security of Election Audits with Low Entropy Randomness 12</p>
  </div>
  <div class="page">
    <p>Example</p>
    <p>Number of Sampled Precincts</p>
    <p>P ro</p>
    <p>b a</p>
    <p>b ili</p>
    <p>ty o</p>
    <p>f D</p>
    <p>e te</p>
    <p>ct in</p>
    <p>g A</p>
    <p>tt a</p>
    <p>ck</p>
    <p>Expected Under Attack</p>
    <p>EVT/WOTE 2009 On the Security of Election Audits with Low Entropy Randomness 13</p>
  </div>
  <div class="page">
    <p>The Attackers View: Modest Advantage</p>
    <p>Still very likely to be detected</p>
    <p>In the above example: about 4x more chance of success at 99%</p>
    <p>Biggest gap around 80% nominal detection rate (71.4% actual)</p>
    <p>Probably not enough to make or break an attack</p>
    <p>But worth doing if youre going to attack anyway</p>
    <p>EVT/WOTE 2009 On the Security of Election Audits with Low Entropy Randomness 14</p>
  </div>
  <div class="page">
    <p>The Auditors View: Higher Work Factor</p>
    <p>Detection Units to Audit Units to Audit Difference</p>
    <p>Probability (projected) (under attack) (percent)</p>
    <p>Required audit levels: 200,000 entries, 1000 precincts, 10 attacked precincts</p>
    <p>EVT/WOTE 2009 On the Security of Election Audits with Low Entropy Randomness 15</p>
  </div>
  <div class="page">
    <p>General Trends</p>
    <p>More entries per unit decrease attacker advantage</p>
    <p>Larger tables</p>
    <p>Fewer units</p>
    <p>Higher attack rates decrease attacker advantage</p>
    <p>Need to select increasingly probable values</p>
    <p>EVT/WOTE 2009 On the Security of Election Audits with Low Entropy Randomness 16</p>
  </div>
  <div class="page">
    <p>A Big Table</p>
    <p>Number of Sampled Precincts</p>
    <p>P ro</p>
    <p>b a</p>
    <p>b ili</p>
    <p>ty o</p>
    <p>f D</p>
    <p>e te</p>
    <p>ct in</p>
    <p>g A</p>
    <p>tt a</p>
    <p>ck</p>
    <p>Expected Under Attack</p>
    <p>EVT/WOTE 2009 On the Security of Election Audits with Low Entropy Randomness 17</p>
  </div>
  <div class="page">
    <p>Permuted Tables</p>
    <p>Number of Sampled Precincts</p>
    <p>P ro</p>
    <p>b a</p>
    <p>b ili</p>
    <p>ty o</p>
    <p>f D</p>
    <p>e te</p>
    <p>ct in</p>
    <p>g A</p>
    <p>tt a</p>
    <p>ck</p>
    <p>Expected Under attack (permuted) Under attack (random)</p>
    <p>EVT/WOTE 2009 On the Security of Election Audits with Low Entropy Randomness 18</p>
  </div>
  <div class="page">
    <p>Potential Improvements</p>
    <p>New tables</p>
    <p>Bigger (107 entries?)</p>
    <p>Permuted rather than random</p>
    <p>Generated using a PRNG?</p>
    <p>Existing tables</p>
    <p>Individual addressing</p>
    <p>Random offsets</p>
    <p>Multiple starting points</p>
    <p>All of these need analysis</p>
    <p>EVT/WOTE 2009 On the Security of Election Audits with Low Entropy Randomness 19</p>
  </div>
  <div class="page">
    <p>What about CSPRNGs?</p>
    <p>CSPRNGs have big state spaces no matter what the seed size</p>
    <p>Stronger than tables for the same seed entropy</p>
    <p>Intuition: sequences dont overlap</p>
    <p>Cryptographic applications require very large seeds</p>
    <p>Not necessary here</p>
    <p>Need unpredictability, not unsearchability</p>
    <p>EVT/WOTE 2009 On the Security of Election Audits with Low Entropy Randomness 20</p>
  </div>
  <div class="page">
    <p>Security of PRNGs by Seed Size (nominal 99% level)</p>
    <p>Bits of entropy</p>
    <p>P ro</p>
    <p>b a</p>
    <p>b ili</p>
    <p>ty o</p>
    <p>f D</p>
    <p>e te</p>
    <p>ct in</p>
    <p>g A</p>
    <p>tt a</p>
    <p>ck</p>
    <p>Probability of detection for PRNGs: 1000 precincts, 10 attacked</p>
    <p>EVT/WOTE 2009 On the Security of Election Audits with Low Entropy Randomness 21</p>
  </div>
  <div class="page">
    <p>Summary</p>
    <p>Secure auditing requires verifiably unpredictable random values</p>
    <p>Generating them directly seems expensive</p>
    <p>Natural stretching approaches may not deliver their expected security</p>
    <p>Not clear if randomness tables can be used safely</p>
    <p>PRNGs appear safe with modest-sized seeds</p>
    <p>EVT/WOTE 2009 On the Security of Election Audits with Low Entropy Randomness 22</p>
  </div>
  <div class="page">
    <p>References</p>
    <p>[CHF08] Joseph A. Calandrino, J. Alex Halderman, and Edward W. Felten. In Defense of</p>
    <p>Pseudorandom Sample Selection. In Proceedings of the 2008 Electronic Voting</p>
    <p>Technology Workshop, 2008. http://www.usenix.org/events/evt08/tech/full_</p>
    <p>papers/calandrino/calandrino.pdf.</p>
    <p>[CWD06] Arel Cordero, David Wagner, and David Dill. The role of dice in election</p>
    <p>auditsextended abstract. IAVoSS Workshop on Trustworthy Elections 2006 (WOTE</p>
    <p>[RAN02] RAND Corporation. A Million Random Digits with 100,000 Normal Deviates.</p>
    <p>American Book Publishers, 2002.</p>
    <p>EVT/WOTE 2009 On the Security of Election Audits with Low Entropy Randomness 23</p>
  </div>
</Presentation>
