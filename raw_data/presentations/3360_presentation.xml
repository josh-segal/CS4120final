<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>A Longitudinal, End-to-End View of the DNSSEC Ecosystem</p>
    <p>Taejoong (tijay) Chung, Roland van Rijswijk-Deij, Bala Chandrasekaran David Choffnes, Dave Levin, Bruce M. Maggs, Alan Mislove, Christo Wilson</p>
  </div>
  <div class="page">
    <p>Domain Name System (DNS)</p>
    <p>example.com's Authoritative DNS Server</p>
    <p>Browser</p>
    <p>DNS Resolver</p>
    <p>example.com example.com</p>
    <p>A records</p>
    <p>A records</p>
  </div>
  <div class="page">
    <p>DNS Spoofing</p>
    <p>example.com's Authoritative DNS Server</p>
    <p>Browser</p>
    <p>DNS Resolver</p>
    <p>example.com example.com</p>
    <p>A recordsA records</p>
  </div>
  <div class="page">
    <p>DNS Spoofing</p>
    <p>example.com's Authoritative DNS Server</p>
    <p>DNS Resolver</p>
    <p>Browser example.com</p>
    <p>A records</p>
    <p>example.com</p>
    <p>A records</p>
    <p>example.com's Authoritative DNS Server</p>
  </div>
  <div class="page">
    <p>DNSSEC 101</p>
    <p>RRSIG</p>
    <p>A records</p>
    <p>A records</p>
    <p>DNSKEY</p>
    <p>DNS Resolver</p>
    <p>A records</p>
    <p>w/ DO bit example.com's Authoritative DNS Server</p>
    <p>Sign!</p>
  </div>
  <div class="page">
    <p>DNSSEC 101</p>
    <p>A records</p>
    <p>w/ DO bit</p>
    <p>RRSIG</p>
    <p>A records</p>
    <p>A records</p>
    <p>DNSKEY</p>
    <p>DNS Resolver example.com's Authoritative DNS Server</p>
    <p>A records</p>
    <p>A records</p>
    <p>w/ DO bit</p>
    <p>DNSKEY</p>
  </div>
  <div class="page">
    <p>DNS Resolver</p>
    <p>DNSKEY</p>
    <p>DNSSEC 101 Hierarchical Structure</p>
    <p>A records</p>
    <p>A records</p>
    <p>w/ DO bit</p>
    <p>DNSKEY</p>
    <p>DNSKEY</p>
    <p>Chain-of-Trust</p>
    <p>example.com's Authoritative DNS Server</p>
    <p>. (root zone)</p>
    <p>.com</p>
  </div>
  <div class="page">
    <p>DNSSEC 101 Hierarchical Structure</p>
    <p>DNSKEY</p>
    <p>Chain-of-Trust</p>
    <p>DNSKEY</p>
    <p>DNSKEY</p>
    <p>DNSKEY</p>
    <p>DNSKEY</p>
    <p>DNS Resolver</p>
    <p>A records</p>
    <p>A records</p>
    <p>w/ DO bit</p>
    <p>example.com's Authoritative DNS Server</p>
    <p>. (root zone)</p>
    <p>.com</p>
  </div>
  <div class="page">
    <p>DNSSEC 101 Hierarchical Structure</p>
    <p>DNSKEY</p>
    <p>Chain-of-Trust</p>
    <p>DNSKEY</p>
    <p>DNSKEY</p>
  </div>
  <div class="page">
    <p>DNSSEC 101 Hierarchical Structure</p>
    <p>RRSIG</p>
    <p>DS Record</p>
    <p>DS Record =Hash( ) DNSKEY</p>
    <p>DNSKEY DNSKEY</p>
    <p>DNSKEY .com</p>
    <p>example.com's Authoritative DNS Server</p>
    <p>Chain-of-Trust</p>
  </div>
  <div class="page">
    <p>DNSKEYs</p>
    <p>DNSSEC 101 Two DNSKEYs</p>
    <p>.com</p>
    <p>zone signing key (ZSK)</p>
    <p>key signing key (KSK)</p>
    <p>A records RRSIG of A</p>
    <p>= Hash of DS Record</p>
    <p>RRSIG of DNSKEYexample.com's Authoritative DNS Server</p>
  </div>
  <div class="page">
    <p>Summary of DNSSEC 101</p>
    <p>Three essential elements for DNSSEC</p>
    <p>has to be uploaded to the parent zone</p>
    <p>Resolvers need to verify all signatures along the chains of trust</p>
    <p>DNSSEC can only function correctly when all principals (server and resolver) work correctly</p>
    <p>DS Record</p>
    <p>DNSKEY</p>
    <p>RRSIG</p>
  </div>
  <div class="page">
    <p>Open Question</p>
    <p>Hows the DNSSEC PKI ecosystem managed?</p>
  </div>
  <div class="page">
    <p>Contribution</p>
    <p>Longitudinal Comprehensive All Angles</p>
  </div>
  <div class="page">
    <p>Outline</p>
    <p>How DNSSEC deployed</p>
    <p>How DNSSEC managed</p>
    <p>How resolvers use DNSSEC</p>
    <p>Authoritative Server Resolver</p>
  </div>
  <div class="page">
    <p>Correct Deployment for Authoritative Servers</p>
    <p>DNSKEY (1) Have DNSKEYs</p>
    <p>RRSIGs (2) Generate Signatures</p>
    <p>Valid RRSIGs</p>
    <p>(3) Valid Signatures (Not expired, correctly signed)</p>
    <p>DS record Uploads</p>
    <p>(4) Generate and upload DS record to the parent zone</p>
    <p>Valid DS record</p>
    <p>(5) Valid DS record (matched with DNSKEYs)</p>
  </div>
  <div class="page">
    <p>Dataset</p>
    <p>Daily Scans*</p>
    <p>TLDs .com, .org., .net</p>
    <p># of domains 147M domains</p>
    <p>Interval every day</p>
    <p>Period 2015/03/01 ~ 2016/12/31</p>
    <p>* https://openintel.nl/</p>
    <p>Over 750 billion DNS Records</p>
  </div>
  <div class="page">
    <p>P e</p>
    <p>r c</p>
    <p>e n</p>
    <p>t o</p>
    <p>f d</p>
    <p>o m</p>
    <p>a in</p>
    <p>s w</p>
    <p>it h</p>
    <p>D N S K E Y</p>
    <p>r e</p>
    <p>c o</p>
    <p>r d</p>
    <p>Date</p>
    <p>.com</p>
    <p>.net</p>
    <p>.org</p>
    <p>DNSSEC Deployment</p>
    <p>Deployment DNSSEC deployment is rare, but growing</p>
    <p>Are they correctly deployed?</p>
    <p>DNSKEY</p>
    <p>RRSIGs</p>
    <p>Valid RRSIGs</p>
    <p>DS record Uploads</p>
    <p>Valid DS record</p>
    <p>RRSIGs</p>
    <p>~1.0%</p>
  </div>
  <div class="page">
    <p>Missing RRSIG records</p>
    <p>DNSKEY</p>
    <p>RRSIGs</p>
    <p>Valid RRSIGs</p>
    <p>DS record Uploads</p>
    <p>Valid DS record</p>
    <p>RRSIGs ~0.3%</p>
    <p>Missing RRSIGs RRSIGs are rarely missing (0.3%)</p>
    <p>missing SOA RRSIG missing DNSKEY RRSIG</p>
    <p>P e</p>
    <p>rc e</p>
    <p>n t</p>
    <p>o f</p>
    <p>d o</p>
    <p>m a</p>
    <p>in s</p>
    <p>m is</p>
    <p>s in</p>
    <p>g R R S I G</p>
    <p>s</p>
    <p>.com</p>
    <p>.net</p>
    <p>.org</p>
    <p>DomainMonster</p>
    <p>~1.0%</p>
    <p>ZSK</p>
    <p>KSK</p>
  </div>
  <div class="page">
    <p>Incorrect RRSIG records</p>
    <p>Expired</p>
    <p>Invalid Signature</p>
    <p>P e</p>
    <p>rc e</p>
    <p>n t</p>
    <p>o f</p>
    <p>d o</p>
    <p>m a</p>
    <p>in s</p>
    <p>w it</p>
    <p>h s</p>
    <p>p e</p>
    <p>c if</p>
    <p>ic f</p>
    <p>a il</p>
    <p>u re</p>
    <p>r e</p>
    <p>a s</p>
    <p>o n</p>
    <p>s</p>
    <p>.com</p>
    <p>.net</p>
    <p>.org</p>
    <p>Expired</p>
    <p>Invalid Signatures</p>
    <p>DNSKEY</p>
    <p>RRSIGs</p>
    <p>Valid RRSIGs</p>
    <p>DS record Uploads</p>
    <p>Valid DS record</p>
    <p>RRSIGs</p>
    <p>Valid RRSIGs</p>
    <p>~0.3%</p>
    <p>Invalid RRSIGs</p>
    <p>RRSIGs are managed well (~0.5%)</p>
    <p>~0.5%</p>
    <p>~1.0%</p>
  </div>
  <div class="page">
    <p>Missing DS records</p>
    <p>DNSKEY</p>
    <p>RRSIGs</p>
    <p>Valid RRSIGs</p>
    <p>DS record Uploads</p>
    <p>Valid DS record</p>
    <p>RRSIGs ~0.3%</p>
    <p>~0.5%</p>
    <p>~30%</p>
    <p>rc e</p>
    <p>n t</p>
    <p>o f</p>
    <p>d o</p>
    <p>m a</p>
    <p>in s</p>
    <p>m is</p>
    <p>s in</p>
    <p>g D S</p>
    <p>r e</p>
    <p>c o</p>
    <p>rd</p>
    <p>.com</p>
    <p>.net</p>
    <p>.org</p>
    <p>DS Records</p>
    <p>Nearly 30% of domains DO NOT upload DS records!</p>
    <p>~1.0%</p>
  </div>
  <div class="page">
    <p>Incorrect DS records</p>
    <p>DNSKEY</p>
    <p>RRSIGs</p>
    <p>Valid RRSIGs</p>
    <p>DS record Uploads</p>
    <p>Valid DS record</p>
    <p>RRSIGs ~0.3%</p>
    <p>~0.5%</p>
    <p>~30%</p>
    <p>P e</p>
    <p>rc e</p>
    <p>n t</p>
    <p>o f</p>
    <p>d o</p>
    <p>m a</p>
    <p>in s</p>
    <p>h a</p>
    <p>v in</p>
    <p>g in</p>
    <p>c o</p>
    <p>rr e</p>
    <p>c t D S</p>
    <p>r e</p>
    <p>c o</p>
    <p>rd</p>
    <p>.com</p>
    <p>.net</p>
    <p>.org</p>
    <p>Incorrect DS record</p>
    <p>Once DS record is generated, it is managed very well (~0.2%)</p>
    <p>~0.2%</p>
    <p>~1.0%</p>
  </div>
  <div class="page">
    <p>Choosing Authoritative Nameserver</p>
    <p>example.com example.com</p>
    <p>example.com's Authoritative DNS Server</p>
    <p>Selfhosted</p>
    <p>example.com's Authoritative DNS Server</p>
    <p>$ $$</p>
  </div>
  <div class="page">
    <p>Why are DS records missing?</p>
    <p>Nameservers # of domains</p>
    <p>DS Publishing Ratio w/ DS w/ DNSKEY</p>
    <p>ovh.net 315,204 316,960 99.45% loopia.se 1 131,726 0.00% hyp.net 93,946 94,084 99.85%</p>
    <p>transip.net 91,009 91,103 99.90% domainmonster.com 4 60,425 0.01%</p>
    <p>anycast.me 51,403 52,381 98.13% transip.nl 46,971 47,007 99.92% binero.se 17,099 44,650 38.30%</p>
    <p>ns.cloudflare.com 17,483 28,938 60.42% is.nl 11 15,738 0.07%</p>
    <p>pcextreme.nl 14,801 14,967 98.89% webhostingserver.nl 10,655 14,806 71.96%</p>
    <p>registrar-servers.com 11,463 13,115 87.40% ns0.nl 12,674 12,738 99.50%</p>
    <p>citynetwork.se 13 11,660 0.11%</p>
  </div>
  <div class="page">
    <p>Why are DS records missing?</p>
    <p>Nameservers # of domains</p>
    <p>DS Publishing Ratio w/ DS w/ DNSKEY</p>
    <p>ovh.net 315,204 316,960 99.45% loopia.se 1 131,726 0.00% hyp.net 93,946 94,084 99.85%</p>
    <p>transip.net 91,009 91,103 99.90% domainmonster.com 4 60,425 0.01%</p>
    <p>anycast.me 51,403 52,381 98.13% transip.nl 46,971 47,007 99.92% binero.se 17,099 44,650 38.30%</p>
    <p>ns.cloudflare.com 17,483 28,938 60.42% is.nl 11 15,738 0.07%</p>
    <p>pcextreme.nl 14,801 14,967 98.89% webhostingserver.nl 10,655 14,806 71.96%</p>
    <p>registrar-servers.com 11,463 13,115 87.40% ns0.nl 12,674 12,738 99.50%</p>
    <p>citynetwork.se 13 11,660 0.11%</p>
  </div>
  <div class="page">
    <p>Why are DS records missing?</p>
    <p>Nameservers # of domains</p>
    <p>DS Publishing Ratio w/ DS w/ DNSKEY</p>
    <p>ovh.net 315,204 316,960 99.45% loopia.se 1 131,726 0.00% hyp.net 93,946 94,084 99.85%</p>
    <p>transip.net 91,009 91,103 99.90% domainmonster.com 4 60,425 0.01%</p>
    <p>anycast.me 51,403 52,381 98.13% transip.nl 46,971 47,007 99.92% binero.se 17,099 44,650 38.30%</p>
    <p>ns.cloudflare.com 17,483 28,938 60.42% is.nl 11 15,738 0.07%</p>
    <p>pcextreme.nl 14,801 14,967 98.89% webhostingserver.nl 10,655 14,806 71.96%</p>
    <p>registrar-servers.com 11,463 13,115 87.40% ns0.nl 12,674 12,738 99.50%</p>
    <p>citynetwork.se 13 11,660 0.11%</p>
    <p>Most people do not understand DNS, so imagine the white faces when I mention DNSSEC ... I dont think DNSSEC has a high priority anymore currently in our organization or our customer</p>
    <p>base.</p>
  </div>
  <div class="page">
    <p>Summary of DNSSEC Deployment</p>
    <p>DNSSEC deployment is still rare, but increasing  The major reason of broken DNSSEC is due to the missing DS</p>
    <p>record  Missing RRSIG record: ~ 0.3%  Incorrect RRSIG record: ~ 0.3 %  Incorrect DS record: ~ 0.2%  Missing DS Record: ~ 30%</p>
    <p>Most of the DNSSEC-support softwares (BIND, Windows Server 2012, PowerDNS, OpenDNSSEC) manage the keys automatically. Regardless, the process to upload DS record is totally dependent on the administrator!</p>
  </div>
  <div class="page">
    <p>Outline</p>
    <p>How DNSSEC deployed</p>
    <p>How DNSSEC managed</p>
    <p>How resolver use DNSSEC</p>
    <p>Authoritative Server Resolver</p>
  </div>
  <div class="page">
    <p>Good Steps to Deploy DNSSEC</p>
    <p>Strong Key (1) Have a cryptographically strong key</p>
    <p>No Reuse (2) Dont reuse across multiple domains</p>
    <p>Regular Rollover (3) Replace on a regular basis</p>
  </div>
  <div class="page">
    <p>Strong Key</p>
    <p>No Reuse</p>
    <p>Regular Rollover</p>
    <p>(1) Have a cryptographically strong key</p>
    <p>(2) Dont reuse across multiple domains</p>
    <p>(3) Replace on a regular basis</p>
    <p>Good Steps to Deploy DNSSEC</p>
  </div>
  <div class="page">
    <p>Key Strength</p>
    <p>KSKs</p>
    <p>ZSKs</p>
    <p>P e</p>
    <p>rc e</p>
    <p>n t</p>
    <p>o f</p>
    <p>d o</p>
    <p>m a</p>
    <p>in s</p>
    <p>w it</p>
    <p>h w</p>
    <p>e a</p>
    <p>k k</p>
    <p>e y</p>
    <p>s .com .net .org</p>
    <p>ZSK</p>
    <p>KSK</p>
    <p>Weak Keys</p>
    <p>Strong Key</p>
    <p>No Reuse</p>
    <p>Regular Rollover</p>
  </div>
  <div class="page">
    <p>KSK</p>
    <p>.com</p>
    <p>.net</p>
    <p>.org</p>
    <p>ZSK</p>
    <p>C D</p>
    <p>F</p>
    <p>Number of Domains Grouped Together</p>
    <p>.com</p>
    <p>.net</p>
    <p>.org</p>
    <p>ZSK</p>
    <p>KSK</p>
    <p>Key Reuse</p>
    <p>DNSKEY Sharing</p>
    <p>Some keys are reused extensively (among 106,640 domains)</p>
    <p>~0.1%</p>
    <p>Strong Key</p>
    <p>No Reuse</p>
    <p>Regular Rollover</p>
  </div>
  <div class="page">
    <p>Outline</p>
    <p>How DNSSEC deployed</p>
    <p>How DNSSEC managed</p>
    <p>How resolver use DNSSEC</p>
    <p>Authoritative Server Resolver</p>
  </div>
  <div class="page">
    <p>Correct Deployment for Resolvers</p>
    <p>DO Bit (1) DNSSEC OK bit in the header</p>
    <p>Validation (2) Validate DNSSEC Records</p>
  </div>
  <div class="page">
    <p>Measuring DNS resolver</p>
    <p>Comcast Network</p>
    <p>DNS Resolver</p>
    <p>Authoritative DNS Server</p>
    <p>Measurement Node</p>
    <p>Client</p>
    <p>Ads</p>
    <p>No Control over the node Not Reproducible</p>
  </div>
  <div class="page">
    <p>Luminati</p>
    <p>Measurement Node</p>
    <p>Local DNS Resolver</p>
    <p>Proxy</p>
    <p>Comcast</p>
    <p>Residential Authoritative DNS Server</p>
    <p>AT&amp;T</p>
    <p>Rogers</p>
    <p>Deutsche Telekom</p>
    <p>Verizon</p>
    <p>Control over the node Reproducible</p>
    <p>Scales</p>
    <p>Node</p>
  </div>
  <div class="page">
    <p>Luminati</p>
    <p>Local DNS Resolver</p>
    <p>Authoritative DNS Server</p>
    <p>Node Measurement</p>
    <p>Node Comcast</p>
    <p>Residential</p>
    <p>Control over the node Reproducible</p>
    <p>Scales</p>
  </div>
  <div class="page">
    <p>Methodology</p>
    <p>Local DNS Resolver</p>
    <p>Authoritative DNS Server</p>
    <p>(Our testbed)</p>
    <p>A records</p>
    <p>w/ DO bit</p>
    <p>RRSIG</p>
    <p>A records</p>
    <p>+ 8 other scenarios of incorrect DNSSEC records</p>
  </div>
  <div class="page">
    <p>Resolvers w/ DO Bit</p>
    <p>DO Bit</p>
    <p>Validation</p>
    <p>- 4,427 resolvers - 83% of them are DO-bit enabled</p>
  </div>
  <div class="page">
    <p>Resolvers w/ DO Bit</p>
    <p>DO Bit</p>
    <p>Validation</p>
    <p>- 3,635 (82%) fail to validate DNSSEC records</p>
    <p>- 543 (12.2%) correctly validate DNSSEC records</p>
    <p>Time Warner Cable Internet Rogers Cable Communications</p>
    <p>Comcast Google</p>
    <p>- 4,427 resolvers - 83% of them are DO-bit enabled</p>
  </div>
  <div class="page">
    <p>Open Resolver Tests</p>
    <p>Provide DO Bit Requested Validated? DS DNSKEY</p>
    <p>Verisign YES YES YES YES Google YES YES YES YES DNSWatch YES YES YES YES DNS Advantage YES YES YES YES Norton ConnectSafe YES YES YES YES Level3 YES NO NO NO Comodo Secure DNS YES NO NO NO SafeDNS YES NO NO NO Dyn YES NO NO NO GreenTeamDNS* YES/NO YES YES NO OpenDNS NO NO NO NO OpenNIC NO NO NO NO FreeDNS NO NO NO NO Alternate DNS NO NO NO NO Yandex DNS NO NO NO NO</p>
  </div>
  <div class="page">
    <p>Conclusion</p>
    <p>Presented a longitudinal, end-to-end study of DNSSEC ecosystem</p>
    <p>DNSSEC deployment from server-side is rare but growing  But, 33% of them are mis-configured  DNSKEYs are not managed well</p>
    <p>Weak  Some are shared  Rarely updated</p>
    <p>DNSSEC deployment from client-side is also rare  Only 12% of resolvers validate responses</p>
    <p>Datasets and source code will be available.  http://securepki.org</p>
  </div>
  <div class="page">
    <p>Recommendations</p>
    <p>Use CDS (Child DS) / CDNSKEY (Child DNSKEY)  Automates DNSSEC delegation trust maintenance</p>
    <p>Modern resolvers (e.g., BIND &gt;= 9.5 ) set DO bit by default, but make sure that it actually validates.</p>
    <p>Financial incentives for registrars to deploy DNSSEC would work  .se and .nl ccTLD  Please read our upcoming paper Understanding the Role of</p>
    <p>Registrars in DNSSEC Deployment [IMC17]</p>
  </div>
  <div class="page">
    <p>Conclusion</p>
    <p>Presented a longitudinal, end-to-end study of DNSSEC ecosystem</p>
    <p>DNSSEC deployment from server-side is rare but growing  But, 33% of them are mis-configured  DNSKEYs are not managed well</p>
    <p>Weak  Some are shared  Rarely updated</p>
    <p>DNSSEC deployment from client-side is also rare  Only 12% of resolvers validate responses</p>
    <p>Datasets and source code will be available.  http://securepki.org</p>
  </div>
  <div class="page">
    <p>Questions?</p>
  </div>
  <div class="page">
    <p>Why DNSSEC Deployment is so Low?</p>
    <p>Understanding the Role of Registrars in DNSSEC Deployment [IMC17]</p>
  </div>
  <div class="page">
    <p>Ethical Consideration</p>
    <p>Subject Considration</p>
    <p>Luminati Paid for access</p>
    <p>Not violate ToS</p>
    <p>Exit Nodes</p>
    <p>Not expose PII</p>
    <p>Connects only our testbed</p>
    <p>Download Empty Page</p>
  </div>
  <div class="page">
    <p>Scenario and Intuition</p>
    <p>subdomains description requires DS requires DNSKEY</p>
    <p>missing-rrsig-a no signature for A record 0 0</p>
    <p>invalid-rrsig-a invalid signature for A record 0 1</p>
    <p>future-rrsig-a signature is not yet valid 0 0</p>
    <p>past-rrsig-a signature is expired 0 0</p>
    <p>missing-zsk ZSK used to sign A record is not in DNSKEY 0 1</p>
    <p>missing-ksk KSK used to sign DNSKEY record is not in DNSKEY 0 1</p>
    <p>missing-rrsig-ksk no signature for DNSKEY record 0 1</p>
    <p>invalid-rrsig-ksk invalid signature for DNSKEY record 0 1</p>
    <p>mismatch-ds DS record at parent zone is not accord with KSK 1 1</p>
  </div>
  <div class="page">
    <p>Structure of Domain Name</p>
    <p>Registry: organizations that manage top-level domains (TLDs). They maintain the TLD zone file (the list of all registered names), and work with registrars to sell domain names to the public.  Verisign</p>
    <p>Registrar: organizations that are accredited by ICANN3 and certified by registries to sell domains to the public. They have direct access to the registry.  GoDaddy</p>
    <p>Reseller: organizations that sell domain names, but are either not accredited (by ICANN) or certified (by a given TLDs registry). Typically, resellers partner with registrars in order to sell domain names, and relay all information through the registrar.</p>
  </div>
  <div class="page">
    <p>DS record uploads</p>
  </div>
  <div class="page">
    <p>Key Sharing</p>
    <p>Nameservers KSK ZSK Keys Domains Keys Domains</p>
    <p>Others 151,733 152,144 ovh.net. 316,888 316,887</p>
    <p>loopia.se. 133,258 133,258 hyp.net. 94,888 94,885</p>
    <p>transip.net. 93,819 93,818 domainmonster.com. 60,984 60,984</p>
    <p>anycast.me. 55,936 55,936 transip.nl. 45,676 45,675 binero.se. 44,963 44,963</p>
    <p>ns.cloudflare.com. 28,469 28,469 is.nl. 12,837 12,836</p>
    <p>pcextreme.nl. 15,210 15,210 webhostingserver.nl. 15,023 15,023 registrar-servers.com. 13,183 13,181</p>
    <p>ns0.nl. 11,945 11,945 citynetwork.se. 11,702 11,702</p>
  </div>
  <div class="page">
    <p>Key Sharing</p>
    <p>Nameservers KSK ZSK Keys Domains Keys Domains</p>
    <p>Others 157,533 151,733 188,482 152,144 ovh.net. 318,036 316,888 326,011 316,887</p>
    <p>loopia.se. 199 133,258 217 133,258 hyp.net. 119,150 94,888 119,161 94,885</p>
    <p>transip.net. 93,774 93,819 187,129 93,818 domainmonster.com. 60,991 60,984 121,939 60,984</p>
    <p>anycast.me. 56,075 55,936 58,296 55,936 transip.nl. 45,648 45,676 91,161 45,675 binero.se. 49 44,963 54 44,963</p>
    <p>ns.cloudflare.com. 239 28,469 214 28,469 is.nl. 12,834 12,837 25,512 12,836</p>
    <p>pcextreme.nl. 15,192 15,210 28,654 15,210 webhostingserver.nl. 15,019 15,023 22,741 15,023 registrar-servers.com. 13,043 13,183 12,998 13,181</p>
    <p>ns0.nl. 11,978 11,945 23,790 11,945 citynetwork.se. 21 11,702 28 11,702</p>
  </div>
  <div class="page">
    <p>Rollover Abrupt Changes</p>
    <p>ZSK</p>
    <p>RRSIG</p>
    <p>t0</p>
    <p>RRSIG</p>
    <p>ZSK</p>
    <p>t0 + 1200</p>
    <p>ZSK</p>
    <p>TTL = 3600</p>
    <p>RRSIG</p>
    <p>ZSK</p>
    <p>t0 + 1800</p>
    <p>IP Address?</p>
    <p>RRSIG</p>
    <p>A Record</p>
    <p>Cant verify the signature!</p>
  </div>
  <div class="page">
    <p>Rollover Process (ZSK) &lt;Pre-publish&gt;</p>
    <p>ZSK</p>
    <p>RRSIG</p>
    <p>t0</p>
    <p>ZSK</p>
    <p>RRSIG</p>
    <p>ZSK</p>
    <p>t2</p>
    <p>RRSIG</p>
    <p>ZSK</p>
    <p>t3</p>
    <p>Introducing a new key</p>
    <p>Retiring a signature</p>
    <p>Retiring the previous key</p>
    <p>t1</p>
    <p>ZSK</p>
    <p>RRSIG</p>
    <p>ZSK</p>
  </div>
  <div class="page">
    <p>Rollover Process (ZSK) &lt;Double-signature&gt;</p>
    <p>RRSIG</p>
    <p>ZSK</p>
    <p>t0</p>
    <p>RRSIG</p>
    <p>ZSK</p>
    <p>t2</p>
    <p>Introducing a new key and signature</p>
    <p>Retiring the previous key and signature</p>
    <p>RRSIG</p>
    <p>ZSK</p>
    <p>t1</p>
    <p>ZSK</p>
    <p>RRSIG</p>
  </div>
  <div class="page">
    <p>Rollover Process (KSK) &lt;Double-signature&gt;</p>
    <p>Parent Zone</p>
    <p>Child Zone</p>
    <p>DS record</p>
    <p>KSK</p>
    <p>RRSIG</p>
    <p>t0</p>
    <p>DS record</p>
    <p>KSK</p>
    <p>RRSIG</p>
    <p>ZSK</p>
    <p>RRSIG</p>
    <p>t1</p>
    <p>DS Record</p>
    <p>KSK</p>
    <p>RRSIG</p>
    <p>ZSK</p>
    <p>RRSIG</p>
    <p>t2</p>
    <p>DS Record</p>
    <p>ZSK</p>
    <p>RRSIG</p>
    <p>t3</p>
  </div>
  <div class="page">
    <p>Rollover Process (KSK) &lt;Double-DS&gt;</p>
    <p>Parent Zone</p>
    <p>Child Zone</p>
    <p>DS record</p>
    <p>KSK</p>
    <p>RRSIG</p>
    <p>t0</p>
    <p>DS Record</p>
    <p>ZSK</p>
    <p>RRSIG</p>
    <p>t3</p>
    <p>DS record</p>
    <p>KSK</p>
    <p>RRSIG</p>
    <p>t1</p>
    <p>DS Record</p>
    <p>ZSK</p>
    <p>RRSIG</p>
    <p>t2</p>
    <p>DS record</p>
    <p>DS Record</p>
  </div>
  <div class="page">
    <p>ZSK Rollovers</p>
    <p>Scheme .com .org</p>
    <p>No ZSK Rollovers 279,935 27,166</p>
    <p>Abrupt 5,527 66</p>
    <p>Double Signatures 58,807 9,615</p>
    <p>Pre-publish 259,327 33,518</p>
  </div>
  <div class="page">
    <p>ZSK Rollovers</p>
    <p>Scheme .com .org</p>
    <p>No ZSK Rollovers 279,935 27,166</p>
    <p>Abrupt 5,527 66</p>
    <p>Double Signatures 58,807 9,615</p>
    <p>Pre-publish 259,327 33,518</p>
    <p>DNSKEY (ZSK)</p>
    <p>Nearly 45% of domains DO NOT switch their DNSKEYs</p>
  </div>
  <div class="page">
    <p>KSK Rollovers</p>
    <p>Scheme .com .net .org</p>
    <p>No KSK Rollovers</p>
    <p>Abrupt 17,724 3,183 1,710</p>
    <p>Double Signatures</p>
  </div>
  <div class="page">
    <p>KSK Rollovers</p>
    <p>Scheme .com .net .org</p>
    <p>No KSK Rollovers</p>
    <p>Abrupt 17,724 3,183 1,710</p>
    <p>Double Signatures</p>
    <p>DNSKEY (KSK)</p>
    <p>Nearly 70% of domains DO NOT switch their DNSKEYs</p>
  </div>
  <div class="page">
    <p>Superfluous Signatures</p>
    <p>example.com</p>
    <p>.com</p>
    <p>zone signing key (ZSK)</p>
    <p>key signing key (KSK)</p>
    <p>A records RRSIG of A</p>
    <p>= Hash of DS Record</p>
    <p>DNSKEYs RRSIG of DNSKEY</p>
    <p>DNSKEYs RRSIG of DNSKEY</p>
    <p>Unnecessary, but not evil!</p>
  </div>
  <div class="page">
    <p>DNSKEY Fragmentation</p>
    <p>C D</p>
    <p>F</p>
    <p>DNSKEY Message Size</p>
    <p>RRSIGs ksk</p>
  </div>
  <div class="page">
    <p>DNSKEY Fragmentation</p>
    <p>C D</p>
    <p>F</p>
    <p>DNSKEY Message Size</p>
    <p>RRSIGsksk RRSIGszsk,ksk</p>
  </div>
  <div class="page">
    <p>DNSKEY Fragmentation</p>
    <p>C D</p>
    <p>F</p>
    <p>DNSKEY Message Size</p>
    <p>RRSIGsksk RRSIGszsk,ksk</p>
    <p>RRSIGszsk,ksk(2,048)</p>
    <p>DNSKEY Fragmentation</p>
    <p>Superfluous signatures increases the chance of fragmentation.</p>
  </div>
  <div class="page">
    <p>Hola Unblocker</p>
    <p>HTTP</p>
    <p>Get netflix.com</p>
  </div>
  <div class="page">
    <p>Hola Luminati</p>
    <p>Luminati user</p>
    <p>example.com</p>
    <p>HTTP Get example.com</p>
    <p>Hola user</p>
  </div>
  <div class="page">
    <p>Measurement Client Exit Node</p>
    <p>Exit Nodes DNS Resolver</p>
    <p>HTTP</p>
    <p>DNS</p>
    <p>DNSSEC response</p>
    <p>Get testbed.com</p>
    <p>DNS &amp; Web server testbed.com</p>
  </div>
  <div class="page">
    <p>We measured 403,355 nodes and their 59,513 resolvers !</p>
  </div>
  <div class="page">
    <p>Get testbed.com</p>
    <p>Measurement Client Super Proxy Exit Node</p>
    <p>Exit Nodes DNS Server</p>
    <p>HTTP</p>
    <p>DNS</p>
    <p>DNS Response</p>
  </div>
</Presentation>
