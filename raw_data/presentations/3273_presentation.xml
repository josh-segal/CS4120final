<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Yixin Sun</p>
    <p>Princeton University</p>
    <p>RAPTOR:</p>
    <p>Routing Attacks on Privacy in Tor</p>
    <p>Joint work with</p>
    <p>Annie Edmundson, Laurent Vanbever,</p>
    <p>Oscar Li, Jennifer Rexford,</p>
    <p>Mung Chiang, Prateek Mittal</p>
    <p>Laurent Vanbever</p>
    <p>ETH Zurich</p>
    <p>Acknowledgment for Slides</p>
  </div>
  <div class="page"/>
  <div class="page">
    <p>NOT</p>
    <p>FOR LONG.</p>
  </div>
  <div class="page">
    <p>COURTESY OF BGP.</p>
    <p>NOT</p>
    <p>FOR LONG.</p>
  </div>
  <div class="page">
    <p>Looking at an Internet communication, one can</p>
    <p>even if the communication is encrypted</p>
    <p>infer who is talking to whom</p>
    <p>infer physical locations</p>
    <p>use that to track behavior and interests</p>
    <p>Internet communications</p>
    <p>are not anonymous</p>
  </div>
  <div class="page">
    <p>Tor aims at preventing adversaries to follow</p>
    <p>packets between a sender and a receiver</p>
    <p>client server</p>
  </div>
  <div class="page">
    <p>To do that,</p>
    <p>Tor bounces traffic around a network of relays</p>
    <p>Tor network</p>
    <p>entry middle exit</p>
    <p>point point</p>
    <p>client server</p>
  </div>
  <div class="page">
    <p>Tor clients start by selecting</p>
    <p>entry middle exitclient server</p>
    <p>Tor network</p>
  </div>
  <div class="page">
    <p>Tor clients then incrementally</p>
    <p>build encrypted circuits through them</p>
    <p>Tor network</p>
    <p>entry middle exitclient server</p>
  </div>
  <div class="page">
    <p>Tor network</p>
    <p>entry middle exitclient server</p>
  </div>
  <div class="page">
    <p>Tor network</p>
    <p>entry middle exitclient server</p>
  </div>
  <div class="page">
    <p>Tor network</p>
    <p>entry middle exitclient server</p>
  </div>
  <div class="page">
    <p>Anonymous communication takes place</p>
    <p>by forwarding across consecutive tunnels</p>
    <p>TCP</p>
    <p>connection</p>
    <p>Tor network</p>
    <p>entry middle exitclient server</p>
  </div>
  <div class="page">
    <p>Not a single Tor entity knows</p>
    <p>the association (client, server)</p>
    <p>Tor network</p>
    <p>entry middle exitclient server</p>
  </div>
  <div class="page">
    <p>knows the source,</p>
    <p>not the destination</p>
    <p>Tor network</p>
    <p>entry middle exitclient server</p>
  </div>
  <div class="page">
    <p>knows neither the source,</p>
    <p>nor the destination</p>
    <p>Tor network</p>
    <p>entry middle exitclient server</p>
  </div>
  <div class="page">
    <p>knows the destination,</p>
    <p>not the source</p>
    <p>Tor network</p>
    <p>entry middle exitclient server</p>
  </div>
  <div class="page">
    <p>Traffic entering and leaving Tor</p>
    <p>is highly correlated</p>
    <p>transmission time transmission time</p>
    <p>highly correlated</p>
    <p>client-to-entry connection exit-to-server connection</p>
    <p>Tor network</p>
  </div>
  <div class="page">
    <p>By correlating client-to-entry &amp; exit-to-server flows,</p>
    <p>one can effectively deanonymize Tor users</p>
  </div>
  <div class="page">
    <p>Traffic correlation attacks require to see</p>
    <p>client-to-entry and exit-to-server traffic</p>
  </div>
  <div class="page">
    <p>How?</p>
    <p>Traffic correlation attacks require to see</p>
    <p>client-to-entry and exit-to-server traffic</p>
  </div>
  <div class="page">
    <p>Manipulate Tor</p>
    <p>malicious relays</p>
    <p>Manipulate routing</p>
    <p>malicious networks</p>
    <p>Two ways</p>
  </div>
  <div class="page">
    <p>This talk</p>
    <p>Manipulate Tor</p>
    <p>malicious relays</p>
    <p>Manipulate routing</p>
    <p>malicious networks</p>
    <p>Two ways</p>
  </div>
  <div class="page">
    <p>client</p>
    <p>server</p>
    <p>AS1</p>
    <p>AS2</p>
    <p>AS5</p>
    <p>AS4</p>
    <p>AS6</p>
    <p>AS3</p>
    <p>entry</p>
    <p>exit</p>
  </div>
  <div class="page">
    <p>AS1</p>
    <p>AS2</p>
    <p>AS5</p>
    <p>AS4</p>
    <p>AS6</p>
    <p>AS3</p>
    <p>Tor connections get routed according to BGP</p>
    <p>exit-to-server</p>
    <p>connection client-to-entry</p>
    <p>connectionclient</p>
    <p>server</p>
    <p>entry</p>
    <p>exit</p>
  </div>
  <div class="page">
    <p>AS1</p>
    <p>AS2</p>
    <p>AS5</p>
    <p>AS4</p>
    <p>AS6</p>
    <p>AS3</p>
    <p>Traffic correlation attacks require to see</p>
    <p>client-to-entry and exit-to-server traffic</p>
    <p>client-to-entry</p>
    <p>connectionclient</p>
    <p>server</p>
    <p>entry</p>
    <p>exit</p>
    <p>exit-to-server</p>
    <p>connection</p>
  </div>
  <div class="page">
    <p>AS1</p>
    <p>AS2 AS4</p>
    <p>AS6</p>
    <p>AS3</p>
    <p>AS5</p>
    <p>can perform</p>
    <p>traffic correlation client</p>
    <p>server</p>
    <p>entry</p>
    <p>exit</p>
  </div>
  <div class="page">
    <p>Network-level adversaries are known</p>
    <p>Edman and Syverson2009 AS-awareness in Tor Path Selection</p>
    <p>Johnson et al.Traffic correlation on Tor</p>
    <p>by realistic adversaries</p>
    <p>Murdoch and ZieliskiSampled traffic analysis by</p>
    <p>Internet-exchange-level adversaries</p>
    <p>Related work</p>
  </div>
  <div class="page">
    <p>However, these works assume</p>
    <p>that the Internet is static</p>
  </div>
  <div class="page">
    <p>which is not the case</p>
    <p>However, these works assume</p>
    <p>that the Internet is static</p>
  </div>
  <div class="page">
    <p>Whats the impact on Tor?Contribution</p>
    <p>However, these works assume</p>
    <p>that the Internet is static</p>
    <p>which is not the case</p>
  </div>
  <div class="page">
    <p>RAPTOR Attacks:</p>
    <p>User anonymity decreases over time</p>
    <p>due to BGP dynamics</p>
  </div>
  <div class="page">
    <p>Natural BGP convergence</p>
    <p>policy changes, failures, etc.</p>
    <p>Asymmetric routing</p>
    <p>path from A to B != from B to A</p>
    <p>Active BGP manipulation</p>
    <p>IP prefix hijack, interception (MITM)</p>
    <p>RAPTOR</p>
    <p>Attacks</p>
    <p>RAPTOR Attacks:</p>
    <p>User anonymity decreases over time</p>
    <p>due to BGP dynamics</p>
  </div>
  <div class="page">
    <p>All your traffic belongs to me</p>
    <p>Attacks1</p>
    <p>Results</p>
    <p>Eyes wide open</p>
    <p>Countermeasures</p>
    <p>Close the curtains</p>
    <p>RAPTOR:</p>
    <p>Routing Attacks on Privacy in Tor</p>
  </div>
  <div class="page">
    <p>All your traffic belongs to me</p>
    <p>Attacks1</p>
    <p>Results</p>
    <p>Eyes wide open</p>
    <p>Countermeasures</p>
    <p>Close the curtains</p>
    <p>RAPTOR:</p>
    <p>Routing Attacks on Privacy in Tor</p>
  </div>
  <div class="page">
    <p>RAPTOR #1.</p>
    <p>Asymmetric routing increases</p>
    <p>the numbers of AS-level adversaries</p>
  </div>
  <div class="page">
    <p>AS1</p>
    <p>AS2</p>
    <p>AS5</p>
    <p>AS4</p>
    <p>AS6</p>
    <p>AS3</p>
    <p>So far, we have considered one side of Tor traffic:</p>
    <p>client-to-entry and exit-to-server</p>
    <p>exit-to-serverclient-to-entry client</p>
    <p>server</p>
    <p>entry</p>
    <p>exit</p>
  </div>
  <div class="page">
    <p>AS1</p>
    <p>AS2</p>
    <p>AS5</p>
    <p>AS4</p>
    <p>AS6</p>
    <p>AS3</p>
    <p>client-to-entry client</p>
    <p>server</p>
    <p>entry</p>
    <p>exit</p>
    <p>However, because of policies,</p>
    <p>routing is often asymmetric</p>
  </div>
  <div class="page">
    <p>AS1</p>
    <p>AS2</p>
    <p>AS5</p>
    <p>AS4</p>
    <p>AS6</p>
    <p>AS3</p>
    <p>entry-to-client</p>
    <p>However, because of policies,</p>
    <p>routing is often asymmetric</p>
    <p>client-to-entry client</p>
    <p>server</p>
    <p>entry</p>
    <p>exit</p>
  </div>
  <div class="page">
    <p>AS1</p>
    <p>AS2</p>
    <p>AS5</p>
    <p>AS4</p>
    <p>AS6</p>
    <p>AS3</p>
    <p>entry-to-client</p>
    <p>While AS4 does not see client-to-entry traffic,</p>
    <p>it sees entry-to-client traffic</p>
    <p>client-to-entry client</p>
    <p>server</p>
    <p>entry</p>
    <p>exit</p>
  </div>
  <div class="page">
    <p>AS1</p>
    <p>AS2</p>
    <p>AS5</p>
    <p>AS4</p>
    <p>AS6</p>
    <p>AS3 server-to-exit</p>
    <p>The same applies</p>
    <p>to server-to-exit traffic</p>
    <p>exit-to-server</p>
    <p>client</p>
    <p>server</p>
    <p>entry</p>
    <p>exit</p>
  </div>
  <div class="page">
    <p>In terms of timing properties,</p>
    <p>both sides of a TCP connection are</p>
    <p>highly correlated</p>
  </div>
  <div class="page">
    <p>seeing one direction</p>
    <p>seeing two directions</p>
    <p>When collecting TCP</p>
    <p>is almost equivalent to</p>
    <p>timing information,</p>
    <p>In terms of timing properties,</p>
    <p>both sides of a TCP connection are</p>
    <p>highly correlated</p>
    <p>(e.g., data packets)</p>
    <p>(ACKs &amp; data packets)</p>
  </div>
  <div class="page">
    <p>Considering only one direction,</p>
    <p>only AS5 is potentially compromising</p>
    <p>AS1</p>
    <p>AS2 AS4</p>
    <p>AS6</p>
    <p>AS3</p>
    <p>AS5</p>
    <p>client</p>
    <p>server</p>
    <p>entry</p>
    <p>exit</p>
  </div>
  <div class="page">
    <p>Considering both directions,</p>
    <p>AS3, AS4 and AS5 are potentially compromising</p>
    <p>AS1</p>
    <p>AS2</p>
    <p>AS6</p>
    <p>AS5</p>
    <p>AS4</p>
    <p>AS3</p>
    <p>client</p>
    <p>server</p>
    <p>entry</p>
    <p>exit</p>
  </div>
  <div class="page">
    <p>RAPTOR #2.</p>
    <p>Natural BGP dynamics increases</p>
    <p>the number of AS-level adversaries</p>
  </div>
  <div class="page">
    <p>Initially, only AS5 is compromising</p>
    <p>AS1</p>
    <p>AS2 AS4</p>
    <p>AS6</p>
    <p>AS3</p>
    <p>AS5</p>
    <p>client</p>
    <p>server</p>
    <p>entry</p>
    <p>exit</p>
  </div>
  <div class="page">
    <p>AS1</p>
    <p>AS2</p>
    <p>AS5</p>
    <p>AS4</p>
    <p>AS6</p>
    <p>AS3</p>
    <p>Assume that the link between AS4 and AS5 fails</p>
    <p>client</p>
    <p>server</p>
    <p>entry</p>
    <p>exit</p>
  </div>
  <div class="page">
    <p>AS1</p>
    <p>AS2</p>
    <p>AS5</p>
    <p>AS4</p>
    <p>AS6</p>
    <p>AS3</p>
    <p>Traffic gets rerouted via AS3</p>
    <p>client</p>
    <p>server</p>
    <p>entry</p>
    <p>exit</p>
  </div>
  <div class="page">
    <p>AS1</p>
    <p>AS2 AS4</p>
    <p>AS6</p>
    <p>Now, both AS3 and AS5 are seeing</p>
    <p>client-to-entry and exit-to-server traffic</p>
    <p>AS5</p>
    <p>AS3</p>
    <p>client</p>
    <p>server</p>
    <p>entry</p>
    <p>exit</p>
  </div>
  <div class="page">
    <p>RAPTOR #3.</p>
    <p>BGP hijacking attacks enable</p>
    <p>on-demand, fine-grained Tor attacks</p>
  </div>
  <div class="page">
    <p>Initially, only AS5 is compromising</p>
    <p>AS1</p>
    <p>AS2 AS4</p>
    <p>AS6</p>
    <p>AS3</p>
    <p>AS5</p>
    <p>client</p>
    <p>server</p>
    <p>entry</p>
    <p>exit</p>
  </div>
  <div class="page">
    <p>AS1</p>
    <p>AS2</p>
    <p>AS5</p>
    <p>AS4</p>
    <p>AS6</p>
    <p>AS3</p>
    <p>Assume that AS3 is a malicious AS,</p>
    <p>and wants to observe Tor traffic</p>
    <p>client</p>
    <p>server</p>
    <p>entry</p>
    <p>exit</p>
  </div>
  <div class="page">
    <p>AS1</p>
    <p>AS2</p>
    <p>AS5</p>
    <p>AS4</p>
    <p>AS6</p>
    <p>AS3</p>
    <p>AS3 can put itself on server-to-exit paths</p>
    <p>by hijacking Tor prefixes</p>
    <p>Path: 6</p>
    <p>client</p>
    <p>server</p>
    <p>entry</p>
    <p>exit</p>
  </div>
  <div class="page">
    <p>AS1</p>
    <p>AS2</p>
    <p>AS5</p>
    <p>AS4</p>
    <p>AS6</p>
    <p>AS3</p>
    <p>AS3 can put itself on server-to-exit paths</p>
    <p>by hijacking Tor prefixes</p>
    <p>Path: 6</p>
    <p>client</p>
    <p>server</p>
    <p>entry</p>
    <p>exit</p>
  </div>
  <div class="page">
    <p>AS1</p>
    <p>AS2</p>
    <p>AS5</p>
    <p>AS4</p>
    <p>AS6</p>
    <p>AS3</p>
    <p>client</p>
    <p>server</p>
    <p>entry</p>
    <p>exit</p>
  </div>
  <div class="page">
    <p>In April 2014,</p>
    <p>Indosat leaked &gt;320k BGP routes over 2 hours</p>
    <p>Indosat</p>
    <p>Affected 44 Tor Relays</p>
    <p>One of Indonesias largest telecommunications providers</p>
    <p>Include 38 guard and 17 exit</p>
  </div>
  <div class="page">
    <p>All your traffic belongs to me</p>
    <p>Attacks</p>
    <p>Results</p>
    <p>Eyes wide open</p>
    <p>Countermeasures</p>
    <p>Close the curtains</p>
    <p>RAPTOR:</p>
    <p>Routing Attacks on Privacy in Tor</p>
  </div>
  <div class="page">
    <p>RAPTOR #1.</p>
    <p>Asymmetric traffic analysis is highly efficient</p>
  </div>
  <div class="page">
    <p>clients HTTP servers</p>
    <p>We collected traces by downloading</p>
    <p>collection points</p>
    <p>nodes</p>
    <p>Tor network</p>
    <p>entry middle exit 50 PlanetLab</p>
    <p>nodes</p>
  </div>
  <div class="page">
    <p>detection rate</p>
    <p>false negative</p>
    <p>client data &amp;</p>
    <p>server ACK</p>
    <p>client data &amp;</p>
    <p>server data</p>
    <p>After 5 min, we were able to deanonymize ~95% of</p>
    <p>the pairswith no false positives</p>
    <p>client ACK &amp;</p>
    <p>server ACK</p>
    <p>client ACK &amp;</p>
    <p>server data</p>
  </div>
  <div class="page">
    <p>Accuracy</p>
    <p>Rate</p>
    <p>Time (s)</p>
    <p>Detection accuracy quickly increases with time,</p>
    <p>reaching 80% within only a minute</p>
  </div>
  <div class="page">
    <p>!</p>
    <p>Accuracy</p>
    <p>Rate</p>
    <p>Time (s)</p>
    <p>Detection accuracy quickly increases with time,</p>
    <p>reaching 80% within only a minute</p>
  </div>
  <div class="page">
    <p>RAPTOR #2.</p>
    <p>Churn significantly increases the number</p>
    <p>ASesof compromising ASes</p>
  </div>
  <div class="page">
    <p>We measured the effect of churn</p>
    <p>by collecting BGP updates for 1 month (Jan 15)</p>
    <p>(6 RIPE RIS collectors)</p>
    <p># BGP sessions</p>
    <p># BGP prefixes</p>
    <p># BGP updates</p>
    <p>announcements/withdraws</p>
  </div>
  <div class="page">
    <p>!</p>
    <p>!</p>
    <p>sources</p>
    <p>(BGP sessions)</p>
    <p>destinations</p>
    <p>(BGP sessions)</p>
    <p>We considered each BGP session</p>
    <p>as a Tor user or destination</p>
  </div>
  <div class="page">
    <p>!</p>
    <p>!</p>
    <p>sources</p>
    <p>(BGP sessions)</p>
    <p>destinations</p>
    <p>(BGP sessions)</p>
    <p>On each session, we computed the ASes</p>
    <p>used to reach each entry and exit relays</p>
  </div>
  <div class="page">
    <p>!</p>
    <p>!</p>
    <p>!</p>
    <p>!</p>
    <p>sources</p>
    <p>(BGP sessions)</p>
    <p>entry</p>
    <p>relays</p>
    <p>exit</p>
    <p>relays</p>
    <p>destinations</p>
    <p>(BGP sessions)</p>
  </div>
  <div class="page">
    <p>!</p>
    <p>!</p>
    <p>!</p>
    <p>!</p>
    <p>sources</p>
    <p>(BGP sessions)</p>
    <p>entry</p>
    <p>relays</p>
    <p>exit</p>
    <p>relays</p>
    <p>destinations</p>
    <p>(BGP sessions)</p>
  </div>
  <div class="page">
    <p>!</p>
    <p>!</p>
    <p>!</p>
    <p>!</p>
    <p>sources</p>
    <p>(BGP sessions)</p>
    <p>exit</p>
    <p>relays</p>
    <p>destinations</p>
    <p>(BGP sessions)</p>
    <p>on-path AS</p>
    <p>entry</p>
    <p>relays</p>
  </div>
  <div class="page">
    <p>!</p>
    <p>!</p>
    <p>!</p>
    <p>!</p>
    <p>sources</p>
    <p>(BGP sessions)</p>
    <p>exit</p>
    <p>relays</p>
    <p>destinations</p>
    <p>(BGP sessions)</p>
    <p>An AS is compromising when it ends up simultaneously</p>
    <p>on a (src, entry) and (exit, dest) path</p>
    <p>entry</p>
    <p>relays</p>
  </div>
  <div class="page">
    <p>!</p>
    <p>!</p>
    <p>!</p>
    <p>!</p>
    <p>sources</p>
    <p>(BGP sessions)</p>
    <p>entry</p>
    <p>relays</p>
    <p>exit</p>
    <p>relays</p>
    <p>destinations</p>
    <p>(BGP sessions)</p>
    <p>ASX is compromising for the TOR circuit</p>
    <p>(g1, e2) and (s1,s2)</p>
  </div>
  <div class="page">
    <p>How many more ASes are compromising,</p>
    <p>and for how many TOR circuits?</p>
    <p>When considering churn</p>
  </div>
  <div class="page">
    <p># of compromised circuits when considering churn/without</p>
    <p>!</p>
  </div>
  <div class="page">
    <p>!</p>
    <p>CCDF</p>
    <p>of compromised circuits</p>
    <p># of compromised circuits when considering churn/without</p>
  </div>
  <div class="page">
    <p>!</p>
    <p>CCDF</p>
    <p>of more than 50%!</p>
    <p>&gt;50% increase</p>
    <p># of compromised circuits when considering churn/without</p>
  </div>
  <div class="page">
    <p>RAPTOR #3.</p>
    <p>BGP hijack works in the wild</p>
  </div>
  <div class="page">
    <p>We successfully performed a BGP attack</p>
    <p>on an existing Tor entry relay</p>
  </div>
  <div class="page">
    <p>Our experiments did not compromise</p>
    <p>the privacy or safety of real Tor users</p>
    <p>We attacked our own relay</p>
    <p>hijacking our own IP prefix</p>
    <p>We attacked our own traffic</p>
    <p>not actual user-generated Tor traffic</p>
    <p>We firewalled our relay</p>
    <p>dropping any traffic not generated by us</p>
  </div>
  <div class="page">
    <p>entry</p>
    <p>Princeton</p>
    <p>GATECH</p>
    <p>ISI</p>
    <p>We hosted an entry relay in Princeton</p>
  </div>
  <div class="page">
    <p>Princeton</p>
    <p>GATECH</p>
    <p>ISI</p>
    <p>We advertised the covering</p>
    <p>IP prefix via GATECH</p>
    <p>entry</p>
  </div>
  <div class="page">
    <p>Princeton</p>
    <p>GATECH</p>
    <p>ISI</p>
    <p>GATECH relayed on prefix</p>
    <p>to the entire Internet</p>
    <p>entry</p>
  </div>
  <div class="page">
    <p>Princeton</p>
    <p>GATECH</p>
    <p>ISI</p>
    <p>TOR traffic</p>
    <p>client</p>
    <p>Tor traffic started to flow</p>
    <p>entry</p>
  </div>
  <div class="page">
    <p>Princeton</p>
    <p>GATECH</p>
    <p>ISI</p>
    <p>After 20 sec, we announced</p>
    <p>a more-specific prefix via ISI</p>
    <p>client184.164.244.0/23</p>
    <p>entry</p>
    <p>TOR traffic</p>
  </div>
  <div class="page">
    <p>Princeton</p>
    <p>GATECH</p>
    <p>ISI 184.164.244.0/24</p>
    <p>After 20 sec, we announced</p>
    <p>a more-specific prefix via ISI</p>
    <p>client184.164.244.0/23</p>
    <p>entry</p>
    <p>TOR traffic</p>
  </div>
  <div class="page">
    <p>Princeton</p>
    <p>GATECH</p>
    <p>ISI</p>
    <p>TOR traffic</p>
    <p>As forwarding is based on the longest-match,</p>
    <p>all traffic soon started to enter via ISI</p>
    <p>client184.164.244.0/23</p>
    <p>entry</p>
  </div>
  <div class="page">
    <p>Traffic to</p>
    <p>entry relay</p>
    <p>Time (s)</p>
    <p>Gatech</p>
    <p>(legitimate)</p>
    <p>ISI</p>
    <p>(attacker)</p>
  </div>
  <div class="page">
    <p>Gatech</p>
    <p>(legitimate)</p>
    <p>ISI</p>
    <p>(attacker)</p>
    <p>Traffic to</p>
    <p>entry relay</p>
    <p>Time (s)</p>
  </div>
  <div class="page">
    <p>hijack</p>
    <p>begins</p>
    <p>Gatech</p>
    <p>(legitimate)</p>
    <p>ISI</p>
    <p>(attacker)</p>
    <p>Traffic to</p>
    <p>entry relay</p>
    <p>Time (s)</p>
  </div>
  <div class="page">
    <p>hijack</p>
    <p>ends</p>
    <p>Time (s)</p>
    <p>Traffic to</p>
    <p>entry relay</p>
    <p>Gatech</p>
    <p>(legitimate)</p>
    <p>ISI</p>
    <p>(attacker)</p>
  </div>
  <div class="page">
    <p>By correlating TCP ACK traffic collected at ISI</p>
    <p>with TCP ACK traffic collected at the HTTP servers,</p>
    <p>we were able to deanonymize 90% of the pairs</p>
  </div>
  <div class="page">
    <p>client</p>
    <p>server</p>
    <p>Time (s)</p>
    <p>D a</p>
    <p>ta (</p>
    <p>M B</p>
    <p>)</p>
    <p>Client ACK v.s. Server ACK analysis: an uncorrelated pair</p>
  </div>
  <div class="page">
    <p>client</p>
    <p>server</p>
    <p>Time (s)</p>
    <p>D a</p>
    <p>ta (</p>
    <p>M B</p>
    <p>)</p>
    <p>Client ACK v.s. Server ACK analysis: a correlated pair</p>
  </div>
  <div class="page">
    <p>making them vulnerable to more-specific attacks</p>
    <p>announced by only 6 ASes</p>
    <p>Known attacks did already intercept Tor traffic</p>
    <p>e.g., Indosat in 2011 (~5 relays) and 2014 (~44 relays)</p>
    <p>BGP interception attacks are concerning</p>
  </div>
  <div class="page">
    <p>All your traffic belongs to me</p>
    <p>Attacks</p>
    <p>Results</p>
    <p>Eyes wide open</p>
    <p>Countermeasures</p>
    <p>Close the curtains</p>
    <p>RAPTOR:</p>
    <p>Routing Attacks on Privacy in Tor</p>
  </div>
  <div class="page">
    <p>To protect itself, Tor should become</p>
    <p>more aware of the network underlying it</p>
    <p>Natural dynamism</p>
    <p>Route manipulation</p>
    <p>Asymmetric analysis</p>
    <p>Countermeasures Tools</p>
  </div>
  <div class="page">
    <p>Natural dynamism</p>
    <p>Route manipulation</p>
    <p>Asymmetric analysis</p>
    <p>prefer stable relays BGP monitoring</p>
    <p>Countermeasures Tools</p>
  </div>
  <div class="page">
    <p>Natural dynamism</p>
    <p>Route manipulation</p>
    <p>Asymmetric analysis</p>
    <p>discard suspicious relays</p>
    <p>prefer close relays</p>
    <p>BGP monitoring +</p>
    <p>BGPsec</p>
    <p>Countermeasures Tools</p>
  </div>
  <div class="page">
    <p>Natural dynamism</p>
    <p>Asymmetric analysis encrypt transport header IPsec</p>
    <p>Countermeasures Tools</p>
    <p>Route manipulation</p>
  </div>
  <div class="page">
    <p>prefer stable relays</p>
    <p>discard suspicious relays</p>
    <p>prefer close relays</p>
    <p>encrypt transport header</p>
    <p>These countermeasures help,</p>
    <p>but come with tradeoffs</p>
    <p>Natural dynamism</p>
    <p>Route manipulation</p>
    <p>Asymmetric analysis</p>
    <p>Countermeasures</p>
  </div>
  <div class="page">
    <p>prefer stable relays</p>
    <p>discard suspicious relays</p>
    <p>prefer close relays</p>
    <p>encrypt transport header</p>
    <p>more power to</p>
    <p>Tradeoffs</p>
    <p>not widely used</p>
    <p>fewer relays</p>
    <p>These countermeasures help,</p>
    <p>but come with tradeoffs</p>
    <p>(easier to detect)</p>
    <p>Natural dynamism</p>
    <p>Route manipulation</p>
    <p>Asymmetric analysis</p>
    <p>Countermeasures</p>
  </div>
  <div class="page">
    <p>All your traffic belongs to me</p>
    <p>Attacks</p>
    <p>Results</p>
    <p>Eyes wide open</p>
    <p>Countermeasures</p>
    <p>Close the curtains</p>
    <p>RAPTOR:</p>
    <p>Routing Attacks on Privacy in Tor</p>
  </div>
  <div class="page">
    <p>BGP is not only a problem for Tor</p>
  </div>
  <div class="page"/>
  <div class="page">
    <p>A bitcoin thief redirected a portion of online</p>
    <p>traffic from no less than 19 Internet service</p>
    <p>providers, including data from the networks of</p>
    <p>Amazon and other hosting services like</p>
    <p>DigitalOcean and OVH, with the goal of stealing</p>
    <p>cryptocurrency from a group of bitcoin users</p>
  </div>
  <div class="page">
    <p>A bitcoin thief redirected a portion of online</p>
    <p>traffic from no less than 19 Internet service</p>
    <p>providers, including data from the networks of</p>
    <p>Amazon and other hosting services like</p>
    <p>DigitalOcean and OVH, with the goal of stealing</p>
    <p>cryptocurrency from a group of bitcoin users</p>
  </div>
  <div class="page">
    <p>OVH is the top AS in terms of # Tor relays hosted</p>
    <p>A bitcoin thief redirected a portion of online</p>
    <p>traffic from no less than 19 Internet service</p>
    <p>providers, including data from the networks of</p>
    <p>Amazon and other hosting services like</p>
    <p>DigitalOcean and OVH, with the goal of stealing</p>
    <p>cryptocurrency from a group of bitcoin users</p>
  </div>
  <div class="page">
    <p>Countermeasures helpto an extent</p>
    <p>we need a better understanding of their impacts</p>
    <p>Internet routing matters</p>
    <p>when it comes to user anonymity</p>
    <p>The threat is real. Attacks are efficient</p>
    <p>validated in the field, on the live Tor network</p>
    <p>BGP dynamics decreases user anonymity over time</p>
    <p>natural &amp; induced, exacerbated by asymmetric routing</p>
  </div>
  <div class="page">
    <p>Yixin Sun</p>
    <p>Princeton University</p>
    <p>RAPTOR:</p>
    <p>Routing Attacks on Privacy in Tor</p>
    <p>Joint work with</p>
    <p>Annie Edmundson, Laurent Vanbever,</p>
    <p>Oscar Li, Jennifer Rexford,</p>
    <p>Mung Chiang, Prateek Mittal</p>
    <p>Laurent Vanbever</p>
    <p>ETH Zurich</p>
    <p>Acknowledgment for Slides</p>
    <p>http://raptor.princeton.edu/</p>
  </div>
</Presentation>
