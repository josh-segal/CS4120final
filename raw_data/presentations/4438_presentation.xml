<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>http://www.ece.rice.edu/networks</p>
    <p>Chengzhi Li and Edward W. Knightly</p>
    <p>Schedulability Criterion and Performance Analysis of Coordinated Schedulers</p>
  </div>
  <div class="page">
    <p>Background: Priority Scheduling</p>
    <p>Each packet has a priority index  Scheduler selects smallest priority index pkt first  Examples: WFQ, VC, EDF, SCED</p>
    <p>Index assignment scheme  Service discipline</p>
    <p>Arrival</p>
    <p>Index</p>
    <p>L/r</p>
    <p>Arrival</p>
    <p>Index</p>
    <p>FIFO index = arrival_time</p>
    <p>Virtual Clock</p>
    <p>index = max(arrival_time, prev_index) + L/r</p>
  </div>
  <div class="page">
    <p>Earliest Deadline First</p>
    <p>Scheduler services packet with smallest</p>
    <p>deadline = arrival_time + delay_bound</p>
    <p>EDF is optimal for a single server</p>
    <p>Arrival</p>
    <p>Index</p>
  </div>
  <div class="page">
    <p>Multiple Nodes: Sub-Optimality</p>
    <p>Over multiple nodes, EDF is not optimal</p>
    <p>Locally optimal rules do not achieve global optimum (best end-to-end performance)</p>
    <p>Can do better</p>
  </div>
  <div class="page">
    <p>Multiple Nodes: Issue 2, Traffic Distortion</p>
    <p>Traffic can become more bursty downstream  Arrivals previously in now in</p>
    <p>Consequence: difficult to analyze and efficiently support multi-node QoS</p>
    <p>Node j</p>
    <p>Node j+1</p>
    <p>-t t + It</p>
    <p>arrivals</p>
    <p>I] t, - t [  I] t, t [</p>
  </div>
  <div class="page">
    <p>Existing Solutions to Distortion Problem</p>
    <p>Problems  Utilization impact of isolation/non-work-conserving  Scalability issues with per-flow operations</p>
    <p>Node j</p>
    <p>Node j+1</p>
    <p>-t t + It</p>
  </div>
  <div class="page">
    <p>Our Approach: CNS Coordinated Network Scheduling [LiKn00]</p>
    <p>Virtual Coordination among servers  Server computes priority index as a function of</p>
    <p>upstream index  Ex. Downstream index = upstream index + constant  Target at end-to-end service</p>
    <p>Implications  Late packets have increased priority downstream  Early packets have priorities reduced downstream</p>
    <p>CNS is a general framework that includes  FIFO+  Coordinated EDF (CEDF)  Coordinated Jitter Controlled Virtual Clock (CJVC)</p>
  </div>
  <div class="page">
    <p>CNS Definition</p>
    <p>CNS is a work conserving scheduler that selects the packet with the smallest priority index first</p>
    <p>Indexes are given by:</p>
    <p>constants nonegative are , and ],[</p>
    <p>hop j at thepacket k theofindex priority ofincrement the</p>
    <p>hopfirst at thepacket k theofindex priority ofincrement the</p>
    <p>hopfirst at the i flow ofpacket k theof timearrival (virtual) t</p>
    <p>hop j itsat i flow ofpacket k theofindex priority d</p>
    <p>hop j at the  d</p>
    <p>hopfirst at the  t d</p>
    <p>ji,ji,ji,ji,ji,ji, k</p>
    <p>ji,</p>
    <p>ththk ji,</p>
    <p>thk i</p>
    <p>thk i</p>
    <p>ththk ji,</p>
    <p>thk ji,</p>
    <p>k 1-ji,</p>
    <p>k i</p>
    <p>k ik</p>
    <p>ji,</p>
    <p>Recursive Priority Index Assignment</p>
  </div>
  <div class="page">
    <p>Main Contribution</p>
    <p>End-to-end deterministic analysis of CNS</p>
    <p>Characterize downstream priority index distortion vs. traffic pattern distortion using Essential Traffic Envelope</p>
    <p>Exploit coordination property  Allow local (per-node) violations provided e2e satisfied  Devise end-to-end schedulability condition</p>
    <p>Show that CNS outperforms WFQ</p>
    <p>Devise an index assignment scheme  If WFQ can schedule a set of flows, so can CNS</p>
  </div>
  <div class="page">
    <p>Traffic Envelopes</p>
    <p>Envelopes characterize arrivals as a function of interval length  Max and deterministic [Cr92, KWLZ95]  Statistical [QK99]</p>
    <p>Recall: traffic distortion problem</p>
    <p>envelopes distorted</p>
    <p>time</p>
    <p>t + It</p>
    <p>E*( I ) = 3</p>
  </div>
  <div class="page">
    <p>New Concept: Essential Traffic Envelope</p>
    <p>Essential traffic impedes a packets ability to meet a deadline  Ex. with FIFO, its pkts arriving earlier</p>
    <p>Approach: bound traffic with a deadline range vs. an arrival time range (ETE vs. TE)</p>
    <p>Arrival</p>
    <p>Index</p>
    <p>Essential Traffic</p>
    <p>t t</p>
  </div>
  <div class="page">
    <p>Illustration: First Hop (EDF and CNS)</p>
    <p>1st hop: priority indexes are the same in CNS and EDF  Suppose that the third packet is seriously delayed due to cross</p>
    <p>traffic</p>
    <p>Packet Arrival Event</p>
    <p>Packet Departure Event</p>
    <p>Packet Priority Index5</p>
  </div>
  <div class="page">
    <p>Second Hop Without Coordination (EDF)</p>
    <p>At the second hop, the priority indexes depend on the (local/late) arrival times in EDF</p>
    <p>Traffic distortion is large and propagates downstream</p>
    <p>Packet Arrival Event</p>
    <p>Packet Departure Event</p>
    <p>Packet Priority Index5</p>
  </div>
  <div class="page">
    <p>Second Hop With Coordination (CNS) Illustration of Essential Traffic Smoothing</p>
    <p>2nd hop: the priority indexes are independent of the (local/late) arrival times in CNS</p>
    <p>Departures are narrowly distorted (without reshaping)  Theory tightly bounds distortion of essential traffic</p>
    <p>Packet Arrival Event</p>
    <p>Packet Departure Event</p>
    <p>Packet Priority Index5</p>
  </div>
  <div class="page">
    <p>End-to-End Schedulability Condition</p>
    <p>Allow local violations (ex. missed per-node deadlines)  contrast to all previous deterministic work</p>
    <p>Bound Essential Traffic Envelope downstream</p>
    <p>Derive an end-to-end delay bound</p>
    <p>Schedulability Condition for all coordinated schedulers (CEDF, CJVC, GEDF, FIFO+, )</p>
    <p>CEDF, FIFO+,  not previously derived  CJVC bound tighter than previous results</p>
  </div>
  <div class="page">
    <p>Index Assignment</p>
    <p>Coordinated scheduling achieves the same end-to-end delay bound as WFQ</p>
    <p>Recall: indexes can be delay targets or L/r rate assignments</p>
    <p>Result: under CJVC-like rate assignment and leaky bucket constrained flows</p>
    <p>Same WFQ bounds, yet scalable (unlike WFQ and RC-EDF), work conserving (unlike RC-EDF),</p>
    <p>CNS is no worse than WFQ. But can be much better!</p>
  </div>
  <div class="page">
    <p>A Simple Priority Index Assignment</p>
    <p>At Ingress Servers</p>
    <p>At Downstream Servers</p>
    <p>i</p>
    <p>k ik</p>
    <p>i,1 1k</p>
    <p>i,1 k i</p>
    <p>]t[d</p>
    <p>l</p>
    <p>max i</p>
    <p>i</p>
    <p>max ik</p>
    <p>ji, C</p>
    <p>ll</p>
    <p>i</p>
    <p>N</p>
    <p>max</p>
    <p>i</p>
    <p>i</p>
    <p>max</p>
    <p>i i</p>
    <p>i</p>
    <p>i</p>
    <p>C</p>
    <p>l 1)(N</p>
    <p>l</p>
    <p>Coordinated scheduling achieves the same end-to-end delay bound as WFQ</p>
    <p>Also scalable, work conserving</p>
    <p>If flow traffic is</p>
    <p>bounded by ) ,( ii</p>
    <p>i</p>
  </div>
  <div class="page">
    <p>Simulation Study</p>
    <p>Simplified CNS priority index assignment schemes:</p>
    <p>Constant local delay assignment scheme (5 msec and 15 msec respectively)</p>
    <p>Path for target traffic Path for background traffic</p>
    <p>Server 1 Server 2 Server 3 Server 4 Server 5 Server 6</p>
  </div>
  <div class="page">
    <p>CNS vs. EDF (Pareto on-off)</p>
    <p>With 300 flows, reduction in delay form 120 msec to 50 msec</p>
    <p>On rate: 64 kbps Mean of on period: 312 msec Mean of off period: 325 msec Parato shape: 1.9</p>
  </div>
  <div class="page">
    <p>CNS vs. WFQ (Pareto on-off)</p>
    <p>With 300 flows, delay reduced from 170 to 50 msec</p>
    <p>On rate: 64 kbps Mean of on period: 312 msec Mean of off period: 325 msec Pareto shape: 1.9</p>
  </div>
  <div class="page">
    <p>Conclusions</p>
    <p>Proposed a shedulability criterion for CNS</p>
    <p>Derived a general end-to-end delay bound for CNS</p>
    <p>Proved CNS can outperform WFQ and EDF</p>
    <p>http://www.ece.rice.edu/networks</p>
  </div>
  <div class="page">
    <p>Example Recursive Priority Index Assignments (CEDF)</p>
    <p>t+5 t+5+5</p>
    <p>t+5+5+5+5</p>
    <p>t+5+5+5</p>
    <p>target packet t = arriving time of target packet</p>
    <p>at ingress router</p>
    <p>vs. local arrival time + 5</p>
  </div>
  <div class="page">
    <p>A Numerical Example</p>
    <p>CNS can be better!</p>
    <p>CNS WFQ</p>
    <p>D1 = 4L/C D1&lt;=4L/C  r1=C, r2=r3=0</p>
    <p>D2 = 3L/C r2 = 0  D2 &gt;= 4L/C</p>
    <p>D3 = 3L/C r3 = 0  D3 &gt;= 4L/C</p>
    <p>L sizepacket IC0.5L (I)b (I)b (I)b 321</p>
    <p>flow 3</p>
    <p>Server 1 flow 1</p>
    <p>flow 2 Server 2</p>
    <p>C C</p>
    <p>flow 2</p>
    <p>C</p>
    <p>L</p>
    <p>C</p>
    <p>L</p>
    <p>r</p>
    <p>L 1)(2</p>
    <p>r</p>
    <p>L</p>
    <p>(WFQ) bounddelay EndtoEnd</p>
    <p>C</p>
    <p>C 3L</p>
    <p>C 3L</p>
    <p>C L</p>
  </div>
</Presentation>
