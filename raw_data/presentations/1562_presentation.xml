<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Knockoff: Cheap versions in the cloud</p>
    <p>Xianzheng Dou, Peter M. Chen, Jason Flinn</p>
  </div>
  <div class="page">
    <p>Cloud-based storage</p>
    <p>Xianzheng Dou 1</p>
    <p>Google Drive</p>
    <p>Microsoft OneDrive</p>
    <p>Dropbox</p>
    <p>Pros:</p>
    <p>Ease-of-management</p>
    <p>Reliability</p>
  </div>
  <div class="page">
    <p>Cloud-based storage</p>
    <p>Xianzheng Dou 2</p>
    <p>Challenges:</p>
    <p>Storage costs</p>
    <p>Communication costs</p>
    <p>Google Drive</p>
    <p>Microsoft OneDrive</p>
    <p>Dropbox</p>
  </div>
  <div class="page">
    <p>Versioning increases costs</p>
    <p>Xianzheng Dou 3</p>
    <p>Versioning</p>
    <p>Pros:</p>
    <p>Recovery of lost data</p>
    <p>Auditing</p>
    <p>Troubleshooting</p>
    <p>Google Drive</p>
    <p>Microsoft OneDrive</p>
    <p>Dropbox</p>
  </div>
  <div class="page">
    <p>Reducing costs: a new direction</p>
    <p>Established methods exploit similarities in data</p>
    <p>Chunk-based deduplication</p>
    <p>Delta compression</p>
    <p>Greater work for incremental gains</p>
    <p>Our goal: explore an orthogonal new dimension</p>
    <p>Deterministically recompute data in lieu of communication, storage</p>
    <p>Xianzheng Dou 4</p>
  </div>
  <div class="page">
    <p>File: data or computation?</p>
    <p>Xianzheng Dou 5</p>
    <p>Computation File data</p>
  </div>
  <div class="page">
    <p>File: data or computation?</p>
    <p>Xianzheng Dou 5</p>
    <p>Computation File data</p>
  </div>
  <div class="page">
    <p>File: data or computation?</p>
    <p>Xianzheng Dou 6</p>
    <p>Computation File data</p>
  </div>
  <div class="page">
    <p>File: data or computation?</p>
    <p>Xianzheng Dou 6</p>
    <p>Computation File data</p>
  </div>
  <div class="page">
    <p>File: data or computation?</p>
    <p>Xianzheng Dou 6</p>
    <p>Computation File data</p>
  </div>
  <div class="page">
    <p>File: data or computation?</p>
    <p>Xianzheng Dou 6</p>
    <p>Computation File data</p>
  </div>
  <div class="page">
    <p>File: data or computation?</p>
    <p>Xianzheng Dou 6</p>
    <p>How can we address non-determinism?</p>
    <p>Different output dataComputation File data</p>
  </div>
  <div class="page">
    <p>File: data or computation?</p>
    <p>Xianzheng Dou 7</p>
    <p>Deterministic record and replay</p>
    <p>Logs of nondeterminism</p>
    <p>Latency Metric</p>
    <p>Mail</p>
    <p>Request</p>
    <p>debug_peer_list</p>
    <p>mydomain.com queue_directory</p>
    <p>How to use X-ray</p>
    <p>List of root causes:</p>
    <p>Scope</p>
    <p>PLAY RECORD</p>
    <p>Michael Chow 12</p>
    <p>Log Record</p>
  </div>
  <div class="page">
    <p>File: data or computation?</p>
    <p>Xianzheng Dou 7</p>
    <p>Deterministic record and replay</p>
    <p>Logs of nondeterminism</p>
    <p>Latency Metric</p>
    <p>Mail</p>
    <p>Request</p>
    <p>debug_peer_list</p>
    <p>mydomain.com queue_directory</p>
    <p>How to use X-ray</p>
    <p>List of root causes:</p>
    <p>Scope</p>
    <p>PLAY RECORD</p>
    <p>Michael Chow 12</p>
    <p>Log Record</p>
  </div>
  <div class="page">
    <p>File: data or computation?</p>
    <p>Xianzheng Dou 7</p>
    <p>Deterministic record and replay</p>
    <p>Logs of nondeterminism</p>
    <p>Latency Metric</p>
    <p>Mail</p>
    <p>Request</p>
    <p>debug_peer_list</p>
    <p>mydomain.com queue_directory</p>
    <p>How to use X-ray</p>
    <p>List of root causes:</p>
    <p>Scope</p>
    <p>PLAY RECORD</p>
    <p>Michael Chow 12</p>
    <p>Log Record</p>
  </div>
  <div class="page">
    <p>File: data or computation?</p>
    <p>Xianzheng Dou 7</p>
    <p>Deterministic record and replay</p>
    <p>Logs of nondeterminism</p>
    <p>Latency Metric</p>
    <p>Mail</p>
    <p>Request</p>
    <p>debug_peer_list</p>
    <p>mydomain.com queue_directory</p>
    <p>How to use X-ray</p>
    <p>List of root causes:</p>
    <p>Scope</p>
    <p>PLAY RECORD</p>
    <p>Michael Chow 12</p>
    <p>Log Record</p>
    <p>Latency Metric</p>
    <p>Mail</p>
    <p>Request</p>
    <p>debug_peer_list</p>
    <p>mydomain.com queue_directory</p>
    <p>How to use X-ray</p>
    <p>List of root causes:</p>
    <p>Scope</p>
    <p>PLAY RECORD</p>
    <p>Michael Chow 12</p>
    <p>Log Replay</p>
  </div>
  <div class="page">
    <p>Knockoff</p>
    <p>Selectively substitutes computation for data</p>
    <p>Benefits</p>
    <p>Reduction compared to chunk-based deduplication</p>
    <p>Communication costs: 21%</p>
    <p>Storage costs: 19%</p>
    <p>Benefits increases as we retain versions more frequently</p>
    <p>A new fined-grained versioning policy</p>
    <p>Xianzheng Dou 8</p>
  </div>
  <div class="page">
    <p>Outline</p>
    <p>Introduction</p>
    <p>Writing files</p>
    <p>Storing files</p>
    <p>Evaluation</p>
    <p>Xianzheng Dou 9</p>
  </div>
  <div class="page">
    <p>Knockoff</p>
    <p>Xianzheng Dou 10</p>
    <p>Knockoff selectively represents a file as: Normal file data (by value)</p>
    <p>Logs of the nondeterminism needed to recompute the file (by operation)</p>
    <p>File</p>
  </div>
  <div class="page">
    <p>Knockoff</p>
    <p>Xianzheng Dou 10</p>
    <p>Knockoff selectively represents a file as: Normal file data (by value)</p>
    <p>Logs of the nondeterminism needed to recompute the file (by operation)</p>
    <p>File</p>
  </div>
  <div class="page">
    <p>Knockoff</p>
    <p>Xianzheng Dou 10</p>
    <p>Knockoff selectively represents a file as: Normal file data (by value)</p>
    <p>Logs of the nondeterminism needed to recompute the file (by operation)</p>
    <p>OR</p>
    <p>File</p>
  </div>
  <div class="page">
    <p>Knockoff</p>
    <p>Xianzheng Dou 10</p>
    <p>Knockoff selectively represents a file as: Normal file data (by value)</p>
    <p>Logs of the nondeterminism needed to recompute the file (by operation)</p>
    <p>OR</p>
    <p>OR File</p>
  </div>
  <div class="page">
    <p>An example log for compilation</p>
    <p>Xianzheng Dou 11</p>
    <p>Log entry Values</p>
  </div>
  <div class="page">
    <p>An example log for compilation</p>
    <p>Xianzheng Dou 11</p>
    <p>Log entry Values</p>
    <p>Return values from syscalls</p>
    <p>Ordering of thread synchronization</p>
    <p>Signals5 SIGCHILD</p>
  </div>
  <div class="page">
    <p>An example log for compilation</p>
    <p>Xianzheng Dou 11</p>
    <p>Log entry Values</p>
  </div>
  <div class="page">
    <p>An example log for compilation</p>
    <p>Xianzheng Dou 11</p>
    <p>Log entry Values</p>
  </div>
  <div class="page">
    <p>Writing files</p>
    <p>Xianzheng Dou 13</p>
    <p>By value By operation</p>
  </div>
  <div class="page">
    <p>Writing files</p>
    <p>Xianzheng Dou 13</p>
    <p>By value By operation</p>
  </div>
  <div class="page">
    <p>Writing files</p>
    <p>Xianzheng Dou 13</p>
    <p>By value By operation</p>
  </div>
  <div class="page">
    <p>Writing files</p>
    <p>Xianzheng Dou 14</p>
    <p>By value</p>
    <p>By operation photo editing</p>
  </div>
  <div class="page">
    <p>Writing files</p>
    <p>Xianzheng Dou 15</p>
    <p>By value</p>
    <p>By operationcryptographic key generation</p>
  </div>
  <div class="page">
    <p>Outline</p>
    <p>Introduction</p>
    <p>Writing files</p>
    <p>Storing files</p>
    <p>Evaluation</p>
    <p>Xianzheng Dou 17</p>
  </div>
  <div class="page">
    <p>Storing files</p>
    <p>Store files by value or by operation?</p>
    <p>A tradeoff between latency and costs</p>
    <p>Current versions: by value</p>
    <p>Past versions: by value or by operation</p>
    <p>Xianzheng Dou 18</p>
    <p>?</p>
  </div>
  <div class="page">
    <p>Storing past versions</p>
    <p>Xianzheng Dou 19</p>
    <p>Maximum materialization delay</p>
    <p>Time bound for reconstructing any version</p>
    <p>Materialization delay = 60sRegeneration time = 20s &lt;</p>
  </div>
  <div class="page">
    <p>Storing past versions</p>
    <p>Xianzheng Dou 19</p>
    <p>Maximum materialization delay</p>
    <p>Time bound for reconstructing any version</p>
    <p>Materialization delay = 60sRegeneration time = 20s &lt;</p>
  </div>
  <div class="page">
    <p>Storing past versions</p>
    <p>Xianzheng Dou 20</p>
    <p>Maximum materialization delay</p>
    <p>Time bound for reconstructing any version</p>
    <p>Regeneration time = 100s &gt; Materialization delay = 60s</p>
  </div>
  <div class="page">
    <p>Storing past versions</p>
    <p>Xianzheng Dou 20</p>
    <p>Maximum materialization delay</p>
    <p>Time bound for reconstructing any version</p>
    <p>Regeneration time = 100s &gt; Materialization delay = 60s</p>
  </div>
  <div class="page">
    <p>Storing past versions</p>
    <p>Xianzheng Dou 21</p>
    <p>Maximum materialization delay</p>
    <p>Time bound for reconstructing any version</p>
    <p>Longest path &gt; materialization delay</p>
    <p>Materialization delay = 60s20s</p>
    <p>Total regeneration time = 20s</p>
    <p>&lt;</p>
  </div>
  <div class="page">
    <p>Storing past versions</p>
    <p>Xianzheng Dou 22</p>
    <p>Maximum materialization delay</p>
    <p>Time bound for reconstructing any version</p>
    <p>Longest path &gt; materialization delay</p>
    <p>Materialization delay = 60s20s</p>
    <p>Total regeneration time = 50s</p>
    <p>&lt;</p>
  </div>
  <div class="page">
    <p>Storing past versions</p>
    <p>Xianzheng Dou 23</p>
    <p>Maximum materialization delay</p>
    <p>Time bound for reconstructing any version</p>
    <p>Longest path &gt; materialization delay</p>
    <p>Materialization delay = 60s20s</p>
    <p>Total regeneration time = 80s</p>
    <p>&gt;</p>
  </div>
  <div class="page">
    <p>Storing past versions</p>
    <p>Xianzheng Dou 24</p>
    <p>Maximum materialization delay</p>
    <p>Time bound for reconstructing any version</p>
    <p>Longest path &gt; materialization delay</p>
    <p>Total regeneration time = 80s</p>
    <p>Materialization delay = 60s &gt;</p>
  </div>
  <div class="page">
    <p>Storing past versions</p>
    <p>Xianzheng Dou 24</p>
    <p>Maximum materialization delay</p>
    <p>Time bound for reconstructing any version</p>
    <p>Longest path &gt; materialization delay</p>
    <p>Total regeneration time = 80s</p>
    <p>Materialization delay = 60s &gt;</p>
  </div>
  <div class="page">
    <p>Storing past versions</p>
    <p>Xianzheng Dou 25</p>
    <p>Maximum materialization delay</p>
    <p>Time bound for reconstructing any version</p>
    <p>Longest path &gt; materialization delay</p>
    <p>A greedy algorithm</p>
    <p>Materialization delay = 60s</p>
  </div>
  <div class="page">
    <p>Xianzheng Dou 26</p>
    <p>Frequency of versioning</p>
    <p>Storing past versions: versioning policies</p>
  </div>
  <div class="page">
    <p>Xianzheng Dou 26</p>
    <p>Frequency of versioning</p>
    <p>Storing past versions: versioning policies</p>
    <p>No versioning Version on close Version on write Eidetic versioning</p>
  </div>
  <div class="page">
    <p>Xianzheng Dou 26</p>
    <p>Frequency of versioning</p>
    <p>Storing past versions: versioning policies</p>
    <p>Any past transient state in memory?</p>
    <p>No versioning Version on close Version on write</p>
    <p>Memory-mapped files</p>
    <p>Eidetic versioning</p>
  </div>
  <div class="page">
    <p>Optimization: log compression</p>
    <p>Chunk-based deduplication is effective for file data</p>
    <p>Executions of the same application have similar patterns</p>
    <p>Can it also be applied to computation (logs of nondeterminism)?</p>
    <p>Delta compression</p>
    <p>Xianzheng Dou 28</p>
  </div>
  <div class="page">
    <p>Problem: a smattering of values differ in each log</p>
    <p>Optimization: log compression</p>
    <p>Xianzheng Dou 29</p>
  </div>
  <div class="page">
    <p>Problem: a smattering of values differ in each log</p>
    <p>Optimization: log compression</p>
    <p>Xianzheng Dou 29</p>
    <p>Delta compression: 42% reduction</p>
  </div>
  <div class="page">
    <p>Outline</p>
    <p>Introduction</p>
    <p>Writing files</p>
    <p>Storing files</p>
    <p>Evaluation</p>
    <p>Xianzheng Dou 30</p>
  </div>
  <div class="page">
    <p>Evaluation</p>
    <p>How much does Knockoff reduce bandwidth usage?</p>
    <p>How much does Knockoff reduce storage costs?</p>
    <p>What is Knockoffs performance overhead?</p>
    <p>For more experimental results, please refer to our paper</p>
    <p>Xianzheng Dou 31</p>
  </div>
  <div class="page">
    <p>Experimental setup</p>
    <p>User study</p>
    <p>8 participants performed several simple tasks in one hour</p>
    <p>20-day study</p>
    <p>A single-user longitudinal study</p>
    <p>A variety of programs used</p>
    <p>Various Linux utilities, text editors and programming languages</p>
    <p>Xianzheng Dou 32</p>
  </div>
  <div class="page">
    <p>Bandwidth usage: user study</p>
    <p>Xianzheng Dou 33</p>
  </div>
  <div class="page">
    <p>No versioning Version on close Version on write Eidetic</p>
    <p>D a</p>
    <p>ta s</p>
    <p>e n</p>
    <p>t to</p>
    <p>t h</p>
    <p>e s</p>
    <p>e rv</p>
    <p>e r</p>
    <p>(M B</p>
    <p>)</p>
    <p>Chunk-based deduplication Knockoff</p>
    <p>Bandwidth usage: user study</p>
    <p>Xianzheng Dou 33</p>
    <p>Already achieve 80%-85% reduction</p>
  </div>
  <div class="page">
    <p>No versioning Version on close Version on write Eidetic</p>
    <p>D a</p>
    <p>ta s</p>
    <p>e n</p>
    <p>t to</p>
    <p>t h</p>
    <p>e s</p>
    <p>e rv</p>
    <p>e r</p>
    <p>(M B</p>
    <p>)</p>
    <p>Chunk-based deduplication Knockoff</p>
    <p>Bandwidth usage: user study</p>
    <p>Xianzheng Dou 33</p>
    <p>Already achieve 80%-85% reduction</p>
  </div>
  <div class="page">
    <p>No versioning Version on close Version on write Eidetic</p>
    <p>D a</p>
    <p>ta s</p>
    <p>e n</p>
    <p>t to</p>
    <p>t h</p>
    <p>e s</p>
    <p>e rv</p>
    <p>e r</p>
    <p>(M B</p>
    <p>)</p>
    <p>Chunk-based deduplication Knockoff</p>
    <p>Bandwidth usage: user study</p>
    <p>Xianzheng Dou 33</p>
  </div>
  <div class="page">
    <p>No versioning Version on close Version on write Eidetic</p>
    <p>D a</p>
    <p>ta s</p>
    <p>e n</p>
    <p>t to</p>
    <p>t h</p>
    <p>e s</p>
    <p>e rv</p>
    <p>e r</p>
    <p>(M B</p>
    <p>)</p>
    <p>Chunk-based deduplication Knockoff</p>
    <p>Bandwidth usage: user study</p>
    <p>Xianzheng Dou 33</p>
  </div>
  <div class="page">
    <p>No versioning Version on close Version on write Eidetic</p>
    <p>D a</p>
    <p>ta s</p>
    <p>e n</p>
    <p>t to</p>
    <p>t h</p>
    <p>e s</p>
    <p>e rv</p>
    <p>e r</p>
    <p>(M B</p>
    <p>)</p>
    <p>Chunk-based deduplication Knockoff</p>
    <p>Bandwidth usage: user study</p>
    <p>Xianzheng Dou 33</p>
  </div>
  <div class="page">
    <p>Variances across applications</p>
    <p>Xianzheng Dou 35</p>
    <p>Version on close</p>
    <p>B a</p>
    <p>n d</p>
    <p>w id</p>
    <p>th s</p>
    <p>a v</p>
    <p>in g</p>
    <p>s( %</p>
    <p>)</p>
    <p>Linux utility</p>
    <p>Graph editing</p>
    <p>Libreoffice Programming Text editing</p>
    <p>Web browsing</p>
    <p>Total</p>
  </div>
  <div class="page">
    <p>Variances across applications</p>
    <p>Xianzheng Dou 35</p>
    <p>Version on close</p>
    <p>B a</p>
    <p>n d</p>
    <p>w id</p>
    <p>th s</p>
    <p>a v</p>
    <p>in g</p>
    <p>s( %</p>
    <p>)</p>
    <p>Linux utility</p>
    <p>Graph editing</p>
    <p>Libreoffice Programming Text editing</p>
    <p>Web browsing</p>
    <p>Total</p>
  </div>
  <div class="page">
    <p>Variances across users</p>
    <p>Xianzheng Dou 36</p>
    <p>A B C D E F G</p>
    <p>Knockoff</p>
    <p>Version on close</p>
    <p>B a</p>
    <p>n d</p>
    <p>w id</p>
    <p>th s</p>
    <p>a v</p>
    <p>in g</p>
    <p>s( %</p>
    <p>)</p>
  </div>
  <div class="page">
    <p>Variances across users</p>
    <p>Xianzheng Dou 36</p>
    <p>A B C D E F G</p>
    <p>Knockoff</p>
    <p>Version on close</p>
    <p>B a</p>
    <p>n d</p>
    <p>w id</p>
    <p>th s</p>
    <p>a v</p>
    <p>in g</p>
    <p>s( %</p>
    <p>)</p>
  </div>
  <div class="page">
    <p>Relative storage costs for past versions</p>
    <p>Xianzheng Dou 37</p>
    <p>Version on close Version on write Eidetic</p>
    <p>Chunk-based deduplication Knockoff</p>
    <p>R e</p>
    <p>la ti</p>
    <p>ve s</p>
    <p>to ra</p>
    <p>g e</p>
    <p>c o</p>
    <p>st</p>
  </div>
  <div class="page">
    <p>Relative storage costs for past versions</p>
    <p>Xianzheng Dou 37</p>
    <p>Version on close Version on write Eidetic</p>
    <p>Chunk-based deduplication Knockoff</p>
    <p>R e</p>
    <p>la ti</p>
    <p>ve s</p>
    <p>to ra</p>
    <p>g e</p>
    <p>c o</p>
    <p>st</p>
  </div>
  <div class="page">
    <p>Relative storage costs for past versions</p>
    <p>Xianzheng Dou 37</p>
    <p>Version on close Version on write Eidetic</p>
    <p>Chunk-based deduplication Knockoff</p>
    <p>R e</p>
    <p>la ti</p>
    <p>ve s</p>
    <p>to ra</p>
    <p>g e</p>
    <p>c o</p>
    <p>st</p>
  </div>
  <div class="page">
    <p>Performance overheads</p>
    <p>No Versioning Version on close Version on write Eidetic</p>
    <p>7-8% performance overheads</p>
    <p>Baseline</p>
  </div>
  <div class="page">
    <p>Conclusion</p>
    <p>A new dimension for reducing costs</p>
    <p>Selectively substitute computation for data</p>
    <p>A general-purpose system for deterministic recomputation</p>
    <p>Reduces storage and communication costs for existing versioning policies</p>
    <p>Enables eidetic versioning</p>
    <p>Xianzheng Dou 39</p>
  </div>
  <div class="page">
    <p>Thank you!</p>
    <p>Xianzheng Dou 40</p>
  </div>
  <div class="page">
    <p>Varying the materialization delay</p>
    <p>Xianzheng Dou 41</p>
  </div>
  <div class="page">
    <p>Monetary costs</p>
    <p>Xianzheng Dou 42</p>
  </div>
  <div class="page">
    <p>Workload characteristics</p>
    <p>Xianzheng Dou 43</p>
  </div>
</Presentation>
