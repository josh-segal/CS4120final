<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Effective Detection of Multimedia Protocol Tunneling using Machine Learning</p>
    <p>Diogo Barradas, Nuno Santos, Lus Rodrigues</p>
    <p>INESC-ID, Instituto Superior Tcnico, Universidade de Lisboa</p>
    <p>USENIX Security Symposium 18</p>
  </div>
  <div class="page">
    <p>Internet Censorship is Widespread Around the Globe</p>
  </div>
  <div class="page">
    <p>Adversaries Monitor and Control Internet Access</p>
    <p>Censored Region Uncensored Region</p>
    <p>Deep Packet Inspection</p>
    <p>DNS Hijacking</p>
    <p>IP Blocking</p>
    <p>...</p>
  </div>
  <div class="page">
    <p>But Some Communication Channels are Still Allowed...</p>
    <p>Censored Region Uncensored Region</p>
  </div>
  <div class="page">
    <p>Censored Region</p>
    <p>How Can We Encode Data into Multimedia Streams?</p>
    <p>+</p>
    <p>Uncensored Region</p>
    <p>Multimedia Protocol Tunneling (MPT)</p>
  </div>
  <div class="page">
    <p>Is MPT a Silver Bullet for Evading Censorship?</p>
    <p>Traffic characteristics change with covert data embedding  Due to changes in video compression</p>
    <p>Adversaries can detect unusual patterns in encrypted network flows  Comparison of packets size / inter-arrival time probability distributions</p>
    <p>Censored Region Uncensored Region</p>
    <p>Encrypted Traffic Analysis</p>
  </div>
  <div class="page">
    <p>Unobservability</p>
    <p>Previous works have attempted to assess unobservability using simple similarity-based classifiers</p>
    <p>Results suggested that covert channels were unobservable</p>
    <p>Are these claims sound?  If not, they pose life-threatening risks to end users (e.g. journalists)</p>
    <p>A covert channel is unobservable if an adversary cannot distinguish</p>
    <p>streams that carry a covert channel from those that do not</p>
  </div>
  <div class="page">
    <p>Limitations of Previous Work</p>
    <p>Different works use different evaluation metrics</p>
    <p>Unobservability assessment is based on a limited set of features</p>
    <p>Do not leverage recent advances on ML techniques</p>
  </div>
  <div class="page">
    <p>Goal</p>
    <p>Provide an answer to the following questions:</p>
    <p>How effective existing detection techniques really are?</p>
    <p>Are there classification techniques which offer better results?</p>
    <p>Which features can be used to better detect covert channels?</p>
    <p>To understand whether state-of-the-art MPT systems are secure</p>
  </div>
  <div class="page">
    <p>Contributions The first extensive experimental study of the unobservability of covert channels</p>
    <p>produced by state-of-the-art MPT systems</p>
    <p>Compare existing similarity classifiers on the detection of MPT tools  In general, unable to accurately detect covert channels</p>
    <p>Explore multiple ML techniques for the detection of covert channels  Decision tree-based classifiers can effectively detect existing MPT tools</p>
    <p>Analyse the importance of multiple features for MPT detection purposes  We find that packet lengths matter the most</p>
  </div>
  <div class="page">
    <p>Multimedia Protocol Tunneling (MPT) Systems Under Study</p>
    <p>Facet (WPES14)</p>
    <p>Unidirectional (A/V) Video Transmission</p>
    <p>DeltaShaper (PETS17)</p>
    <p>Bidirectional (V) Arbitrary Data Transmission</p>
    <p>CovertCast (PETS16)</p>
    <p>Unidirectional (V) Censored Websites Transmission</p>
  </div>
  <div class="page">
    <p>Multimedia Protocol Tunneling (MPT) Systems Under Study</p>
    <p>Facet (WPES14)</p>
    <p>Unidirectional (A/V) Video Transmission</p>
    <p>DeltaShaper (PETS17)</p>
    <p>Bidirectional (V) Arbitrary Data Transmission</p>
    <p>CovertCast (PETS16)</p>
    <p>Unidirectional (V) Censored Websites Transmission</p>
  </div>
  <div class="page">
    <p>Adversary Model  We emulate a passive state-level adversary</p>
    <p>Able to inspect encrypted traffic streams  Uses multiple anomaly detection techniques</p>
    <p>Adversary cannot decrypt the encrypted traffic streams  And cannot control the software at users endpoints</p>
    <p>Adversary does not collude with multimedia applications providers</p>
    <p>The adversary cannot disclose raw multimedia content</p>
  </div>
  <div class="page">
    <p>Experimental Setup</p>
    <p>Local Testbed  Two Ubuntu VMs on 2.4 GHz Intel Core2 Duo CPU, 8GB RAM</p>
    <p>Skype for Web, YouTube (QUIC packets)  MPT tools prototypes</p>
    <p>Dataset  Facet: 1000 chat streams, 1000 covert streams  DeltaShaper: 300 chat streams, 300 covert streams  CovertCast: 200 live streams, 200 covert streams</p>
    <p>Network packets are collected for 60 seconds</p>
  </div>
  <div class="page">
    <p>How are Covert Channels Detected Today?  Previous systems were evaluated with different similarity-based classifiers</p>
    <p>Facet : Pearsons Chi-squared Test (2)  CovertCast : Kullback-Leibler Divergence (KL)</p>
    <p>DeltaShaper : Earth Movers Distance (EMD)</p>
    <p>Feature sets are similar (quantized frequency distributions)  Facet : Packet size bi-grams  CovertCast : Packet size, inter-arrival delay  DeltaShaper : Packet size, inter-arrival delay</p>
  </div>
  <div class="page">
    <p>How Effective are Existing Detection Techniques?</p>
    <p>Protocol Tunneling System 2 Classifier (acc%) KL Classifier (acc%) EMD Classifier (acc%)</p>
    <p>Facet (s = 50%) 74.3 57.5 57.5</p>
    <p>2 is the most accurate classifier</p>
    <p>But adversaries are interested in checking TPR and FPR trade-offs  Flag as many covert channels as possible  Erroneously flag few legitimate connections</p>
    <p>KL and EMD are comparable</p>
    <p>Recent classifiers offer worse accuracy</p>
  </div>
  <div class="page">
    <p>Similarity-based Classifiers Produce a Large FPR</p>
    <p>2: 90% TPR = 45% FPR EMD: 90% TPR = 84% FPRB</p>
    <p>e</p>
    <p>t t e</p>
    <p>r</p>
    <p>R</p>
    <p>a</p>
    <p>n</p>
    <p>d</p>
    <p>o</p>
    <p>m</p>
    <p>G</p>
    <p>u</p>
    <p>e</p>
    <p>s s i n</p>
    <p>g</p>
    <p>( A</p>
    <p>U</p>
    <p>C</p>
    <p>=</p>
    <p>. 5</p>
    <p>)</p>
    <p>Facet:</p>
    <p>Similarity-based classifiers are not suitable for the effective detection of Facet</p>
    <p>Can we do better?</p>
  </div>
  <div class="page">
    <p>Can Other ML Techniques Better Detect Covert Channels?  We assess the effectiveness of multiple decision tree-based classifiers</p>
    <p>Decision Trees  Random Forests  eXtreme Gradient Boosting (XGBoost)</p>
    <p>Models are easily interpretable</p>
    <p>Provide the ability to assess feature importance</p>
  </div>
  <div class="page">
    <p>Which Features Could an Adversary Use?  Feature set 1: Summary statistics (ST)</p>
    <p>Total of 166 features, including simple statistics (e.g., max, min, percentiles), high order statistics (e.g., skew), and bursts</p>
    <p>Feature set 2: Quantized packet lengths (PL)  Quantized PL frequency distribution for the flow carrying covert data  Each K size bin acts as an individual feature (K = 5 bytes)</p>
    <p>A set of features not previously considered for the detection of MPT tools</p>
    <p>Decision trees exploit the different relevance of particular ranges of this feature set</p>
  </div>
  <div class="page">
    <p>XGBoost + ST is Effective at Detecting Covert Channels</p>
    <p>XGBoost-ST: 90% TPR = 7% FPR</p>
    <p>Facet:</p>
    <p>2: 90% TPR = 45% FPR</p>
    <p>Majority of covert channels can be flagged</p>
    <p>with a small number of false positives</p>
    <p>XGBoost-ST offers a much lower FPR than 2</p>
  </div>
  <div class="page">
    <p>Quantized Packet Lengths Outperform Summary Statistics</p>
    <p>XGBoost-ST: 90% TPR = 7% FPR XGBoost-PL: 90% TPR = 2% FPR</p>
    <p>XGBoost-PL reduces the FPR when flagging the same amount of covert channels</p>
  </div>
  <div class="page">
    <p>Which Features can Better Identify Facet Traffic?</p>
    <p>XGBoost-ST XGBoost-PL</p>
    <p>ST features indicate that PL</p>
    <p>features are more relevant</p>
    <p>PL within 100-200B is most relevant for</p>
    <p>detection. This is the typical range for audio data</p>
  </div>
  <div class="page">
    <p>Is Detection Effective Without a Fully Labeled Dataset?  XGBoost is effective, but requires a fully labeled dataset</p>
    <p>Both legitimate and covert traffic samples</p>
    <p>Adversaries may be unable to synthesize covert traffic  e.g., difficulty in obtaining a particular MPT tool, zero-day MPT tools</p>
    <p>We investigate the effectiveness of semi- and unsupervised ML techniques</p>
    <p>OCSVM  Autoencoder  Isolation Forest</p>
    <p>Train with legitimate samples only</p>
    <p>Train without labeled samples</p>
  </div>
  <div class="page">
    <p>Labeled Data is Required for Accurate Detection</p>
    <p>Protocol Tunneling</p>
    <p>System</p>
    <p>XGBoost-PL</p>
    <p>(AUC)</p>
    <p>Autoencoder</p>
    <p>(AUC)</p>
    <p>OCSVM</p>
    <p>(AUC)</p>
    <p>Isolation Forest</p>
    <p>(AUC)</p>
    <p>Facet (s = 50%) 0.99 0.70 0.63 0.56</p>
    <p>Autoencoders are promising for</p>
    <p>the identification of covert traffic</p>
    <p>OCSVMs have limited capability</p>
    <p>for covert traffic detection</p>
    <p>Isolation Forest is unable to</p>
    <p>accurately detect covert channels</p>
  </div>
  <div class="page">
    <p>Overview on the Detection of Other MPT Tools</p>
    <p>Facet (WPES14)</p>
    <p>Unidirectional (A/V) Video Transmission</p>
    <p>DeltaShaper (PETS17)</p>
    <p>Bidirectional (V) Arbitrary Data Transmission</p>
    <p>CovertCast (PETS16)</p>
    <p>Unidirectional (V) Censored Websites Transmission</p>
  </div>
  <div class="page">
    <p>Detection of DeltaShaper</p>
    <p>DeltaShaper detection results follow a similar trend to those of Facet detection</p>
    <p>2: 90% TPR = 51% FPR XGBoost-PL: 90% TPR = 14% FPR</p>
  </div>
  <div class="page">
    <p>Detection of CovertCast</p>
    <p>CovertCast can be easily detected by similarity-based classifiers</p>
    <p>Protocol Tunneling System 2 Classifier (acc%) KL Classifier (acc%) EMD Classifier (acc%)</p>
    <p>CovertCast 99 92 83</p>
    <p>How tightly are MPT designs coupled to carrier protocols / applications?  Results suggest that implementation changes on carrier protocols can affect</p>
    <p>the unobservability of covert channels</p>
  </div>
  <div class="page">
    <p>Conclusions  Existing MPT tools can be effectively detected despite previous</p>
    <p>unobservability claims provided by similarity-based classifiers</p>
    <p>The analysis of feature importance offers potentially actionable data for the development of new MPT designs</p>
    <p>More sophisticated semi-supervised ML techniques are promising for the detection of MPT tools</p>
    <p>https://web.ist.utl.pt/diogo.barradas</p>
  </div>
</Presentation>
