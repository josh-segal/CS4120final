<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Slide Title</p>
    <p>Shadow: The Case for Determinism on the Edge</p>
    <p>Matthew Furlong, Andrew Quinn, and Jason Flinn</p>
  </div>
  <div class="page">
    <p>Edge Concern Effect Problem</p>
    <p>Concerns for the Edge</p>
  </div>
  <div class="page">
    <p>Concerns for the Edge</p>
    <p>Edge Concern Effect Problem</p>
    <p>Provisioning More jitter</p>
  </div>
  <div class="page">
    <p>Edge Concern Effect Problem</p>
    <p>Provisioning More jitter  Limited edge resources</p>
    <p>Concerns for the Edge</p>
  </div>
  <div class="page">
    <p>[1] Lee, H., Flinn, J., And Tonshal, B. Raven: Improving interactive latency for the connected car.</p>
    <p>Edge Concern Effect Problem</p>
    <p>Provisioning More jitter  Limited edge resources  Mobile network variability</p>
    <p>High tail latency!</p>
    <p>Concerns for the Edge</p>
  </div>
  <div class="page">
    <p>Edge Concern Effect Problem</p>
    <p>Provisioning More jitter  Limited edge resources  Mobile network variability</p>
    <p>Mobility Performance</p>
    <p>variability</p>
    <p>Concerns for the Edge</p>
  </div>
  <div class="page">
    <p>Edge Concern Effect Problem</p>
    <p>Provisioning More jitter  Limited edge resources  Mobile network variability</p>
    <p>Mobility Performance</p>
    <p>variability  Low-latency connections are lost</p>
    <p>Concerns for the Edge</p>
  </div>
  <div class="page">
    <p>Edge Concern Effect Problem</p>
    <p>Provisioning More jitter  Limited edge resources  Mobile network variability</p>
    <p>Mobility Performance</p>
    <p>variability  Low-latency connections are lost</p>
    <p>Reliability More faults</p>
    <p>Concerns for the Edge</p>
  </div>
  <div class="page">
    <p>Edge Concern Effect Problem</p>
    <p>Provisioning More jitter  Limited edge resources  Mobile network variability</p>
    <p>Mobility Performance</p>
    <p>variability  Low-latency connections are lost</p>
    <p>Reliability More faults  Numerous providers</p>
    <p>Concerns for the Edge</p>
  </div>
  <div class="page">
    <p>Edge Concern Effect Problem</p>
    <p>Provisioning More jitter  Limited edge resources  Mobile network variability</p>
    <p>Mobility Performance</p>
    <p>variability  Low-latency connections are lost</p>
    <p>Reliability More faults  Numerous providers  Distributed</p>
    <p>Concerns for the Edge</p>
  </div>
  <div class="page">
    <p>Edge Concern Effect Problem</p>
    <p>Provisioning More jitter  Limited edge resources  Mobile network variability</p>
    <p>Mobility Performance</p>
    <p>variability  Low-latency connections are lost</p>
    <p>Reliability More faults  Numerous providers  Distributed</p>
    <p>More data sources Privacy concerns</p>
    <p>Concerns for the Edge</p>
  </div>
  <div class="page">
    <p>Edge Concern Effect Problem</p>
    <p>Provisioning More jitter  Limited edge resources  Mobile network variability</p>
    <p>Mobility Performance</p>
    <p>variability  Low-latency connections are lost</p>
    <p>Reliability More faults  Numerous providers  Distributed</p>
    <p>More data sources Privacy concerns  More IoT devices = more sensitive user data</p>
    <p>Concerns for the Edge</p>
  </div>
  <div class="page">
    <p>Applications are typically latency-sensitive or require high bandwidth</p>
    <p>Moving From the Cloud to Edge</p>
  </div>
  <div class="page">
    <p>Applications are typically latency-sensitive or require high bandwidth</p>
    <p>Moving From the Cloud to Edge</p>
    <p>AR App</p>
    <p>TorchOpenCV</p>
    <p>Edge</p>
    <p>AR App</p>
    <p>TorchOpenCV</p>
    <p>AR App</p>
    <p>TorchOpenCV</p>
    <p>AR App</p>
    <p>TorchOpenCV</p>
  </div>
  <div class="page">
    <p>Outline</p>
    <p>Motivation  Determinism to the rescue  Shadow: Deterministic containers  Evaluation</p>
  </div>
  <div class="page">
    <p>A deterministic execution of an application provides the necessary support for edge systems</p>
    <p>Determinism to the Rescue</p>
    <p>S0 S1 1</p>
    <p>Deterministic Non-Deterministic</p>
    <p>S0 S1 1</p>
    <p>S2 0/1</p>
  </div>
  <div class="page">
    <p>Determinism allows applications to be replicated across multiple servers</p>
    <p>Determinism to the Rescue</p>
  </div>
  <div class="page">
    <p>Determinism allows applications to be replicated across multiple servers  Determinism enables migration with minimal</p>
    <p>downtime</p>
    <p>Determinism to the Rescue</p>
  </div>
  <div class="page">
    <p>Migration</p>
    <p>Low-latency connection</p>
    <p>Server inputs: a</p>
    <p>Server Responses:</p>
  </div>
  <div class="page">
    <p>Migration</p>
    <p>Better connection discovered</p>
    <p>Server inputs: a</p>
    <p>Server Responses:</p>
  </div>
  <div class="page">
    <p>Migration</p>
    <p>Initiate migration!</p>
    <p>Responses:</p>
    <p>Server inputs: a</p>
  </div>
  <div class="page">
    <p>Migration</p>
    <p>Server inputs: a</p>
    <p>b</p>
    <p>Checkpoint Application</p>
    <p>Server inputs: ab</p>
    <p>? Server</p>
    <p>Responses:</p>
  </div>
  <div class="page">
    <p>Migration</p>
    <p>Server inputs: a</p>
    <p>Multicast client inputb b</p>
    <p>Transfer Checkpoint</p>
    <p>Server inputs: ab b</p>
    <p>Responses:</p>
  </div>
  <div class="page">
    <p>Migration</p>
    <p>Server inputs: a</p>
    <p>Multicast client inputc c</p>
    <p>Transfer Checkpoint</p>
    <p>Server inputs: ab b</p>
    <p>c c</p>
    <p>Responses:</p>
  </div>
  <div class="page">
    <p>Migration</p>
    <p>Server inputs: a</p>
    <p>Multicast client inputd d</p>
    <p>Server inputs: ab b</p>
    <p>c c</p>
    <p>Restore Application</p>
    <p>dd</p>
    <p>Server Responses:</p>
  </div>
  <div class="page">
    <p>e</p>
    <p>Migration</p>
    <p>Server inputs: a</p>
    <p>Multicast client input e e</p>
    <p>Server inputs: ab b</p>
    <p>c c</p>
    <p>d d</p>
    <p>e</p>
    <p>Server Responses:</p>
  </div>
  <div class="page">
    <p>e</p>
    <p>Migration</p>
    <p>Server inputs: a</p>
    <p>Multicast client input f f</p>
    <p>Server inputs: ab b</p>
    <p>c c</p>
    <p>d d</p>
    <p>ef f</p>
    <p>Responses:</p>
  </div>
  <div class="page">
    <p>e</p>
    <p>Migration</p>
    <p>Server inputs: a</p>
    <p>Migration complete! g</p>
    <p>Server inputs: ab b</p>
    <p>c c</p>
    <p>d d</p>
    <p>ef f</p>
  </div>
  <div class="page">
    <p>Determinism to the Rescue</p>
    <p>Edge Concern Problem Solution</p>
    <p>Provisioning  Limited edge resources  Mobile network variability</p>
    <p>Determinism</p>
    <p>Mobility  Low-latency connections are lost Determinism</p>
    <p>Reliability  Numerous providers  Distributed</p>
    <p>Determinism</p>
    <p>More data sources  More IoT devices = more sensitive user data Determinism</p>
  </div>
  <div class="page">
    <p>Determinism to the Rescue</p>
    <p>Edge Concern Problem Solution</p>
    <p>Provisioning  Limited edge resources  Mobile network variability</p>
    <p>Determinism</p>
    <p>Mobility  Low-latency connections are lost Determinism</p>
    <p>Reliability  Numerous providers  Distributed</p>
    <p>Determinism</p>
    <p>More data sources  More IoT devices = more sensitive user data Determinism</p>
    <p>Challenge: Applications are inherently nondeterministic!</p>
  </div>
  <div class="page">
    <p>Non-determinism in applications  Randomness  Time  Multi-threading  Network communication  Inter-process communication (IPC)</p>
    <p>Determinism to the Rescue</p>
  </div>
  <div class="page">
    <p>Non-determinism in applications  Randomness  Time  Multi-threading  Network communication  Inter-process communication (IPC)</p>
    <p>Challenge: How can we make non-deterministic applications behave deterministically??</p>
    <p>Determinism to the Rescue</p>
  </div>
  <div class="page">
    <p>Outline</p>
    <p>Motivation  Determinism to the rescue  Shadow: Deterministic containers  Evaluation</p>
  </div>
  <div class="page">
    <p>Goal: Eliminate sources of non-determinism</p>
    <p>Shadow</p>
  </div>
  <div class="page">
    <p>Goal: Eliminate sources of non-determinism  Minimize application modifications</p>
    <p>Shadow</p>
  </div>
  <div class="page">
    <p>Goal: Eliminate sources of non-determinism  Minimize application modifications  Maintain similar performance to non-deterministic</p>
    <p>executions</p>
    <p>Shadow</p>
  </div>
  <div class="page">
    <p>Shadow removes non-determinism from applications deployed within containers  Multi-threading  OS Events  Client inputs  External Sources of Non-Determinism</p>
    <p>Deterministic Containers</p>
  </div>
  <div class="page">
    <p>Shadow uses a deterministic thread scheduler based on weak determinism1</p>
    <p>Deterministic Thread Scheduler</p>
    <p>[1] Olseweski, M., Ansel, J., And Amarsinghe, S. Kendo: Efficient deterministic multithreading in software.</p>
  </div>
  <div class="page">
    <p>Shadow uses a deterministic thread scheduler based on weak determinism1  Weak determinism globally orders all</p>
    <p>synchronization operations</p>
    <p>Deterministic Thread Scheduler</p>
    <p>[1] Olseweski, M., Ansel, J., And Amarsinghe, S. Kendo: Efficient deterministic multithreading in software.</p>
  </div>
  <div class="page">
    <p>Shadow removes non-determinism from applications deployed within containers  Multi-threading  OS Events  Client inputs  External Sources of Non-Determinism</p>
    <p>Deterministic Containers</p>
  </div>
  <div class="page">
    <p>System Calls  getrandom()  gettimeofday()  getpid()</p>
    <p>Operating System Events</p>
  </div>
  <div class="page">
    <p>Shadow removes non-determinism from applications deployed within containers  Multi-threading  OS Events  Client inputs  External Sources of Non-Determinism</p>
    <p>Deterministic Containers</p>
  </div>
  <div class="page">
    <p>Determinism is only useful if replicas receive the same sequence of inputs</p>
    <p>Client Inputs</p>
  </div>
  <div class="page">
    <p>Determinism is only useful if replicas receive the same sequence of inputs</p>
    <p>Client Inputs</p>
    <p>Client multicasts inputs</p>
  </div>
  <div class="page">
    <p>Determinism is only useful if replicas receive the same sequence of inputs</p>
    <p>Client Inputs</p>
    <p>Inputs are delivered in epochs to each server</p>
  </div>
  <div class="page">
    <p>Determinism is only useful if replicas receive the same sequence of inputs</p>
    <p>External Sources</p>
    <p>A B</p>
  </div>
  <div class="page">
    <p>Determinism is only useful if replicas receive the same sequence of inputs</p>
    <p>External Sources</p>
    <p>A B</p>
  </div>
  <div class="page">
    <p>Determinism is only useful if replicas receive the same sequence of inputs</p>
    <p>External Sources</p>
  </div>
  <div class="page">
    <p>Determinism is only useful if replicas receive the same sequence of inputs</p>
    <p>External Sources</p>
    <p>Forward request from</p>
    <p>client a</p>
    <p>a</p>
  </div>
  <div class="page">
    <p>Determinism is only useful if replicas receive the same sequence of inputs</p>
    <p>External Sources</p>
    <p>a A</p>
    <p>a</p>
  </div>
  <div class="page">
    <p>Determinism is only useful if replicas receive the same sequence of inputs</p>
    <p>External Sources</p>
    <p>a</p>
    <p>A A</p>
    <p>Client caches response</p>
    <p>a</p>
  </div>
  <div class="page">
    <p>Determinism is only useful if replicas receive the same sequence of inputs</p>
    <p>External Sources</p>
    <p>a</p>
    <p>A</p>
  </div>
  <div class="page">
    <p>Determinism is only useful if replicas receive the same sequence of inputs</p>
    <p>External Sources</p>
    <p>a</p>
    <p>A A</p>
  </div>
  <div class="page">
    <p>Determinism is only useful if replicas receive the same sequence of inputs</p>
    <p>External Sources</p>
    <p>a</p>
    <p>A A</p>
    <p>Shadow!</p>
  </div>
  <div class="page">
    <p>Determinism Summary</p>
    <p>Non-Determinisim Solution Application Limitations</p>
    <p>Multi-threading Weak determinism No data races</p>
    <p>OS Events Deterministic syscalls Time skew</p>
    <p>No IPC or kernel devices</p>
    <p>Client Inputs Use client as primary None</p>
    <p>External Sources Use client as primary None</p>
  </div>
  <div class="page">
    <p>Outline</p>
    <p>Motivation  Determinism to the rescue  Shadow: Deterministic containers  Evaluation</p>
  </div>
  <div class="page">
    <p>Evaluation</p>
    <p>Test Application  Vehicle Caravan</p>
  </div>
  <div class="page">
    <p>Emulate suburban network traces from VNperf1  Evaluate quality of experience for the client</p>
    <p>using response time from server</p>
    <p>Jitter Results</p>
    <p>[1] Lee, H., Flinn, J., And Tonshal, B. Raven: Improving interactive latency for the connected car.</p>
    <p>Non-Det Non-Det Det Det</p>
  </div>
  <div class="page">
    <p>Jitter Results Vehicle Caravan</p>
  </div>
  <div class="page">
    <p>Jitter Results Vehicle Caravan</p>
    <p>Shadow reduces the median response by up to 25 percent</p>
  </div>
  <div class="page">
    <p>Discussion  Feedback</p>
    <p>Are Shadows limitations reasonable to place on applications?  How prevalent does the community think single-client</p>
    <p>applications will be in edge deployments?  What other applications could benefit from a deterministic</p>
    <p>environment?  Controversial points</p>
    <p>Applications must fit into Shadows restrictions (e.g. no IPC, clock skew, race-free)</p>
    <p>Everything falls apart  Performance overhead of determinism outweighs the benefits  If the majority of applications cannot be modified to fit into</p>
    <p>Shadows restrictions</p>
  </div>
</Presentation>
