<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Office Document Security and Privacy</p>
    <p>Jens Mller, Fabian Ising, Christian Mainka, Vladislav Mladenov, Sebastian Schinzel, Jrg Schwenk</p>
  </div>
  <div class="page">
    <p>Overview</p>
  </div>
  <div class="page">
    <p>History: Office Wars</p>
    <p>1990: MS Office 1.0  2002: Star Office  OpenOffice.org  2006: OOXML + ODF standardization  2010: OpenOffice.org  LibreOffice</p>
  </div>
  <div class="page">
    <p>Two competing standards</p>
    <p>OOXML (ISO/IEC 29500) ODF (ISO/IEC 26300)</p>
    <p>Office Open XML Open Document Format</p>
    <p>(some) MS proprietary formats re-use of SVG, MathML, XForms,</p>
    <p>.docx, .xlsx, .pptx,  .odt, .ods, .odp,</p>
    <p>XML-based, Zip container XML-based, Zip container</p>
  </div>
  <div class="page">
    <p>OOXML Directory Structure</p>
  </div>
  <div class="page">
    <p>OOXML Example</p>
  </div>
  <div class="page">
    <p>ODF Directory Structure</p>
  </div>
  <div class="page">
    <p>ODF Example</p>
  </div>
  <div class="page">
    <p>Victim opens malicious office document  Bad things happen (attack-dependent)</p>
    <p>Attacker Model</p>
  </div>
  <div class="page">
    <p>Overview</p>
  </div>
  <div class="page">
    <p>Deflate Bomb</p>
    <p>max. compression ratio: 1:1023</p>
  </div>
  <div class="page">
    <p>Overview</p>
  </div>
  <div class="page">
    <p>Goal: phone home to attackers server once document is opened</p>
    <p>URL Invocation</p>
  </div>
  <div class="page">
    <p>URL Invocation</p>
    <p>CVE-2020-12802</p>
  </div>
  <div class="page">
    <p>URL Invocation</p>
  </div>
  <div class="page">
    <p>Evitable Metadata</p>
    <p>S o</p>
    <p>u rc</p>
    <p>e :</p>
    <p>n e</p>
    <p>w s.</p>
    <p>b b</p>
    <p>c. co</p>
    <p>.u k</p>
  </div>
  <div class="page">
    <p>Evitable Metadata</p>
  </div>
  <div class="page">
    <p>Overview</p>
  </div>
  <div class="page">
    <p>Idea: victim obtains spreadsheet; user input values sent to attackers server</p>
    <p>Data Exfiltration</p>
  </div>
  <div class="page">
    <p>Idea: include local files on disk</p>
    <p>File Disclosure</p>
  </div>
  <div class="page">
    <p>File Disclosure</p>
  </div>
  <div class="page">
    <p>File Disclosure</p>
  </div>
  <div class="page">
    <p>File Disclosure</p>
  </div>
  <div class="page">
    <p>Goal: obtain users NTLM hash</p>
    <p>Credential Theft</p>
  </div>
  <div class="page">
    <p>Offline cracking  NTLMv2: modern GPU requires 2,5h for eight chars</p>
    <p>NTLMv1, LM: considered broken [Marlinspike2012]</p>
    <p>Pass-the-hash or relay attacks  Compare [Ochoa2008, Hummel2009]</p>
    <p>Depending on Windows security policy</p>
    <p>Credential Theft</p>
  </div>
  <div class="page">
    <p>Overview</p>
  </div>
  <div class="page">
    <p>Idea: XForms allow local file as target</p>
    <p>File Write Access</p>
  </div>
  <div class="page">
    <p>File Write Access</p>
    <p>CVE-2020-12803</p>
  </div>
  <div class="page">
    <p>Content Masking: OOXML</p>
  </div>
  <div class="page">
    <p>Content Masking: ODF</p>
    <p>Parsed by MS Office Parsed by LibreOffice</p>
  </div>
  <div class="page">
    <p>Overview</p>
  </div>
  <div class="page">
    <p>Macros</p>
  </div>
  <div class="page">
    <p>Addition Findings</p>
    <p>CVE-2018-8161 (memory corruption)</p>
  </div>
  <div class="page">
    <p>We can write XML to arbitrary files</p>
    <p>LibreOffice config file itself is XML</p>
    <p>One-Click RCE in LibreOffice</p>
  </div>
  <div class="page">
    <p>One-Click RCE in LibreOffice</p>
    <p>CVE-2020-12803</p>
  </div>
  <div class="page">
    <p>Overview</p>
  </div>
  <div class="page">
    <p>Evaluation</p>
  </div>
  <div class="page">
    <p>Removing insecure features  User privacy by default  Limitation of resources  Elimination of ambiguities</p>
    <p>Countermeasures</p>
  </div>
  <div class="page">
    <p>OOXML and ODF are complex formats  Thorough analysis of dangerous features  One-click pure logic chain RCE in 2020 ;)</p>
    <p>Conclusion</p>
    <p>Artifacts: https://github.com/RUB-NDS/Office-Security</p>
  </div>
</Presentation>
