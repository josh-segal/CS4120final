<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Identifying and characterizing Sybils in the Tor network</p>
    <p>August 12, 2016 USENIX Security Symposium</p>
    <p>Philipp Winter Princeton University and Karlstad University</p>
    <p>Roya Ensafi Princeton University</p>
    <p>Karsten Loesing The Tor Project</p>
    <p>Nick Feamster Princeton University</p>
  </div>
  <div class="page"/>
  <div class="page">
    <p>The double-edged sword of volunteer-run networks</p>
    <p>The Tor code is developed by The Tor Project</p>
    <p>The Tor network is run by volunteers</p>
    <p>Currently ~7,000 relays</p>
    <p>Low barrier of entry</p>
    <p>Tor relays as of Aug 2016</p>
  </div>
  <div class="page">
    <p>The double-edged sword of volunteer-run networks</p>
    <p>The Tor code is developed by The Tor Project</p>
    <p>The Tor network is run by volunteers</p>
    <p>Currently ~7,000 relays</p>
    <p>Low barrier of entry</p>
    <p>Single attacker controls many Sybil relays</p>
  </div>
  <div class="page"/>
  <div class="page">
    <p>Existing Sybil defenses dont help</p>
    <p>Social network-based defenses dont apply</p>
    <p>Proof-of-work-based defenses inherent to running a relay</p>
    <p>Instead, we leverage two observations to detect Sybils</p>
    <p>Sybils often controlled similarly</p>
    <p>Sybils often configured similarly</p>
    <p>Nickname IP address ORPort DirPort Flags Version OS Bandwidth Unnamed 204.45.15.234 9001 9030 Fast|Guard|HSDir|Stable|Running|Valid|V2Dir 0.2.4.18-rc FreeBSD 26214400 Unnamed 204.45.15.235 9001 9030 Fast|Guard|HSDir|Stable|Running|Valid|V2Dir 0.2.4.18-rc FreeBSD 26214400 Unnamed 204.45.15.236 9001 9030 Fast|Guard|HSDir|Stable|Running|Valid|V2Dir 0.2.4.18-rc FreeBSD 26214400 Unnamed 204.45.15.237 9001 9030 Fast|Guard|HSDir|Stable|Running|Valid|V2Dir 0.2.4.18-rc FreeBSD 26214400 Unnamed 204.45.250.10 9001 9030 Fast|Guard|HSDir|Stable|Running|Valid|V2Dir 0.2.4.18-rc FreeBSD 26214400 Unnamed 204.45.250.11 9001 9030 Fast|Guard|HSDir|Stable|Running|Valid|V2Dir 0.2.4.18-rc FreeBSD 26214400 Unnamed 204.45.250.12 9001 9030 Fast|Guard|HSDir|Stable|Running|Valid|V2Dir 0.2.4.18-rc FreeBSD 26214400 Unnamed 204.45.250.13 9001 9030 Fast|Guard|HSDir|Stable|Running|Valid|V2Dir 0.2.4.18-rc FreeBSD 26214400 Unnamed 204.45.250.14 9001 9030 Fast|Guard|HSDir|Stable|Running|Valid|V2Dir 0.2.4.18-rc FreeBSD 26214400</p>
  </div>
  <div class="page">
    <p>Passive dataset</p>
    <p>The Tor Project archives lots of data</p>
    <p>Available at collector.torproject.org</p>
    <p>Network consensus hourly published</p>
    <p>List of currently-running relays</p>
    <p>We use ~100 GiB of archived data</p>
    <p>Tells us network state on any given date since 2005</p>
  </div>
  <div class="page">
    <p>Active dataset</p>
    <p>Used exit relay scanner exitmap  Runs arbitrary network task over all ~1,000 exit relays  Sends decoy traffic over exit relays</p>
    <p>Wrote exitmap modules to detect HTML and HTTP tampering  Checks if decoy traffic is modified by exit relay  Ran modules for 18 months</p>
    <p>Found 251 malicious relays that serve as ground truth  Most of them were Sybils  Many attempted to steal Bitcoins  Some injected JavaScript</p>
  </div>
  <div class="page">
    <p>Introducing sybilhunter</p>
    <p>New tool we developed and maintain</p>
    <p>Freely available at nymity.ch/sybilhunting/</p>
    <p>~5,000 lines of code in golang</p>
    <p>Implements four analysis methods</p>
    <p>Network churn</p>
    <p>Relay uptime visualisation</p>
    <p>Nearest-neighbour ranking</p>
    <p>Fingerprint frequency</p>
  </div>
  <div class="page">
    <p>Visualizing uptimes (method #1)</p>
    <p>Each hour, Tor publishes new consensus  Allows us to create binary uptime sequences for Tor relays</p>
    <p>Date State</p>
    <p>Online</p>
    <p>Offline</p>
    <p>Online</p>
  </div>
  <div class="page">
    <p>Visualizing uptimes (method #1)</p>
    <p>Each hour, Tor publishes new consensus  Allows us to create binary uptime sequences for Tor relays</p>
    <p>Date R 1</p>
    <p>R 2</p>
    <p>R 3</p>
    <p>R 4</p>
  </div>
  <div class="page">
    <p>Visualizing uptimes (method #1)</p>
    <p>Each hour, Tor publishes new consensus  Allows us to create binary uptime sequences for Tor relays</p>
    <p>Date R 1</p>
    <p>R 2</p>
    <p>R 3</p>
    <p>R 4</p>
    <p>Critical part is sorting columns. We use single-linkage clustering.</p>
  </div>
  <div class="page">
    <p>Visualizing uptimes (method #1)</p>
    <p>Each hour, Tor publishes new consensus  Allows us to create binary uptime sequences for Tor relays</p>
    <p>Date R 1</p>
    <p>R 2</p>
    <p>R 3</p>
    <p>R 4</p>
    <p>Sorted columns make it easier to spot Sybils.</p>
  </div>
  <div class="page">
    <p>Visualizing uptimes (method #1)</p>
    <p>Each hour, Tor publishes new consensus  Allows us to create binary uptime sequences for Tor relays</p>
    <p>Date R 1</p>
    <p>R 2</p>
    <p>R 3</p>
    <p>R 4</p>
    <p>Highlight identical uptime sequences to facilitate visual inspection</p>
  </div>
  <div class="page">
    <p>Relay index</p>
    <p>T im</p>
    <p>e</p>
    <p>The Tor Project blocked CMU/SEIs</p>
    <p>relays</p>
    <p>Also run by CMU/SEI</p>
  </div>
  <div class="page">
    <p>~500 relays on PlanetLab relays for</p>
    <p>research</p>
    <p>Relay index</p>
    <p>T im</p>
    <p>e</p>
  </div>
  <div class="page">
    <p>~100 relays from Russia and Germany</p>
    <p>Relay index</p>
    <p>T im</p>
    <p>e</p>
  </div>
  <div class="page">
    <p>Probably Sybils, but not recognized as such</p>
    <p>Relay index</p>
    <p>T im</p>
    <p>e</p>
  </div>
  <div class="page">
    <p>Network churn (method #2)</p>
    <p>Uptime images provide very fine-grained view  Churn between two subsequent consensuses</p>
    <p>Each hour, we calculate new churn values</p>
    <p>Tor network grew more stable  Median decreased from 0.04 (2008)</p>
    <p>to 0.02 (2015) 19</p>
  </div>
  <div class="page">
    <p>Changing fingerprints (method #3)</p>
    <p>Generally, Tor relays dont change their fingerprints  Fingerprint is 40-digit, relay-specific hash over public key</p>
    <p>Systematic changes can be sign of DHT manipulation  Excerpt from March 2013:</p>
    <p>54.242.125.205 (24 unique fingerprints)</p>
    <p>See S&amp;P13 paper Trawling for Tor Hidden Services 20</p>
  </div>
  <div class="page">
    <p>Nearest neighbour ranking (method #4)</p>
    <p>Exitmap occasionally discovered malicious relays  Were there more, but we failed to find them?  Given relay R</p>
    <p>Rank relays nearest neighbour by configuration similarity  First, turn relay configurations into string  Then, calculate Levenshtein distance to reference relay</p>
    <p>Example of Levenshtein distance being six  Four modifications  Two deletions</p>
  </div>
  <div class="page">
    <p>Nearest neighbour search in action</p>
    <p>Tool available at nymity.ch/sybilhunting/</p>
  </div>
  <div class="page">
    <p>Our results in a nutshell</p>
    <p>Studied twenty Sybil groups  lower bound</p>
    <p>Purpose # of Sybil groups Description</p>
    <p>MitM 7 Attempted to steal Bitcoins by manipulating Tor exit traffic</p>
    <p>Botnet 2 Relays seemed part of botnet</p>
    <p>DoS 1 Attempted to (unsuccessfully) disable Tor network</p>
    <p>Research 4 Various live experiments, mostly on hidden services</p>
    <p>Unknown 6 Purpose unclear, perhaps benign</p>
  </div>
  <div class="page">
    <p>Discussion of Bitcoin Sybils</p>
    <p>Attempted to steal Bitcoins from Tor users</p>
    <p>All Sybils were exit relays</p>
    <p>Transparent rewriting of Bitcoin addresses</p>
    <p>Resurfaced after The Tor Project blocked relays</p>
    <p>Game of whack-a-mole</p>
    <p>Went on for many months</p>
    <p>Original: 14Rwtr11Mkc6wix9isJ7SPFZMY4Rq7st7a</p>
    <p>Fake: 14RW9mkoDosyCxzupWTVuLVqs5T4FSeBx7</p>
  </div>
  <div class="page">
    <p>Limitations</p>
    <p>Determining intent is hard</p>
    <p>Our results are a lower bound</p>
    <p>Sybilhunter works best against ignorant attacker</p>
    <p>Open analysis framework, secret parameters</p>
    <p>Hard to exposure future attacks</p>
  </div>
  <div class="page">
    <p>Discussion</p>
    <p>Our adversaries are often lazy and we can exploit that</p>
    <p>Different types of Sybils call for different methods</p>
    <p>Academic research not harmless by definition</p>
    <p>research.torproject.org/safetyboard.html</p>
    <p>Methods are general and apply to other networks as well</p>
    <p>Crowdsourcing successful</p>
  </div>
  <div class="page">
    <p>Acknowledgements</p>
    <p>Thanks to</p>
    <p>Georg Koppen</p>
    <p>Prateek Mittal</p>
    <p>Stefan Lindskog</p>
    <p>Tor developers and community</p>
    <p>Tudor Dumitra (our shepherd)</p>
    <p>Open code, data, visualisations:</p>
    <p>nymity.ch/sybilhunting/</p>
    <p>Contact</p>
    <p>phw@nymity.ch</p>
    <p>@__phw 27</p>
    <p>Karsten Loesing Nick FeamsterRoya Ensafi</p>
  </div>
  <div class="page">
    <p>Acknowledgements</p>
    <p>Thanks to</p>
    <p>Georg Koppen</p>
    <p>Prateek Mittal</p>
    <p>Stefan Lindskog</p>
    <p>Tor developers and community</p>
    <p>Tudor Dumitra (our shepherd)</p>
    <p>Open code, data, visualisations:</p>
    <p>nymity.ch/sybilhunting/</p>
    <p>Contact</p>
    <p>phw@nymity.ch</p>
    <p>@__phw 28</p>
    <p>Karsten Loesing Nick FeamsterRoya Ensafi</p>
    <p>Roya is looking for a faculty position!</p>
  </div>
</Presentation>
