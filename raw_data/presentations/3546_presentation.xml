<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Point Break: A Study of Bandwidth Denial-of-Service Attacks against Tor Rob Jansen, U.S. Naval Research Laboratory Tavish Vaidya, Georgetown University Micah Sherr, Georgetown University</p>
    <p>Rob Jansen Center for High Assurance Computer Systems U.S. Naval Research Laboratory</p>
    <p>August 16th, 2019</p>
  </div>
  <div class="page">
    <p>Point Break: A Study of Bandwidth Denial-of-Service Attacks against Tor | 2U.S. Naval Research Laboratory</p>
    <p>Most Exciting Contribution</p>
    <p>Explore the costs and effects of bandwidth denial-of-service attacks on Tor</p>
    <p>$140 - $1.6K / mo.</p>
  </div>
  <div class="page"/>
  <div class="page">
    <p>Point Break: A Study of Bandwidth Denial-of-Service Attacks against Tor | 4U.S. Naval Research Laboratory</p>
    <p>Tor Protects Users</p>
    <p>Anonymous Communication  Separates identification from routing  Provides unlinkable communication  Protects user privacy and safety online</p>
    <p>Tor is Popular  ~2-8 million daily active users  ~6,500 volunteer relays  Transferring ~200 Gbit/s</p>
  </div>
  <div class="page">
    <p>Point Break: A Study of Bandwidth Denial-of-Service Attacks against Tor | 5U.S. Naval Research Laboratory</p>
    <p>Anonymity Attacks against Tor</p>
    <p>Website fingerprinting attacks  CCSW09, WPES11, CCS12,</p>
    <p>WPES13, Sec14, NDSS16, Sec16, NDSS18, CCS18</p>
    <p>Traffic correlation attacks  S&amp;P05, PET07, Sec09, CCS09,</p>
    <p>TISSEC10, CCS11, PETS13, CCS13, CN13, NDSS14, CCS18,</p>
    <p>Routing attacks  WPES07, CCS07,</p>
    <p>Sec15, PETS16, S&amp;P17, PETS18</p>
  </div>
  <div class="page">
    <p>Point Break: A Study of Bandwidth Denial-of-Service Attacks against Tor | 6U.S. Naval Research Laboratory</p>
    <p>Anonymity Attacks against Tor</p>
    <p>Website fingerprinting attacks  CCSW09, WPES11, CCS12,</p>
    <p>WPES13, Sec14, NDSS16, Sec16, NDSS18, CCS18</p>
    <p>Traffic correlation attacks  S&amp;P05, PET07, Sec09, CCS09,</p>
    <p>TISSEC10, CCS11, PETS13, CCS13, CN13, NDSS14, CCS18,</p>
    <p>Routing attacks  WPES07, CCS07,</p>
    <p>Sec15, PETS16, S&amp;P17, PETS18</p>
  </div>
  <div class="page">
    <p>Point Break: A Study of Bandwidth Denial-of-Service Attacks against Tor | 7U.S. Naval Research Laboratory</p>
    <p>Our Focus: Denial-of-Service Attacks</p>
  </div>
  <div class="page">
    <p>Point Break: A Study of Bandwidth Denial-of-Service Attacks against Tor | 8U.S. Naval Research Laboratory</p>
    <p>Our Focus: Denial-of-Service Attacks</p>
  </div>
  <div class="page">
    <p>Point Break: A Study of Bandwidth Denial-of-Service Attacks against Tor | 9U.S. Naval Research Laboratory</p>
    <p>Our Focus: Denial-of-Service Attacks</p>
    <p>Borisov et al. CCS07</p>
    <p>Selective service refusal</p>
    <p>Geddes et al. WPES14</p>
    <p>Socket Exhaustion</p>
  </div>
  <div class="page">
    <p>Point Break: A Study of Bandwidth Denial-of-Service Attacks against Tor | 10U.S. Naval Research Laboratory</p>
    <p>Our Focus: Denial-of-Service Attacks</p>
    <p>Borisov et al. CCS07</p>
    <p>Selective service refusal</p>
    <p>Pappas et al. InfoSec08</p>
    <p>Packet Spinning</p>
    <p>Barbera et al. ESORICS13</p>
    <p>Cell Flood</p>
    <p>Geddes et al. WPES14</p>
    <p>Socket Exhaustion</p>
  </div>
  <div class="page">
    <p>Point Break: A Study of Bandwidth Denial-of-Service Attacks against Tor | 11U.S. Naval Research Laboratory</p>
    <p>Our Focus: Denial-of-Service Attacks</p>
    <p>Borisov et al. CCS07</p>
    <p>Selective service refusal</p>
    <p>Pappas et al. InfoSec08</p>
    <p>Packet Spinning</p>
    <p>Evans et al. Sec09</p>
    <p>Long Paths</p>
    <p>Barbera et al. ESORICS13</p>
    <p>Cell Flood</p>
    <p>Geddes et al. WPES14</p>
    <p>Socket Exhaustion</p>
  </div>
  <div class="page">
    <p>Point Break: A Study of Bandwidth Denial-of-Service Attacks against Tor | 12U.S. Naval Research Laboratory</p>
    <p>Our Focus: Denial-of-Service Attacks</p>
    <p>Borisov et al. CCS07</p>
    <p>Selective service refusal</p>
    <p>Pappas et al. InfoSec08</p>
    <p>Packet Spinning</p>
    <p>Evans et al. Sec09</p>
    <p>Long Paths</p>
    <p>Barbera et al. ESORICS13</p>
    <p>Cell Flood</p>
    <p>Geddes et al. WPES14</p>
    <p>Socket Exhaustion</p>
    <p>Jansen et al. NDSS14</p>
    <p>Sniper Attack</p>
  </div>
  <div class="page">
    <p>Point Break: A Study of Bandwidth Denial-of-Service Attacks against Tor | 13U.S. Naval Research Laboratory</p>
    <p>Our Focus: Denial-of-Service Attacks</p>
    <p>Borisov et al. CCS07</p>
    <p>Selective service refusal</p>
    <p>Pappas et al. InfoSec08</p>
    <p>Packet Spinning</p>
    <p>Evans et al. Sec09</p>
    <p>Long Paths</p>
    <p>Barbera et al. ESORICS13</p>
    <p>Cell Flood</p>
    <p>Geddes et al. WPES14</p>
    <p>Socket Exhaustion</p>
    <p>Jansen et al. NDSS14</p>
    <p>Sniper Attack</p>
    <p>This Work Long Paths</p>
    <p>+ Sniper</p>
  </div>
  <div class="page">
    <p>Point Break: A Study of Bandwidth Denial-of-Service Attacks against Tor | 14U.S. Naval Research Laboratory</p>
    <p>DoS against Tor  A Realistic Threat</p>
    <p>https://trac.torproject.org/projects/tor/ticket/24902</p>
  </div>
  <div class="page">
    <p>Point Break: A Study of Bandwidth Denial-of-Service Attacks against Tor | 15U.S. Naval Research Laboratory</p>
    <p>Research Questions and Summary of Results</p>
    <p>Component Cost Effect</p>
    <p>Bridges $17,000 / mo. 44% slower</p>
    <p>TorFlow BW Scanners</p>
    <p>$2,800 / mo. 80% slower</p>
    <p>Relays $140 - $1,600 / mo. or $6,300 / mo. 47% slower or 120% slower</p>
  </div>
  <div class="page">
    <p>Component Cost Effect</p>
    <p>Bridges $17,000 / mo. 44% slower</p>
    <p>TorFlow BW Scanners</p>
    <p>$2,800 / mo. 80% slower</p>
    <p>Relays $140 - $1,600 / mo. or $6,300 / mo. 47% slower or 120% slower</p>
    <p>Point Break: A Study of Bandwidth Denial-of-Service Attacks against Tor | 16U.S. Naval Research Laboratory</p>
    <p>Research Questions and Summary of Results</p>
    <p>Ethical research:</p>
    <p>No attacks on the public Tor network</p>
    <p>Analyzed performance effects with Shadow</p>
    <p>Conducted some Tor measurements as client, stored no information about users</p>
  </div>
  <div class="page">
    <p>Component Cost Effect</p>
    <p>Bridges $17,000 / mo. 44% slower</p>
    <p>TorFlow BW Scanners</p>
    <p>$2,800 / mo. 80% slower</p>
    <p>Relays $140 - $1,600 / mo. or $6,300 / mo. 47% slower or 120% slower</p>
    <p>Point Break: A Study of Bandwidth Denial-of-Service Attacks against Tor | 17U.S. Naval Research Laboratory</p>
    <p>Research Questions and Summary of Results</p>
  </div>
  <div class="page">
    <p>Attack</p>
  </div>
  <div class="page">
    <p>Point Break: A Study of Bandwidth Denial-of-Service Attacks against Tor | 19U.S. Naval Research Laboratory</p>
    <p>How Tor Works</p>
    <p>= Circuit = Stream</p>
  </div>
  <div class="page">
    <p>Point Break: A Study of Bandwidth Denial-of-Service Attacks against Tor | 20U.S. Naval Research Laboratory</p>
    <p>The Relay Congestion Attack</p>
    <p>Step 1: Build 8-hop circuit</p>
  </div>
  <div class="page">
    <p>Point Break: A Study of Bandwidth Denial-of-Service Attacks against Tor | 21U.S. Naval Research Laboratory</p>
    <p>The Relay Congestion Attack</p>
    <p>Step 1: Build 8-hop circuit</p>
    <p>Can be targeted or indiscriminate</p>
  </div>
  <div class="page">
    <p>Point Break: A Study of Bandwidth Denial-of-Service Attacks against Tor | 22U.S. Naval Research Laboratory</p>
    <p>The Relay Congestion Attack</p>
    <p>Step 1: Build 8-hop circuit</p>
    <p>Step 2: GET large files</p>
  </div>
  <div class="page">
    <p>Point Break: A Study of Bandwidth Denial-of-Service Attacks against Tor | 23U.S. Naval Research Laboratory</p>
    <p>The Relay Congestion Attack</p>
    <p>Step 1: Build 8-hop circuit</p>
    <p>Step 2: GET large files</p>
    <p>Step 3: Stop reading</p>
  </div>
  <div class="page">
    <p>Point Break: A Study of Bandwidth Denial-of-Service Attacks against Tor | 24U.S. Naval Research Laboratory</p>
    <p>The Relay Congestion Attack</p>
    <p>Step 1: Build 8-hop circuit</p>
    <p>Step 2: GET large files</p>
    <p>Step 3: Stop reading</p>
    <p>Step 4: Send flow control cells</p>
  </div>
  <div class="page">
    <p>Point Break: A Study of Bandwidth Denial-of-Service Attacks against Tor | 25U.S. Naval Research Laboratory</p>
    <p>The Relay Congestion Attack</p>
    <p>Step 5: Repeat!!!</p>
    <p>New sockets</p>
    <p>New entry relays</p>
  </div>
  <div class="page">
    <p>Evaluation</p>
  </div>
  <div class="page">
    <p>Point Break: A Study of Bandwidth Denial-of-Service Attacks against Tor | 27U.S. Naval Research Laboratory</p>
    <p>Evaluation Setup</p>
    <p>Use Shadow for evaluation  Private Tor network for safety</p>
    <p>634 relays (10% size, capacity of Tor)</p>
    <p>15,000 clients and 2,000 servers generating traffic through Tor</p>
    <p>Explore network effects  Attack strength (num. attack circuits)</p>
    <p>Network load, attacker resource usage, client performance</p>
    <p>https://github.com/shadow/shadow</p>
  </div>
  <div class="page">
    <p>Point Break: A Study of Bandwidth Denial-of-Service Attacks against Tor | 28U.S. Naval Research Laboratory</p>
    <p>Bandwidth Used by Attacker and Tor Network</p>
    <p>Attacker Throughput (MiB/s)</p>
    <p>C u m</p>
    <p>u la</p>
    <p>ti ve</p>
    <p>F ra</p>
    <p>ct io</p>
    <p>n</p>
    <p>Stop Reading</p>
    <p>Aggregate Tor Relay Goodput (GiB/s)</p>
    <p>C u m</p>
    <p>u la</p>
    <p>ti ve</p>
    <p>F ra</p>
    <p>ct io</p>
    <p>n</p>
    <p>No Attack</p>
    <p>Stop Reading</p>
  </div>
  <div class="page">
    <p>Point Break: A Study of Bandwidth Denial-of-Service Attacks against Tor | 29U.S. Naval Research Laboratory</p>
    <p>Bandwidth Used by Attacker and Tor Network</p>
    <p>Attacker Throughput (MiB/s)</p>
    <p>C u m</p>
    <p>u la</p>
    <p>ti ve</p>
    <p>F ra</p>
    <p>ct io</p>
    <p>n</p>
    <p>Stop Reading</p>
    <p>Aggregate Tor Relay Goodput (GiB/s)</p>
    <p>C u m</p>
    <p>u la</p>
    <p>ti ve</p>
    <p>F ra</p>
    <p>ct io</p>
    <p>n</p>
    <p>No Attack</p>
    <p>Stop Reading</p>
    <p>Bandwidth Amplification</p>
    <p>Factors:</p>
  </div>
  <div class="page">
    <p>Point Break: A Study of Bandwidth Denial-of-Service Attacks against Tor | 30U.S. Naval Research Laboratory</p>
    <p>Bandwidth Used by Attacker and Tor Network</p>
    <p>Attacker Throughput (MiB/s)</p>
    <p>C u m</p>
    <p>u la</p>
    <p>ti ve</p>
    <p>F ra</p>
    <p>ct io</p>
    <p>n</p>
    <p>Stop Reading</p>
    <p>Aggregate Tor Relay Goodput (GiB/s)</p>
    <p>C u m</p>
    <p>u la</p>
    <p>ti ve</p>
    <p>F ra</p>
    <p>ct io</p>
    <p>n</p>
    <p>No Attack</p>
    <p>Stop Reading</p>
    <p>Bandwidth Amplification</p>
    <p>Factors:</p>
  </div>
  <div class="page">
    <p>Point Break: A Study of Bandwidth Denial-of-Service Attacks against Tor | 31U.S. Naval Research Laboratory</p>
    <p>Effect on Client Performance</p>
    <p>N o</p>
    <p>A tt ac</p>
    <p>k 20</p>
    <p>k C ir c.</p>
    <p>St op</p>
    <p>R ea</p>
    <p>di ng</p>
    <p>TTFB All</p>
    <p>D ow</p>
    <p>n lo</p>
    <p>ad T</p>
    <p>im e</p>
    <p>(s )</p>
    <p>N o</p>
    <p>A tt ac</p>
    <p>k 20</p>
    <p>k C ir c.</p>
    <p>St op</p>
    <p>R ea</p>
    <p>di ng</p>
    <p>TTLB 50KiB</p>
    <p>N o</p>
    <p>A tt ac</p>
    <p>k 20</p>
    <p>k C ir c.</p>
    <p>St op</p>
    <p>R ea</p>
    <p>di ng</p>
    <p>TTLB 1MiB</p>
    <p>N o</p>
    <p>A tt ac</p>
    <p>k 20</p>
    <p>k C ir c.</p>
    <p>St op</p>
    <p>R ea</p>
    <p>di ng</p>
    <p>TTLB 5MiB</p>
  </div>
  <div class="page">
    <p>Point Break: A Study of Bandwidth Denial-of-Service Attacks against Tor | 32U.S. Naval Research Laboratory</p>
    <p>Effect on Client Performance</p>
    <p>N o</p>
    <p>A tt ac</p>
    <p>k 20</p>
    <p>k C ir c.</p>
    <p>St op</p>
    <p>R ea</p>
    <p>di ng</p>
    <p>TTFB All</p>
    <p>D ow</p>
    <p>n lo</p>
    <p>ad T</p>
    <p>im e</p>
    <p>(s )</p>
    <p>N o</p>
    <p>A tt ac</p>
    <p>k 20</p>
    <p>k C ir c.</p>
    <p>St op</p>
    <p>R ea</p>
    <p>di ng</p>
    <p>TTLB 50KiB</p>
    <p>N o</p>
    <p>A tt ac</p>
    <p>k 20</p>
    <p>k C ir c.</p>
    <p>St op</p>
    <p>R ea</p>
    <p>di ng</p>
    <p>TTLB 1MiB</p>
    <p>N o</p>
    <p>A tt ac</p>
    <p>k 20</p>
    <p>k C ir c.</p>
    <p>St op</p>
    <p>R ea</p>
    <p>di ng</p>
    <p>TTLB 5MiB</p>
    <p>TTFB: +138%</p>
    <p>TTLB: +120%</p>
  </div>
  <div class="page">
    <p>Point Break: A Study of Bandwidth Denial-of-Service Attacks against Tor | 33U.S. Naval Research Laboratory</p>
    <p>Effect on Client Performance</p>
    <p>N o</p>
    <p>A tt ac</p>
    <p>k 20</p>
    <p>k C ir c.</p>
    <p>St op</p>
    <p>R ea</p>
    <p>di ng</p>
    <p>TTFB All</p>
    <p>D ow</p>
    <p>n lo</p>
    <p>ad T</p>
    <p>im e</p>
    <p>(s )</p>
    <p>N o</p>
    <p>A tt ac</p>
    <p>k 20</p>
    <p>k C ir c.</p>
    <p>St op</p>
    <p>R ea</p>
    <p>di ng</p>
    <p>TTLB 50KiB</p>
    <p>N o</p>
    <p>A tt ac</p>
    <p>k 20</p>
    <p>k C ir c.</p>
    <p>St op</p>
    <p>R ea</p>
    <p>di ng</p>
    <p>TTLB 1MiB</p>
    <p>N o</p>
    <p>A tt ac</p>
    <p>k 20</p>
    <p>k C ir c.</p>
    <p>St op</p>
    <p>R ea</p>
    <p>di ng</p>
    <p>TTLB 5MiB</p>
    <p>TTFB: +138%</p>
    <p>Stop Reading</p>
    <p>TTFB: +48%</p>
    <p>TTLB: +120%</p>
    <p>Stop Reading</p>
    <p>TTLB: +47%</p>
  </div>
  <div class="page">
    <p>Point Break: A Study of Bandwidth Denial-of-Service Attacks against Tor | 34U.S. Naval Research Laboratory</p>
    <p>Cost to Conduct Relay Congestion Attack</p>
    <p>Requirements for stop reading attack  200,000 circuits  3 Gbit/s, 20 IP addresses</p>
    <p>Cost of Bandwidth and IP addresses  3 dedicated servers at 1 Gbit/s each,</p>
    <p>amortized cost of 0.70 $/hour/Gbit/s  17 additional IPs at $5 each, $85 total</p>
    <p>Total Cost Estimates  Conservative: $1,647 per month  Optimistic: $140 per month ($7 * 20 VPSes)</p>
  </div>
  <div class="page">
    <p>Point Break: A Study of Bandwidth Denial-of-Service Attacks against Tor | 35U.S. Naval Research Laboratory</p>
    <p>Comparison to Sybil Attacks</p>
    <p>Comparison to relay Sybil attacks with the same bandwidth budget (3 Gbit/s)</p>
    <p>Sybil DoS Attack Sybil Deanonymization Attack</p>
  </div>
  <div class="page">
    <p>Point Break: A Study of Bandwidth Denial-of-Service Attacks against Tor | 36U.S. Naval Research Laboratory</p>
    <p>Comparison to Sybil Attacks</p>
    <p>Comparison to relay Sybil attacks with the same bandwidth budget (3 Gbit/s)</p>
    <p>Sybil DoS Attack  Goal: drop all circuits containing</p>
    <p>Sybil relays</p>
    <p>Exit BW is scarcest and gives highest probability of selection</p>
    <p>3 Gbit/s = 4.5% dropped circuits</p>
    <p>Sybil Deanonymization Attack</p>
  </div>
  <div class="page">
    <p>Point Break: A Study of Bandwidth Denial-of-Service Attacks against Tor | 37U.S. Naval Research Laboratory</p>
    <p>Comparison to Sybil Attacks</p>
    <p>Comparison to relay Sybil attacks with the same bandwidth budget (3 Gbit/s)</p>
    <p>Sybil DoS Attack  Goal: drop all circuits containing</p>
    <p>Sybil relays</p>
    <p>Exit BW is scarcest and gives highest probability of selection</p>
    <p>3 Gbit/s = 4.5% dropped circuits</p>
    <p>Sybil Deanonymization Attack  Goal: appear on both ends of</p>
    <p>circuits to compromise anonymity</p>
    <p>5:1 guard-to-exit BW allocation</p>
    <p>2.8% guard * 0.8% exit = 0.02% total circuits compromised</p>
  </div>
  <div class="page">
    <p>Mitigation</p>
  </div>
  <div class="page">
    <p>Point Break: A Study of Bandwidth Denial-of-Service Attacks against Tor | 39U.S. Naval Research Laboratory</p>
    <p>Mitigations to Relay Congestion Attack</p>
    <p>Ability to stop reading from circuits  Authenticated SENDMEs, Tor Proposal 289, implemented in 0.4.1.1-alpha</p>
    <p>Inject nonce in every 50 cells</p>
    <p>Must read and return nonce in SENDME cell</p>
  </div>
  <div class="page">
    <p>Point Break: A Study of Bandwidth Denial-of-Service Attacks against Tor | 40U.S. Naval Research Laboratory</p>
    <p>Mitigations to Relay Congestion Attack</p>
    <p>Ability to stop reading from circuits  Authenticated SENDMEs, Tor Proposal 289, implemented in 0.4.1.1-alpha</p>
    <p>Ability to build 8 hop circuits  Reduce to 4 hops to reduce BW amplification factor</p>
  </div>
  <div class="page">
    <p>Point Break: A Study of Bandwidth Denial-of-Service Attacks against Tor | 41U.S. Naval Research Laboratory</p>
    <p>Mitigations to Relay Congestion Attack</p>
    <p>Ability to stop reading from circuits  Authenticated SENDMEs, Tor Proposal 289, implemented in 0.4.1.1-alpha</p>
    <p>Ability to build 8 hop circuits  Reduce to 4 hops to reduce BW amplification factor</p>
    <p>Ability to use any relay as entry  Privacy-preserving defense against Sybil attacks  Detect, measure, and prevent such attacks</p>
  </div>
  <div class="page">
    <p>Point Break: A Study of Bandwidth Denial-of-Service Attacks against Tor | 42U.S. Naval Research Laboratory</p>
    <p>Summary</p>
    <p>Contributions  Bridge congestion attack: $17K/mo., 44% slower  Bandwidth authority attack: $2.6K/mo., 80% slower  Relay congestion attack: $140-$1.6K/mo., 47% slower (or $6.3K/mo., 120% slower)</p>
    <p>Future Work  Deploy simple mitigation techniques in short term  Need research in Sybil attack detection, measurement, and prevention</p>
    <p>Contact  &lt;rob.g.jansen@nrl.navy.mil&gt;, robgjansen.com, @robgjansen</p>
  </div>
</Presentation>
