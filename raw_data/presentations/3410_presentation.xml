<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>USB Snooping Made Easy: Crosstalk Leakage Attacks on USB Hubs</p>
    <p>Daniel Genkin UPenn and UMD</p>
    <p>Damith Ranasinghe University of Adelaide</p>
    <p>joint work with</p>
    <p>Yang Su University of Adelaide</p>
    <p>Yuval Yarom University of Adelaide and Data61</p>
  </div>
  <div class="page">
    <p>Universal Serial Bus (USB)</p>
    <p>Version Year Speed</p>
    <p>USB 1.0 1996 1.5 Mbit/s</p>
    <p>USB 1.1 1998 12 Mbit/s</p>
    <p>USB 2.0 2000 480 Mbit/s</p>
    <p>USB 3.0 2008 5 Gbit/s</p>
    <p>USB 3.1 2013 10 Gbit/s</p>
  </div>
  <div class="page">
    <p>Universal Serial Bus (USB)</p>
    <p>Version Year Speed</p>
    <p>USB 1.0 1996 1.5 Mbit/s</p>
    <p>USB 1.1 1998 12 Mbit/s</p>
    <p>USB 2.0 2000 480 Mbit/s</p>
    <p>USB 3.0 2008 5 Gbit/s</p>
    <p>USB 3.1 2013 10 Gbit/s</p>
    <p>Today</p>
    <p>Most Human Input Devices (HID) are still using USB 1.x</p>
  </div>
  <div class="page">
    <p>USB Security Features</p>
    <p>USB does have some basic routing mechanism, so not all devices see all the traffic</p>
  </div>
  <div class="page">
    <p>USB Topology</p>
    <p>USB Root Hub</p>
    <p>USB Hub</p>
    <p>Downstream data is broadcasted</p>
    <p>Upstream data is unicasted</p>
    <p>How can we mount off path attack on USB devices?</p>
    <p>?</p>
  </div>
  <div class="page">
    <p>Demonstrate off path attacks on USB devices</p>
    <p>Human input devices</p>
    <p>USB storage</p>
    <p>Utilizing crosstalk leakage between adjacent USB ports</p>
    <p>Analog effects between adjacent USB ports on the same hub</p>
    <p>Recover signals present on the other port</p>
    <p>Works on internal and external USB hubs</p>
    <p>30 out of 34 internal hubs</p>
    <p>17 out of 20 external hubs</p>
    <p>Leakage is present on both power and data lines</p>
    <p>Bypassing typical hardware countermeasures such as</p>
    <p>USB power only cables</p>
    <p>Our Results</p>
  </div>
  <div class="page">
    <p>Observing Crosstalk Leakage</p>
    <p>+5V</p>
    <p>D</p>
    <p>D+</p>
    <p>GND</p>
  </div>
  <div class="page">
    <p>Demo: Observing Crosstalk Leakage</p>
  </div>
  <div class="page">
    <p>Observing Crosstalk Leakage</p>
  </div>
  <div class="page">
    <p>Leakage Mechanism</p>
    <p>USB logic Port 1</p>
    <p>D+ D</p>
    <p>USB driver Port 2</p>
    <p>D+ D</p>
    <p>R1=15k</p>
    <p>R2=15k</p>
    <p>R3=15k</p>
    <p>R4=15k</p>
    <p>GND</p>
    <p>C</p>
    <p>USB hubs typically consist of</p>
    <p>one main chip</p>
    <p>Two USB logic blocks should</p>
    <p>be isolated from each other</p>
    <p>Due to manufacturing</p>
    <p>imperfections parasitic</p>
    <p>capacitance is present</p>
    <p>between different USB ports</p>
    <p>on the same chip</p>
    <p>USB logic</p>
    <p>Port 2</p>
  </div>
  <div class="page">
    <p>Leakage Mechanism</p>
    <p>D+ D+ R3=15k</p>
    <p>GND</p>
    <p>C</p>
    <p>USB Port 1</p>
    <p>USB Port 2</p>
    <p>USB hubs typically consist of</p>
    <p>one main chip</p>
    <p>Two USB logic blocks should</p>
    <p>be isolated from each other</p>
    <p>Due to manufacturing</p>
    <p>imperfections parasitic</p>
    <p>capacitance is present</p>
    <p>between different USB ports</p>
    <p>on the same chip</p>
    <p>Fluctuations on one port can</p>
    <p>be visible from other ports</p>
  </div>
  <div class="page">
    <p>Attacking other devices</p>
    <p>USB Fingerprint reader</p>
  </div>
  <div class="page">
    <p>Attacking HID devices</p>
    <p>Magnetic card reader</p>
  </div>
  <div class="page">
    <p>Attacking HID devices</p>
    <p>Magnetic card reader</p>
  </div>
  <div class="page">
    <p>Attacking HID devices</p>
    <p>Exfiltrating keystrokes</p>
  </div>
  <div class="page">
    <p>Attacking HID devices</p>
    <p>Exfiltrating keystrokes</p>
  </div>
  <div class="page">
    <p>Demo: Keystroke Exfiltration</p>
  </div>
  <div class="page">
    <p>Attacking USB 2.0</p>
    <p>Runs at 480Mbit/sec compared to 1.5 Mbit/sec or USB 1.0</p>
    <p>Uses 0.3V compared to 3.3V for USB 1.0</p>
    <p>Data captured using a 6GHz oscilloscope and active probes</p>
  </div>
  <div class="page">
    <p>Bypassing power only cables</p>
    <p>USB Root Hub</p>
    <p>USB Hub</p>
  </div>
  <div class="page">
    <p>Observing Crosstalk Leakage</p>
    <p>+5V</p>
    <p>D</p>
    <p>D+</p>
    <p>GND</p>
  </div>
  <div class="page">
    <p>Observing Crosstalk Leakage</p>
    <p>+5V</p>
    <p>D</p>
    <p>D+</p>
    <p>GND</p>
  </div>
  <div class="page">
    <p>Observing Crosstalk Leakage</p>
  </div>
  <div class="page">
    <p>Do not plug in what you do not trust</p>
    <p>Power leakage can be mitigated using voltage regulators while maintaining</p>
    <p>USB power functionality</p>
    <p>Adding encryption to</p>
    <p>USB buses</p>
    <p>Attack only works for USB 1.1 and (to some extent) USB 2.0</p>
    <p>Attacks on USB 3.0 and USB C devices remain open</p>
    <p>Several pairs of data lines, making leakage analysis harder</p>
    <p>Run at greater speeds, requiring faster equipment to measure</p>
    <p>Other unencrypted buses</p>
    <p>Countermeasures and Future Work</p>
  </div>
  <div class="page">
    <p>Thanks!</p>
  </div>
</Presentation>
