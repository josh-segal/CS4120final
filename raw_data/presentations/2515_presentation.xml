<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Dont Lose Sleep Over Availability:Don t Lose Sleep Over Availability: The GreenUp Decentralized Wakeup Service</p>
    <p>Siddhartha Sen, Princeton University</p>
    <p>J b R L h Ri h d H h C l G J SJacob R. Lorch, Richard Hughes, Carlos G. J. Suarez, Brian Zill, Weverton Cordeiro, and Jitendra Padhye</p>
  </div>
  <div class="page">
    <p>Enterprise networksEnterprise networks</p>
  </div>
  <div class="page">
    <p>Enterprise networksEnterprise networks</p>
    <p>WAN</p>
    <p>users, IT admins</p>
  </div>
  <div class="page">
    <p>Enterprise networksEnterprise networks</p>
    <p>WAN</p>
    <p>users, IT admins</p>
    <p>Despite the cloud, this is a common scenario</p>
  </div>
  <div class="page">
    <p>Enterprise networksEnterprise networks</p>
    <p>St St</p>
    <p>Energy savings</p>
    <p>Stay Green!</p>
    <p>Availability</p>
    <p>Stay Up!</p>
    <p>Energy savings Availability</p>
  </div>
  <div class="page">
    <p>Enterprise networksEnterprise networks</p>
    <p>St St</p>
    <p>Energy savings</p>
    <p>Stay Green!</p>
    <p>Availability</p>
    <p>Stay Up!</p>
    <p>GreenUp!Energy savings AvailabilityGreenUp!</p>
  </div>
  <div class="page">
    <p>Sleep proxySleep proxy</p>
    <p>WAN</p>
    <p>Machine (active)</p>
  </div>
  <div class="page">
    <p>Sleep proxySleep proxy</p>
    <p>WAN</p>
    <p>Machine (active)</p>
    <p>Sleep proxy</p>
  </div>
  <div class="page">
    <p>Sleep proxySleep proxy</p>
    <p>WAN</p>
    <p>Machine (asleep)</p>
    <p>Sleep proxy</p>
  </div>
  <div class="page">
    <p>Sleep proxySleep proxy</p>
    <p>WAN</p>
    <p>Send traffic to me! Machine (asleep)</p>
    <p>Sleep proxy</p>
  </div>
  <div class="page">
    <p>Sleep proxySleep proxy</p>
    <p>WAN</p>
    <p>Send traffic to me!</p>
    <p>Machine (asleep)</p>
    <p>Sleep proxy</p>
  </div>
  <div class="page">
    <p>Sleep proxySleep proxy</p>
    <p>WAN</p>
    <p>Machine (asleep) Machine</p>
    <p>(asleep) Sleep proxy</p>
  </div>
  <div class="page">
    <p>Sleep proxySleep proxy</p>
    <p>Remote requestq (TCP SYN)</p>
    <p>WAN</p>
    <p>Machine (asleep) Machine</p>
    <p>(asleep) Sleep proxy</p>
  </div>
  <div class="page">
    <p>Sleep proxySleep proxy</p>
    <p>WAN</p>
    <p>Machine (asleep) Machine</p>
    <p>(asleep) Sleep proxy</p>
    <p>Remote request (TCP SYN)</p>
  </div>
  <div class="page">
    <p>Sleep proxySleep proxy</p>
    <p>WAN</p>
    <p>Wake up! (WoL)</p>
    <p>Machine (asleep) Machine</p>
    <p>(asleep) Sleep proxy</p>
    <p>(WoL)</p>
  </div>
  <div class="page">
    <p>Sleep proxySleep proxy</p>
    <p>WAN</p>
    <p>Machine (asleep) Machine</p>
    <p>(asleep) Sleep proxy</p>
    <p>Wake up! (WoL)</p>
  </div>
  <div class="page">
    <p>Sleep proxySleep proxy</p>
    <p>WAN</p>
    <p>Machine (active)</p>
    <p>Sleep proxy</p>
  </div>
  <div class="page">
    <p>Sleep proxySleep proxy</p>
    <p>Remote requestq (TCP SYN)</p>
    <p>WAN</p>
    <p>Machine (active)</p>
    <p>Sleep proxy</p>
  </div>
  <div class="page">
    <p>Sleep proxySleep proxy</p>
    <p>WAN</p>
    <p>Machine (active)</p>
    <p>Sleep proxy Remote request</p>
    <p>(TCP SYN)</p>
  </div>
  <div class="page">
    <p>Sleep proxySleep proxy</p>
    <p>WAN</p>
    <p>Response</p>
    <p>Machine (active)</p>
    <p>Sleep proxy</p>
  </div>
  <div class="page">
    <p>Sleep proxySleep proxy</p>
    <p>RResponse</p>
    <p>WAN</p>
    <p>Machine (active)</p>
    <p>Sleep proxy</p>
  </div>
  <div class="page">
    <p>Sleep proxySleep proxy</p>
    <p>RResponse</p>
    <p>Pros Cons</p>
    <p>WAN  No special hardware  No envir. changes N h</p>
    <p>Dedicated server per subnet</p>
    <p>No app changes</p>
    <p>Machine (active)</p>
    <p>Sleep proxy</p>
  </div>
  <div class="page">
    <p>Dedicated servers are a problemDedicated servers are a problem</p>
    <p>High deployment andHigh deployment and management cost</p>
    <p>Single point of failure</p>
  </div>
  <div class="page">
    <p>Dedicated servers are a problemDedicated servers are a problem</p>
    <p>High deployment andHigh deployment and management cost</p>
    <p>Single point of failure</p>
    <p>High availability becomes expensive!</p>
  </div>
  <div class="page">
    <p>GreenUp A decentralized minimalGreenUp: A decentralized, minimal softwareonly sleep proxy</p>
  </div>
  <div class="page">
    <p>GreenUp A decentralized minimalGreenUp: A decentralized, minimal softwareonly sleep proxy</p>
    <p>Any machine can act as a proxy (manager) forAny machine can act as a proxy (manager) for sleeping machines on the subnet</p>
  </div>
  <div class="page">
    <p>OutlineOutline 1. How does GreenUp work? 2. What can I learn from GreenUp?</p>
    <p>deployed on 1,100 machines</p>
  </div>
  <div class="page">
    <p>OutlineOutline 1. How does GreenUp work? 2. What can I learn from GreenUp?</p>
    <p>Machine State</p>
    <p>Distributed management</p>
    <p>Subnet state coordination</p>
    <p>Guardians</p>
    <p>deployed on 1,100 machines</p>
  </div>
  <div class="page">
    <p>OutlineOutline 1. How does GreenUp work? 2. What can I learn from GreenUp?</p>
    <p>Machine State</p>
    <p>Distributed management</p>
    <p>Subnet state coordination</p>
    <p>Guardians</p>
    <p>deployed on 1,100 machines</p>
  </div>
  <div class="page">
    <p>GreenUps environmentGreenUp s environment</p>
    <p>Subnet domainsSubnet domains</p>
    <p>Loadsensitive, unreliable machinesLoad sensitive, unreliable machines</p>
    <p>Single administrative domainSingle administrative domain</p>
    <p>Availability most importanty p</p>
  </div>
  <div class="page">
    <p>Running example (not to scale)Running example (not to scale)</p>
    <p>M1 M8</p>
    <p>M5</p>
    <p>M2</p>
    <p>M5</p>
    <p>M6 M3</p>
    <p>M6</p>
    <p>M7</p>
    <p>M9 M4</p>
    <p>M7</p>
  </div>
  <div class="page">
    <p>Running example (not to scale)Running example (not to scale)</p>
    <p>M1 M8</p>
    <p>M5</p>
    <p>M2</p>
    <p>M5</p>
    <p>M6 awake</p>
    <p>M3 M6</p>
    <p>M7</p>
    <p>M9 M4</p>
    <p>M7</p>
  </div>
  <div class="page">
    <p>Running example (not to scale)Running example (not to scale)</p>
    <p>M1 M8</p>
    <p>M5</p>
    <p>M2</p>
    <p>M5</p>
    <p>M6 awake</p>
    <p>M3 M6</p>
    <p>M7</p>
    <p>M9 M4</p>
    <p>M7</p>
    <p>asleep + unmanaged</p>
  </div>
  <div class="page">
    <p>Running example (not to scale)Running example (not to scale) manager</p>
    <p>M1 M8 asleep + managedM5</p>
    <p>M2 awake</p>
    <p>managedM5</p>
    <p>M6 M3</p>
    <p>M6</p>
    <p>M7</p>
    <p>M9 M4asleep +</p>
    <p>unmanaged</p>
    <p>M7</p>
  </div>
  <div class="page">
    <p>Distributed management: hWho manages M9?</p>
    <p>b f l No guarantees before sleep  M1 failure abandons M8M1 M8</p>
    <p>M5  Probe randomly, repeat since machines unreliable</p>
    <p>M2</p>
    <p>M5</p>
    <p>M6</p>
    <p>Loadsensitive machines, di ib bi</p>
    <p>M3 M6</p>
    <p>M7 so distribute probing  Robust to manager issuesM4</p>
    <p>M9</p>
    <p>M7</p>
  </div>
  <div class="page">
    <p>Distributed management: hWho manages M9?</p>
    <p>Wait for notification?  No guarantees before sleep M1 f il b d M8</p>
    <p>M1 M8</p>
    <p>M5  M1 failure abandons M8</p>
    <p>Probe randomly, repeat M2</p>
    <p>M5</p>
    <p>M6 Probe randomly, repeat since machines unreliableM3</p>
    <p>M6</p>
    <p>M7  Loadsensitive machines, so distribute probing</p>
    <p>b</p>
    <p>M4 M9</p>
    <p>M7</p>
    <p>Robust to manager issues</p>
  </div>
  <div class="page">
    <p>Distributed management: hWho manages M9?</p>
    <p>Wait for notification?  No guarantees before sleep M1 f il b d M8</p>
    <p>M1 M8</p>
    <p>M5  M1 failure abandons M8</p>
    <p>Probe randomly, repeat M2</p>
    <p>M5</p>
    <p>M6 Probe randomly, repeat since machines unreliableM3</p>
    <p>M6</p>
    <p>M7  Loadsensitive machines, so distribute probing</p>
    <p>b</p>
    <p>M4 M9</p>
    <p>M7</p>
    <p>Robust to manager issues</p>
  </div>
  <div class="page">
    <p>Distributed management: hWho manages M9?</p>
    <p>Wait for notification?  No guarantees before sleep M1 f il b d M8</p>
    <p>M1 M8</p>
    <p>M5  M1 failure abandons M8</p>
    <p>Probe randomly, repeat M2</p>
    <p>M5</p>
    <p>M6 Probe randomly, repeat since machines unreliableM3</p>
    <p>M6</p>
    <p>M7  Loadsensitive machines, so distribute probing</p>
    <p>b</p>
    <p>M4 M9</p>
    <p>M7</p>
    <p>Robust to manager issues</p>
  </div>
  <div class="page">
    <p>Distributed management: hWho manages M9?</p>
    <p>M1 M8 total #</p>
    <p>machines</p>
    <p>M5</p>
    <p>machinesawake# nM2</p>
    <p>M5</p>
    <p>M6 machinesawake# M3</p>
    <p>M6</p>
    <p>M7 M4</p>
    <p>M9</p>
    <p>M7</p>
  </div>
  <div class="page">
    <p>Distributed management: hWho manages M9?</p>
    <p>M5</p>
    <p>M1 M8 total #</p>
    <p>machines # managed</p>
    <p>by i</p>
    <p>M5</p>
    <p>M6 machinesawake# imnM2</p>
    <p>M6</p>
    <p>M7</p>
    <p>machinesawake# M3</p>
    <p>M7 M4</p>
    <p>M9</p>
  </div>
  <div class="page">
    <p>Distributed management: hWho manages M9?</p>
    <p>M5</p>
    <p>M1 M8 total #</p>
    <p>machines # managed</p>
    <p>by i</p>
    <p>M5</p>
    <p>M6 machinesawake# imnM2</p>
    <p>M6</p>
    <p>M7</p>
    <p>machinesawake# M3</p>
    <p>M7 M4</p>
    <p>M9</p>
  </div>
  <div class="page">
    <p>Distributed management: hWho manages M9?</p>
    <p>M5</p>
    <p>M1 M8</p>
    <p>M5</p>
    <p>machinesawake# ln 1</p>
    <p>M6</p>
    <p>M7  Coupon collector analysis</p>
    <p>machinesawake# M3</p>
    <p>M6</p>
    <p>M7 Coupon collector analysis M4</p>
    <p>M9</p>
  </div>
  <div class="page">
    <p>Distributed management: hWho manages M9?</p>
    <p>M5</p>
    <p>M1 M8</p>
    <p>M5</p>
    <p>machinesawake# ln 1</p>
    <p>M6</p>
    <p>M7  Coupon collector analysis</p>
    <p>machinesawake# M3</p>
    <p>M6</p>
    <p>M7 Coupon collector analysis M4</p>
    <p>M9</p>
  </div>
  <div class="page">
    <p>Distributed management: hWho manages M9?</p>
    <p>M5</p>
    <p>M1 M8 p = Pr(machine probed)</p>
    <p>M5</p>
    <p>machinesawake# ln 1</p>
    <p>M6</p>
    <p>M7  Coupon collector analysis</p>
    <p>machinesawake# M3</p>
    <p>M6</p>
    <p>M7 Coupon collector analysis M4</p>
    <p>M9</p>
  </div>
  <div class="page">
    <p>Distributed management: hWho manages M9?</p>
    <p>M5</p>
    <p>M1 M8 p = Pr(machine probed)</p>
    <p>M9</p>
    <p>M5</p>
    <p>machinesawake# ln 1</p>
    <p>M6</p>
    <p>M7  Coupon collector analysis</p>
    <p>machinesawake# M3</p>
    <p>M6</p>
    <p>M7 Coupon collector analysis M4</p>
  </div>
  <div class="page">
    <p>Multiple managersMultiple managers</p>
    <p>M1 M8</p>
    <p>M5</p>
    <p>M2     machinesawake# ln 1</p>
    <p>M5</p>
    <p>M6</p>
    <p>M7  Availability most important M3</p>
    <p>machinesawake#M6</p>
    <p>M7 Availability most important</p>
    <p>Simple resolution protocol M4</p>
    <p>M9M9</p>
  </div>
  <div class="page">
    <p>Multiple managersMultiple managers</p>
    <p>M1 M8</p>
    <p>M5</p>
    <p>M9</p>
    <p>M2     machinesawake# ln 1</p>
    <p>M5</p>
    <p>M6M9</p>
    <p>M7  Availability most important M3</p>
    <p>machinesawake#M6M9</p>
    <p>M7 Availability most important</p>
    <p>Simple resolution protocol M4</p>
  </div>
  <div class="page">
    <p>Multiple managersMultiple managers</p>
    <p>M1 M8</p>
    <p>M5</p>
    <p>M9</p>
    <p>M2     machinesawake# ln 1</p>
    <p>M5</p>
    <p>M6M9</p>
    <p>M7  Availability most important M3</p>
    <p>machinesawake#M6M9</p>
    <p>M7 Availability most important</p>
    <p>Simple resolution protocol M4</p>
  </div>
  <div class="page">
    <p>Multiple managersMultiple managers</p>
    <p>M1 M8</p>
    <p>M5</p>
    <p>M9</p>
    <p>M2     machinesawake# ln 1</p>
    <p>M5</p>
    <p>M6M9</p>
    <p>M7  Availability most important M3</p>
    <p>machinesawake#M6M9</p>
    <p>M7 Availability most important</p>
    <p>Simple resolution protocol M4</p>
  </div>
  <div class="page">
    <p>Multiple managersMultiple managers</p>
    <p>M1 M8</p>
    <p>M5</p>
    <p>M9</p>
    <p>M2     machinesawake# ln 1</p>
    <p>M5</p>
    <p>M6</p>
    <p>M7  Availability most important M3</p>
    <p>machinesawake#M6</p>
    <p>M7 Availability most important</p>
    <p>Simple resolution protocol M4</p>
  </div>
  <div class="page">
    <p>Load balanceLoad balance</p>
    <p>M8 M9M1</p>
    <p>M5</p>
    <p>M2</p>
    <p>M5</p>
    <p>M6 M3</p>
    <p>M6</p>
    <p>M7 M4</p>
    <p>M7</p>
  </div>
  <div class="page">
    <p>Load balanceLoad balance</p>
    <p>M5</p>
    <p>M2 M8</p>
    <p>M5</p>
    <p>M6 M3 M9</p>
    <p>M6</p>
    <p>M7 M4 M1</p>
    <p>M7</p>
  </div>
  <div class="page">
    <p>Load balanceLoad balance</p>
    <p>M5</p>
    <p>Induction analysis: equivalent to ballsinbins!</p>
    <p>M2 M8</p>
    <p>M5</p>
    <p>M6 )2/ln(ln</p>
    <p>)2/ln( n n</p>
    <p>after n/2 sleeps</p>
    <p>M3 M9 M6</p>
    <p>M7 M4 M1</p>
    <p>M7</p>
  </div>
  <div class="page">
    <p>Load balanceLoad balance</p>
    <p>M5</p>
    <p>Induction analysis: equivalent to ballsinbins!</p>
    <p>Distributed management elects leaders in a M2 M8</p>
    <p>M5</p>
    <p>M6 )2/ln(ln</p>
    <p>)2/ln( n n</p>
    <p>after n/2 sleeps Distributed management elects leaders in a robust and loadbalanced way, assuming temporary conflicts are tolerable</p>
    <p>M3 M9 M6</p>
    <p>M7</p>
    <p>temporary conflicts are tolerable.</p>
    <p>M4 M1 M7</p>
  </div>
  <div class="page">
    <p>Subnet state coordinationSubnet state coordination</p>
    <p>Distributed management relies on global state</p>
    <p>M1 M8</p>
    <p>M5 g  Who to probe?  How to manage?</p>
    <p>M2</p>
    <p>M5</p>
    <p>M6</p>
    <p>IP address, MAC address M3</p>
    <p>M6</p>
    <p>M7  TCP listen ports</p>
    <p>M9 M4</p>
    <p>M7</p>
  </div>
  <div class="page">
    <p>Subnet state coordinationSubnet state coordination</p>
    <p>Distributed management relies on global state</p>
    <p>M1 M8</p>
    <p>M5 g  Who to probe?  How to manage?</p>
    <p>M2Machine State M8  M9</p>
    <p>M5</p>
    <p>M6</p>
    <p>IP address, MAC address M3 M9  M5</p>
    <p>M6</p>
    <p>M7  TCP listen ports</p>
    <p>M9 M4</p>
    <p>M7</p>
  </div>
  <div class="page">
    <p>Subnet state coordinationSubnet state coordination</p>
    <p>Replicated state machine?  Unreliable machines, correlated behavior</p>
    <p>M1 M8</p>
    <p>M5 correlated behavior  Strong consistency overkillM2Machine State</p>
    <p>M8  M9</p>
    <p>M5</p>
    <p>M6  External database?  Lose instant deployability</p>
    <p>M3 M9  M5</p>
    <p>M6</p>
    <p>M7</p>
    <p>Exploit subnet and weaker M9 M4</p>
    <p>M7</p>
    <p>consistency</p>
  </div>
  <div class="page">
    <p>Subnet state coordinationSubnet state coordination</p>
    <p>Replicated state machine?  Unreliable machines, correlated behavior</p>
    <p>M1 M8</p>
    <p>M5 correlated behavior  Strong consistency overkillM2Machine State</p>
    <p>M8  M9</p>
    <p>M5</p>
    <p>M6  External database?  Lose instant deployability</p>
    <p>M3 M9  M5</p>
    <p>M6</p>
    <p>M7</p>
    <p>Exploit subnet and weaker M9 M4</p>
    <p>M7</p>
    <p>consistency</p>
  </div>
  <div class="page">
    <p>Subnet state coordinationSubnet state coordination</p>
    <p>Replicated state machine?  Unreliable machines, correlated behavior</p>
    <p>M1 M8</p>
    <p>M5 correlated behavior  Strong consistency overkillM2Machine State</p>
    <p>M8  M9</p>
    <p>M5</p>
    <p>M6  External database?  Lose instant deployability</p>
    <p>M3 M9  M5</p>
    <p>M6</p>
    <p>M7</p>
    <p>Exploit subnet and weaker M9 M4</p>
    <p>M7</p>
    <p>consistency</p>
  </div>
  <div class="page">
    <p>Subnet state coordinationSubnet state coordination</p>
    <p>M1 M8</p>
    <p>M5</p>
    <p>M2</p>
    <p>M5</p>
    <p>M6 managers while asleep</p>
    <p>M6</p>
    <p>M7</p>
    <p>M9M9</p>
    <p>M7</p>
  </div>
  <div class="page">
    <p>Subnet state coordinationSubnet state coordination</p>
    <p>M1 M8</p>
    <p>M5</p>
    <p>M2</p>
    <p>M5</p>
    <p>M6 managers while asleep</p>
    <p>M6</p>
    <p>M7</p>
    <p>M9M9</p>
    <p>M9 state</p>
    <p>M7</p>
  </div>
  <div class="page">
    <p>Subnet state coordinationSubnet state coordination</p>
    <p>M1 M8</p>
    <p>M5</p>
    <p>M2</p>
    <p>M5</p>
    <p>M6 managers while asleep</p>
    <p>M6</p>
    <p>M7</p>
    <p>M9</p>
    <p>M7</p>
  </div>
  <div class="page">
    <p>Subnet state coordinationSubnet state coordination</p>
    <p>M1 M8</p>
    <p>M5</p>
    <p>M2</p>
    <p>M5</p>
    <p>M6 managers while asleep</p>
    <p>M6</p>
    <p>M7</p>
    <p>M9</p>
    <p>M7</p>
  </div>
  <div class="page">
    <p>Subnet state coordinationSubnet state coordination</p>
    <p>M1 M8</p>
    <p>M5</p>
    <p>M2</p>
    <p>M5</p>
    <p>M6 ? managers while asleep</p>
    <p>M6</p>
    <p>M7</p>
    <p>?</p>
    <p>M9</p>
    <p>M7</p>
  </div>
  <div class="page">
    <p>Subnet state coordinationSubnet state coordination</p>
    <p>M1 M8</p>
    <p>M5</p>
    <p>M2</p>
    <p>M5</p>
    <p>M6 ? managers while asleep</p>
    <p>M6</p>
    <p>M7</p>
    <p>?</p>
    <p>M9</p>
    <p>M7</p>
  </div>
  <div class="page">
    <p>Subnet state coordinationSubnet state coordination</p>
    <p>M1 M8M8 state</p>
    <p>M5</p>
    <p>M2</p>
    <p>M5</p>
    <p>M6 managers while asleep</p>
    <p>M6</p>
    <p>M7</p>
    <p>M9</p>
    <p>M7</p>
  </div>
  <div class="page">
    <p>Subnet state coordinationSubnet state coordination</p>
    <p>M1 M8M8 state</p>
    <p>M5</p>
    <p>M2</p>
    <p>M5</p>
    <p>M6 M8 state</p>
    <p>managers while asleep</p>
    <p>M6</p>
    <p>M7</p>
    <p>M9</p>
    <p>M7</p>
  </div>
  <div class="page">
    <p>Subnet state coordinationSubnet state coordination</p>
    <p>M1 M8</p>
    <p>M5</p>
    <p>M8 state</p>
    <p>M2</p>
    <p>M5</p>
    <p>M6 managers while asleep</p>
    <p>M6</p>
    <p>M7</p>
    <p>M9</p>
    <p>M7</p>
  </div>
  <div class="page">
    <p>Subnet state coordinationSubnet state coordination</p>
    <p>M1 M8</p>
    <p>M5</p>
    <p>M2</p>
    <p>M5</p>
    <p>M6 managers while asleep</p>
    <p>M6</p>
    <p>M7</p>
    <p>M9</p>
    <p>M7</p>
  </div>
  <div class="page">
    <p>Subnet state coordinationSubnet state coordination</p>
    <p>M1 M8</p>
    <p>M5Subnet state coordination distributes 2. Rebroadcast by</p>
    <p>h l l</p>
    <p>M2</p>
    <p>M5</p>
    <p>M6</p>
    <p>Subnet state coordination distributes permachine state on a subnet when strong consistency is not requiredmanagers while asleep</p>
    <p>M6</p>
    <p>M7</p>
    <p>strong consistency is not required.</p>
    <p>M9</p>
    <p>M7</p>
  </div>
  <div class="page">
    <p>OutlineOutline 1. How does GreenUp work? 2. What can I learn from GreenUp?</p>
    <p>Machine State</p>
    <p>Distributed management</p>
    <p>Subnet state coordination</p>
    <p>Guardians</p>
    <p>deployed on 1,100 machines</p>
  </div>
  <div class="page">
    <p>OutlineOutline 1. How does GreenUp work? 2. What can I learn from GreenUp?</p>
    <p>P iMachine State</p>
    <p>Protects against simultaneous sleep</p>
    <p>Caps the max load Distributed management</p>
    <p>Subnet state coordination</p>
    <p>Guardians  Caps the max load</p>
    <p>deployed on 1,100 machines</p>
  </div>
  <div class="page">
    <p>OutlineOutline 1. How does GreenUp work? 2. What can I learn from GreenUp?</p>
    <p>Machine State</p>
    <p>Distributed management</p>
    <p>Subnet state coordination</p>
    <p>Guardians</p>
    <p>deployed on 1,100 machines</p>
  </div>
  <div class="page">
    <p>Deployment in MicrosoftDeployment in Microsoft</p>
    <p>C# codeC# code  Interfaces with packet sniffer/network driver</p>
    <p>Client GUI for users and d l teasy deployment</p>
    <p>Pilot on 1 100 machinesPilot on 1,100 machines</p>
  </div>
  <div class="page">
    <p>EvaluationEvaluation</p>
    <p>Logs from 101 Windows 7 machines Feb Logs from 101 Windows 7 machines, Feb. Sep. 2011</p>
    <p>Questions:  Does GreenUp consistently wake machines whenDoes GreenUp consistently wake machines when accessed?</p>
    <p>Does it do so in time to meet user patience?Does it do so in time to meet user patience?  Can GreenUp scale to large subnets?</p>
  </div>
  <div class="page">
    <p>GreenUp wakes machines reliablyGreenUp wakes machines reliably</p>
  </div>
  <div class="page">
    <p>GreenUp wakes machines reliablyGreenUp wakes machines reliably</p>
    <p>Connect to machines usingConnect to machines using Samba (TCP port 139)</p>
    <p>11 different days (weekends, evenings):  496 already awake, 278 woken, 5 unwakeable</p>
    <p>Most failures due to WoL Most failures due to WoL</p>
    <p>99.4% success rate</p>
  </div>
  <div class="page">
    <p>GreenUp wakes machines reliablyGreenUp wakes machines reliably</p>
    <p>Connect to machines usingConnect to machines using Samba (TCP port 139)</p>
    <p>11 different days (weekends, evenings):</p>
    <p>WoL is availability bottleneck!</p>
    <p>496 already awake, 278 woken, 5 unwakeable</p>
    <p>Most failures due to WoL</p>
    <p>bott e ec</p>
    <p>Most failures due to WoL</p>
    <p>99.4% success rate</p>
  </div>
  <div class="page">
    <p>GreenUp wakes machines quicklyGreenUp wakes machines quickly</p>
    <p>GreenUp relies on someGreenUp relies on some user patience  Wakeup delay  User retry logic</p>
    <p>Sideeffect of WoL failure: manager logs how long user waitshow long user waits  48 events</p>
  </div>
  <div class="page">
    <p>GreenUp wakes machines quicklyGreenUp wakes machines quickly</p>
    <p>GreenUp relies on someGreenUp relies on some user patience  Wakeup delay  User retry logic</p>
    <p>Sideeffect of WoL failure: manager logs how long user waitshow long user waits  48 events</p>
  </div>
  <div class="page">
    <p>GreenUp wakes machines quicklyGreenUp wakes machines quickly</p>
    <p>Convolving: GreenUp wakes machines before userConvolving: GreenUp wakes machines before user gives up 85% of the time</p>
  </div>
  <div class="page">
    <p>GreenUp wakes machines quicklyGreenUp wakes machines quickly</p>
    <p>Convolving: GreenUp wakes machines before userConvolving: GreenUp wakes machines before user gives up 85% of the time</p>
  </div>
  <div class="page">
    <p>GreenUp wakes machines quicklyGreenUp wakes machines quickly</p>
    <p>Convolving: GreenUp wakes machines before userConvolving: GreenUp wakes machines before user gives up 85% of the time</p>
  </div>
  <div class="page">
    <p>GreenUp wakes machines quicklyGreenUp wakes machines quickly</p>
    <p>Convolving: GreenUp wakes machines before userConvolving: GreenUp wakes machines before user gives up 85% of the time</p>
  </div>
  <div class="page">
    <p>GreenUp scales to large subnetsGreenUp scales to large subnets</p>
    <p>Sources of manager loadSources of manager load  Intercept traffic for asleep machines Broadcast state Broadcast state</p>
    <p>Probe/respond to probes</p>
  </div>
  <div class="page">
    <p>GreenUp scales to large subnetsGreenUp scales to large subnets</p>
  </div>
  <div class="page">
    <p>GreenUp scales to large subnetsGreenUp scales to large subnets</p>
  </div>
  <div class="page">
    <p>GreenUp scales to large subnetsGreenUp scales to large subnets</p>
  </div>
  <div class="page">
    <p>GreenUp scales to large subnetsGreenUp scales to large subnets</p>
    <p>Good load balance + h k henough awake machines</p>
    <p>few managed machines!</p>
  </div>
  <div class="page">
    <p>GreenUp scales to large subnetsGreenUp scales to large subnets</p>
    <p>Simulated probing load on 2.4GHz, dualcoreSimulated probing load on 2.4 GHz, dual core Windows 7 machine w/ 4GB memory and 1Gb/s NIC:</p>
    <p># of managed machines CPU utilization 100 12% 200 21% 300 29%</p>
    <p>Guardians ensure max load is 100</p>
  </div>
  <div class="page">
    <p>GreenUp scales to large subnetsGreenUp scales to large subnets</p>
    <p>Simulated probing load on 2.4GHz, dualcoreSimulated probing load on 2.4 GHz, dual core Windows 7 machine w/ 4GB memory and 1Gb/s NIC:</p>
    <p># of managed machines CPU utilization 100 12% 200 21% 300 29%</p>
    <p>Guardians ensure max load is 100</p>
  </div>
  <div class="page">
    <p>Does GreenUp save more energy?Does GreenUp save more energy?</p>
    <p>Energy savings depends on sleep timeEnergy savings depends on sleep time</p>
  </div>
  <div class="page">
    <p>Does GreenUp save more energy?Does GreenUp save more energy?</p>
    <p>Energy savings depends on sleep timeEnergy savings depends on sleep time</p>
  </div>
  <div class="page">
    <p>Does GreenUp save more energy?Does GreenUp save more energy?</p>
    <p>Energy savings depends on sleep timeEnergy savings depends on sleep time</p>
    <p>Average 31%  $17.50/machine/year</p>
  </div>
  <div class="page">
    <p>Does GreenUp save more energy?Does GreenUp save more energy?</p>
    <p>Energy savings depends on sleep timeEnergy savings depends on sleep time</p>
    <p>IT enforces sleep policy at Microsoft, so hardIT enforces sleep policy at Microsoft, so hard to tell</p>
  </div>
  <div class="page">
    <p>Extension: Higher availability via l l d h d ffexplicit load handoff</p>
    <p>M5</p>
    <p>M8 M9M1</p>
    <p>M2</p>
    <p>M5</p>
    <p>M6 M3</p>
    <p>M6</p>
    <p>M7 M4</p>
    <p>M7</p>
  </div>
  <div class="page">
    <p>Extension: Higher availability via l l d h d ffexplicit load handoff</p>
    <p>M5</p>
    <p>M2</p>
    <p>M5</p>
    <p>M6 M8</p>
    <p>M3 M6</p>
    <p>M7 M9</p>
    <p>M4 M7</p>
    <p>M1</p>
  </div>
  <div class="page">
    <p>Extension: Higher availability via l l d h d ffexplicit load handoff</p>
    <p>M5</p>
    <p>M8 M9M1</p>
    <p>M2</p>
    <p>M5</p>
    <p>M6 M3</p>
    <p>M6</p>
    <p>M7 M4</p>
    <p>M7</p>
  </div>
  <div class="page">
    <p>Extension: Higher availability via l l d h d ffexplicit load handoff</p>
    <p>M5</p>
    <p>M2</p>
    <p>M5</p>
    <p>M6 M3</p>
    <p>M6</p>
    <p>M7 M4</p>
    <p>M7 M8 M9M1</p>
  </div>
  <div class="page">
    <p>Extension: Higher availability via l l d h d ffexplicit load handoff</p>
    <p>+ M5</p>
    <p>M2</p>
    <p>M5</p>
    <p>M6 M3</p>
    <p>M6</p>
    <p>M7 M4</p>
    <p>M7 M8 M9M1</p>
  </div>
  <div class="page">
    <p>Extension: Higher availability via l l d h d ffexplicit load handoff</p>
    <p>+ M5</p>
    <p>Theorem Expected max M2</p>
    <p>M5</p>
    <p>M6  Theorem. Expected max load = n/d  Hd.M3</p>
    <p>M6</p>
    <p>M7 M4</p>
    <p># awake machines</p>
    <p>Harmonic numbers</p>
    <p>M7 M8 M9M1</p>
  </div>
  <div class="page">
    <p>Other solutionsOther solutions</p>
    <p>Sleep proxy idea: Christensen &amp; Gulledge 98Sleep proxy idea: Christensen &amp; Gulledge 98  Recently:</p>
    <p>System Technique Somniloquy, NSDI 09 augmented NICsq y, g LiteGreen, ATC 10 Jettison, EuroSys 12</p>
    <p>VM migration</p>
    <p>SleepServer, ATC 10 application stubs Nedevschi et al., NSDI 08 Reich et al ATC 10</p>
    <p>dedicated servers Reich et al., ATC 10</p>
  </div>
  <div class="page">
    <p>Other solutionsOther solutions</p>
    <p>Sleep proxy idea: Christensen &amp; Gulledge 98Barriers to Sleep proxy idea: Christensen &amp; Gulledge 98  Recently:</p>
    <p>deployment</p>
    <p>System Technique Somniloquy, NSDI 09 augmented NICsq y, g LiteGreen, ATC 10 Jettison, EuroSys 12</p>
    <p>VM migration</p>
    <p>SleepServer, ATC 10 application stubs Nedevschi et al., NSDI 08 Reich et al ATC 10</p>
    <p>dedicated servers Reich et al., ATC 10</p>
  </div>
  <div class="page">
    <p>GreenUpGreenUp</p>
    <p>Completely decentralized softwareonlyCompletely decentralized, software only sleep proxy</p>
    <p>Useful distributed systems techniques</p>
    <p>High availability at low cost, even as machines sleep!machines sleep!</p>
    <p>http://research.microsoft.com/enus/projects/greenup/http://research.microsoft.com/en us/projects/greenup/</p>
  </div>
</Presentation>
