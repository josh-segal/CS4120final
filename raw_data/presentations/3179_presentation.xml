<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>On the Effective Prevention of TLS Man-InThe-Middle Attacks in Web Applications</p>
    <p>Nikos Karapanos and Srdjan apkun, ETH Zurich ! !</p>
    <p>USENIX Security 2014</p>
  </div>
  <div class="page">
    <p>/ 15</p>
    <p>TLS in Web Applications (HTTPS)</p>
    <p>Server authentication is problematic</p>
  </div>
  <div class="page">
    <p>/ 15</p>
    <p>TLS in Web Applications (HTTPS)</p>
    <p>Compromised CAs</p>
    <p>Server authentication is problematic</p>
  </div>
  <div class="page">
    <p>/ 15</p>
    <p>TLS in Web Applications (HTTPS)</p>
    <p>Compromised CAs</p>
    <p>Compromised server keys</p>
    <p>Server authentication is problematic</p>
  </div>
  <div class="page">
    <p>/ 15</p>
    <p>TLS in Web Applications (HTTPS)</p>
    <p>Compromised CAs</p>
    <p>Compromised server keys</p>
    <p>Users click through warnings</p>
    <p>Server authentication is problematic</p>
  </div>
  <div class="page">
    <p>/ 153</p>
    <p>TLS Man-In-The-Middle (MITM)</p>
    <p>Server impersonation</p>
    <p>Goal: Compromise user account</p>
    <p>*Some of the icons used in this presentation were taken and adapted from opensecurityarchitecture.org</p>
  </div>
  <div class="page">
    <p>/ 153</p>
    <p>TLS Man-In-The-Middle (MITM)</p>
    <p>TLSTLS</p>
    <p>Server impersonation</p>
    <p>Goal: Compromise user account</p>
    <p>*Some of the icons used in this presentation were taken and adapted from opensecurityarchitecture.org</p>
  </div>
  <div class="page">
    <p>/ 153</p>
    <p>TLS Man-In-The-Middle (MITM)</p>
    <p>TLSTLS</p>
    <p>Server impersonation User impersonation</p>
    <p>Goal: Compromise user account</p>
    <p>*Some of the icons used in this presentation were taken and adapted from opensecurityarchitecture.org</p>
  </div>
  <div class="page">
    <p>/ 153</p>
    <p>TLS Man-In-The-Middle (MITM)</p>
    <p>TLSTLS</p>
    <p>Server impersonation User impersonation</p>
    <p>Goal: Compromise user account</p>
    <p>*Some of the icons used in this presentation were taken and adapted from opensecurityarchitecture.org</p>
    <p>TLS Channel IDs (Balfanz et al., IETF Internet Draft) proposed as a solution</p>
  </div>
  <div class="page">
    <p>/ 15</p>
    <p>Main Contributions</p>
  </div>
  <div class="page">
    <p>/ 15</p>
    <p>Main Contributions</p>
  </div>
  <div class="page">
    <p>/ 15</p>
    <p>Main Contributions</p>
  </div>
  <div class="page">
    <p>/ 15</p>
    <p>TLS HTTP</p>
    <p>TLS HTTP</p>
    <p>Solutions focus on either endpoint</p>
    <p>Preventing TLS MITM: Overview</p>
  </div>
  <div class="page">
    <p>/ 15</p>
    <p>TLS HTTP</p>
    <p>TLS HTTP</p>
    <p>Solutions focus on either endpoint</p>
    <p>Preventing TLS MITM: Overview</p>
    <p>Pinning, multipath probing</p>
    <p>Prevent server impersonation</p>
  </div>
  <div class="page">
    <p>/ 15</p>
    <p>TLS HTTP</p>
    <p>TLS HTTP</p>
    <p>Solutions focus on either endpoint</p>
    <p>Preventing TLS MITM: Overview</p>
    <p>TLS Channel ID-based authentication</p>
    <p>Prevent user impersonation</p>
  </div>
  <div class="page">
    <p>/ 15</p>
    <p>Channel ID = public key of a private/public key pair</p>
    <p>TLS Channel ID-Based Client Authentication</p>
    <p>, : TLS Channel IDs</p>
    <p>www.example.com</p>
  </div>
  <div class="page">
    <p>/ 15</p>
    <p>Channel ID = public key of a private/public key pair</p>
    <p>TLS Channel ID-Based Client Authentication</p>
    <p>TLS</p>
    <p>, : TLS Channel IDs</p>
    <p>Here is my channel ID , signed with the corresponding private key</p>
    <p>www.example.com</p>
  </div>
  <div class="page">
    <p>/ 15</p>
    <p>Channel ID = public key of a private/public key pair</p>
    <p>TLS Channel ID-Based Client Authentication</p>
    <p>TLS</p>
    <p>, : TLS Channel IDs</p>
    <p>www.example.com</p>
  </div>
  <div class="page">
    <p>/ 15</p>
    <p>Channel ID = public key of a private/public key pair</p>
    <p>TLS Channel ID-Based Client Authentication</p>
    <p>, : TLS Channel IDs</p>
    <p>www.example.com</p>
  </div>
  <div class="page">
    <p>/ 15</p>
    <p>TLS</p>
    <p>Channel ID = public key of a private/public key pair</p>
    <p>TLS Channel ID-Based Client Authentication</p>
    <p>, : TLS Channel IDs</p>
    <p>Here is my channel ID , signed with the corresponding private key</p>
    <p>www.example.com</p>
  </div>
  <div class="page">
    <p>/ 15</p>
    <p>A Channel ID identifies the same TLS channel across different TLS connections</p>
    <p>TLS</p>
    <p>Channel ID = public key of a private/public key pair</p>
    <p>TLS Channel ID-Based Client Authentication</p>
    <p>, : TLS Channel IDs</p>
    <p>www.example.com</p>
  </div>
  <div class="page">
    <p>/ 15</p>
    <p>TLS</p>
    <p>A Channel ID identifies the same TLS channel across different TLS connections</p>
    <p>TLS</p>
    <p>Channel ID = public key of a private/public key pair</p>
    <p>TLS Channel ID-Based Client Authentication</p>
    <p>, : TLS Channel IDs</p>
    <p>Here is my channel ID , signed with the corresponding private key</p>
    <p>www.example.com</p>
  </div>
  <div class="page">
    <p>/ 15</p>
    <p>TLS</p>
    <p>A Channel ID identifies the same TLS channel across different TLS connections</p>
    <p>TLS</p>
    <p>Channel ID = public key of a private/public key pair</p>
    <p>TLS Channel ID-Based Client Authentication</p>
    <p>, : TLS Channel IDs</p>
    <p>www.example.com</p>
  </div>
  <div class="page">
    <p>/ 15</p>
    <p>Initial login (first login from a browser)</p>
    <p>TLS Channel ID-Based Client Authentication</p>
    <p>TLS Set-Cookie</p>
    <p>, : TLS Channel IDs</p>
    <p>PhoneAuth (Czeskis et al., CCS 2012), FIDO Alliance U2F draft spec.</p>
    <p>After initial login</p>
  </div>
  <div class="page">
    <p>/ 15</p>
    <p>Initial login (first login from a browser)</p>
    <p>TLS Channel ID-Based Client Authentication</p>
    <p>TLS Set-Cookie</p>
    <p>, : TLS Channel IDs</p>
    <p>Channel-bound cookie</p>
    <p>PhoneAuth (Czeskis et al., CCS 2012), FIDO Alliance U2F draft spec.</p>
    <p>After initial login</p>
  </div>
  <div class="page">
    <p>/ 15</p>
    <p>Initial login (first login from a browser)</p>
    <p>TLS Channel ID-Based Client Authentication</p>
    <p>TLS</p>
    <p>, : TLS Channel IDs</p>
    <p>PhoneAuth (Czeskis et al., CCS 2012), FIDO Alliance U2F draft spec.</p>
    <p>After initial login</p>
  </div>
  <div class="page">
    <p>/ 15</p>
    <p>Initial login (first login from a browser)</p>
    <p>TLS Channel ID-Based Client Authentication</p>
    <p>TLS</p>
    <p>, : TLS Channel IDs</p>
    <p>PhoneAuth (Czeskis et al., CCS 2012), FIDO Alliance U2F draft spec.</p>
    <p>After initial login</p>
  </div>
  <div class="page">
    <p>/ 15</p>
    <p>Initial login (first login from a browser)</p>
    <p>TLS Channel ID-Based Client Authentication</p>
    <p>, : TLS Channel IDs</p>
    <p>PhoneAuth (Czeskis et al., CCS 2012), FIDO Alliance U2F draft spec.</p>
    <p>After initial login</p>
  </div>
  <div class="page">
    <p>/ 15</p>
    <p>Initial login (first login from a browser)</p>
    <p>TLS Channel ID-Based Client Authentication</p>
    <p>TLSTLS</p>
    <p>, : TLS Channel IDs</p>
    <p>PhoneAuth (Czeskis et al., CCS 2012), FIDO Alliance U2F draft spec.</p>
    <p>After initial login</p>
  </div>
  <div class="page">
    <p>/ 15</p>
    <p>Initial login (first login from a browser)</p>
    <p>TLS Channel ID-Based Client Authentication</p>
    <p>TLSTLS</p>
    <p>, : TLS Channel IDs</p>
    <p>Cookie presented over wrong channel!</p>
    <p>PhoneAuth (Czeskis et al., CCS 2012), FIDO Alliance U2F draft spec.</p>
    <p>After initial login</p>
  </div>
  <div class="page">
    <p>/ 15</p>
    <p>Initial login (first login from a browser)</p>
    <p>TLS Channel ID-Based Client Authentication</p>
    <p>TLSTLS</p>
    <p>, : TLS Channel IDs</p>
    <p>Cookie presented over wrong channel!</p>
    <p>PhoneAuth (Czeskis et al., CCS 2012), FIDO Alliance U2F draft spec.</p>
    <p>After initial login</p>
  </div>
  <div class="page">
    <p>/ 15</p>
    <p>MITM-Script-In-The-Browser (MITM-SITB)</p>
    <p>Our Attack</p>
    <p>www.example.comwww.example.com</p>
  </div>
  <div class="page">
    <p>/ 15</p>
    <p>MITM-Script-In-The-Browser (MITM-SITB)</p>
    <p>Our Attack</p>
    <p>TLS</p>
    <p>www.example.comwww.example.com</p>
  </div>
  <div class="page">
    <p>/ 15</p>
    <p>MITM-Script-In-The-Browser (MITM-SITB)</p>
    <p>Our Attack</p>
    <p>TLS</p>
    <p>www.example.comwww.example.com</p>
  </div>
  <div class="page">
    <p>/ 15</p>
    <p>MITM-Script-In-The-Browser (MITM-SITB)</p>
    <p>Our Attack</p>
    <p>TLS &lt;script language=javascript&gt;</p>
    <p>&lt;/script&gt;</p>
    <p>&lt;script language=javascript&gt;</p>
    <p>&lt;/script&gt;</p>
    <p>&lt;script language=javascript&gt;</p>
    <p>&lt;/script&gt;</p>
    <p>www.example.comwww.example.com</p>
  </div>
  <div class="page">
    <p>/ 15</p>
    <p>MITM-Script-In-The-Browser (MITM-SITB)</p>
    <p>Our Attack</p>
    <p>&lt;script language=javascript&gt;</p>
    <p>&lt;/script&gt;</p>
    <p>&lt;script language=javascript&gt;</p>
    <p>&lt;/script&gt;</p>
    <p>&lt;script language=javascript&gt;</p>
    <p>&lt;/script&gt;</p>
    <p>Executed within the target servers web origin</p>
    <p>www.example.comwww.example.com</p>
  </div>
  <div class="page">
    <p>/ 15</p>
    <p>MITM-Script-In-The-Browser (MITM-SITB)</p>
    <p>Our Attack</p>
    <p>TLS &lt;script language=javascript&gt;</p>
    <p>&lt;/script&gt;</p>
    <p>&lt;script language=javascript&gt;</p>
    <p>&lt;/script&gt;</p>
    <p>&lt;script language=javascript&gt;</p>
    <p>&lt;/script&gt;</p>
    <p>Executed within the target servers web origin</p>
    <p>www.example.comwww.example.com</p>
  </div>
  <div class="page">
    <p>/ 15</p>
    <p>MITM-Script-In-The-Browser (MITM-SITB)</p>
    <p>Our Attack</p>
    <p>TLS &lt;script language=javascript&gt;</p>
    <p>&lt;/script&gt;</p>
    <p>&lt;script language=javascript&gt;</p>
    <p>&lt;/script&gt;</p>
    <p>&lt;script language=javascript&gt;</p>
    <p>&lt;/script&gt;</p>
    <p>Executed within the target servers web origin</p>
    <p>www.example.comwww.example.com</p>
  </div>
  <div class="page">
    <p>/ 15</p>
    <p>MITM-Script-in-the-Browser</p>
    <p>MITM-SITB was missed by a number of proposals</p>
  </div>
  <div class="page">
    <p>/ 15</p>
    <p>MITM-Script-in-the-Browser</p>
    <p>TLS Channel IDs (PhoneAuth, FIDO U2F)</p>
    <p>TLS client auth., SSL/TLS session-aware user auth. (Oppliger et al, Computer Communications 2006)</p>
    <p>MITM-SITB was missed by a number of proposals</p>
  </div>
  <div class="page">
    <p>/ 15</p>
    <p>MITM-Script-in-the-Browser</p>
    <p>TLS Channel IDs (PhoneAuth, FIDO U2F)</p>
    <p>TLS client auth., SSL/TLS session-aware user auth. (Oppliger et al, Computer Communications 2006)</p>
    <p>These solutions focus on client authentication but ignore server authentication.</p>
    <p>Attacker impersonates the server and injects malicious but trusted client-side code</p>
    <p>MITM-SITB was missed by a number of proposals</p>
  </div>
  <div class="page">
    <p>/ 15</p>
    <p>MITM-Script-in-the-Browser</p>
    <p>TLS Channel IDs (PhoneAuth, FIDO U2F)</p>
    <p>TLS client auth., SSL/TLS session-aware user auth. (Oppliger et al, Computer Communications 2006)</p>
    <p>These solutions focus on client authentication but ignore server authentication.</p>
    <p>Attacker impersonates the server and injects malicious but trusted client-side code</p>
    <p>MITM-SITB was missed by a number of proposals</p>
    <p>=&gt; we cannot ignore server authentication&quot; But</p>
  </div>
  <div class="page">
    <p>/ 1510</p>
    <p>Do we really need server authentication?</p>
    <p>Insight</p>
  </div>
  <div class="page">
    <p>/ 1510</p>
    <p>Do we really need server authentication?</p>
    <p>Insight</p>
  </div>
  <div class="page">
    <p>/ 1510</p>
    <p>Do we really need server authentication?</p>
    <p>Conventional MITM prevented by Channel ID-based</p>
    <p>client auth.</p>
    <p>Insight</p>
  </div>
  <div class="page">
    <p>/ 1510</p>
    <p>Do we really need server authentication?</p>
    <p>Conventional MITM prevented by Channel ID-based</p>
    <p>client auth.</p>
    <p>Insight</p>
    <p>&lt;script language=javascript&gt;</p>
    <p>&lt;/script&gt;</p>
    <p>&lt;script language=javascript&gt;</p>
    <p>&lt;/script&gt;</p>
    <p>&lt;script language=javascript&gt;</p>
    <p>&lt;/script&gt;</p>
  </div>
  <div class="page">
    <p>/ 1510</p>
    <p>Do we really need server authentication?</p>
    <p>Conventional MITM prevented by Channel ID-based</p>
    <p>client auth.</p>
    <p>MITM-SITB needs the browser to connect to two different entities</p>
    <p>Insight</p>
    <p>&lt;script language=javascript&gt;</p>
    <p>&lt;/script&gt;</p>
    <p>&lt;script language=javascript&gt;</p>
    <p>&lt;/script&gt;</p>
    <p>&lt;script language=javascript&gt;</p>
    <p>&lt;/script&gt;</p>
  </div>
  <div class="page">
    <p>/ 1510</p>
    <p>Do we really need server authentication?</p>
    <p>Conventional MITM prevented by Channel ID-based</p>
    <p>client auth.</p>
    <p>MITM-SITB needs the browser to connect to two different entities</p>
    <p>Insight</p>
    <p>&lt;script language=javascript&gt;</p>
    <p>&lt;/script&gt;</p>
    <p>&lt;script language=javascript&gt;</p>
    <p>&lt;/script&gt;</p>
    <p>&lt;script language=javascript&gt;</p>
    <p>&lt;/script&gt;</p>
  </div>
  <div class="page">
    <p>/ 1510</p>
    <p>Do we really need server authentication?</p>
    <p>Conventional MITM prevented by Channel ID-based</p>
    <p>client auth.</p>
    <p>MITM-SITB needs the browser to connect to two different entities</p>
    <p>Insight</p>
    <p>&lt;script language=javascript&gt;</p>
    <p>&lt;/script&gt;</p>
    <p>&lt;script language=javascript&gt;</p>
    <p>&lt;/script&gt;</p>
    <p>&lt;script language=javascript&gt;</p>
    <p>&lt;/script&gt;</p>
  </div>
  <div class="page">
    <p>/ 1510</p>
    <p>Do we really need server authentication?</p>
    <p>Conventional MITM prevented by Channel ID-based</p>
    <p>client auth.</p>
    <p>MITM-SITB needs the browser to connect to two different entities</p>
    <p>Insight</p>
    <p>&lt;script language=javascript&gt;</p>
    <p>&lt;/script&gt;</p>
    <p>&lt;script language=javascript&gt;</p>
    <p>&lt;/script&gt;</p>
    <p>&lt;script language=javascript&gt;</p>
    <p>&lt;/script&gt;</p>
    <p>OUR PROPOSAL:&quot; ensure that the browser does not</p>
    <p>connect to different entities!</p>
  </div>
  <div class="page">
    <p>/ 1511</p>
    <p>This Invariance is Enforced by the Browser</p>
    <p>www.example.com</p>
    <p>www.example.com</p>
  </div>
  <div class="page">
    <p>/ 1511</p>
    <p>This Invariance is Enforced by the Browser</p>
    <p>TLS</p>
    <p>TLS</p>
    <p>www.example.com</p>
    <p>www.example.com</p>
  </div>
  <div class="page">
    <p>/ 1511</p>
    <p>This Invariance is Enforced by the Browser</p>
    <p>www.example.com</p>
    <p>www.example.com</p>
  </div>
  <div class="page">
    <p>/ 1511</p>
    <p>This Invariance is Enforced by the Browser</p>
    <p>TLS</p>
    <p>TLS</p>
    <p>www.example.com</p>
    <p>www.example.com</p>
  </div>
  <div class="page">
    <p>/ 1511</p>
    <p>This Invariance is Enforced by the Browser</p>
    <p>www.example.com</p>
    <p>www.example.com</p>
  </div>
  <div class="page">
    <p>/ 1511</p>
    <p>This Invariance is Enforced by the Browser</p>
    <p>TLS</p>
    <p>www.example.com</p>
    <p>www.example.com</p>
  </div>
  <div class="page">
    <p>/ 1511</p>
    <p>This Invariance is Enforced by the Browser</p>
    <p>www.example.com</p>
    <p>www.example.com</p>
    <p>TLS</p>
  </div>
  <div class="page">
    <p>/ 1512</p>
    <p>Example of Realizing Server Invariance</p>
    <p>www.example.com</p>
  </div>
  <div class="page">
    <p>/ 1512</p>
    <p>Example of Realizing Server Invariance</p>
    <p>TLS</p>
    <p>Init, rb</p>
    <p>rs</p>
    <p>rb rs store: [ , rb, rs]</p>
    <p>www.example.com</p>
    <p>store: [rb, rs]</p>
  </div>
  <div class="page">
    <p>/ 1512</p>
    <p>Example of Realizing Server Invariance</p>
    <p>TLS</p>
    <p>TLS</p>
    <p>Init, rb</p>
    <p>rs</p>
    <p>Verify, rb</p>
    <p>rs  rs</p>
    <p>rb rs</p>
    <p>lookup: rs from [ , rb]</p>
    <p>store: [ , rb, rs]</p>
    <p>rs</p>
    <p>www.example.com</p>
    <p>store: [rb, rs]</p>
  </div>
  <div class="page">
    <p>/ 15</p>
    <p>Important Insight</p>
    <p>TLS MITM prevention</p>
  </div>
  <div class="page">
    <p>/ 15</p>
    <p>Important Insight</p>
    <p>TLS MITM prevention</p>
    <p>Server authentication+Weak client authentication passwords, conventional HTTP</p>
    <p>cookies, OTP,  certificate pinning, certificate</p>
    <p>transparency,</p>
  </div>
  <div class="page">
    <p>/ 15</p>
    <p>Important Insight</p>
    <p>TLS MITM prevention</p>
    <p>Server authentication+</p>
    <p>Server invariance+</p>
    <p>Weak client authentication</p>
    <p>Strong client authentication</p>
    <p>passwords, conventional HTTP cookies, OTP,</p>
    <p>certificate pinning, certificate transparency,</p>
    <p>Channel ID-based (FIDO U2F, channel-bound cookies),</p>
  </div>
  <div class="page">
    <p>/ 15</p>
    <p>Important Insight</p>
    <p>TLS MITM prevention</p>
    <p>Server authentication+</p>
    <p>Server invariance+</p>
    <p>Weak client authentication</p>
    <p>Strong client authentication</p>
    <p>passwords, conventional HTTP cookies, OTP,</p>
    <p>certificate pinning, certificate transparency,</p>
    <p>Channel ID-based (FIDO U2F, channel-bound cookies), SISCA</p>
  </div>
  <div class="page">
    <p>/ 15</p>
    <p>Summary</p>
  </div>
  <div class="page">
    <p>/ 15</p>
    <p>Summary</p>
    <p>In web, servers can ask clients to execute arbitrary code - needs to be taken into account in protocol and system analysis</p>
    <p>TLS Channel IDs vulnerable to MITM-SITB attacks</p>
  </div>
  <div class="page">
    <p>/ 15</p>
    <p>Summary</p>
    <p>In web, servers can ask clients to execute arbitrary code - needs to be taken into account in protocol and system analysis</p>
    <p>TLS Channel IDs vulnerable to MITM-SITB attacks</p>
    <p>To prevent MITM attacks we need either: - server authentication or - server invariance with Channel ID-based client authentication</p>
    <p>Server invariance is easier to achieve than server authentication =&gt; we propose SISCA: Server Invariance with Strong Client Authentication</p>
  </div>
  <div class="page">
    <p>Thank you for your attention! Any Questions?</p>
    <p>! knikos@inf.ethz.ch</p>
  </div>
</Presentation>
