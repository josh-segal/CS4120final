<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>BotMiner: Clustering Analysis of Network Traffic for</p>
    <p>Protocol- and Structure-Independent Botnet Detection</p>
    <p>Guofei Gu1,2, Roberto Perdisci3, Junjie Zhang1, and Wenke Lee1</p>
  </div>
  <div class="page">
    <p>Roadmap</p>
    <p>Introduction  Botnet problem  Challenges for botnet detection  Related work</p>
    <p>BotMiner  Motivation  Design  Evaluation</p>
    <p>Conclusion</p>
    <p>Roadmap</p>
  </div>
  <div class="page">
    <p>What Is a Bot/Botnet?</p>
    <p>Bot  A malware instance that runs autonomously and automatically on</p>
    <p>a compromised computer (zombie) without owners consent  Profit-driven, professionally written, widely propagated</p>
    <p>Botnet (Bot Army): network of bots controlled by criminals  Definition: A coordinated group of malware instances that are</p>
    <p>controlled by a botmaster via some C&amp;C channel  Architecture: centralized (e.g., IRC,HTTP), distributed (e.g., P2P)  25% of Internet PCs are part of a botnet! ( - Vint Cerf)</p>
    <p>bot</p>
    <p>C&amp;C</p>
    <p>Botmaster</p>
    <p>Introduction BotMiner</p>
    <p>Conclusion</p>
    <p>Botnet Problem Challenges for Botnet Detection Related Work</p>
  </div>
  <div class="page">
    <p>Botnets are used for</p>
    <p>All DDoS attacks  Spam  Click fraud  Information theft  Phishing attacks  Distributing other malware, e.g., spyware</p>
    <p>Introduction BotMiner</p>
    <p>Conclusion</p>
    <p>Botnet Problem Challenges for Botnet Detection Related Work</p>
  </div>
  <div class="page">
    <p>Challenges for Botnet Detection</p>
    <p>Bots are stealthy on the infected machines  We focus on a network-based solution</p>
    <p>Bot infection is usually a multi-faceted and multiphased process  Only looking at one specific aspect likely to fail</p>
    <p>Bots are dynamically evolving  Static and signature-based approaches may not be</p>
    <p>effective</p>
    <p>Botnets can have very flexible design of C&amp;C channels  A solution very specific to a botnet instance is not</p>
    <p>desirable</p>
    <p>Botnet Problem Challenges for Botnet Detection Related Work</p>
    <p>Introduction BotMiner</p>
    <p>Conclusion</p>
  </div>
  <div class="page">
    <p>Why Existing Techniques Not Enough?</p>
    <p>Traditional AV tools  Bots use packer, rootkit, frequent updating to</p>
    <p>easily defeat AV tools</p>
    <p>Traditional IDS/IPS  Look at only specific aspect  Do not have a big picture</p>
    <p>Honeypot  Not a good botnet detection tool</p>
    <p>Introduction BotMiner</p>
    <p>Conclusion</p>
    <p>Botnet Problem Challenges for Botnet Detection Related Work</p>
  </div>
  <div class="page">
    <p>Existing Botnet Detection Work</p>
    <p>[Binkley,Singh 2006]: IRC-based bot detection combine IRC statistics and TCP work weight</p>
    <p>Rishi [Goebel, Holz 2007]: signature-based IRC bot nickname detection</p>
    <p>[Livadas et al. 2006, Karasaridis et al. 2007]: (BBN, AT&amp;T) network flow level detection of IRC botnets (IRC botnet)</p>
    <p>BotHunter [Gu etal Security07]: dialog correlation to detect bots based on an infection dialog model</p>
    <p>BotSniffer [Gu etal NDSS08]: spatial-temporal correlation to detect centralized botnet C&amp;C</p>
    <p>TAMD [Yen, Reiter 2008]: traffic aggregation to detect botnets that use a centralized C&amp;C structure</p>
    <p>Botnet Problem Challenges for Botnet Detection Related Work</p>
    <p>Introduction BotMiner</p>
    <p>Conclusion</p>
  </div>
  <div class="page">
    <p>Why BotMiner?</p>
    <p>Botnets can change their C&amp;C content (encryption, etc.), protocols (IRC, HTTP, etc.), structures (P2P, etc.), C&amp;C servers, infection models</p>
    <p>Introduction BotMiner Conclusion</p>
    <p>Motivation Design Evaluation</p>
    <p>Example: Nugache, Storm,</p>
  </div>
  <div class="page">
    <p>BotMiner: Protocol- and Structure-Independent Detection</p>
    <p>Enterprise-like Network</p>
    <p>Horizontal correlation - Bots are for long-term use - Botnet: communication and activities are coordinated/similar</p>
    <p>Introduction BotMiner Conclusion</p>
    <p>Motivation Design Evaluation</p>
    <p>Internet</p>
  </div>
  <div class="page">
    <p>Revisit the Definition of a Botnet</p>
    <p>A coordinated group of malware instances that are controlled by a botmaster via some C&amp;C channel</p>
    <p>We need to monitor two planes  C-plane (C&amp;C communication plane): who is talking</p>
    <p>to whom  A-plane (malicious activity plane): who is doing what</p>
    <p>Introduction BotMiner Conclusion</p>
    <p>Motivation Design Evaluation</p>
  </div>
  <div class="page">
    <p>BotMiner Architecture</p>
    <p>Introduction BotMiner Conclusion</p>
    <p>Motivation Design Evaluation</p>
  </div>
  <div class="page">
    <p>BotMiner C-plane Clustering</p>
    <p>What characterizes a communication flow (Cflow) between a local host and a remote service?  &lt;protocol, srcIP, dstIP, dstPort&gt;</p>
    <p>Introduction BotMiner Conclusion</p>
    <p>Motivation Design Evaluation</p>
  </div>
  <div class="page">
    <p>How to Capture Talking in What Kind of Patterns?</p>
    <p>Temporal related statistical distribution information in  BPS (bytes per</p>
    <p>second)  FPH (flow per hour)</p>
    <p>Spatial related statistical distribution information in  BPP (bytes per packet)  PPF (packet per flow)</p>
    <p>Introduction BotMiner Conclusion</p>
    <p>Motivation Design Evaluation</p>
  </div>
  <div class="page">
    <p>Two-step Clustering of C-flows  Why multi-step?</p>
    <p>How?  Coarse-grained clustering</p>
    <p>Using reduced feature space: mean and variance of the distribution of FPH, PPF, BPP, BPS for each C-flow (2*4=8)</p>
    <p>Efficient clustering algorithm: X-means</p>
    <p>Fine-grained clustering  Using full feature space (13*4=52)</p>
    <p>Whats left?</p>
    <p>Introduction BotMiner Conclusion</p>
    <p>Motivation Design Evaluation</p>
  </div>
  <div class="page">
    <p>A-plane Clustering</p>
    <p>Capture activities in what kind of patterns</p>
    <p>Introduction BotMiner Conclusion</p>
    <p>Motivation Design Evaluation</p>
  </div>
  <div class="page">
    <p>Cross-plane Correlation</p>
    <p>Botnet score s(h) for every host h</p>
    <p>Similarity score between host hi and hj</p>
    <p>Hierarchical clustering</p>
    <p>Ai Aj</p>
    <p>Two hosts in the same A-clusters and in at least one common C-cluster are clustered together</p>
    <p>Introduction BotMiner Conclusion</p>
    <p>Motivation Design Evaluation</p>
  </div>
  <div class="page">
    <p>Evaluation Traces</p>
    <p>Introduction BotMiner Conclusion</p>
    <p>Motivation Design</p>
    <p>Evaluation</p>
  </div>
  <div class="page">
    <p>Evaluation Results: False Positives</p>
    <p>Introduction BotMiner Conclusion</p>
    <p>Motivation Design</p>
    <p>Evaluation</p>
  </div>
  <div class="page">
    <p>Evaluation Results: Detection Rate</p>
    <p>Introduction BotMiner Conclusion</p>
    <p>Motivation Design</p>
    <p>Evaluation</p>
  </div>
  <div class="page">
    <p>Summary and Future Work</p>
    <p>BotMiner  New botnet detection system based on Horizontal</p>
    <p>correlation  Independent of botnet C&amp;C protocol and structure  Real-world evaluation shows promising results</p>
    <p>Future work  More efficient clustering, more robust features  New faster detection system using active techniques</p>
    <p>BotMiner: offline correlation, and requires a relatively long time for detection</p>
    <p>BotProbe: fast detection by observing at most one round of C&amp;C</p>
    <p>New real-time solution for very high speed and very large networks</p>
    <p>Introduction BotMiner</p>
    <p>Conclusion</p>
    <p>Summary &amp; Future Work</p>
    <p>Correlation-based Botnet Detection Framework</p>
  </div>
  <div class="page">
    <p>Correlation-based Botnet Detection Framework</p>
    <p>Internet</p>
    <p>Enterprise-like Network</p>
    <p>Horizontal Correlation</p>
    <p>Vertical Correlation</p>
    <p>BotHunter (Security07)</p>
    <p>BotSniffer (NDSS08)</p>
    <p>BotMiner (Security08)Cause-Effect</p>
    <p>Correlation</p>
    <p>BotProbe</p>
    <p>Time</p>
    <p>Introduction BotMiner</p>
    <p>Conclusion</p>
    <p>Summary &amp; Future Work</p>
    <p>Correlation-based Botnet Detection Framework</p>
  </div>
  <div class="page">
    <p>Limitation and Discussion</p>
    <p>Evading C-plane monitoring and clustering  Misuse whitelist  Manipulate communication patterns</p>
    <p>Evading A-plane monitoring and clustering  Very stealthy activity</p>
    <p>Individualize bots communication/activity</p>
    <p>Evading cross-plane analysis  Extremely delayed task</p>
    <p>Appendix</p>
  </div>
</Presentation>
