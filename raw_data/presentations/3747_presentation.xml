<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Phong Q. NguyPhong Q. Nguyn n (cole normale suprieure)(cole normale suprieure)</p>
    <p>Oded Regev Oded Regev (Tel Aviv University)(Tel Aviv University)</p>
    <p>Learning a Parallelepiped:Learning a Parallelepiped: Cryptanalysis of Cryptanalysis of GGH and NTRU GGH and NTRU SignaturesSignatures</p>
  </div>
  <div class="page">
    <p>OutlineOutline</p>
    <p>Introduction to lattices Lattice-based signature schemes The attack</p>
  </div>
  <div class="page">
    <p>Basis: Basis:</p>
    <p>vv11,,v,,vnn vectors in R vectors in Rnn</p>
    <p>The lattice L is The lattice L is</p>
    <p>L={aL={a11vv11++a++annvvnn| a| ai i integers}integers}</p>
    <p>LatticesLattices</p>
    <p>v1 v2</p>
  </div>
  <div class="page">
    <p>Basis is not uniqueBasis is not unique</p>
    <p>v2</p>
    <p>v1</p>
    <p>v1</p>
    <p>v2</p>
  </div>
  <div class="page">
    <p>CVP: Given a lattice and a target vector, find the CVP: Given a lattice and a target vector, find the closest lattice pointclosest lattice point</p>
    <p>Seems very difficult; best algorithms take time 2Seems very difficult; best algorithms take time 2nn  However, checking if a point is However, checking if a point is inin a lattice is easy a lattice is easy</p>
    <p>Closest Vector Problem (CVPClosest Vector Problem (CVP((</p>
    <p>v2</p>
    <p>v1</p>
    <p>uu</p>
  </div>
  <div class="page">
    <p>Babais algorithm: given a point u, writeBabais algorithm: given a point u, write</p>
    <p>and output and output</p>
    <p>Works well for good basesWorks well for good bases</p>
    <p>Babais CVP AlgorithmBabais CVP Algorithm</p>
  </div>
  <div class="page">
    <p>Babais CVP AlgorithmBabais CVP Algorithm</p>
  </div>
  <div class="page">
    <p>Babais CVP AlgorithmBabais CVP Algorithm</p>
  </div>
  <div class="page">
    <p>Lattice-based CryptographyLattice-based Cryptography</p>
    <p>One-way functions based on worst-case One-way functions based on worst-case hardness hardness [Ajtai96, GoldreichGoldwasserHalevi96, [Ajtai96, GoldreichGoldwasserHalevi96, CaiNerurkar97, MicciancioRegev04]CaiNerurkar97, MicciancioRegev04]</p>
    <p>Public-key cryptosystems based on worst-case Public-key cryptosystems based on worst-case hardness [hardness [AjtaiDwork97, GoldreichGoldwasserHalevi97, AjtaiDwork97, GoldreichGoldwasserHalevi97, Regev04, Regev06Regev04, Regev06]]  Other public-key cryptosystems Other public-key cryptosystems</p>
    <p>[[GoldreichGoldwasserHalevi97, HoffsteinPipherSilverman98]GoldreichGoldwasserHalevi97, HoffsteinPipherSilverman98]</p>
    <p>Signature schemesSignature schemes  GGH GGH [GoldreichGoldwasserHalevi97],[GoldreichGoldwasserHalevi97],  NTRUsign NTRUsign</p>
    <p>[HoffsteinHowgraveGrahamPipherSilvermanWhyte01[HoffsteinHowgraveGrahamPipherSilvermanWhyte01]]</p>
  </div>
  <div class="page">
    <p>Signature SchemesSignature Schemes</p>
    <p>Consists ofConsists of::  Key generation algorithm:Key generation algorithm: produces a produces a</p>
    <p>(public-key,private-key) pair(public-key,private-key) pair  Signing algorithm: Signing algorithm: given a message given a message</p>
    <p>and a private-key, produces a signatureand a private-key, produces a signature  Verification algorithm: Verification algorithm: given a given a</p>
    <p>message+signature and a public key, message+signature and a public key, verifies that the signature matchesverifies that the signature matches</p>
  </div>
  <div class="page">
    <p>The GGH Signature SchemeThe GGH Signature Scheme  Idea: CVP is hard, but easy with good basisIdea: CVP is hard, but easy with good basis  The scheme:The scheme:</p>
    <p>Key generation algorithm: Key generation algorithm: choose a lattice with some choose a lattice with some good basis good basis</p>
    <p>Private-key = good basisPrivate-key = good basis  Public-key = bad basisPublic-key = bad basis</p>
    <p>Signing algorithm: Signing algorithm: given a message and a private key,given a message and a private key,  Map message to a point in space Map message to a point in space  Apply Babais algorithm with good basis to obtain the Apply Babais algorithm with good basis to obtain the</p>
    <p>signature signature  Verification algorithm: Verification algorithm: given message+signature and given message+signature and</p>
    <p>a public key, verify that a public key, verify that  Signature is a lattice point, andSignature is a lattice point, and  Signature is close to the messageSignature is close to the message</p>
  </div>
  <div class="page">
    <p>GGH Signature SchemeGGH Signature Scheme</p>
    <p>Private-keyPrivate-key::</p>
    <p>Public-key:Public-key:</p>
    <p>Message:Message:</p>
    <p>Signature:Signature:</p>
  </div>
  <div class="page">
    <p>GGH Signature SchemeGGH Signature Scheme</p>
    <p>Public-key:Public-key:</p>
    <p>Message:Message:</p>
    <p>Signature:Signature:</p>
    <p>Verification: 1. should be a lattice pointVerification: 1. should be a lattice point 2. distance between and should be small2. distance between and should be small</p>
  </div>
  <div class="page">
    <p>The NTRUsign Signature SchemeThe NTRUsign Signature Scheme  Essentially a very efficient implementation Essentially a very efficient implementation</p>
    <p>of the GGH signature schemeof the GGH signature scheme  Signature length only 1757 bitsSignature length only 1757 bits  Signing and verification are faster than RSA-Signing and verification are faster than RSA</p>
    <p>based methodsbased methods  Based on the NTRU lattices (bicyclic lattices Based on the NTRU lattices (bicyclic lattices</p>
    <p>generated from a polynomial ring)generated from a polynomial ring)  Developed by the company NTRU and Developed by the company NTRU and</p>
    <p>currently under consideration by IEEE currently under consideration by IEEE P1363.1P1363.1</p>
    <p>Some flaws pointed out in [GentrySzydlo02]Some flaws pointed out in [GentrySzydlo02]</p>
  </div>
  <div class="page">
    <p>Main ResultMain Result</p>
    <p>An inherent security flaw in GGH-based signature An inherent security flaw in GGH-based signature schemesschemes</p>
    <p>Demonstrated a practical attack on:Demonstrated a practical attack on:  GGH GGH</p>
    <p>Up to dimension 400Up to dimension 400  NTRUsign NTRUsign</p>
    <p>Dimension 502 Dimension 502  Applies to half of the parameter sets in IEEE P1363.1Applies to half of the parameter sets in IEEE P1363.1  Only 400 signatures needed!Only 400 signatures needed!</p>
    <p>The attack recovers the The attack recovers the private keyprivate key</p>
    <p>Running time is a few Running time is a few minutes on a 2Ghz/2GB PCminutes on a 2Ghz/2GB PC</p>
  </div>
  <div class="page">
    <p>Main ResultMain Result</p>
    <p>Possible countermeasures:Possible countermeasures:  Pertubations, as suggested by NTRU in Pertubations, as suggested by NTRU in</p>
    <p>several of the IEEE P1363.1 parameter setsseveral of the IEEE P1363.1 parameter sets  Larger entries in private keyLarger entries in private key  It is not clear if the attack can be extended to It is not clear if the attack can be extended to</p>
    <p>deal with these extensionsdeal with these extensions</p>
    <p>Public key encryption schemes and one-Public key encryption schemes and oneway functions are still secure!!way functions are still secure!!  This includes all schemes based on worst-This includes all schemes based on worst</p>
    <p>case hardness and NTRUencryptcase hardness and NTRUencrypt</p>
  </div>
  <div class="page"/>
  <div class="page">
    <p>The AttackThe Attack</p>
  </div>
  <div class="page">
    <p>So it is enough to solve the following So it is enough to solve the following problem:problem:</p>
    <p>This would enable us to This would enable us to recover the private keyrecover the private key</p>
    <p>Hidden Parallelepiped Hidden Parallelepiped ProblemProblem</p>
    <p>Given points sampled uniformly Given points sampled uniformly from an n-dimensional centered from an n-dimensional centered parallelepiped, recover the parallelepiped, recover the parallelepipedparallelepiped</p>
    <p>Given points sampled uniformly Given points sampled uniformly from an n-dimensional centered from an n-dimensional centered parallelepiped, recover the parallelepiped, recover the parallelepipedparallelepiped</p>
  </div>
  <div class="page">
    <p>Lets try to solve an easier problem:Lets try to solve an easier problem:</p>
    <p>We will later reduce the We will later reduce the general case to the general case to the hypercubehypercube</p>
    <p>Hidden Hypercube ProblemHidden Hypercube Problem</p>
    <p>Given points sampled uniformly Given points sampled uniformly from an n-dimensional centered unit from an n-dimensional centered unit hypercube, recover the hypercubehypercube, recover the hypercube</p>
    <p>Given points sampled uniformly Given points sampled uniformly from an n-dimensional centered unit from an n-dimensional centered unit hypercube, recover the hypercubehypercube, recover the hypercube</p>
  </div>
  <div class="page">
    <p>For a unit vector u define the variance in the For a unit vector u define the variance in the direction u as direction u as</p>
    <p>Perhaps by computing Var(u) for many us we Perhaps by computing Var(u) for many us we can learn somethingcan learn something</p>
    <p>HHP: First AttemptHHP: First Attempt</p>
    <p>The samples x can be written asThe samples x can be written as for y chosen uniformly from [-1,1]for y chosen uniformly from [-1,1]n n and an and an orthogonal matrix Uorthogonal matrix U</p>
    <p>Therefore,Therefore,</p>
  </div>
  <div class="page">
    <p>So lets try the fourth moment instead:So lets try the fourth moment instead:</p>
    <p>A short calculation shows that A short calculation shows that</p>
    <p>where uwhere uii are us coordinates in the hypercube are us coordinates in the hypercube basisbasis</p>
    <p>Therefore:Therefore:  In direction of the corners In direction of the corners</p>
    <p>the kurtosis is ~1/3 the kurtosis is ~1/3  In direction of the faces In direction of the faces</p>
    <p>the kurtosis is 1/5the kurtosis is 1/5</p>
    <p>HHP: Second AttemptHHP: Second Attempt</p>
  </div>
  <div class="page">
    <p>The algorithm repeats the following steps:The algorithm repeats the following steps:</p>
    <p>Choose a random unit vector Choose a random unit vector uu  Perform a gradient descent on the Perform a gradient descent on the</p>
    <p>sphere to find a local minimum of Kur(u)sphere to find a local minimum of Kur(u)  Output the resulting Output the resulting</p>
    <p>vectorvector</p>
    <p>Each application randomly Each application randomly yields one of the 2n yields one of the 2n face vectors face vectors</p>
    <p>HHP: The AlgorithmHHP: The Algorithm</p>
  </div>
  <div class="page">
    <p>Now the samples can be written asNow the samples can be written as where y is chosen uniformly from [-1,1]where y is chosen uniformly from [-1,1]nn</p>
    <p>and R is some matrix and R is some matrix  Consider the average of the matrix xxConsider the average of the matrix xxTT</p>
    <p>Hence, we can get an approximation of Hence, we can get an approximation of S=RRS=RRT T (the Gram matrix of R)(the Gram matrix of R)</p>
    <p>Now the matrix SNow the matrix S-1/2-1/2R is orthogonal:R is orthogonal:</p>
    <p>Back to HPPBack to HPP</p>
  </div>
  <div class="page">
    <p>Hence, by applying the transformation Hence, by applying the transformation SS-1/21/2 to our samples x, we obtain samples to our samples x, we obtain samples from a unit hypercube, so were back to from a unit hypercube, so were back to HCPHCP</p>
    <p>In other words, we have morphed a In other words, we have morphed a parallelepiped into a hypercube:parallelepiped into a hypercube:</p>
    <p>Now run the HHP algorithm on the Now run the HHP algorithm on the samples samples SS-1/2-1/2x. If U is the returned x. If U is the returned matrix, return Smatrix, return S1/21/2U as the U as the parallelepiped.parallelepiped.</p>
    <p>Back to HPPBack to HPP</p>
  </div>
  <div class="page">
    <p>The HPP has already been looked at:The HPP has already been looked at:  In statistical analysis, and in In statistical analysis, and in</p>
    <p>particular Independent Component particular Independent Component Analysis (ICA). The FastICA algorithm Analysis (ICA). The FastICA algorithm is very similar to ours is very similar to ours [HyvrinenOja97][HyvrinenOja97]. Many applications in . Many applications in signal processing, neural networks, signal processing, neural networks, etc.etc.</p>
    <p>In the computational learning In the computational learning community, by [community, by [FriezeJerrumKannan96FriezeJerrumKannan96]. ]. A somewhat different algorithm.A somewhat different algorithm.</p>
    <p>However, none gives a rigorous However, none gives a rigorous analysis. We analyze the algorithm analysis. We analyze the algorithm rigorously, taking into account the rigorously, taking into account the effects of noiseeffects of noise</p>
    <p>Were not aloneWere not alone</p>
  </div>
  <div class="page">
    <p>Open questionsOpen questions</p>
    <p>Any provably secure lattice-based Any provably secure lattice-based signature schemes?signature schemes?</p>
    <p>Can the attack be extended to deal with Can the attack be extended to deal with the countermeasures?the countermeasures?</p>
    <p>+ =</p>
  </div>
  <div class="page">
    <p>Thanks !!Thanks !!</p>
  </div>
</Presentation>
