<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>ASM: A Programmable Interface for Extending Android Security</p>
    <p>Stephan Heuser,</p>
    <p>Ahmad-Reza Sadeghi</p>
    <p>Intel Collaborative Research Institute for</p>
    <p>Secure Computing at TU Darmstadt,</p>
    <p>Germany</p>
    <p>Adwait Nadkarni,</p>
    <p>William Enck</p>
    <p>NC State University, USA</p>
  </div>
  <div class="page">
    <p>Android Security Extensions (selected)</p>
    <p>Security extensions focus on specific use cases and/or security and privacy models</p>
    <p>Contextbased Apps</p>
    <p>CRePE, ConXSense</p>
    <p>Privacy TaintDroid, AppFence, MockDroid</p>
    <p>Type Enforcement</p>
    <p>SEAndroid, FlaskDroid</p>
    <p>FineGrained</p>
    <p>Permissions APEX, CRePE</p>
    <p>Permission Constraints</p>
    <p>Kirin</p>
    <p>App Communication Saint, XManDroid,</p>
    <p>TrustDroid, Aquifer</p>
    <p>IPC Provenance QUIRE,</p>
    <p>IPC Inspection</p>
    <p>Mock Data</p>
    <p>MockDroid, TISSA, AppFence</p>
  </div>
  <div class="page">
    <p>System Apps</p>
    <p>Android Security Extensions</p>
    <p>Access control (hooks) are embedded in sensitive components</p>
    <p>Linux DAC, SELinux/SEAndroid</p>
    <p>System ContentProviders</p>
    <p>(e.g. contacts)</p>
    <p>Activity Manager Service</p>
    <p>Framework Libraries Package Manager</p>
    <p>Service</p>
    <p>Applications</p>
    <p>Linux Kernel</p>
    <p>Android OS</p>
  </div>
  <div class="page">
    <p>System Apps</p>
    <p>Android Security Extensions</p>
    <p>Access control (hooks) are embedded in sensitive components</p>
    <p>Linux DAC, SELinux/SEAndroid</p>
    <p>System ContentProviders</p>
    <p>(e.g. contacts)</p>
    <p>Activity Manager Service</p>
    <p>Framework Libraries Package Manager</p>
    <p>Service</p>
    <p>Applications</p>
    <p>Linux Kernel</p>
    <p>Android OS Access Control</p>
    <p>Access Control</p>
    <p>Access Control (Inlined Reference</p>
    <p>Monitor)</p>
  </div>
  <div class="page">
    <p>Research Question</p>
    <p>Is it possible to provide a programmable and generic security architecture on top of which many of these solutions can be</p>
    <p>instantiated?</p>
  </div>
  <div class="page">
    <p>Observations</p>
    <p>Diverse Goals, but use similar security hooks and mechanisms System Android</p>
    <p>ICC Package Manager</p>
    <p>Sensors / Phone</p>
    <p>Info</p>
    <p>Fake Data</p>
    <p>System Content</p>
    <p>Providers</p>
    <p>File Access</p>
    <p>Network Access</p>
    <p>MockDroid</p>
    <p>XManDroid</p>
    <p>TrustDroid</p>
    <p>FlaskDroid</p>
    <p>CRePE</p>
    <p>Quire</p>
    <p>TaintDroid</p>
    <p>Kirin</p>
    <p>IPC Inspection</p>
    <p>AppFence</p>
    <p>Aquifer</p>
    <p>APEX</p>
    <p>Saint</p>
    <p>SEAndroid</p>
    <p>TISSA</p>
  </div>
  <div class="page">
    <p>Observations</p>
    <p>Diverse Goals, but use similar security hooks and mechanisms System Android</p>
    <p>ICC Package Manager</p>
    <p>Sensors / Phone</p>
    <p>Info</p>
    <p>Fake Data</p>
    <p>System Content</p>
    <p>Providers</p>
    <p>File Access</p>
    <p>Network Access</p>
    <p>MockDroid</p>
    <p>XManDroid</p>
    <p>TrustDroid</p>
    <p>FlaskDroid</p>
    <p>CRePE</p>
    <p>Quire</p>
    <p>TaintDroid</p>
    <p>Kirin</p>
    <p>IPC Inspection</p>
    <p>AppFence</p>
    <p>Aquifer</p>
    <p>APEX</p>
    <p>Saint</p>
    <p>SEAndroid</p>
    <p>TISSA</p>
  </div>
  <div class="page">
    <p>Android OS</p>
    <p>Linux Kernel</p>
    <p>High-level Idea of ASM</p>
    <p>Android</p>
  </div>
  <div class="page">
    <p>Android OS</p>
    <p>Linux Kernel</p>
    <p>High-level Idea of ASM</p>
    <p>A modular access control architecture supporting multiple stakeholders</p>
    <p>Enterprise</p>
    <p>User</p>
    <p>Platform Provider</p>
    <p>Android</p>
  </div>
  <div class="page">
    <p>Android OS</p>
    <p>Linux Kernel</p>
    <p>High-level Idea of ASM</p>
    <p>A modular access control architecture supporting multiple stakeholders</p>
    <p>Deploy Android Security Modules (ASMs) as apps</p>
    <p>Enterprise</p>
    <p>User</p>
    <p>Platform Provider</p>
    <p>Android</p>
    <p>ASM Enterprise</p>
    <p>ASM User</p>
    <p>ASM Provider</p>
  </div>
  <div class="page">
    <p>Android OS</p>
    <p>Linux Kernel</p>
    <p>High-level Idea of ASM</p>
    <p>A modular access control architecture supporting multiple stakeholders</p>
    <p>Deploy Android Security Modules (ASMs) as apps</p>
    <p>Enterprise</p>
    <p>User</p>
    <p>Platform Provider</p>
    <p>Access Control</p>
    <p>Access Control</p>
    <p>Android</p>
    <p>ASM Enterprise</p>
    <p>ASM User</p>
    <p>ASM Provider</p>
  </div>
  <div class="page">
    <p>Challenges</p>
    <p>Fine-grained access control on all abstraction layers</p>
    <p>Handle the semantics and pecularities of each layer</p>
    <p>Preserve existing security invariants</p>
    <p>Dont overrule denials by default Android access control</p>
    <p>Data modification by ASMs only in well-defined bounds</p>
    <p>Efficiency</p>
    <p>Only activate hooks when they are required</p>
    <p>Whitelisting for root processes and system apps</p>
    <p>Policy Reconcilliation</p>
    <p>Handle decision conflicts (currently consensus strategy)</p>
  </div>
  <div class="page">
    <p>Design</p>
  </div>
  <div class="page">
    <p>System ContentProviders</p>
    <p>(e.g. contacts)</p>
    <p>System Services (e.g. ActivityManager)</p>
    <p>ASM Framework</p>
    <p>ASM - Android Security Modules 9</p>
    <p>ASM User</p>
    <p>ASM Provider</p>
    <p>ASM Enterprise</p>
    <p>H o</p>
    <p>o k</p>
    <p>H o</p>
    <p>o k</p>
    <p>Applications</p>
    <p>Linux Kernel</p>
    <p>Android OS</p>
    <p>ASM Bridge</p>
    <p>ASM LSM SELinux LSM</p>
  </div>
  <div class="page">
    <p>ASM Framework</p>
    <p>ASM - Android Security Modules 9</p>
    <p>ASM User</p>
    <p>ASM Provider</p>
    <p>ASM Enterprise Applications</p>
    <p>Linux Kernel</p>
    <p>Android OS</p>
    <p>ASM Bridge</p>
    <p>ASM LSM SELinux LSM</p>
  </div>
  <div class="page">
    <p>ASM Framework</p>
    <p>ASM - Android Security Modules 9</p>
    <p>ASM User</p>
    <p>ASM Provider</p>
    <p>ASM Enterprise Applications</p>
    <p>Linux Kernel</p>
    <p>Android OS</p>
    <p>ASM Bridge</p>
    <p>Reference Monitor</p>
    <p>ASM LSM SELinux LSM</p>
  </div>
  <div class="page">
    <p>ASM Framework</p>
    <p>ASM - Android Security Modules 9</p>
    <p>ASM User</p>
    <p>ASM Provider</p>
    <p>ASM Enterprise Applications</p>
    <p>Linux Kernel</p>
    <p>Android OS</p>
    <p>ASM Bridge</p>
    <p>ASM LSM SELinux LSM</p>
  </div>
  <div class="page">
    <p>Hook Invocation</p>
    <p>Applications</p>
    <p>Linux Kernel</p>
    <p>ASM User</p>
    <p>ASM Provider</p>
    <p>ASM Enterprise</p>
    <p>System ContentProviders</p>
    <p>(e.g. contacts)</p>
    <p>System Services (e.g. ActivityManager) H</p>
    <p>o o</p>
    <p>k</p>
    <p>H o</p>
    <p>o k</p>
    <p>ASM Bridge</p>
    <p>ASM LSM SELinux LSM</p>
    <p>Android OS</p>
  </div>
  <div class="page">
    <p>Hook Invocation</p>
    <p>Applications</p>
    <p>Linux Kernel</p>
    <p>ASM User</p>
    <p>ASM Provider</p>
    <p>ASM Enterprise</p>
    <p>System ContentProviders</p>
    <p>(e.g. contacts)</p>
    <p>Query</p>
    <p>H o</p>
    <p>o k</p>
    <p>ASM Bridge</p>
    <p>ASM LSM SELinux LSM</p>
    <p>Android OS</p>
  </div>
  <div class="page">
    <p>Hook Invocation</p>
    <p>Applications</p>
    <p>Linux Kernel</p>
    <p>ASM User</p>
    <p>ASM Provider</p>
    <p>ASM Enterprise</p>
    <p>System ContentProviders</p>
    <p>(e.g. contacts)</p>
    <p>Query</p>
    <p>Protection Event (query contacts)</p>
    <p>H o</p>
    <p>o k</p>
    <p>ASM Bridge</p>
    <p>ASM LSM SELinux LSM</p>
    <p>Android OS</p>
  </div>
  <div class="page">
    <p>Hook Invocation</p>
    <p>Applications</p>
    <p>Linux Kernel</p>
    <p>ASM User</p>
    <p>ASM Provider</p>
    <p>ASM Enterprise</p>
    <p>System ContentProviders</p>
    <p>(e.g. contacts)</p>
    <p>Query Callback</p>
    <p>Protection Event (query contacts)</p>
    <p>H o</p>
    <p>o k</p>
    <p>ASM Bridge</p>
    <p>ASM LSM SELinux LSM</p>
    <p>Android OS</p>
  </div>
  <div class="page">
    <p>System ContentProviders</p>
    <p>(e.g. contacts)</p>
    <p>Support for 3rd-Party Hooks</p>
    <p>ASM User</p>
    <p>ASM Provider</p>
    <p>ASM Enterprise</p>
    <p>ASM aware 3rd Party App</p>
    <p>H o</p>
    <p>o k</p>
    <p>Applications</p>
    <p>Linux Kernel</p>
    <p>Android OS</p>
    <p>ASM Bridge</p>
    <p>ASM LSM SELinux LSM</p>
  </div>
  <div class="page">
    <p>System ContentProviders</p>
    <p>(e.g. contacts)</p>
    <p>Support for 3rd-Party Hooks</p>
    <p>ASM User</p>
    <p>ASM Provider</p>
    <p>ASM Enterprise</p>
    <p>ASM aware 3rd Party App</p>
    <p>H o</p>
    <p>o k</p>
    <p>H o</p>
    <p>o k</p>
    <p>Applications</p>
    <p>Linux Kernel</p>
    <p>Android OS</p>
    <p>ASM Bridge</p>
    <p>ASM LSM SELinux LSM</p>
  </div>
  <div class="page">
    <p>System ContentProviders</p>
    <p>(e.g. contacts)</p>
    <p>Support for 3rd-Party Hooks</p>
    <p>ASM User</p>
    <p>ASM Provider</p>
    <p>ASM Enterprise</p>
    <p>Register 3rd-party Hook</p>
    <p>ASM aware 3rd Party App</p>
    <p>H o</p>
    <p>o k</p>
    <p>H o</p>
    <p>o k</p>
    <p>Applications</p>
    <p>Linux Kernel</p>
    <p>Android OS</p>
    <p>ASM Bridge</p>
    <p>ASM LSM SELinux LSM</p>
  </div>
  <div class="page">
    <p>Evaluation</p>
  </div>
  <div class="page">
    <p>Experiment Setup</p>
    <p>LG Nexus 4</p>
    <p>Android 4.4 (with ASM extensions), Linux MSM Kernel 3.4</p>
    <p>Evaluated aspects include User Interface (Activity), Contact, File and Socket operations</p>
    <p>Considered impact of a plain ASM</p>
    <p>Automated Test Suite</p>
    <p>Performance Overhead: Java System.nanotime()</p>
    <p>Power Consumption: Qualcomm Trepn Profiler</p>
  </div>
  <div class="page">
    <p>Performance</p>
    <p>Stock Android</p>
    <p>No ASM active</p>
    <p>One ASM active</p>
    <p>Activity Start</p>
    <p>Contacts Query</p>
    <p>File Read</p>
    <p>Socket Connect</p>
    <p>A vg</p>
    <p>. ti</p>
    <p>m e</p>
    <p>i n</p>
    <p>m s</p>
  </div>
  <div class="page">
    <p>Power Consumption</p>
    <p>Stock Android No ASM active One ASM active</p>
    <p>A vg</p>
    <p>. p</p>
    <p>o w</p>
    <p>e r</p>
    <p>co n</p>
    <p>su m</p>
    <p>p ti</p>
    <p>o n</p>
    <p>in m</p>
    <p>W</p>
  </div>
  <div class="page">
    <p>Example Use Case</p>
  </div>
  <div class="page">
    <p>ConXSense Context Aware Access Control</p>
    <p>Goal: Context-aware access control</p>
    <p>ConXSense [ASIACCS 2014]</p>
  </div>
  <div class="page">
    <p>ConXSense</p>
    <p>ConXSense Context Aware Access Control</p>
    <p>Goal: Context-aware access control</p>
    <p>Context-aware access control enforcing policies by user context profiling</p>
    <p>Includes access control on sensors (e.g., GPS and camera), sensitive information (e.g., contacts) and apps</p>
    <p>Context Profiler</p>
    <p>User Interface</p>
    <p>Location Info</p>
    <p>BT Sensing</p>
    <p>User Input</p>
    <p>WiFi Sensing</p>
    <p>ConXSense [ASIACCS 2014]</p>
  </div>
  <div class="page">
    <p>ConXSense</p>
    <p>ConXSense Context Aware Access Control</p>
    <p>Goal: Context-aware access control</p>
    <p>Context-aware access control enforcing policies by user context profiling</p>
    <p>Includes access control on sensors (e.g., GPS and camera), sensitive information (e.g., contacts) and apps</p>
    <p>ASM based implementation:</p>
    <p>ConXSense ASM</p>
    <p>Context Profiler</p>
    <p>User Interface</p>
    <p>ASM Callback Service Location Info</p>
    <p>BT Sensing</p>
    <p>User Input</p>
    <p>WiFi Sensing System</p>
    <p>ContentProviders</p>
    <p>ActivityManager Service</p>
    <p>CameraService</p>
    <p>LocationManager Service</p>
    <p>H o</p>
    <p>o k</p>
    <p>H o</p>
    <p>o k</p>
    <p>H o</p>
    <p>o k</p>
    <p>H o</p>
    <p>o k</p>
    <p>ConXSense [ASIACCS 2014]</p>
  </div>
  <div class="page">
    <p>Conclusion</p>
    <p>ASM greatly simplifies use-case specific solutions</p>
    <p>Developers dont need to modify system components</p>
    <p>Implementation of security solutions as apps</p>
    <p>Currently working on further use-cases</p>
    <p>Dual Persona Phone</p>
    <p>Dynamic Application Behaviour Analysis</p>
    <p>Port to new Android versions</p>
    <p>Push ASM to device vendors, AOSP</p>
    <p>Google, OEMs  please call us</p>
  </div>
  <div class="page">
    <p>Thank you!</p>
    <p>Questions?</p>
    <p>http://www.androidsecuritymodules.org</p>
  </div>
</Presentation>
