<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>End-Users Get Maneuvered: Empirical Analysis of Redirection Hijacking in Content Delivery Networks</p>
    <p>Shuai Hao* Yubao Zhang Haining Wang Angelos Starvous</p>
    <p>* Currently with CAIDA / UC San Diego</p>
    <p>University of Delaware University of Delaware University of Delaware George Mason University</p>
  </div>
  <div class="page">
    <p>/ Outline</p>
    <p>DNS and DNSSEC</p>
    <p>Redirection Hijacking in CDN</p>
    <p>Threat Analysis</p>
    <p>Countermeasures</p>
    <p>Conclusion</p>
  </div>
  <div class="page">
    <p>/ Outline</p>
    <p>DNS and DNSSEC</p>
  </div>
  <div class="page">
    <p>Client Resolver</p>
    <p>domain.com</p>
    <p>Authoritative DNS server</p>
    <p>Root</p>
    <p>.com</p>
    <p>domain.com a.b.c.d a.b.c.d</p>
    <p>/ Domain Name System (DNS) and DNSSEC</p>
    <p>Domain Name System</p>
  </div>
  <div class="page">
    <p>Client Resolver</p>
    <p>domain.com</p>
    <p>Authoritative DNS server</p>
    <p>domain.com a.b.c.d</p>
    <p>DNS Cache Poisoning / DNS Spoofing</p>
    <p>w.x.y.z</p>
    <p>/ Domain Name System (DNS) and DNSSEC</p>
    <p>w.x.y.z</p>
  </div>
  <div class="page">
    <p>Client Resolver</p>
    <p>domain.com</p>
    <p>Authoritative DNS server</p>
    <p>domain.com a.b.c.d</p>
    <p>DNS Cache Poisoning / DNS Spoofing</p>
    <p>w.x.y.z</p>
    <p>/ Domain Name System (DNS) and DNSSEC</p>
    <p>Challenge-response defense  transaction-ID and source port randomization  increase the entropy: only effective against the off-path attackers</p>
    <p>DNSSEC: System-wide solution</p>
    <p>w.x.y.z</p>
  </div>
  <div class="page">
    <p>RRSIG</p>
    <p>Client Resolver</p>
    <p>domain.com</p>
    <p>Authoritative DNS server</p>
    <p>Root</p>
    <p>.com</p>
    <p>domain.com a.b.c.d</p>
    <p>DNSSEC</p>
    <p>DNSKEY ZSK</p>
    <p>DS Record RRSIG</p>
    <p>DNSKEY KSK</p>
    <p>RRSIG</p>
    <p>/ Domain Name System (DNS) and DNSSEC</p>
  </div>
  <div class="page">
    <p>Client Resolver</p>
    <p>NX.domain.com</p>
    <p>Authoritative DNS server</p>
    <p>Root</p>
    <p>.com</p>
    <p>domain.com</p>
    <p>DNSKEY ZSK</p>
    <p>DS Record RRSIG</p>
    <p>DNSKEY KSY</p>
    <p>RRSIG</p>
    <p>Negative Responses in DNSSEC</p>
    <p>Denial of existence in DNSSEC</p>
    <p>NX.domain.com</p>
    <p>NSEC / NSEC3</p>
    <p>/ Domain Name System (DNS) and DNSSEC</p>
  </div>
  <div class="page">
    <p>Client Resolver</p>
    <p>NX.domain.com</p>
    <p>Authoritative DNS server</p>
    <p>Root</p>
    <p>.com</p>
    <p>domain.com</p>
    <p>DNSKEY ZSK</p>
    <p>DS Record RRSIG</p>
    <p>DNSKEY KSY</p>
    <p>RRSIG</p>
    <p>Zone Enumeration Attack</p>
    <p>NX.domain.com</p>
    <p>enumerate the NSEC records to walk through the zone space</p>
    <p>Negative Responses in DNSSEC</p>
    <p>NSEC / NSEC3</p>
    <p>/ Domain Name System (DNS) and DNSSEC</p>
  </div>
  <div class="page">
    <p>Zone Enumeration Attack  expose private device names; reveal registrant data [RFC 5155]</p>
    <p>Negative Responses in DNSSEC</p>
    <p>ECDSA-based (Live) Signing  RSA-based signing is prohibitively expensive to generate real-time, on-demandsignature</p>
    <p>fast key generation  live signing - zone enumeration</p>
    <p>significantly reduced signature size  DDoS amplification attack</p>
    <p>has been adoptedby Cloudflare and .nlTLD</p>
    <p>/ Domain Name System (DNS) and DNSSEC</p>
  </div>
  <div class="page">
    <p>/ Outline</p>
    <p>Redirection Hijacking in CDN</p>
  </div>
  <div class="page">
    <p>Domain DelegationSurrogate Selection</p>
    <p>CDN</p>
    <p>Client</p>
    <p>Resolver</p>
    <p>Mapping System</p>
    <p>a.b.c.d</p>
    <p>a.b.c.d</p>
    <p>a.b.c.d</p>
    <p>Content Origin Content Server</p>
    <p>CNAME Content Provider</p>
    <p>DNS Server</p>
    <p>Request Routing</p>
    <p>/ Redirection Hijacking in CDN</p>
  </div>
  <div class="page">
    <p>CDN</p>
    <p>Client</p>
    <p>Resolver</p>
    <p>Mapping System a.b.c.d Content Origin</p>
    <p>Content Server</p>
    <p>Content Provider DNS delegation</p>
    <p>a.b.c.d</p>
    <p>a.b.c.d</p>
    <p>Surrogate Selection Domain Delegation</p>
    <p>Request Routing</p>
    <p>/ Redirection Hijacking in CDN</p>
  </div>
  <div class="page">
    <p>CDN</p>
    <p>Client</p>
    <p>Resolver</p>
    <p>Mapping System m.n.p.qa.b.c.d</p>
    <p>Content Origin Content Server</p>
    <p>CNAME Content Provider</p>
    <p>DNS Server</p>
    <p>Threat Model: When DNSSEC meets CDN</p>
    <p>a.b.c.d</p>
    <p>m.n.p.q</p>
    <p>m.n.p.q</p>
    <p>/ Redirection Hijacking in CDN</p>
  </div>
  <div class="page">
    <p>/ Outline</p>
    <p>Threat Analysis</p>
  </div>
  <div class="page">
    <p>Case Studies</p>
    <p>www.dell.com CNAME www1.dell-cidr.akadns.net</p>
    <p>www1.dell-cidr.akadns.net CNAME cdn-www.dell.com.edgekey.net</p>
    <p>cdn-www.dell.com.edgekey.net CNAME cdn-www.dell.com. edgekey.net.globalredir.akadns.net</p>
    <p>cdn-www.dell.com. edgekey.net.globalredir.akadns.net CNAME e28.x.akamaiedge.net</p>
    <p>e28.x.akamaiedge.net A 104.117.80.33</p>
    <p>End-User Mapping: Akamai</p>
    <p>dynamic mapping</p>
    <p>/ Threat Analysis</p>
  </div>
  <div class="page">
    <p>Case Studies</p>
    <p>Dynamic CNAME: KeyCDN</p>
    <p>ja.onsen.io CNAME jaonsenio-4ecf.kxcdn.com jaonsenio-4ecf.kxcdn.com CNAME p-usse00.kxcdn.com</p>
    <p>p-uswd00.kxcdn.com A 76.164.234.2</p>
    <p>ja.onsen.io CNAME jaonsenio-4ecf.kxcdn.com jaonsenio-4ecf.kxcdn.com CNAME p-uswd00.kxcdn.com</p>
    <p>p-uswd00.kxcdn.com A 107.182.231.101</p>
    <p>/ Threat Analysis</p>
  </div>
  <div class="page"/>
  <div class="page">
    <p>T. Chung et al., Understanding the Role of Registrars in DNSSEC Deployment (IMC17)</p>
    <p>Registrars are responsible for the (small) DNSSEC deployment today, and that many leading registrars do not support DNSSEC at all, or require customers to take cumbersome steps to deploy DNSSEC</p>
    <p>Why DNSSEC adoption for top domains is also slow?  their registrars are typically DNSSEC-enabled  highly reply on CDN to delivery contents: dynamic mapping</p>
    <p>Why DNSSEC adoption is so slow?</p>
    <p>/ Threat Analysis</p>
  </div>
  <div class="page">
    <p>Round-trip time (RTT) Content download speed  pure network matric:</p>
    <p>performance of network path</p>
    <p>network latency + page construction</p>
    <p>download a set of medium-sized content files (50k 50M)</p>
    <p>curl -H Host:i.dell.com O http://104.78.87.26/sites/imagecontent/products/...jpg</p>
    <p>Time-to-first-byte (TTFB)</p>
    <p>Performance Impact</p>
    <p>/ Threat Analysis</p>
  </div>
  <div class="page">
    <p>Content download speed</p>
    <p>Time-to-first-byte (TTFB)</p>
    <p>Performance Impact</p>
    <p>/ Threat Analysis</p>
    <p>Round-trip time (RTT)</p>
  </div>
  <div class="page">
    <p>Potential DoS attack  directing the requests from a large number of clients to a single victim edge servers (with legitimate traffic)</p>
    <p>Defeating CDNs load balancing and DoS protection  easy detection for unresponsive edge servers  replaying legitimate mapping records associated with the unresponsive edge servers  still valid for DNSSEC validation</p>
    <p>interrupting end-users access  financial and reputational damage</p>
    <p>More Serious Threat</p>
    <p>/ Threat Analysis</p>
  </div>
  <div class="page">
    <p>/ Outline</p>
    <p>Countermeasures</p>
  </div>
  <div class="page">
    <p>DNSSEC Consideration</p>
    <p>against record replay: signing with additional information  currently practice: long validity period</p>
    <p>RSA 30 days; ECDSA: 2 days (Cloudflare)</p>
    <p>/ Countermeasures</p>
    <p>use a short validity period  sign the signature expiration</p>
    <p>increase the difficulty of record injection as the validity cannot be altered</p>
    <p>adversaries will only have a short window to perform the record injection</p>
  </div>
  <div class="page">
    <p>the prevalence of CNAME increases the difficulty of securing the mapping in CDNs</p>
    <p>CNAME Chain  dynamic CNAME mapping</p>
    <p>CNAME Flattening  hide the CNAME chain from resolvers  CDNs authoritative nameservers act as a resolver by recursively resolving the CNAME chain and finally construct an A record</p>
    <p>CNAME Flattening</p>
    <p>/ Countermeasures</p>
  </div>
  <div class="page">
    <p>CNAME Flattening</p>
    <p>www.dell.com CNAME www1.dell-cidr.akadns.net</p>
    <p>www1.dell-cidr.akadns.net CNAME cdn-www.dell.com.edgekey.net</p>
    <p>cdn-www.dell.com.edgekey.net CNAME cdn-www.dell.com. edgekey.net.globalredir.akadns.net</p>
    <p>cdn-www.dell.com. edgekey.net.globalredir.akadns.net CNAME e28.x.akamaiedge.net</p>
    <p>e28.x.akamaiedge.net A 104.117.80.33</p>
    <p>/ Countermeasures</p>
  </div>
  <div class="page">
    <p>CNAME Flattening</p>
    <p>www.dell.com CNAME www1.dell-cidr.akadns.net</p>
    <p>www1.dell-cidr.akadns.net CNAME cdn-www.dell.com.edgekey.net</p>
    <p>cdn-www.dell.com.edgekey.net CNAME cdn-www.dell.com. edgekey.net.globalredir.akadns.net</p>
    <p>cdn-www.dell.com. edgekey.net.globalredir.akadns.net CNAME e28.x.akamaiedge.net</p>
    <p>e28.x.akamaiedge.net A 104.117.80.33</p>
    <p>/ Countermeasures</p>
  </div>
  <div class="page">
    <p>/ Outline</p>
    <p>Conclusion</p>
  </div>
  <div class="page">
    <p>Problem: When DNSSEC meets CDN  fundamental vulnerability in DNS-based CDNs stemming from the</p>
    <p>dynamics of DNS mapping records</p>
    <p>allowing adversaries to manipulate the access of end-users even with DNSSEC signatures (i.e., replay attack)</p>
    <p>Prevalence of redirection by CNAME</p>
    <p>characterizing the request routing of CDNs  practical impact: performance degradation, nullifying CDNs benefits  countermeasures</p>
    <p>/ Conclusion</p>
  </div>
  <div class="page">
    <p>Thank you!</p>
    <p>Shuai Hao haos@caida.org www.caida.org/~haos/</p>
    <p>End-Users Get Maneuvered: Empirical Analysis of Redirection Hijacking in Content Delivery Networks</p>
  </div>
</Presentation>
