<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Attaining the Promise and Avoiding the Pitfalls of TCP in the Datacenter</p>
    <p>Glenn Judd</p>
    <p>Morgan Stanley</p>
  </div>
  <div class="page">
    <p>Introduction</p>
    <p>Datacenter computing pervasive  Beyond the Internet services domain  BigData, Grid Computing, Cloud etc.</p>
    <p>Communication is essential  Demand is increasing</p>
    <p>TCP  Leverage existing base of TCP applications  Avoid re-inventing flow control, congestion control, etc.  Not designed with datacenter computing in mind</p>
    <p>Internet: propagation delay &gt;&gt;&gt; queueing delay  Datacenter: propagation delay &lt;&lt;&lt; queueing delay</p>
  </div>
  <div class="page">
    <p>Outline</p>
    <p>Background</p>
    <p>TCP Datacenter Challenges  Latency &amp; Application Coupling</p>
    <p>Incast</p>
    <p>DCTCP  Deployment Challenges</p>
    <p>Performance</p>
    <p>Receive Buffer Tuning</p>
    <p>Related Work</p>
    <p>Conclusion</p>
  </div>
  <div class="page">
    <p>Application Types</p>
    <p>Large-scale computation  Monte Carlo simulation</p>
    <p>Data analysis</p>
    <p>Latency-sensitive computation  End-user-facing</p>
    <p>Multiple groups sharing the datacenter</p>
  </div>
  <div class="page">
    <p>Motivation</p>
    <p>Workarounds  Rerun slow tasks  Overlap computation</p>
    <p>Underlying Cause  I/O  Network</p>
    <p>Cross-application Interference</p>
    <p>Time</p>
    <p>F ra</p>
    <p>ct io</p>
    <p>n C</p>
    <p>o m</p>
    <p>p le</p>
    <p>te</p>
    <p>Task Completion PDF</p>
  </div>
  <div class="page">
    <p>Outline</p>
    <p>Background</p>
    <p>TCP Datacenter Challenges  Latency &amp; Application Coupling</p>
    <p>Incast</p>
    <p>DCTCP  Deployment Challenges</p>
    <p>Performance</p>
    <p>Receive Buffer Tuning</p>
    <p>Related Work</p>
    <p>Conclusion</p>
  </div>
  <div class="page">
    <p>Latency &amp; Application Coupling</p>
    <p>By design, TCP fills queues  Even simple congestion  Latency</p>
    <p>microseconds  milliseconds</p>
    <p>Application coupling  Shared congested link  Buffer pressure  Disparate groups coupled through network</p>
    <p>Sender Switch</p>
    <p>Sender Receiver</p>
    <p>All traffic transiting queue incurs latency</p>
  </div>
  <div class="page">
    <p>Incast</p>
    <p>Triggers timeouts</p>
    <p>Exacerbated by synchronized requests  Common in distributed storage</p>
    <p>Sender</p>
    <p>Sender</p>
    <p>Sender</p>
    <p>Sender</p>
    <p>Switch Receivern * L L</p>
    <p>L = Link bandwidth</p>
    <p>n senders</p>
    <p>Discards</p>
  </div>
  <div class="page">
    <p>Impact of Timeouts</p>
    <p>Majority of delay eliminated by Reducing RTOmin</p>
    <p>But:  Zero delay preferred  Latency remains</p>
  </div>
  <div class="page">
    <p>Outline</p>
    <p>Background</p>
    <p>TCP Datacenter Challenges  Latency &amp; Application Coupling</p>
    <p>Incast</p>
    <p>DCTCP  Deployment Challenges</p>
    <p>Performance</p>
    <p>Receive Buffer Tuning</p>
    <p>Related Work</p>
    <p>Conclusion</p>
  </div>
  <div class="page">
    <p>DCTCP</p>
    <p>Key idea: reduce queue occupancy</p>
    <p>Reduced loss</p>
    <p>Reduce timeouts</p>
    <p>Reduced queueing delay</p>
    <p>Mechanism</p>
    <p>Leverage ECN RED/AQM capabilities</p>
    <p>Available in current technology</p>
    <p>Can it work in production? At scale?</p>
  </div>
  <div class="page">
    <p>Coexistence with TCP</p>
    <p>TCP Switch Receiver10 Gbps</p>
  </div>
  <div class="page">
    <p>Coexistence with TCP</p>
    <p>TCP</p>
    <p>DCTCP</p>
  </div>
  <div class="page">
    <p>RED-ECN AQM Implementation</p>
    <p>Solution: Segregate DCTCP traffic using QoS 14</p>
    <p>DCTCP</p>
    <p>Marking Threshold</p>
    <p>TCP DCTCP</p>
    <p>CE DCTCP</p>
    <p>CE TCPTCP</p>
    <p>TCP packets discarded</p>
    <p>DCTCP packets marked</p>
  </div>
  <div class="page">
    <p>Connection Establishment</p>
    <p>SYNs ECT?</p>
    <p>Paper: ?</p>
    <p>Implementation: No</p>
  </div>
  <div class="page">
    <p>Non-technical Challenges</p>
    <p>Network administrators are necessarily risk averse</p>
    <p>You want to do what?!</p>
    <p>Keys to deploying DCTCP</p>
    <p>Demonstrated reduction in coupling</p>
    <p>Primum non nocere</p>
    <p>Support for TCP and DCTCP coeixistence</p>
    <p>Timing</p>
  </div>
  <div class="page">
    <p>Outline</p>
    <p>Background</p>
    <p>TCP Datacenter Challenges  Latency &amp; Application Coupling</p>
    <p>Incast</p>
    <p>DCTCP  Deployment Challenges</p>
    <p>Performance</p>
    <p>Receive Buffer Tuning</p>
    <p>Related Work</p>
    <p>Conclusion</p>
  </div>
  <div class="page">
    <p>Throughput, Fairness, &amp; Latency</p>
    <p>Sender</p>
    <p>Sender</p>
    <p>Sender</p>
    <p>Sender</p>
    <p>Switch Receiver</p>
    <p>Latency measurements</p>
  </div>
  <div class="page">
    <p>Throughput and Fairness</p>
    <p>TCP DCTCP</p>
    <p>T h</p>
    <p>ro u</p>
    <p>g h</p>
    <p>o u</p>
    <p>t (M</p>
    <p>b p</p>
    <p>s)</p>
    <p>Mean throughput Error bars show maximum and minimum</p>
  </div>
  <div class="page">
    <p>Latency</p>
    <p>DCTCP latency significantly lower than TCP</p>
    <p>Latency in ms</p>
  </div>
  <div class="page">
    <p>Stability, Convergence, &amp; Fairness: TCP</p>
    <p>Flows</p>
    <p>Introduced one at a time</p>
    <p>Removed one at a time</p>
  </div>
  <div class="page">
    <p>Stability, Convergence, &amp; Fairness: DCTCP</p>
    <p>DCTCP is better! Contradicts analytical results?</p>
  </div>
  <div class="page">
    <p>Stability, Convergence, &amp; Fairness: TCP, 2 Flows</p>
    <p>Digging deeper: TCP is performing very poorly</p>
  </div>
  <div class="page">
    <p>Receive Buffer Tuning Off: TCP</p>
  </div>
  <div class="page">
    <p>Scale</p>
    <p>Senders Total (Mbps) RTT (ms)</p>
    <p>Retransmissions</p>
    <p>Timeouts Min. Load</p>
    <p>(Gbps)Total %</p>
  </div>
  <div class="page">
    <p>Conclusion</p>
    <p>TCP has significant performance problems in datacenters  Latency &amp; Application Coupling  Incast</p>
    <p>Lowest feasible RTOmin  DCTCP</p>
    <p>Receive buffer tuning</p>
    <p>DCTCP  Requires changes to work in production</p>
    <p>Coexistence  Connection establishment</p>
    <p>Has scaling limits, but significantly improves performance  In production  Coming soon to your favorite OS</p>
  </div>
  <div class="page">
    <p>Questions?</p>
  </div>
</Presentation>
