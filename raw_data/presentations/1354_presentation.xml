<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Marie Vasek and Tyler Moore Southern Methodist University / Wellesley College USENIX CSET August 6, 2012</p>
    <p>DO MALWARE REPORTS EXPEDITE CLEANUP?</p>
    <p>AN EXPERIMENTAL STUDY</p>
  </div>
  <div class="page">
    <p>HACKED WEBSITES DISTRIBUTE MALWARE TO UNSUSPECTING VISITORS</p>
  </div>
  <div class="page">
    <p>HACKED WEBSITES DISTRIBUTE MALWARE TO UNSUSPECTING VISITORS</p>
  </div>
  <div class="page">
    <p>VOLUNTARY INFOSEC ENFORCEMENT  Law enforcement is usually not involved in the detection and</p>
    <p>cleanup of hacked websites distributing malware  Instead, cleanup is coordinated and carried out by voluntary</p>
    <p>efforts  Security companies  Search engines  Non-profit organizations  Web hosts and site owners</p>
    <p>Malware cleanup process 1. Detect a website distributing malware 2. Notify the website owner and hosting provider of infection if</p>
    <p>compromised, or hosting provider and registrar if purely malicious 3. Search engines might block results until malware is removed 4</p>
  </div>
  <div class="page">
    <p>STOPBADWARE BEST PRACTICES FOR REPORTING BADWARE URLS</p>
    <p>Developed Spring &amp; Summer 2011 by StopBadware working group  Guide for malware reporters to send more effective malware reports</p>
    <p>What should be in every malware report:  Specific URL, date/time badness occurred, IP address, brief</p>
    <p>description of badness, list of report targets, your contact info  Additional helpful information:</p>
    <p>Specific bad code observed, more detailed information needed for malware delivery, scope of behavior, hash of executable, etc.</p>
    <p>Who to contact and how:  Hosting provider unless bulletproof  Site owner if compromised ; Domain Registrar if malicious  Escalate to AS owner, DNS provider, registry, CERT/CSIRT, police  Quick methods of contact: phone or email (fax? postcard?)</p>
  </div>
  <div class="page">
    <p>EXAMPLE BADWARE URL NOTIFICATION To: abuse@wehateabuse.example.com! Subject: Badware URL notification  malicious-url .net! ! hxxp://malicious-url .net/evilscript.js appears to be a badware URL. This means it may be placing Internet users at risk. We believe that malicious-url.net is primarily used for malicious purposes. Please investigate and take appropriate action to resolve or mitigate the threat.! ! Badware description: Delivers malicious PDF and Flash files.! ! Date/time of detection: 15 July 2011 at 1048 EDT! IP address at time of detection: 192.10.20.30! Additional parties notified: Friendly Registrar, Inc. (domain name registrar)! ! You are receiving this report because this email address is listed as the hosting provider contact in the WHOIS record for 192.10.20.30. ! ! Caution: Opening badware URLs in your browser can infect your computer. For security reasons, URLs in this email have been modified by replacing http with hxxp and by adding a space before the last dot (.) ! ! ======================! ADDITIONAL INFORMATION! ======================! ! Detailed badware description:! URL accessed: hxxp://malicious-url .net/evilscript.js! Bad Code: eval(function(p,a,c,k,e,r){e=function(c){return(c&lt;a?'':e(parseInt(c/a)))+((c=c%a) [truncated]! Behavior: Delivers malicious PDF and Flash files! Special conditions: Only delivers files when referred by a compromised site, such as hxxp:// compromised.example .com.! ! Best practices for web hosting providers receiving reports like this:! http://www.stopbadware.org/best-practices/web-hosting-providers!</p>
  </div>
  <div class="page">
    <p>THE EXPERIMENT</p>
    <p>Hypothesis 1: Sending malware notices helps cleanup -- in particular, more sites will be cleaned and they will be cleaned more quickly</p>
    <p>Hypothesis 2: More details help expedite cleanup</p>
  </div>
  <div class="page">
    <p>fetch URL</p>
    <p>from clear</p>
    <p>inghouse</p>
    <p>filter</p>
    <p>see bad</p>
    <p>behavior?</p>
    <p>find</p>
    <p>associated</p>
    <p>sites</p>
    <p>add sites to</p>
    <p>candidate</p>
    <p>list</p>
    <p>no</p>
    <p>yes</p>
  </div>
  <div class="page">
    <p>executable?</p>
    <p>run in</p>
    <p>VirusTotal</p>
    <p>bad</p>
    <p>clean</p>
    <p>loads known</p>
    <p>bad code?</p>
    <p>bad</p>
    <p>trac</p>
    <p>abnormalities?</p>
    <p>circumstantial</p>
    <p>evidence?</p>
    <p>bad</p>
    <p>code abnor</p>
    <p>malities?</p>
    <p>inspect closer</p>
    <p>bad</p>
    <p>spider site</p>
    <p>more pages?</p>
    <p>clean</p>
    <p>site to be checked</p>
    <p>yes</p>
    <p>3</p>
    <p>&lt;3</p>
    <p>no</p>
    <p>yes</p>
    <p>no</p>
    <p>yes yes</p>
    <p>no</p>
    <p>no</p>
    <p>yes</p>
    <p>yes</p>
    <p>no</p>
    <p>no</p>
    <p>no</p>
    <p>yes</p>
    <p>WHAT IS BAD BEHAVIOR?</p>
  </div>
  <div class="page">
    <p>malicious?</p>
    <p>gather</p>
    <p>hosting and</p>
    <p>registrar</p>
    <p>contacts</p>
    <p>gather</p>
    <p>hosting and</p>
    <p>webmaster</p>
    <p>contacts</p>
    <p>random</p>
    <p>send</p>
    <p>minimal</p>
    <p>report</p>
    <p>send full</p>
    <p>report</p>
    <p>do nothing</p>
    <p>candidate site to be checked</p>
    <p>yes</p>
    <p>no</p>
    <p>min</p>
    <p>f</p>
    <p>u</p>
    <p>l</p>
    <p>l</p>
    <p>c</p>
    <p>o</p>
    <p>n</p>
    <p>t</p>
    <p>r</p>
    <p>o</p>
    <p>l</p>
  </div>
  <div class="page">
    <p>EXAMPLE MINIMAL NOTICE</p>
  </div>
  <div class="page">
    <p>EXAMPLE DETAILED NOTICE</p>
    <p>Everything in the minimal notice plus:</p>
  </div>
  <div class="page">
    <p>see bad behavior?</p>
    <p>bad malicious? clean</p>
    <p>resolves?</p>
    <p>WHOIS info changes?</p>
    <p>bad cleanclean bad</p>
    <p>candidate site to be re-checked after 1,2,4,8,16 days</p>
    <p>yes no no</p>
    <p>yes</p>
    <p>yes no</p>
    <p>yes no yes no</p>
  </div>
  <div class="page">
    <p>WHAT WE FOUND: CLEAN AFTER 16 DAYS</p>
    <p>All Badware</p>
    <p>Purely Malicious</p>
    <p>Compromised</p>
    <p>Report Type # % Clean</p>
    <p># % Clean</p>
    <p># % Clean</p>
    <p>Control 53 45 13 46 40 45 Minimal 55 49 17 53 38 47</p>
    <p>Full 53 62 17 58 36 63</p>
    <p>10 October  5 December 2011  161 badware URLs (out of 960 reported to SBW)</p>
  </div>
  <div class="page">
    <p>TRACKING CLEANUP OVER TIME (161 URLS)</p>
  </div>
  <div class="page">
    <p>WHAT HAPPENS IF GOOGLE HASNT ALREADY SENT A NOTICE? (100 / 161 URLS)</p>
  </div>
  <div class="page">
    <p>ON GOOGLES BLACKLIST (61 / 161 URLS)</p>
  </div>
  <div class="page">
    <p>CONCLUSION</p>
    <p>Reporting works  40% cleaned up 1 day after receiving full report, vs. 18% w/o notice</p>
    <p>Fuller reports better than concise reports  But only the first report matters  Concise reports a waste of time</p>
    <p>Methodology for evaluating malware notices  Limitations and future work</p>
    <p>Small sample size  Mostly manual  Automated assessment of malware could enable larger scale studies</p>
  </div>
</Presentation>
