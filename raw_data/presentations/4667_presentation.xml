<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Theoretical Justification of Popular Link Prediction Heuristics</p>
    <p>Purnamrita Sarkar (UC Berkeley) Deepayan Chakrabarti (Yahoo! Research) Andrew W. Moore (Google, Inc.)</p>
  </div>
  <div class="page">
    <p>Link Prediction  Which pair of nodes {i,j} should be connected?</p>
    <p>Alice</p>
    <p>Bob</p>
    <p>Charlie</p>
    <p>Goal: Recommend a movieGoal: Recommend a movie</p>
  </div>
  <div class="page">
    <p>Link Prediction  Which pair of nodes {i,j} should be connected?</p>
    <p>Goal: Suggest friendsGoal: Suggest friends</p>
  </div>
  <div class="page">
    <p>Link Prediction Heuristics  Predict link between nodes</p>
    <p>Connected by the shortest path  With the most common neighbors (length 2</p>
    <p>paths)  More weight to low-degree common nbrs</p>
    <p>(Adamic/Adar)</p>
    <p>Prolific common friends Less evidence Less prolific Much more evidence</p>
    <p>Alice</p>
    <p>Bob</p>
    <p>Charlie</p>
  </div>
  <div class="page">
    <p>Link Prediction Heuristics  Predict link between nodes</p>
    <p>Connected by the shortest path  With the most common neighbors (length 2</p>
    <p>paths)  More weight to low-degree common nbrs</p>
    <p>(Adamic/Adar)  With more short paths (e.g. length 3 paths )</p>
    <p>exponentially decaying weights to longer paths (Katz measure)</p>
  </div>
  <div class="page">
    <p>Previous Empirical Studies*</p>
    <p>Random Shortest Path</p>
    <p>Common Neighbors</p>
    <p>Adamic/Adar Ensemble of short paths</p>
    <p>L in</p>
    <p>k p</p>
    <p>re d</p>
    <p>ic ti</p>
    <p>o n</p>
    <p>a c c u ra</p>
    <p>c y *</p>
    <p>*Liben-Nowell &amp; Kleinberg, 2003; Brand, 2005; Sarkar &amp; Moore, 2007</p>
    <p>How do we justify these observations? How do we justify</p>
    <p>these observations?</p>
    <p>Especially if the graph is sparse</p>
  </div>
  <div class="page">
    <p>Link Prediction  Generative Model</p>
    <p>Unit volume universe</p>
    <p>Model: 1. Nodes are uniformly distributed points in a latent space 2. This space has a distance metric 3. Points close to each other are likely to be connected in</p>
    <p>the graph  Logistic distance function (Raftery+/2002)</p>
  </div>
  <div class="page">
    <p>Link Prediction  Generative Model</p>
    <p>Higher probability of linking</p>
    <p>radius r</p>
    <p>determines the steepness</p>
    <p>The problem of link prediction is to find the nearest neighbor who is not currently linked to the node.</p>
    <p>Equivalent to inferring distances in the latent space</p>
    <p>Model: 1. Nodes are uniformly distributed points in a latent space 2. This space has a distance metric 3. Points close to each other are likely to be connected in</p>
    <p>the graph  Logistic distance function (Raftery+/2002)</p>
  </div>
  <div class="page">
    <p>Previous Empirical Studies*</p>
    <p>RandomShortest Path</p>
    <p>Common Neighbors</p>
    <p>Adamic/Adar Ensemble of short paths</p>
    <p>L in</p>
    <p>k</p>
    <p>p re</p>
    <p>d ic</p>
    <p>ti o n</p>
    <p>a c c u</p>
    <p>ra c y</p>
    <p>*Liben-Nowell &amp; Kleinberg, 2003; Brand, 2005; Sarkar &amp; Moore, 2007</p>
    <p>Especially if the graph is sparse</p>
  </div>
  <div class="page">
    <p>Common Neighbors</p>
    <p>Pr2(i,j) = Pr(common neighbor|dij)</p>
    <p>jkikijjkikjkik2 dd)d|d,d()d|~Pr()d|~Pr(j)(i,Pr Pkjki</p>
    <p>Product of two logistic probabilities, integrated over a volume determined by dij As  Logistic  Step function</p>
    <p>Much easier to analyze!</p>
    <p>i j</p>
  </div>
  <div class="page">
    <p>Common Neighbors</p>
    <p>Everyone has same radius r</p>
    <p>i j</p>
    <p>)dr,A(r,j)(i,Pr ij2</p>
    <p># common nbrs gives a bound on distance</p>
    <p>DD</p>
    <p>rr /2</p>
    <p>ij</p>
    <p>/1</p>
    <p>ij</p>
    <p>V(r)</p>
    <p>/N 12d</p>
    <p>V(r)</p>
    <p>/N 12</p>
    <p>)dr,A(r,</p>
    <p>N</p>
    <p>P</p>
    <p>=Number of common neighbors</p>
    <p>V(r)=volum e of radius r in D dims</p>
    <p>Unit volume universe</p>
  </div>
  <div class="page">
    <p>Common Neighbors  OPT = node closest to i  MAX = node with max common neighbors</p>
    <p>with i</p>
    <p>Theorem:</p>
    <p>w.h.p</p>
    <p>Link prediction by common neighbors is asymptotically optimal</p>
    <p>dOPT  dMAX  dOPT + 2[/V(1)]1/D</p>
  </div>
  <div class="page">
    <p>Common Neighbors: Distinct Radii  Node k has radius rk .</p>
    <p>ik if dik  rk (Directed graph)  rk captures popularity of node k</p>
    <p>Weighted common neighbors:  Predict (i,j) pairs with highest  w(r)(r)</p>
    <p>i</p>
    <p>k</p>
    <p>j</p>
    <p>r k</p>
    <p>m</p>
    <p>Weight for nodes of radius r</p>
    <p># common neighbors of radius r</p>
  </div>
  <div class="page">
    <p>Type 2 common neighbors</p>
    <p>Presence of common</p>
    <p>neighbor is very informative</p>
    <p>r is close to max radius</p>
    <p>Absence is very</p>
    <p>informative D</p>
    <p>const</p>
    <p>r</p>
    <p>const w(r)</p>
    <p>Adamic/Adar</p>
    <p>Real world graphs generally fall in this range</p>
    <p>i</p>
    <p>k</p>
    <p>j ra</p>
    <p>di u</p>
    <p>s</p>
  </div>
  <div class="page">
    <p>Previous Empirical Studies*</p>
    <p>RandomShortest Path</p>
    <p>Common Neighbors</p>
    <p>Adamic/Adar Ensemble of short paths</p>
    <p>L in</p>
    <p>k</p>
    <p>p re</p>
    <p>d ic</p>
    <p>ti o n</p>
    <p>a c c u</p>
    <p>ra c y</p>
    <p>*Liben-Nowell &amp; Kleinberg, 2003; Brand, 2005; Sarkar &amp; Moore, 2007</p>
    <p>Especially if the graph is sparse</p>
  </div>
  <div class="page">
    <p>-hop Paths  Common neighbors = 2 hop paths</p>
    <p>For longer paths:</p>
    <p>Bounds are weaker  For    we need  &gt;&gt;  to obtain similar</p>
    <p>bounds   justifies the exponentially decaying weight given to longer</p>
    <p>paths by the Katz measure</p>
    <p>N,,g-11)r(rdij</p>
  </div>
  <div class="page">
    <p>Conclusion  Three key ingredients</p>
  </div>
  <div class="page">
    <p>Summary</p>
    <p>Random Shortest Path</p>
    <p>Common Neighbors</p>
    <p>Adamic/Adar Ensemble of short paths</p>
    <p>L in</p>
    <p>k p</p>
    <p>re d</p>
    <p>ic ti</p>
    <p>o n</p>
    <p>a c c u ra</p>
    <p>c y *</p>
    <p>*Liben-Nowell &amp; Kleinberg, 2003; Brand, 2005; Sarkar &amp; Moore, 2007</p>
    <p>The number of paths matters, not the length</p>
    <p>For large dense graphs, common neighbors are enough</p>
    <p>Differentiating between different degrees is important</p>
    <p>In sparse graphs, length 3 or more paths help in prediction.</p>
  </div>
  <div class="page">
    <p>Thanks!</p>
  </div>
  <div class="page">
    <p>Link Prediction  Generative Model</p>
    <p>Higher probability of linking</p>
    <p>Two sources of randomness  Point positions: uniform in D dimensional space  Linkage probability: logistic with parameters ,</p>
    <p>r  , r and D are known</p>
    <p>radius r</p>
    <p>determines the steepness</p>
    <p>The problem of link prediction is to find the nearest neighbor who is not currently linked to the node.</p>
    <p>Equivalent to inferring distances in the latent space</p>
  </div>
  <div class="page">
    <p>Revisiting Raftery et al.s model</p>
    <p>D),c(r,Aj)(i,PrA)(VeA 2 d</p>
    <p>Factor  weak bound for Logistic</p>
    <p>Can be made tighter, as logistic approaches the step function.</p>
  </div>
  <div class="page">
    <p>Problem Statement</p>
    <p>Generative model</p>
    <p>Link Prediction Heuristics</p>
    <p>node a</p>
    <p>Most likely neighbor of node i ?</p>
    <p>node b</p>
    <p>Compare</p>
    <p>A few properties</p>
    <p>Can justify the empirical observations</p>
    <p>We also offer some new prediction algorithms</p>
  </div>
  <div class="page">
    <p>New Estimators  Combine bounds from different radii  But there might not be enough data to obtain</p>
    <p>individual bounds from each radius</p>
    <p>New sweep estimator  Qr = Fraction of nodes w. radius  r, which are</p>
    <p>common neighbors.</p>
    <p>Higher Qr smaller dij w.h.p</p>
    <p>r rijijr N</p>
    <p>cQ V(r)</p>
  </div>
  <div class="page">
    <p>New Estimators  Qr = Fraction of nodes w. radius  r, which are</p>
    <p>common neighbors  larger Qr  smaller dij w.h.p</p>
    <p>TR : = Fraction of nodes w. radius  R, which are common neighbors.</p>
    <p>Smaller TR large dij w.h.p</p>
    <p>R RijijR N</p>
    <p>cT V(R)</p>
  </div>
  <div class="page">
    <p>Sweep Estimators</p>
    <p>Qr = Fraction of nodes with radius  r which are common neighbors</p>
    <p>TR = Fraction of nodes with radius  R which are common neighbors</p>
    <p>Number of common neighbors of a given radius</p>
    <p>Large Qr  small dij Small TR  large dij</p>
    <p>r</p>
  </div>
  <div class="page">
    <p>Link Prediction  Which pair of nodes {i,j} should be connected? Variant: node i is given</p>
    <p>Friend suggestion in FacebookFriend suggestion in Facebook</p>
    <p>Alice</p>
    <p>Bob</p>
    <p>Charlie</p>
    <p>Movie recommendation in Netflix Movie recommendation in Netflix</p>
  </div>
  <div class="page">
    <p>Link Prediction  Generative Model</p>
    <p>Nodes are uniformly distributed in a latent space</p>
    <p>The problem of link prediction is to find the nearest neighbor who is not currently linked to the node.</p>
    <p>Equivalent to inferring distances in the latent space</p>
    <p>Raftery et al.s Model:</p>
    <p>Unit volume universe</p>
    <p>Points close in this space are more likely to be connected.</p>
  </div>
  <div class="page">
    <p>Link Prediction  Generative Model</p>
    <p>Higher probability of linking</p>
    <p>Two sources of randomness  Point positions: uniform in D dimensional space</p>
    <p>Linkage probability: logistic with parameters , r</p>
    <p>, r and D are known</p>
    <p>radius r</p>
    <p>determines the steepness</p>
  </div>
  <div class="page">
    <p>Type 2 common neighbors</p>
    <p>i j</p>
    <p>k 1 ~ Bin[N1 , A(r1, r1, dij)]</p>
    <p>2 ~ Bin[N2 , A(r2, r2, dij)]</p>
    <p>Example graph:  N1 nodes of radius r1 and N2 nodes of radius r2  r1 &lt;&lt; r2</p>
    <p>Maximize Pr[1 , 2 | dij] = product of two binomials</p>
    <p>w(r1) E[1|d*] + w(r2) E[2|d*] = w(r1)1 + w(r2) 2</p>
    <p>RHS   LHS   d*</p>
  </div>
  <div class="page">
    <p>Type 2 common neighbors</p>
    <p>A)A(1 w(r) ij</p>
    <p>d A</p>
    <p>{Varianc e</p>
    <p>Jacobian</p>
    <p>Small variance Presence is more surprising</p>
    <p>r is close to max radius</p>
    <p>Small variance Absence is more surprising</p>
    <p>D 1</p>
    <p>deg</p>
    <p>const</p>
    <p>r</p>
    <p>const w(r)</p>
    <p>Adamic/Adar</p>
    <p>Real world graphs generally fall in this range</p>
  </div>
  <div class="page">
    <p>-hop Paths  Common neighbors = 2 hop paths</p>
    <p>Analysis of longer paths: two components 1. Bounding E(l | dij). [l = # l hop paths]  Bounds Prl (i,j) by using triangle inequality on a series of common neighbor probabilities.</p>
    <p>Triangulation</p>
  </div>
  <div class="page">
    <p>l hop Paths  Common neighbors = 2 hop paths</p>
    <p>Analysis of longer paths: two components 1. Bounding E(l | dij) [l = # l hop paths]  Bounds Prl (i,j) by using triangle inequality on a series of common neighbor probabilities.</p>
    <p>Can use McDiarmids inequality to bound | l - E(l|dij)|</p>
  </div>
  <div class="page">
    <p>Type 2 common neighbors</p>
    <p>i j</p>
    <p>k 1 ~ Bin[N1 , A(r1, r1, dij)]</p>
    <p>2 ~ Bin[N2 , A(r2, r2, dij)]</p>
    <p>Example graph:  N1 nodes of radius r1 and N2 nodes of radius r2</p>
    <p>w(r1) E[1|d*] + w(r2) E[2|d*] = w(r1)1 + w(r2) 2 (d*=MLE) Decreasing function of d* Weighted common neighbors</p>
    <p>Weights</p>
    <p>RHS   d*  Link prediction by weighted common neighbors is</p>
    <p>justified</p>
  </div>
  <div class="page">
    <p>Common Neighbors: Distinct Radii  Node k has radius rk .</p>
    <p>ik if dik  rk (Directed graph)  rk captures popularity of node k</p>
    <p>i</p>
    <p>k</p>
    <p>j</p>
    <p>r k</p>
    <p>m</p>
  </div>
  <div class="page">
    <p>Common Neighbors: Distinct Radii  Node k has radius rk .</p>
    <p>ik if dik  rk (Directed graph)  rk captures popularity of node k</p>
    <p>i k</p>
    <p>j</p>
    <p>Type 1: i k  j</p>
    <p>ri rj</p>
    <p>A(ri , rj ,dij)</p>
    <p>Type 2: i  k  j</p>
    <p>i k</p>
    <p>jrk rk</p>
    <p>A(rk , rk ,dij)</p>
  </div>
  <div class="page">
    <p>Type 2 common neighbors</p>
    <p>i j</p>
    <p>k</p>
    <p>Example graph:  N1 nodes of radius r1 and N2 nodes of radius r2  1 and 2 common neighbors with these radii</p>
    <p>w(r1) E[1|d*] + w(r2) E[2|d*] = w(r1)1 + w(r2) 2 (d*=MLE) Decreasing function of d* Weighted common neighbors</p>
    <p>Weights</p>
    <p>More weighted common neighbors  points are closer  Useful for link prediction</p>
  </div>
  <div class="page">
    <p>-hop Paths  Common neighbors = 2 hop paths</p>
    <p>Analysis of longer paths: 1. Triangulation: -hop path as a sequence of common</p>
    <p>neighbors 2. Metric property: intermediate distances linked to dij</p>
  </div>
  <div class="page">
    <p>-hop Paths  Bound dij as a function of</p>
    <p>For    we need  &gt;&gt;  to obtain similar bounds   justifies the exponentially decaying weight given to longer paths</p>
    <p>by the Katz measure</p>
    <p>Also, we can obtain much tighter bounds for long paths if shorter paths are known to exist.</p>
    <p>N,,g-11)r(rdij</p>
  </div>
</Presentation>
