<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Bohatei: Flexible and Elas2c DDoS Defense</p>
    <p>Seyed K. Fayaz, Yoshiaki Tobioka, Vyas Sekar, Michael Bailey</p>
    <p>h5ps://github.com/ddos-defense/bohatei</p>
  </div>
  <div class="page">
    <p>DDoS a5acks are geCng worse</p>
    <p>Increasing in number</p>
    <p>Threatpost, 7/31/2015</p>
    <p>The New York Times, 3/30/2015</p>
    <p>Increasing in volume Increasing in diversity</p>
    <p>Incapsula, 11/12/2014</p>
    <p>Cloudflare, 3/27/2013</p>
    <p>Imperva, 2015</p>
    <p>Techworld, 7/16/2014</p>
    <p>High cost on vicIms</p>
  </div>
  <div class="page">
    <p>Intranet</p>
    <p>DDoS Defense Today: Expensive Proprietary Hardware</p>
    <p>Assets</p>
  </div>
  <div class="page">
    <p>LimitaIon: Fixed funcIonality</p>
    <p>Intranet</p>
    <p>Assets</p>
    <p>What if new types of a5acks emerge?</p>
  </div>
  <div class="page">
    <p>LimitaIon: Fixed capacity</p>
    <p>t1 t2 t3 Ime</p>
    <p>fixed capacity</p>
    <p>a5ack vol.(Gbps)</p>
    <p>t4</p>
    <p>waste waste</p>
    <p>Intranet</p>
    <p>Assets</p>
  </div>
  <div class="page">
    <p>LimitaIon: Fixed locaIon</p>
    <p>AddiIonal traffic latency due to waypoinIng  RouIng hacks to enforce defense</p>
    <p>source</p>
    <p>desInaIon</p>
    <p>shortest path</p>
  </div>
  <div class="page">
    <p>Need flexibility w.r.t. a5ack type</p>
    <p>Today: Hardware appliance res. footprint=240Gbps Today: Hardware appliance res. footprint=240Gbps</p>
    <p>Assets</p>
  </div>
  <div class="page">
    <p>Need Flexibility w.r.t A5ack LocaIons</p>
    <p>Today: Hardware appliance res. footprint=240Gbps Today: Hardware appliance res. footprint=240Gbps</p>
    <p>Assets A</p>
    <p>B</p>
    <p>C</p>
  </div>
  <div class="page">
    <p>Need ElasIcity w.r.t. A5ack Volume</p>
    <p>Today: Hardware appliance res. footprint=240Gbps Today: Hardware appliance res. footprint=240Gbps</p>
    <p>Assets</p>
  </div>
  <div class="page">
    <p>Bohatei in a nutshell..</p>
    <p>A pracIcal ISP-scale system for Flexible and ElasIc DDoS Defense via Socware-Defined Networking (SDN) &amp; Network FuncIons VirtualizaIon (NFV)  React to 500 Gbps scale a5acks in 1 min!</p>
  </div>
  <div class="page">
    <p>Outline  MoIvaIon  Background on SDN/NFV  Bohatei overview and challenges  System design  ImplementaIon  EvaluaIon  Conclusions</p>
  </div>
  <div class="page">
    <p>Centralized management + Open config APIs</p>
    <p>Controller</p>
    <p>Flow FwdAc2on</p>
    <p>Flow FwdAc2on</p>
    <p>Flow FwdAc2on</p>
    <p>Socware-Defined Networking (SDN)</p>
  </div>
  <div class="page">
    <p>Network FuncIons VirtualizaIon (NFV)</p>
    <p>Proxy Firewall IDS/IPS AppFilter Today: Standalone and Specialized</p>
    <p>Commodity hardware</p>
  </div>
  <div class="page">
    <p>Why are SDN/NFV useful for DDoS defense?</p>
    <p>Expensive</p>
    <p>Fixed funcIonality</p>
    <p>Fixed capacity</p>
    <p>Fixed locaIon</p>
    <p>NFV</p>
    <p>SDN</p>
    <p>Our Work: Bring these benefits to DDoS Defense</p>
  </div>
  <div class="page">
    <p>Outline  MoIvaIon  Background on SDN/NFV  Bohatei overview and challenges  System design  ImplementaIon  EvaluaIon  Conclusions</p>
  </div>
  <div class="page">
    <p>Bohatei Vision: Flexible + ElasIc Defense via SDN/NFV</p>
    <p>SDN/NFV Controller</p>
    <p>DC2 DC1 customer intranet</p>
    <p>VM</p>
    <p>aJack traffic</p>
    <p>defense policy</p>
    <p>ISP</p>
  </div>
  <div class="page">
    <p>Bohatei Controller Workflow</p>
    <p>Predict a5ack pa5ern</p>
    <p>Decide how many VMs, what types, where</p>
    <p>Configure network to route traffic</p>
    <p>Strategy layer</p>
    <p>Resource management</p>
    <p>Network orchestraIon</p>
  </div>
  <div class="page">
    <p>Threat model: general, dynamic adversaries  Targets one or more customers  A5acker has a fixed budget w.r.t. total a5ack volume</p>
    <p>do{ Pick_Target() Pick_Attack_Type() Pick_Attack_Volume() Pick_Attack_Ingress() Observe_and_Adapt()</p>
    <p>}</p>
  </div>
  <div class="page">
    <p>Bohatei Design Challenges</p>
    <p>Strategy layer</p>
    <p>Resource management</p>
    <p>Network orchestraIon</p>
    <p>Resilient to adaptaIon?</p>
    <p>Fast algorithms?</p>
    <p>Scalable SDN?</p>
    <p>Predict a5ack pa5ern</p>
    <p>Decide how many VMs, what types, where</p>
    <p>Configure network to route traffic</p>
  </div>
  <div class="page">
    <p>Outline  MoIvaIon  Background on SDN/NFV  Bohatei overview and challenges  System design  ImplementaIon  EvaluaIon  Conclusions</p>
  </div>
  <div class="page">
    <p>Nave resource management is too slow!</p>
    <p>Global opImizaIon</p>
    <p>Takes hours to solve</p>
    <p>Types, numbers, and locaIons of VMs? RouIng decisions?</p>
    <p>Suspicious traffic predicIons Defense library</p>
    <p>Compute/network resources</p>
  </div>
  <div class="page">
    <p>Our Approach: Hierarchical + Greedy</p>
    <p>ISP-level Greedy</p>
    <p>Per datacenter N Per datacenter 1</p>
    <p>How much traffic to DC1</p>
    <p>Which VM slots in DC1</p>
    <p>How much traffic to DCN</p>
    <p>Which VM slots in DCN</p>
    <p>Suspicious traffic predicIons Defense library</p>
    <p>Compute/network resources</p>
  </div>
  <div class="page">
    <p>Port1 Port2</p>
    <p>Port3</p>
    <p>A reacIve, per-flow controller will be a new vulnerability</p>
    <p>VM1</p>
    <p>VM2</p>
    <p>SW</p>
    <p>Controller</p>
    <p>packet1</p>
    <p>VM3</p>
    <p>Flow outPort Switch Forwarding Table</p>
    <p>Flow1 Port 2</p>
    <p>Flow100 Port 3</p>
    <p>packet100</p>
    <p>ReacIve, per-flow isnt scalable</p>
  </div>
  <div class="page">
    <p>Port1</p>
    <p>Port 3</p>
    <p>Port 2</p>
    <p>VM1</p>
    <p>VM2</p>
    <p>VM3</p>
    <p>Idea: ProacIve tag-based steering</p>
    <p>Port 2</p>
    <p>SW</p>
    <p>Controller</p>
    <p>Port 3</p>
    <p>Context Tag Tag outPort</p>
    <p>ProacMve set up</p>
    <p>ProacIve per-VM tagging enables scaling</p>
    <p>Benign Suspicious</p>
    <p>packet1 1 packet1</p>
    <p>packet100</p>
  </div>
  <div class="page">
    <p>Dynamic adversaries can game the defense Adversarys goals:</p>
    <p>Simple predicIon (e.g., prev. epoch, avg) can be gamed</p>
    <p>t1 t2 t3 Ime</p>
    <p>SYN flood predicted aJack volume for t4</p>
    <p>A5ack vol.(Gbps)</p>
    <p>t4</p>
    <p>DNS amp.</p>
  </div>
  <div class="page">
    <p>Our approach: Online adaptaIon  Metric of Success = Regret minimizaIon  How worse than best staIc strategy in hindsight?</p>
    <p>Borrow idea from online algorithms: Follow the perturbed leader (FPL) strategy</p>
    <p>IntuiIon: PredicIon = F (Obs. History + Random Noise)  This provably minimizes the regret metric</p>
  </div>
  <div class="page">
    <p>PuCng it together</p>
    <p>PredicIon strategy</p>
    <p>launching VMs, traffic path set up</p>
    <p>predicts volume of suspicious traffic of each a5ack type at</p>
    <p>each ingress</p>
    <p>OrchestraIon</p>
    <p>quanIty, type, locaIon of VMs</p>
    <p>suspicious traffic spec.</p>
    <p>DC2 DC1 customer intranet</p>
    <p>VM</p>
    <p>aJack traffic</p>
    <p>ISP</p>
    <p>Resource management</p>
    <p>defense policy</p>
  </div>
  <div class="page">
    <p>Outline  MoIvaIon  Background on SDN/NFV  Bohatei overview and challenges  System design  ImplementaIon  EvaluaIon  Conclusions</p>
  </div>
  <div class="page">
    <p>Defense policy library</p>
    <p>Analyze Srces: count</p>
    <p>SYN  SYN/ACK per source</p>
    <p>SYNPROXY</p>
    <p>[LegiImate]</p>
    <p>OK</p>
    <p>LOG DROP</p>
    <p>[Unknown]</p>
    <p>[A5ack] [A5ack]</p>
    <p>A defense graph per a5ack type  Customized interconnecIon of defense modules  Open source defense VMs</p>
    <p>Example (SYN flood defense)</p>
    <p>[LegiImate]</p>
  </div>
  <div class="page">
    <p>ImplementaIon</p>
    <p>FlowTags-enabled defense VMs (e.g., Snort)</p>
    <p>OpenDaylight</p>
    <p>resource manager</p>
    <p>FlowTags (Fayaz et al., NSDI14)</p>
    <p>OpenFlow</p>
    <p>h5ps://github.com/ddos-defense/bohatei</p>
    <p>KVM</p>
    <p>Control Plane</p>
    <p>Data Plane</p>
    <p>defense library</p>
    <p>Switches (OVS)</p>
  </div>
  <div class="page">
    <p>Outline  MoIvaIon  Background on SDN/NFV  Bohatei overview and challenges  System design  ImplementaIon  EvaluaIon  Conclusions</p>
  </div>
  <div class="page">
    <p>EvaluaIon quesIons  Does Bohatei respond to a5acks rapidly?</p>
    <p>Can Bohatei handle 500 Gbps a5acks?</p>
    <p>Can Bohatei successfully cope with dynamic adversaries?</p>
  </div>
  <div class="page">
    <p>Responsiveness</p>
    <p>Bohatei restores performance of benign traffic  1 min.</p>
    <p>Hierarchical resource management:  A few milliseconds (vs. hours)  OpImality gap &lt; 1%</p>
    <p>B e n ig</p>
    <p>n t ra</p>
    <p>ff ic</p>
    <p>th ro</p>
    <p>u g h p u t (G</p>
    <p>b p s )</p>
    <p>Time (s)</p>
    <p>attack starts</p>
    <p>SYN flood DNS amp.</p>
    <p>Elephant flow UDP flood</p>
  </div>
  <div class="page">
    <p>Scalability: Forwarding table size</p>
    <p>Per-VM tagging cuts #rules by 3-4 orders of magnitude ProacIve setup reduces Ime by 3-4 orders of magnitude</p>
    <p>x r</p>
    <p>e q</p>
    <p>u ir e</p>
    <p>d n</p>
    <p>u m</p>
    <p>b e</p>
    <p>r o</p>
    <p>f ru</p>
    <p>le s o</p>
    <p>n a</p>
    <p>s w</p>
    <p>it c h</p>
    <p>Attack traffic volume (Gbps)</p>
    <p>Bohatei per-flow rules</p>
  </div>
  <div class="page">
    <p>Adversarial resilience</p>
    <p>Bohatei online adaptaIon strategy minimizes regret.</p>
    <p>Ran dIn</p>
    <p>gre ss</p>
    <p>Ran dAt</p>
    <p>tack</p>
    <p>Ran dHy</p>
    <p>brid</p>
    <p>Ste ady</p>
    <p>Flip Pre</p>
    <p>vEp och</p>
    <p>R e</p>
    <p>g re</p>
    <p>t w</p>
    <p>.r .t</p>
    <p>. v o</p>
    <p>lu m</p>
    <p>e o</p>
    <p>f s u</p>
    <p>c c e</p>
    <p>s s fu</p>
    <p>l a</p>
    <p>tt a</p>
    <p>c k s (</p>
    <p>% )</p>
    <p>Uniform PrevEpoch</p>
    <p>Bohatei</p>
  </div>
  <div class="page">
    <p>Conclusions</p>
    <p>DDoS defense today : Expensive, Inflexible, and InelasIc</p>
    <p>Bohatei: SDN/NFV for flexible and elasIc DDoS defense</p>
    <p>Key Challenges: Responsiveness, scalability, resilience</p>
    <p>Main soluIon ideas:  Hierarchical resource management  ProacIve, tag-based orchestraIon  Online adaptaIon strategy</p>
    <p>Ideas may be applicable to other security problems</p>
    <p>Scalable + Can react to very large a5acks quickly!</p>
  </div>
</Presentation>
