<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Combining ACID and BASE! in a distributed database</p>
    <p>Chao Xie, Chunzhi Su, Manos Kapritsos, Yang Wang,! Navid Yaghmazadeh, Lorenzo Alvisi, Prince Mahajan</p>
    <p>Salt</p>
    <p>The University of Texas at Austin</p>
  </div>
  <div class="page">
    <p>Four properties in a single abstraction</p>
    <p>Ease of programming</p>
    <p>Easy to reason about</p>
    <p>TRANSACTIONS ARE GREAT</p>
    <p>Atomicity Consistency Isolation Durability (ACID)</p>
    <p>Transaction</p>
  </div>
  <div class="page">
    <p>TRANSACTIONS ARE GREAT</p>
    <p>Concurrency control! limits performance</p>
    <p>Txn Manager Data Nodes</p>
    <p>Write(x)</p>
    <p>Commit</p>
    <p>Write(y) Phase 1</p>
    <p>Phase 2</p>
  </div>
  <div class="page">
    <p>THE ALTERNATIVE: BASE</p>
    <p>Application</p>
    <p>ACID Storage Transaction Guarantees</p>
    <p>Storage Interface</p>
  </div>
  <div class="page">
    <p>Write custom code to get better performance</p>
    <p>THE ALTERNATIVE: BASE</p>
    <p>Application</p>
    <p>BASE Storage (e.g., put, get) Storage Interface</p>
  </div>
  <div class="page">
    <p>Write custom code to get better performance</p>
    <p>Complexity gets out of control</p>
    <p>THE ALTERNATIVE: BASE</p>
    <p>Application</p>
    <p>BASE Storage (e.g., put, get)</p>
    <p>Application Implement Consistency Storage Interface</p>
  </div>
  <div class="page">
    <p>A STARK CHOICE</p>
    <p>Performance</p>
    <p>Ease of programming</p>
    <p>Ease of programming &amp; Performance</p>
    <p>ACID</p>
    <p>BASE</p>
  </div>
  <div class="page">
    <p>Vilfredo Pareto</p>
  </div>
  <div class="page">
    <p>NOT ALL TRANSACTIONS ARE CREATED EQUAL</p>
    <p>Many transactions are not run frequently  Many transactions are lightweight</p>
  </div>
  <div class="page">
    <p>AN OPPORTUNITY</p>
    <p>Txn 1 Txn 2 Identify critical transactions</p>
    <p>BASE-ify only critical transactions</p>
    <p>BASE</p>
  </div>
  <div class="page">
    <p>SALT</p>
    <p>Motivation!</p>
    <p>Base Transactions &amp; Salt Isolation!</p>
    <p>Achieving Salt Isolation!</p>
    <p>Evaluation</p>
  </div>
  <div class="page">
    <p>Transfer</p>
    <p>Is c$10?</p>
    <p>c=c-$10</p>
    <p>s=s+$10</p>
    <p>MORE CONCURRENCY ! Transfer</p>
    <p>Part1</p>
    <p>Is c$10?</p>
    <p>c=c-$10</p>
    <p>Part2</p>
    <p>s=s+$10</p>
  </div>
  <div class="page">
    <p>Transfer</p>
    <p>Is c$10?</p>
    <p>c=c-$10</p>
    <p>s=s+$10</p>
    <p>Transfer</p>
    <p>Is c$10?</p>
    <p>c=c-$10</p>
    <p>s=s+$10</p>
    <p>MORE CONCURRENCY ! Transfer</p>
    <p>Part1</p>
    <p>Is c$10?</p>
    <p>c=c-$10</p>
    <p>Part2</p>
    <p>s=s+$10</p>
    <p>Transfer</p>
    <p>Part1</p>
    <p>Is c$10?</p>
    <p>c=c-$10</p>
    <p>Part2</p>
    <p>s=s+$10</p>
    <p>Time</p>
  </div>
  <div class="page">
    <p>Transfer</p>
    <p>Is c$10?</p>
    <p>c=c-$10</p>
    <p>s=s+$10</p>
    <p>CORRECTNESS AT RISK</p>
    <p>Read c</p>
    <p>Read s</p>
    <p>Balance</p>
  </div>
  <div class="page">
    <p>Part2</p>
    <p>s=s+$10</p>
    <p>Part1</p>
    <p>Is c$10?</p>
    <p>c=c-$10</p>
    <p>CORRECTNESS AT RISK Transfer</p>
    <p>Read c</p>
    <p>Read s</p>
    <p>Balance Exposed !</p>
    <p>state</p>
  </div>
  <div class="page">
    <p>Part2</p>
    <p>s=s+$10</p>
    <p>Finer Isolation for one transaction! may affect all transactions!!</p>
    <p>Part1</p>
    <p>Is c$10?</p>
    <p>c=c-$10</p>
    <p>CORRECTNESS AT RISK</p>
    <p>Read c</p>
    <p>Read s</p>
    <p>Balance</p>
  </div>
  <div class="page">
    <p>Performance vs Complexity</p>
    <p>Better Performance</p>
    <p>More Interleavings!</p>
    <p>More Complexity</p>
  </div>
  <div class="page">
    <p>Performance vs Complexity</p>
    <p>Better Performance</p>
    <p>Other Transactions Unaffected</p>
    <p>More Interleavings ! (only among perf-critical txns)</p>
  </div>
  <div class="page">
    <p>s=s+$10</p>
    <p>Is c$10?</p>
    <p>c=c-$10</p>
    <p>Behaves differently when interacting with different transactions</p>
    <p>Balance</p>
    <p>Read c</p>
    <p>Read s</p>
    <p>Transfer 2</p>
    <p>Is c$10?</p>
    <p>c=c-$10</p>
    <p>s=s+$10</p>
    <p>Transfer 1</p>
  </div>
  <div class="page">
    <p>Balance</p>
    <p>Read c</p>
    <p>Read s</p>
    <p>Time</p>
    <p>Transfer 2</p>
    <p>Is c$10?</p>
    <p>c=c-$10</p>
    <p>s=s+$10</p>
    <p>Transfer 1</p>
    <p>Is c$10?</p>
    <p>c=c-$10</p>
    <p>s=s+$10</p>
  </div>
  <div class="page">
    <p>BASE TRANSACTION BASE</p>
    <p>transaction</p>
    <p>alkaline txn</p>
    <p>alkaline txn</p>
    <p>Behaves differently when interacting with different transactions</p>
  </div>
  <div class="page">
    <p>BASE INTERACT WITH BASE</p>
    <p>Fine Isolation granularity! between BASE transactions</p>
    <p>BASE 1</p>
    <p>BASE 2</p>
  </div>
  <div class="page">
    <p>BASE INTERACT WITH BASE</p>
    <p>Fine Isolation granularity! between BASE transactions</p>
  </div>
  <div class="page">
    <p>BASE</p>
    <p>BASE INTERACT WITH ACID</p>
    <p>ACID</p>
    <p>BASE transactions provide coarse Isolation! granularity to ACID transactions</p>
  </div>
  <div class="page">
    <p>BASE</p>
    <p>BASE INTERACT WITH ACID ACID</p>
    <p>BASE transactions provide coarse Isolation! granularity to ACID transactions</p>
  </div>
  <div class="page">
    <p>SALT ISOLATION</p>
    <p>Performance &amp; Ease of Programming</p>
    <p>BASE transactions: multiple granularities of Isolation</p>
    <p>To ACID transactions:! a single, monolithic ! ACID transaction</p>
    <p>To BASE transactions:! a sequence of small ! ACID transactions</p>
  </div>
  <div class="page">
    <p>SALT</p>
    <p>Motivation!</p>
    <p>Base Transactions &amp; Salt Isolation!</p>
    <p>Achieving Salt Isolation!</p>
    <p>Evaluation</p>
  </div>
  <div class="page">
    <p>ONE MECHANISM</p>
    <p>LOCKS</p>
    <p>ACID locks! Alkaline locks! Saline locks</p>
    <p>Three flavors</p>
  </div>
  <div class="page">
    <p>ACID LOCKS</p>
    <p>Lock Table</p>
    <p>ACID 1</p>
    <p>Write x AC-R AC-W</p>
    <p>AC-R  X AC-W X XACID 2</p>
    <p>Read x</p>
    <p>Execute</p>
  </div>
  <div class="page">
    <p>LOCKS?</p>
    <p>ACID</p>
    <p>Rx</p>
    <p>BASE</p>
    <p>Rx</p>
    <p>Execute</p>
    <p>Execute</p>
    <p>BASE</p>
    <p>Wx</p>
  </div>
  <div class="page">
    <p>LOCKS?</p>
    <p>ACID</p>
    <p>Rx</p>
    <p>BASE</p>
    <p>Rx</p>
    <p>Execute</p>
    <p>Execute</p>
    <p>alkaline lock</p>
    <p>saline lock</p>
    <p>BASE</p>
    <p>Wx</p>
  </div>
  <div class="page">
    <p>ALKALINE LOCKS</p>
    <p>AC-R AC-W alk-R alk-W</p>
    <p>AC-R  X  X AC-W X X X X alk-R  X  X alk-W X X X X</p>
    <p>ACID</p>
    <p>Rx</p>
    <p>BASE</p>
    <p>Rx</p>
    <p>Lock Table</p>
    <p>alkaline lock</p>
    <p>Wait Wait</p>
    <p>BASE</p>
    <p>Wx</p>
    <p>Conflict with ACID &amp; alkaline locks</p>
  </div>
  <div class="page">
    <p>SALINE LOCKS</p>
    <p>ACID</p>
    <p>Rx</p>
    <p>Wait</p>
    <p>saline lock</p>
    <p>AC-R AC-W alk-R alk-W sal-R sal-W</p>
    <p>AC-R  X  X  X AC-W X X X X X X alk-R  X  X alk-W X X X X sal-R  X sal-W X X</p>
    <p>Lock Table</p>
    <p>AC-R AC-W alk-R alk-W sal-R sal-W</p>
    <p>AC-R  X  X  X AC-W X X X X X X alk-R  X  X   alk-W X X X X   sal-R  X     sal-W X X</p>
    <p>Lock Table</p>
    <p>BASE</p>
    <p>Wx</p>
    <p>Conflict only with ACID locks</p>
  </div>
  <div class="page">
    <p>A SUBTLE PROBLEM</p>
    <p>ACID reads uncommitted value of x!</p>
    <p>BASE</p>
    <p>W x BASE</p>
    <p>R x</p>
    <p>y=x</p>
    <p>ACID</p>
    <p>R y</p>
    <p>Dirty Read!</p>
  </div>
  <div class="page">
    <p>A SUBTLE PROBLEM</p>
    <p>For the solution, please read our paper</p>
    <p>BASE</p>
    <p>W x BASE</p>
    <p>R x</p>
    <p>y=x</p>
    <p>ACID</p>
    <p>R y</p>
    <p>Dirty Read!</p>
  </div>
  <div class="page">
    <p>THE BOTTOM LINE</p>
    <p>Guarantee!</p>
    <p>Salt prevents all ACID transactions from being affected by BASE transactions either directly or indirectly.</p>
  </div>
  <div class="page">
    <p>SALT</p>
    <p>Motivation!</p>
    <p>Base Transactions &amp; Salt Isolation!</p>
    <p>Achieving Salt Isolation!</p>
    <p>Evaluation</p>
  </div>
  <div class="page">
    <p>What is the performance gain of Salt compared to ACID?</p>
    <p>Can we get most performance gain compared to the BASE approach?</p>
    <p>QUESTIONS TO ANSWER</p>
  </div>
  <div class="page">
    <p>EXPERIMENTAL SETUP Configuration!</p>
    <p>Emulab Cluster (Dell Power Edge R710)!  10 shards, 3-way replicated!</p>
    <p>Workloads!  TPC-C!  Fusion Ticket!  Microbenchmarks</p>
  </div>
  <div class="page">
    <p>PERFORMANCE GAIN</p>
    <p>La te</p>
    <p>nc y</p>
    <p>(m s) 200</p>
    <p>Fusion Ticket</p>
    <p>Throughput (transactions/sec)</p>
    <p>ACID Salt</p>
  </div>
  <div class="page">
    <p>REAP MOST PERFORMANCE OF BASE Fusion Ticket</p>
    <p>Th ro</p>
    <p>ug hp</p>
    <p>ut (t</p>
    <p>ra ns</p>
    <p>ac tio</p>
    <p>ns /s</p>
    <p>ec ) 10000</p>
    <p>Number of BASE-ified transactions</p>
    <p>ACID 1 2 Raw ops</p>
  </div>
  <div class="page">
    <p>RELATED WORK</p>
    <p>Optimizing ACID Performance!  H-Store, Granola, F1, Sagas, Transaction Chain, Calvin !</p>
    <p>!</p>
    <p>BASE with enhanced semantics (e.g., partition local transactions)!  ElasTras, G-Store, Megastore</p>
  </div>
  <div class="page">
    <p>SALT</p>
    <p>Key Abstraction! Base Transaction</p>
    <p>Pain Point Transactional systems !</p>
    <p>do not scale</p>
    <p>Promising! Results</p>
  </div>
</Presentation>
