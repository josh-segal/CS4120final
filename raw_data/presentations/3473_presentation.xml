<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>End-to-End Measurements of Email Spoofing Attacks</p>
    <p>Hang Hu, Gang Wang hanghu@vt.edu</p>
    <p>Computer Science, Virginia Tech</p>
  </div>
  <div class="page">
    <p>Spear Phishing is a Big Threat</p>
    <p>Spear phishing: targeted phishing attack, often involves impersonation  91% of targeted attacks involve spear phishing1</p>
    <p>95% of state-affiliated espionage attacks are traced to phishing2</p>
  </div>
  <div class="page">
    <p>Real-life Spear Phishing Examples</p>
    <p>Yahoo Data Breach in 2014 Affected 500 Million Yahoo! User Account</p>
    <p>John Podestas Gmail Account Hillary Clinton 2016 Campaign Chairman</p>
    <p>From Google [accounts.googlemail.com]</p>
    <p>Why can phishers still impersonate others so easily?</p>
  </div>
  <div class="page">
    <p>I Performed a Spear Phishing Test</p>
    <p>I impersonated USENIX Security co-chairs to send spoofing emails to my account (hanghu@vt.edu)</p>
    <p>Adrienne Porter Felt felt@chromium.org</p>
    <p>William Enck whenck@ncsu.edu</p>
    <p>From Adrienne Porter Felt felt@chromium.org</p>
    <p>Auto-loaded Profile Picture</p>
    <p>From William Enck whenck@ncsu.edu</p>
  </div>
  <div class="page">
    <p>Background: SMTP &amp; Spoofing</p>
    <p>Simple Mail Transfer Protocol (SMTP) defined in 1982  SMTP has no built-in authentication mechanism  Spoof anyone by modifying MAIL FROM field of SMTP</p>
    <p>William ncsu.edu Mail Server</p>
    <p>HTTP SMTP SMTP</p>
    <p>vt.edu Mail Server</p>
    <p>HTTP POP IMAP</p>
    <p>Hang</p>
    <p>Attacker Mail Server</p>
    <p>SMTP MAIL FROM: whenck@ncsu.edu</p>
  </div>
  <div class="page">
    <p>Existing Anti-spoofing Protocols</p>
    <p>Sender Policy Framework (SPF), 2002  IP based authentication</p>
    <p>ncsu.edu</p>
    <p>vt.edu</p>
    <p>MAIL FROM: whenck@ncsu.edu IP: 1.2.3.4</p>
    <p>Is the IP aut</p>
    <p>horize d?</p>
    <p>DNS</p>
    <p>Yes</p>
    <p>DomainKeys Identified Mail (DKIM), 2004  Public key based authentication</p>
    <p>Domain-based Message Authentication, Reporting and Conformance (DMARC), 2015  Based on SPF and DKIM  Publish policy</p>
    <p>SMTP, 1982</p>
    <p>Publish</p>
    <p>SPF Record</p>
    <p>Attacker</p>
    <p>MAIL FROM: whenck@ncsu.edu IP: 5.6.7.8</p>
    <p>Is the IP aut</p>
    <p>horize d?</p>
    <p>No</p>
    <p>SPF Process</p>
  </div>
  <div class="page">
    <p>How Widely are Anti-spoofing Protocols Used?</p>
    <p>Scanned SPF and DMARC records of Alexa top 1 million domains  When an email fails SPF/DMARC:</p>
    <p>- Relaxed: No recommending policy</p>
    <p>- Strict: Rejecting failed emails</p>
    <p>Less than</p>
    <p>Around 5%</p>
    <p>After years, the adoption rates are still low</p>
    <p>And they also increase slowly</p>
  </div>
  <div class="page">
    <p>This Study</p>
    <p>Research questions - How do email providers detect and handle spoofing emails? - Under what conditions can spoofing emails penetrate the defense? - Once spoofing emails get in, how do email providers warn users?</p>
    <p>Measurement + user study - 35 popular email providers reaction to spoofing emails - A user study (N=488) to examine users reaction to warnings</p>
  </div>
  <div class="page">
    <p>Outline</p>
    <p>Introduction</p>
    <p>End-to-end Spoofing Experiments</p>
    <p>User Study</p>
  </div>
  <div class="page">
    <p>End-to-end Spoofing Experiments</p>
    <p>SMTP</p>
    <p>Target Email Server Gmail.com</p>
    <p>Email Client test@gmail.com</p>
    <p>IMAP POP</p>
    <p>MAIL FROM: forged@A.com</p>
    <p>Goal: Understand how email providers handle spoofing emails  Method:</p>
    <p>- Black-box testing - Control input and observe output</p>
    <p>Register our own accounts as email receivers  Change input email</p>
  </div>
  <div class="page">
    <p>Target Email Providers  35 Email providers</p>
    <p>Full Authentication Check (16) Partial Authentication (15) No Authentication (4)</p>
    <p>Our Mail Server Target Email Server</p>
    <p>Email Client test@T.com</p>
  </div>
  <div class="page">
    <p>Controlled Parameters for Spoofing Emails</p>
    <p>Spoofed Sender x 30 SPF/DKIM, strict policy (x10) SPF/DKIM, relaxed policy (x10) No SPF/DKIM/DMARC (x10)</p>
    <p>Content x 5 Phishing, Benign Blank, Blank w/ URL, Blank w/ attachment</p>
    <p>IP x 2 Static, Dynamic</p>
    <p>Our Mail Server</p>
    <p>Email Client test@gmail.com</p>
    <p>Spoofing Email</p>
    <p>Experiment Setup  Repeat 5 times  Randomized sending order  30 x 5 x 2 x 5 = 1500 emails per service  1500 x 35 = 52500 emails in total  Carefully controlled sending rate</p>
    <p>Target Email Server</p>
    <p>IRB Approved</p>
  </div>
  <div class="page">
    <p>Full Authentication Check Check SPF/DKIM but not DMARC No Authentication</p>
    <p>Email providers still let spoofing emails in even if they conduct authentication check</p>
    <p>Penetration Rate</p>
  </div>
  <div class="page">
    <p>Strict Relaxed None</p>
    <p>Full Authentication 0.13 0.45 0.6</p>
    <p>Receiver Partial Authentication</p>
    <p>No Authentication 0.94 0.95 0.94</p>
    <p>Spoofed Sender Address Profile</p>
    <p>Impacting Factors</p>
    <p>IP Penetration Rate Static 0.60</p>
    <p>Dynamic 0.34</p>
    <p>Penetration Rate</p>
    <p>Strict: SPF/DKIM, Strict DMARC policy Relaxed: SPF/DKIM, Relaxed DMARC policy None: No SPF/DKIM/DMARC</p>
    <p>Full Authentication: Check SPF &amp; DKIM &amp; DMARC Partial Authentication: Check SPF/DKIM, not DMARC No Authentication: Dont check SPF/DKIM/DMARC</p>
    <p>Sender strict policy Receiver full authentication The penetration rate is lowest but still 13%</p>
    <p>When sender didnt publish authentication records, the penetration rate is the highest</p>
    <p>When receiver doesnt do authentication, the penetration rates are more than 94%</p>
    <p>Content Phishing Benign Blank Blank w/ URL Blank w/ attachment Penetration Rate 0.457 0.495 0.467 0.428 0.427</p>
  </div>
  <div class="page">
    <p>How Do Email Providers Give Warning</p>
    <p>Gmail</p>
    <p>Naver</p>
    <p>Protonmail</p>
    <p>Mail.ru</p>
    <p>Web Mobile</p>
  </div>
  <div class="page">
    <p>Outline</p>
    <p>Introduction</p>
    <p>End-to-end Spoofing Experiments</p>
    <p>User Study</p>
  </div>
  <div class="page">
    <p>Method - Try to make users not aware they are in an experiment</p>
    <p>to capture realistic reaction - Inform users after experiment - Users can withdraw data anytime with payment</p>
    <p>How Effective are These Security Indicators</p>
    <p>IRB Approved</p>
    <p>Challenge - How to capture the realistic user reactions? - Lab experiment has limited ability to reflect reality [3]</p>
    <p>Research Questions - How do users react to spoofing emails? - How effective are warnings?</p>
  </div>
  <div class="page">
    <p>Phase 1/2: Set Up Deception</p>
    <p>Frame the study as a survey to understand email using habits - Ask for users email address - Send the participant an email with 1x1 tracking pixel - Ask questions about the email using habits and other distraction questions - Pay users and make users believe the survey is over</p>
    <p>Purpose: - Collect and validate users email addresses - Test if the tracking pixel works</p>
  </div>
  <div class="page">
    <p>Phase 2/2: Sending Actual Spoofing Emails</p>
    <p>From Amazon Mechanical Turk &lt;support@mturk.com&gt;</p>
    <p>A link points to our server</p>
    <p>Invisible Tracking Pixel</p>
    <p>Embedded Warning</p>
    <p>Wait for another 20 days and send debriefing emails  Wait for 10 days and send users spoofing emails</p>
  </div>
  <div class="page">
    <p>Deception User Study: Recruiting Participants</p>
    <p>Amazon Mechanical Turk  Recruited 488 users</p>
    <p>- 243 in no warning group - 245 in warning group</p>
    <p>Male 49%</p>
    <p>Female 51%</p>
    <p>Gender</p>
    <p>&lt;= 29 32%</p>
    <p>&gt;=50 14%</p>
    <p>Age high-school 10%</p>
    <p>some college 34%bachelor</p>
    <p>graduate 21%</p>
    <p>Education</p>
  </div>
  <div class="page">
    <p>Deception User Study: Results</p>
    <p>Phase Users Without Warning With Warning Phase 1 All Participants</p>
    <p>Not Blocking Pixel 243 176</p>
    <p>Phase 2 Opened Email Clicked URL</p>
    <p>Click Rate Overall After Opening Email</p>
  </div>
  <div class="page">
    <p>Discussion</p>
    <p>A big gap between server detection and user protection - Most email providers let spoofing emails reach inbox - Most email providers lack necessary warnings - Warnings cant fully eliminate the risk</p>
    <p>Countermeasures - Promote SPF, DKIM and DMARC - Place warning consistently across web and mobile clients</p>
    <p>Future work  Design more effective warnings  Defeat warning fatigue  User training and education</p>
  </div>
  <div class="page">
    <p>Thank You 23</p>
  </div>
  <div class="page">
    <p>Deception User Study: Results</p>
  </div>
  <div class="page">
    <p>Things are Worse with Less Popular Domains</p>
  </div>
  <div class="page">
    <p>Misleading UI Elements</p>
    <p>When spoofing existing contacts or conducting same-domain spoofing</p>
    <p>Profile Picture Name Card Email History</p>
    <p>Web MobileWeb &amp; Mobile</p>
    <p>Web MobileWeb &amp; Mobile WebWeb &amp; Mobile</p>
  </div>
  <div class="page">
    <p>Misleading UI Elements</p>
    <p>Seznam.cz</p>
  </div>
  <div class="page">
    <p>Spoofing is a Critical Step in Spear Phishing</p>
    <p>Email spoofing is widely used in spear phishing attacks - Business email compromise (BEC) scams became a major problem in 20153 - Use similar domain names or spoofed domain names3</p>
  </div>
  <div class="page">
    <p>Link</p>
    <p>Virginia Tech 2017</p>
    <p>From Virginia Tech [vt.edu]</p>
  </div>
  <div class="page">
    <p>Misleading UI Elements</p>
    <p>Auto-loaded Profile Picture</p>
    <p>False Security Cue</p>
    <p>Auto-loaded name card and email history</p>
  </div>
  <div class="page">
    <p>Deception User Study: Results</p>
    <p>Users Without Indicator With Indicator Desktop Mobile Desktop Mobile</p>
    <p>Opened Email 45 49 41 45 Clicked URL 21 25 15 17 Click Rate 46.7% 51.0% 36.6% 37.8%</p>
  </div>
  <div class="page">
    <p>End-to-end Spoofing Experiments: Results</p>
    <p>Hotmail.com blocked all forged email</p>
    <p>Email providers still let forged emails in even if they conduct authentication check</p>
  </div>
  <div class="page">
    <p>End-to-end Spoofing Experiments: Results</p>
    <p>Email providers still let forged emails in even if they conduct authentication check</p>
  </div>
  <div class="page">
    <p>End-to-end Spoofing Experiments: Results</p>
    <p>No authentication group let almost all forged emails in</p>
  </div>
  <div class="page">
    <p>End-to-end Spoofing Experiments: Results</p>
    <p>IP Authentication Static Dynamic Full Authentication 0.57 0.27 Check SPF DKIM But not DMARC</p>
    <p>No authentication 0.95 0.94</p>
  </div>
</Presentation>
