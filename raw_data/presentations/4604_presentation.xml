<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>ANNIE Conference November 10, 2008</p>
    <p>Predicting Links and Link Change in Friends Networks: Supervised Time Series Learning with</p>
    <p>Imbalanced Data</p>
    <p>William H. Hsu, Tim Weninger and Martin S.R. Paradesi Department of Computing and Information Sciences</p>
    <p>Kansas State University, Manhattan KS</p>
    <p>ANNIE 2008 St. Louis, MO USA</p>
  </div>
  <div class="page">
    <p>ANNIE Conference November 10, 2008</p>
    <p>Outline</p>
    <p>Introduction  Background</p>
    <p>Friends networks  Methodologies for link mining</p>
    <p>Atemporal data set  Temporal data set</p>
    <p>Link prediction vs change prediction</p>
    <p>Experiment Design  LJCrawler 3.0  Prediction Tasks  Handling imbalanced data</p>
    <p>Results  Conclusions and Future Work</p>
  </div>
  <div class="page">
    <p>ANNIE Conference November 10, 2008</p>
    <p>Introduction</p>
    <p>Problem Definition  Given: records of users of a social network service  Discover:</p>
    <p>Features of entities: users, communities  Relationships: friendship, membership  Explanations and predictions for relationships</p>
  </div>
  <div class="page">
    <p>ANNIE Conference November 10, 2008</p>
    <p>Background</p>
    <p>What are friends networks?</p>
  </div>
  <div class="page">
    <p>ANNIE Conference November 10, 2008</p>
    <p>Rationale  Friendships change:</p>
    <p>From: Andrew Chen - http://andrewchenblog.com/2008/01/07/does-facebook-reflect-your-true-friendships-how-about-e-mail/</p>
    <p>We would like to predict those changes</p>
  </div>
  <div class="page">
    <p>ANNIE Conference November 10, 2008</p>
    <p>Methodologies for Link Prediction [1]</p>
    <p>u v</p>
    <p>u vu v</p>
    <p>u v</p>
    <p>u v</p>
    <p>Node-Dependent Features: specific to one node (vertex) within candidate pair</p>
    <p>Indegree (u) Source</p>
    <p>popularity</p>
    <p>Outdegree (u) Source fertility</p>
    <p>Outdegree (v) Target</p>
    <p>fertility</p>
    <p>Indegree (v) Target</p>
    <p>popularity</p>
    <p>Pair-Dependent Features: specific to one candidate pair of nodes (vertices)</p>
    <p>Link-Dependent Features: specific to one link (edge) in directed graph</p>
    <p>u v Common entities: interests, friends, schools, etc. Attributes of common entities</p>
    <p>Computed from relational query on entities u, v</p>
    <p>Past, predicted duration Diagnosed cause</p>
    <p>Computed and stored with relationship set</p>
    <p>Atemporal features:</p>
  </div>
  <div class="page">
    <p>ANNIE Conference November 10, 2008</p>
    <p>Methodologies for Link Prediction [2]</p>
    <p>Temporal Features  There are none!</p>
    <p>(we must discover them)</p>
    <p>Link Prediction vs Change Prediction</p>
    <p>We know how to do link prediction  (see our work in AAAI-SS'06, ICWSM'07)</p>
    <p>This work is specifically on detecting changes in links</p>
  </div>
  <div class="page">
    <p>ANNIE Conference November 10, 2008</p>
    <p>Experiment Design [1]</p>
    <p>LJCrawler v3  Crawled LiveJournal in a breadth-first manner  Gathering friends, interests, communities, etc.</p>
    <p>Max bandwidth allowed for 200 users/sec. per computer  LiveJournal terms of service allowed for 5 users/sec.</p>
    <p>(I obliged)</p>
    <p>Crawler was run for three hours, every six hours for seven days  09/27/2007 00:00 CST  10/03/2007 18:00 CST  28 total crawls.</p>
    <p>Mostly of the same users</p>
  </div>
  <div class="page">
    <p>ANNIE Conference November 10, 2008</p>
    <p>Prediction Tasks</p>
    <p>First:  Identify changes from the first crawl and the final crawl  A true label is annotated iff (u, v)  Ei and (u, v)  Ef.</p>
    <p>Second:  Learning from incremental differences:</p>
    <p>Where ft-k is the feature tuple from the crawl at time t-k  (k crawls ago)</p>
  </div>
  <div class="page">
    <p>ANNIE Conference November 10, 2008</p>
    <p>Handling Imbalanced Data</p>
    <p>Relatively few changes in six hours.  Therefore there are relatively few positive examples</p>
    <p>Downsample negative examples  Upsample positive examples</p>
    <p>Fixed Ratio (FR)  Positive : Negative examples = 1:1</p>
    <p>Fixed Count (FC)  Random sample: Negative &gt;&gt; Postive</p>
    <p>Kubat M., Matwin S., 1997, Addressing the Curse of Imbalanced Training Sets: One-Sided Selection, In Proceedings of the 14th International Conference on Machine Learning (ICML'97), pp. 179-186.</p>
  </div>
  <div class="page">
    <p>ANNIE Conference November 10, 2008</p>
    <p>Experiments</p>
    <p>Data for 1000, 2000, 4000 pairs  Fixed Ratio (FR) with Graph Features  FR without Graph Features  Fixed Count (FC) with Graph Features  FC without Graph Features</p>
    <p>WEKA was used to train classifiers  FR/FC</p>
    <p>Train with 1:1 data test with random data</p>
    <p>FC/FC  Test with 10-fold cross validation</p>
  </div>
  <div class="page">
    <p>ANNIE Conference November 10, 2008</p>
    <p>Results [1]</p>
    <p>J48  Atemporal data  Predicting becomeFriends</p>
    <p>Class: yes iff u, v were not friends before T0 and were friends after T28</p>
    <p>FR/FC FC/FC Graph Features (%) All Features (%) Graph Features (%) All Features (%)</p>
    <p>m Acc. Prec. Rec. Acc. Prec. Rec. Acc. Prec. Rec. Acc. Prec. Rec. 1000 83.0 2.0 100.0 83.0 2.0 100.0 99.5 0.0 0.0 99.3 0.0 0.0 2000 90.7 4.6 90.0 92.1 5.0 90.0 99.5 0.0 0.0 99.4 33.3 2.0 4000 95.1 2.0 66.7 92.6 2.0 100.0 99.9 0.0 0.0 99.7 11.1 16.7</p>
  </div>
  <div class="page">
    <p>ANNIE Conference November 10, 2008</p>
    <p>Results[2]</p>
    <p>Incremental time series task  The realignment allows the inducer to learn temporal</p>
    <p>actions that may lead to changes in the friendship status of a pair.</p>
    <p>FR/FR - cross validation</p>
  </div>
  <div class="page">
    <p>ANNIE Conference November 10, 2008</p>
    <p>Results[3]</p>
    <p>FR/FC  train with FR test with FC</p>
  </div>
  <div class="page">
    <p>ANNIE Conference November 10, 2008</p>
    <p>Results[4]</p>
    <p>FC/FC  train with FR test with FC</p>
  </div>
  <div class="page">
    <p>ANNIE Conference November 10, 2008</p>
    <p>Conclusions</p>
    <p>We are able to learn a predictor for the time series problem.</p>
    <p>Handling imbalanced data:  FR/FR  Does not represent the data  FC/FC  Does not train a classifier very well  FR/FC  Probably the most appropriate predictor</p>
    <p>High recall, low precision, and decent accuracy</p>
    <p>Future Work  Better, more descriptive, time series features should be</p>
    <p>discovered.  Apply prepossessing to the feature vector</p>
  </div>
  <div class="page">
    <p>ANNIE Conference November 10, 2008</p>
    <p>Questions?</p>
  </div>
</Presentation>
