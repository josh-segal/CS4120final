<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Kevin Bock</p>
    <p>Detecting and Evading Censorship in Depth: A Case Study of Irans Protocol Filter</p>
    <p>Yair Fax, Kyle Reese, Jasraj Singh, Dave Levin</p>
  </div>
  <div class="page">
    <p>Iranian Censorship</p>
    <p>Client Server !</p>
    <p>!</p>
  </div>
  <div class="page">
    <p>Iranian Censorship</p>
    <p>Client Server !</p>
    <p>!</p>
  </div>
  <div class="page">
    <p>Iranian Censorship</p>
    <p>Client Server !</p>
    <p>!</p>
  </div>
  <div class="page">
    <p>Iranian Censorship</p>
    <p>Client Server !</p>
    <p>!</p>
    <p>Deep-packet inspection for keywords</p>
    <p>Censors DNS, HTTP, HTTPS</p>
    <p>Applies to all destination IP addresses</p>
    <p>Typically injects dummy responses or blackholes</p>
  </div>
  <div class="page">
    <p>Iranian Censorship</p>
    <p>Client Server !</p>
    <p>!</p>
    <p>Deep-packet inspection for keywords</p>
    <p>Censors DNS, HTTP, HTTPS</p>
    <p>Applies to all destination IP addresses</p>
    <p>February 2020 Typically injects dummy responses or blackholes</p>
  </div>
  <div class="page">
    <p>Iranian Censorship</p>
    <p>Client Server !</p>
    <p>!</p>
    <p>Censored before keywords</p>
    <p>Censors DNS, HTTP, HTTPS</p>
    <p>February 2020</p>
    <p>Applies to all destination IP addresses</p>
    <p>Typically injects dummy responses or blackholes</p>
  </div>
  <div class="page">
    <p>Iranian Censorship</p>
    <p>Client Server !</p>
    <p>!</p>
    <p>Censored before keywords</p>
    <p>Censors DNS, HTTP, HTTPS</p>
    <p>February 2020</p>
    <p>Applies to all destination IP addresses</p>
    <p>No injections; only packet drops</p>
  </div>
  <div class="page">
    <p>Iranian Censorship</p>
    <p>Client Server !</p>
    <p>!</p>
    <p>Censored before keywords</p>
    <p>Censors DNS, HTTP, HTTPS</p>
    <p>Applied only to some destinations</p>
    <p>No injections; only packet drops February 2020</p>
    <p>!</p>
  </div>
  <div class="page">
    <p>Irans Protocol Filter</p>
    <p>Client Server ! !</p>
  </div>
  <div class="page">
    <p>Irans Protocol Filter</p>
    <p>Client Server ! !</p>
    <p>Protocol filter</p>
    <p>Standard censorship</p>
  </div>
  <div class="page">
    <p>Irans Protocol Filter</p>
    <p>Client Server ! !</p>
    <p>Protocol filter</p>
    <p>Standard censorship</p>
    <p>Drops connections from unrecognized protocols</p>
    <p>Matches connections to protocol fingerprints</p>
    <p>Applies only to some destinations</p>
  </div>
  <div class="page">
    <p>Irans Protocol Filter</p>
    <p>Client Server ! !</p>
    <p>Protocol filter</p>
    <p>Standard censorship</p>
    <p>Drops connections from unrecognized protocols</p>
    <p>Matches connections to protocol fingerprints</p>
    <p>Applies only to some destinations</p>
    <p>Composes with standard censorship, creating censorship-in-depth</p>
  </div>
  <div class="page">
    <p>Irans Protocol Filter</p>
    <p>How the protocol filter works</p>
    <p>Client-side and server-side</p>
    <p>How the filter can be defeated</p>
    <p>Packet manipulation strategies</p>
    <p>How it censors connections</p>
    <p>How it fingerprints connections</p>
  </div>
  <div class="page">
    <p>Irans Protocol Filter</p>
    <p>How the protocol filter works</p>
    <p>Client-side and server-side</p>
    <p>How the filter can be defeated</p>
    <p>Packet manipulation strategies</p>
    <p>How it censors connections</p>
    <p>How it fingerprints connections</p>
  </div>
  <div class="page">
    <p>How it fingerprints connections</p>
    <p>HTTP</p>
    <p>HTTPS</p>
    <p>Only monitors:</p>
    <p>Port 53</p>
    <p>Port 80</p>
    <p>Port 443</p>
    <p>DNS</p>
    <p>Only matches on TCP2</p>
    <p>Performs deep packet inspection1</p>
    <p>Only allows:3 4</p>
  </div>
  <div class="page">
    <p>How it fingerprints connections</p>
    <p>HTTP</p>
    <p>HTTPS</p>
    <p>Only monitors:</p>
    <p>Port 53</p>
    <p>Port 80</p>
    <p>Port 443</p>
    <p>DNS</p>
    <p>Only matches on TCP2</p>
    <p>Performs deep packet inspection1</p>
    <p>Only allows:3 4</p>
  </div>
  <div class="page">
    <p>Protocol-specific Fingerprints</p>
    <p>HTTP</p>
    <p>HTTPS</p>
    <p>DNS</p>
  </div>
  <div class="page">
    <p>FingerprintDNS</p>
    <p>TCP payload  12 bytes long Query/response field = 0 Question count &lt; 15 Answer count = 0 Must have a valid DNS-over-UDP header</p>
    <p>Violating any of these results in censorship</p>
  </div>
  <div class="page">
    <p>DNS header</p>
    <p>FingerprintDNS</p>
  </div>
  <div class="page">
    <p>DNS header</p>
    <p>FingerprintDNS</p>
    <p>The filter only applies to DNS-over-TCP</p>
  </div>
  <div class="page">
    <p>DNS header</p>
    <p>FingerprintDNS</p>
    <p>DNS header</p>
    <p>The filter only applies to DNS-over-TCP</p>
  </div>
  <div class="page">
    <p>DNS header</p>
    <p>FingerprintDNS</p>
    <p>DNS header</p>
    <p>The filter only applies to DNS-over-TCP</p>
  </div>
  <div class="page">
    <p>Length DNS header</p>
    <p>FingerprintDNS</p>
    <p>DNS header</p>
    <p>The filter only applies to DNS-over-TCP</p>
  </div>
  <div class="page">
    <p>Length DNS header</p>
    <p>FingerprintDNS</p>
    <p>DNS header</p>
    <p>The filter only applies to DNS-over-TCP</p>
    <p>Irans protocol filter never permits DNS-over-TCP</p>
  </div>
  <div class="page">
    <p>Protocol-specific Fingerprints</p>
    <p>Matches for DNS-over-UDP header</p>
    <p>HTTP</p>
    <p>HTTPS</p>
    <p>Matches for most HTTP verbs</p>
    <p>Matches on the TLS ClientHello</p>
    <p>DNS</p>
    <p>Details for each in the paper</p>
  </div>
  <div class="page">
    <p>How the filter censors connections</p>
    <p>Client Server !</p>
    <p>Drops all packets from the client</p>
  </div>
  <div class="page">
    <p>How the filter censors connections</p>
    <p>Client Server !</p>
    <p>Drops all packets from the client</p>
  </div>
  <div class="page">
    <p>How the filter censors connections</p>
    <p>Client Server !</p>
    <p>Drops all packets from the client</p>
  </div>
  <div class="page">
    <p>How the filter censors connections</p>
    <p>Client Server !</p>
    <p>Drops all packets from the client</p>
    <p>Deep packet inspection</p>
  </div>
  <div class="page">
    <p>How the filter censors connections</p>
    <p>Client Server !</p>
    <p>!</p>
    <p>Drops all packets from the client</p>
  </div>
  <div class="page">
    <p>How the filter censors connections</p>
    <p>Client Server !</p>
    <p>!</p>
    <p>Drops all packets from the client</p>
  </div>
  <div class="page">
    <p>How the filter censors connections</p>
    <p>Client Server !</p>
    <p>!</p>
    <p>Drops all packets from the client after the first non-matching packet</p>
  </div>
  <div class="page">
    <p>How the filter censors connections</p>
    <p>Client Server !</p>
    <p>!</p>
    <p>Drops all packets from the client after the first non-matching packet</p>
  </div>
  <div class="page">
    <p>How the filter censors connections</p>
    <p>Client Server !</p>
    <p>!</p>
    <p>Drops all packets from the client after the first non-matching packet</p>
  </div>
  <div class="page">
    <p>How the filter censors connections</p>
    <p>Client Server !</p>
    <p>!</p>
    <p>Drops all packets from the client after the first non-matching packet</p>
  </div>
  <div class="page">
    <p>The filter is not bidirectional</p>
    <p>Client Server</p>
    <p>Filters and drops only outbound packets</p>
    <p>!</p>
  </div>
  <div class="page">
    <p>The filter is not bidirectional</p>
    <p>Client Server</p>
    <p>Filters and drops only outbound packets</p>
    <p>!</p>
  </div>
  <div class="page">
    <p>The filter is not bidirectional</p>
    <p>Client Server !</p>
    <p>Filters and drops only outbound packets</p>
  </div>
  <div class="page">
    <p>The filter is not bidirectional</p>
    <p>Client Server !</p>
    <p>Filters and drops only outbound packets</p>
  </div>
  <div class="page">
    <p>The filter is not bidirectional</p>
    <p>Client Server !</p>
    <p>Filters and drops only outbound packets</p>
  </div>
  <div class="page">
    <p>The filter is not bidirectional</p>
    <p>Client Server !</p>
    <p>Filters and drops only outbound packets</p>
  </div>
  <div class="page">
    <p>The filter is not bidirectional</p>
    <p>Client Server !</p>
    <p>Filters and drops only outbound packets</p>
    <p>Requires vantage points within Iran to study</p>
  </div>
  <div class="page">
    <p>Other details in the paper</p>
    <p>How many packets? First two data-carrying packets</p>
    <p>How long does it block? 60 sec (resets with each packet)</p>
    <p>Whom does it censor?</p>
    <p>Some entire /24 and /16 prefixes But no clear pattern as to whom</p>
    <p>Protocol fingerprints Full details on DNS, HTTP, HTTPS</p>
  </div>
  <div class="page">
    <p>Irans Protocol Filter</p>
    <p>How the protocol filter works</p>
    <p>Client-side and server-side</p>
    <p>How the filter can be defeated</p>
    <p>Packet manipulation strategies</p>
    <p>How it censors connections</p>
    <p>How it fingerprints connections</p>
  </div>
  <div class="page">
    <p>Irans Protocol Filter</p>
    <p>How the protocol filter works</p>
    <p>Client-side and server-side</p>
    <p>How the filter can be defeated</p>
    <p>Packet manipulation strategies</p>
    <p>How it censors connections</p>
    <p>How it fingerprints connections</p>
  </div>
  <div class="page">
    <p>Client Server</p>
    <p>Genetic Evasion</p>
    <p>Geneva</p>
    <p>Bock et al. CCS19</p>
  </div>
  <div class="page">
    <p>Geneva runs strictly at one side</p>
    <p>Client Server</p>
    <p>Discovers packets manipulations to evade censorship</p>
    <p>Genetic Evasion</p>
    <p>Geneva</p>
    <p>Bock et al. CCS19</p>
  </div>
  <div class="page">
    <p>Inject Fingerprint</p>
    <p>Client Server</p>
    <p>Geneva</p>
  </div>
  <div class="page">
    <p>Inject Fingerprint</p>
    <p>Client Server</p>
    <p>Geneva</p>
  </div>
  <div class="page">
    <p>Geneva</p>
    <p>Inject Fingerprint</p>
    <p>Client Server</p>
  </div>
  <div class="page">
    <p>Geneva</p>
    <p>Inject Fingerprint</p>
    <p>Client Server</p>
  </div>
  <div class="page">
    <p>Geneva</p>
    <p>Inject Fingerprint</p>
    <p>Client Server</p>
    <p>Benign HTTP request</p>
  </div>
  <div class="page">
    <p>Geneva</p>
    <p>Inject Fingerprint</p>
    <p>Client Server</p>
    <p>Benign HTTP request with a broken checksum</p>
  </div>
  <div class="page">
    <p>Geneva</p>
    <p>Inject Fingerprint</p>
    <p>Client Server</p>
    <p>Benign HTTP request with a broken checksum</p>
  </div>
  <div class="page">
    <p>Geneva</p>
    <p>Inject Fingerprint</p>
    <p>Client Server</p>
    <p>Benign HTTP request with a broken checksum</p>
  </div>
  <div class="page">
    <p>Geneva</p>
    <p>Inject Fingerprint</p>
    <p>Client Server</p>
    <p>??</p>
    <p>Benign HTTP request with a broken checksum</p>
  </div>
  <div class="page">
    <p>Geneva</p>
    <p>Inject Fingerprint</p>
    <p>Client Server</p>
    <p>??</p>
    <p>Benign HTTP request with a broken checksum</p>
  </div>
  <div class="page">
    <p>Geneva</p>
    <p>Inject Fingerprint</p>
    <p>Client Server</p>
    <p>Benign HTTP request with a broken checksum</p>
  </div>
  <div class="page">
    <p>Geneva</p>
    <p>Inject Fingerprint</p>
    <p>Client Server</p>
    <p>Benign HTTP request with a broken checksum</p>
  </div>
  <div class="page">
    <p>Geneva</p>
    <p>Inject Fingerprint</p>
    <p>Client Server</p>
    <p>Benign HTTP request with a broken checksum</p>
  </div>
  <div class="page">
    <p>Client-side Evasion Strategies</p>
    <p>HTTP Request</p>
    <p>Send 2 FIN packets before starting the handshake</p>
    <p>Send a benign HTTP request with a broken checksum</p>
    <p>Send 9 ACK packets to complete the handshake</p>
    <p>FIN 2!</p>
    <p>ACK 9!</p>
  </div>
  <div class="page">
    <p>Server-side Evasion Strategies</p>
    <p>Geneva</p>
    <p>Client Server</p>
  </div>
  <div class="page">
    <p>Server-side Evasion Strategies</p>
    <p>Geneva</p>
    <p>Client Server</p>
  </div>
  <div class="page">
    <p>Server-side Evasion Strategies</p>
    <p>Geneva</p>
    <p>Client Server</p>
    <p>Requires no client-side modifications</p>
  </div>
  <div class="page">
    <p>Server-side Evasion Strategies</p>
    <p>Geneva</p>
    <p>Client Server</p>
    <p>Send 9 SYN/ACK packets with incorrect ack numbers</p>
    <p>S+A 9!</p>
  </div>
  <div class="page">
    <p>Server-side Evasion Strategies</p>
    <p>Geneva</p>
    <p>Client Server</p>
    <p>Induces 9 RSTs from the client</p>
    <p>Send 9 SYN/ACK packets with incorrect ack numbers</p>
    <p>S+A 9!</p>
  </div>
  <div class="page">
    <p>Evading Irans Protocol Filter</p>
    <p>HTTP Request</p>
    <p>Send 2 FIN packets before starting the handshake</p>
    <p>Send a benign HTTP request with a broken checksum</p>
    <p>Send 9 ACK packets to complete the handshake</p>
    <p>FIN 2!</p>
    <p>ACK 9!</p>
    <p>Send 9 SYN/ACK packets with incorrect ack numbers</p>
  </div>
  <div class="page">
    <p>Geneva code and website geneva.cs.umd.edu</p>
    <p>Irans Protocol Filter</p>
    <p>Client Server ! !</p>
  </div>
  <div class="page">
    <p>Geneva code and website geneva.cs.umd.edu</p>
    <p>Irans Protocol Filter</p>
    <p>Client Server ! !</p>
    <p>Protocol filter</p>
    <p>Standard censorship</p>
    <p>Drops connections from unrecognized protocols</p>
    <p>Matches connections to protocol fingerprints</p>
    <p>Applies only to some destinations</p>
  </div>
  <div class="page"/>
</Presentation>
