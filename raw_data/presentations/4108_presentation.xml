<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Universal Radio Hacker A Suite for Analyzing and Attacking Stateful Wireless Protocols</p>
    <p>Johannes Pohl and Andreas Noack</p>
    <p>University of Applied Sciences Stralsund</p>
    <p>August 13, 2018</p>
  </div>
  <div class="page">
    <p>Internet of Things</p>
    <p>Proprietary wireless protocols everywhere</p>
    <p>Smart Home Increase comfort through wireless sockets, door locks, valve sensors... Devices are designed under size and energy constraints Less resources for cryptography</p>
    <p>Risks of Smart Home Manufactures design custom proprietary wireless protocols Hackers may take over households and e.g. break in without physical traces</p>
    <p>How can we eavesdrop and manipulate the wireless communication between such devices to assess the security?</p>
    <p>August 13, 2018 Johannes Pohl and Andreas Noack Universal Radio Hacker Slide 2</p>
  </div>
  <div class="page">
    <p>Software Defined Radios</p>
    <p>Software Defined Radio</p>
    <p>Why Software Defined Radios? Send and receive on nearly arbitrary frequenciesa</p>
    <p>Flexibility and extendability with custom software ae.g. HackRF: 1 MHz - 6 GHz</p>
    <p>(a) USRP N210 (b) HackRF</p>
    <p>August 13, 2018 Johannes Pohl and Andreas Noack Universal Radio Hacker Slide 3</p>
  </div>
  <div class="page">
    <p>Software Defined Radios</p>
    <p>Software Defined Radios are affordable Last Checked: July 21, 2018</p>
    <p>August 13, 2018 Johannes Pohl and Andreas Noack Universal Radio Hacker Slide 4</p>
  </div>
  <div class="page">
    <p>Software Defined Radios</p>
    <p>Universal Radio Hacker</p>
    <p>Interpretation</p>
    <p>Analysis</p>
    <p>Generation</p>
    <p>Stateless</p>
    <p>Format</p>
    <p>Simulation</p>
    <p>Stateful</p>
    <p>Format</p>
    <p>August 13, 2018 Johannes Pohl and Andreas Noack Universal Radio Hacker Slide 5</p>
  </div>
  <div class="page">
    <p>Software Defined Radios</p>
    <p>Universal Radio Hacker</p>
    <p>Interpretation</p>
    <p>Analysis</p>
    <p>Generation</p>
    <p>Stateless</p>
    <p>Format</p>
    <p>Simulation</p>
    <p>Stateful</p>
    <p>Format</p>
    <p>August 13, 2018 Johannes Pohl and Andreas Noack Universal Radio Hacker Slide 5</p>
  </div>
  <div class="page">
    <p>Software Defined Radios</p>
    <p>Universal Radio Hacker</p>
    <p>Interpretation</p>
    <p>Analysis</p>
    <p>Generation</p>
    <p>Stateless</p>
    <p>Format</p>
    <p>Simulation</p>
    <p>Stateful</p>
    <p>Format</p>
    <p>August 13, 2018 Johannes Pohl and Andreas Noack Universal Radio Hacker Slide 5</p>
  </div>
  <div class="page">
    <p>Software Defined Radios</p>
    <p>Universal Radio Hacker</p>
    <p>Interpretation</p>
    <p>Analysis</p>
    <p>Generation</p>
    <p>Stateless</p>
    <p>Format</p>
    <p>Simulation</p>
    <p>Stateful</p>
    <p>Format</p>
    <p>August 13, 2018 Johannes Pohl and Andreas Noack Universal Radio Hacker Slide 5</p>
  </div>
  <div class="page">
    <p>Protocol</p>
    <p>Setup</p>
    <p>CCU door lock remote control</p>
    <p>August 13, 2018 Johannes Pohl and Andreas Noack Universal Radio Hacker Slide 6</p>
  </div>
  <div class="page">
    <p>Protocol</p>
    <p>Overview</p>
    <p>central (CCU) door lock remote control</p>
    <p>Pairing AES-Key AES-Key</p>
    <p>OPEN Command</p>
    <p>Challenge</p>
    <p>ResponseAES-Key(Challenge)</p>
    <p>ACKwireless socket</p>
    <p>AES-Key</p>
    <p>August 13, 2018 Johannes Pohl and Andreas Noack Universal Radio Hacker Slide 7</p>
  </div>
  <div class="page">
    <p>Protocol</p>
    <p>Overview</p>
    <p>central (CCU) door lock remote control</p>
    <p>Pairing AES-Key AES-Key</p>
    <p>OPEN Command</p>
    <p>Challenge</p>
    <p>ResponseAES-Key(Challenge)</p>
    <p>ACKwireless socket</p>
    <p>AES-Key</p>
    <p>August 13, 2018 Johannes Pohl and Andreas Noack Universal Radio Hacker Slide 7</p>
  </div>
  <div class="page">
    <p>Protocol</p>
    <p>Overview</p>
    <p>central (CCU) door lock remote control</p>
    <p>Pairing AES-Key AES-Key</p>
    <p>OPEN Command</p>
    <p>Challenge</p>
    <p>ResponseAES-Key(Challenge)</p>
    <p>ACKwireless socket</p>
    <p>AES-Key</p>
    <p>August 13, 2018 Johannes Pohl and Andreas Noack Universal Radio Hacker Slide 7</p>
  </div>
  <div class="page">
    <p>Protocol</p>
    <p>Overview</p>
    <p>central (CCU) door lock remote control</p>
    <p>Pairing AES-Key AES-Key</p>
    <p>OPEN Command</p>
    <p>Challenge</p>
    <p>ResponseAES-Key(Challenge)</p>
    <p>ACKwireless socket</p>
    <p>AES-Key</p>
    <p>August 13, 2018 Johannes Pohl and Andreas Noack Universal Radio Hacker Slide 7</p>
  </div>
  <div class="page">
    <p>Protocol</p>
    <p>Overview</p>
    <p>central (CCU) door lock remote control</p>
    <p>Pairing AES-Key AES-Key</p>
    <p>OPEN Command</p>
    <p>Challenge</p>
    <p>ResponseAES-Key(Challenge)</p>
    <p>ACK</p>
    <p>wireless socket</p>
    <p>AES-Key</p>
    <p>August 13, 2018 Johannes Pohl and Andreas Noack Universal Radio Hacker Slide 7</p>
  </div>
  <div class="page">
    <p>Protocol</p>
    <p>Overview</p>
    <p>central (CCU) door lock remote control</p>
    <p>Pairing AES-Key AES-Key</p>
    <p>OPEN Command</p>
    <p>Challenge</p>
    <p>ResponseAES-Key(Challenge)</p>
    <p>ACKwireless socket</p>
    <p>AES-Key</p>
    <p>August 13, 2018 Johannes Pohl and Andreas Noack Universal Radio Hacker Slide 7</p>
  </div>
  <div class="page">
    <p>Interpretation</p>
    <p>Record and demodulate signal</p>
    <p>Capture of door lock open communication</p>
    <p>Zoom into start of second message</p>
    <p>August 13, 2018 Johannes Pohl and Andreas Noack Universal Radio Hacker Slide 8</p>
  </div>
  <div class="page">
    <p>Interpretation</p>
    <p>Demodulation and Signal Editing with URH</p>
    <p>Further Interpretation Features Synchronized selection between demodulated and raw signal Signal Editor i.e. copy, paste, crop, mute signal selections Configurable moving average and bandpass filters</p>
    <p>August 13, 2018 Johannes Pohl and Andreas Noack Universal Radio Hacker Slide 9</p>
  </div>
  <div class="page">
    <p>Analysis</p>
    <p>Analysis phase</p>
    <p>In Analysis phase we reverse engineer the protocol format.</p>
    <p>Example format</p>
    <p>Preamble Synchronization Length Source Address</p>
    <p>Destination Address Data Checksum</p>
    <p>This includes Decode messages Labeling of protocol fields Group messages by assigning message types</p>
    <p>August 13, 2018 Johannes Pohl and Andreas Noack Universal Radio Hacker Slide 10</p>
  </div>
  <div class="page">
    <p>Analysis</p>
    <p>What kind of decoding does the door lock use?</p>
    <p>All messages are encoded in the following way 1 Pseudo encryption 2 Data Whitening 3 (Modulation)</p>
    <p>August 13, 2018 Johannes Pohl and Andreas Noack Universal Radio Hacker Slide 11</p>
  </div>
  <div class="page">
    <p>Analysis</p>
    <p>Pseudo Encryption</p>
    <p>Code</p>
    <p>enc [0] = msg [0]; enc [1] = ~( msg [1]) ^ 0x89 ; for ( i = 2; i &lt; N U M _ B Y T E S ; i ++)</p>
    <p>enc [ i ] = ( enc [ i -1]+ 0xdc ) ^ msg [ i ];</p>
    <p>Use Does not increase the security Assumption: Obscure method for pseudo security</p>
    <p>August 13, 2018 Johannes Pohl and Andreas Noack Universal Radio Hacker Slide 12</p>
  </div>
  <div class="page">
    <p>Analysis</p>
    <p>Data Whitening</p>
    <p>Data Whitening To increase transmission quality a data whitening is used XOR with each 8 LSB of a pseudo-random sequence generated by an LFSR represented by the polynomial x 9 + x 5 + x 0</p>
    <p>s8 s7 s6 s5 s4 s3 s2 s1 s0</p>
    <p>+</p>
    <p>s8s7 . . . s0</p>
    <p>Initial state is 111111111</p>
    <p>First eight states of the LFSR 111111111  011111111  001111111  000111111  000011111  100001111  110000111  111000011</p>
    <p>August 13, 2018 Johannes Pohl and Andreas Noack Universal Radio Hacker Slide 13</p>
  </div>
  <div class="page">
    <p>Analysis</p>
    <p>Decodings with URH</p>
    <p>August 13, 2018 Johannes Pohl and Andreas Noack Universal Radio Hacker Slide 14</p>
  </div>
  <div class="page">
    <p>Analysis</p>
    <p>Result in URH after decoding and labeling</p>
    <p>Other Options: Select all, Filter, Align</p>
    <p>Check against configurable CRCAssign manually or rule based</p>
    <p>August 13, 2018 Johannes Pohl and Andreas Noack Universal Radio Hacker Slide 15</p>
  </div>
  <div class="page">
    <p>Simulation</p>
    <p>Simulation phase In Simulation phase we can work on the logical layer. URH takes care of Modulation and Encoding during simulation time.</p>
    <p>Figure: Flowgraph for the attack August 13, 2018 Johannes Pohl and Andreas Noack Universal Radio Hacker Slide 16</p>
  </div>
  <div class="page">
    <p>Simulation</p>
    <p>Demonstration Video</p>
    <p>August 13, 2018 Johannes Pohl and Andreas Noack Universal Radio Hacker Slide 17</p>
  </div>
  <div class="page">
    <p>Summary and future work</p>
    <p>Summary Software Defined Radios offer a high flexibility when investigating radio protocols Tools like Universal Radio Hacker abstract the required HF basics and enable analyzing such protocols without having to be a hardware expert Smart Home manufactureres have to react, Security by Obscurity is no longer an option</p>
    <p>Ongoing work Rule based intelligence for automatic analysis phase Enhance accuracy of detecting interpretation parameters Support for more complex modulations e.g. 4-PSK</p>
    <p>August 13, 2018 Johannes Pohl and Andreas Noack Universal Radio Hacker Slide 18</p>
  </div>
  <div class="page">
    <p>https://github.com/jopohl/urh  q</p>
    <p>Contact E-Mail: Johannes.Pohl90@gmail.com E-Mail: Andreas.Noack@hochschule-stralsund.de Slack: https://bit.ly/2LGpsra GitHub: https://github.com/jopohl</p>
    <p>August 13, 2018 Johannes Pohl and Andreas Noack Universal Radio Hacker Slide 19</p>
  </div>
</Presentation>
