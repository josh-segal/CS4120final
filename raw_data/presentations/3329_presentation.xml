<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Florida Institute of Cyber Security (FICS) Research</p>
    <p>Authloop: Practical End-to-End Cryptographic</p>
    <p>Authentication for Telephony over Voice Channels</p>
    <p>Brad Reaves, Logan Blue, Patrick Traynor</p>
  </div>
  <div class="page">
    <p>Florida Institute of Cyber Security (FICS) Research 2</p>
    <p>Phones are really trusted  Phones are our backup, our trusted platform</p>
    <p>Customer service  Account Reset  Network operators  Critical Infrastructure</p>
  </div>
  <div class="page">
    <p>Florida Institute of Cyber Security (FICS) Research 3</p>
    <p>But they shouldnt be</p>
  </div>
  <div class="page">
    <p>Florida Institute of Cyber Security (FICS) Research 4</p>
    <p>But they shouldnt be  In general, neither carriers nor end users can provide guarantees about who is</p>
    <p>on a call.  Faking a Caller ID is easy</p>
    <p>What is at the root of this problem?</p>
  </div>
  <div class="page">
    <p>Florida Institute of Cyber Security (FICS) Research 5</p>
    <p>IP Networks</p>
    <p>PSTN</p>
    <p>Cell Network</p>
    <p>Gateway</p>
    <p>Gateway</p>
    <p>Intermediary Telco</p>
    <p>Networks</p>
    <p>Internet</p>
    <p>VOIP Carrier</p>
    <p>Web Services</p>
    <p>VOIP Proxy</p>
    <p>Modern Telephony Systems</p>
  </div>
  <div class="page">
    <p>Florida Institute of Cyber Security (FICS) Research 6</p>
    <p>IP Networks</p>
    <p>PSTN</p>
    <p>Cell Network</p>
    <p>Gateway</p>
    <p>Gateway</p>
    <p>Intermediary Telco</p>
    <p>Networks</p>
    <p>Internet</p>
    <p>VOIP Carrier</p>
    <p>Web Services</p>
    <p>VOIP Proxy</p>
    <p>Modern Telephony Systems</p>
  </div>
  <div class="page">
    <p>Florida Institute of Cyber Security (FICS) Research 7</p>
    <p>Along the way:</p>
    <p>What happens to the call</p>
    <p>All networks transmit voice  but they dont always share a way of transmitting data</p>
    <p>IP Networks</p>
    <p>PSTN</p>
    <p>Cell Network</p>
    <p>Gateway</p>
    <p>Gateway</p>
    <p>Intermediary Telco</p>
    <p>Networks</p>
    <p>Internet</p>
    <p>VOIP Carrier</p>
    <p>Web Services</p>
    <p>VOIP Proxy</p>
  </div>
  <div class="page">
    <p>Florida Institute of Cyber Security (FICS) Research 8</p>
    <p>Web Lessons for Telephony  We saw similar authentication problems in the early days of the web  SSL/TLS was developed largely in response to this problem</p>
    <p>Cryptographic verification of well-known parties became widely possible*</p>
    <p>This paper brings end-to-end explicit authentication to all phone calls</p>
    <p>Authloop : Phones :: TLS : Web  Can I get some guarantee that the real Bank of America is calling me?</p>
  </div>
  <div class="page">
    <p>Florida Institute of Cyber Security (FICS) Research 9</p>
    <p>Authloop  Authloop authenticates calls cryptographically &amp; end-to-end for the</p>
    <p>existing phone network through the voice channel</p>
    <p>Authenticates calls</p>
    <p>Cryptographically</p>
    <p>End to end</p>
    <p>Existing phone network</p>
    <p>Voice channel</p>
    <p>Note: Many apps provide authenticated VoIP, but they only authenticate VoIP calls</p>
  </div>
  <div class="page">
    <p>Florida Institute of Cyber Security (FICS) Research 10</p>
    <p>Two problems  Authloop needs two things:</p>
    <p>A way to send data through the voice channel  An secure, efficient authentication protocol</p>
  </div>
  <div class="page">
    <p>Florida Institute of Cyber Security (FICS) Research 11</p>
    <p>What about a modem?</p>
  </div>
  <div class="page">
    <p>Florida Institute of Cyber Security (FICS) Research 12</p>
    <p>The Problem: Modern Codecs  Modern codecs make high-fidelity, low bitrate audio possible.  But these codecs make the transmission of anything other than human voices</p>
    <p>completely unreliable</p>
    <p>Almost all of the traditional digital comm. techniques go out the window  Amplitude not preserved (ASK, QAM, TCM, &amp; PCM)  Phase discontinuities not preserved (PSK &amp; QPSK)</p>
    <p>a) 1-second chirp sweep from 300 - 3300 Hz before AMR-NB encoding</p>
    <p>b) 1-second chirp sweep from 300 - 3300 Hz after AMR-NB encoding</p>
  </div>
  <div class="page">
    <p>Florida Institute of Cyber Security (FICS) Research 13</p>
    <p>Codec Agnostic Modem  Solution: Encode data as changes in frequency</p>
    <p>3 frequencies available: 1,2,3 kHz  Use Manchester encoding (1=&gt; 10, 0=&gt;01) to limit runs of values  Transmit 20ms constant-frequency header to open VAD gates</p>
    <p>Header Footer17 data bits</p>
    <p>Punchline: approximately 500 bps goodput in the best case</p>
  </div>
  <div class="page">
    <p>Florida Institute of Cyber Security (FICS) Research 14</p>
    <p>Modem Evaluation  We measured bit error rate 100 frames containing 2000 bits each  The modem provides a low bit error rate across codecs for :</p>
    <p>Landline (G.711)  Cellular (AMR-NB)  VoIP (Speex)</p>
    <p>Codec Avg Bit Error Std.Dev G.711 0.0% 0.0%</p>
    <p>AMR-NB 0.3% 0.2% Speex 0.5% 5%</p>
  </div>
  <div class="page">
    <p>Florida Institute of Cyber Security (FICS) Research 15</p>
    <p>We need a link layer with as little overhead as possible  While still detecting common bit errors on retransmission</p>
    <p>Link Layer</p>
    <p>IDLE (START)</p>
    <p>SEND ERROR FRAME</p>
    <p>SEND STANDARD</p>
    <p>FRAME</p>
    <p>RECEIVE STANDARD</p>
    <p>FRAME</p>
    <p>RECEIVE OTHER FRAME</p>
    <p>AWAIT ACK</p>
    <p>SEND ACK SEND</p>
    <p>REPEAT FRAMES</p>
    <p>SEND ERROR</p>
    <p>MESSAGE</p>
    <p>NACKs&gt;0</p>
    <p>Timeout / Error</p>
    <p>NACKs==0</p>
    <p>AWAIT REPEAT BLOCKS</p>
    <p>SEND ERROR FRAME</p>
    <p>ANY STATE</p>
    <p>RECIEVE ERROR FRAME</p>
    <p>Timeout</p>
    <p>Receive Repeat Blocks</p>
    <p>NACKs &gt;0</p>
    <p>NACKs==0</p>
  </div>
  <div class="page">
    <p>Florida Institute of Cyber Security (FICS) Research 16</p>
    <p>Theres a 1.3% chance that the L2 wont detect a bit error  Actual goodput heavily dependent on BER  Fortunately, performance is good for the error rates we see in practice</p>
    <p>Link Layer Performance</p>
    <p>Bit Error Rate Transmission Time Goodput</p>
  </div>
  <div class="page">
    <p>Florida Institute of Cyber Security (FICS) Research 17</p>
    <p>Strawman: SSL/TLS  With a reliable data channel in place, why cant we use TLS?  Problem: Using a standard TLS handshake is too slow</p>
    <p>Solution: A protocol with the guarantees of TLS 1.2  But a fraction of the bandwidth requirement</p>
    <p>Site Name Total Bits Transmission Time at 500 bps</p>
    <p>Facebook 41,544 83.088 s Google 42,856 85.712 s</p>
    <p>Bank of America 53,144 106.288 s Yahoo 57,920 115.840 s</p>
    <p>Average 48,688 97.232 s</p>
  </div>
  <div class="page">
    <p>Florida Institute of Cyber Security (FICS) Research 18</p>
    <p>Slimming Down TLS  Things that we need:</p>
    <p>Cryptographic attestation of identity (i.e. a PKI)  Freshness and Liveness tests  Shared secret establishment</p>
    <p>Things we can live without:</p>
    <p>RSA and very long HMACs (80bits)  Cipher Agreement  TLS Record Protocol</p>
  </div>
  <div class="page">
    <p>Florida Institute of Cyber Security (FICS) Research 19</p>
    <p>The Protocol</p>
    <p>C: E: H: D: K+,-: k: N: P: S: V:</p>
    <p>Certificate Encryption HMAC Digital Signature Public/Private Key Symmetric Key Nonce Prover Pre-Master Secret Verifier</p>
    <p>Call Center (Prover)</p>
    <p>Mobile (Verifier)</p>
    <p>(1) V, NV</p>
    <p>(2) P, NP , CP</p>
    <p>(3) E(KP +,S), H(k,'VRFY', #1, #2)</p>
    <p>(4) H(k,'PROV', #1, #2)</p>
    <p>(n-1) H(k, V, NV+n-1)</p>
    <p>(n) H(k, P, NP+n)</p>
    <p>(0) Initiate Call</p>
    <p>Protocol is based on TLS 1.2 Key Transport, verified with ProVerif</p>
    <p>Send periodic keepalive messages to prove liveness</p>
    <p>Handshake complete Prover is authenticated Secret key is established</p>
  </div>
  <div class="page">
    <p>Florida Institute of Cyber Security (FICS) Research 20</p>
    <p>Great But Does It Work?  On average it takes ~9 seconds to do a full handshake.  If we can cache certificates, we can do it in ~5 seconds</p>
    <p>Network transmission accounts for 99% of this time  only 50 ms of computation</p>
    <p>Codec Cached</p>
    <p>Certificate Certificate Exchanged</p>
    <p>G.711 4.463 s 8.279 s AMR-NB 5.608 s 10.374 s</p>
    <p>Speex 4.427 s 8.279 s Average 4.844 s 8.977 s</p>
  </div>
  <div class="page">
    <p>Florida Institute of Cyber Security (FICS) Research 21</p>
    <p>Telephony PKI  One of the major problems in the Internet is confusion over valid CAs and identity bindings.  Telephony naturally lends itself to a singly rooted system using the North American</p>
    <p>Numbering Plan (NANPA).  Carriers are publicly</p>
    <p>allocated blocks of numbers, so assignments are based on authority.</p>
    <p>Certs for every carrier can be stored in ~100 KiB.</p>
    <p>No more long, ambiguous certificate chains!</p>
    <p>bankof america.com</p>
    <p>Symantec</p>
    <p>Verisign Root</p>
    <p>(800) 432-1000 Bank of America</p>
    <p>AT&amp;T (NPA/NXX</p>
    <p>Administrator)</p>
    <p>NANPA Root</p>
    <p>AddTrust Root Entrust Root</p>
    <p>xyz.bankof america.com</p>
    <p>Current Internet PKI Proposed TPKI</p>
    <p>Stored at</p>
    <p>Endpoint . . .</p>
    <p>Stored at</p>
    <p>Endpoint</p>
  </div>
  <div class="page">
    <p>Florida Institute of Cyber Security (FICS) Research 22</p>
    <p>Summing up  Telephones are used for our most trusted communications, but one cant be</p>
    <p>sure who is calling  Authloop solves this problem by providing end-to-end cryptographic</p>
    <p>authentication Bank of America 1-800-432-1000</p>
  </div>
  <div class="page">
    <p>Florida Institute of Cyber Security (FICS) Research 23</p>
    <p>BradReaves.net</p>
  </div>
</Presentation>
