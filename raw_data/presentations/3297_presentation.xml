<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>+ Fingerprinting Electronic Control Units</p>
    <p>for Vehicle Intrusion Detection</p>
    <p>Kyong Tak Cho and Kang G. Shin The University of Michigan</p>
  </div>
  <div class="page">
    <p>+ Vehicle Cyber Attack</p>
    <p>Security</p>
    <p>Risks!</p>
    <p>Remote</p>
    <p>Access Points</p>
    <p>In-Vehicle Network</p>
  </div>
  <div class="page">
    <p>Source: K. Koscher et al, Experimental Security Analysis of a Modern Automobile, IEEE S&amp;P10</p>
    <p>Vehicle attacks are real!</p>
  </div>
  <div class="page">
    <p>ECU ECU ECU</p>
    <p>ECU ECU</p>
    <p>ID DATAID DATAID DATAID DATAID DATAID DATAID DATAID DATAID DATAID DATAID DATAID DATA</p>
    <p>CAN Message Format</p>
    <p>o Message-oriented addressing</p>
    <p>ID represents message contents</p>
    <p>No info who sent the message.</p>
    <p>CAN (Controller Area Network)</p>
  </div>
  <div class="page">
    <p>+ Attack Model : Attacker</p>
    <p>Strong Weak</p>
    <p>Start + Stop</p>
    <p>Tx</p>
    <p>Start + Stop</p>
    <p>Tx</p>
  </div>
  <div class="page">
    <p>+ Attack Model</p>
    <p>B0</p>
    <p>ECU</p>
    <p>A</p>
    <p>B0 20</p>
    <p>ECU</p>
    <p>B</p>
    <p>ECU</p>
    <p>C</p>
    <p>CAN Bus</p>
    <p>B0 B0 B0 B020 20</p>
    <p>B0 B0 B0 B020 20B0 B0 B0</p>
    <p>Time</p>
    <p>Without Attack</p>
    <p>With Attack</p>
    <p>(Strong)</p>
    <p>B0 B0</p>
    <p>Method 1 &amp; 2: Fabrication and Suspension attack</p>
    <p>B0 20</p>
    <p>Source: K. Koscher et al, Experimental Security Analysis of a Modern Automobile, IEEE S&amp;P10</p>
  </div>
  <div class="page">
    <p>B0</p>
    <p>ECU</p>
    <p>A</p>
    <p>ECU</p>
    <p>B</p>
    <p>ECU</p>
    <p>C</p>
    <p>CAN Bus</p>
    <p>B0 B0 B0 B020 20</p>
    <p>B0 B020 20 B0</p>
    <p>Time</p>
    <p>Without Attack</p>
    <p>With Attack</p>
    <p>(Strong)</p>
    <p>B0</p>
    <p>Method 3: Masquerade attack</p>
    <p>B0 20</p>
    <p>Tmasq</p>
    <p>(Weak)</p>
    <p>Attack Model</p>
  </div>
  <div class="page">
    <p>ECU ECU ECU</p>
    <p>ECU ECU</p>
    <p>Problems</p>
    <p>ID DATAID DATAID DATAID DATA</p>
  </div>
  <div class="page">
    <p>ECU</p>
    <p>ECU ECU</p>
    <p>ECU ECU</p>
    <p>Problems</p>
    <p>ID DATAID DATAID DATAID DATA</p>
  </div>
  <div class="page">
    <p>ECU ECU</p>
    <p>ECU ECU</p>
    <p>ID DATA</p>
    <p>ID DATA</p>
    <p>ID DATA</p>
    <p>ID DATA</p>
    <p>Objective: Fingerprint ECUs for Intrusion Detection</p>
    <p>Clock</p>
    <p>Skew</p>
    <p>CIDS: Clock-based IDS</p>
    <p>ECU</p>
  </div>
  <div class="page">
    <p>Node 1 Node 2 Node 3</p>
    <p>Clock Offset -1 min +1 min 0 min</p>
    <p>Clock Skew -1/60 +1/60 0</p>
    <p>CIDS: Clock-based IDS</p>
  </div>
  <div class="page">
    <p>Determine ECUs Clock Skew !</p>
    <p>How? Exploit the fact that most messages are Periodic</p>
    <p>CIDS: Clock-based IDS</p>
  </div>
  <div class="page">
    <p>T+O1</p>
    <p>T+O1+d1+n1Trx =</p>
    <p>d0+n0 T+O1+d1+n1 2T+O2+d2+n2 3T+O3+d3+n3</p>
    <p>T+O2-O1+d2+n2 T+O3-O2+d3+n3</p>
    <p>ECU A</p>
    <p>ECU R</p>
    <p>T 2T 3TIdeal</p>
    <p>Actual t=0</p>
    <p>Transmitters clock information is hidden in the</p>
    <p>message arrival timestamps and intervals!</p>
    <p>CIDS: Clock-based IDS</p>
  </div>
  <div class="page">
    <p>Estimated</p>
    <p>Measured</p>
    <p>E[Trx]+d0+n0 2E[Trx]+d0+n0 3E[Trx]+d0+n0</p>
    <p>Difference  O1+d+n O2+d+n O3+d+n</p>
    <p>Average clock offset (Newly incurred offset)</p>
    <p>CIDS: Clock-based IDS</p>
    <p>T+O1 2T+O2 3T+O3</p>
    <p>d0+n0 T+O1+d1+n1 2T+O2+d2+n2 3T+O3+d3+n3</p>
    <p>ECU A</p>
    <p>ECU R</p>
    <p>T 2T 3TIdeal</p>
    <p>Actual t=0</p>
    <p>Accumulated clock offset (Oacc)</p>
    <p>Time (t)</p>
    <p>Slope = Clock skew !</p>
    <p>ECU1</p>
    <p>ECU2</p>
    <p>ECU3</p>
    <p>ECU4</p>
    <p>Recursive Least</p>
    <p>Square (RLS)</p>
    <p>Oacc[k] = S[k]t[k]+e[k]</p>
  </div>
  <div class="page">
    <p>A A A A</p>
    <p>B B B B</p>
    <p>As clock behavior</p>
    <p>Bs clock behavior</p>
    <p>CIDS: Clock-based IDS</p>
  </div>
  <div class="page">
    <p>+ CIDS: Per-message Detection</p>
    <p>Detection  Fabrication Attack</p>
    <p>Estimated</p>
    <p>Measured d0+n0 E[Trx]+d0+n0 2E[Trx]+d0+n0 3E[Trx]+d0+n0</p>
    <p>Difference  O1+d+n O2+d+n O3+d+n</p>
    <p>|E[Oi]| Increases!</p>
    <p>T+O1+d1+n1 2T+O2+d2+n2 3T+O3+d3+n3</p>
  </div>
  <div class="page">
    <p>Detection: Fabrication Attack</p>
    <p>Accumulated clock offset (Oacc)</p>
    <p>Time (t)</p>
    <p>High error in RLS !</p>
    <p>CIDS: Per-message Detection</p>
  </div>
  <div class="page">
    <p>Detection: Masquerade Attack</p>
    <p>Accumulated clock offset (Oacc)</p>
    <p>Time (t)</p>
    <p>High error in RLS !</p>
    <p>Detect abnormal shifts via</p>
    <p>CUSUM (Cumulative Sum) Analysis</p>
    <p>CIDS: Per-message Detection</p>
  </div>
  <div class="page">
    <p>A A A A</p>
    <p>B B B B</p>
    <p>As clock behavior</p>
    <p>Bs clock behavior</p>
    <p>CIDS: Clock-based IDS</p>
    <p>Relation between clock behaviors</p>
  </div>
  <div class="page">
    <p>A A A A</p>
    <p>B B B B</p>
    <p>CIDS: Clock-based IDS</p>
    <p>ECU X</p>
    <p>Correlated</p>
    <p>Offsets!</p>
    <p>ECU X</p>
  </div>
  <div class="page">
    <p>Accumulated clock offset (Oacc)</p>
    <p>Time (t)</p>
    <p>CIDS: Message-pairwise Detection</p>
    <p>Message-pairwise</p>
    <p>Detection</p>
  </div>
  <div class="page">
    <p>+ CIDS: Message-pairwise Detection</p>
    <p>2013 Honda Accord</p>
    <p>Same Txer Different Txer</p>
  </div>
  <div class="page">
    <p>+ CIDS: Message-pairwise Detection</p>
    <p>2010 Toyota Camry</p>
    <p>Same Txer Different Txer</p>
  </div>
  <div class="page">
    <p>+ Evaluation</p>
    <p>Setting 1: CAN bus prototype</p>
  </div>
  <div class="page">
    <p>Setting 3: CAN log data</p>
    <p>2010 Toyota Camry</p>
    <p>2010 Dodge Ram Pickup</p>
    <p>Evaluation</p>
    <p>Setting 2: Real Vehicle  2013 Honda Accord</p>
  </div>
  <div class="page">
    <p>+ Evaluation</p>
    <p>Different Fingerprints</p>
    <p>CAN bus prototype 2013 Honda Accord</p>
  </div>
  <div class="page">
    <p>Attacker</p>
    <p>CIDS</p>
    <p>Evaluation</p>
    <p>Defending Fabrication Attack</p>
  </div>
  <div class="page">
    <p>+ Evaluation</p>
    <p>Defending Masquerade Attack</p>
    <p>Root-cause</p>
    <p>Analysis</p>
  </div>
  <div class="page">
    <p>Message-pairwise Detection</p>
    <p>What if impersonating node has near-equivalent clock skew?</p>
    <p>Evaluation</p>
  </div>
  <div class="page">
    <p>+ Evaluation</p>
    <p>False Alarm Rate : Per-message</p>
    <p>P(false alarm)</p>
    <p>P (d</p>
    <p>e te</p>
    <p>c ti o n )</p>
  </div>
  <div class="page">
    <p>+ Evaluation</p>
    <p>False Alarm Rate : Per-message + Message-pairwise</p>
    <p>P(false alarm)</p>
    <p>P (d</p>
    <p>e te</p>
    <p>c ti o n )</p>
  </div>
  <div class="page">
    <p>+ Conclusion</p>
    <p>CIDS: Clock-based IDS</p>
    <p>Fingerprints transmitters based on extracted clock skew</p>
    <p>Overcomes the limitations of state-of-the-art defenses</p>
    <p>No change in protocol/messages required!</p>
    <p>Intrusion</p>
    <p>Detection</p>
    <p>Root-cause</p>
    <p>Analysis Authentication</p>
  </div>
  <div class="page">
    <p>Thank you! ktcho@umich.edu</p>
  </div>
</Presentation>
