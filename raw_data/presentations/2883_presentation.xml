<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Shooting the moving target : machine learning in cybersecurity</p>
    <p>Ankit Arun*, Ignacio Arnaldo</p>
    <p>MIT CSAIL top 16 2016</p>
  </div>
  <div class="page">
    <p>Outline</p>
  </div>
  <div class="page">
    <p>Vast number of data sources and attacks</p>
    <p>Reported in 2018</p>
    <p>~ 24k malicious mobile apps are blocked</p>
    <p>everyday</p>
    <p>Ransomware attacks</p>
    <p>targeted attacks between 2015 and</p>
  </div>
  <div class="page">
    <p>The Need for AI in InfoSec: Data Problem</p>
    <p>successfully</p>
    <p>By machines (aka logs and network systems) during or after the attack</p>
    <p>By human analysts, after an attack has been known to occur</p>
  </div>
  <div class="page">
    <p>Detection approaches</p>
    <p>Im Here</p>
    <p>Coverage</p>
    <p>False positives Dwell time</p>
    <p>Threat intel and signatures Rules Anomaly detection Supervised models</p>
  </div>
  <div class="page">
    <p>Challenges</p>
    <p>Cybersecurity</p>
    <p>Computer Vision</p>
    <p>More Expert Knowledge Required</p>
    <p>DATA PROPERTY AVAILABILITY VARIETY LABELED STATIC / DYNAMIC</p>
    <p>Siloed with Barriers Adversarial</p>
    <p>and Dynamic</p>
  </div>
  <div class="page">
    <p>State-of-the-art ML in Cybersecurity</p>
    <p>[1] M. Darling, G. Heileman, G. Gressel, A. Ashok, and P. Poornachandran, A lexical approach for classifying malicious urls</p>
    <p>[2] M. S. I. Mamun, M. A. Rathore, A. H. Lashkari, N. Stakhanova, and A. A. Ghorbani, Detecting malicious urls using lexical analysis</p>
    <p>[3] Woodbridge, H. S. Anderson, A. Ahuja, and D. Grant, Predicting domain generation algorithms with long short-term memory networks</p>
    <p>[4] H. S. Anderson, J. Woodbridge, and B. Filar, DeepDGA: Adversarially-Tuned Domain Generation and Detection,</p>
    <p>[5] J. Saxe et al., eXpose: A Character-Level Convolutional Neural Network with Embeddings For Detecting Malicious URLs, File Paths and Registry Keys</p>
    <p>2015-2016: lexical analysis to detect spam, malware hosting and phishing URLs [1][2]</p>
    <p>2016: LSTMs for DGA detection [3][4]  2017: Char-level CNNs for URL classification [5]</p>
    <p>Academia Industry  Web traffic open by default  Blacklists based on threat intelligence  ML is rarely used for live detection</p>
    <p>Are the approaches still valid or are they outdated? How do the models perform in real world scenarios?</p>
    <p>Will the models work in my environment? Risks preventing ML adoption:</p>
  </div>
  <div class="page">
    <p>Logs</p>
    <p>Data Pipelines</p>
    <p>Labels</p>
    <p>Models</p>
    <p>Continuous Improvement Process</p>
    <p>Adding/Changing more data  Changing the entity to model  Adding more attack examples  Changing modeling strategy</p>
  </div>
  <div class="page">
    <p>Machine Learning Platform</p>
  </div>
  <div class="page">
    <p>The cloud repositories</p>
    <p>Golden Data Set and Models</p>
    <p>Threat Researchers</p>
    <p>ML Engineers</p>
    <p>Data Scientists</p>
  </div>
  <div class="page">
    <p>The cloud repositories</p>
    <p>Horizontal Brute Force Attack environment_1 raw_logs normalized_logs features</p>
    <p>label.csv labeled_feature_matrix models Brute_force_attack_classifier_v1.1 Brute_force_attack_outlier_v1.1</p>
  </div>
  <div class="page">
    <p>Configurable data pipelines</p>
    <p>fields { name: protocol display_name: Protocol index: proto data_type: string</p>
    <p>}</p>
    <p>Log Parsing Engine</p>
  </div>
  <div class="page">
    <p>Configurable data pipelines</p>
    <p>feature { name: distinct_protocol display_name: Distinct Protocol definition: count_distinct(protocol) data_type: int</p>
    <p>}</p>
    <p>Feature Compute Engine</p>
  </div>
  <div class="page">
    <p>Model Versioning</p>
    <p>Brute_force_attack_Classifier_V2.3</p>
    <p>Major Version</p>
    <p>Minor Version</p>
    <p>Brute Force Attack Classifier Param Version Apr 2019 Mar 2019 Feb 2019 Jan 2019 Dec 2018 Nov 2018 Oct 2018 Sep 2018</p>
    <p>v1</p>
    <p>v2</p>
    <p>v3</p>
  </div>
  <div class="page">
    <p>Current state of the system</p>
    <p>Ping Sweep</p>
    <p>Port Scan</p>
    <p>DNS Reconnaissance</p>
    <p>Zone Transfer</p>
    <p>Social Eng Domains</p>
    <p>Phishing Domains</p>
    <p>Redirects</p>
    <p>Dll Highjack</p>
    <p>Task Sched</p>
    <p>Mimikatz</p>
    <p>Winroot</p>
    <p>Domain Enumeration</p>
    <p>Brute Force Login</p>
    <p>Overpass the Hash</p>
    <p>Skeleton Key Attack</p>
    <p>Kerberoasting</p>
    <p>DC Replication</p>
    <p>Golden Ticket Attack</p>
    <p>SSO Login Attack</p>
    <p>Malware Backdoor</p>
    <p>DGAs</p>
    <p>TOR Connections</p>
    <p>ICMP Tunneling</p>
    <p>HTTP Tunneling</p>
    <p>Twittor</p>
    <p>SSH Tunneling</p>
    <p>DNS Tunneling</p>
    <p>DNS Beaconing</p>
    <p>ICMP Exfiltration</p>
    <p>HTTP Exfiltration</p>
    <p>Gmail Exfiltration</p>
    <p>Twitter Exfiltration</p>
    <p>NTP Exfiltration</p>
    <p>SMTP Exfiltration</p>
    <p>DNS Exfiltration</p>
    <p>Cloud Takeover</p>
    <p>Reconnaissance Delivery Privilege Escalation Lateral</p>
    <p>Movement Command and</p>
    <p>Control Exfiltration</p>
    <p>Fwd Proxy Logs / NGFW</p>
    <p>AD Logs</p>
    <p>EDR Logs</p>
    <p>DNS Logs</p>
    <p>App Logs</p>
    <p>Network</p>
    <p>Proxy Logs</p>
    <p>Zscaler</p>
    <p>BlueCoat</p>
    <p>Squid</p>
    <p>Bro HTTP</p>
    <p>Intersafe</p>
    <p>FW Logs</p>
    <p>PANW</p>
    <p>Cisco ASA</p>
    <p>Fortigate</p>
    <p>NetScreen</p>
    <p>Bro Conn</p>
    <p>Flow Logs</p>
    <p>Netflow</p>
    <p>VPC Flow</p>
    <p>IBM QFlow</p>
    <p>DNS Logs</p>
    <p>Windows DNS</p>
    <p>Suricata</p>
    <p>Bro DNS</p>
    <p>Authentication</p>
    <p>Auth/Auth</p>
    <p>Active Directory</p>
    <p>Okta</p>
    <p>End Point</p>
    <p>EDR Logs</p>
    <p>Carbon Black</p>
    <p>osQuery</p>
    <p>Applications</p>
    <p>App Logs</p>
    <p>Apache</p>
    <p>Box</p>
    <p>OneDrive</p>
    <p>Audit Trail</p>
    <p>AWS CloudTrail</p>
    <p>Contextual</p>
    <p>Contextual</p>
    <p>DHCP</p>
    <p>Tenable</p>
    <p>STIX</p>
    <p>Open IoC</p>
    <p>Alexa Top 1M</p>
    <p>Datasets</p>
    <p>Deployment</p>
    <p>Weekly Model</p>
    <p>Updates</p>
  </div>
  <div class="page">
    <p>Ongoing efforts</p>
    <p>Automating Feature Computation</p>
    <p>Data Shift Detection</p>
    <p>Automating Model Review/Update Process</p>
  </div>
  <div class="page">
    <p>References  https://www.ptsecurity.com/ww-en/analytics/cybersecurity</p>
    <p>threatscape-2018-q3/  https://www.checkpoint.com/downloads/product-related/report/2018</p>
    <p>security-report.pdf  https://www.varonis.com/blog/cybersecurity-statistics/</p>
  </div>
  <div class="page">
    <p>Questions?</p>
  </div>
</Presentation>
