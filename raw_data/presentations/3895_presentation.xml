<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Sora: High Performance Software Radio using General Purpose Multi</p>
    <p>Core Processors</p>
    <p>Kun Tan Jiansong Zhang Ji Fang He Liu Yusheng Ye</p>
    <p>Shen Wang Yongguang Zhang Haitao Wu Wei Wang</p>
    <p>Geoffrey M. Voelker  Microsoft Research Asia</p>
    <p>Tsinghua University, Beijing, China  Beijing Jiaotong University, Beijing, China</p>
    <p>UCSD, La Jolla, USA</p>
    <p>NSDI 2009, Boston, USA 1</p>
  </div>
  <div class="page">
    <p>Software Radio</p>
    <p>NSDI 2009, Boston, USA 2</p>
    <p>Benefits Promise of universal connectivity and cost saving Programmability =&gt; faster development cycle, faster to market Open platform for wireless research</p>
    <p>CDMA</p>
    <p>WiFi</p>
    <p>WiMAX</p>
    <p>GPS</p>
    <p>GSM</p>
    <p>Bluetooth</p>
    <p>software</p>
    <p>Bluetooth, WiFi, WiMAX, GSM, CDMA, 3G, LTE</p>
    <p>General RF</p>
    <p>Frontend</p>
  </div>
  <div class="page">
    <p>Fundamental Challenges</p>
    <p>Large volume of high-fidelity digital signals</p>
    <p>Require a high-speed system I/O</p>
    <p>NSDI 2009, Boston, USA 3</p>
    <p>Antenna</p>
    <p>Processor</p>
    <p>SoftwareHardware Digital</p>
    <p>Samples</p>
    <p>D/A</p>
    <p>A/D</p>
    <p>RF</p>
    <p>Frontend</p>
    <p>~up to 5 Gbps for 11n (4x4MIMO) ;</p>
    <p>Over 10Gbps for future high-speed wireless</p>
  </div>
  <div class="page">
    <p>Fundamental Challenges</p>
    <p>Large volume of high-fidelity digital signals</p>
    <p>Require a high-speed system I/O</p>
    <p>Computation-intensive signal processing</p>
    <p>NSDI 2009, Boston, USA 4</p>
    <p>Interleaving Convolutional</p>
    <p>encoder QAM Mod IFFT GI Addition</p>
    <p>Symbol Wave</p>
    <p>Shaping Scramble</p>
    <p>To RF</p>
    <p>Demod +</p>
    <p>Interleaving FFT</p>
    <p>Viterbi</p>
    <p>decoding Remove GI</p>
    <p>From RF</p>
    <p>Descramble</p>
    <p>Transmitter:</p>
    <p>Receiver:</p>
    <p>Bits</p>
    <p>@48Mbps Bits</p>
    <p>@48Mbps</p>
    <p>Samples</p>
    <p>@512Mbps</p>
    <p>Samples</p>
    <p>@1.28Gbps</p>
    <p>Samples</p>
    <p>@640Mbps</p>
    <p>Decimation</p>
    <p>Samples</p>
    <p>@384Mbps Bits</p>
    <p>@24Mbps</p>
    <p>Samples</p>
    <p>@1.28Gbps</p>
    <p>Samples</p>
    <p>@640Mbps</p>
    <p>Samples</p>
    <p>@512Mbps</p>
    <p>Samples</p>
    <p>@384Mbps Bits</p>
    <p>@48Mbps</p>
    <p>Bits</p>
    <p>@24Mbps</p>
    <p>Bits</p>
    <p>@24Mbps</p>
    <p>From MAC</p>
    <p>To MAC</p>
    <p>Bits</p>
    <p>@24Mbps</p>
  </div>
  <div class="page">
    <p>Fundamental Challenges</p>
    <p>Large volume of high-fidelity digital signals</p>
    <p>Require a high-speed system I/O</p>
    <p>Computation-intensive signal processing</p>
    <p>NSDI 2009, Boston, USA 5</p>
    <p>Interleaving Convolutional</p>
    <p>encoder QAM Mod IFFT GI Addition</p>
    <p>Symbol Wave</p>
    <p>Shaping Scramble</p>
    <p>To RF</p>
    <p>Demod +</p>
    <p>Interleaving FFT</p>
    <p>Viterbi</p>
    <p>decoding Remove GI</p>
    <p>From RF</p>
    <p>Descramble</p>
    <p>Transmitter:</p>
    <p>Receiver:</p>
    <p>Bits</p>
    <p>@48Mbps Bits</p>
    <p>@48Mbps</p>
    <p>Samples</p>
    <p>@512Mbps</p>
    <p>Samples</p>
    <p>@1.28Gbps</p>
    <p>Samples</p>
    <p>@640Mbps</p>
    <p>Decimation</p>
    <p>Samples</p>
    <p>@384Mbps Bits</p>
    <p>@24Mbps</p>
    <p>Samples</p>
    <p>@1.28Gbps</p>
    <p>Samples</p>
    <p>@640Mbps</p>
    <p>Samples</p>
    <p>@512Mbps</p>
    <p>Samples</p>
    <p>@384Mbps Bits</p>
    <p>@48Mbps</p>
    <p>Bits</p>
    <p>@24Mbps</p>
    <p>Bits</p>
    <p>@24Mbps</p>
    <p>From MAC</p>
    <p>To MAC</p>
    <p>Bits</p>
    <p>@24Mbps</p>
    <p>Raw computation power required: 802.11b =&gt; 10Gops, 802.11a =&gt; 40Gops! (now server-class CPU runs at 3GHz clock)</p>
  </div>
  <div class="page">
    <p>Fundamental Challenges</p>
    <p>Large volume of high-fidelity digital signals</p>
    <p>Require a high-speed system I/O</p>
    <p>Computation-intensive signal processing</p>
    <p>Hard deadline and accurate timing control</p>
    <p>802.11 MAC requires response within a few s</p>
    <p>Event trigger timing accuracy at s level</p>
    <p>NSDI 2009, Boston, USA 6</p>
  </div>
  <div class="page">
    <p>Approaches</p>
    <p>NSDI 2009, Boston, USA 7</p>
    <p>Programmability</p>
    <p>Low High</p>
    <p>Lo w</p>
    <p>H</p>
    <p>ig h</p>
    <p>P e rf</p>
    <p>o rm</p>
    <p>a n c e</p>
    <p>Embedded DSP</p>
    <p>Example: Rice WARP, TI SFF-SDR</p>
    <p>Programmable hardware</p>
    <p>(FPGA)</p>
    <p>Example: GNU Radio/USRP(v1&amp;2)  Interface USB/GbE: &lt;1Gbps, &gt;1ms  Achievable wireless xput: ~100Kbps</p>
    <p>Low-performance GPP-based SDR</p>
    <p>Sora Sora</p>
    <p>Resolving the SDR platform dilemma  Commodity PC w/ C program  High performance</p>
    <p>sys tput:10Gbps; ~s latency  target wireless xput:10M~1Gbps</p>
  </div>
  <div class="page">
    <p>Sora Approach</p>
    <p>New PCIe-based Interface card =&gt; high system throughput</p>
    <p>New optimizations to implement PHY algorithms and streamline processing on multi-core CPU=&gt; efficient PHY processing</p>
    <p>Core dedication =&gt; real-time support</p>
    <p>NSDI 2009, Boston, USA 8</p>
  </div>
  <div class="page">
    <p>Mem RF</p>
    <p>RF RF</p>
    <p>Sora</p>
    <p>APP</p>
    <p>Multi-core CPU</p>
    <p>Sora Soft-Radio Stack</p>
    <p>PCIe bus</p>
    <p>Digital Samples</p>
    <p>@Multiple Gbps</p>
    <p>RCB A/D</p>
    <p>D/A RF Sora</p>
    <p>APP</p>
    <p>APP</p>
    <p>APP</p>
    <p>APP</p>
    <p>APP</p>
    <p>Sora Hardware</p>
    <p>Sora Architecture</p>
    <p>NSDI 2009, Boston, USA 9</p>
    <p>General radio front-end: 700M/1.8G/2.4G/5GHz</p>
  </div>
  <div class="page">
    <p>Mem RF</p>
    <p>RF RF</p>
    <p>Sora</p>
    <p>APP</p>
    <p>Multi-core CPU</p>
    <p>Sora Soft-Radio Stack</p>
    <p>PCIe bus</p>
    <p>Digital Samples</p>
    <p>@Multiple Gbps</p>
    <p>RCB A/D</p>
    <p>D/A RF Sora</p>
    <p>APP</p>
    <p>APP</p>
    <p>APP</p>
    <p>APP</p>
    <p>APP</p>
    <p>Sora Hardware</p>
    <p>Radio Control Board</p>
    <p>NSDI 2009, Boston, USA 10</p>
    <p>PCIe-based High-speed Interface card</p>
    <p>PCIe is commodity in most modern PCs  High throughput: 16Gbps at PCIe-8x  Low latency: ~ 1 s  Separated with other I/O devices</p>
  </div>
  <div class="page">
    <p>RCB Details</p>
    <p>NSDI 2009, Boston, USA 11</p>
    <p>PCIe-8x interface: up to 16Gbps throughput</p>
    <p>Versatile RF interface: up to 8 channels (8x8 MIMO)</p>
  </div>
  <div class="page">
    <p>Versatile RF interface: up to 8 channels (8x8 MIMO)</p>
    <p>RCB Details</p>
    <p>NSDI 2009, Boston, USA 12</p>
    <p>s</p>
    <p>Buffered data path: bridging the synchronous ops at RF and asynchronous processing at CPU (12.3Gbps measured )</p>
    <p>Low latency control path for software (0.36 s measured)</p>
    <p>A/D</p>
    <p>D/A RF Circuit</p>
    <p>RF Front-end PCIE</p>
    <p>Controller SDRAM</p>
    <p>Controller</p>
    <p>FIFO</p>
    <p>FIFO DMA</p>
    <p>Controller</p>
    <p>DDR</p>
    <p>SDRAM</p>
    <p>FPGA</p>
    <p>RCB</p>
    <p>PCIe</p>
    <p>bus</p>
    <p>Antenna</p>
    <p>RF</p>
    <p>Controller</p>
    <p>Registers</p>
  </div>
  <div class="page">
    <p>Mem RF</p>
    <p>RF RF</p>
    <p>Sora</p>
    <p>APP</p>
    <p>Multi-core CPU</p>
    <p>Sora Soft-Radio Stack</p>
    <p>PCIe bus</p>
    <p>Digital Samples</p>
    <p>@Multiple Gbps</p>
    <p>RCB A/D</p>
    <p>D/A RF Sora</p>
    <p>APP</p>
    <p>APP</p>
    <p>APP</p>
    <p>APP</p>
    <p>APP</p>
    <p>Sora Hardware</p>
    <p>Sora Software</p>
    <p>High-performance SDR processing w/ key software techniques</p>
    <p>Efficient PHY implementation using SIMD and LUTs  Speed up PHY using multi-core streamline processing  Core dedication for real-time support</p>
    <p>NSDI 2009, Boston, USA</p>
  </div>
  <div class="page">
    <p>Efficient PHY Implementation</p>
    <p>Exploit large high-speed cache memory  Extensive use of lookup tables (LUT): trade memory</p>
    <p>for calculation; still well fit into L2 cache</p>
    <p>Applicable for more than half of the common algorithms; speedup ranges from 1.5x to 22x</p>
    <p>NSDI 2009, Boston, USA 14</p>
    <p>Direct impl. 8 ops per bit</p>
    <p>LUT impl. 2 Lookup op for 8 bits! (size 32KB)</p>
    <p>Ex: Convolutional encoder +</p>
    <p>+</p>
    <p>Tb Tb Tb Tb Tb Tb</p>
    <p>Output Data A</p>
    <p>Output Data B</p>
  </div>
  <div class="page">
    <p>Efficient PHY Implementation</p>
    <p>Exploit data parallelism in PHY</p>
    <p>Utilize wide-vector SIMD extension in CPU</p>
    <p>Applicable to many PHY algorithms with significant speedups (1.6x ~ 50x)</p>
    <p>NSDI 2009, Boston, USA 15</p>
    <p>Ex. (I)FFT</p>
  </div>
  <div class="page">
    <p>Core 2Core 1</p>
    <p>Speed up PHY using multi-core streamline processing</p>
    <p>Efficiently partition and schedule the PHY processing across cores  Interconnecting sub-pipeline with light-weight,</p>
    <p>synchronized FIFOs</p>
    <p>Static scheduling of processing modules in PHY pipeline</p>
    <p>NSDI 2009, Boston, USA 16</p>
    <p>Demod +</p>
    <p>Interleaving FFT</p>
    <p>Viterbi</p>
    <p>decoding Remove GI DescrambleDecimation</p>
    <p>Synchronized FIFO</p>
  </div>
  <div class="page">
    <p>Core Dedication for Real-time Support</p>
    <p>Exclusively allocate enough cores for SDR processing in multi-core systems</p>
    <p>Guarantee the CPU, cache and memory bandwidth resources for predictable performance</p>
    <p>Achieve s-level timing control</p>
    <p>Simple abstraction, and easier to implement in standard OSes than RT-scheduler</p>
    <p>Implemented in WinXP without modifications to Kernel</p>
    <p>NSDI 2009, Boston, USA 17</p>
  </div>
  <div class="page">
    <p>Implementation</p>
    <p>Sora software platform on Win XP</p>
    <p>14K lines of C code, including PCIe driver framework, memory management, FIFO management, etc</p>
    <p>SoftWiFi: full implementation of IEEE 802.11a/b/g PHY and DCF MAC</p>
    <p>9K lines of C code; 4 man-month for dev &amp; test</p>
    <p>DSSS 1, 2, 5.5, 11Mbps for 11b; OFDM 6, 9, 12, 18, 24, 36, 48, 54Mbps for 11a/g</p>
    <p>NSDI 2009, Boston, USA 18</p>
  </div>
  <div class="page">
    <p>R e</p>
    <p>q u</p>
    <p>ir e</p>
    <p>d c</p>
    <p>o m</p>
    <p>p u</p>
    <p>ta ti</p>
    <p>o n</p>
    <p>(G ig</p>
    <p>a c</p>
    <p>y cl</p>
    <p>e s</p>
    <p>p e</p>
    <p>r se</p>
    <p>co n</p>
    <p>d )</p>
    <p>R e</p>
    <p>q u</p>
    <p>ir e</p>
    <p>d c</p>
    <p>o m</p>
    <p>p u</p>
    <p>ta ti</p>
    <p>o n</p>
    <p>(G ig</p>
    <p>a c</p>
    <p>y cl</p>
    <p>e s</p>
    <p>p e</p>
    <p>r se</p>
    <p>co n</p>
    <p>d )</p>
    <p>Results: PHY Processing</p>
    <p>NSDI 2009, Boston, USA 19</p>
    <p>&gt; 3 0</p>
    <p>x s</p>
    <p>p e e d u p</p>
    <p>~ 1 0</p>
    <p>x s</p>
    <p>p e e d u p</p>
    <p>After Sora Optimization</p>
  </div>
  <div class="page">
    <p>R e</p>
    <p>q u</p>
    <p>ir e</p>
    <p>d c</p>
    <p>o m</p>
    <p>p u</p>
    <p>ta ti</p>
    <p>o n</p>
    <p>(G ig</p>
    <p>a c</p>
    <p>y cl</p>
    <p>e s</p>
    <p>p e</p>
    <p>r se</p>
    <p>co n</p>
    <p>d )</p>
    <p>R e</p>
    <p>q u</p>
    <p>ir e</p>
    <p>d c</p>
    <p>o m</p>
    <p>p u</p>
    <p>ta ti</p>
    <p>o n</p>
    <p>(G ig</p>
    <p>a c</p>
    <p>y cl</p>
    <p>e s</p>
    <p>p e</p>
    <p>r se</p>
    <p>co n</p>
    <p>d )</p>
    <p>Results: PHY Processing</p>
    <p>NSDI 2009, Boston, USA 20</p>
    <p>&gt; 3 0</p>
    <p>x s</p>
    <p>p e e d u p</p>
    <p>~ 1 0</p>
    <p>x s</p>
    <p>p e e d u p</p>
    <p>Sora enables software implementation of todays high-speed wireless system in</p>
    <p>standard PC with a few cores</p>
    <p>After Sora Optimization</p>
  </div>
  <div class="page">
    <p>T h</p>
    <p>ro u</p>
    <p>g h</p>
    <p>p u</p>
    <p>t (M</p>
    <p>b p</p>
    <p>s )</p>
    <p>Modulation Mode</p>
    <p>Sora-Commercial</p>
    <p>Commercial-Commercial</p>
    <p>Commercial-Sora</p>
    <p>Results: End-to-end Throughput</p>
    <p>NSDI 2009, Boston, USA 21</p>
    <p>Communicating with commercial 802.11a/b/g card</p>
  </div>
  <div class="page">
    <p>T h</p>
    <p>ro u</p>
    <p>g h</p>
    <p>p u</p>
    <p>t (M</p>
    <p>b p</p>
    <p>s )</p>
    <p>Modulation Mode</p>
    <p>Sora-Commercial</p>
    <p>Commercial-Commercial</p>
    <p>Commercial-Sora</p>
    <p>Results: End-to-end Throughput</p>
    <p>NSDI 2009, Boston, USA 22</p>
    <p>Communicating with commercial 802.11a/b/g card</p>
    <p>Seamlessly interoperate with commercial WiFi  Correctness of all PHY algorithms  Satisfying timing requirements of standards  Commercial equivalent performance</p>
  </div>
  <div class="page">
    <p>Extensions</p>
    <p>NSDI 2009, Boston, USA 23</p>
    <p>Jumbo frames in 802.11 TDMA MAC</p>
  </div>
  <div class="page">
    <p>Extensions: New Applications</p>
    <p>NSDI 2009, Boston, USA 24</p>
  </div>
  <div class="page">
    <p>Conclusion</p>
    <p>Sora is a fully programmable software radio platform on commodity PC architecture  Easy C programming on multi-core CPU</p>
    <p>High performance: high processing speed, low latency, and performance guarantee  Confirmed by SoftWiFi, the first fully interoperable IEEE</p>
    <p>Plan to release Sora SDK to research community  H/W: RCB + 2.4G RF front-end set (~$2K USD)</p>
    <p>NSDI 2009, Boston, USA 25</p>
  </div>
  <div class="page">
    <p>Sora demo in the demo session this evening</p>
    <p>You can interact with Sora with your own laptop, iPhone, or other smart phones</p>
    <p>SSID: soranet</p>
    <p>DEMO</p>
    <p>NSDI 2009, Boston, USA 2611/5/2008</p>
    <p>HD Video streaming</p>
  </div>
  <div class="page">
    <p>Q&amp;A</p>
    <p>NSDI 2009, Boston, USA 27</p>
  </div>
</Presentation>
