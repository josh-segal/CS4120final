<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>A Stochastic Model for TCP with Stationary Random Losses</p>
    <p>Eitan Altman, Kostya Avrachenkov Chadi Barakat</p>
    <p>INRIA Sophia Antipolis - France</p>
    <p>ACM SIGCOMM August 31, 2000</p>
    <p>Stockholm, Sweden</p>
  </div>
  <div class="page">
    <p>August 31, 2000 2</p>
    <p>Outline  Introduction</p>
    <p>Some facts about TCP and loss events in the Internet</p>
    <p>Our models  A fluid model for rate evolution of TCP  A general model for losses</p>
    <p>Performance analysis  Throughput calculation  Specification of the result to particular loss processes  Introduction of Timeouts and bounds for the window limitation case</p>
    <p>Model validation and concluding remarks</p>
  </div>
  <div class="page">
    <p>August 31, 2000 3</p>
    <p>TCP and losses  TCP congestion control</p>
    <p>An additive-increase multiplicative-decrease strategy for congestion control in the Internet</p>
    <p>Packet losses for congestion detection (possibly ECN)</p>
    <p>When looking at the rate level Loss event (or congestion event): An event that causes the</p>
    <p>reduction of the congestion window by a constant factor. Interpretation: Depends on the version of TCP</p>
    <p>One packet loss for Reno  One lossy round trip-time for Tahoe, New-Reno and SACK</p>
  </div>
  <div class="page">
    <p>August 31, 2000 4</p>
    <p>Losses and TCP modeling  TCP modeling requires a good characterization of</p>
    <p>times between loss events.  Simple loss processes have been considered in the</p>
    <p>literature (Deterministic e.g., [Mathis, Semke, Mahdavi, 1997], Poisson e.g., [Misra, Gong, Towsly, 1999])</p>
    <p>TCP throughput has been expressed only as a function of the average loss rate (e.g., p , )</p>
    <p>But, the Internet is so heterogeneous that losses may exhibit a more complicated distribution  What do our measurements tell us ?</p>
  </div>
  <div class="page">
    <p>August 31, 2000 5</p>
    <p>Measurement testbed</p>
    <p>INRIA - Sophia Antipolis</p>
    <p>ESSI - Sophia Antipolis</p>
    <p>ENST - Paris</p>
    <p>Univ. of South Australia</p>
    <p>Three long-life unlimited-data TCP transfers (New Reno version)  Develop and run a tool at INRIA that detects loss events  Store traces in separate files at fixed intervals (20, 40, and 60 min)</p>
    <p>LAN MAN</p>
    <p>WAN</p>
  </div>
  <div class="page">
    <p>August 31, 2000 6</p>
    <p>Some inter-loss time distributions</p>
    <p>Highly bursty</p>
    <p>LAN</p>
    <p>Inter-loss time (s)</p>
    <p>D en</p>
    <p>si ty</p>
    <p>fu nc</p>
    <p>tio n</p>
    <p>Measurements Exponential</p>
  </div>
  <div class="page">
    <p>August 31, 2000 7</p>
    <p>Some inter-loss time distributions</p>
    <p>Close to Normal</p>
    <p>MAN</p>
    <p>Inter-loss time (s)</p>
    <p>D en</p>
    <p>si ty</p>
    <p>fu nc</p>
    <p>tio n</p>
    <p>Measurements Normal</p>
  </div>
  <div class="page">
    <p>August 31, 2000 8</p>
    <p>Some inter-loss time distributions</p>
    <p>Close to Poisson</p>
    <p>WAN</p>
    <p>Inter-loss time (s)</p>
    <p>D en</p>
    <p>si ty</p>
    <p>fu nc</p>
    <p>tio n</p>
    <p>Measurements Exponential</p>
  </div>
  <div class="page">
    <p>August 31, 2000 9</p>
    <p>Some correlation coefficients</p>
    <p>LAN WAN</p>
    <p>Higher correlation is expected on paths with a significant memory (e.g., wireless links, satellite links).</p>
  </div>
  <div class="page">
    <p>August 31, 2000 10</p>
    <p>Our model for losses  Consider the loss events as a point process</p>
    <p>Denote by {Sn} the times between losses</p>
    <p>The only assumption we made: {Sn} stationary and ergodic</p>
    <p>Notation:  Average inter-loss time: d = 1/ = E[Sn]  Correlation functions: R(k) = E[SnSn+k], k=0,1,...  Covariance functions: C(k) = R(k) - d2, k=0,1,...  Normalized functions: R(k) = R(k)/d2, C(k) = C(k)/d2^ ^</p>
  </div>
  <div class="page">
    <p>August 31, 2000 11</p>
    <p>Our fluid model for TCP  Consider a long TCP transfer with infinite amount of data to send  Denote by X(t) the rate of the connection at time t (=W(t)/RTT )</p>
    <p>X(t)</p>
    <p>t</p>
    <p>Linear increase at rate Congestion detection Multiplicative decrease by</p>
    <p>(typically 0.5)</p>
    <p>Sn Sn+1</p>
    <p>Xn Xn+1</p>
    <p>Xn+2</p>
    <p>=</p>
  </div>
  <div class="page">
    <p>August 31, 2000 12</p>
    <p>Performance analysis</p>
    <p>Input parameters  Parameters of the loss process  Parameters of the connection</p>
    <p>Output parameter  Throughput of the connection</p>
    <p>= t</p>
    <p>t dX</p>
    <p>t X</p>
    <p>)( 1</p>
    <p>lim</p>
  </div>
  <div class="page">
    <p>August 31, 2000 13</p>
    <p>Stochastic Difference Equation Consider the rate between loss n and loss n+1</p>
    <p>nnn SXX  +=+1</p>
    <p>Using Theorem 2A in [Glasserman and Yao,1995]</p>
    <p>The difference equation has a unique stationary solution Xn*</p>
    <p>Xn converges to Xn* for any initial state X0</p>
    <p>{Xn} is an ergodic process</p>
  </div>
  <div class="page">
    <p>August 31, 2000 14</p>
    <p>Calculation of the throughput</p>
    <p>][][)]([ 22 1*0*0</p>
    <p>nnnn SSXEAEtXEX  +===</p>
    <p>tn tn+1</p>
    <p>An*</p>
    <p>=</p>
    <p>+= 1</p>
    <p>k</p>
    <p>k kRRX</p>
    <p>Using Palm theory</p>
    <p>= =</p>
    <p>*</p>
    <p>k kn</p>
    <p>k n SX with</p>
    <p>Sn</p>
    <p>Xn* Xn+1*</p>
  </div>
  <div class="page">
    <p>August 31, 2000 15</p>
    <p>With packet drop probability Let p denote the probability at which a packet is lost in average</p>
    <p>Xp=</p>
    <p>=</p>
    <p>++</p>
    <p>+ =</p>
    <p>)()0( 2 1</p>
    <p>)1(2 11</p>
    <p>k</p>
    <p>k kCC bpRTT</p>
    <p>X</p>
    <p>Due to variance Due to correlationDue to loss rate</p>
  </div>
  <div class="page">
    <p>August 31, 2000 16</p>
    <p>Specification of the model  Deterministic losses: (square root formula)</p>
    <p>Poisson loss process:</p>
    <p>General renewal process:</p>
    <p>Markovian arrival process (see paper):</p>
    <p>The characteristics of the loss process in the connection depend on the state of the system which has a Markovian evolution. Loss events may occur between and during state transitions.</p>
    <p>bpRTT X</p>
    <p>=</p>
    <p>bpRTT X</p>
    <p>+= 2 )(</p>
    <p>d SVar</p>
    <p>bpRTT X n</p>
  </div>
  <div class="page">
    <p>August 31, 2000 17</p>
    <p>Case of rate limitation</p>
    <p>TCP rate increase stops when the receiver window is reached.</p>
    <p>M</p>
    <p>New SDE: ),min( 2 1</p>
    <p>explicit expression of the throughput for a general loss process seems to be impossible given the non-linearity of the model.</p>
    <p>We calculate bounds on the throughput which are also a good approximation of the throughput.</p>
  </div>
  <div class="page">
    <p>August 31, 2000 18</p>
    <p>Introduction of Timeouts  TCP may stay idle for a long time before the detection of a loss.</p>
    <p>Sn+1Sn</p>
    <p>Sn Sn+1Zn</p>
    <p>Timeout Duplicate ACKs</p>
    <p>Average rate when excluding TO intervals</p>
    <p>='X</p>
    <p>])0|[1(' &gt;= nnTO ZZEXX  or</p>
    <p>)()('1 '</p>
    <p>pZpQXp X</p>
    <p>X +</p>
    <p>=</p>
    <p>Q(p) = P(Zn &gt; 0) Z(p) = E[Zn | Zn &gt; 0]</p>
  </div>
  <div class="page">
    <p>August 31, 2000 19</p>
    <p>Validation of the model  Instead of validating once the overall model, we chose to</p>
    <p>validate separately:  The model for losses:</p>
    <p>We compare the results of our model to a reference throughput, the one obtained by a fluid LIMD flow control mechanism. We construct this fluid model using the traces of a real TCP connection.</p>
    <p>The model for TCP rate evolution: The main objective is to validate the assumption on the linearity of rate increase.</p>
    <p>Time (s)</p>
    <p>Real TCP Ideal fluid model</p>
    <p>W in</p>
    <p>do w</p>
    <p>s iz</p>
    <p>e (b</p>
    <p>yt es</p>
    <p>)</p>
  </div>
  <div class="page">
    <p>August 31, 2000 20</p>
    <p>Impact of inter-loss times  With a small number of correlation coefficients, we are able</p>
    <p>to estimate correctly the reference throughput.</p>
    <p>The correlation in our experimentation has not a great impact. A renewal model for losses is quite sufficient.</p>
    <p>The estimate of the throughput increases with the variance of the inter-loss times:</p>
    <p>On LAN, deterministic and Poisson losses lead to an underestimation.</p>
    <p>On MAN, Poisson losses lead to an overestimation.</p>
    <p>On WAN, deterministic losses lead to an underestimation.</p>
  </div>
  <div class="page">
    <p>August 31, 2000 21</p>
    <p>Impact of inter-loss times</p>
    <p>Day time (hours)</p>
    <p>An example of results: Throughput evolution during a day ...</p>
    <p>T C</p>
    <p>P th</p>
    <p>ro ug</p>
    <p>hp ut</p>
    <p>(k bp</p>
    <p>s)</p>
    <p>Day time (hours)</p>
    <p>LAN WAN</p>
    <p>Exact, IID</p>
    <p>PoissonDeterministic</p>
    <p>Exact, IID, Poisson</p>
    <p>Deterministic</p>
  </div>
  <div class="page">
    <p>August 31, 2000 22</p>
    <p>LAN WAN</p>
    <p>Did we model TCP correctly?  We compare the reference throughput to the real one ...</p>
    <p>Good approximation on WAN, but a significant overestimation when the window size is comparable to the bandwidth-delay product (e.g., LAN)</p>
    <p>Day time (hours)</p>
    <p>T C</p>
    <p>P th</p>
    <p>ro ug</p>
    <p>hp ut</p>
    <p>(k bp</p>
    <p>s)</p>
    <p>Day time (hours)</p>
    <p>Ideal TCP, Real TCP</p>
    <p>Deterministic losses</p>
    <p>Ideal TCP</p>
    <p>Real TCP Deterministic losses</p>
  </div>
  <div class="page">
    <p>August 31, 2000 23</p>
    <p>TCP window increases linearly as a function of RTT number rather than time.</p>
    <p>Sublinearity of TCP rate increase  Main cause of the overestimation we observed in LAN:</p>
    <p>In LAN in particular, and on paths where the window size is comparable to the bandwidthdelay product in general, the increase in TCP window results in an increase in RTT (once the bottleneck link is fully utilized).</p>
    <p>A correlated increase between window and RTT results in a sublinear increase in window and rate (the rate stabilizes if the connection is running alone on the path).</p>
    <p>A sublinear rate increase leads to less throughput than a linear one.</p>
    <p>Time (s)</p>
  </div>
  <div class="page">
    <p>August 31, 2000 24</p>
    <p>LAN WAN</p>
    <p>TCP window (bytes) TCP window (bytes)</p>
    <p>Window and RTT</p>
    <p>Linear window increase models often used in the literature work well when the window and the RTT are independent from each other.</p>
    <p>Existing models need to be extended to the case when they are dependent.</p>
    <p>R ou</p>
    <p>nd -t</p>
    <p>ri p</p>
    <p>tim e</p>
    <p>(s )</p>
    <p>For a single trace file</p>
    <p>Samples</p>
    <p>Average +</p>
  </div>
  <div class="page">
    <p>August 31, 2000 25</p>
    <p>Correction for the fluid assumption</p>
    <p>][2 ].[</p>
    <p>n</p>
    <p>n dis SE</p>
    <p>RTTXE RTTXX =</p>
    <p>With this correction, our model with deterministic inter-loss times gives the same performance as the detailed packet level model in</p>
    <p>[Padhye,Firoiu,Towsly,Kurose,1998]</p>
    <p>LAN</p>
    <p>Day time (hours)</p>
    <p>T C</p>
    <p>P th</p>
    <p>ro ug</p>
    <p>hp ut</p>
    <p>(k bp</p>
    <p>s)</p>
    <p>W in</p>
    <p>do w</p>
    <p>s iz</p>
    <p>e (p</p>
    <p>ac ke</p>
    <p>ts )</p>
    <p>Deterministic losses</p>
    <p>Real TCP</p>
  </div>
  <div class="page">
    <p>August 31, 2000 26</p>
    <p>Summary  A good modeling of TCP requires:  A good characterization of inter-loss times. The second moment</p>
    <p>and some correlation coefficients need to be found.  These coefficients can be measured or calculated from another model for</p>
    <p>the network (e.g., as a function of the packet drop probability p).</p>
    <p>A good characterization of TCP window evolution. The dependency between window and RTT needs to be considered.</p>
    <p>The errors introduced by these two characterizations may be in opposite directions and cancel each other, resulting in an overall throughput close to the real one (e.g., LAN, assuming that interloss times are deterministic).</p>
  </div>
</Presentation>
