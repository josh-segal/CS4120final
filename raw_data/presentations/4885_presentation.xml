<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>An asymmetric security</p>
    <p>mechanism for navigation signals</p>
    <p>Markus G. Kuhn</p>
    <p>Computer Laboratory</p>
    <p>http://www.cl.cam.ac.uk/~mgk25/</p>
  </div>
  <div class="page">
    <p>Remote attestation of position</p>
    <p>X2 X3</p>
    <p>X4</p>
    <p>X1</p>
    <p>R V</p>
    <p>d1</p>
    <p>d2 d3</p>
    <p>d4</p>
    <p>N</p>
    <p>{N, r} K</p>
    <p>1</p>
    <p>R</p>
  </div>
  <div class="page">
    <p>Application examples</p>
    <p>GPS receivers are installed in high-valued goods transporters, such that headquarters can remotely monitor the route the vehicles take and act instantly on deviations, to prevent theft.</p>
    <p>Prisoners undergo electronic tagging such that the police can remotely monitor their whereabouts.</p>
    <p>Road-charging systems have been proposed to use navigation receivers in vehicles, to record road usage and calculate fees.</p>
    <p>These are distributed security systems that use a remotely-queried navigation-signal receiver as a trusted component.</p>
    <p>Such a receiver may end up in the hands of an attacker with a strong incentive to manipulate the system such that it reports a pretended position r instead of its actual position r. Examples: vehicle thief, escaping prisoner, road charge avoider</p>
  </div>
  <div class="page">
    <p>Pseudorange positioning systems</p>
    <p>R</p>
    <p>X2 X3</p>
    <p>X4</p>
    <p>X1</p>
    <p>s1(t)</p>
    <p>s2(t)</p>
    <p>s4(t)</p>
    <p>s3(t)</p>
    <p>d1</p>
    <p>d2 d3</p>
    <p>d4</p>
    <p>g(r, t)</p>
    <p>g(r, t) =</p>
    <p>i</p>
    <p>Ai  si</p>
    <p>(</p>
    <p>t  di c</p>
    <p>)</p>
    <p>+ n(r, t)</p>
  </div>
  <div class="page">
    <p>Pseudorange positioning systems</p>
    <p>Transmitter Xi at location xi broadcasts signal si(t).</p>
    <p>Signal propagates through space at speed c.</p>
    <p>Receiver at position r receives signal</p>
    <p>g(r, t) =</p>
    <p>i</p>
    <p>Ai  si</p>
    <p>(</p>
    <p>t  |xi  r|</p>
    <p>c</p>
    <p>)</p>
    <p>+ n(r, t)</p>
    <p>(Ai is path attenuation, n(r, t) is background noise)</p>
    <p>Choose orthogonal signal waveforms si(t), with low auto- and crosscorrelation.</p>
    <p>Receiver can separate the different Ai  si (</p>
    <p>t  |xir|</p>
    <p>c</p>
    <p>)</p>
    <p>terms.</p>
  </div>
  <div class="page">
    <p>Add to si(t) timestamp and current transmitter location.  Receiver can identify time delays |xi  r|/c and ranges</p>
    <p>di = |xi  r|.</p>
    <p>Three ranges, three intersecting spheres  receiver location r. In practice, high-precision atomic clocks are somewhat expensive and only used by transmitters.</p>
    <p>Receiver uses a cheap crystal clock and knows only time estimate tR = t + uR with clock error uR.</p>
    <p>Receiver can identify time delays |xi  r|/c  uR and pseudoranges</p>
    <p>di = |xi  r|  c  uR.</p>
    <p>Clock error uR adds a fourth unknown scalar.  Use four transmitters and solve four pseudorange equations to</p>
    <p>determine both r  R3 and uR. Examples: GPS, Glonass, Galileo, Loran-C</p>
  </div>
  <div class="page">
    <p>Attacks on navigation receivers A) Impersonating the receiver Replace R with a device that takes over communication with remote verifier V and reports pretended position r.</p>
    <p>Countermeasures:</p>
    <p>Use cryptographic authentication protocol between R and V .  Design R as a tamper-resistant device to prevent theft of key.  Tamper-resistant attachment.</p>
    <p>B) Relaying attack Disconnect R from its antenna and connect it via a communication link to a remote antenna at pretended location r. Less likely, since</p>
    <p>challenging logistics for attacker  remote antenna easy to locate  wideband signal may be difficult to relay</p>
  </div>
  <div class="page">
    <p>C) Signal-synthesis attack Attacker connects R to a signal generator that emulates  knowing the predictable waveforms si(t)  the signal g(r</p>
    <p>, t), as it would be received at the pretended position r.</p>
    <p>Countermeasure:</p>
    <p>Add to si(t) an unpredictable but verifiable element, e.g. encrypt the transmitted data (timestamp, transmitter position, etc.) or, better, add a MAC or digital signature of it.</p>
    <p>D) Selective-delay attack Attacker uses signal g(r, t) at the actual position r and converts it into a prediction of the signal g(r, t  t) that would have been received at the pretended position r a short time t earlier, and feeds that into the receiver.</p>
  </div>
  <div class="page">
    <p>Selective-delay attack</p>
    <p>To generate g(r, t  t), the attacker needs to split g(r, t) into</p>
    <p>g(r, t) =</p>
    <p>i</p>
    <p>Ai  gi(r, t) + n(r, t)</p>
    <p>with</p>
    <p>gi(r, t) = si</p>
    <p>(</p>
    <p>t  |xi  r|</p>
    <p>c</p>
    <p>)</p>
    <p>.</p>
    <p>This can then be reassembled into</p>
    <p>g(r, t  t) =</p>
    <p>i</p>
    <p>Ai  gi</p>
    <p>(</p>
    <p>r, t + |xi  r|  |xi  r</p>
    <p>|</p>
    <p>c  t</p>
    <p>)</p>
    <p>+ n(t)</p>
    <p>after choosing</p>
    <p>t  max i</p>
    <p>{|xi  r|  |xi  r |}/c</p>
    <p>to preserve causality. 9</p>
  </div>
  <div class="page">
    <p>Past example of real-word sensor attacks</p>
    <p>Photo: Hampshire Constabulatory / Ross Anderson</p>
    <p>Sensor-signal manipulation devices have already been found in the wild by British police in commercial good vehicles between tachograph and gearbox sensor. Drivers use them to manipulate their velocity and working-hours record.</p>
  </div>
  <div class="page">
    <p>Symmetric security in GPS GPS satellites broadcast a 50 bit/s data signal via direct-sequence spread-spectrum modulation. This comes in two forms:</p>
    <p>Civilian C/A signal</p>
    <p>Data is multiplied with 1.023 Mbit/s pseudorandom-bit spreading sequence and then PSK modulated.</p>
    <p>Spreading sequences are publicly known and repeat every 1023 bits (1 ms).</p>
    <p>The C/A signal is predictable from GPS specification and therefore offers no security against signal-synthesis attacks.</p>
    <p>fc</p>
    <p>noise level</p>
    <p>data signal</p>
    <p>fc  fs fc + fs f</p>
    <p>DSS modulated signal</p>
  </div>
  <div class="page">
    <p>Military Y signal</p>
    <p>Data is multiplied with a 10.23 Mbit/s pseudorandom spreading sequence and then PSK modulated.</p>
    <p>Secret spreading sequence, only known to military receivers.  Spreading step encrypts data like a stream cipher.  100 Hz mainlobe bandwidth of the data signal is spread by a</p>
    <p>factor of 2  105 to 20 MHz.</p>
    <p>Peak power-spectral density is reduced by same factor (53 dB).  Received power-spectral density is therefore about 28 dB below</p>
    <p>thermal noise density of a typical receiver.</p>
    <p>To recover the Y signal from the background noise, a receiver must multiply it phase-synchronously with the same pseudo-random bit sequence. This despreads the data signal back into a 100 Hz band, where a low-pass filter can separate it from the background noise that came through the 20 MHz wide input channel.</p>
  </div>
  <div class="page">
    <p>For a selective-delay attack, it is necessary to split the received signal g(r, t) into the contributions gi(r, t) from individual transmitters.</p>
    <p>There are two options:</p>
    <p>Use high-gain directional antennas that track the satellites  probably less feasible for a mobile attacker, who can only work with compact portable equipment.</p>
    <p>Use the spreading sequences to detect and demodulate each signal  this limits attackers to other military receivers that know the same key.</p>
  </div>
  <div class="page">
    <p>Asymmetric Security</p>
    <p>Goals:</p>
    <p>protect against signal-synthesis and selective-delay attacks</p>
    <p>avoid shared long-term secret keys in receivers that would enable one receiver to attack others</p>
    <p>Can we separate the ability to verify the authenticity and integrity of a navigation signal from the ability to fake one?</p>
    <p>Can we achieve for navigation signals what digital signatures did for published documents?</p>
    <p>The integrity of a navigation broadcast signals rests as much in their exact relative arrival time as in the integrity of the data transmitted.</p>
    <p>Digital signatures alone are no help against selective-delay attacks.</p>
  </div>
  <div class="page">
    <p>Basic idea  Every few seconds, all transmitters broadcast a hidden marker.  A hidden marker carries no data.  It is an unpublished spreading sequence broadcast at least 20 dB</p>
    <p>below the thermal noise seen by any receiver.</p>
    <p>Receivers digitize and buffer in RAM the full bandwidth of the hidden markers while they are broadcast. This preserves their relative arrival times, but it cannot be accessed yet.</p>
    <p>After a delay , the transmitters broadcast the seed value used to generate the hidden marker, which was secret until then.</p>
    <p>Receivers (and attackers!) can only now identify and separate the markers in the recorded antenna signal.</p>
    <p>A signal-synthesis or selective-delay attack can now be performed only with a delay t &gt; .</p>
    <p>Choose  large enough (e.g., 10 s), such that even receivers with a cheap clock can discover the delay in the received timestamps.</p>
  </div>
  <div class="page">
    <p>Steps executed at each transmitter  Each Xi generates a nonce Ni,m, used to seed secure PRBG</p>
    <p>P (Ni,m, j)  {1, +1} (output bit indices j = {0, 1, 2, . . .}).</p>
    <p>During time t  [tm, tm + ], Xi transmits the hidden marker si(t) = A  sin[2fc  (t  tm)]  P (Ni,m, fs  (t  tm))</p>
    <p>where</p>
    <p>fc = signal center frequency</p>
    <p>fs = bit rate of the spreading sequence</p>
    <p>Note:</p>
    <p>tm, fc, fs are identical for all transmitters; this is CDMA, not FDMA or TDMA!</p>
    <p>A is low enough to bring received signal well below the received noise level.</p>
    <p>At time tm +  (where  &gt; ), Xi broadcasts data packet Mi,m = {tm, Xi, xi(tm), Ni,m}K1</p>
    <p>Parts of M may be transmitted earlier, but no information about Ni,m must be revealed before time tm + .</p>
  </div>
  <div class="page">
    <p>Receiver clock considerations</p>
    <p>Each receiver runs a local clock tR(t) independent of navigation signals.</p>
    <p>It has a known maximum relative frequency error f , such that</p>
    <p>tR(t +  )  tR(t)</p>
    <p>f .</p>
    <p>Assume that tR was last adjusted at system time t (by an authenticated two-way clock synchronization from a trusted source, e.g. V ):</p>
    <p>|tR(t)  t|  s.</p>
    <p>The error uR(t) of the local clock tR(t) is then bounded by</p>
    <p>|uR(t)|  f  (t  t) + s, for t  t.</p>
    <p>Simple crystal oscillators offer f &lt; 10 5. Authenticated two-way clock</p>
    <p>synchronization over wireless networks offers s &lt; 100 ms. For t &gt; t  1 week, |uR(t)| &lt; 10 s  choose  = 10 s.</p>
  </div>
  <div class="page">
    <p>Steps taken in each receiver</p>
    <p>During time interval [tm, tm +  + dmax/c], digitize the entire frequency band [fc  fs, fc + fs] and store it in RAM buffer B(t) (sampling rate &gt; 4fs).</p>
    <p>Wait for arrival of messages Mi,m = {tm, Xi, xi(tm), Ni,m}K1</p>
    <p>Discard those where signature verification fails or where tm does not match.</p>
    <p>From each received Ni,m, regenerate the corresponding spreading sequence si(tR). Cross-correlate each with the RAM buffer:</p>
    <p>Ci,m( ) =</p>
    <p>t</p>
    <p>B(t)  si(t +  ) dt</p>
    <p>Record the position i,m of the largest peak in each Ci,m, as well as the relative attenuation wi,m of any second-largest peak.</p>
  </div>
  <div class="page">
    <p>Discard any (i, i,m, wi,m) if wi,m &gt; W</p>
    <p>Use remaining peak-positions i,m as authentic pseudoranges</p>
    <p>di = c  i,m = |xi  r|  c  uR</p>
    <p>and solve for r and uR.</p>
    <p>Accept the result if</p>
    <p>|uR(t)|  f  (t  t) + s &lt; .</p>
    <p>t</p>
    <p>si(t  di/c)</p>
    <p>recording full-band</p>
    <p>noise level</p>
    <p>hidden markers</p>
    <p>re ce</p>
    <p>iv ed</p>
    <p>p o w</p>
    <p>er</p>
    <p>signed data Mi,m</p>
    <p>tm + tm tm +</p>
  </div>
  <div class="page">
    <p>Handling attacks with directional antennas Problem: Attacker can still try to use four dish antennas (or a an equivalent phased array) that track the satellites to isolate their signals for a selective-delay attack.</p>
    <p>If antenna gain is high enough to lift signal out of noise, it can be made noise-free with a threshold operator.</p>
    <p>Otherwise, attacker can still delay and mix the four antenna signals, without removing their noise.</p>
    <p>Solution: In practice, no directional antenna is perfect and attenuated signals from all transmitters will be present in each antenna signal.</p>
    <p>When the antenna signals are delayed individually and then added up, multiple delayed copies of the signals from each transmitter will be present in the result. These will lead to secondary peaks in the cross correlation.</p>
    <p>The purpose of security parameter W is to force attackers to use antennas with side lobes that are at least by that factor weaker compared to the main lobe.</p>
  </div>
  <div class="page">
    <p>Example parameters Scheme particularly well suited for medium orbit satellites, because all receivers have comparable range (GPS: 20 00026 000 km) and SNR.</p>
    <p>Hidden markers must overlap  marker length   maximum path delay variation 20 ms, e.g.  = 1 s.</p>
    <p>Cross-correlation over 1 s equals noise bandwidth of 1 Hz  204 dB noise power at 290 K antenna temperature (pessimistic).</p>
    <p>With fs = 10 MHz (like GPS Y code), the marker has a mainlobe bandwidth of 20 MHz. The noise power across this band is 136 dBW at 100 K antenna temperature (optimistic).</p>
    <p>Arrange transmission power such that 170 dBW reach the receiver, leaving 34 dB SNR with known spreading sequence and 34 dB SNR without.</p>
    <p>Set W = 20 dB (within available SNR, eliminates Yagis)  Use 1-bit A/D converter (more bits useless at 34 dB SNR)  Sampling frequency 200 MHz  25 MB RAM (more for FFT)</p>
  </div>
  <div class="page">
    <p>Conclusions  Protection for pseudo-ranging positioning systems, where at</p>
    <p>tackers can insert signal processor between receiver and antenna.</p>
    <p>Existing military GPS security only of use for mutually trusting communities of receiver users.</p>
    <p>Hidden-marker approach provides asymmetric security, i.e. the navigation signal equivalent of digital signatures, as needed for global civilian applications.</p>
    <p>Solution still based on pseudo-ranging system with low-cost local crystal timebase, therefore still vulnerable to relay attacks.</p>
    <p>Special security parameter provides some protection even against high-end attacks involving multiple satellite-tracking antennas.</p>
    <p>Implementation in forthcoming Galileo system and future GPS extensions?</p>
  </div>
</Presentation>
