<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>From Throw-Away Traffic to Bots: Detecting the Rise of DGA-Based Malware</p>
    <p>Manos Antonakakis</p>
    <p>Damballa Inc. Georgia Institute of Technology, College of Computing</p>
    <p>Atlanta, Georgia</p>
  </div>
  <div class="page">
    <p>Talk Outline</p>
    <p>Preliminaries  DNS Abuse  Problem Statement  Contributions of Pleiades</p>
    <p>Pleiades in Depth  Methodology and C&amp;C Detection  Results and New DGAs Discovered  Latest Discoveries</p>
    <p>Discussion  Consideration and Limitations</p>
  </div>
  <div class="page">
    <p>Credits</p>
    <p>My Research Peers:</p>
    <p>Wenke, Roberto and Nick</p>
    <p>Yacin, Saeed and David</p>
    <p>Special Thanks:</p>
    <p>Jeremy Demar</p>
    <p>Robert Edmonds</p>
  </div>
  <div class="page">
    <p>DNS Abuse and Why Should I Care?</p>
    <p>DNS critical Internet protocol  Illicit operations also rely on DNS  Important to improve ways to deal with DNS abuse  Limiting DNS abuse will help us limit the abuse in the</p>
    <p>Internet</p>
  </div>
  <div class="page">
    <p>Problem Statement</p>
    <p>Abuse (malware, DB, PPI, ect.):</p>
    <p>Why DNS is being exploited?</p>
    <p>Agile and reliable platform  Take-down efforts are hard</p>
    <p>(i.e., MS/Zeus)  Basic economics:</p>
    <p>Domain cost is small  Domain space very big</p>
    <p>Defenders: Manual Blacklisting Attackers: Easy to evade!</p>
    <p>We can deal with the tail using Notos</p>
    <p>Malware-related Domain Discovery:</p>
    <p>Malware discovery typically behind the threat, and malware-domain discovery even slower</p>
    <p>DNS Hierarchy: Different levels enable different classification signal</p>
    <p>We can act proactively at the authority levels using Kopis</p>
    <p>Open Problem: We cannot act proactively at the recursive level!</p>
  </div>
  <div class="page">
    <p>DGAs ecosystem and DGA discovery</p>
    <p>DGA is an alternative agile platform for modern C&amp;C botnets</p>
    <p>Great success so far: Kraken, Sinowal, Srizbi, Zeus-variants etc.</p>
    <p>Currently, the community detects DGA bots via malware analysis</p>
    <p>Reverse-engineer the DGA algorithm  Pre-compute future candidate C&amp;C domains  Register the generated domains before botmaster</p>
    <p>Community can deal only with client side not server side DGAs</p>
  </div>
  <div class="page">
    <p>DGAs ecosystem and DGA discovery</p>
    <p>DGA is an alternative agile platform for modern C&amp;C botnets</p>
    <p>Great success so far: Kraken, Sinowal, Srizbi, Zeus-variants etc.</p>
    <p>Currently, the community detects DGA bots via malware analysis</p>
    <p>Reverse-engineer the DGA algorithm  Pre-compute future candidate C&amp;C domains  Register the generated domains before botmaster</p>
    <p>Community can deal only with client side not server side DGAs</p>
    <p>Several the problem with this:  Obtaining the malware  Preregistering the domains (non-friendly TLDs)  Any binary update could alter the DGA</p>
    <p>Need for a light-weight ISP-level detector</p>
  </div>
  <div class="page">
    <p>Research Contributions</p>
    <p>Early Malware Domain Detection at the recursive level:  Detect rising DGA-botnets prior the malware discovery  Model new DGA-bots without the related malware  Discover the active C&amp;C for the rising DGA-bot</p>
    <p>With Pleiades we can now proactively identify malware-related domain names even in the absence of</p>
    <p>corresponding malware</p>
  </div>
  <div class="page">
    <p>Looking under the hood</p>
  </div>
  <div class="page">
    <p>System Overview</p>
    <p>Test NXDomain</p>
    <p>clusters</p>
    <p>Compromised</p>
    <p>Hosts Report</p>
    <p>DGA Discovery</p>
    <p>DGA Classification and C&amp;C Detection</p>
    <p>Local DNS</p>
    <p>Server</p>
    <p>known</p>
    <p>DGA-botnet</p>
    <p>domains</p>
    <p>legitimate</p>
    <p>domains</p>
    <p>NXDomain</p>
    <p>Clustering</p>
    <p>DGA Classifier</p>
    <p>C&amp;C Detection</p>
    <p>NXDomains</p>
    <p>NXDomains Active</p>
    <p>Domains</p>
    <p>DGA Filtering filter out noise and</p>
    <p>known DGAs</p>
    <p>DGA-like</p>
    <p>NXDomain</p>
    <p>clusters</p>
    <p>NXDomain</p>
    <p>clusters</p>
    <p>new DGA</p>
    <p>models DGA Modeling</p>
  </div>
  <div class="page">
    <p>System Overview</p>
    <p>Test NXDomain</p>
    <p>clusters</p>
    <p>Compromised</p>
    <p>Hosts Report</p>
    <p>DGA Discovery</p>
    <p>DGA Classification and C&amp;C Detection</p>
    <p>Local DNS</p>
    <p>Server</p>
    <p>known</p>
    <p>DGA-botnet</p>
    <p>domains</p>
    <p>legitimate</p>
    <p>domains</p>
    <p>NXDomain</p>
    <p>Clustering</p>
    <p>DGA Classifier</p>
    <p>C&amp;C Detection</p>
    <p>NXDomains</p>
    <p>NXDomains Active</p>
    <p>Domains</p>
    <p>DGA Filtering filter out noise and</p>
    <p>known DGAs</p>
    <p>DGA-like</p>
    <p>NXDomain</p>
    <p>clusters</p>
    <p>NXDomain</p>
    <p>clusters</p>
    <p>new DGA</p>
    <p>models DGA Modeling</p>
    <p>Pleiades: a DGA-based botnet identification system  Analyze streams of NXDomains at the recursive level  Accurately detects and models (new and old) DGA-bots  Our experimental results allowed us to discover six new</p>
    <p>DGA-based botnets  HMM-based active C&amp;C detector for new DGAs</p>
  </div>
  <div class="page">
    <p>Statistical Features in Pleiades</p>
    <p>Group NXDomains per asset with cardinality</p>
  </div>
  <div class="page">
    <p>Statistical Features in Pleiades</p>
    <p>Group NXDomains per asset with cardinality   n-gram Features</p>
    <p>Frequency distribution of n-grams across domain</p>
  </div>
  <div class="page">
    <p>Statistical Features in Pleiades</p>
    <p>Group NXDomains per asset with cardinality   n-gram Features</p>
    <p>Frequency distribution of n-grams across domain  Entropy-based Features</p>
    <p>Entropy of character distribution for separate domain levels, from the domains in the set</p>
  </div>
  <div class="page">
    <p>Statistical Features in Pleiades</p>
    <p>Group NXDomains per asset with cardinality   n-gram Features</p>
    <p>Frequency distribution of n-grams across domain  Entropy-based Features</p>
    <p>Entropy of character distribution for separate domain levels, from the domains in the set</p>
    <p>Structural Domain Features  Summarizes NXDomains structure</p>
    <p>Length  # of unique TLDs  # domain levels</p>
  </div>
  <div class="page">
    <p>NXDomain Graph Construction</p>
    <p>evil1.com</p>
    <p>evil2.com</p>
    <p>evil3.com</p>
    <p>asset 1</p>
    <p>evil3.com</p>
    <p>evil4.com</p>
    <p>evil5.com</p>
    <p>asset 2</p>
    <p>evil3.com</p>
    <p>evil6.com</p>
    <p>evil8.com</p>
    <p>asset 3</p>
    <p>evil6.com</p>
    <p>evil8.com</p>
    <p>asset 4</p>
    <p>evil1.com</p>
    <p>evil2.com</p>
    <p>evli7.com</p>
    <p>asset 5</p>
    <p>evil2.com</p>
    <p>evil1.com</p>
    <p>evil7.com</p>
    <p>evil2.com</p>
    <p>evil5.com</p>
    <p>asset 7asset 6</p>
    <p>evil1</p>
    <p>evil5</p>
    <p>evi2</p>
    <p>evil4</p>
    <p>evil8</p>
    <p>evil6evil7</p>
    <p>evil3</p>
    <p>Weight: Inverse document frequency  Intuition: The higher the number of unique NXDomains</p>
    <p>queried by a host (or asset) the less likely the host is representative of the NXDomains it queries</p>
  </div>
  <div class="page">
    <p>DGA Discovery</p>
    <p>DGA Filtering</p>
    <p>Module</p>
    <p>(4) (5)</p>
    <p>Cluster Correlation</p>
    <p>Module</p>
    <p>(6)</p>
    <p>(2) Clustering Module for</p>
    <p>Name-based Features</p>
    <p>Graph Clustering</p>
    <p>Module</p>
    <p>(1)</p>
    <p>(3)</p>
    <p>New NXDomains</p>
    <p>DGA Discovery Module</p>
    <p>Unknown</p>
    <p>NXDomain Clusters</p>
  </div>
  <div class="page">
    <p>DGA Modeling</p>
    <p>DGA Modeling</p>
    <p>Module</p>
    <p>DGA Classifier</p>
    <p>Unknown NXDomain Clusters</p>
    <p>Asset Based Classification</p>
    <p>Report (4)</p>
    <p>DGA-bot Identification Module</p>
    <p>Knowledge Base</p>
    <p>(1)</p>
    <p>(2)</p>
    <p>(3)</p>
    <p>New</p>
    <p>NXDomains</p>
  </div>
  <div class="page">
    <p>Dataset</p>
  </div>
  <div class="page">
    <p>NXDomains Traffic from ISP</p>
  </div>
  <div class="page">
    <p>Classification Accuracy and New DGAs</p>
  </div>
  <div class="page">
    <p>DGA Modeling: 5 Classes with RF (percent)</p>
    <p>= 5 NXDomains  = 10 NXDomains</p>
    <p>Class TPrate FPrate ROC TPrate FPrate ROC</p>
    <p>Bobax 95 0.4 97 99 0 99 Conficker 98 1.4 98 99 0.1 99 Sinowal 99 0.1 98 100 0 100 Murofet 98 0.7 98 99 0.2 99 Benign 96 0.7 97 99 0.1 99</p>
  </div>
  <div class="page">
    <p>Case study from the paper</p>
  </div>
  <div class="page">
    <p>The BankPatch Trojan</p>
    <p>Active since late 2010  DGA not discovered yet</p>
    <p>Trojan is targeting 187 banks, credit cards and credit unions hard-coded into the binary.</p>
    <p>Some of the US financial entities targeted are BOA, Citi, Wellsfargo, Chase, AmericaFirst, CapitalOne, etc.</p>
    <p>Domain Structure: 4 random characters and a domain</p>
    <p>argument. The arguments are:</p>
    <p>seapollo.com, tomvader.com, aulmala.com, apontis.com, fnomosk.com, erhogeld.com, erobots.com, ndsontex.com, rtehedel.com, nconnect.com, edsafe.com, berhogeld.com, musallied.com, newnacion.com, susaname.com, tvolveras.com and dminmont.com.</p>
  </div>
  <div class="page">
    <p>The C&amp;C Infrastructure for BankPatch</p>
    <p>IP addresses CC Owner</p>
    <p>IP addresses CC Owner</p>
    <p>Sinkhole action showed that this botnet has infected hosts in 270 different networks distributed across 25 different countries.</p>
    <p>Active today! 25 / 31</p>
  </div>
  <div class="page">
    <p>The latest look into BankPatch DGA</p>
    <p>[ 68.35.XXX.XXX 304 0.523465703971 ] lfnnmobama.com hhqrmobama.com brdsmobama.com wmtqmobama.com oqtnmobama.com uiflmobama.com wyhqmobama.com kmtcmobama.com sgvxmobama.com jtulmobama.com pzeimobama.com qedkmobama.com oavbmobama.com ywfhmobama.com gmpvmobama.com dxvnmobama.com wuvsmobama.com tbtimobama.com aybhmobama.com qutomobama.com xxifmobama.com ltjwmobama.com lhuamobama.com iqzwmobama.com blxvmobama.com tnxpmobama.com pbbmmobama.com hhnumobama.com zngmmobama.com vxygmobama.com trtnmobama.com gmjdmobama.com dzxtmobama.com ltcymobama.com uyoamobama.com fdddmobama.com nrwumobama.com fpqtmobama.com lxdbmobama.com hlcfmobama.com ocxrmobama.com ucxumobama.com eeqgmobama.com flaymobama.com segemobama.com tfonmobama.com gmtrmobama.com ogkamobama.com wkccmobama.com dvlzmobama.com rnwimobama.com cqfmmobama.com xdvqmobama.com pjnmmobama.com dxuwmobama.com ljydmobama.com tzfjmobama.com ecpzmobama.com kmnemobama.com ffrnmobama.com ltpumobama.com bxgymobama.com wmdamobama.com briumobama.com igvkmobama.com</p>
    <p>[ 174.56.XXX.XXX 876 0.411764705882 ] ggsgmobama.com msrsmobama.com yuxtmobama.com ushjmobama.com iousmobama.com trnpmobama.com htabmobama.com pbjrmobama.com kcjkmobama.com nrmvmobama.com iypimobama.com wsdwmobama.com dxvnmobama.com aybhmobama.com oabdmobama.com ukmumobama.com zrcmmobama.com ltjwmobama.com rztamobama.com acjymobama.com hhnumobama.com awymmobama.com kaqmmobama.com xtdwmobama.com oskcmobama.com fbgzmobama.com smaemobama.com xvtqmobama.com dxcjmobama.com xfskmobama.com eeqgmobama.com kuvbmobama.com bztfmobama.com uascmobama.com hndlmobama.com wyhqmobama.com iqlzmobama.com vvmemobama.com xtjrmobama.com dbxrmobama.com gsjgmobama.com vbilmobama.com wmdamobama.com gclemobama.com ysdmmobama.com rfvpmobama.com rpgsmobama.com vblcmobama.com zvmimobama.com jrqbmobama.com ccpumobama.com bfudmobama.com suvrmobama.com jlibmobama.com htcxmobama.com uofqmobama.com pnvbmobama.com nfiemobama.com xfmamobama.com dnapmobama.com oaiymobama.com znaqmobama.com dpbamobama.com bvyfmobama.com ukvgmobama.com</p>
  </div>
  <div class="page">
    <p>Some of the unknown at the time DGAs ...</p>
    <p>lymylorozig.eu</p>
    <p>lyvejujolec.eu</p>
    <p>xuxusujenes.eu</p>
    <p>gacezobeqon.eu</p>
    <p>tufecagemyl.eu</p>
    <p>lyvitexemod.eu</p>
    <p>mavulymupiv.eu</p>
    <p>jenokirifux.eu</p>
    <p>fotyriwavix.eu</p>
    <p>vojugycavov.eu</p>
    <p>New-DGA-v6</p>
    <p>semk1cquvjufayg02orednzdfg.com</p>
    <p>invfgg4szr22sbjbmdqm51pdtf.com</p>
    <p>np1r0vnqjr3vbs3c3iqyuwe3vf.com</p>
    <p>s3fhkbdu4dmc00ltmxskleeqrf.com</p>
    <p>gup1iapsm2xiedyefet21sxete.com</p>
    <p>y5rk0hgujfgo0t4sfers2xolte.com</p>
    <p>me5oclqrfano4z0mx4qsbpdufc.com</p>
    <p>jwhnr2uu3zp0ep40cttq3oyeed.com</p>
    <p>ja4baqnv02qoxlsjxqrszdziwb.com</p>
    <p>New-DGA-v4</p>
    <p>zpdyaislnu.net</p>
    <p>vvbmjfxpyi.net</p>
    <p>oisbyccilt.net</p>
    <p>vgkblzdsde.net</p>
    <p>bxrvftzvoc.net</p>
    <p>dlftozdnxn.net</p>
    <p>gybszkmpse.net</p>
    <p>dycsmcfwwa.net</p>
    <p>dpwxwmkbxl.net</p>
    <p>ttbkuogzum.net</p>
    <p>New-DGA-v5</p>
    <p>uwhornfrqsdbrbnbuhjt.com</p>
    <p>epmsgxuotsciklvywmck.com</p>
    <p>nxmglieidfsdolcakggk.com</p>
    <p>ieheckbkkkoibskrqana.com</p>
    <p>qabgwxmkqdeixsqavxhr.com</p>
    <p>gmjvfbhfcfkfyotdvbtv.com</p>
    <p>sajltlsbigtfexpxvsri.com</p>
    <p>uxyjfflvoqoephfywjcq.com</p>
    <p>kantifyosseefhdgilha.com</p>
    <p>lmklwkkrficnnqugqlpj.com</p>
    <p>New-DGA-v3</p>
    <p>clfnoooqfpdc.com</p>
    <p>slsleujrrzwx.com</p>
    <p>qzycprhfiwfb.com</p>
    <p>uvphgewngjiq.com</p>
    <p>gxnbtlvvwmyg.com</p>
    <p>wdlmurglkuxb.com</p>
    <p>zzopaahxctfh.com</p>
    <p>bzqbcftfcrqf.com</p>
    <p>rjvmrkkycfuh.com</p>
    <p>itzbkyunmzfv.com</p>
    <p>New-DGA-v2</p>
    <p>a8459681.com</p>
    <p>a8459681.info</p>
    <p>a8459681.net</p>
    <p>New-DGA-v1</p>
    <p>Some of them are malware related: New-DGA-v1 is EnviServ.A and New-DGA-v6 is Simba-F, while others not active any more.</p>
  </div>
  <div class="page">
    <p>Closing Remarks</p>
  </div>
  <div class="page">
    <p>Pleiades in a nutshell</p>
    <p>DGA-based C&amp;C discovery is very resilient mechanism  Malware increasingly use DGAs (i.e., Zeus)  The community cannot detect DGA bot without malware  Key contributions:</p>
    <p>Detect rising DGA-botnets before responsible malware is found</p>
    <p>Accurately model DGA-bots without malware  Identify active C&amp;C domains for new DGA even in the</p>
    <p>absence of corresponding malware</p>
  </div>
  <div class="page">
    <p>Limitations</p>
    <p>HMM C&amp;C detection of e2LDs domains (i.e., Bonnana)  C&amp;C detection on triple flux networks: IP &amp; C&amp;C fluxing</p>
    <p>simultaneously  DGA to MD5: Automata Induction and Grammar Inference.</p>
    <p>Hard to infer the grammar based on a few characters of the alphabet</p>
  </div>
  <div class="page">
    <p>Thanks! Questions? Manos Antonakakis (manos@antonakakis.org)</p>
  </div>
</Presentation>
