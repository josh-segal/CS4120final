<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Securing Computer Hardware Using 3D Integrated Circuit (IC) Technology and Split Manufacturing</p>
    <p>for Obfuscation</p>
    <p>Frank Imeson</p>
    <p>USENIX Security 13</p>
    <p>ECE, University of Waterloo</p>
    <p>Collaborators: Ariq Emtenan, Siddharth Garg, and Mahesh V. Tripunitara (Waterloo).</p>
    <p>Frank Imeson, Waterloo ECE 3D Hardware Security 1/26</p>
  </div>
  <div class="page">
    <p>Computer Hardware</p>
    <p>Computer Hardware = Digital IC  Physical realization of digital logic  Complex and ubiquitous</p>
    <p>Credit: http://www.newsplink.com/2009/05/20/the-silicon-valley-trail/</p>
    <p>Frank Imeson, Waterloo ECE 3D Hardware Security 2/26</p>
  </div>
  <div class="page">
    <p>Manufacturing Process</p>
    <p>case(display_state) UPDATE : begin seg00_reg &lt;= seg00; seg01_reg &lt;= seg01; // update leds if (count00[0]) begin state &lt;= UPDATE; end default : begin ons00 &lt;= 0; count00 &lt;= 0; display_state &lt;= UPDATE; end endcase</p>
    <p>HDL Netlist IC</p>
    <p>Credit: www.theverge.com/2011/11/16/2565638/mit-neural-connectivity-silicon-synapse</p>
    <p>Frank Imeson, Waterloo ECE 3D Hardware Security 3/26</p>
  </div>
  <div class="page">
    <p>Threat Model</p>
    <p>Netlist ICsExternal Foundry</p>
    <p>News story, May 2012: Security backdoor found in US military chip made in [foreign country].</p>
    <p>Frank Imeson, Waterloo ECE 3D Hardware Security 4/26</p>
  </div>
  <div class="page">
    <p>Attack Types</p>
    <p>Examples:</p>
    <p>Privilege escalation [King et al., LEET08]</p>
    <p>Leaking private information [Skorobogatov et al., CHES 2012]</p>
    <p>Credit: King et al., LEET08</p>
    <p>Frank Imeson, Waterloo ECE 3D Hardware Security 5/26</p>
  </div>
  <div class="page">
    <p>Premise</p>
    <p>Successful Attack</p>
    <p>Uniquely identify at least one gate</p>
    <p>Credit: Cynthia Sturton, Matthew Hicks, David Wagner, and Samuel T. King. Defeating UCI: Building stealthy</p>
    <p>and malicious hardware. In Security and Privacy (SP), 2011 IEEE Symposium on, pp. 64-77. IEEE, 2011.</p>
    <p>Frank Imeson, Waterloo ECE 3D Hardware Security 6/26</p>
  </div>
  <div class="page">
    <p>Premise</p>
    <p>Successful Attack</p>
    <p>Uniquely identify at least one gate</p>
    <p>Credit: Cynthia Sturton, Matthew Hicks, David Wagner, and Samuel T. King. Defeating UCI: Building stealthy</p>
    <p>and malicious hardware. In Security and Privacy (SP), 2011 IEEE Symposium on, pp. 64-77. IEEE, 2011.</p>
    <p>Frank Imeson, Waterloo ECE 3D Hardware Security 6/26</p>
  </div>
  <div class="page">
    <p>Example</p>
    <p>A B</p>
    <p>CIN S</p>
    <p>COUT</p>
    <p>T</p>
    <p>M</p>
    <p>Full Adder Netlist</p>
    <p>Malicious Gate</p>
    <p>Frank Imeson, Waterloo ECE 3D Hardware Security 7/26</p>
  </div>
  <div class="page">
    <p>Example</p>
    <p>A B</p>
    <p>CIN S</p>
    <p>COUT</p>
    <p>T</p>
    <p>Full Adder Netlist</p>
    <p>Frank Imeson, Waterloo ECE 3D Hardware Security 7/26</p>
  </div>
  <div class="page">
    <p>Example</p>
    <p>A B</p>
    <p>CIN S</p>
    <p>COUT</p>
    <p>T</p>
    <p>Full Adder Netlist</p>
    <p>Frank Imeson, Waterloo ECE 3D Hardware Security 7/26</p>
  </div>
  <div class="page">
    <p>Our Solution  Circuit Obfuscation</p>
    <p>A B</p>
    <p>CIN S</p>
    <p>C OUT</p>
    <p>Full Adder Netlist</p>
    <p>Obfuscated Netlist</p>
    <p>X</p>
    <p>V</p>
    <p>U</p>
    <p>W</p>
    <p>Y</p>
    <p>Frank Imeson, Waterloo ECE 3D Hardware Security 8/26</p>
  </div>
  <div class="page">
    <p>Our Solution  Circuit Obfuscation</p>
    <p>A B</p>
    <p>CIN S</p>
    <p>C OUT</p>
    <p>Full Adder Netlist</p>
    <p>Obfuscated Netlist</p>
    <p>X</p>
    <p>V</p>
    <p>U</p>
    <p>W</p>
    <p>Y</p>
    <p>Frank Imeson, Waterloo ECE 3D Hardware Security 8/26</p>
  </div>
  <div class="page">
    <p>Two or more tiers</p>
    <p>Tiers are connected via bond points</p>
    <p>Wire only tiers are relatively inexpensive Substrate</p>
    <p>Unhidden Wires</p>
    <p>Bond Points Hidden Wires</p>
    <p>Transistors/Gates</p>
    <p>IO Pins</p>
    <p>Bottom Tier (Obfuscated)</p>
    <p>Top Tier (Hidden)</p>
    <p>Frank Imeson, Waterloo ECE 3D Hardware Security 9/26</p>
  </div>
  <div class="page">
    <p>Credit: http://www.electroiq.com/articles/ap/2011/10/xilinx-fpga-boasts-6-8b-transistors.html</p>
    <p>Frank Imeson, Waterloo ECE 3D Hardware Security 10/26</p>
  </div>
  <div class="page">
    <p>Circuit Obfuscation with 3D Technology</p>
    <p>Outsourced</p>
    <p>In House</p>
    <p>Fabrication</p>
    <p>Fabrication</p>
    <p>Hidden Circuit</p>
    <p>Obfuscated Circuit</p>
    <p>Stacking</p>
    <p>A B</p>
    <p>CIN S</p>
    <p>C OUT</p>
    <p>U</p>
    <p>V</p>
    <p>X</p>
    <p>W Y</p>
    <p>Hide Wires</p>
    <p>Place and</p>
    <p>Route</p>
    <p>Frank Imeson, Waterloo ECE 3D Hardware Security 11/26</p>
  </div>
  <div class="page">
    <p>Circuit Obfuscation with 3D Technology</p>
    <p>Outsourced</p>
    <p>In House</p>
    <p>Fabrication</p>
    <p>Fabrication</p>
    <p>Hidden Circuit</p>
    <p>Obfuscated Circuit</p>
    <p>Stacking</p>
    <p>A B</p>
    <p>CIN S</p>
    <p>C OUT</p>
    <p>U</p>
    <p>V</p>
    <p>X</p>
    <p>W Y</p>
    <p>Hide Wires</p>
    <p>Place and</p>
    <p>Route</p>
    <p>Frank Imeson, Waterloo ECE 3D Hardware Security 11/26</p>
  </div>
  <div class="page">
    <p>Circuit Obfuscation with 3D Technology</p>
    <p>Outsourced</p>
    <p>In House</p>
    <p>Fabrication</p>
    <p>Fabrication</p>
    <p>Hidden Circuit</p>
    <p>Obfuscated Circuit</p>
    <p>Stacking</p>
    <p>A B</p>
    <p>CIN S</p>
    <p>C OUT</p>
    <p>U</p>
    <p>V</p>
    <p>X</p>
    <p>W Y</p>
    <p>Hide Wires</p>
    <p>Place and</p>
    <p>Route</p>
    <p>Frank Imeson, Waterloo ECE 3D Hardware Security 11/26</p>
  </div>
  <div class="page">
    <p>Attack Model Summary</p>
    <p>A B</p>
    <p>CIN S</p>
    <p>C OUT</p>
    <p>Original Netlist</p>
    <p>Obfuscated Circuit</p>
    <p>V</p>
    <p>X</p>
    <p>U</p>
    <p>W</p>
    <p>Y</p>
    <p>G</p>
    <p>W V</p>
    <p>Y</p>
    <p>X U</p>
    <p>H</p>
    <p>Frank Imeson, Waterloo ECE 3D Hardware Security 12/26</p>
  </div>
  <div class="page">
    <p>Attack Model Summary</p>
    <p>A B</p>
    <p>CIN S</p>
    <p>C OUT</p>
    <p>Original Netlist</p>
    <p>Obfuscated Circuit</p>
    <p>V</p>
    <p>X</p>
    <p>U</p>
    <p>W</p>
    <p>Y</p>
    <p>G</p>
    <p>W V</p>
    <p>Y</p>
    <p>X U</p>
    <p>H</p>
    <p>Frank Imeson, Waterloo ECE 3D Hardware Security 12/26</p>
  </div>
  <div class="page">
    <p>What an Attacker Needs to Do</p>
    <p>Input graphs G and H</p>
    <p>Find subgraph isomorphisms</p>
    <p>G W</p>
    <p>V</p>
    <p>Y</p>
    <p>X U</p>
    <p>H</p>
    <p>Frank Imeson, Waterloo ECE 3D Hardware Security 13/26</p>
  </div>
  <div class="page">
    <p>What an Attacker Needs to Do</p>
    <p>Input graphs G and H</p>
    <p>Find subgraph isomorphisms</p>
    <p>G W</p>
    <p>V</p>
    <p>Y</p>
    <p>X U</p>
    <p>H</p>
    <p>Frank Imeson, Waterloo ECE 3D Hardware Security 13/26</p>
  </div>
  <div class="page">
    <p>What an Attacker Needs to Do</p>
    <p>Input graphs G and H</p>
    <p>Find subgraph isomorphisms</p>
    <p>M1 4</p>
    <p>M2 2</p>
    <p>M3</p>
    <p>G W</p>
    <p>V</p>
    <p>Y</p>
    <p>X U</p>
    <p>H</p>
    <p>M4</p>
    <p>Frank Imeson, Waterloo ECE 3D Hardware Security 13/26</p>
  </div>
  <div class="page">
    <p>k-Security</p>
    <p>S(w) = 2</p>
    <p>S(v),S(u),S(x) = 2</p>
    <p>S(y) = 1</p>
    <p>S(H) = 1</p>
    <p>W V</p>
    <p>Y</p>
    <p>X U</p>
    <p>H 2</p>
    <p>G</p>
    <p>A vertex v  H is k-secure if there exist at least k subgraph isomorphisms each of which maps v to a distinct vertex in G .</p>
    <p>An obfuscated graph (circuit) H is k-secure if every vertex (gate) in H is k-secure.</p>
    <p>Frank Imeson, Waterloo ECE 3D Hardware Security 14/26</p>
  </div>
  <div class="page">
    <p>k-Security</p>
    <p>S(w) = 2</p>
    <p>S(v),S(u),S(x) = 2</p>
    <p>S(y) = 1</p>
    <p>S(H) = 1</p>
    <p>W V</p>
    <p>Y</p>
    <p>X U</p>
    <p>H 2</p>
    <p>G</p>
    <p>A vertex v  H is k-secure if there exist at least k subgraph isomorphisms each of which maps v to a distinct vertex in G .</p>
    <p>An obfuscated graph (circuit) H is k-secure if every vertex (gate) in H is k-secure.</p>
    <p>Frank Imeson, Waterloo ECE 3D Hardware Security 14/26</p>
  </div>
  <div class="page">
    <p>k-Security</p>
    <p>S(w) = 2</p>
    <p>S(v),S(u),S(x) = 2</p>
    <p>S(y) = 1</p>
    <p>S(H) = 1</p>
    <p>W V</p>
    <p>Y</p>
    <p>X U</p>
    <p>H 2</p>
    <p>G</p>
    <p>A vertex v  H is k-secure if there exist at least k subgraph isomorphisms each of which maps v to a distinct vertex in G .</p>
    <p>An obfuscated graph (circuit) H is k-secure if every vertex (gate) in H is k-secure.</p>
    <p>Frank Imeson, Waterloo ECE 3D Hardware Security 14/26</p>
  </div>
  <div class="page">
    <p>k-Security</p>
    <p>S(w) = 2</p>
    <p>S(v),S(u),S(x) = 2</p>
    <p>S(y) = 1</p>
    <p>S(H) = 1</p>
    <p>W V</p>
    <p>Y</p>
    <p>X U</p>
    <p>H 2</p>
    <p>G</p>
    <p>A vertex v  H is k-secure if there exist at least k subgraph isomorphisms each of which maps v to a distinct vertex in G .</p>
    <p>An obfuscated graph (circuit) H is k-secure if every vertex (gate) in H is k-secure.</p>
    <p>Frank Imeson, Waterloo ECE 3D Hardware Security 14/26</p>
  </div>
  <div class="page">
    <p>Computational Complexity</p>
    <p>G,H is k-secure  NP-complete.</p>
    <p>We investigated two approaches:</p>
    <p>Reduction to Subgraph Isomorphism and use of VF2 solver</p>
    <p>Reduction to SAT and use of MiniSAT solver</p>
    <p>Number of Vertices</p>
    <p>Avg Time vf2</p>
    <p>sat</p>
    <p>Frank Imeson, Waterloo ECE 3D Hardware Security 15/26</p>
  </div>
  <div class="page">
    <p>Cost vs. Security</p>
    <p>Cost = Number of hidden edges</p>
    <p>Goal: Explore Cost vs. Security trade-off</p>
    <p>Greedy approach</p>
    <p>Start with no edges in H.</p>
    <p>Greedily pick an edge to add to H that maximizes security.</p>
    <p>Repeat.</p>
    <p>Frank Imeson, Waterloo ECE 3D Hardware Security 16/26</p>
  </div>
  <div class="page">
    <p>Cost vs. Security</p>
    <p>Cost = Number of hidden edges</p>
    <p>Goal: Explore Cost vs. Security trade-off</p>
    <p>Greedy approach</p>
    <p>Start with no edges in H.</p>
    <p>Greedily pick an edge to add to H that maximizes security.</p>
    <p>Repeat.</p>
    <p>Frank Imeson, Waterloo ECE 3D Hardware Security 16/26</p>
  </div>
  <div class="page">
    <p>Cost vs. Security</p>
    <p>Cost = Number of hidden edges</p>
    <p>Goal: Explore Cost vs. Security trade-off</p>
    <p>Greedy approach</p>
    <p>Start with no edges in H.</p>
    <p>Greedily pick an edge to add to H that maximizes security.</p>
    <p>Repeat.</p>
    <p>Frank Imeson, Waterloo ECE 3D Hardware Security 16/26</p>
  </div>
  <div class="page">
    <p>Security vs. Number of Removed Edges</p>
    <p>S ec</p>
    <p>ur ity</p>
    <p>% Hidden Wires (Cost)</p>
    <p>greedy</p>
    <p>rand</p>
    <p>Figure: Experiments on the c432 circuit, which contains 303 edges. The c432 circuit is a 27-channel interrupt controller.</p>
    <p>Frank Imeson, Waterloo ECE 3D Hardware Security 17/26</p>
  </div>
  <div class="page">
    <p>Security vs. Number of Removed Edges</p>
    <p>S ec</p>
    <p>ur ity</p>
    <p>% Hidden Wires (Cost)</p>
    <p>greedy</p>
    <p>rand</p>
    <p>Lower Cost</p>
    <p>Figure: Experiments on the c432 circuit, which contains 303 edges. The c432 circuit is a 27-channel interrupt controller.</p>
    <p>Frank Imeson, Waterloo ECE 3D Hardware Security 17/26</p>
  </div>
  <div class="page">
    <p>Layout Randomization</p>
    <p>Placement of Wires</p>
    <p>Netlist</p>
    <p>Layout</p>
    <p>Routing</p>
    <p>A B</p>
    <p>CIN S</p>
    <p>C OUT</p>
    <p>Placement of Gates</p>
    <p>Frank Imeson, Waterloo ECE 3D Hardware Security 18/26</p>
  </div>
  <div class="page">
    <p>Layout Randomization</p>
    <p>Hidden WiresUnhidden Wires</p>
    <p>Hidden NetlistObfuscated Netlist</p>
    <p>Layout</p>
    <p>Routing</p>
    <p>Frank Imeson, Waterloo ECE 3D Hardware Security 18/26</p>
  </div>
  <div class="page">
    <p>Layout and Routing Results</p>
    <p>(a) Unsecure Circuit (b) Obfuscated Tier (c) Hidden Tier</p>
    <p>Figure: Layout of c432 without any security (left), and the obfuscated (middle) and hidden tiers of an 8-secure version of c432 circuit. Green and red lines correspond to metal wires.</p>
    <p>Frank Imeson, Waterloo ECE 3D Hardware Security 19/26</p>
  </div>
  <div class="page">
    <p>Wire Length Distribution</p>
    <p>R at io</p>
    <p>Distance (um)</p>
    <p>Unsecure Obfuscated</p>
    <p>Hidden</p>
    <p>Figure: Comparison of the wire length distribution for the unsecured, obfuscated and hidden circuits. Also the hidden wire length distribution passes the 2 test when compared to a random distribution.</p>
    <p>Frank Imeson, Waterloo ECE 3D Hardware Security 20/26</p>
  </div>
  <div class="page">
    <p>Power and Delay Costs</p>
    <p>R at</p>
    <p>io</p>
    <p>Security</p>
    <p>Delay</p>
    <p>Power</p>
    <p>Figure: Power and delay ratio calculated from base/unsecured circuit.</p>
    <p>Frank Imeson, Waterloo ECE 3D Hardware Security 21/26</p>
  </div>
  <div class="page">
    <p>Case Study: DES Circuit</p>
    <p>Symmetric key-based encryption/ decryption algorithm.</p>
    <p>A fault in LSB of 14th round reveals secret key [3].</p>
    <p>Further lifting can increase security.</p>
    <p>Plaintext</p>
    <p>Round 01</p>
    <p>Round 14</p>
    <p>IP</p>
    <p>FB</p>
    <p>Round 16</p>
    <p>Ciphertext</p>
    <p>Round 15</p>
    <p>Frank Imeson, Waterloo ECE 3D Hardware Security 22/26</p>
  </div>
  <div class="page">
    <p>Case Study: DES Circuit</p>
    <p>Symmetric key-based encryption/ decryption algorithm.</p>
    <p>A fault in LSB of 14th round reveals secret key [3].</p>
    <p>Further lifting can increase security.</p>
    <p>Plaintext</p>
    <p>Round 01</p>
    <p>Round 14</p>
    <p>IP</p>
    <p>FB</p>
    <p>Round 16</p>
    <p>Ciphertext</p>
    <p>Round 15</p>
    <p>Frank Imeson, Waterloo ECE 3D Hardware Security 22/26</p>
  </div>
  <div class="page">
    <p>Impact on Attack Footprint</p>
    <p>Implemented a 64-secure DES circuit.</p>
    <p>Modified Target</p>
    <p>Target</p>
    <p>Trigger</p>
    <p>t255</p>
    <p>t2</p>
    <p>FSM</p>
    <p>Trigger</p>
    <p>Attacking a non-secure circuit</p>
    <p>target1</p>
    <p>t1</p>
    <p>Attacking a k-secure circuit</p>
    <p>target2</p>
    <p>t2</p>
    <p>target255</p>
    <p>t255</p>
    <p>Attacking all k possible targets</p>
    <p>Frank Imeson, Waterloo ECE 3D Hardware Security 23/26</p>
  </div>
  <div class="page">
    <p>Raising the Bar on the Attacker</p>
    <p>Attack 1 out of k gates</p>
    <p>or</p>
    <p>Attack all k gates</p>
    <p>MIPS 00000-00-001</p>
    <p>MIPS 00000-00-001</p>
    <p>Frank Imeson, Waterloo ECE 3D Hardware Security 24/26</p>
  </div>
  <div class="page">
    <p>Related Work and References</p>
    <p>Alina Campan and Traian Truta.</p>
    <p>Data and structural k-anonymity in social networks. Privacy, Security, and Trust in KDD, pages 3354, 2009.</p>
    <p>Alex Baumgarten, Michael Steffen, Matthew Clausman, and Joseph Zambreno.</p>
    <p>A case study in hardware trojan design and implementation. International Journal of Information Security, 10(1):114, 2011.</p>
    <p>Dan Boneh, Richard DeMillo, and Richard Lipton.</p>
    <p>On the importance of checking cryptographic protocols for faults. In Advances in CryptologyEUROCRYPT97, pages 3751. Springer, 1997.</p>
    <p>F. Brglez.</p>
    <p>Neutral netlist of ten combinational benchmark circuits and a target translator in fortran. In Special session on ATPG and fault simulation, Proc. IEEE Int. Symp. Circuits and Systems, June 1985, pages 663698, 1985.</p>
    <p>Y. Jin, N. Kupp, and Y. Makris.</p>
    <p>Experiences in hardware trojan design and implementation. In Hardware-Oriented Security and Trust, 2009. HOST09. IEEE International Workshop on, pages 5057. IEEE, 2009.</p>
    <p>S. h and C. Woods.</p>
    <p>Breakthrough silicon scanning discovers backdoor in military chip. Cryptographic Hardware and Embedded SystemsCHES 2012, pages 2340, 2012.</p>
    <p>Frank Imeson, Waterloo ECE 3D Hardware Security 25/26</p>
  </div>
  <div class="page">
    <p>Frank Imeson, Waterloo ECE 3D Hardware Security 26/26</p>
  </div>
</Presentation>
