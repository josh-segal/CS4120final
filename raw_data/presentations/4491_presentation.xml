<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Towards Estimating the Number of Distinct Value</p>
    <p>Combinations for a Set of Attributes</p>
    <p>Xiaohui Yu1, Calisto Zuzarte2, Ken Sevcik1 1University of Toronto 2IBM Toronto Lab xhyu@cs.toronto.edu</p>
  </div>
  <div class="page">
    <p>CIKM 2005 2</p>
    <p>Distinct value combinations</p>
    <p>Country City Hotel Name</p>
    <p>Germany Bremen Hilton</p>
    <p>Germany Bremen Best Western</p>
    <p>Germany Frankfurt InterCity</p>
    <p>Canada Toronto Four Seasons</p>
    <p>Canada Toronto Intercontinent al</p>
    <p>COLSCARD (COlumn Set CARDinality) = 3</p>
    <p>The problem: estimating COLSCARD for a given set of attributes</p>
  </div>
  <div class="page">
    <p>CIKM 2005 3</p>
    <p>Motivation  Cardinality estimation for query</p>
    <p>optimization, e.g.,  Estimating the size of  Estimating the size of the aggregation</p>
    <p>Approximate query answering, e.g., COUNT queries</p>
    <p>Hotelcitycountry ),(</p>
    <p>SELECT sales_date, sales_person, SUM(sales_quantity) AS unit_sold FROM sales GROUP BY sales_date, sales_person</p>
  </div>
  <div class="page">
    <p>CIKM 2005 4</p>
    <p>Roadmap  Related work  Estimation with known marginal</p>
    <p>distributions  Upper/lower bounds  An estimator</p>
    <p>Estimation with histograms  Experimental results  Conclusions</p>
  </div>
  <div class="page">
    <p>CIKM 2005 5</p>
    <p>Related work</p>
    <p>Previous work has focused on the case of single attribute.  [HT88],[HT89],[HNSS95],[HS98],[CCMN00]</p>
    <p>Sampling approach is used.  Estimation through sampling is difficult</p>
    <p>[CCMN00]</p>
    <p>No existing statistical information is exploited.</p>
  </div>
  <div class="page">
    <p>CIKM 2005 6</p>
    <p>Our solution  Considering multiple-attributes  Utilizing existing statistics on individual</p>
    <p>attributes  Readily available in most database systems  Does not require access to the data</p>
    <p>Granularity of statistics  Exact marginal frequency distributions  Approximate distributions: histograms etc.</p>
  </div>
  <div class="page">
    <p>CIKM 2005 7</p>
    <p>Estimation with known marginals  Number of distinct values in attribute Ai,</p>
    <p>frequency vector</p>
    <p>),...,2,1( midi</p>
    <p>i</p>
    <p>i</p>
    <p>d</p>
    <p>j ijidiii ffff</p>
    <p>)4.0,6.0(1 f</p>
    <p>Country City Hotel Name</p>
    <p>Germany Bremen Hilton</p>
    <p>Germany Bremen Best Western</p>
    <p>Germany Frankfurt InterCity</p>
    <p>Canada Toronto Four Seasons</p>
    <p>Canada Toronto Intercontinental</p>
    <p>)4.0,2.0,4.0(2 f )2.0,2.0,2.0,2.0,2.0(3 f</p>
  </div>
  <div class="page">
    <p>CIKM 2005 8</p>
    <p>The nave estimator</p>
    <p>COLSCARD =  Ndm i</p>
    <p>i ,min 1</p>
    <p>Number of possible valu e combinations</p>
    <p>di: the number of distinct values in attribute Ai</p>
    <p>Sanity bound: COLSCARD cannot be greater than the table size</p>
    <p>The problem: Some value combinations with low occurrence probabilities may not appear in the table!</p>
  </div>
  <div class="page">
    <p>CIKM 2005 9</p>
    <p>Upper/Lower bounds</p>
    <p>Trivial bounds  Upper bound: (the nave</p>
    <p>estimator)  Lower bound:</p>
    <p>Tighter bounds?  In the case of two attributes, tighter bounds</p>
    <p>are available.</p>
    <p>mddd ,...,,max 21</p>
    <p>Ndm i</p>
    <p>i ,min 1</p>
  </div>
  <div class="page">
    <p>CIKM 2005 10</p>
    <p>Tighter bounds</p>
    <p>N = 10</p>
    <p>d e f</p>
    <p>a b c</p>
    <p>A2A1</p>
    <p>Nave bounds: 3, 9 Lower bound = 2+1+1 = 4</p>
    <p>value freqvalue freq</p>
    <p>[2, 3]</p>
    <p>Upper bound = 3+1+1 = 5</p>
  </div>
  <div class="page">
    <p>CIKM 2005 11</p>
    <p>Expected number of combinations</p>
    <p>Assumptions 1. The data distributions of individual columns are</p>
    <p>independent</p>
    <p>Each element of f represents the</p>
    <p>frequency of a specific value combination.  An estimate of the probability of occurrence</p>
    <p>mffff  21</p>
  </div>
  <div class="page">
    <p>CIKM 2005 12</p>
    <p>Estimator  The probability of the i-th combination</p>
    <p>not appearing in a particular tuple is</p>
    <p>The probability of the i-th combination not appearing in the table (of size N) is</p>
    <p>The expected number of value combinations is</p>
    <p>)1( if</p>
    <p>i</p>
    <p>N ifMCOLSCARDE )1(][ )(</p>
    <p>j jdM</p>
    <p>N if )1(</p>
  </div>
  <div class="page">
    <p>CIKM 2005 13</p>
    <p>Example revisited  Estimate the COLSCARD for attribute set (A1, A2, A3),</p>
    <p>given</p>
    <p>)6.0,3.0,1.0(1 f )99.0,01.0(2 f )95.0,05.0(3 f 100N</p>
    <p>New estimate: 5.94</p>
    <p>Nave estimate: 3*2*2 = 12</p>
    <p>,09405.0,00495.0,00095.0,00005.0(321  ffff ,28215.0,01485.0,00285.0,00015.0 )05643.0,02970.0,00570.0,00030.0</p>
  </div>
  <div class="page">
    <p>CIKM 2005 14</p>
    <p>Roadmap</p>
    <p>Related work  Estimation with known marginal</p>
    <p>distributions  Upper/lower bounds  An estimator</p>
    <p>Estimation with histograms  Experimental results  Conclusions</p>
  </div>
  <div class="page">
    <p>CIKM 2005 15</p>
    <p>Estimation with histograms</p>
    <p>Histograms exist on individual attributes  Two classes of histograms</p>
    <p>Partition-based  End-biased</p>
    <p>Marginals can be (approximately) reconstru cted from histograms</p>
    <p>Optimal histograms in each class?</p>
  </div>
  <div class="page">
    <p>CIKM 2005 16</p>
    <p>Optimal histograms</p>
    <p>Minimizing the error incurred by histograms  ERR = |ESThist  ESTexact|</p>
    <p>Partition-based histograms  A dynamic programming algorithm similar to tha</p>
    <p>t for V-optimal histogram construction [Jagadish et al. 98] can be used.</p>
  </div>
  <div class="page">
    <p>CIKM 2005 17</p>
    <p>Optimal end-biased histograms  An end-biased histogram with B buckets</p>
    <p>stores  The exact frequencies of B-1 attribute values  The average of the remaining values</p>
    <p>Which B-1 values to store exactly?  Most widely used end-biased histograms</p>
    <p>store the frequencies of the most frequent values  Not always optimal for COLSCARD estimation!!</p>
  </div>
  <div class="page">
    <p>CIKM 2005 18</p>
    <p>Example</p>
    <p>)9.0,1.0(1 f</p>
    <p>Attributes (A1, A2)</p>
    <p>Choose 1 frequency to store exactly</p>
    <p>Index of the frequency stored</p>
    <p>Error table</p>
    <p>N=10</p>
  </div>
  <div class="page">
    <p>CIKM 2005 19</p>
    <p>Optimal end-biased histograms  Exhaustive search takes time proportional to  We prove that the optimal choices can be one of t</p>
    <p>he following  Most frequent values  Least frequent values  A combination of most frequent and least frequent value</p>
    <p>s  Only need to search both ends</p>
    <p>Cost is linear in B, independent of dj!</p>
    <p>C</p>
  </div>
  <div class="page">
    <p>CIKM 2005 20</p>
    <p>Roadmap</p>
    <p>Related work  Estimation with known marginal</p>
    <p>distributions  Upper/lower bounds  An estimator</p>
    <p>Estimation with histograms  Experimental results  Conclusions</p>
  </div>
  <div class="page">
    <p>CIKM 2005 21</p>
    <p>Experiments  Data sets</p>
    <p>Synthetic data  Skew: Zipfian parameter z=0 (uniform) to 4 (highly skewe</p>
    <p>d)  Number of tuples: 10K to 1M</p>
    <p>Real data  Cover Type: 581,012 tuples, 10 attributes  Census Income: 32,561 tuples, 14 attributes</p>
    <p>Error measure: ratio error  ERR = max{true/est-1, est/true-1}</p>
  </div>
  <div class="page">
    <p>CIKM 2005 22</p>
    <p>Effect of data skew</p>
    <p>N=100K</p>
    <p>di=1k</p>
  </div>
  <div class="page">
    <p>CIKM 2005 23</p>
    <p>Effect of number of tuples</p>
  </div>
  <div class="page">
    <p>CIKM 2005 24</p>
    <p>Results on real data</p>
  </div>
  <div class="page">
    <p>CIKM 2005 25</p>
    <p>Accuracy of end-biased histograms</p>
    <p>Results on the capital-gain attribute of Census Income data set</p>
  </div>
  <div class="page">
    <p>CIKM 2005 26</p>
    <p>Conclusions</p>
    <p>Utilizing existing knowledge maintained in database systems</p>
    <p>Proposed upper/lower bounds as well as an estimator</p>
    <p>Considered two cases  exact marginal frequencies  Histograms: optimal histograms</p>
    <p>Experimental results show the effectiveness of the proposed method</p>
  </div>
</Presentation>
