<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>FANCI Feature-based Automated NXDomain Classification and Intelligence</p>
    <p>Samuel Schppen1 Dominik Teubert2 Patrick Herrmann1 Ulrike Meyer1</p>
    <p>August 17, 2018</p>
    <p>RWTH Aachen University1 and Siemens CERT2</p>
  </div>
  <div class="page">
    <p>Traditional Bot Communication</p>
  </div>
  <div class="page">
    <p>Traditional Bot Communication</p>
    <p>Easy to block fixed domains or IP addresses. 1</p>
  </div>
  <div class="page">
    <p>Domain Generation Algorithm (DGA)</p>
    <p>DGAs are popular: more than 70 DGAs known 2</p>
  </div>
  <div class="page">
    <p>The Approach</p>
  </div>
  <div class="page">
    <p>The Challenge</p>
    <p>Classify non-existent domains (NXDs)</p>
    <p>iieee.org i8a0q2wdu8otulkfylo2gdq.ddns.net mcirosfot.com layergetadobpeflash.net strangerbiketechnology.com etadobeflgashplayer.net bayanescortbandirma.xyz fsztakqwdjfqsc.asa.at</p>
    <p>wfn hde.de kaqoeizerbo ahxuro bdughh.rwth-aachen.de 873c174ca173b5393e93f9571e8a293b.org de-swyx-2.fraba.local kh1her76avy0qnelivijwd1.ddns.net www.digitexeu.com brwc0f8da79205c.net</p>
  </div>
  <div class="page">
    <p>The Challenge</p>
    <p>Classify non-existent domains (NXDs)</p>
    <p>iieee.org i8a0q2wdu8otulkfylo2gdq.ddns.net mcirosfot.com layergetadobpeflash.net strangerbiketechnology.com etadobeflgashplayer.net bayanescortbandirma.xyz fsztakqwdjfqsc.asa.at</p>
    <p>wfn hde.de kaqoeizerbo ahxuro bdughh.rwth-aachen.de 873c174ca173b5393e93f9571e8a293b.org de-swyx-2.fraba.local kh1her76avy0qnelivijwd1.ddns.net www.digitexeu.com brwc0f8da79205c.net</p>
  </div>
  <div class="page">
    <p>Contribution</p>
    <p>We present FANCI</p>
    <p>Feature-based Automated NXDomain Classification Intelligence</p>
    <p>ML-based classification of NXDs into benign and DGA-related  High accuracy  Lightweight and efficient  Classification on domain names only  no meta data required  Generalizable and usable as-a-service</p>
    <p>Find DGA-based malware infected devices / deliver actionable IoCs 4</p>
  </div>
  <div class="page">
    <p>FANCI</p>
  </div>
  <div class="page">
    <p>FANCIs Architecture</p>
    <p>benign non-existent domain (BNXD) algorithmically generated domain (AGD)</p>
  </div>
  <div class="page">
    <p>Classification</p>
    <p>benign non-existent domain (BNXD) algorithmically generated domain (AGD)</p>
  </div>
  <div class="page">
    <p>Supervised Learning Classifier</p>
  </div>
  <div class="page">
    <p>Supervised Learning Classifier</p>
  </div>
  <div class="page">
    <p>Feature Extraction</p>
  </div>
  <div class="page">
    <p>Feature Design</p>
    <p>structural 12 Valid TLD binary 1 1</p>
    <p>linguistic 7 Alphabet Cardinality integer 10 21</p>
    <p>statistical 2 Entropy rational 3.35 4.18</p>
    <p>d1 = nxdomain.siemens.com d2 = dekh1her76avy0qnelivijwd1.ddns.net</p>
  </div>
  <div class="page">
    <p>Evaluation</p>
  </div>
  <div class="page">
    <p>Data Set</p>
    <p>RWTH Aachen University  35.8 million unique benign NXDs</p>
    <p>31 days (May - June 17)  central DNS server</p>
    <p>Siemens AG  31.2 million unique benign NXDs</p>
    <p>61 days (Sep - Oct 17)  DNS servers from EU, USA, Asia</p>
    <p>DGArchive1</p>
    <p>49.7 million unique DGA domains</p>
    <p>1,344 days (2014 2018)</p>
    <p>more than 70 DGAs</p>
  </div>
  <div class="page">
    <p>Select the Best Classifier</p>
    <p>One DGA one Classifier vs. Multiple DGAs one Classifier</p>
    <p>Support Vector Machine vs. Random Forest</p>
  </div>
  <div class="page">
    <p>Select the Best Classifier</p>
    <p>One DGA one Classifier vs. Multiple DGAs one Classifier</p>
    <p>Support Vector Machine vs. Random Forest</p>
  </div>
  <div class="page">
    <p>Select the Best Classifier</p>
    <p>One DGA one Classifier vs. Multiple DGAs one Classifier</p>
    <p>Support Vector Machine vs. Random Forest</p>
  </div>
  <div class="page">
    <p>The Best Performing Classifier</p>
    <p>One Random Forest classifier trained with all known DGAs</p>
  </div>
  <div class="page">
    <p>Multiple DGAs One Random Forest Classifier</p>
    <p>RF x  xmin x xmax</p>
    <p>ACC 0.9976 0.0001 0.9975 0.9976 0.9978</p>
    <p>TPR 0.9976 0.0001 0.9974 0.9976 0.9978</p>
    <p>FPR 0.0025 0.0001 0.0023 0.0025 0.0027</p>
    <p>RF x  xmin x xmax</p>
    <p>ACC 0.9807 0.0003 0.9797 0.9808 0.9812</p>
    <p>TPR 0.9639 0.0007 0.9618 0.9640 0.9647</p>
    <p>FPR 0.0024 0.0002 0.0022 0.0024 0.0027</p>
    <p>x: arithmetic mean; : standard deviation; xmin: minimum; x: median; xmax: maximum 12</p>
  </div>
  <div class="page">
    <p>Multiple DGAs One Random Forest Classifier</p>
    <p>RF x  xmin x xmax</p>
    <p>ACC 0.9976 0.0001 0.9975 0.9976 0.9978</p>
    <p>TPR 0.9976 0.0001 0.9974 0.9976 0.9978</p>
    <p>FPR 0.0025 0.0001 0.0023 0.0025 0.0027</p>
    <p>RF x  xmin x xmax</p>
    <p>ACC 0.9807 0.0003 0.9797 0.9808 0.9812</p>
    <p>TPR 0.9639 0.0007 0.9618 0.9640 0.9647</p>
    <p>FPR 0.0024 0.0002 0.0022 0.0024 0.0027</p>
    <p>x: arithmetic mean; : standard deviation; xmin: minimum; x: median; xmax: maximum 12</p>
  </div>
  <div class="page">
    <p>Generalization</p>
    <p>RF x  xmin x xmax</p>
    <p>ACC 0.9953 0.0002 0.9951 0.9953 0.9957</p>
    <p>TPR 0.9994 0.0001 0.9992 0.9994 0.9995</p>
    <p>FPR 0.0087 0.0003 0.0080 0.0088 0.0092</p>
    <p>RF x  xmin x xmax</p>
    <p>ACC 0.9979 0.0001 0.9977 0.9978 0.9980</p>
    <p>TPR 0.9995 0.0001 0.9994 0.9995 0.9995</p>
    <p>FPR 0.0038 0.0002 0.0035 0.0038 0.0041</p>
    <p>x: arithmetic mean; : standard deviation; xmin: minimum; x: median; xmax: maximum</p>
  </div>
  <div class="page">
    <p>Real World Application: Setup</p>
    <p>Fresh data set (university): 31 days (13 Oct 17 - 12 Nov 17)  35 million unique NXDs  Single-threaded on consumer hardware</p>
  </div>
  <div class="page">
    <p>Real World Application: Results</p>
    <p>We found 10 groups of unknown DGA-related domains: 405 overall</p>
    <p>Unknown DGA 1 cxoriilg.host dcveyroohhuz.host ktnotybgnqrjvkq.host ndptbhn.host qbeweonxhzlflh.host zwchzomnkersegz.host</p>
    <p>Unknown DGA 2 blwemxb.ga yinnic.gq fyrrzx.ml fhvfbhq.tk ihrslrk.cf xlajbu.cf</p>
    <p>Unknown DGA 3 brn001ba9933850.net brn001ba99fa1c7.net brw48e244240e9d.net brwc0f8da79205c.net brw184f328b61dc.net brwc48e8fbdfa3e.net</p>
    <p>Unknown DGA 4 or Seed of Redyms</p>
    <p>Unknown DGA 5 or Seed of GozNym 2nd Stage / Nymaim afyonescortkizlar.xyz ordubayanescort.xyz kirikkalebayanescort.xyz nigdebayanescort.xyz bayanescortbandirma.xyz bayanescortbilecik.xyz afyonescortkizlar.xyz</p>
    <p>Unknown DGA 6 or Seed of GozNym 2nd Stage / Nymaim getbeautifuljacked.xyz evelynmiller.xyz juicepress.xyz quietbranch.xyz tracyhernandez.xyz webhostpremium.xyz wertvollebrillanthobby.xyz</p>
  </div>
  <div class="page">
    <p>Summary</p>
    <p>FANCI classifies NXDs into benign and DGA-related  based on domain names only</p>
    <p>lightweight, efficient, and with high accuracy</p>
    <p>FANCI is real-world applicable  found 10 groups of unknown DGA domains</p>
    <p>FANCI generalizes well and is usable as-a-service</p>
    <p>Available on GitHub: https://github.com/fanci-dga-detection/fanci 15</p>
  </div>
</Presentation>
