<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Security Analysis of Web-based Password Managers</p>
    <p>Zhiwei Li, Warren He, Devdatta Akhawe, Dawn Song</p>
    <p>University of California, Berkeley</p>
    <p>The Emperors New Password Manager</p>
  </div>
  <div class="page"/>
  <div class="page"/>
  <div class="page"/>
  <div class="page">
    <p>Benefits of Password Managers  Memorywise-Effortless  Scalable-for-Users  Physically-Effortless  Resilient-to-Physical-Observation  Resilient-to-Throttled-Guessing  Resilient-to-Unthrottled-Guessing  Resilient-to-Leaks-from-Other-Verifiers  Resilient-to-Phishing</p>
  </div>
  <div class="page">
    <p>Keep All of Your Logins Secure With XXXX</p>
    <p>XXXX Offers NSA-Level Protection for Your Passwords</p>
    <p>XXXX: Unbreakable Passwords That You Dont Have to Remember</p>
    <p>XXXX Wins Best Mobile App at CES 2014</p>
    <p>XXXX Never Forget a Password Again</p>
    <p>XXXX Surpasses Gmail for Top Productivity App</p>
    <p>XXXX is a must-use freeware tool that supports multiple operating systems and browsers</p>
    <p>Apps to Protect Your Array of Passwords</p>
  </div>
  <div class="page"/>
  <div class="page">
    <p>Are they truly secure?</p>
  </div>
  <div class="page">
    <p>How it works</p>
    <p>Alice Alice Bob(Collaborator)</p>
    <p>dropbox.com</p>
  </div>
  <div class="page">
    <p>Security Goals  Master Account Security  impossible for an attacker to authenticate as the</p>
    <p>user to the password manager</p>
    <p>Credential Database Security  ensure the CIA of the credential</p>
    <p>database</p>
    <p>Unlinkability  Use of password manager should not</p>
    <p>allow colluding web applications to track a single user across websites</p>
  </div>
  <div class="page">
    <p>Threat model</p>
    <p>Web attacker</p>
    <p>Control web servers</p>
    <p>DNS domains</p>
    <p>get a victim to visit controlled domains</p>
  </div>
  <div class="page">
    <p>bookmarklet vulnerabilities</p>
    <p>classic web vulnerabilities</p>
    <p>authorization vulnerabilities</p>
    <p>user interface vulnerabilities</p>
    <p>NO product was safe against all four</p>
    <p>Four classes of vulnerabilities</p>
  </div>
  <div class="page">
    <p>authorization vulnerabilities</p>
    <p>classic web vulnerabilities</p>
    <p>user interface vulnerabilities</p>
    <p>bookmarklet vulnerabilities</p>
  </div>
  <div class="page">
    <p>Bookmarklet  A bookmarklet is a snippet of JavaScript code  installs as a bookmark  when clicked, runs in the context of the current page  interact with a login form</p>
  </div>
  <div class="page">
    <p>dropbox.com</p>
    <p>The iframe loads Alices encrypted master key and encrypted credential for dropbox.com (specified by</p>
    <p>a URL parameter).</p>
    <p>This is done using a &lt;script&gt; tag in the iframe.</p>
    <p>Bookmarklet loads a LastPass page in an iframe</p>
    <p>Bookmarklet code is a stub that loads the main code from lastpass.com</p>
    <p>Alice clicks bookmarklet, which includes _LASTPASS_RAND and h</p>
    <p>PostMessage communicates the decryption key to the iframe, which decrypts the credential and sends it</p>
    <p>back through PostMessage.</p>
  </div>
  <div class="page">
    <p>LastPass Bookmarklet Attack</p>
  </div>
  <div class="page">
    <p>Leaking sensitive data into untrusted pages</p>
    <p>All password managers that support bookmarklet leak their credentials  LastPass  RoboForm  My1login</p>
  </div>
  <div class="page">
    <p>authorization vulnerabilities</p>
    <p>classic web vulnerabilities</p>
    <p>user interface vulnerabilities</p>
    <p>bookmarklet vulnerabilities</p>
  </div>
  <div class="page">
    <p>Web Vulnerabilities</p>
    <p>Subtleties of the web platform  Focus on CSRF and XSS</p>
    <p>CSRF vulnerabilities  LastPass, RoboForm, and NeedMyPassword</p>
    <p>XSS vulnerability  NeedMyPassword</p>
  </div>
  <div class="page">
    <p>LastPass One-Time Password</p>
    <p>OTP feature  authentication code for the master account  only valid for one use</p>
  </div>
  <div class="page">
    <p>h = hash(hash(alice|otp)|otp) rand_encrypted_key = encrypt(masterkey, hash(alice|otp))</p>
  </div>
  <div class="page">
    <p>OTP Attack h = hash(hash(alice|otp)|any_otp) rand_encrypted_key = encrypt(dummy, hash(alice|any_otp))</p>
    <p>The attacker can then log into Alices master account to view unencrypted information and delete credentials</p>
  </div>
  <div class="page">
    <p>authorization vulnerabilities</p>
    <p>classic web vulnerabilities</p>
    <p>user interface vulnerabilities</p>
    <p>bookmarklet vulnerabilities</p>
  </div>
  <div class="page">
    <p>Collaboration</p>
    <p>Alice Bob(Collaborator)</p>
    <p>Ability to share passwords with a collaborator</p>
    <p>Alice requests to share a credential with Bob  Password manager forwards the credential to Bob  Both need accounts with the password manager</p>
  </div>
  <div class="page">
    <p>Authorization Vulnerabilities</p>
    <p>Three support collaboration</p>
    <p>Both My1login and PasswordBox mistook authentication for authorization</p>
  </div>
  <div class="page"/>
  <div class="page"/>
  <div class="page">
    <p>authorization vulnerabilities</p>
    <p>classic web vulnerabilities</p>
    <p>user interface vulnerabilities</p>
    <p>bookmarklet vulnerabilities</p>
  </div>
  <div class="page">
    <p>User Interface Vulnerabilities  Resilient-to-Phishing  a major benefit of password managers  detects application  (auto-)fill the right password</p>
    <p>Vulnerable  LastPass  RoboForm</p>
  </div>
  <div class="page">
    <p>Logging into RoboForm</p>
    <p>Creates an iframe in the current web application to login the user</p>
    <p>Attack  block the iframe  spoof an authentication dialog  steal master credentials</p>
    <p>iframe</p>
  </div>
  <div class="page">
    <p>LastPass UI Vulnerability</p>
    <p>(Demo)</p>
  </div>
  <div class="page">
    <p>authorization vulnerabilities</p>
    <p>classic web vulnerabilities</p>
    <p>user interface vulnerabilities</p>
    <p>bookmarklet vulnerabilities</p>
    <p>Mitigations</p>
  </div>
  <div class="page">
    <p>Mitigations  Bookmarklet Vulnerabilities  loads the password manager code in an iframe  postMessage with the right target</p>
    <p>Web Vulnerabilities  Content Security Policy (CSP)  CSRF prevention</p>
    <p>Authorization Vulnerabilities  a simpler sharing mode</p>
    <p>UI Vulnerabilities  manually open a new tab</p>
  </div>
  <div class="page">
    <p>Conclusions</p>
    <p>The wide spectrum of discovered vulnerabilities  logic mistakes  misunderstanding about the web security model  typical vulnerabilities like CSRF and XSS</p>
    <p>A single solution unlikely</p>
    <p>Developing password manager entails a systematic, defense-in-depth approach</p>
  </div>
</Presentation>
