<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Hulk: Eliciting Malicious Behavior in Browser Extensions</p>
    <p>Alexandros Kapravelos, Chris Grier, Neha Chachra, Christopher Kruegel, Giovanni Vigna, and Vern Paxson</p>
    <p>USENIX Security 2014</p>
  </div>
  <div class="page">
    <p>HTML + JavaScript  Modify and enhance the functionality of the</p>
    <p>browser  Have access to a privileged API</p>
    <p>Browser extensions</p>
  </div>
  <div class="page">
    <p>Adblock Plus</p>
    <p>Over 50 million users!</p>
  </div>
  <div class="page"/>
  <div class="page">
    <p>Compromising the browser</p>
    <p>Drive-by downloads  Browser extensions</p>
  </div>
  <div class="page">
    <p>Compromising the browser</p>
    <p>Extensions</p>
    <p>Malware</p>
  </div>
  <div class="page">
    <p>Goal</p>
    <p>Understand malicious behavior in browser extensions</p>
    <p>Identify automatically malicious browser extensions</p>
  </div>
  <div class="page"/>
  <div class="page">
    <p>Inject advertisements  Keylogger (only in the visited page)  Affiliate fraud  Steal credentials</p>
    <p>What can a malicious extension do?</p>
    <p>Anything malicious that you can do with JavaScript having access to the visited page, the web requests, the browsers cookies</p>
  </div>
  <div class="page">
    <p>Approach</p>
    <p>Install extension in Chrome inside a VM  Visit a few pages  Monitor what the extension is doing  Classify the extension</p>
  </div>
  <div class="page">
    <p>How to trigger malicious code?  What content should the pages contain?  Which pages should we visit?</p>
    <p>How to detect maliciousness?</p>
    <p>Challenges</p>
  </div>
  <div class="page">
    <p>Triggering malicious behavior</p>
    <p>Find the right content  HoneyPage</p>
    <p>Visit the right page  URL extraction  Event handler fuzzing</p>
  </div>
  <div class="page">
    <p>HoneyPage</p>
    <p>&lt;html&gt;</p>
    <p>&lt;/html&gt;</p>
    <p>document.getElementById(fb_newsfeed)</p>
    <p>&lt;div id=fb_newsfeed&gt;&lt;/div&gt;</p>
  </div>
  <div class="page">
    <p>Event handler fuzzing</p>
    <p>Extensions can intercept network events  Triggering the event handlers is possible!</p>
    <p>Pretend to visit Alexa top 1 million domains  Point to a HoneyPage  Takes &lt;10 sec on average</p>
  </div>
  <div class="page">
    <p>Detecting malicious behavior</p>
    <p>In JavaScript  Extension API  Interaction with visited pages</p>
    <p>In the network  In injected code</p>
  </div>
  <div class="page">
    <p>Malicious behavior heuristics</p>
    <p>Prevents extension uninstall  Steals email/password from form  Contains keylogging functionality  Manipulates security-related HTTP headers  Uninstalls extensions</p>
  </div>
  <div class="page">
    <p>Suspicious behavior heuristics</p>
    <p>Injects dynamic JavaScript  Evals with input &gt;128 chars long  Produces HTTP 4xx errors  Performs requests to non-existent domains</p>
  </div>
  <div class="page">
    <p>Results</p>
    <p>47,940 extensions from Chrome Web Store  392 extensions from Anubis</p>
    <p>Analysis result Count</p>
    <p>Benign 43,490</p>
    <p>Suspicious 4,712</p>
    <p>Malicious 130</p>
  </div>
  <div class="page">
    <p>SimilarSites Pro</p>
  </div>
  <div class="page">
    <p>*Split Screen*</p>
  </div>
  <div class="page">
    <p>Recommendations</p>
    <p>Manipulating configuration pages e.g., chrome://extensions</p>
    <p>Uninstalling extensions  Removing security-related HTTP headers  Hooking keyboard events  Local inclusion of static files instead of</p>
    <p>dynamic JavaScript inclusions</p>
  </div>
  <div class="page">
    <p>Limitations</p>
    <p>Dynamic analysis system  Targeted attacks (location, time)  Multistep queries of DOM elements in</p>
    <p>HoneyPages  Evasions against HoneyPages</p>
  </div>
  <div class="page">
    <p>Conclusion</p>
    <p>Dynamic analysis system for browser extensions</p>
    <p>Detected malicious extensions affecting millions of users</p>
    <p>Proposed changes in Chrome browser ecosystem</p>
  </div>
  <div class="page">
    <p>Thank you!</p>
    <p>@kapravel</p>
  </div>
</Presentation>
