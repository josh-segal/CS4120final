<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Bamboozling Certificate Authorities with BGP</p>
    <p>Henry Birge-Lee, Yixin Sun, Anne Edmundson, Jennifer Rexford, Prateek Mittal</p>
  </div>
  <div class="page">
    <p>Digital certificates as a root of trust</p>
    <p>Root of trust on the internet  Bootstraps trust on first time connections  The keys to all web encryption</p>
  </div>
  <div class="page">
    <p>Digital certificates as a root of trust</p>
    <p>Root of trust on the internet  Bootstraps trust on first time connections  The keys to all web encryption</p>
    <p>Border Gateway Protocol (BGP) attacks compromise this root of trust</p>
  </div>
  <div class="page">
    <p>Overview  Domain Control Validation  BGP Attacks  Quantifying Vulnerability  Countermeasures  Takeaways</p>
  </div>
  <div class="page">
    <p>Domain Control Verification</p>
    <p>Could I get a certificate for example.com?</p>
    <p>(Certificate Signing Request)Certificate Authority</p>
    <p>Server at example.com</p>
    <p>Owner of example.com</p>
  </div>
  <div class="page">
    <p>Upload &lt;content&gt; to example.com/verify.html</p>
    <p>(Domain Control Verification Challenge)</p>
    <p>Domain Control Verification</p>
    <p>Certificate Authority</p>
    <p>Server at example.com</p>
    <p>Owner of example.com</p>
  </div>
  <div class="page">
    <p>Domain Control Verification</p>
    <p>Server modifications</p>
    <p>Certificate Authority</p>
    <p>Server at example.com</p>
    <p>Owner of example.com</p>
  </div>
  <div class="page">
    <p>Domain Control Verification</p>
    <p>I did it!</p>
    <p>HTTP GET e</p>
    <p>xampl e.com</p>
    <p>/verify .html</p>
    <p>Certificate Authority</p>
    <p>Server at example.com</p>
    <p>Owner of example.com</p>
  </div>
  <div class="page">
    <p>Domain Control Verification</p>
    <p>Here is your certificateCertificate Authority</p>
    <p>Server at example.com</p>
    <p>Owner of example.com</p>
    <p>HTTP 200 O</p>
    <p>K: &lt;co ntent&gt;</p>
  </div>
  <div class="page">
    <p>Where BGP Comes In</p>
    <p>I did it!</p>
    <p>HTTP GET e</p>
    <p>xampl e.com</p>
    <p>/verify .html</p>
    <p>Certificate Authority</p>
    <p>Server at example.com</p>
    <p>Adversary posing as owner of example.com</p>
    <p>If an adversary can hijack this request with BGP, it can generate a response</p>
    <p>Adversarys serverHTTP 2</p>
    <p>t&gt;</p>
  </div>
  <div class="page">
    <p>Overview  Domain Control Validation  BGP Attacks  Quantifying Vulnerability  Countermeasures  Takeaways</p>
  </div>
  <div class="page">
    <p>AS 1</p>
    <p>AS 3 AS 4AS 2</p>
    <p>Certificate Authority</p>
    <p>Adversary</p>
    <p>AS containing example.com</p>
    <p>Original BGP route to victim</p>
  </div>
  <div class="page">
    <p>Original BGP route to victim</p>
    <p>Certificate Authority</p>
    <p>Adversary</p>
    <p>I own 2.2.2.0/23</p>
    <p>AS containing example.com</p>
    <p>AS 1</p>
    <p>AS 3 AS 4AS 2</p>
  </div>
  <div class="page">
    <p>BGP route to victim under sub-prefix attack</p>
    <p>Certificate Authority</p>
    <p>Adversary I own sub-prefix 2.2.2.0/24</p>
    <p>AS containing example.com</p>
    <p>I own 2.2.2.0/23AS 1</p>
    <p>AS 3 AS 4AS 2</p>
  </div>
  <div class="page">
    <p>BGP route to victim under sub-prefix attack</p>
    <p>Certificate Authority</p>
    <p>Adversary I own sub-prefix 2.2.2.0/24</p>
    <p>AS containing exmaple.com</p>
    <p>I own 2.2.2.0/23</p>
    <p>AS 4</p>
    <p>HTTP GET example.com/verify.html goes to adversary</p>
    <p>AS 1</p>
    <p>AS 3AS 2</p>
  </div>
  <div class="page">
    <p>BGP route to victim under sub-prefix attack</p>
    <p>Certificate Authority</p>
    <p>Adversary I own sub-prefix 2.2.2.0/24</p>
    <p>AS containing example.com</p>
    <p>I own 2.2.2.0/23</p>
    <p>Routers prefer more specific announcements</p>
    <p>Global visibility</p>
    <p>Connectivity broken</p>
    <p>Not very stealthy</p>
    <p>AS 1</p>
    <p>AS 3 AS 4AS 2</p>
  </div>
  <div class="page">
    <p>A local (equally-specific prefix) attack</p>
    <p>AS 5</p>
    <p>Certificate Authority</p>
    <p>Adversary</p>
    <p>AS containing example.com</p>
    <p>I own 2.2.2.0/23</p>
    <p>I own 2.2.2.0/23AS 1</p>
    <p>AS 3 AS 4</p>
    <p>A. Gavrichenkov. Breaking HTTPS with BGP hijacking. Black Hat USA Briefings, 2015</p>
  </div>
  <div class="page">
    <p>A local (equally-specific prefix) attack</p>
    <p>AS 5</p>
    <p>Certificate Authority</p>
    <p>Adversary</p>
    <p>AS containing example.com</p>
    <p>I own 2.2.2.0/23</p>
    <p>I own 2.2.2.0/23AS 1</p>
    <p>AS 3 AS 4</p>
    <p>A. Gavrichenkov. Breaking HTTPS with BGP hijacking. Black Hat USA Briefings, 2015</p>
    <p>Hijacked portion</p>
    <p>Unaffected portion</p>
  </div>
  <div class="page">
    <p>Certificate Authority</p>
    <p>Adversary</p>
    <p>AS 5 AS 1</p>
    <p>AS 3 AS 4</p>
    <p>AS containing example.com</p>
    <p>I own 2.2.2.0/23</p>
    <p>I own 2.2.2.0/23</p>
    <p>A local (equally-specific prefix) attack</p>
    <p>Equally specific announcements compete for traffic</p>
    <p>Announcement localized</p>
    <p>Local broken connectivity</p>
    <p>Potentially stealthy</p>
    <p>A. Gavrichenkov. Breaking HTTPS with BGP hijacking. Black Hat USA Briefings, 2015</p>
  </div>
  <div class="page">
    <p>Adversary</p>
    <p>AS 1</p>
    <p>AS 3 AS 4</p>
    <p>AS containing example.com</p>
    <p>I own 2.2.2.0/23</p>
    <p>I own 2.2.2.0/23</p>
    <p>A local (equally-specific prefix) attack</p>
    <p>Equally specific announcements compete for traffic</p>
    <p>Announcement localized</p>
    <p>Local broken connectivity</p>
    <p>Potentially stealthy</p>
    <p>Not all ASes can perform</p>
    <p>Certificate Authority</p>
    <p>AS 2</p>
    <p>A. Gavrichenkov. Breaking HTTPS with BGP hijacking. Black Hat USA Briefings, 2015</p>
  </div>
  <div class="page">
    <p>AS path poisoning</p>
    <p>Adversary</p>
    <p>I can get to 2.2.2.0/24 through AS 4</p>
    <p>Certificate Authority</p>
    <p>AS 1</p>
    <p>AS 3 AS 4AS 2</p>
    <p>I own 2.2.2.0/23</p>
    <p>AS containing example.com</p>
  </div>
  <div class="page">
    <p>AS path poisoning</p>
    <p>Everyone sees announcement but looks less suspicious</p>
    <p>Connectivity preserved</p>
    <p>Almost any AS can perform</p>
    <p>Very stealthy</p>
    <p>Perfect setup to intercept traffic with certificateAdversary</p>
    <p>I can get to 2.2.2.0/24 through AS 4</p>
    <p>Certificate Authority</p>
    <p>AS 1</p>
    <p>AS 3 AS 4AS 2</p>
    <p>I own 2.2.2.0/23</p>
    <p>AS containing example.com</p>
  </div>
  <div class="page">
    <p>Ethical framework for launching real-world attacks</p>
    <p>Hijack only our own prefixes</p>
    <p>Domains run on our own prefixes</p>
    <p>No real users attacked</p>
    <p>Approached trusted CAs for certificates</p>
  </div>
  <div class="page">
    <p>AS path poisoning attack demonstration</p>
  </div>
  <div class="page">
    <p>Results from real world attacks Lets Encrypt GoDaddy Comodo Symantec* GlobalSign</p>
    <p>Time to issue certificate</p>
    <p>Human interaction</p>
    <p>No No No No No</p>
    <p>Multiple Vantage Points</p>
    <p>Not yet No No No No</p>
    <p>Validation Method Attacked</p>
    <p>HTTP HTTP Email Email Email</p>
    <p>*At time of experiments Symantec was still a trusted CA</p>
  </div>
  <div class="page">
    <p>Results from real world attacks Lets Encrypt GoDaddy Comodo Symantec GlobalSign</p>
    <p>Time to issue certificate</p>
    <p>Human interaction</p>
    <p>No No No No No</p>
    <p>Multiple Vantage Points</p>
    <p>No No No No No</p>
    <p>Validation Method Attacked</p>
    <p>HTTP HTTP Email Email Email</p>
    <p>All studied CAs were vulnerable</p>
    <p>*At time of experiments Symantec was still a trusted CA</p>
  </div>
  <div class="page">
    <p>Additional Attacks  More targets:</p>
    <p>Authoritative DNS servers  Mail servers</p>
    <p>Certificate Authority DNS</p>
    <p>BGP Adversary</p>
    <p>BGP Adversary</p>
  </div>
  <div class="page">
    <p>Additional Attacks  More targets:</p>
    <p>Authoritative DNS servers  Mail servers</p>
    <p>Attacking CA prefixes:  Reverse (victim domain -&gt; CA) traffic also</p>
    <p>vulnerable</p>
    <p>Certificate Authority DNS</p>
    <p>Certificate Authority</p>
    <p>BGP Adversary</p>
    <p>BGP Adversary</p>
    <p>BGP Adversary</p>
  </div>
  <div class="page">
    <p>Overview  Domain Control Validation  BGP Attacks  Quantifying Vulnerability  Countermeasures  Takeaways</p>
  </div>
  <div class="page">
    <p>How many domains are vulnerable?</p>
    <p>How many adversaries can launch attacks?</p>
    <p>Quantifying Vulnerability</p>
  </div>
  <div class="page">
    <p>Quantifying Vulnerability</p>
    <p>How many domains are vulnerable?</p>
    <p>How many adversaries can launch attacks?</p>
    <p>1.8 million certificates via Certificate Transparency</p>
    <p>Common names resolved to IPs</p>
    <p>Recorded the BGP routes used for IPs at time of signing</p>
  </div>
  <div class="page">
    <p>Vulnerability of domains: sub-prefix attacks  Any AS can</p>
    <p>launch  Only prefix</p>
    <p>lengths less than /24 vulnerable</p>
  </div>
  <div class="page">
    <p>Vulnerability of domains: sub-prefix attacks  Any AS can</p>
    <p>launch  Only prefix</p>
    <p>lengths less than /24 vulnerable (filtering)</p>
  </div>
  <div class="page">
    <p>Resilience to equally-specific prefix attacks</p>
    <p>Certificate Authority Affected</p>
    <p>Adversary</p>
    <p>AS containing exmaple.com</p>
    <p>I own 2.2.2.0/23</p>
    <p>I own 2.2.2.0/23AS 1</p>
    <p>AS 3 AS 4 Hijacked portion</p>
    <p>Unaffected portion</p>
    <p>AS 5</p>
    <p>Lad et al., Understanding resiliency of Internet topology against prefix hijack attacks, IEEE DSN, 2007</p>
  </div>
  <div class="page">
    <p>Resilience to equally-specific prefix attacks</p>
    <p>Adversary</p>
    <p>AS containing exmaple.com</p>
    <p>I own 2.2.2.0/23</p>
    <p>I own 2.2.2.0/23AS 1</p>
    <p>AS 3 AS 4 Hijacked portion</p>
    <p>Unaffected portion Certificate Authority Resilient</p>
    <p>AS 2</p>
    <p>Lad et al., Understanding resiliency of Internet topology against prefix hijack attacks, IEEE DSN, 2007</p>
  </div>
  <div class="page">
    <p>Resilience to equally-specific prefix attacks</p>
    <p>Adversary</p>
    <p>AS containing exmaple.com</p>
    <p>I own 2.2.2.0/23</p>
    <p>I own 2.2.2.0/23AS 1</p>
    <p>AS 3 AS 4 Hijacked portion</p>
    <p>Unaffected portion Certificate Authority Resilient</p>
    <p>AS 2</p>
    <p>Lad et al., Understanding resiliency of Internet topology against prefix hijack attacks, IEEE DSN, 2007</p>
    <p>Probability a CA will be resilient to attacks on a domain</p>
  </div>
  <div class="page">
    <p>Resilience of domains assuming random CA</p>
  </div>
  <div class="page">
    <p>Median Median resilience is .57</p>
    <p>Resilience of domains assuming random CA</p>
  </div>
  <div class="page">
    <p>Choosing an affected CA</p>
    <p>CA 2</p>
    <p>Adversary</p>
    <p>AS containing example.com</p>
    <p>I own 2.2.2.0/23</p>
    <p>I own 2.2.2.0/23AS 1</p>
    <p>AS 3 AS 4 Hijacked portion</p>
    <p>Unaffected portion CA 1</p>
    <p>Around 100 CAs</p>
    <p>Any one can sign any for domain</p>
  </div>
  <div class="page">
    <p>Vulnerability of Domains: Equally-specific attacks</p>
  </div>
  <div class="page">
    <p>Vulnerability of Domains: Equally-specific attacks</p>
    <p>Median resilience drops from .57 to .25</p>
    <p>Median</p>
  </div>
  <div class="page">
    <p>Overview  Domain Control Validation  BGP Attacks  Quantifying Vulnerability  Countermeasures  Takeaways</p>
  </div>
  <div class="page">
    <p>Multiple Vantage Points</p>
    <p>AS 5</p>
    <p>Certificate Authority</p>
    <p>Adversary</p>
    <p>AS containing exmaple.com</p>
    <p>I own 2.2.2.0/23</p>
    <p>I own 2.2.2.0/23AS 1</p>
    <p>AS 3 AS 4 Hijacked portion</p>
    <p>Unaffected portion</p>
  </div>
  <div class="page">
    <p>Multiple Vantage Points</p>
    <p>Certificate Authority</p>
    <p>Adversary</p>
    <p>AS containing exmaple.com</p>
    <p>I own 2.2.2.0/23</p>
    <p>I own 2.2.2.0/23AS 1</p>
    <p>AS 3 AS 4 Hijacked portion</p>
    <p>Unaffected portion Remote Vantage</p>
    <p>Point</p>
  </div>
  <div class="page">
    <p>Multiple Vantage Points</p>
    <p>Certificate Authority</p>
    <p>Adversary</p>
    <p>AS containing exmaple.com</p>
    <p>I own 2.2.2.0/23</p>
    <p>I own 2.2.2.0/23AS 1</p>
    <p>AS 3 AS 4 Hijacked portion</p>
    <p>Unaffected portion Remote Vantage</p>
    <p>Point</p>
    <p>Only sign certificate if all vantage points and CA agree</p>
  </div>
  <div class="page">
    <p>Multiple Vantage Points</p>
    <p>Key factor influencing Lets Encrypts staging deployment</p>
    <p>Full deployment coming soon 3 Remote Vantage Points in AS 16509</p>
    <p>Data Center in AS 13649</p>
  </div>
  <div class="page">
    <p>Resilience Improvement of Multiple Vantage Points Resilience computed using Lets Encrypt data center and optimally located</p>
    <p>additional vantage points</p>
  </div>
  <div class="page">
    <p>Median resilience improves from .60 to .95</p>
    <p>Median</p>
    <p>Resilience Improvement of Multiple Vantage Points Resilience computed using Lets Encrypt data center and optimally located</p>
    <p>additional vantage points</p>
  </div>
  <div class="page">
    <p>Other Defenses  CAs:</p>
    <p>BGP Monitoring  CA Prefix Length  CA Resilience</p>
    <p>Domains:  CAA DNS Records  DNSSEC</p>
  </div>
  <div class="page">
    <p>Overview  Domain Control Validation  BGP Attacks  Quantifying Vulnerability  Countermeasures  Takeaways</p>
  </div>
  <div class="page">
    <p>Takeaways</p>
  </div>
  <div class="page">
    <p>Takeaways</p>
    <p>Next BGP phishing attack the malicious certificate might be trusted!</p>
  </div>
  <div class="page">
    <p>Takeaways</p>
    <p>CAs bootstrap trust on the internet through digital certificates</p>
    <p>The majority of domains and CAs are vulnerable</p>
    <p>CAs must implement countermeasures soon</p>
    <p>Secure routing (i.e., BGPsec, RPKI, SCION) is still important even with end-to-end encryption</p>
    <p>More information at https://secure-certificates.princeton.edu/</p>
    <p>Thanks to support from</p>
  </div>
  <div class="page">
    <p>Takeaways</p>
    <p>CAs bootstrap trust on the internet through digital certificates</p>
    <p>The majority of domains and CAs are vulnerable</p>
    <p>CAs must implement countermeasures soon</p>
    <p>Secure routing (i.e., BGPsec, RPKI, SCION) is still important even with end-to-end encryption</p>
    <p>More information at https://secure-certificates.princeton.edu/</p>
    <p>Thanks to support from</p>
    <p>Questions?</p>
  </div>
</Presentation>
