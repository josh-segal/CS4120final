<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>VAST A Unified Platform for Interactive Network Forensics</p>
    <p>Matthias Vallentin1,2 Vern Paxson1,2 Robin Sommer2,3</p>
    <p>March 17, 2016</p>
    <p>USENIX NSDI</p>
  </div>
  <div class="page">
    <p>Omnipresent Data Breaches</p>
  </div>
  <div class="page">
    <p>Breach Timeline</p>
    <p>Compromise Forensics</p>
    <p>Detection</p>
    <p>Time</p>
  </div>
  <div class="page">
    <p>Breach Timeline</p>
    <p>Compromise</p>
    <p>Detection</p>
    <p>Time</p>
  </div>
  <div class="page">
    <p>Breach Timeline</p>
    <p>Compromise</p>
    <p>Detection</p>
    <p>Time</p>
    <p>?</p>
  </div>
  <div class="page">
    <p>Network Forensics  Characteristics</p>
    <p>Interactive data exploration I Iterative query refinement</p>
    <p>I High-dimensional search</p>
    <p>Disparate data access I Temporal</p>
    <p>I Spatial</p>
    <p>Massive data volumes I 50100K events/sec</p>
    <p>I 10s TBs/day</p>
  </div>
  <div class="page">
    <p>Network Forensics  Characteristics</p>
    <p>Interactive data exploration I Iterative query refinement</p>
    <p>I High-dimensional search</p>
    <p>Disparate data access I Temporal</p>
    <p>I Spatial</p>
    <p>Massive data volumes I 50100K events/sec</p>
    <p>I 10s TBs/day</p>
  </div>
  <div class="page">
    <p>Network Forensics  Characteristics</p>
    <p>Interactive data exploration I Iterative query refinement</p>
    <p>I High-dimensional search</p>
    <p>Disparate data access I Temporal</p>
    <p>I Spatial</p>
    <p>Massive data volumes I 50100K events/sec</p>
    <p>I 10s TBs/day</p>
    <p>Organization</p>
  </div>
  <div class="page">
    <p>Network Forensics  Characteristics</p>
    <p>Interactive data exploration I Iterative query refinement</p>
    <p>I High-dimensional search</p>
    <p>Disparate data access I Temporal</p>
    <p>I Spatial</p>
    <p>Massive data volumes I 50100K events/sec</p>
    <p>I 10s TBs/day</p>
  </div>
  <div class="page">
    <p>Network Forensics  Characteristics</p>
    <p>Interactive data exploration I Iterative query refinement</p>
    <p>I High-dimensional search</p>
    <p>Disparate data access I Temporal</p>
    <p>I Spatial</p>
    <p>Massive data volumes I 50100K events/sec</p>
    <p>I 10s TBs/day</p>
  </div>
  <div class="page">
    <p>Network Forensics  Characteristics</p>
    <p>Interactive data exploration I Iterative query refinement</p>
    <p>I High-dimensional search</p>
    <p>Disparate data access I Temporal</p>
    <p>I Spatial</p>
    <p>Massive data volumes I 50100K events/sec</p>
    <p>I 10s TBs/day</p>
  </div>
  <div class="page">
    <p>Network Forensics  Characteristics</p>
    <p>Interactive data exploration I Iterative query refinement</p>
    <p>I High-dimensional search</p>
    <p>Disparate data access I Temporal</p>
    <p>I Spatial</p>
    <p>Massive data volumes I 50100K events/sec</p>
    <p>I 10s TBs/day</p>
    <p>?</p>
  </div>
  <div class="page">
    <p>Network Forensics  Characteristics</p>
    <p>Interactive data exploration I Iterative query refinement</p>
    <p>I High-dimensional search</p>
    <p>Disparate data access I Temporal</p>
    <p>I Spatial</p>
    <p>Massive data volumes I 50100K events/sec</p>
    <p>I 10s TBs/day</p>
    <p>?</p>
  </div>
  <div class="page">
    <p>Network Forensics  Characteristics</p>
    <p>Interactive data exploration I Iterative query refinement</p>
    <p>I High-dimensional search</p>
    <p>Disparate data access I Temporal</p>
    <p>I Spatial</p>
    <p>Massive data volumes I 50100K events/sec</p>
    <p>I 10s TBs/day</p>
    <p>?</p>
  </div>
  <div class="page">
    <p>Network Forensics  Characteristics</p>
    <p>Interactive data exploration I Iterative query refinement</p>
    <p>I High-dimensional search</p>
    <p>Disparate data access I Temporal</p>
    <p>I Spatial</p>
    <p>Massive data volumes I 50100K events/sec</p>
    <p>I 10s TBs/day</p>
    <p>?</p>
  </div>
  <div class="page">
    <p>Log Example  Bro Connection Log</p>
    <p>#separator \x09 #set_separator , #empty_field (empty) #unset_field #path conn #open 2016-01-06-15-28-58 #fields ts uid id.orig_h id.orig_p id.resp_h id.resp_p proto service duration orig_bytes resp_bytes conn_.. #types time string addr port addr port enum string interval count count string bool bool count string 1258531.. Cz7SRx3.. 192.168.1.102 68 192.168.1.1 67 udp dhcp 0.163820 301 300 SF - - 0 Dd 1 329 1 328 (empty) 1258531.. CTeURV1.. 192.168.1.103 137 192.168.1.255 137 udp dns 3.780125 350 0 S0 - - 0 D 7 546 0 0 (empty) 1258531.. CUAVTq1.. 192.168.1.102 137 192.168.1.255 137 udp dns 3.748647 350 0 S0 - - 0 D 7 546 0 0 (empty) 1258531.. CYoxAZ2.. 192.168.1.103 138 192.168.1.255 138 udp - 46.725380 560 0 S0 - - 0 D 3 644 0 0 (empty) 1258531.. CvabDq2.. 192.168.1.102 138 192.168.1.255 138 udp - 2.248589 348 0 S0 - - 0 D 2 404 0 0 (empty) 1258531.. CViJEOm.. 192.168.1.104 137 192.168.1.255 137 udp dns 3.748893 350 0 S0 - - 0 D 7 546 0 0 (empty) 1258531.. CSC2Hd4.. 192.168.1.104 138 192.168.1.255 138 udp - 59.052898 549 0 S0 - - 0 D 3 633 0 0 (empty) 1258531.. Cd3RNm1.. 192.168.1.103 68 192.168.1.1 67 udp dhcp 0.044779 303 300 SF - - 0 Dd 1 331 1 328 (empty) 1258531.. CEwuIl2.. 192.168.1.102 138 192.168.1.255 138 udp - - - - S0 - - 0 D 1 229 0 0 (empty) 1258532.. CXxLc94.. 192.168.1.104 68 192.168.1.1 67 udp dhcp 0.002103 311 300 SF - - 0 Dd 1 339 1 328 (empty) 1258532.. CIFDQJV.. 192.168.1.102 1170 192.168.1.1 53 udp dns 0.068511 36 215 SF - - 0 Dd 1 64 1 243 (empty) 1258532.. CXFISh5.. 192.168.1.104 1174 192.168.1.1 53 udp dns 0.170962 36 215 SF - - 0 Dd 1 64 1 243 (empty) 1258532.. CQJw4C3.. 192.168.1.1 5353 224.0.0.251 5353 udp dns 0.100381 273 0 S0 - - 0 D 2 329 0 0 (empty) 1258532.. ClfEd43.. fe80::219:e3ff:fee7:5d23 5353 ff02::fb 5353 udp dns 0.100371 273 0 S0 - - 0 D 2 369 0 0 1258532.. C67zf02.. 192.168.1.103 137 192.168.1.255 137 udp dns 3.873818 350 0 S0 - - 0 D 7 546 0 0 (empty) 1258532.. CG1FKF1.. 192.168.1.102 137 192.168.1.255 137 udp dns 3.748891 350 0 S0 - - 0 D 7 546 0 0 (empty) 1258532.. CNFkeF2.. 192.168.1.103 138 192.168.1.255 138 udp - 2.257840 348 0 S0 - - 0 D 2 404 0 0 (empty) 1258532.. Cq4eis4.. 192.168.1.102 1173 192.168.1.1 53 udp dns 0.000267 33 497 SF - - 0 Dd 1 61 1 525 (empty) 1258532.. CHpqv31.. 192.168.1.102 138 192.168.1.255 138 udp - 2.248843 348 0 S0 - - 0 D 2 404 0 0 (empty) 1258532.. CFoJjT3.. 192.168.1.1 5353 224.0.0.251 5353 udp dns 0.099824 273 0 S0 - - 0 D 2 329 0 0 (empty) 1258532.. Cc3Ayyz.. fe80::219:e3ff:fee7:5d23 5353 ff02::fb 5353 udp dns 0.099813 273 0 S0 - - 0 D 2 369 0 0</p>
  </div>
  <div class="page">
    <p>Existing Solutions</p>
    <p>MapReduce (Hadoop)</p>
    <p>In-Memory Cluster Computing (Spark)</p>
  </div>
  <div class="page">
    <p>Existing Solutions</p>
    <p>MapReduce (Hadoop)</p>
    <p>In-Memory Cluster Computing (Spark)</p>
  </div>
  <div class="page">
    <p>Contribution</p>
    <p>VAST Visibility Across Space and Time</p>
    <p>Architecture I</p>
    <p>Performance: concurrent &amp; modular design</p>
    <p>I Scaling: intra-machine &amp; inter-machine</p>
    <p>I Typing: strong &amp; rich</p>
    <p>Implementation I</p>
    <p>Composition: high-level bitmap indexing framework</p>
    <p>I Adaptation: fine-grained component flow-control</p>
    <p>I Asynchrony: finite state machines for query execution</p>
  </div>
  <div class="page">
    <p>Contribution</p>
    <p>VAST Visibility Across Space and Time</p>
    <p>Architecture I</p>
    <p>Performance: concurrent &amp; modular design</p>
    <p>I Scaling: intra-machine &amp; inter-machine</p>
    <p>I Typing: strong &amp; rich</p>
    <p>Implementation I</p>
    <p>Composition: high-level bitmap indexing framework</p>
    <p>I Adaptation: fine-grained component flow-control</p>
    <p>I Asynchrony: finite state machines for query execution</p>
  </div>
  <div class="page">
    <p>Contribution</p>
    <p>VAST Visibility Across Space and Time</p>
    <p>Architecture I</p>
    <p>Performance: concurrent &amp; modular design</p>
    <p>I Scaling: intra-machine &amp; inter-machine</p>
    <p>I Typing: strong &amp; rich</p>
    <p>Implementation I</p>
    <p>Composition: high-level bitmap indexing framework</p>
    <p>I Adaptation: fine-grained component flow-control</p>
    <p>I Asynchrony: finite state machines for query execution</p>
  </div>
  <div class="page">
    <p>Outline</p>
  </div>
  <div class="page">
    <p>VAST Architecture  Single Machine</p>
  </div>
  <div class="page">
    <p>VAST Architecture  Single Machine</p>
    <p>importer</p>
    <p>archive</p>
    <p>index</p>
    <p>exporter</p>
    <p>node</p>
    <p>source sink</p>
  </div>
  <div class="page">
    <p>VAST Architecture  Ingestion</p>
    <p>source</p>
    <p>type 10.0.0.1 53/udpmeta type 10.0.0.2 80/tcpmeta</p>
    <p>generate event batch</p>
  </div>
  <div class="page">
    <p>VAST Architecture  Ingestion</p>
    <p>source</p>
    <p>type 10.0.0.1 53/udpmeta type 10.0.0.2 80/tcpmeta</p>
    <p>generate event batch</p>
    <p>importer</p>
    <p>assign IDs</p>
  </div>
  <div class="page">
    <p>VAST Architecture  Ingestion</p>
    <p>source</p>
    <p>type 10.0.0.1 53/udpmeta type 10.0.0.2 80/tcpmeta</p>
    <p>generate event batch</p>
    <p>importer</p>
    <p>assign IDs</p>
    <p>archive</p>
    <p>compress batch</p>
  </div>
  <div class="page">
    <p>VAST Architecture  Ingestion</p>
    <p>source</p>
    <p>type 10.0.0.1 53/udpmeta type 10.0.0.2 80/tcpmeta</p>
    <p>generate event batch</p>
    <p>importer</p>
    <p>assign IDs</p>
    <p>archive</p>
    <p>compress batch</p>
    <p>index</p>
  </div>
  <div class="page">
    <p>VAST Architecture  Ingestion</p>
    <p>source</p>
    <p>type 10.0.0.1 53/udpmeta type 10.0.0.2 80/tcpmeta</p>
    <p>generate event batch</p>
    <p>importer</p>
    <p>assign IDs</p>
    <p>archive</p>
    <p>compress batch</p>
    <p>index</p>
    <p>append data to bitmap index</p>
    <p>type</p>
  </div>
  <div class="page">
    <p>VAST Architecture  Index</p>
    <p>partition</p>
    <p>index</p>
    <p>partition partition</p>
    <p>meta index</p>
  </div>
  <div class="page">
    <p>VAST Architecture  Index</p>
    <p>partition</p>
    <p>index</p>
    <p>partition partition</p>
    <p>meta index</p>
    <p>conn</p>
    <p>indexer</p>
  </div>
  <div class="page">
    <p>VAST Architecture  Querying</p>
    <p>exporter</p>
    <p>X in 10.0.0.0/8 ||</p>
    <p>X == 80/tcp</p>
  </div>
  <div class="page">
    <p>VAST Architecture  Querying</p>
    <p>exporter</p>
    <p>X in 10.0.0.0/8 ||</p>
    <p>X == 80/tcp</p>
    <p>index</p>
  </div>
  <div class="page">
    <p>VAST Architecture  Querying</p>
    <p>exporter</p>
    <p>X in 10.0.0.0/8 ||</p>
    <p>X == 80/tcp</p>
    <p>index</p>
    <p>lookup bit vectors from partitions</p>
  </div>
  <div class="page">
    <p>VAST Architecture  Querying</p>
    <p>exporter</p>
    <p>X in 10.0.0.0/8 ||</p>
    <p>X == 80/tcp</p>
    <p>index</p>
    <p>lookup bit vectors from partitions</p>
  </div>
  <div class="page">
    <p>VAST Architecture  Querying</p>
    <p>exporter</p>
    <p>X in 10.0.0.0/8 ||</p>
    <p>X == 80/tcp</p>
    <p>index</p>
    <p>lookup bit vectors from partitions</p>
    <p>archive</p>
    <p>locate &amp; ship event batch for ID</p>
  </div>
  <div class="page">
    <p>VAST Architecture  Querying</p>
    <p>exporter</p>
    <p>X in 10.0.0.0/8 ||</p>
    <p>X == 80/tcp</p>
    <p>index</p>
    <p>lookup bit vectors from partitions</p>
    <p>archive</p>
    <p>locate &amp; ship event batch for ID</p>
    <p>candidate check</p>
    <p>decompress batch</p>
  </div>
  <div class="page">
    <p>VAST Architecture  Querying</p>
    <p>exporter</p>
    <p>X in 10.0.0.0/8 ||</p>
    <p>X == 80/tcp</p>
    <p>index</p>
    <p>lookup bit vectors from partitions</p>
    <p>archive</p>
    <p>locate &amp; ship event batch for ID</p>
    <p>candidate check</p>
    <p>decompress batch</p>
    <p>sink</p>
  </div>
  <div class="page">
    <p>VAST Architecture  Querying</p>
    <p>exporter</p>
    <p>X in 10.0.0.0/8 ||</p>
    <p>X == 80/tcp</p>
    <p>index</p>
    <p>lookup bit vectors from partitions</p>
    <p>archive</p>
    <p>locate &amp; ship event batch for ID</p>
    <p>candidate check</p>
    <p>decompress batch</p>
    <p>sink</p>
    <p>type 10.0.0.1 53/udpmeta type 10.0.0.2 80/tcpmeta</p>
    <p>render results</p>
  </div>
  <div class="page">
    <p>VAST Architecture  Distributed</p>
  </div>
  <div class="page">
    <p>VAST Architecture  Distributed</p>
  </div>
  <div class="page">
    <p>VAST Architecture  Distributed</p>
  </div>
  <div class="page">
    <p>VAST Architecture  Distributed</p>
  </div>
  <div class="page">
    <p>VAST Architecture  Distributed</p>
  </div>
  <div class="page">
    <p>VAST Architecture  Distributed</p>
  </div>
  <div class="page">
    <p>VAST Architecture  Distributed</p>
  </div>
  <div class="page">
    <p>VAST Architecture  Distributed</p>
  </div>
  <div class="page">
    <p>Outline</p>
  </div>
  <div class="page">
    <p>Indexing Basics  Tree Indexes</p>
  </div>
  <div class="page">
    <p>Indexing Basics  Composition</p>
    <p>( )</p>
  </div>
  <div class="page">
    <p>Indexing Basics  Composition</p>
    <p>( )</p>
  </div>
  <div class="page">
    <p>Indexing Basics  Inverted Index</p>
    <p>A B C D</p>
  </div>
  <div class="page">
    <p>Indexing Basics  Bitmap Index</p>
    <p>A B C D</p>
  </div>
  <div class="page">
    <p>Indexing Basics  Bitmap Index</p>
    <p>A B C D</p>
  </div>
  <div class="page">
    <p>Indexing Basics  Bitmap Composition</p>
  </div>
  <div class="page">
    <p>Indexing Basics  Bitmap Composition</p>
    <p>X 2 192.168.0.0/24 Y  60s</p>
  </div>
  <div class="page">
    <p>Indexing Basics  Bitmap Composition</p>
    <p>X 2 192.168.0.0/24 Y  60s</p>
  </div>
  <div class="page">
    <p>Indexing Challenges</p>
    <p>High-cardinality values I Represent millions of distinct values compactly</p>
    <p>I Provide low-latency lookups</p>
    <p>High-level operations I Support type-specific operations</p>
    <p>I Relational operators: {&lt;, , =, 6=, , &gt;, 2, /2}</p>
  </div>
  <div class="page">
    <p>Query Language</p>
    <p>Boolean Expressions I Conjunctions &amp;&amp;</p>
    <p>I Disjunctions ||</p>
    <p>I Negations ! I Predicates</p>
    <p>I LHS op RHS I (expr)</p>
    <p>Examples I A &amp;&amp; B || !(C &amp;&amp; D) I orig h in 10.0.0.1 &amp;&amp; &amp;time &lt; now - 2h I &amp;type == &quot;conn&quot; || &quot;foo&quot; in :string I duration &gt; 60s &amp;&amp; service == &quot;tcp&quot;</p>
    <p>Extractors I &amp;tag</p>
    <p>I x.y.z</p>
    <p>I :type</p>
    <p>Relational Operators I &lt;, &lt;=, ==, &gt;=, &gt;</p>
    <p>I in, ni, [+, +]</p>
    <p>I !in, !ni, [-, -]</p>
    <p>I , !</p>
    <p>Values I T, F</p>
    <p>I +42, 1337, 3.14</p>
    <p>I &quot;foo&quot;</p>
    <p>I 10.0.0.0/8</p>
    <p>I 80/tcp, 53/?</p>
    <p>I {1, 2, 3} 19 / 28</p>
  </div>
  <div class="page">
    <p>Data Model</p>
    <p>TYPE</p>
    <p>record</p>
    <p>vector set</p>
    <p>table</p>
    <p>KEY VALUE</p>
    <p>TYPETYPE</p>
    <p>field 1</p>
    <p>TYPE</p>
    <p>field n</p>
    <p>TYPE</p>
    <p>container types</p>
    <p>basic types</p>
    <p>compound types</p>
    <p>recursive types</p>
    <p>bool</p>
    <p>int</p>
    <p>count</p>
    <p>real</p>
    <p>duration</p>
    <p>time</p>
    <p>string</p>
    <p>pattern</p>
    <p>address</p>
    <p>subnet</p>
    <p>port</p>
    <p>none</p>
  </div>
  <div class="page">
    <p>Data Model</p>
    <p>TYPE</p>
    <p>record</p>
    <p>vector set</p>
    <p>table</p>
    <p>KEY VALUE</p>
    <p>TYPETYPE</p>
    <p>field 1</p>
    <p>TYPE</p>
    <p>field n</p>
    <p>TYPE</p>
    <p>container types</p>
    <p>basic types</p>
    <p>compound types</p>
    <p>recursive types</p>
    <p>bool</p>
    <p>int</p>
    <p>count</p>
    <p>real</p>
    <p>duration</p>
    <p>time</p>
    <p>string</p>
    <p>pattern</p>
    <p>address</p>
    <p>subnet</p>
    <p>port</p>
    <p>none</p>
  </div>
  <div class="page">
    <p>Bitmap Index for IP Addresses</p>
  </div>
  <div class="page">
    <p>Bitmap Index for IP Addresses</p>
  </div>
  <div class="page">
    <p>Bitmap Index for IP Addresses</p>
  </div>
  <div class="page">
    <p>Bitmap Index for IP Addresses</p>
  </div>
  <div class="page">
    <p>Bitmap Index for IP Addresses</p>
    <p>X 2 192.168.0.0/27</p>
  </div>
  <div class="page">
    <p>Bitmap Index for IP Addresses</p>
    <p>X 2 192.168.0.0/27</p>
  </div>
  <div class="page">
    <p>Outline</p>
  </div>
  <div class="page">
    <p>Data Set</p>
    <p>Single-Machine</p>
    <p>Data:</p>
    <p>I 10 M packets from a 24-hour trace (5 fields/event)</p>
    <p>I 3.4 M derived Bro connection logs (20 fields/event)</p>
    <p>Machine:</p>
    <p>I 2  8-core Intel Xeon CPUs I 128 GB RAM</p>
    <p>I 4  3 TB SAS 7.2 K disks I 64-bit FreeBSD</p>
    <p>Cluster Data:</p>
    <p>I 1.24 B Bro connection logs (152 GB)</p>
    <p>I Split into N slices for N nodes</p>
    <p>I N 2 [1, 24] Nodes:</p>
    <p>I 2  8-core Intel Xeon CPUs I 12 GB of RAM</p>
    <p>I 2  500 MB SATA disks I 64-bit FreeBSD</p>
  </div>
  <div class="page">
    <p>Data Set</p>
    <p>Single-Machine</p>
    <p>Data:</p>
    <p>I 10 M packets from a 24-hour trace (5 fields/event)</p>
    <p>I 3.4 M derived Bro connection logs (20 fields/event)</p>
    <p>Machine:</p>
    <p>I 2  8-core Intel Xeon CPUs I 128 GB RAM</p>
    <p>I 4  3 TB SAS 7.2 K disks I 64-bit FreeBSD</p>
    <p>Cluster Data:</p>
    <p>I 1.24 B Bro connection logs (152 GB)</p>
    <p>I Split into N slices for N nodes</p>
    <p>I N 2 [1, 24] Nodes:</p>
    <p>I 2  8-core Intel Xeon CPUs I 12 GB of RAM</p>
    <p>I 2  500 MB SATA disks I 64-bit FreeBSD</p>
  </div>
  <div class="page">
    <p>Queries</p>
  </div>
  <div class="page">
    <p>Performance  Index Latency</p>
    <p>La te</p>
    <p>nc y</p>
    <p>(s ec</p>
    <p>on ds</p>
    <p>) Query  A</p>
    <p>B C D E F G H I</p>
  </div>
  <div class="page">
    <p>Performance  Scaling</p>
    <p>Import</p>
    <p>til iz</p>
    <p>at io</p>
    <p>n</p>
    <p>Export</p>
    <p>La te</p>
    <p>nc y</p>
    <p>(s ec</p>
    <p>on ds</p>
    <p>)</p>
  </div>
  <div class="page">
    <p>Details in the paper</p>
  </div>
  <div class="page">
    <p>Conclusion</p>
    <p>Network Forensics Challenges I Explorative high-dimensional search</p>
    <p>I Disparate data access</p>
    <p>I Massive data volumes</p>
    <p>VAST: Visibility Across Space and Time I Platform for network forensics</p>
    <p>I Interactive &amp; iterative search</p>
    <p>I Inter-machine and intra-machine scaling</p>
    <p>I Open-source, permissive license (BSD)</p>
  </div>
  <div class="page">
    <p>Questions?</p>
    <p>http://vast.io</p>
  </div>
</Presentation>
