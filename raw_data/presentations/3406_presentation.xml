<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Beauty and the Burst Remote Identification of Encrypted</p>
    <p>Video Streams</p>
    <p>Roei Schuster</p>
    <p>Cornell Tech, Tel Aviv University</p>
    <p>Vitaly Shmatikov</p>
    <p>Cornell Tech</p>
    <p>Eran Tromer</p>
    <p>Columbia University, Tel Aviv University</p>
  </div>
  <div class="page">
    <p>Video traffic is interesting</p>
  </div>
  <div class="page">
    <p>Video traffic is encrypted</p>
  </div>
  <div class="page">
    <p>What can still be learned?</p>
    <p>Video traffic is encrypted</p>
  </div>
  <div class="page">
    <p>victim</p>
    <p>streaming service</p>
    <p>Traffic analysis for video identification</p>
  </div>
  <div class="page">
    <p>victim</p>
    <p>streaming service</p>
    <p>Traffic analysis for video identification</p>
  </div>
  <div class="page">
    <p>victim</p>
    <p>Metadata! packet times, sizes,</p>
    <p>streaming service</p>
    <p>Traffic analysis for video identification</p>
  </div>
  <div class="page">
    <p>Victim is watching</p>
    <p>Beauty and the Beast!</p>
    <p>victim</p>
    <p>Metadata! packet times, sizes,</p>
    <p>streaming service</p>
    <p>Traffic analysis for video identification</p>
  </div>
  <div class="page">
    <p>Initial buffering, then on/off bursts p a</p>
    <p>c k e</p>
    <p>t s iz</p>
    <p>e (</p>
    <p>b y te</p>
    <p>s )</p>
    <p>time (seconds)</p>
  </div>
  <div class="page">
    <p>Initial buffering, then on/off bursts p a</p>
    <p>c k e</p>
    <p>t s iz</p>
    <p>e (</p>
    <p>b y te</p>
    <p>s )</p>
    <p>time (seconds)</p>
  </div>
  <div class="page">
    <p>[RLLTBD 11], [ARNL 12], [MFWS 13],</p>
    <p>Initial buffering, then on/off bursts p a</p>
    <p>c k e</p>
    <p>t s iz</p>
    <p>e (</p>
    <p>b y te</p>
    <p>s )</p>
    <p>time (seconds)</p>
  </div>
  <div class="page">
    <p>[RLLTBD 11], [ARNL 12], [MFWS 13],</p>
    <p>Where do bursts come from?</p>
    <p>Initial buffering, then on/off bursts p a</p>
    <p>c k e</p>
    <p>t s iz</p>
    <p>e (</p>
    <p>b y te</p>
    <p>s )</p>
    <p>time (seconds)</p>
  </div>
  <div class="page">
    <p>streaming service</p>
    <p>Video representation on server</p>
  </div>
  <div class="page">
    <p>streaming service</p>
    <p>Video representation on server</p>
  </div>
  <div class="page">
    <p>streaming service</p>
    <p>Pulp Fiction</p>
    <p>Die Hard</p>
    <p>The Fifth Element</p>
    <p>Die Hard II</p>
    <p>Armageddon</p>
    <p>Video representation on server</p>
  </div>
  <div class="page">
    <p>Pulp Fiction</p>
    <p>Die Hard</p>
    <p>The Fifth Element</p>
    <p>Die Hard II</p>
    <p>Armageddon</p>
    <p>MPEG-DASH standard:</p>
    <p>widely adopted by Netflix, YouTube, others</p>
    <p>Video representation on server</p>
  </div>
  <div class="page">
    <p>Pulp Fiction</p>
    <p>Die Hard</p>
    <p>The Fifth Element</p>
    <p>Die Hard II</p>
    <p>Armageddon</p>
    <p>segment2.m4s</p>
    <p>segment3.m4s</p>
    <p>segment4.m4s</p>
    <p>segment1.m4s</p>
    <p>video stored in segment-files</p>
    <p>MPEG-DASH standard:</p>
    <p>widely adopted by Netflix, YouTube, others</p>
    <p>Video representation on server</p>
  </div>
  <div class="page">
    <p>Pulp Fiction</p>
    <p>Die Hard</p>
    <p>The Fifth Element</p>
    <p>Die Hard II</p>
    <p>Armageddon</p>
    <p>segment2.m4s</p>
    <p>segment3.m4s</p>
    <p>segment4.m4s</p>
    <p>segment1.m4s</p>
    <p>video stored in segment-files</p>
    <p>segment = a few seconds</p>
    <p>of playback</p>
    <p>MPEG-DASH standard:</p>
    <p>widely adopted by Netflix, YouTube, others</p>
    <p>Video representation on server</p>
  </div>
  <div class="page">
    <p>server client</p>
    <p>buffer below threshold?</p>
    <p>yes</p>
    <p>request next</p>
    <p>segment</p>
    <p>no</p>
    <p>segment2.m4s</p>
    <p>segment3.m4s</p>
    <p>segment4.m4s</p>
    <p>segment1.m4s</p>
    <p>server</p>
    <p>segment5.m4s</p>
    <p>segment6.m4s</p>
    <p>DASH client-server interaction (simplified)</p>
  </div>
  <div class="page">
    <p>server client</p>
    <p>buffer below threshold?</p>
    <p>yes</p>
    <p>request next</p>
    <p>segment</p>
    <p>no</p>
    <p>segment2.m4s</p>
    <p>segment3.m4s</p>
    <p>segment4.m4s</p>
    <p>segment1.m4s</p>
    <p>server</p>
    <p>segment5.m4s</p>
    <p>segment6.m4s</p>
    <p>segment fetched every few seconds</p>
    <p>DASH client-server interaction (simplified)</p>
  </div>
  <div class="page">
    <p>server client</p>
    <p>buffer below threshold?</p>
    <p>yes</p>
    <p>request next</p>
    <p>segment</p>
    <p>no</p>
    <p>segment2.m4s</p>
    <p>segment3.m4s</p>
    <p>segment4.m4s</p>
    <p>segment1.m4s</p>
    <p>server</p>
    <p>segment5.m4s</p>
    <p>segment6.m4s</p>
    <p>fetching causes a traffic burst</p>
    <p>segment fetched every few seconds</p>
    <p>DASH client-server interaction (simplified)</p>
  </div>
  <div class="page">
    <p>Different video seconds require different amount of bytes to encode</p>
    <p>B it ra</p>
    <p>te (</p>
    <p>b y te</p>
    <p>s )</p>
    <p>Time (seconds)</p>
    <p>Iguana vs. Snakes VBR</p>
    <p>Variable bit rate encoding</p>
  </div>
  <div class="page">
    <p>Phases of Iguana vs Snakes in Bitrate</p>
    <p>scenery, movement,</p>
    <p>tension rising</p>
    <p>B it ra</p>
    <p>te (</p>
    <p>b it s p</p>
    <p>e r</p>
    <p>s e</p>
    <p>c o</p>
    <p>n d</p>
    <p>)</p>
    <p>Time (seconds)</p>
  </div>
  <div class="page">
    <p>Phases of Iguana vs Snakes in Bitrate</p>
    <p>tension peaking, iguana is still</p>
    <p>B it ra</p>
    <p>te (</p>
    <p>b it s p</p>
    <p>e r</p>
    <p>s e</p>
    <p>c o</p>
    <p>n d</p>
    <p>)</p>
    <p>Time (seconds)</p>
  </div>
  <div class="page">
    <p>Phases of Iguana vs Snakes in Bitrate</p>
    <p>chase</p>
    <p>B it ra</p>
    <p>te (</p>
    <p>b it s p</p>
    <p>e r</p>
    <p>s e</p>
    <p>c o</p>
    <p>n d</p>
    <p>)</p>
    <p>Time (seconds)</p>
  </div>
  <div class="page">
    <p>Phases of Iguana vs Snakes in Bitrate</p>
    <p>chase</p>
    <p>iguana almost captured</p>
    <p>B it ra</p>
    <p>te (</p>
    <p>b it s p</p>
    <p>e r</p>
    <p>s e</p>
    <p>c o</p>
    <p>n d</p>
    <p>)</p>
    <p>Time (seconds)</p>
  </div>
  <div class="page">
    <p>Phases of Iguana vs Snakes in Bitrate</p>
    <p>iguana safe, resting</p>
    <p>B it ra</p>
    <p>te (</p>
    <p>b it s p</p>
    <p>e r</p>
    <p>s e</p>
    <p>c o</p>
    <p>n d</p>
    <p>)</p>
    <p>Time (seconds)</p>
  </div>
  <div class="page">
    <p>Different video seconds require different amount of bytes to encode</p>
    <p>B it ra</p>
    <p>te (</p>
    <p>b y te</p>
    <p>s )</p>
    <p>Time (seconds)</p>
    <p>Iguana vs. Snakes VBR</p>
    <p>Variable bit rate encoding</p>
  </div>
  <div class="page">
    <p>Pulp Fiction</p>
    <p>Die Hard</p>
    <p>The Fifth Element</p>
    <p>Die Hard II</p>
    <p>Armageddon Segment2.m4s</p>
    <p>Segment3.m4s</p>
    <p>Segment4.m4s</p>
    <p>Segment1.m4s</p>
    <p>Segment5.m4s</p>
    <p>Variable bit rate  variable segment size</p>
  </div>
  <div class="page">
    <p>Variable segment size  variable burst size</p>
    <p>buffering On/off bursts</p>
    <p>b u</p>
    <p>rs t s iz</p>
    <p>e (</p>
    <p>b y te</p>
    <p>s )</p>
    <p>Time (seconds)</p>
  </div>
  <div class="page">
    <p>Variable segment size  variable burst size</p>
    <p>buffering On/off bursts</p>
    <p>b u</p>
    <p>rs t s iz</p>
    <p>e (</p>
    <p>b y te</p>
    <p>s )</p>
    <p>Time (seconds)</p>
  </div>
  <div class="page">
    <p>segments</p>
    <p>VBR pattern</p>
    <p>stream time</p>
    <p>burst sizes</p>
    <p>content</p>
    <p>MPEG-DASH leak</p>
  </div>
  <div class="page">
    <p>burst sizes</p>
    <p>stream time</p>
    <p>Does the pattern of burst (segment) sizes uniquely</p>
    <p>characterize a title?</p>
    <p>Can we learn a titles identifying</p>
    <p>pattern?</p>
    <p>From a leak to a fingerprint</p>
  </div>
  <div class="page">
    <p>burst sizes</p>
    <p>stream time</p>
    <p>Does the pattern of burst (segment) sizes uniquely</p>
    <p>characterize a title?</p>
    <p>Can we learn a titles identifying</p>
    <p>pattern?</p>
    <p>Diversity: empirically measure pairwise distances for 3500 downloaded and segmented YouTube titles</p>
    <p>From a leak to a fingerprint</p>
  </div>
  <div class="page">
    <p>burst sizes</p>
    <p>stream time</p>
    <p>Does the pattern of burst (segment) sizes uniquely</p>
    <p>characterize a title?</p>
    <p>Consistency: empirically evaluate attackers measurement error bound</p>
    <p>Can we learn a titles identifying</p>
    <p>pattern?</p>
    <p>Diversity: empirically measure pairwise distances for 3500 downloaded and segmented YouTube titles</p>
    <p>From a leak to a fingerprint</p>
  </div>
  <div class="page">
    <p>burst sizes</p>
    <p>stream time</p>
    <p>Does the pattern of burst (segment) sizes uniquely</p>
    <p>characterize a title?</p>
    <p>Consistency: empirically evaluate attackers measurement error bound</p>
    <p>Can we learn a titles identifying</p>
    <p>pattern?</p>
    <p>~20% of YouTube titles have fingerprints</p>
    <p>Diversity: empirically measure pairwise distances for 3500 downloaded and segmented YouTube titles</p>
    <p>From a leak to a fingerprint</p>
  </div>
  <div class="page">
    <p>victim network</p>
    <p>Pulp Fiction</p>
    <p>Die Hard</p>
    <p>Armageddon attacker network</p>
    <p>Attack overview</p>
  </div>
  <div class="page">
    <p>victim network</p>
    <p>Pulp Fiction</p>
    <p>Die Hard</p>
    <p>Armageddon attacker network</p>
    <p>Attack overview</p>
  </div>
  <div class="page">
    <p>metadata</p>
    <p>victim network</p>
    <p>Pulp Fiction</p>
    <p>Die Hard</p>
    <p>Armageddon attacker network</p>
    <p>Attack overview</p>
  </div>
  <div class="page">
    <p>detectors</p>
    <p>metadata</p>
    <p>tra in</p>
    <p>in g</p>
    <p>victim network</p>
    <p>Pulp Fiction</p>
    <p>Die Hard</p>
    <p>Armageddon attacker network</p>
    <p>Attack overview</p>
  </div>
  <div class="page">
    <p>detectors</p>
    <p>metadata</p>
    <p>tra in</p>
    <p>in g</p>
    <p>victim network</p>
    <p>Pulp Fiction</p>
    <p>Die Hard</p>
    <p>Armageddon Armageddon attacker network</p>
    <p>Attack overview</p>
  </div>
  <div class="page">
    <p>detectors</p>
    <p>metadata</p>
    <p>tra in</p>
    <p>in g</p>
    <p>victim network</p>
    <p>Pulp Fiction</p>
    <p>Die Hard</p>
    <p>Armageddon Armageddon attacker network</p>
    <p>Attack overview</p>
  </div>
  <div class="page">
    <p>detectors</p>
    <p>metadata</p>
    <p>tra in</p>
    <p>in g</p>
    <p>victim network</p>
    <p>Pulp Fiction</p>
    <p>Die Hard</p>
    <p>Armageddon Armageddon attacker network</p>
    <p>Victim is watching</p>
    <p>Armageddon!</p>
    <p>Attack overview</p>
  </div>
  <div class="page">
    <p>detectors</p>
    <p>tra in</p>
    <p>in g</p>
    <p>victim network</p>
    <p>Pulp Fiction</p>
    <p>Die Hard</p>
    <p>Armageddon Armageddon attacker network</p>
    <p>vantage point?</p>
    <p>Attack details</p>
    <p>metadata</p>
  </div>
  <div class="page">
    <p>bursts</p>
    <p>Wi-Fi access points, proxies, routers, enterprise or national network censors, ISPs</p>
    <p>on-path vantage</p>
    <p>point</p>
    <p>Scenario I: on-path attack</p>
  </div>
  <div class="page">
    <p>detectors</p>
    <p>tra in</p>
    <p>in g</p>
    <p>victim network</p>
    <p>Pulp Fiction</p>
    <p>Die Hard</p>
    <p>Armageddon Armageddon attacker network</p>
    <p>machine learning</p>
    <p>Attack details</p>
    <p>metadata</p>
  </div>
  <div class="page">
    <p>Very good at learning high-level concepts that are hard to</p>
    <p>express formally (e.g., traffic traces are similar)</p>
    <p>Existing NN architectures very accurate on classification</p>
    <p>and detection problems</p>
    <p>Deep neural networks</p>
  </div>
  <div class="page">
    <p>Robust: can operate on noisy and coarse</p>
    <p>measurements</p>
    <p>Agnostic to protocol-specific attributes (e.g.,</p>
    <p>QUIC vs. TLS)</p>
    <p>Can learn features other than burst patterns,</p>
    <p>e.g., arrival patterns of individual packets</p>
    <p>Can use multiple session representations,</p>
    <p>train on all at once</p>
    <p>Advantages of neural networks</p>
  </div>
  <div class="page">
    <p>Each feature is a time-series, sampled at 0.25-second intervals (example: bytes per second)</p>
    <p>time (seconds)</p>
    <p>p a c k e</p>
    <p>t s iz</p>
    <p>e</p>
    <p>Features considered: downstream/upstream/total values of bytes per</p>
    <p>second, packet per second, average packet length, and burst sizes</p>
    <p>Features</p>
  </div>
  <div class="page">
    <p>detectors</p>
    <p>tra in</p>
    <p>in g</p>
    <p>victim network</p>
    <p>Pulp Fiction</p>
    <p>Die Hard</p>
    <p>Armageddon Armageddon attacker network</p>
    <p>neural net</p>
    <p>Attack</p>
    <p>On-path attacker</p>
    <p>metadata</p>
  </div>
  <div class="page">
    <p>Datasets and identification experiments</p>
  </div>
  <div class="page">
    <p>Datasets and identification experiments</p>
  </div>
  <div class="page">
    <p>open-world identification</p>
    <p>Datasets and identification experiments</p>
  </div>
  <div class="page">
    <p>open-world identification</p>
    <p>Datasets and identification experiments</p>
  </div>
  <div class="page">
    <p>open-world identification</p>
    <p>Datasets and identification experiments</p>
  </div>
  <div class="page">
    <p>Netflix (feature: total burst size)</p>
    <p>YouTube (feature: total burst size)</p>
    <p>Predicted label Predicted label</p>
    <p>unknown class, 3500 samples</p>
    <p>Empirical results: confusion matrices</p>
  </div>
  <div class="page">
    <p>Netflix (feature: total burst size)</p>
    <p>YouTube (feature: total burst size)</p>
    <p>Predicted label Predicted label</p>
    <p>unknown class, 3500 samples Exactly 2 false positives</p>
    <p>No recurrent confusions (despite many same-series titles)</p>
    <p>Empirical results: confusion matrices</p>
  </div>
  <div class="page">
    <p>Netflix (feature: total burst size)</p>
    <p>YouTube (feature: total burst size)</p>
    <p>Tuning for precision</p>
  </div>
  <div class="page">
    <p>detectors</p>
    <p>tra in</p>
    <p>in g</p>
    <p>victim network</p>
    <p>Pulp Fiction</p>
    <p>Die Hard</p>
    <p>Armageddon Armageddon attacker network</p>
    <p>vantage point?</p>
    <p>Attack details</p>
    <p>tra in</p>
    <p>in g</p>
    <p>neural net</p>
    <p>metadata</p>
  </div>
  <div class="page">
    <p>Wi-Fi access points, proxies, routers, enterprise or national network censors, ISPs</p>
    <p>bursts</p>
    <p>victim network</p>
    <p>on-path vantage</p>
    <p>point</p>
    <p>Off-path attackers</p>
  </div>
  <div class="page">
    <p>bursts</p>
    <p>victim network Off-path attackers</p>
  </div>
  <div class="page">
    <p>A visited webpage? A smartphone app?</p>
    <p>bursts</p>
    <p>victim network Off-path attackers</p>
  </div>
  <div class="page">
    <p>A visited webpage? A smartphone app?</p>
    <p>bursts</p>
    <p>victim network Off-path attackers</p>
    <p>Example: checking Facebook feed while streaming Armageddon</p>
  </div>
  <div class="page">
    <p>A visited webpage? A smartphone app?</p>
    <p>bursts</p>
    <p>victim network Off-path attackers</p>
    <p>Example: checking Facebook feed while streaming Armageddon</p>
  </div>
  <div class="page">
    <p>A visited webpage? A smartphone app?</p>
    <p>bursts</p>
    <p>victim network Off-path attackers</p>
    <p>Example: checking Facebook feed while streaming Armageddon</p>
  </div>
  <div class="page">
    <p>A visited webpage? A smartphone app?</p>
    <p>bursts</p>
    <p>victim network</p>
    <p>Web ad</p>
    <p>Off-path attackers</p>
    <p>Example: checking Facebook feed while streaming Armageddon</p>
  </div>
  <div class="page">
    <p>A visited webpage? A smartphone app?</p>
    <p>bursts</p>
    <p>victim network</p>
    <p>Web ad</p>
    <p>Off-path attackers</p>
    <p>Example: checking Facebook feed while streaming Armageddon</p>
  </div>
  <div class="page">
    <p>A visited webpage? A smartphone app?</p>
    <p>bursts</p>
    <p>victim network</p>
    <p>Web ad</p>
    <p>Three-fold confinement: different device, browser process, sandboxed iframe</p>
    <p>Off-path attackers</p>
    <p>Example: checking Facebook feed while streaming Armageddon</p>
  </div>
  <div class="page">
    <p>Browser</p>
    <p>neighbor</p>
    <p>viewer Cross-device attack</p>
  </div>
  <div class="page">
    <p>JavaScript attacker client</p>
    <p>Browser</p>
    <p>attacker Web site</p>
    <p>neighbor</p>
    <p>viewer Cross-device attack</p>
  </div>
  <div class="page">
    <p>JavaScript attacker client</p>
    <p>Browser</p>
    <p>attacker Web site</p>
    <p>neighbor</p>
    <p>viewer Cross-device attack</p>
    <p>messages</p>
  </div>
  <div class="page">
    <p>JavaScript attacker client</p>
    <p>Congestion</p>
    <p>Browser</p>
    <p>attacker Web site</p>
    <p>neighbor</p>
    <p>viewer Cross-device attack</p>
    <p>messages</p>
  </div>
  <div class="page">
    <p>JavaScript attacker client</p>
    <p>Congestion</p>
    <p>Browser</p>
    <p>attacker Web site</p>
    <p>bursts</p>
    <p>neighbor</p>
    <p>viewer Cross-device attack</p>
    <p>messages</p>
  </div>
  <div class="page">
    <p>JavaScript attacker client</p>
    <p>Congestion</p>
    <p>Browser</p>
    <p>attacker Web site</p>
    <p>bursts</p>
    <p>delays</p>
    <p>neighbor</p>
    <p>viewer Cross-device attack</p>
    <p>messages</p>
  </div>
  <div class="page">
    <p>JavaScript attacker client</p>
    <p>Noisy, coarse estimate of actual traffic bursts</p>
    <p>Congestion</p>
    <p>Browser</p>
    <p>attacker Web site</p>
    <p>bursts</p>
    <p>delays</p>
    <p>neighbor</p>
    <p>viewer Cross-device attack</p>
    <p>messages</p>
  </div>
  <div class="page">
    <p>traffic burst sizes (scaled down)</p>
    <p>Message delays</p>
    <p>Delay-bursts d e la</p>
    <p>y (</p>
    <p>m il li s e c o n d s )</p>
    <p>time (seconds)</p>
  </div>
  <div class="page">
    <p>For each traffic burst, compute aggregate delay induced. Use resulting time-series as input to neural network</p>
    <p>traffic burst sizes (scaled down)</p>
    <p>Message delays</p>
    <p>Delay-bursts d e la</p>
    <p>y (</p>
    <p>m il li s e c o n d s )</p>
    <p>time (seconds)</p>
  </div>
  <div class="page">
    <p>Delay-bursts vs. traffic bursts</p>
    <p>delay-bursts time series: the delays induced by traffic bursts</p>
  </div>
  <div class="page">
    <p>Accuracy: 0.965</p>
    <p>false positive rate: 0.003, recall 0.933</p>
  </div>
  <div class="page">
    <p>JavaScript detector code</p>
    <p>Browser</p>
    <p>attacker Web site</p>
    <p>Cross-device attack</p>
    <p>neighbor</p>
    <p>viewer</p>
  </div>
  <div class="page">
    <p>attacker Web site</p>
    <p>Cross-site attack</p>
    <p>Streaming client</p>
    <p>victim PC browser window</p>
    <p>browser window</p>
    <p>JavaScript detector code</p>
  </div>
  <div class="page">
    <p>Modern streaming traffic characteristics</p>
    <p>Title bitrate pattern unique when sampled at few-seconds granularity</p>
    <p>Fetching at segment granularity (= every few seconds)</p>
    <p>Maximizes quality of experience, server load, and network</p>
    <p>bandwidth utilization</p>
    <p>However, information leakage is intrinsic</p>
    <p>Buffer below threshold?</p>
    <p>yes</p>
    <p>fetch next segment</p>
    <p>no</p>
    <p>Mitigating the DASH leak</p>
  </div>
  <div class="page">
    <p>Further information and the paper:</p>
    <p>https://beautyburst.github.io/</p>
    <p>Thank you!</p>
  </div>
</Presentation>
