<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>DONAR Decentralized Server Selection</p>
    <p>for Cloud Services</p>
    <p>Patrick Wendell, Princeton University</p>
    <p>Joint work with Joe Wenjie Jiang, Michael J. Freedman, and Jennifer Rexford</p>
  </div>
  <div class="page">
    <p>Outline</p>
    <p>Server selection background</p>
    <p>Constraint-based policy interface</p>
    <p>Scalable optimization algorithm</p>
    <p>Production deployment</p>
  </div>
  <div class="page">
    <p>User Facing Services are Geo-Replicated</p>
  </div>
  <div class="page">
    <p>Reasoning About Server Selection</p>
    <p>Service Replicas</p>
    <p>Client Requests</p>
    <p>Mapping Nodes</p>
  </div>
  <div class="page">
    <p>Example: Distributed DNS</p>
    <p>Client 1</p>
    <p>Client C</p>
    <p>DNS 1</p>
    <p>DNS 2</p>
    <p>DNS 10</p>
    <p>ServersAuth. Nameservers</p>
    <p>Client 2</p>
    <p>Clients Mapping Nodes Service Replicas</p>
    <p>DNS Resolvers</p>
  </div>
  <div class="page">
    <p>Example: HTTP Redir/Proxying</p>
    <p>Client 1</p>
    <p>Client C</p>
    <p>DatacentersHTTP Proxies</p>
    <p>Client 2</p>
    <p>Clients Mapping Nodes Service Replicas</p>
    <p>HTTP Clients</p>
    <p>Proxy 1</p>
    <p>Proxy 2</p>
    <p>Proxy 500</p>
  </div>
  <div class="page">
    <p>Reasoning About Server Selection</p>
    <p>Service Replicas</p>
    <p>Client Requests</p>
    <p>Mapping Nodes</p>
  </div>
  <div class="page">
    <p>Reasoning About Server Selection</p>
    <p>Service Replicas</p>
    <p>Client Requests</p>
    <p>Mapping Nodes</p>
    <p>Outsource to DONAR</p>
  </div>
  <div class="page">
    <p>Outline</p>
    <p>Server selection background</p>
    <p>Constraint-based policy interface</p>
    <p>Scalable optimization algorithm</p>
    <p>Production deployment</p>
  </div>
  <div class="page">
    <p>Nave Policy Choices Load-Aware: Round Robin</p>
    <p>Service Replicas</p>
    <p>Client Requests</p>
    <p>Mapping Nodes</p>
  </div>
  <div class="page">
    <p>Nave Policy Choices Location-Aware: Closest Node</p>
    <p>Service Replicas</p>
    <p>Client Requests</p>
    <p>Mapping Nodes</p>
    <p>Goal: support complex policies</p>
    <p>across many nodes.</p>
  </div>
  <div class="page">
    <p>Policies as Constraints</p>
    <p>ReplicasDONAR Nodes</p>
  </div>
  <div class="page">
    <p>Eg. 10-Server Deployment</p>
    <p>How to describe policy with constraints?</p>
  </div>
  <div class="page">
    <p>No Constraints Equivalent to Closest Node</p>
  </div>
  <div class="page">
    <p>No Constraints Equivalent to Closest Node</p>
    <p>Impose 20% Cap</p>
  </div>
  <div class="page">
    <p>Cap as Overload Protection</p>
  </div>
  <div class="page">
    <p>Requests per Replica</p>
  </div>
  <div class="page">
    <p>Load Balance (split = 10%, tolerance = 5%)</p>
    <p>Requests per Replica</p>
  </div>
  <div class="page">
    <p>Load Balance (split = 10%, tolerance = 5%)</p>
    <p>Requests per Replica</p>
    <p>Trade-off network proximity &amp; load distribution</p>
  </div>
  <div class="page">
    <p>Requests per Replica</p>
    <p>Large range of policies by varying cap/weight</p>
  </div>
  <div class="page">
    <p>Outline</p>
    <p>Server selection background</p>
    <p>Constraint-based policy interface</p>
    <p>Scalable optimization algorithm</p>
    <p>Production deployment</p>
  </div>
  <div class="page">
    <p>Optimization: Policy Realization</p>
    <p>Global LP describing optimal pairing</p>
    <p>Clients: c C  Nodes: n N Replica Instances: i I</p>
    <p>Minimize network costMinimize network cost</p>
    <p>Server loads within tolerance Server loads within tolerance</p>
    <p>Bandwidth caps metBandwidth caps met</p>
    <p>s.t.</p>
  </div>
  <div class="page">
    <p>Optimization Workflow</p>
    <p>Measure Traffic</p>
    <p>Track Replica Set</p>
    <p>Calculate Optimal</p>
    <p>Assignment</p>
  </div>
  <div class="page">
    <p>Optimization Workflow</p>
    <p>Measure Traffic</p>
    <p>Track Replica Set</p>
    <p>Calculate Optimal</p>
    <p>Assignment</p>
    <p>Per-customer!</p>
  </div>
  <div class="page">
    <p>Optimization Workflow</p>
    <p>Measure Traffic</p>
    <p>Track Replica Set</p>
    <p>Calculate Optimal</p>
    <p>Assignment</p>
    <p>Continuously!</p>
    <p>(respond to underlying traffic)</p>
  </div>
  <div class="page">
    <p>By The Numbers 101 102 103 104</p>
    <p>DONAR Nodes Customers replicas/customer client groups/ customer</p>
    <p>Problem for each customer: 102 * 104 = 106</p>
  </div>
  <div class="page">
    <p>Measure Traffic &amp; Optimize Locally?</p>
    <p>Service Replicas</p>
    <p>Mapping Nodes</p>
  </div>
  <div class="page">
    <p>Not Accurate!</p>
    <p>Service Replicas</p>
    <p>Mapping Nodes</p>
    <p>Client Requests</p>
    <p>No one node sees entire client population</p>
    <p>No one node sees entire client population</p>
  </div>
  <div class="page">
    <p>Aggregate at Central Coordinator?</p>
    <p>Service Replicas</p>
    <p>Mapping Nodes</p>
  </div>
  <div class="page">
    <p>Aggregate at Central Coordinator?</p>
    <p>Service Replicas</p>
    <p>Mapping Nodes</p>
    <p>Share Traffic Measurements</p>
    <p>(106)</p>
  </div>
  <div class="page">
    <p>Aggregate at Central Coordinator?</p>
    <p>Service Replicas</p>
    <p>Mapping Nodes</p>
    <p>Optimize</p>
  </div>
  <div class="page">
    <p>Aggregate at Central Coordinator?</p>
    <p>Service Replicas</p>
    <p>Mapping Nodes</p>
    <p>Return assignments</p>
    <p>(106)</p>
  </div>
  <div class="page">
    <p>So Far Accurate Efficient Reliable</p>
    <p>Local only No Yes Yes</p>
    <p>Central Coordinator</p>
    <p>Yes No No</p>
  </div>
  <div class="page">
    <p>Decomposing Objective Function</p>
    <p>Traffic from c</p>
    <p>prob of mapping c to i</p>
    <p>cost of mapping c to i</p>
    <p>=</p>
    <p>Traffic to this node</p>
    <p>We also decompose constraints</p>
    <p>(more complicated)</p>
    <p>We also decompose constraints</p>
    <p>(more complicated)</p>
  </div>
  <div class="page">
    <p>Decomposed Local Problem For Some Node (n*)</p>
    <p>min</p>
    <p>loadi = f(prevailing load on each server + load I will impose on each server)</p>
    <p>Local distance minimization</p>
    <p>Global load information</p>
  </div>
  <div class="page">
    <p>DONAR Algorithm</p>
    <p>Service Replicas</p>
    <p>Mapping Nodes</p>
    <p>Solve local problem</p>
  </div>
  <div class="page">
    <p>DONAR Algorithm</p>
    <p>Service Replicas</p>
    <p>Mapping Nodes</p>
    <p>Solve local problem</p>
    <p>Share summary data</p>
    <p>w/ others (102)</p>
  </div>
  <div class="page">
    <p>DONAR Algorithm</p>
    <p>Service Replicas</p>
    <p>Mapping Nodes</p>
    <p>Solve local problem</p>
  </div>
  <div class="page">
    <p>DONAR Algorithm</p>
    <p>Service Replicas</p>
    <p>Mapping Nodes</p>
    <p>Share summary data w/ others</p>
    <p>(102)</p>
  </div>
  <div class="page">
    <p>DONAR Algorithm</p>
    <p>Provably converges to global optimum</p>
    <p>Requires no coordination</p>
    <p>Reduces message passing by 104</p>
    <p>Service Replicas</p>
    <p>Mapping Nodes</p>
  </div>
  <div class="page">
    <p>Better! Accurate Efficient Reliable</p>
    <p>Local only No Yes Yes</p>
    <p>Central Coordinator</p>
    <p>Yes No No</p>
    <p>DONAR Yes Yes Yes</p>
  </div>
  <div class="page">
    <p>Outline</p>
    <p>Server selection background</p>
    <p>Constraint-based policy interface</p>
    <p>Scalable optimization algorithm</p>
    <p>Production deployment</p>
  </div>
  <div class="page">
    <p>Production and Deployment</p>
    <p>Publicly deployed 24/7 since November 2009</p>
    <p>IP2Geo data from Quova Inc.</p>
    <p>Production use:  All MeasurementLab Services</p>
    <p>(incl. FCC Broadband Testing)  CoralCDN</p>
    <p>Services around 1M DNS requests per day</p>
  </div>
  <div class="page">
    <p>Systems Challenges (See Paper!)</p>
    <p>Network availability Anycast with BGP</p>
    <p>Reliable data storage Chain-Replication with Apportioned Queries</p>
    <p>Secure, reliable updates Self-Certifying Update Protocol</p>
  </div>
  <div class="page">
    <p>CoralCDN Replicas</p>
    <p>DONAR Nodes</p>
    <p>Client Requests</p>
    <p>CoralCDN Experimental Setup</p>
    <p>split_weight = .1 tolerance = .02</p>
  </div>
  <div class="page">
    <p>Results: DONAR Curbs Volatility</p>
    <p>Closest Node policy</p>
    <p>DONAR Equal Split Policy</p>
  </div>
  <div class="page">
    <p>Results: DONAR Minimizes Distance</p>
    <p>Minimal (Closest Node) DONAR Round-Robin</p>
    <p>Ranked Order from Closest</p>
    <p>Re qu</p>
    <p>es ts</p>
    <p>p er</p>
    <p>R ep</p>
    <p>lic a</p>
  </div>
  <div class="page">
    <p>Conclusions</p>
    <p>Dynamic server selection is difficult  Global constraints  Distributed decision-making</p>
    <p>Services reap benefit of outsourcing to DONAR.  Flexible policies  General: Supports DNS &amp; HTTP Proxying  Efficient distributed constraint optimization</p>
    <p>Interested in using? Contact me or visit http://www.donardns.org.</p>
  </div>
  <div class="page">
    <p>Questions?</p>
  </div>
  <div class="page">
    <p>Related Work (Academic and Industry)</p>
    <p>Academic  Improving network measurement</p>
    <p>iPlane: An informationplane for distributed services H. V. Madhyastha, T. Isdal, M. Piatek, C. Dixon, T. Anderson, A. Krishnamurthy, and A. Venkataramani, , in OSDI, Nov. 2006</p>
    <p>Application Layer Anycast  OASIS: Anycast for Any Service</p>
    <p>Michael J. Freedman, Karthik Lakshminarayanan, and David Mazires Proc. 3rd USENIX/ACM Symposium on Networked Systems Design and Implementation (NSDI '06) San Jose, CA, May 2006.</p>
    <p>Proprietary  Amazon Elastic Load Balancing  UltraDNS  Akamai Global Traffic Management</p>
  </div>
  <div class="page">
    <p>Doesnt [Akamai/UltraDNS/etc] Already Do This?</p>
    <p>Existing approaches use alternative, centralized formulations.</p>
    <p>Often restrict the set of nodes per-service.</p>
    <p>Lose benefit of large number of nodes (proxies/DNS servers/etc).</p>
  </div>
</Presentation>
