<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Computer Science</p>
    <p>DACSA: A Decoupled Architecture for</p>
    <p>Cloud Security Analysis</p>
    <p>Jason Gionta, William Enck, Peng Ning  NC State</p>
    <p>Ahmed Azab  Samsung Ltd</p>
    <p>Xialoan Zhang  Google Inc</p>
  </div>
  <div class="page">
    <p>Computer Science</p>
    <p>Cloud Provider Landscape</p>
  </div>
  <div class="page">
    <p>Computer Science</p>
    <p>Cloud Provider Landscape</p>
    <p>Degrade</p>
    <p>Steal</p>
    <p>Infect Degrade</p>
  </div>
  <div class="page">
    <p>Computer Science</p>
    <p>Cloud Provider Landscape</p>
    <p>Degrade</p>
    <p>Steal</p>
    <p>Infect Degrade</p>
    <p>How to ask security centric questions?</p>
  </div>
  <div class="page">
    <p>Computer Science</p>
    <p>Unique Features of Cloud</p>
    <p>Diverse Components and</p>
    <p>Applications</p>
    <p>Single Platform Owner</p>
    <p>Geographically Dispersed</p>
  </div>
  <div class="page">
    <p>Computer Science</p>
    <p>Cloud Infrastructure as a Security Testbed</p>
    <p>Security</p>
    <p>Attributes</p>
  </div>
  <div class="page">
    <p>Computer Science</p>
    <p>How to Create a Datasource?</p>
    <p>Network Monitoring</p>
    <p>Flow analysis</p>
    <p>Encrypted network data</p>
    <p>In-Guest VM Monitoring</p>
    <p>Virus Scanners / Security Software</p>
    <p>Application Firewalls</p>
    <p>Resource Intensive</p>
    <p>Software Management</p>
    <p>Host Based Out of VM Monitoring</p>
    <p>Peer into VM - VMWatcher</p>
    <p>Record and Replay - Revirt</p>
    <p>Scalability</p>
  </div>
  <div class="page">
    <p>Computer Science</p>
    <p>How to Create a Datasource?</p>
    <p>Network Monitoring</p>
    <p>Flow analysis</p>
    <p>Encrypted network data</p>
    <p>In-Guest VM Monitoring</p>
    <p>Virus Scanners / Security Software</p>
    <p>Application Firewalls</p>
    <p>Resource Intensive</p>
    <p>Software Management</p>
    <p>Host Based Out of VM Monitoring</p>
    <p>Peer into VM - VMWatcher</p>
    <p>Record and Replay - Revirt</p>
    <p>Scalability</p>
    <p>Decouple analysis from</p>
    <p>attribute acquisition</p>
  </div>
  <div class="page">
    <p>Computer Science</p>
    <p>Decoupled Architecture for Analysis</p>
    <p>Security</p>
    <p>Attributes</p>
    <p>Sensor Sensor Sensor</p>
  </div>
  <div class="page">
    <p>Computer Science</p>
    <p>DACSA</p>
    <p>Security</p>
    <p>Attributes</p>
    <p>Sensor Sensor Sensor Context</p>
    <p>Acquisition</p>
    <p>Context</p>
    <p>Acquisition</p>
    <p>Context</p>
    <p>Acquisition</p>
    <p>Context</p>
    <p>Carver</p>
    <p>Security</p>
    <p>Attributes</p>
    <p>Analysis</p>
    <p>Tools</p>
    <p>DACSA Components</p>
  </div>
  <div class="page">
    <p>Computer Science</p>
    <p>DACSA Goals</p>
    <p>Limit impact to client VMs and hosts</p>
    <p>Enable analysis on supporting infrastructure</p>
    <p>Transparent to clients</p>
    <p>Test for security violations</p>
    <p>ToS</p>
    <p>Bots/C&amp;C</p>
    <p>Malicious software development</p>
  </div>
  <div class="page">
    <p>Computer Science</p>
    <p>Context Acquisition</p>
    <p>Fast Memory Snapshots</p>
    <p>Logical memory copy of guest memory</p>
    <p>COW</p>
    <p>Limit impact to guest and host</p>
    <p>Reliable copies</p>
    <p>Pause guest</p>
    <p>Flush Asynchronous I/O</p>
  </div>
  <div class="page">
    <p>Computer Science</p>
    <p>Carving Memory</p>
    <p>Apply memory forensic techniques</p>
    <p>Extract security centric information</p>
    <p>Open ports, registry keys, processes, API hooks</p>
    <p>Hashes of executable pages</p>
    <p>Forensic tools</p>
    <p>Volatility</p>
    <p>Work directly on memory</p>
    <p>Interpose file I/O</p>
  </div>
  <div class="page">
    <p>Computer Science</p>
    <p>Analysis</p>
    <p>Clustering of system features</p>
    <p>Blacksheep  Bianchi et al.</p>
    <p>Memory based virus scanning</p>
    <p>Memory only malware</p>
    <p>Security Audit</p>
    <p>PCI Requirements</p>
  </div>
  <div class="page">
    <p>Computer Science</p>
    <p>Implementation</p>
    <p>Host  Ubuntu 12.04 64-bit</p>
    <p>Guests  Windows 7 SP1 64-bit</p>
    <p>KVM/QEMU</p>
    <p>Fork QEMU process</p>
    <p>Shared library for interposing File I/O</p>
    <p>Volatility</p>
    <p>Custom tool for parsing memory</p>
    <p>Window 7 GS register to walk internal data structures</p>
    <p>Analysis</p>
    <p>Scan viruses in memory</p>
  </div>
  <div class="page">
    <p>Computer Science</p>
    <p>Evaluation</p>
    <p>Platform</p>
    <p>IBM System X server Xeon E5450 Quad-core</p>
    <p>Guests 1GB Ram</p>
    <p>Impact to Guest</p>
    <p>Impact to Host</p>
    <p>Correctly identify infected processes</p>
  </div>
  <div class="page">
    <p>Computer Science</p>
    <p>Impact to Guest</p>
    <p>1-15 VMs, snapshot VMs, carve process list</p>
    <p>Pause time</p>
    <p>Flush Async I/O, Fork QEMU Process, Resume</p>
    <p>VM</p>
    <p>~.2112 seconds / standard deviation .07359 sec</p>
    <p>Reduction in system performance</p>
    <p>Run Novabench in snapshotted VM</p>
    <p>Measure CPU Ops/Sec and Memory Ops/Sec</p>
    <p>0-6% CPU, 0-3% Memory</p>
  </div>
  <div class="page">
    <p>Computer Science</p>
    <p>Impact to Host</p>
    <p>1-15 VMs, snapshot VMs, carve process list</p>
    <p>Increased CPU and Memory Utilization</p>
    <p>~3% CPU</p>
    <p>Negligible Memory overhead</p>
    <p>Write Working Set</p>
    <p>100-300 MB per minute</p>
  </div>
  <div class="page">
    <p>Computer Science</p>
    <p>Carving Process Memory</p>
    <p>Infected VM with Cerberus RAT</p>
    <p>iexplore.exe host process</p>
    <p>Carved process memory</p>
    <p>Scanned memory with ClamAV</p>
    <p>Identified infected process</p>
  </div>
  <div class="page">
    <p>Computer Science</p>
    <p>Related Work</p>
    <p>Live VM Migration (Clark et al.)</p>
    <p>Migrations takes upwards of 90 seconds</p>
    <p>Performance degradation upto 20%</p>
    <p>Fast VM Cloning (Sun et al.)</p>
    <p>COW based by write protecting pages</p>
    <p>Technical challenges of cloning</p>
  </div>
  <div class="page">
    <p>Computer Science</p>
    <p>Conclusion</p>
    <p>DACSA turns clouds into a platform for</p>
    <p>security analysis</p>
    <p>VMs lightweight sensors</p>
    <p>Minimal impact to VM and host operations</p>
    <p>Apply large scale analysis</p>
    <p>Future Work</p>
    <p>Deploy to Virtual Computing Lab at NC State</p>
    <p>Memory Scanning as a Service</p>
  </div>
  <div class="page">
    <p>Computer Science</p>
    <p>Questions?</p>
    <p>Thanks</p>
    <p>Reviewers insightful comments</p>
    <p>Eric Eide for shepherding</p>
    <p>jjgionta@ncsu.edu</p>
  </div>
</Presentation>
