<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Efficiently Delivering Online Services over Integrated Infrastructure</p>
    <p>Hongqiang Harry Liu, Raajay Viswanathan, MaC Calder Aditya Akella, Ratul Mahajan, Jitendra Padhye, Ming Zhang</p>
  </div>
  <div class="page">
    <p>Online Services</p>
  </div>
  <div class="page">
    <p>Data Centers</p>
    <p>Proxies</p>
    <p>Online Service Delivery Infrastructure</p>
    <p>Wide Area Network</p>
  </div>
  <div class="page">
    <p>WAN</p>
    <p>MulOple owners</p>
    <p>Online Service Delivery is Evolving</p>
    <p>Owned by a single enOty</p>
    <p>Tradi*onal infrastructure Integrated infrastructure</p>
    <p>Operated by different ISPs Operated by content providers</p>
  </div>
  <div class="page">
    <p>WAN</p>
    <p>Integrated Infrastructure Enables Joint Control of All Decisions</p>
  </div>
  <div class="page">
    <p>WAN</p>
    <p>DC-1</p>
    <p>DC-2</p>
    <p>Proxy-2 Proxy-1</p>
    <p>Increase efficiency: total traffic without congesOon  Improve performance: aggregate end-to-end latency</p>
    <p>Proxy-3</p>
    <p>Advantages of Joint Control</p>
  </div>
  <div class="page">
    <p>Footprint: Jointly Controls the Integrated Infrastructure</p>
    <p>Controller</p>
    <p>UG  proxy latency</p>
    <p>System capacity</p>
    <p>User workload</p>
    <p>P2 P1</p>
    <p>DC1</p>
    <p>DC2 P3</p>
    <p>Control decisions for a user group:  UGproxy mapping  proxyDC mapping  network paths</p>
    <p>Goals:  Maximize congesOon free traffic  Minimize end-to-end latency</p>
    <p>Topology</p>
    <p>UG1</p>
    <p>Users grouped by locaOon, service provider</p>
  </div>
  <div class="page">
    <p>Outline</p>
    <p>Challenges in compuOng forwarding configuraOon  Other challenges in realizing Footprint  EvaluaOon</p>
  </div>
  <div class="page">
    <p>CompuOng ConfiguraOon: Basic Approach</p>
    <p>d1</p>
    <p>d2</p>
    <p>dn</p>
    <p>C1</p>
    <p>C2</p>
    <p>Cm</p>
    <p>EsOmated user demands for an epoch</p>
    <p>Resource capaciOes</p>
    <p>EsOmated load from user u on resource r</p>
    <p>Capacity constraint for resource r</p>
    <p>ObjecOve</p>
    <p>maximize</p>
    <p>w11</p>
    <p>w12</p>
    <p>w1m</p>
    <p>wnm</p>
    <p>nu r = du.wu</p>
    <p>r</p>
    <p>{d1,d2,...,dn}</p>
    <p>{C1,C2,...,Cm}</p>
    <p>nr = nu r Cr</p>
    <p>u</p>
    <p>nu r</p>
    <p>r</p>
    <p>u</p>
    <p>ln m</p>
    <p>l1 m</p>
    <p>l1 2</p>
    <p>l1 1</p>
    <p>lu rnu</p>
    <p>r</p>
    <p>r</p>
    <p>u Latencies</p>
    <p>Linear Program</p>
  </div>
  <div class="page">
    <p>Does such a simple model suffice ?</p>
    <p>No</p>
    <p>Because of the nature of traffic from different online applicaOons</p>
  </div>
  <div class="page">
    <p>User Traffic Arrives over Sessions</p>
    <p>MulOple requests and responses over a single session</p>
    <p>Sessions are long-lived and arrive all through the duraOon of</p>
    <p>an epoch</p>
    <p>#S es si on</p>
    <p>s on</p>
    <p>a R es ou</p>
    <p>rc e</p>
    <p>Ome (s) 0</p>
    <p>TCP</p>
    <p>Requests</p>
    <p>Responses Proxy</p>
    <p>#sessions varies over Ome</p>
  </div>
  <div class="page">
    <p>Session SOckiness</p>
    <p>Sessions s*ck to proxy and DC  Long lived TCP sessions  No fresh DNS query in the middle of a session</p>
    <p>P1</p>
    <p>P2</p>
    <p>P1</p>
    <p>P2</p>
    <p>Switch traffic at t = T</p>
    <p>Overlay link</p>
    <p># sessions on P1</p>
    <p>Ome (s) T</p>
    <p># sessions on P2</p>
    <p>Ome (s) T</p>
    <p>Non-s*cky sessions</p>
    <p># sessions on P2</p>
    <p>Ome (s)</p>
    <p># sessions on P1</p>
    <p>Ome (s) T</p>
    <p>T</p>
    <p>S*cky sessions</p>
    <p>Old sessions are sOll forwarded to P1</p>
    <p>UG1</p>
    <p>UG1</p>
    <p>n1 1 n1</p>
    <p>n1 2 n1</p>
  </div>
  <div class="page">
    <p>Challenge: Temporal VariaOon of Load</p>
    <p>Gradually varying load from a user group to a resource</p>
    <p>Resource capacity constraints should be saOsfied during enOre epoch</p>
    <p>ComputaOonally infeasible if does not have a closed form</p>
    <p>- ApplicaOons have arbitrary session life distribuOons</p>
    <p>nu r Cr</p>
    <p>u  nur(t)Cr</p>
    <p>u</p>
    <p>nu r(t)</p>
  </div>
  <div class="page">
    <p>How to guarantee congesOon free delivery for traffic on sessions?</p>
  </div>
  <div class="page">
    <p>High Fidelity Modeling of Load</p>
    <p>previous</p>
    <p>n n ew</p>
    <p>Ome (s) 0 300</p>
    <p>n o ld</p>
    <p>Ome (s)</p>
    <p>ProporOonal to arrival rate of new sessions</p>
    <p>nr(t)= nrnew(t)+n r old(t)</p>
    <p>Arrival rate of sessions (decision variable)</p>
    <p>Always holds this paCern</p>
    <p>nro</p>
    <p>current</p>
    <p>nr(t)= rF(t)+no rG(t)</p>
    <p>PaCern FuncOons  Session length distribuOon</p>
    <p>CD F</p>
    <p>Session life Ome (s) 100 200</p>
  </div>
  <div class="page">
    <p>DiscreOzing the Temporal Model</p>
    <p>Approximate by a Oght piecewise</p>
    <p>linear upper bound,</p>
    <p>nr(t) n __</p>
    <p>r(t)= r F __ (t)+nr0G(t)</p>
    <p>n __</p>
    <p>r(t) has maximum at one of the corners</p>
    <p>Capacity constraints have to be checked only at fixed set of points</p>
    <p>Op*mal s obtained by solving a linear program</p>
    <p>F __ (t)</p>
    <p>F(t) F(t)</p>
    <p>F __ (t)</p>
    <p>r</p>
  </div>
  <div class="page">
    <p>Footprint: System ImplementaOon</p>
    <p>Gathering Inputs</p>
    <p>CompuOng OpOmal Forwarding</p>
    <p>ImplemenOng Computed ConfiguraOon</p>
  </div>
  <div class="page">
    <p>Footprint: Inputs to the controller</p>
    <p>Input data collected every 5 minutes</p>
    <p>Inputs:  User group  proxy latency measurements</p>
    <p>Piggy-back on end-host applicaOons</p>
    <p>Instrumented JavaScript on bing.com webpage [Calder et al., IMC 2015]</p>
    <p>User workload  EsOmated using observed workload in prior epochs</p>
    <p>System health status  From Microsoo internal system monitoring pipelines</p>
    <p>Deployed in producOon</p>
  </div>
  <div class="page">
    <p>ImplemenOng Computed ConfiguraOon</p>
    <p>UGproxy mapping: DNS (BIND)</p>
    <p>ProxyDC mapping: Custom sooware to change configuraOon</p>
    <p>WAN path selecOon: OpenFlow</p>
    <p>Prototyped on a modest-sized testbed</p>
  </div>
  <div class="page">
    <p>EvaluaOon</p>
  </div>
  <div class="page">
    <p>EvaluaOon Setup</p>
    <p>Trace driven simulaOons</p>
    <p>Data - Taken from producOon deployment of Footprint - One week worth of data - MulOple topologies (North America, Europe)</p>
    <p>Scale - O(10k) user groups - O(100) routers and links - O(100) proxies - O(10) data centers</p>
    <p>Metric - Efficiency: Maximum traffic with no congesOon - Performance: Aggregated end-to-end latency</p>
  </div>
  <div class="page">
    <p>EvaluaOon: Efficiency of Joint Control</p>
    <p>Footprint can carry 2x more load because user traffic is diverted to resources with unused capacity</p>
    <p>FastRoute Footprint</p>
    <p>N or m al iz ed</p>
    <p>Tr affi</p>
    <p>c Sc al e</p>
    <p>FastRoute [Flavel et al., NSDI 2015]  UGproxy: Closest proxy decided by Anycast rouOng  ProxyDC: Closest proxy based on acOve measurements  WAN path selecOon: Independent traffic engineering module</p>
  </div>
  <div class="page">
    <p>EvaluaOon: Latency Improvement</p>
    <p>La te nc y (m</p>
    <p>s)</p>
    <p>FastRoute Footprint</p>
    <p>External Delay</p>
    <p>Queuing Delay</p>
    <p>Internal PropagaOon Delay</p>
    <p>Footprint decreases overall latency by ~60%</p>
    <p>Compare end-to-end latency at 70% capacity of FastRoute</p>
  </div>
  <div class="page">
    <p>EvaluaOon: Efficiency of Temporal Modeling</p>
    <p>More than 50% gains with respect to non-temporal models.</p>
    <p>Compare with non-temporal models  JointAverage:  JointWorst:</p>
    <p>JointAverage JointWorst Footprint</p>
    <p>N or m al iz ed</p>
    <p>T ra ffi c Sc al e</p>
    <p>nr (t) = max t</p>
    <p>(#old sessions) + max t</p>
    <p>(#new sessions)</p>
    <p>nr (t) =  x Average session length</p>
  </div>
  <div class="page">
    <p>Related Work</p>
    <p>To coordinate or not to coordinate? [Narayana et. al, SIGMETRICS 2012]</p>
    <p>CooperaOve world vs Single enOty world</p>
    <p>Show importance of temporal load modeling</p>
  </div>
  <div class="page">
    <p>Summary</p>
    <p>Joint decision for proxy, DC and WAN path selecOon  100% increase in supported users, and,  60% reducOon in end-to-end latency</p>
    <p>High fidelity temporal models 50% efficient than non</p>
    <p>temporal models</p>
    <p>Ome (s) 0</p>
    <p>#S es si on</p>
    <p>s</p>
  </div>
  <div class="page"/>
</Presentation>
