<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Weiss</p>
    <p>Berlin Institute of TechnologyBerlin Institute of Technology FG Security in Telecommunications</p>
    <p>Let Me Answer That For You: Exploiting Broadcast Information in Cellular Networks</p>
    <p>Nico Golde, Kvin Redon, JeanPierre Seifert</p>
    <p>{nico, kredon, jpseifert}@sec.tlabs.tuberlin.de</p>
    <p>USENIX Security '13</p>
    <p>August 14th, 2013 Washington, D.C.</p>
  </div>
  <div class="page">
    <p>Golde, Redon, Seifert  Let Me Answer That For You  USENIX Security '13 2</p>
    <p>Motivation  Yet Another Attack on GSM?</p>
    <p>Numerous security vulnerabilities already exist on GSM, but few of them involve active adversaries</p>
    <p>GSM is still one of the most relevant mobile telephony standards: it still account for an important part of the mobile traffic, every phone supports GSM, M2M and IoT will used it for long,</p>
    <p>GSM is still widely used and a model for mobile communication</p>
    <p>The same mechanism from GSM are used in UMTS and LTE, including the paging</p>
    <p>Freely modifiable GSM stack + baseband exist for verification</p>
  </div>
  <div class="page">
    <p>Golde, Redon, Seifert  Let Me Answer That For You  USENIX Security '13 3</p>
    <p>Contributions</p>
    <p>We present the paging response attack  Novel attack against mobile terminated services</p>
    <p>We show feasibility in practice  Implemented phone firmware which to steal SMS and</p>
    <p>perform denial of service attacks  Evaluate attack in major European GSM operator networks</p>
    <p>We access requirements and challenges to large-scale denial  Evaluate feasibility of attacks against large regions such as</p>
    <p>city districts (example: Berlin)</p>
  </div>
  <div class="page">
    <p>Golde, Redon, Seifert  Let Me Answer That For You  USENIX Security '13 4</p>
    <p>Introduction to paging</p>
    <p>Paging: mechanism used by the network to notify an incoming service</p>
    <p>Once a phone is registered to a cell, it listens to only the Paging Channel (PCH) broadcast downlink channel on the CCCH (this saves energy)</p>
    <p>Phone update their location only when they changes Location Area (LA), but can listen to any PCH from any BTS within this LA</p>
    <p>Paging message carries Mobile Identity (IMSI/TMSI)</p>
    <p>Each phone compares its identity and reacts</p>
    <p>Again, this information is broadcast!  every phone can see every paging request</p>
  </div>
  <div class="page">
    <p>Golde, Redon, Seifert  Let Me Answer That For You  USENIX Security '13 5</p>
    <p>Mobile Terminated service delivery cont.</p>
    <p>All phones within a LA</p>
    <p>all BTSs within a LA</p>
    <p>Paging request on the PCH</p>
  </div>
  <div class="page">
    <p>Golde, Redon, Seifert  Let Me Answer That For You  USENIX Security '13 6</p>
    <p>Mobile Terminated service delivery cont.</p>
    <p>Paging request on the PCH</p>
    <p>DEADBEEF == identity?</p>
    <p>All phones within a LA</p>
    <p>all BTSs within a LA</p>
  </div>
  <div class="page">
    <p>Golde, Redon, Seifert  Let Me Answer That For You  USENIX Security '13 7</p>
    <p>Mobile Terminated service delivery cont.</p>
    <p>phone BTS</p>
    <p>Paging request on the PCH</p>
    <p>Initial channel request (RACH)</p>
    <p>DEADBEEF == identity?</p>
  </div>
  <div class="page">
    <p>Golde, Redon, Seifert  Let Me Answer That For You  USENIX Security '13 8</p>
    <p>Mobile Terminated service delivery cont.</p>
    <p>BTS</p>
    <p>Paging request on the PCH</p>
    <p>Initial channel request (RACH)</p>
    <p>Immediate Assignment (AGCH)</p>
    <p>DEADBEEF == identity?</p>
    <p>phone</p>
  </div>
  <div class="page">
    <p>Golde, Redon, Seifert  Let Me Answer That For You  USENIX Security '13 9</p>
    <p>Mobile Terminated service delivery cont.</p>
    <p>BTS</p>
    <p>Paging request on the PCH</p>
    <p>Initial channel request (RACH)</p>
    <p>Immediate Assignment (AGCH)</p>
    <p>DEADBEEF == identity?</p>
    <p>Tune to allocated channel</p>
    <p>phone</p>
  </div>
  <div class="page">
    <p>Golde, Redon, Seifert  Let Me Answer That For You  USENIX Security '13 10</p>
    <p>Mobile Terminated service delivery cont.</p>
    <p>BTS</p>
    <p>Paging request on the PCH</p>
    <p>Initial channel request (RACH)</p>
    <p>Immediate Assignment (AGCH)</p>
    <p>Paging response message (SDCCH)</p>
    <p>DEADBEEF == identity?</p>
    <p>Tune to allocated channel</p>
    <p>phone</p>
  </div>
  <div class="page">
    <p>Golde, Redon, Seifert  Let Me Answer That For You  USENIX Security '13 11</p>
    <p>Mobile Terminated service delivery cont.</p>
    <p>BTS</p>
    <p>Paging request on the PCH</p>
    <p>Initial channel request (RACH)</p>
    <p>Immediate Assignment (AGCH)</p>
    <p>Paging response message (SDCCH)</p>
    <p>DEADBEEF == identity?</p>
    <p>Tune to allocated channel</p>
    <p>Authentication, Ciphering, Service Delivery</p>
    <p>phone</p>
  </div>
  <div class="page">
    <p>Golde, Redon, Seifert  Let Me Answer That For You  USENIX Security '13 12</p>
    <p>Paging Attack</p>
    <p>We have a race condition!</p>
    <p>GSM protocols are driven by complex state machines</p>
    <p>Can we respond to other peoples paging messages?  Can we do that faster?  Will the network expect a 2nd paging response?</p>
    <p>We could do that from any BTS in the same area (preferably the one with the best radio link)!</p>
  </div>
  <div class="page">
    <p>Golde, Redon, Seifert  Let Me Answer That For You  USENIX Security '13 13</p>
    <p>Paging Attack  implementing a fast baseband</p>
    <p>Free Software/Open Source mobile baseband firmware: OsmocomBB  Runs on cheap hardware (e.g. cheap Motorola C123)  Mobile phone application exists (but runs on PC!)</p>
    <p>not fast at all :/</p>
    <p>Completely implemented as Layer1 firmware  Ported Layer2/Layer3 to Layer1  Runs solely on the phone  very fast</p>
    <p>Listens to messages on the PCH  Can react to IMSIs/TMSIs or TMSI ranges  Sends paging response messages  Performs invalid ciphering/auth</p>
  </div>
  <div class="page">
    <p>Golde, Redon, Seifert  Let Me Answer That For You  USENIX Security '13 14</p>
    <p>Paging Attack  Measuring paging response speed</p>
    <p>Relevant baseband stacks: Qualcomm, Intel (Infineon), Texas Instruments, ST-Ericsson, Renesas (Nokia), Marvell, Mediatek</p>
    <p>USRP + Modified OpenBTS version logs:  Time for Paging Request  Channel request  Time for Paging Request  Paging response</p>
    <p>Hookup phones to test BTS  Send 250 SMS to each phone  Measure time</p>
  </div>
  <div class="page">
    <p>Golde, Redon, Seifert  Let Me Answer That For You  USENIX Security '13 15</p>
    <p>Paging Attack  How fast is the average phone?</p>
    <p>Time measurements for each baseband</p>
    <p>T im</p>
    <p>e in</p>
    <p>m ill</p>
    <p>is ec</p>
    <p>on ds</p>
    <p>Tested mobile phone</p>
    <p>channel request paging response</p>
  </div>
  <div class="page">
    <p>Golde, Redon, Seifert  Let Me Answer That For You  USENIX Security '13 16</p>
    <p>Paging Attack  Practice results</p>
    <p>Small layer1 only implementation can win the race!  DoS against Mobile Terminated services</p>
    <p>Tested all German operators:  Vodafone  O2 (Telefonica)  E-Plus  T-Mobile</p>
    <p>all vulnerable to this attack</p>
    <p>Can be used for selective DoS</p>
    <p>EPlus MVNO</p>
  </div>
  <div class="page">
    <p>Golde, Redon, Seifert  Let Me Answer That For You  USENIX Security '13 17</p>
    <p>Hijacking Services</p>
    <p>To impersonate a victim we need:  victims identity  credentials normally stored in the SIM to pass the</p>
    <p>authentication</p>
    <p>With this information we can hijack the MT service:  get the SMS  receive the call</p>
  </div>
  <div class="page">
    <p>Golde, Redon, Seifert  Let Me Answer That For You  USENIX Security '13 18</p>
    <p>Getting victim mobile identities</p>
    <p>You don't necessarily have to (why not just react to every paging?)</p>
    <p>Network paging with IMSIs:  3rd party HLR lookups provide number  IMSI mapping</p>
    <p>For TMSIs:  Monitor PCH with OsmocomBB phone  Call victim, drop call early (3.7 seconds on O2)</p>
    <p>phone will not ring, but being paged!  Or use silent SMS  Rinse and repeat</p>
    <p>Evaluate monitored data</p>
    <p>Location leaks over the GSM air interface, Kune et al., NDSS 2012</p>
  </div>
  <div class="page">
    <p>Golde, Redon, Seifert  Let Me Answer That For You  USENIX Security '13 19</p>
    <p>Hijacking delivery  Encryption</p>
    <p>GSM uses weak encryption, which enables us to pass the authentication and impersonate a victim</p>
    <p>We need Kc for encrypted communication!  Some networks use A5/0  No encryption  Some networks use A5/2  Broken (1999)  Most use A5/1  Broken (e.g. 26C3/27C3)</p>
    <p>Kraken + OsmocomBB phones/airprobe can crack session key (Kc) in seconds</p>
    <p>Wideband GSM Sniffing, Munaut &amp; Nohl, 2010</p>
  </div>
  <div class="page">
    <p>Golde, Redon, Seifert  Let Me Answer That For You  USENIX Security '13 20</p>
    <p>Paging Attack cont.  Authentication</p>
    <p>50% of networks authenticate MT (SMS/call) 10% of the time (referring to Security Research Labs)</p>
    <p>Operators care about MO because of billing!  However, MT indirectly affects billing</p>
    <p>Most MT service deliveries not authenticated</p>
    <p>Incomplete authentication allows MT hijacking  Our code can handle a known session key/encryption</p>
    <p>Julien Tromeur</p>
  </div>
  <div class="page">
    <p>Golde, Redon, Seifert  Let Me Answer That For You  USENIX Security '13 21</p>
    <p>Attacking large areas</p>
    <p>Paging requests are broadcasted on all BTSs within a location area  we don't need to camp on the same BTS</p>
    <p>We can respond to all paging requests faster  DoS to all subscribers in that area</p>
    <p>What is the size of a Location Area?  How many users are affected?  What is the amount of paging requests to answer to?</p>
  </div>
  <div class="page">
    <p>Golde, Redon, Seifert  Let Me Answer That For You  USENIX Security '13 22</p>
    <p>How large is a Location Area?</p>
    <p>Location Area Code broadcast on the BCCH  2 people + GPS loggers + OsmocomBB cell_log phones + car :)</p>
  </div>
  <div class="page">
    <p>Golde, Redon, Seifert  Let Me Answer That For You  USENIX Security '13 23</p>
    <p>Location Areas  Berlin/Vodafone</p>
  </div>
  <div class="page">
    <p>Golde, Redon, Seifert  Let Me Answer That For You  USENIX Security '13 24</p>
    <p>Attacking Location Areas cont.</p>
    <p>Non-city LAs larger (and fewer) than for cities  Seen 1000 km</p>
    <p>Location Areas are huge even in cities!  100  500 km in Berlin  Cover whole city districts</p>
    <p>For Mobile Terminated: Paging DoS way more effective than jamming (can be done from any location)</p>
    <p>Feasibility depends on paging activity</p>
  </div>
  <div class="page">
    <p>Golde, Redon, Seifert  Let Me Answer That For You  USENIX Security '13 25</p>
    <p>Attacking Location Areas  Activity</p>
    <p>We can camp on location areas and log paging  Measured all 4 operators over 24 hours, same time and location</p>
    <p>T M</p>
    <p>S Is</p>
    <p>/ m</p>
    <p>in ut</p>
    <p>e</p>
    <p>Local time (in hours), 20120801</p>
    <p>EPlus O2</p>
    <p>TMobile Vodafone</p>
  </div>
  <div class="page">
    <p>Golde, Redon, Seifert  Let Me Answer That For You  USENIX Security '13 26</p>
    <p>Attacking Location Areas cont.</p>
    <p>One phone can answer to ~1 paging request/sec (including sending paging response and retuning to BCCH)</p>
    <p>~ 11 phones are needed to answer all paging requests within location area of a small operator (E-plus). This is supported by a single BTS.</p>
    <p>These phones are cheap (5-20 )</p>
  </div>
  <div class="page">
    <p>Golde, Redon, Seifert  Let Me Answer That For You  USENIX Security '13 27</p>
    <p>DoS + Paging activity reduction</p>
    <p>Paging attack stops initial service delivery  We don't want to answer every time in the future</p>
    <p>IMSI DETACH attack by Sylvain Munaut  Phone detach signal to network</p>
    <p>Mobile Terminated services not delivered until re-attach</p>
    <p>Detach message contains mobile identity  send paging response, send detach message  watch paging reducing over time</p>
  </div>
  <div class="page">
    <p>Golde, Redon, Seifert  Let Me Answer That For You  USENIX Security '13 28</p>
    <p>Conclusions</p>
    <p>Attacking single subscribers and Location Areas is practical!</p>
    <p>Impersonating victims is practical!  DoSing all subscribers within a location area is practical!</p>
    <p>MT services need 100% authentication  Active attackers (malicious phones) need to be considered</p>
    <p>by standardization bodies</p>
  </div>
  <div class="page">
    <p>Golde, Redon, Seifert  Let Me Answer That For You  USENIX Security '13 29</p>
    <p>Thank you for your attention!</p>
    <p>Also thanks to these people:  Dmitry Nedospasov  Benjamin Michle  Alex Dent  Dieter Spaar  Harald Welte  Holger Freyther  Osmocom community!</p>
  </div>
  <div class="page">
    <p>Golde, Redon, Seifert  Let Me Answer That For You  USENIX Security '13 30</p>
    <p>Questions?</p>
    <p>Demonstration videos are available: https://www.youtube.com/watch?v=oep3zpY6cvE https://www.youtube.com/watch?v=4umb2P-93BQ</p>
    <p>(Uncleaned) source code available: http://tinyurl.com/fun-with-paging (Apply on osmocom changeset 4f0acac4c1fa538082f54cb14bef0841aa9c8abb)</p>
    <p>Mail: nico@sec.t-labs.tu-berlin.de kredon@sec.t-labs.tu-berlin.de</p>
    <p>Twitter: @iamnion</p>
    <p>Disclaimer: don't do this at home or only with your own SIM cards!</p>
  </div>
  <div class="page">
    <p>Golde, Redon, Seifert  Let Me Answer That For You  USENIX Security '13 31</p>
    <p>Countermeasures</p>
    <p>100% MT authentication: prevents hijacking</p>
    <p>Use A5/3: prevents hijacking</p>
    <p>Refresh TMSI: prevents targeted DoS</p>
    <p>Wait for authentication before assigning MT service: removes race condition</p>
    <p>Use authenticated paging: removes race condition</p>
  </div>
  <div class="page">
    <p>Golde, Redon, Seifert  Let Me Answer That For You  USENIX Security '13 32</p>
    <p>TMSI distribution</p>
    <p>O bs</p>
    <p>er ve</p>
    <p>rd T</p>
    <p>M S</p>
    <p>Is</p>
    <p>Byte value in hexadecimal</p>
    <p>O bs</p>
    <p>er ve</p>
    <p>d T</p>
    <p>M S</p>
    <p>Is</p>
    <p>Byte value in hexadecimal</p>
    <p>O b</p>
    <p>se rv</p>
    <p>e d</p>
    <p>T M</p>
    <p>S Is</p>
    <p>Byte value in hexademical</p>
    <p>O b</p>
    <p>se rv</p>
    <p>e d</p>
    <p>T M</p>
    <p>S Is</p>
    <p>Byte value in hexadecimal</p>
    <p>byte 0 byte 1</p>
    <p>byte 2 byte 3</p>
  </div>
  <div class="page">
    <p>Golde, Redon, Seifert  Let Me Answer That For You  USENIX Security '13 33</p>
    <p>TMSI distribution (cont.)</p>
    <p>C um</p>
    <p>ul at</p>
    <p>iv e</p>
    <p>pr ob</p>
    <p>ab ili</p>
    <p>ty</p>
    <p>Byte value in hexadecimal</p>
    <p>LSB byte value distribution uniform distribution</p>
    <p>byte 0</p>
  </div>
</Presentation>
