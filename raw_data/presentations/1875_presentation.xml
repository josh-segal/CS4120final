<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>On The [Ir]relevance of Network Performance for Data Processing</p>
    <p>Animesh Trivedi, Patrick Stuedi, Jonas Pfefferle, Radu Stoica, Bernard Metzler, Ioannis Koltsidas,</p>
    <p>Nikolas Ioannou</p>
    <p>IBM Research, Zurich</p>
  </div>
  <div class="page">
    <p>The 8th USENIX Workshop on Hot Topics in Cloud Computing (HotCloud '16) 2</p>
    <p>How [Ir]relevant is the Network?</p>
  </div>
  <div class="page">
    <p>The 8th USENIX Workshop on Hot Topics in Cloud Computing (HotCloud '16) 3</p>
    <p>How [Ir]relevant is the Network?</p>
  </div>
  <div class="page">
    <p>The 8th USENIX Workshop on Hot Topics in Cloud Computing (HotCloud '16) 4</p>
    <p>How [Ir]relevant is the Network?</p>
    <p>TeraSort PageRank SQL WordCount GroupBy 0</p>
    <p>R u</p>
    <p>n ti</p>
    <p>m e</p>
    <p>in s</p>
    <p>e cs</p>
  </div>
  <div class="page">
    <p>The 8th USENIX Workshop on Hot Topics in Cloud Computing (HotCloud '16) 5</p>
    <p>How [Ir]relevant is the Network?</p>
    <p>TeraSort PageRank SQL WordCount GroupBy 0</p>
    <p>R u</p>
    <p>n ti</p>
    <p>m e</p>
    <p>in s</p>
    <p>e cs</p>
  </div>
  <div class="page">
    <p>The 8th USENIX Workshop on Hot Topics in Cloud Computing (HotCloud '16) 6</p>
    <p>How [Ir]relevant is the Network?</p>
    <p>TeraSort PageRank SQL WordCount GroupBy 0</p>
    <p>Network IO is very relevant - up to 64%</p>
    <p>R u</p>
    <p>n ti</p>
    <p>m e</p>
    <p>in s</p>
    <p>e cs</p>
  </div>
  <div class="page">
    <p>The 8th USENIX Workshop on Hot Topics in Cloud Computing (HotCloud '16) 7</p>
    <p>How [Ir]relevant is the Network?</p>
    <p>TeraSort PageRank SQL WordCount GroupBy 0</p>
    <p>Network IO is very relevant - up to 64% ??</p>
    <p>R u</p>
    <p>n ti</p>
    <p>m e</p>
    <p>in s</p>
    <p>e cs</p>
  </div>
  <div class="page">
    <p>The 8th USENIX Workshop on Hot Topics in Cloud Computing (HotCloud '16) 8</p>
    <p>Is It Spark Specific?</p>
    <p>Flink-TS Flink-PR GraphLab Timely 0</p>
    <p>R u</p>
    <p>n ti</p>
    <p>m e</p>
    <p>in s</p>
    <p>e cs</p>
  </div>
  <div class="page">
    <p>The 8th USENIX Workshop on Hot Topics in Cloud Computing (HotCloud '16) 9</p>
    <p>Spark TeraSort: The Shuffle Story</p>
    <p>outputinput</p>
    <p>distributed sorting</p>
    <p>- simple - shuffle data is input data - highest chance of improvements</p>
  </div>
  <div class="page">
    <p>The 8th USENIX Workshop on Hot Topics in Cloud Computing (HotCloud '16) 10</p>
    <p>Spark TeraSort: The Shuffle Story</p>
    <p>Shuffle data</p>
    <p>Reduce tasks</p>
    <p>output</p>
    <p>Map tasks</p>
    <p>Cores</p>
    <p>input</p>
  </div>
  <div class="page">
    <p>The 8th USENIX Workshop on Hot Topics in Cloud Computing (HotCloud '16) 11</p>
    <p>Spark TeraSort: The Shuffle Story</p>
    <p>Shuffle data</p>
    <p>Reduce tasks</p>
    <p>output</p>
    <p>net</p>
    <p>net</p>
    <p>net</p>
    <p>reading in shuffle data</p>
    <p>Cores</p>
    <p>input</p>
    <p>Map tasks</p>
  </div>
  <div class="page">
    <p>The 8th USENIX Workshop on Hot Topics in Cloud Computing (HotCloud '16) 12</p>
    <p>Spark TeraSort: The Shuffle Story</p>
    <p>Shuffle data</p>
    <p>Reduce tasks</p>
    <p>output</p>
    <p>net CPU</p>
    <p>net CPU</p>
    <p>net CPU</p>
    <p>reading in shuffle data</p>
    <p>sorting shuffle data</p>
    <p>Cores</p>
    <p>input</p>
    <p>Map tasks</p>
  </div>
  <div class="page">
    <p>The 8th USENIX Workshop on Hot Topics in Cloud Computing (HotCloud '16) 13</p>
    <p>Spark TeraSort: The Shuffle Story</p>
    <p>Shuffle data</p>
    <p>Reduce tasks</p>
    <p>output</p>
    <p>net CPU</p>
    <p>net CPU</p>
    <p>net CPU</p>
    <p>reading in shuffle data</p>
    <p>sorting shuffle data</p>
    <p>performance</p>
    <p>Cores</p>
    <p>input</p>
    <p>Map tasks</p>
  </div>
  <div class="page">
    <p>The 8th USENIX Workshop on Hot Topics in Cloud Computing (HotCloud '16) 14</p>
    <p>How Important is the Network?</p>
    <p>CPU Network</p>
    <p>Gains from the networks are shadowed by the high CPU footprint</p>
  </div>
  <div class="page">
    <p>The 8th USENIX Workshop on Hot Topics in Cloud Computing (HotCloud '16) 15</p>
    <p>How Important is the Network?</p>
    <p>CPU Network</p>
    <p>Gains from the networks are shadowed by the high CPU footprint</p>
  </div>
  <div class="page">
    <p>The 8th USENIX Workshop on Hot Topics in Cloud Computing (HotCloud '16) 16</p>
    <p>How Important is the Network?</p>
    <p>CPU Network</p>
    <p>Gains from the networks are shadowed by the high CPU footprint</p>
  </div>
  <div class="page">
    <p>The 8th USENIX Workshop on Hot Topics in Cloud Computing (HotCloud '16) 17</p>
    <p>How Important is the Network?</p>
    <p>CPU Network</p>
    <p>Gains from the networks are shadowed by the high CPU footprint</p>
  </div>
  <div class="page">
    <p>The 8th USENIX Workshop on Hot Topics in Cloud Computing (HotCloud '16) 18</p>
    <p>How Important is the Network?</p>
    <p>CPU Network</p>
    <p>Gains from the networks are shadowed by the high CPU footprint</p>
    <p>Network gains are shadowed by the CPU</p>
  </div>
  <div class="page">
    <p>The 8th USENIX Workshop on Hot Topics in Cloud Computing (HotCloud '16) 19</p>
    <p>What Exactly is the CPU Doing?</p>
    <p>Map Reduce 0%</p>
    <p>Misc. Iterator Serialization Sorting IO JVM Linux</p>
    <p>S p</p>
    <p>a rk</p>
  </div>
  <div class="page">
    <p>The 8th USENIX Workshop on Hot Topics in Cloud Computing (HotCloud '16) 20</p>
    <p>What Exactly is the CPU Doing?</p>
    <p>Map Reduce 0%</p>
    <p>Misc. Iterator Serialization Sorting IO JVM Linux</p>
    <p>S p</p>
    <p>a rk</p>
  </div>
  <div class="page">
    <p>The 8th USENIX Workshop on Hot Topics in Cloud Computing (HotCloud '16) 21</p>
    <p>What Exactly is the CPU Doing?</p>
    <p>Map Reduce 0%</p>
    <p>Misc. Iterator Serialization Sorting IO JVM Linux</p>
    <p>Overheads are spread across the entire stack - serialization, abstration, execution model etc.</p>
    <p>S p</p>
    <p>a rk</p>
  </div>
  <div class="page">
    <p>The 8th USENIX Workshop on Hot Topics in Cloud Computing (HotCloud '16) 22</p>
    <p>The Balancing Act: CPU vs Network</p>
  </div>
  <div class="page">
    <p>The 8th USENIX Workshop on Hot Topics in Cloud Computing (HotCloud '16) 23</p>
    <p>The Balancing Act: CPU vs Network</p>
    <p>I. Balance out the CPU</p>
    <p>with the network time</p>
    <p>Sorting : O(nlog(n)) Network: O(n)</p>
    <p>use smaller 'n'</p>
  </div>
  <div class="page">
    <p>The 8th USENIX Workshop on Hot Topics in Cloud Computing (HotCloud '16) 24</p>
    <p>The Balancing Act: CPU vs Network</p>
    <p>I. Balance out the CPU</p>
    <p>with the network time</p>
    <p>Smaller Partitions</p>
    <p>R u</p>
    <p>n ti</p>
    <p>m e</p>
    <p>( se</p>
    <p>cs )</p>
  </div>
  <div class="page">
    <p>The 8th USENIX Workshop on Hot Topics in Cloud Computing (HotCloud '16) 25</p>
    <p>The Balancing Act: CPU vs Network</p>
    <p>I. Balance out the CPU</p>
    <p>with the network time</p>
    <p>Smaller Partitions</p>
    <p>R u</p>
    <p>n ti</p>
    <p>m e</p>
    <p>( se</p>
    <p>cs )</p>
  </div>
  <div class="page">
    <p>The 8th USENIX Workshop on Hot Topics in Cloud Computing (HotCloud '16) 26</p>
    <p>The Balancing Act: CPU vs Network</p>
    <p>I. Balance out the CPU</p>
    <p>with the network time</p>
    <p>Smaller Partitions</p>
    <p>R u</p>
    <p>n ti</p>
    <p>m e</p>
    <p>( se</p>
    <p>cs )</p>
  </div>
  <div class="page">
    <p>The 8th USENIX Workshop on Hot Topics in Cloud Computing (HotCloud '16) 27</p>
    <p>The Balancing Act: CPU vs Network</p>
    <p>II. Use more cores to</p>
    <p>scale up</p>
    <p>if a single core cannot do 40 Gbps</p>
    <p>then use more</p>
    <p>Needs a more careful analysis of at the entire stack</p>
    <p>I. Balance out the CPU</p>
    <p>with the network time</p>
    <p>Smaller Partitions</p>
    <p>R u</p>
    <p>n ti</p>
    <p>m e</p>
    <p>( se</p>
    <p>cs )</p>
  </div>
  <div class="page">
    <p>The 8th USENIX Workshop on Hot Topics in Cloud Computing (HotCloud '16) 28</p>
    <p>The Balancing Act: CPU vs Network</p>
    <p>II. Use more cores to</p>
    <p>scale up</p>
    <p>Number of cores</p>
    <p>ideal measured</p>
    <p>B a</p>
    <p>n d</p>
    <p>w id</p>
    <p>th (</p>
    <p>G b</p>
    <p>p s)</p>
    <p>I. Balance out the CPU</p>
    <p>with the network time</p>
    <p>Smaller Partitions</p>
    <p>R u</p>
    <p>n ti</p>
    <p>m e</p>
    <p>( se</p>
    <p>cs )</p>
  </div>
  <div class="page">
    <p>The 8th USENIX Workshop on Hot Topics in Cloud Computing (HotCloud '16) 29</p>
    <p>The Balancing Act: CPU vs Network</p>
    <p>II. Use more cores to</p>
    <p>scale up</p>
    <p>Number of cores</p>
    <p>ideal measured</p>
    <p>B a</p>
    <p>n d</p>
    <p>w id</p>
    <p>th (</p>
    <p>G b</p>
    <p>p s)</p>
    <p>I. Balance out the CPU</p>
    <p>with the network time</p>
    <p>Smaller Partitions</p>
    <p>R u</p>
    <p>n ti</p>
    <p>m e</p>
    <p>( se</p>
    <p>cs )</p>
  </div>
  <div class="page">
    <p>The 8th USENIX Workshop on Hot Topics in Cloud Computing (HotCloud '16) 30</p>
    <p>The Balancing Act: CPU vs Network</p>
    <p>II. Use more cores to</p>
    <p>scale up</p>
    <p>Number of cores</p>
    <p>ideal measured</p>
    <p>B a</p>
    <p>n d</p>
    <p>w id</p>
    <p>th (</p>
    <p>G b</p>
    <p>p s)</p>
    <p>I. Balance out the CPU</p>
    <p>with the network time</p>
    <p>Smaller Partitions</p>
    <p>R u</p>
    <p>n ti</p>
    <p>m e</p>
    <p>( se</p>
    <p>cs )</p>
  </div>
  <div class="page">
    <p>The 8th USENIX Workshop on Hot Topics in Cloud Computing (HotCloud '16) 31</p>
    <p>The Balancing Act: CPU vs Network</p>
    <p>II. Use more cores to</p>
    <p>scale up</p>
    <p>Number of cores R</p>
    <p>u n</p>
    <p>ti m</p>
    <p>e (</p>
    <p>se cs</p>
    <p>)</p>
    <p>I. Balance out the CPU</p>
    <p>with the network time</p>
    <p>Smaller Partitions</p>
    <p>R u</p>
    <p>n ti</p>
    <p>m e</p>
    <p>( se</p>
    <p>cs )</p>
  </div>
  <div class="page">
    <p>The 8th USENIX Workshop on Hot Topics in Cloud Computing (HotCloud '16) 32</p>
    <p>The Balancing Act: CPU vs Network</p>
    <p>II. Use more cores to</p>
    <p>scale up</p>
    <p>Number of cores R</p>
    <p>u n</p>
    <p>ti m</p>
    <p>e (</p>
    <p>se cs</p>
    <p>)</p>
    <p>I. Balance out the CPU</p>
    <p>with the network time</p>
    <p>Smaller Partitions</p>
    <p>R u</p>
    <p>n ti</p>
    <p>m e</p>
    <p>( se</p>
    <p>cs )</p>
    <p>_____ cores</p>
    <p>runtime = 9 +</p>
  </div>
  <div class="page">
    <p>The 8th USENIX Workshop on Hot Topics in Cloud Computing (HotCloud '16) 33</p>
    <p>The Balancing Act: CPU vs Network</p>
    <p>II. Use more cores to</p>
    <p>scale up</p>
    <p>Classical techniques are ineffective</p>
    <p>I. Balance out the CPU</p>
    <p>with the network time</p>
    <p>Smaller Partitions</p>
    <p>R u</p>
    <p>n ti</p>
    <p>m e</p>
    <p>( se</p>
    <p>cs )</p>
    <p>Number of cores 1 2 4 8 16</p>
    <p>R u</p>
    <p>n ti</p>
    <p>m e</p>
    <p>( se</p>
    <p>cs )</p>
  </div>
  <div class="page">
    <p>The 8th USENIX Workshop on Hot Topics in Cloud Computing (HotCloud '16) 34</p>
    <p>Conclusion Faster networks (IO) are very relevant  as long as you have CPU cycles  differentiate between user vs framework CPU usage</p>
    <p>Framework's CPU usage is bad  CPU-network imbalance : sorting, serialization, volcano</p>
    <p>execution model, etc.  scalability (serial vs parallel components)  ineffective classical balancing techniques</p>
    <p>Knowing today's usec-era IO and CPU hardware, how would you re-design modern data processing framework?</p>
  </div>
  <div class="page">
    <p>The 8th USENIX Workshop on Hot Topics in Cloud Computing (HotCloud '16) 35</p>
    <p>Conclusion Faster networks (IO) are very relevant  as long as you have CPU cycles  differentiate between user vs framework CPU usage</p>
    <p>Framework's CPU usage is bad  CPU-network imbalance : sorting, serialization, volcano</p>
    <p>execution model, etc.  scalability (serial vs parallel components)  ineffective classical balancing techniques</p>
    <p>Knowing today's usec-era IO and CPU hardware, how would you re-design modern data processing framework?</p>
  </div>
  <div class="page">
    <p>The 8th USENIX Workshop on Hot Topics in Cloud Computing (HotCloud '16) 36</p>
    <p>Conclusion Faster networks (IO) are very relevant  as long as you have CPU cycles  differentiate between user vs framework CPU usage</p>
    <p>Framework's CPU usage is bad  CPU-network imbalance : sorting, serialization, volcano</p>
    <p>execution model, etc.  scalability (serial vs parallel components)  ineffective classical balancing techniques</p>
    <p>Knowing today's usec-era IO and CPU hardware, how would you re-design modern data processing framework?</p>
  </div>
</Presentation>
