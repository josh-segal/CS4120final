<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>The FuzzyLog: A Partially Ordered Shared Log</p>
    <p>Joshua Lockerman, Jose M. Faleiro, Juno Kim, Soham Sankaran Daniel J. Abadi, James Aspnes, Siddhartha Sen, Mahesh Balakrishnan</p>
    <p>Yale University UC Berkeley UC San Diego Cornell University University of Maryland College Park Microsoft Research Facebook</p>
    <p>(work done at Yale University)</p>
  </div>
  <div class="page">
    <p>consistency  durability  scalability  availability</p>
    <p>distributing state</p>
    <p>complex systems!</p>
  </div>
  <div class="page">
    <p>shared log  simple systems</p>
    <p>A B C D</p>
    <p>sequencer</p>
    <p>replicated state</p>
    <p>updates in shared log</p>
  </div>
  <div class="page">
    <p>shared log  simple systems</p>
    <p>consistency durability  scalability  availability (network partitions) A B C D</p>
    <p>sequencer</p>
    <p>replicated state</p>
    <p>updates in shared log</p>
  </div>
  <div class="page">
    <p>applications are partially ordered</p>
    <p>Database</p>
    <p>A lic e</p>
  </div>
  <div class="page">
    <p>Database</p>
    <p>A lic e</p>
    <p>Bo b</p>
    <p>applications are partially ordered</p>
  </div>
  <div class="page">
    <p>Database A lic e</p>
    <p>Bo b</p>
    <p>Bo b*</p>
    <p>USA Asia</p>
    <p>applications are partially ordered</p>
    <p>can we provide the simplicity of a shared log without imposing a total order?</p>
  </div>
  <div class="page">
    <p>two sources of partial order</p>
    <p>data shards</p>
    <p>geo-replication 8</p>
    <p>Database</p>
    <p>A lic e</p>
    <p>Bo b</p>
    <p>Bo b*</p>
    <p>USA Asia</p>
  </div>
  <div class="page">
    <p>FuzzyLog  a partially ordered log</p>
    <p>J K</p>
    <p>B D H</p>
    <p>C</p>
    <p>I</p>
    <p>A G J</p>
    <p>E</p>
    <p>D at ab as e Alice</p>
    <p>Bob</p>
    <p>Bob*</p>
  </div>
  <div class="page">
    <p>outline</p>
    <p>abstraction  applications  implementation  evaluation</p>
  </div>
  <div class="page">
    <p>one color per data shard</p>
    <p>A B DC</p>
    <p>D at ab as e</p>
    <p>Bob</p>
    <p>reading</p>
    <p>appending</p>
  </div>
  <div class="page">
    <p>one color per data shard</p>
    <p>A B DC</p>
    <p>H I KJ</p>
    <p>QD at ab as e</p>
    <p>Alice</p>
    <p>Bob</p>
    <p>multi-color appendappending</p>
  </div>
  <div class="page">
    <p>each color is in multiple regions</p>
    <p>A B</p>
    <p>E</p>
    <p>J</p>
    <p>F</p>
    <p>CUSA</p>
    <p>Asia</p>
    <p>geo-replication</p>
  </div>
  <div class="page">
    <p>void append(colors, data);</p>
    <p>B D H</p>
    <p>C</p>
    <p>I</p>
    <p>A G</p>
    <p>E</p>
    <p>USA</p>
    <p>Asia</p>
  </div>
  <div class="page">
    <p>D</p>
    <p>void sync(callback);</p>
    <p>B D H</p>
    <p>C</p>
    <p>I</p>
    <p>A G</p>
    <p>E</p>
    <p>B</p>
    <p>EC</p>
    <p>H D I</p>
    <p>B D H C E I D B H I E C</p>
    <p>USA</p>
    <p>Asia</p>
  </div>
  <div class="page">
    <p>recap: the FuzzyLog API</p>
    <p>append a node to one or more colors  each color is totally ordered within a region  each color is causally ordered across regions.</p>
    <p>sync nodes in a single color  nodes are seen in log-order</p>
  </div>
  <div class="page">
    <p>outline</p>
    <p>abstraction  applications  implementation  evaluation</p>
  </div>
  <div class="page">
    <p>applications</p>
    <p>transactions: AtomicMap</p>
    <p>best-effort consistency: CAPMap</p>
  </div>
  <div class="page">
    <p>AtomicMap: write-only tx TX: Alice = $5</p>
    <p>Bob = $0</p>
    <p>D at ab as e</p>
    <p>Alice</p>
    <p>Bob</p>
  </div>
  <div class="page">
    <p>Bob has $5 Alice has $0</p>
    <p>AtomicMap: read-write tx</p>
    <p>$</p>
    <p>$</p>
    <p>Alice had $5</p>
    <p>Transfer Alices money to Bob</p>
    <p>D at ab as e</p>
    <p>Alice</p>
    <p>Bob</p>
  </div>
  <div class="page">
    <p>applications</p>
    <p>transactions: AtomicMap</p>
    <p>best-effort consistency: CAPMap</p>
  </div>
  <div class="page">
    <p>Asia</p>
    <p>USA</p>
    <p>CAPMap: best-effort consistency</p>
  </div>
  <div class="page">
    <p>CAPMap: best-effort consistency</p>
    <p>Asia</p>
    <p>USA</p>
  </div>
  <div class="page">
    <p>CAPMap: best-effort consistency</p>
    <p>Asia</p>
    <p>USA</p>
  </div>
  <div class="page">
    <p>outline</p>
    <p>abstraction  applications  implementation  evaluation</p>
  </div>
  <div class="page">
    <p>implementation</p>
    <p>single region</p>
    <p>multiple regions</p>
  </div>
  <div class="page">
    <p>FuzzyLog implementation</p>
    <p>FuzzyLog storage servers</p>
    <p>application servers</p>
    <p>Chain Replication</p>
  </div>
  <div class="page">
    <p>FuzzyLog mechanism: multi-appends</p>
    <p>application servers</p>
    <p>FuzzyLog storage servers</p>
    <p>Chain Replication</p>
  </div>
  <div class="page">
    <p>FuzzyLog mechanism: multi-appends</p>
    <p>Server 1</p>
    <p>Client B</p>
    <p>Client A</p>
  </div>
  <div class="page">
    <p>FuzzyLog mechanism: multi-appends</p>
    <p>Phase 1</p>
    <p>Server 1</p>
    <p>Client B</p>
    <p>Client A</p>
  </div>
  <div class="page">
    <p>FuzzyLog mechanism: multi-appends</p>
    <p>Phase 1</p>
    <p>Server 1</p>
    <p>Client B</p>
    <p>Client A</p>
  </div>
  <div class="page">
    <p>FuzzyLog mechanism: multi-appends</p>
    <p>Phase 1</p>
    <p>Server 1</p>
    <p>Client B</p>
    <p>Client A</p>
  </div>
  <div class="page">
    <p>FuzzyLog mechanism: multi-appends</p>
    <p>Phase 1</p>
    <p>Max = 13</p>
    <p>Max = 12</p>
    <p>Server 1</p>
    <p>Client B</p>
    <p>Client A</p>
  </div>
  <div class="page">
    <p>FuzzyLog mechanism: multi-appends</p>
    <p>Phase 1</p>
    <p>Max = 13</p>
    <p>Max = 12</p>
    <p>Server 1</p>
    <p>Client B</p>
    <p>Client A</p>
    <p>multi-appends are assigned unique timestamps.</p>
  </div>
  <div class="page">
    <p>FuzzyLog mechanism: multi-appends</p>
    <p>Phase 2</p>
    <p>Max = 13</p>
    <p>Max = 12</p>
    <p>Phase 1</p>
    <p>Server 1</p>
    <p>Client B</p>
    <p>Client A</p>
    <p>the FuzzyLog supports atomic multi-appends without a centralized sequencer.</p>
  </div>
  <div class="page">
    <p>implementation</p>
    <p>single region</p>
    <p>multiple regions</p>
  </div>
  <div class="page">
    <p>FuzzyLog mechanism: shadow logs</p>
    <p>B</p>
    <p>USA</p>
    <p>Asia</p>
    <p>A</p>
    <p>A</p>
  </div>
  <div class="page">
    <p>FuzzyLog mechanism: shadow logs</p>
    <p>BAsia</p>
    <p>USA A</p>
    <p>A</p>
    <p>C</p>
  </div>
  <div class="page">
    <p>outline</p>
    <p>abstraction  applications  implementation  evaluation</p>
  </div>
  <div class="page">
    <p>M s of pu ts /s ec</p>
    <p>Workload (% of multi-shard puts)</p>
    <p># of AtomicMap / Dapple servers = 1 / 8 2 / 8 4 / 8 8 / 8</p>
    <p># of clients</p>
    <p>AtomicMap performance</p>
  </div>
  <div class="page">
    <p>primary puts</p>
    <p>secondary puts</p>
    <p>primary gets</p>
    <p>secondary gets</p>
    <p>L at en cy (m s)</p>
    <p>Time Elapsed (ms)</p>
    <p>La te nc y</p>
    <p>Time</p>
    <p>CAPMap performance</p>
  </div>
  <div class="page">
    <p>other applications</p>
    <p>transactions: AtomicMap</p>
    <p>best-effort consistency: CAPMap</p>
    <p>RedBlue</p>
    <p>CRDTs</p>
    <p>transactional CRDTs</p>
    <p>FuzzyZookeeper</p>
  </div>
  <div class="page">
    <p>conclusion</p>
    <p>a shared log simplifies distributed systems but imposes a total order  the FuzzyLog is a partially ordered shared log:  data sharding  geo-replication</p>
    <p>we obtain the simplicity of the shared log approach without its limitations!</p>
  </div>
  <div class="page">
    <p>Thank You!</p>
    <p>Mossy Log by Shawn Harquail used under CC BY-NC</p>
    <p>Globes from: https://visualpharm.com/free-icons/globe-595b40b65ba036ed117d2d7e https://visualpharm.com/free-icons/globe%20asia-595b40b65ba036ed117d2d7f</p>
  </div>
</Presentation>
