<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>RFDump: An Architecture for Monitoring the Wireless Ether</p>
    <p>Kaushik Lakshminarayanan Samir Sapra</p>
    <p>Srinivasan Seshan Peter Steenkiste</p>
    <p>Carnegie Mellon University</p>
  </div>
  <div class="page">
    <p>Popularity causes crowding</p>
    <p>Wireless  2.4 GHz ISM band  Unlicensed 802.11, Bluetooth, ZigBee, Microwave oven</p>
    <p>Packet ACKPacket</p>
    <p>How do we troubleshoot such problems?</p>
    <p>PacketPacket Packet</p>
  </div>
  <div class="page">
    <p>Tcpdump, Ethereal</p>
    <p>Wired networks</p>
    <p>How do existing sniffers work?</p>
    <p>Physical Data Link Network Transport</p>
    <p>Session Presentation</p>
    <p>Application</p>
    <p>Sniffers 802.11+BT+microwave+..</p>
    <p>Data Link Network Transport Session</p>
    <p>Presentation Application</p>
    <p>?</p>
    <p>How do we bootstrap</p>
    <p>in wireless?</p>
    <p>NIC 802.11 PHY 802.11 MAC</p>
    <p>Network Transport Session</p>
    <p>Presentation</p>
    <p>Application</p>
    <p>tcpdump 802.11 NIC</p>
  </div>
  <div class="page">
    <p>Multi-dongle approach</p>
    <p>Cumbersome  Sniffers dont expose physical layer information  Dont capture inter-protocol interactions</p>
    <p>ZigBee</p>
    <p>Bluetooth</p>
    <p>How do we enable such fine-grained analysis?</p>
    <p>Presentation Application</p>
    <p>tcpdump 802.11 NIC BT PHY</p>
    <p>BT MAC Network Transport Session</p>
    <p>Presentation Application</p>
    <p>hcidump BluetoothNIC</p>
  </div>
  <div class="page">
    <p>Software-Defined Radio (SDR): An enabler</p>
    <p>SDR Hardware</p>
    <p>Software Analog signal</p>
    <p>Exposes physical layer</p>
    <p>information</p>
    <p>Samples</p>
    <p>Supports programmable</p>
    <p>analysis modules</p>
  </div>
  <div class="page">
    <p>SDR: Challenges</p>
    <p>SDR Hardware Software Analog signal</p>
    <p>Samples</p>
    <p>How do we process 256 Mbps of</p>
    <p>information?</p>
    <p>How to differentiate between</p>
    <p>samples?</p>
    <p>Real-time</p>
    <p>Multi-protocol, Extensibility</p>
    <p>ZigBee, Bluetooth, 802.11 or Noise</p>
  </div>
  <div class="page">
    <p>Outline</p>
    <p>Motivation Design of RFDump Implementation Evaluation</p>
  </div>
  <div class="page">
    <p>demodulator</p>
    <p>Bluetooth demodulator</p>
    <p>ZigBee demodulator</p>
    <p>SDR</p>
    <p>A nave solution: Demodulate all Protocol Extensible Real-time</p>
    <p>Demodulation is costly All demodulators process everything! How to make it more efficient? ZigBee 802.11</p>
    <p>Bluetooth Noise</p>
    <p>SDR</p>
    <p>ZigBee demodulator</p>
    <p>Bluetooth demodulator</p>
    <p>demodulator</p>
    <p>Demodulator CPU time</p>
    <p>Bluetooth 0.7x } 5 demodulators  3x</p>
  </div>
  <div class="page">
    <p>A better solution: Energy filter</p>
    <p>Demodulators do less work Only when medium utilization is very low</p>
    <p>What if medium utilization is very high Real-time</p>
    <p>Need fast demultiplexing</p>
    <p>SDR</p>
    <p>ZigBee demodulator</p>
    <p>Bluetooth demodulator</p>
    <p>demodulator</p>
    <p>Energy Filter</p>
    <p>ZigBee 802.11</p>
    <p>Bluetooth Noise</p>
  </div>
  <div class="page">
    <p>RFDump: High-level idea</p>
    <p>Fast detector  map signal to protocol Protocol extensible Real-time</p>
    <p>Detectors can be faster Can tolerate false positives Can tolerate delay</p>
    <p>ZigBee 802.11</p>
    <p>Bluetooth Noise</p>
    <p>SDR</p>
    <p>ZigBee demodulator</p>
    <p>Bluetooth demodulator</p>
    <p>demodulator</p>
    <p>Energy Filter</p>
    <p>Fast detector</p>
  </div>
  <div class="page">
    <p>Packet MAC-level</p>
    <p>ACK</p>
    <p>SIFS Time</p>
    <p>How do we detect protocols?</p>
    <p>Timing 802.11  Interframe Space (SIFS, DIFS) Bluetooth  TDD slots</p>
    <p>Phase 802.11b 1Mbps  DBPSK Bluetooth  GMSK</p>
    <p>Frequency (Channel width) 802.11b  22 MHz Bluetooth  1 MHz</p>
    <p>Packet MAC-level ACK SIFS Time</p>
    <p>I</p>
    <p>Q</p>
    <p>I</p>
    <p>Q</p>
    <p>Frequency</p>
    <p>Constellation diagram</p>
  </div>
  <div class="page">
    <p>How to make detection fast?</p>
    <p>Protocol-agnostic Protocol-specific</p>
    <p>Peak detector</p>
    <p>Bluetooth Slot time</p>
    <p>ZigBee Slot time</p>
    <p>Light-weight 5% real-time</p>
    <p>Metadata (coarse)</p>
    <p>Start and end of frames</p>
    <p>Samples</p>
    <p>(fine)</p>
  </div>
  <div class="page">
    <p>RFDump: Putting the pieces together</p>
    <p>Fast detector</p>
    <p>SDR Energy Filter</p>
    <p>ZigBee demodulator</p>
    <p>Bluetooth demodulator</p>
    <p>demodulator</p>
    <p>Energy Filter</p>
    <p>SDR</p>
    <p>demodulator</p>
    <p>Bluetooth demodulator</p>
    <p>Peak detector</p>
    <p>Bluetooth TDD Slot</p>
    <p>QPSK</p>
    <p>DBPSK</p>
    <p>BT Filter</p>
    <p>In-depth analysis stage</p>
    <p>GFSK</p>
    <p>ZigBee Slot time</p>
    <p>demodulator</p>
    <p>ZigBee demodulator</p>
    <p>ZigBee Filter</p>
    <p>SDR Energy</p>
    <p>Filter</p>
    <p>Yes</p>
    <p>Yes</p>
    <p>M</p>
    <p>Detection stage Protocol-specificProtocol-agnostic</p>
    <p>Timing Analysis</p>
    <p>Phase Analysis</p>
  </div>
  <div class="page">
    <p>Implementation</p>
    <p>GNU Radio and USRP SDR platform</p>
    <p>Fast detectors  802.11b (1 Mbps) and Bluetooth</p>
    <p>Limited by USRP1 8MHz bandwidth</p>
  </div>
  <div class="page">
    <p>Evaluation</p>
    <p>Are the detectors accurate? Microbenchmarks (CMU wireless emulator)</p>
    <p>Do they have false positives? Traffic mix (CMU wireless emulator)</p>
    <p>Are the detectors fast? Different loads</p>
  </div>
  <div class="page">
    <p>Bluetooth detection accuracy  6000 L2CAP pings between 2 Bluetooth nodes</p>
    <p>Very accurate at high SNRs</p>
    <p>Accurate at low SNRs</p>
    <p>Good region</p>
    <p>SNR (dB)</p>
    <p>Packet Miss Rate</p>
  </div>
  <div class="page">
    <p>Traffic mix detection accuracy</p>
    <p>Bluetooth and 802.11b 1 Mbps (1000 packets)</p>
    <p>Detector Packet miss rate (%) False positive rate (%)</p>
    <p>Timing 1.8 2.4 0.07 0.7</p>
    <p>Phase 1.8 1.2 1 0.2</p>
    <p>Low packet miss rate Low false positive rate</p>
  </div>
  <div class="page">
    <p>How fast is detection? 8 demodulators for Bluetooth, 1 for 802.11</p>
    <p>Fast detection even at high loads</p>
    <p>Good region</p>
    <p>Medium Utilization (%)</p>
    <p>CPU time Real time</p>
  </div>
  <div class="page">
    <p>Related work</p>
    <p>802.11 connectivity diagnosis  ClientConduit (Mobicom 04), WiFiProfiler (MobiSys 06)</p>
    <p>802.11 performance diagnosis (Enterprise networks)  Jigsaw (SIGCOMM 06, 07), Wit (SIGCOMM 06), DAIR (NSDI 07)  MOJO (MobiSys 06)</p>
    <p>Detection  Many  recently, WhiteFi (SIGCOMM 09)</p>
    <p>SDR Performance  Sora (NSDI 09), Split-functionality approach (NSDI 09)</p>
  </div>
  <div class="page">
    <p>Summary</p>
    <p>Wireless is ubiquitous  Hard to diagnose protocol/device interactions  Built RFDump tool for monitoring</p>
    <p>Efficient (light-weight detection modules)  Accurate  Extensible (SDR)  Scalable (protocol-agnostic detection modules)</p>
  </div>
</Presentation>
