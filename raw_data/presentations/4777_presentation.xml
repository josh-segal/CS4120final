<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Design and implementation of a Routing Control</p>
    <p>Platform</p>
    <p>Matthew Caesar, Donald Caldwell, Nick Feamster, Jennifer Rexford, Aman Shaikh, Jacobus van der</p>
    <p>Merwe</p>
  </div>
  <div class="page">
    <p>How ISPs route</p>
    <p>Border router Internal router</p>
  </div>
  <div class="page">
    <p>Whats wrong with Internet routing?</p>
    <p>Full-mesh iBGP doesnt scale  # sessions, control traffic, router memory/cpu  Route-reflectors help by introducing hierarchy</p>
    <p>but introduce configuration complexity, protocol oscillations/loops</p>
    <p>Hard to manage  Many highly configurable mechanisms  Difficult to model effects of configuration changes  Hard to diagnose when things go wrong</p>
    <p>Hard to evolve  Hard to provide new services, improve upon</p>
    <p>protocols</p>
  </div>
  <div class="page">
    <p>Routing Control Platform</p>
    <p>Whats causing these problems?  Each router has limited visibility of IGP and BGP  No central point of control/observation  Resource limitations on legacy routers</p>
    <p>network</p>
    <p>RCP</p>
    <p>Solution: compute routes from central point, remove protocols from routers</p>
    <p>network network</p>
    <p>RCP Inter-AS Protocol</p>
    <p>RCP</p>
  </div>
  <div class="page">
    <p>RCP in a single ISP</p>
    <p>Better scalability: reduces load on routers  Easier management: configuration from a single</p>
    <p>point  Easier evolvability: freedom from router software</p>
    <p>RCP</p>
    <p>iBGP</p>
  </div>
  <div class="page">
    <p>RCP architecture</p>
    <p>Route Control Server (RCS)</p>
    <p>BGP Engine IGP Viewer (NSDI 04)</p>
    <p>Routing Control Platform (RCP)</p>
    <p>Available BGP routes</p>
    <p>BGP updates</p>
    <p>Selected BGP routes</p>
    <p>BGP updates</p>
    <p>Path cost matrix</p>
    <p>IGP link-state advertisements</p>
  </div>
  <div class="page">
    <p>Challenges and contributions</p>
    <p>Reliability  Problem: single point of failure  Contribution: simple replication of RCP components</p>
    <p>Consistency  Problem: inconsistent decisions by replicas  Contribution: guaranteed consistency without inter</p>
    <p>replica protocol</p>
    <p>Scalability  Problem: storing all routes increases cpu/memory</p>
    <p>usage  Contribution : can support large ISP in one computer</p>
    <p>Building this system is feasible</p>
  </div>
  <div class="page">
    <p>Potential consistency problem</p>
    <p>Need to ensure routes are consistently assigned  Even in presence of failures/partitions</p>
    <p>A B</p>
    <p>C D</p>
    <p>Use egress C (hence use A as your next-hop)</p>
    <p>Use egress D (hence use B as your next-hop)</p>
    <p>RCP 1 RCP 2</p>
  </div>
  <div class="page">
    <p>Consistent assignment Single RCP, single partition</p>
    <p>Solution: Assign all routers along the shortest IGP path the same exit router  Ensures forwarding loops dont arise</p>
    <p>RCP 1</p>
    <p>BA</p>
    <p>Use egress BUse egress A</p>
  </div>
  <div class="page">
    <p>Consistent assignment Single RCP, multiple partitions</p>
    <p>Solution: Only use state from routers partition in assigning its routes  Ensures next hop is reachable</p>
    <p>Partition 1 Partition 2</p>
    <p>RCP 1</p>
  </div>
  <div class="page">
    <p>Consistent assignment Multiple RCPs, multiple</p>
    <p>partitions</p>
    <p>Solution: RCPs receive same IGP/BGP state from each partition they can reach  IGP provides complete visibility and connectivity  RCS only acts on partition if it has complete state for it</p>
    <p>Partition 1 Partition 2 Partition 3</p>
    <p>RCP 2RCP 1</p>
    <p>No consistency protocol needed to guarantee consistency in steady state</p>
  </div>
  <div class="page">
    <p>Scalability solution</p>
    <p>Eliminate redundancy  Store only a single copy of each BGP route</p>
    <p>Accelerate lookup  Quickly find routers whose routes changed</p>
    <p>Avoid recomputation  Compute routes once for groups of routers  Dont recompute if relative ranking of egress</p>
    <p>routers unchanged</p>
  </div>
  <div class="page">
    <p>RIB-Out shadow tables</p>
    <p>P</p>
    <p>re fi</p>
    <p>x es</p>
    <p>BGP updates (to routers)</p>
    <p>(points to currently used route for each router)</p>
    <p>rtr1 rtr2 rtr3</p>
    <p>(stores copies of routes)</p>
    <p>BGP routes</p>
    <p>P</p>
    <p>re fi</p>
    <p>x es</p>
    <p>BGP updates (from egress routers)</p>
    <p>Global route table</p>
    <p>eg1</p>
    <p>eg2</p>
    <p>eg3</p>
    <p>eg1</p>
    <p>eg2</p>
    <p>eg3</p>
    <p>IGP updates</p>
    <p>(points to routes that use each egress)</p>
    <p>Egress lists</p>
    <p>rtr1 rtr2</p>
    <p>RCS data structures</p>
  </div>
  <div class="page">
    <p>Example of egress list operation</p>
    <p>A B C</p>
    <p>C</p>
    <p>A</p>
    <p>B D</p>
    <p>Ds egress list</p>
  </div>
  <div class="page">
    <p>Example of egress list operation</p>
    <p>A B C</p>
    <p>D</p>
    <p>C</p>
    <p>A</p>
    <p>B</p>
    <p>Ds egress list</p>
  </div>
  <div class="page">
    <p>Example of egress list operation</p>
    <p>A B C</p>
    <p>D</p>
    <p>A</p>
    <p>B</p>
    <p>Ds egress list</p>
  </div>
  <div class="page">
    <p>Example of egress list operation</p>
    <p>A B C</p>
    <p>D</p>
    <p>C</p>
    <p>A</p>
    <p>B</p>
    <p>Ds egress list</p>
  </div>
  <div class="page">
    <p>Performance evaluation</p>
    <p>BGP and OSPF logs from Tier-1 ISP backbone  collected on Aug 1 2004, ~500 routers</p>
    <p>Metrics: memory usage, update processing time</p>
    <p>Measurement techniques:  Whitebox (instrument code with timers)  Blackbox (workload generator on separate</p>
    <p>machine)  no-queuing (one update at a time)  real-time (allow updates to queue)</p>
    <p>3.2 Ghz P4, 4GB memory, Linux 2.6.5</p>
  </div>
  <div class="page">
    <p>Results: RCS memory usage</p>
    <p>State for entire ISP in 2.5 gigabytes</p>
  </div>
  <div class="page">
    <p>BGP change processing time</p>
    <p>All BGP updates processed within 30ms</p>
  </div>
  <div class="page">
    <p>IGP change processing time</p>
    <p>High delay due to bursty path cost changes</p>
  </div>
  <div class="page">
    <p>Towards decoupling BGP from IGP</p>
    <p>Problem: Single link change can affect many paths  Transient delay/loss, traffic shift, and eBGP updates</p>
    <p>Solution: Decouple egress point ranking and cost  Experiment: process only reachability-affecting events</p>
    <p>A B</p>
    <p>C</p>
  </div>
  <div class="page">
    <p>IGP change processing time</p>
    <p>New approach reduces processing time</p>
  </div>
  <div class="page">
    <p>Conclusions</p>
    <p>RCP improves routing  Correct, scalable route distribution  Eases management and evolvability</p>
    <p>RCP is feasible  Reliability, scalability, deployability,</p>
    <p>consistency</p>
    <p>Many open problems:  How to simplify network management  How to enable new services  RCP cooperation between ISPs</p>
  </div>
</Presentation>
