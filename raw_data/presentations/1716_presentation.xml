<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Measuring Privacy Threats in China-Wide Mobile Networks</p>
    <p>Mingming Zhang1, Baojun Liu1, Chaoyi Lu1, Jia Zhang1, Shuang Hao2 and Haixin Duan1</p>
  </div>
  <div class="page">
    <p>Background</p>
    <p>Methodology</p>
    <p>Analysis</p>
    <p>Conclusion</p>
    <p>Contents</p>
  </div>
  <div class="page">
    <p>Internet eNodeB</p>
    <p>Proxy server Carrier-Class</p>
    <p>Network Firewall</p>
    <p>ISP Network</p>
    <p>Web server</p>
    <p>Background</p>
    <p>HTTP transparent proxies  Widely deployed by mobile network operators</p>
    <p>e.g. cache servers, firewalls, NAT devices  Enhance network performance and security [Sherry, SIGCOMM12]  Violate end-to-end principle</p>
  </div>
  <div class="page">
    <p>Examples of HTTP traffic manipulations</p>
    <p>Phone Number</p>
    <p>Mobile Services (e.g., Data plan, Recharge service)</p>
    <p>Data Usage Data usage pop-up</p>
  </div>
  <div class="page">
    <p>HTTP traffic manipulation  A core area of free communication online in worldwide [Sherry, SIGCOMM12]</p>
    <p>[Weaver, PAM14] [Chung, IMC16] [Tyson, WWW17]</p>
    <p>Some transparent proxies leak private data of users and properties of devices [Weaver, SATIN11]</p>
    <p>Some transparent proxies are vulnerable to known attacks. [Vallina-Rodriguez, MobiSys15]</p>
    <p>Background</p>
    <p>HTTP transparent proxies lead to potential security and privacy issues</p>
  </div>
  <div class="page">
    <p>How is that in China-wide?</p>
    <p>How is that in cellular networks?</p>
    <p>Questions To Be Answered</p>
    <p>Our Goal</p>
    <p>Analyze the manipulation of HTTP traffic by transparent proxies</p>
    <p>From China-wide</p>
    <p>In cellular networks</p>
  </div>
  <div class="page">
    <p>Background</p>
    <p>Methodology</p>
    <p>Analysis</p>
    <p>Conclusion</p>
    <p>Contents</p>
  </div>
  <div class="page">
    <p>Methodology</p>
    <p>Identify transparent proxies</p>
    <p>Client Proxy server WEB Server</p>
  </div>
  <div class="page">
    <p>Methodology</p>
    <p>Identify transparent proxies</p>
    <p>Client Proxy server WEB Server</p>
    <p>HTTP headers injection?</p>
  </div>
  <div class="page">
    <p>Methodology</p>
    <p>Web content modification?</p>
    <p>Identify transparent proxies</p>
    <p>Client Proxy server WEB Server</p>
  </div>
  <div class="page">
    <p>Collected Dataset</p>
    <p>China-Wide Analysis</p>
    <p>A mobile network debugging tool of a security software</p>
    <p>Ethics</p>
    <p>One-time consent</p>
    <p>Request our own website</p>
    <p>Restrict traffic amount</p>
    <p>Encrypted storage</p>
  </div>
  <div class="page">
    <p>Tests Count</p>
    <p>HTTP sessions 33,439</p>
    <p>#IP 30,810</p>
    <p>Provinces 31</p>
    <p>AS 79</p>
    <p>Collected Dataset</p>
    <p>HTTP traffic originates from China-wide mobile networks</p>
    <p>Filter out invalid traffic</p>
  </div>
  <div class="page">
    <p>Collected Dataset</p>
    <p>HTTP traffic originates from China-wide mobile networks</p>
    <p>Filter invalid traffic</p>
    <p>Limitation</p>
    <p>Couldnt partition the data: cellular vs. wi-fi connectivity</p>
  </div>
  <div class="page">
    <p>Methodology</p>
    <p>Identify Manipulation  Webpage modification</p>
    <p>HTTP headers injection</p>
  </div>
  <div class="page">
    <p>Methodology</p>
    <p>Identify Manipulation  Webpage modification</p>
    <p>Hierarchical clustering</p>
    <p>Classify the similar pages</p>
  </div>
  <div class="page">
    <p>Identify Manipulation  Webpage modification</p>
    <p>Hierarchical clustering</p>
    <p>Classify the similar pages</p>
    <p>Inspecting sample pages from each cluster manually</p>
    <p>Methodology</p>
  </div>
  <div class="page">
    <p>Identify Manipulation  Webpage modification</p>
    <p>Hierarchical clustering</p>
    <p>Classify the similar pages</p>
    <p>Inspecting sample pages from each cluster manually</p>
    <p>HTTP headers injection</p>
    <p>Jaccard distance between original headers set and captured ones</p>
    <p>, = |  |</p>
    <p>|  |</p>
    <p>Methodology</p>
  </div>
  <div class="page">
    <p>Background</p>
    <p>Methodology</p>
    <p>Analysis</p>
    <p>Conclusion</p>
    <p>Contents</p>
  </div>
  <div class="page">
    <p>Scale of Traffic Manipulation</p>
    <p>HTTP session</p>
    <p>1271 sessions: injecting HTTP headers  22 sessions: modifying web contents</p>
    <p>IP address Total 30K</p>
  </div>
  <div class="page">
    <p>Scale of Traffic Manipulation</p>
    <p>Geo-Distribution (451 IPs in 30 provinces)</p>
    <p>Province # Session</p>
    <p>BJ 229</p>
    <p>HB 135</p>
    <p>JS 135</p>
    <p>JL 75</p>
    <p>HN 69</p>
    <p>SD 67</p>
    <p>GD 46</p>
    <p>SX 44</p>
    <p>Top 8 Provinces</p>
  </div>
  <div class="page">
    <p>Scale of Traffic Manipulation</p>
    <p>AS-Distribution  From three major mobile operators (China Telecom, China Unicom and China</p>
    <p>Mobile)</p>
    <p>AS #Session ISP</p>
    <p>TOP 5 ASes</p>
  </div>
  <div class="page">
    <p>Scale of Traffic Manipulation</p>
    <p>Network Operator  Top 12 operators related to HTTP traffic manipulation.</p>
    <p>90% manipulated traffic are found in networks of the top 3 ISPs.</p>
    <p>Organization QTY Organization QTY</p>
    <p>China Mobile 524 Beijing Founder Broadband Network 3 China Unicom 325 Shanghai Anchang Network Security 2 China Telecom 317 ZhengZhou GIANT Computer Network 2</p>
    <p>CNISP-Union Technology (Beijing) 15 Beijing flash newsletter cas</p>
    <p>telecommunication 1</p>
    <p>Zhejiang Taobao Network 8 BeiJing New-Billion Telecom</p>
    <p>Technology 1</p>
    <p>BeiJing Guoxin bilin Telecom Technology 4 Beijing yiantianxia Network</p>
    <p>Science&amp;Technology 1</p>
  </div>
  <div class="page">
    <p>Dataset Analysis</p>
    <p>Modification of HTML Contents  22 modified web pages from 30K samples</p>
    <p>Classification of Modified webpages</p>
    <p>Advertisement (mobile service &amp; products, online shopping) 45.5%</p>
    <p>Authentication (public Wi-Fi, gateway) 27.3%</p>
    <p>Others (fake authentication pages, 404 Error page) 27.2%</p>
  </div>
  <div class="page">
    <p>Services of mobile operators Finance &amp; stock service</p>
    <p>Products of online shops</p>
  </div>
  <div class="page"/>
  <div class="page">
    <p>Dataset Analysis</p>
    <p>Modification of HTML Contents  Who is behind the modification? (22 modified web pages)</p>
    <p>Ads 45.5%</p>
    <p>Products and services of mobile operators (e.g, roaming service, phone card)</p>
    <p>wiportal.cn wo.com.cn</p>
    <p>Alibaba Advertising China Unicom</p>
    <p>Pop-up ads and banners of online shopping products</p>
    <p>cdn.wiair.com China Telecom (Guangdong)</p>
    <p>HiChina Zhicheng Technology</p>
    <p>Alibaba Advertising</p>
    <p>Others (e.g, loan services) m.rong360.com</p>
    <p>Auth 27.3%</p>
    <p>Gateway or Public Wi-Fi zhengzhou-airport.wiportal.cn</p>
  </div>
  <div class="page">
    <p>Dataset Analysis</p>
    <p>Modification of HTTP Headers  1,271 HTTP sessions are injected with 43 types of headers</p>
    <p>These headers embed privacy data of users or devices</p>
    <p>Location</p>
    <p>IP address</p>
    <p>Device serial number (e.g., IMEI)</p>
    <p>3 categories</p>
    <p>Identify users</p>
    <p>Track users</p>
    <p>Specials types</p>
  </div>
  <div class="page">
    <p>Dataset Analysis</p>
    <p>Modification of HTTP Headers  Headers for identifying mobile users (11 kinds in total)</p>
    <p>Header Type Organization Count</p>
    <p>x-IMEI* IMEI ChinaMobile (GD) 12</p>
    <p>x-IMSI* IMSI ChinaTelecom, ChinaUnicom 6</p>
    <p>x-up-calling-line-id Phone # ChinaTelecom (SH, SN, QH, SC, XJ, GS, BJ, SD, LN, YN, NM, ZJ, AH), ChinaMobile (GD), ChinaUnicom (BJ, JL,</p>
    <p>LN) 50</p>
    <p>X-Nokia-CONNECTION_MODE Connecting mode ChinaMobile (GD) 11</p>
    <p>x-up-bear-type Communicating Type ChinaMobile (GD), ChinaTelecom(BJ, SH, SX, QH, SC, XJ,</p>
    <p>GS, YN), ChinaUnicom (BJ, NM) 122</p>
    <p>x-huawei-NetworkType* Communicating Type ChinaUnicom, ChinaTelecom 6</p>
  </div>
  <div class="page">
    <p>Dataset Analysis</p>
    <p>Modification of HTTP Headers  Headers for tracking mobile users (9 kinds in total)</p>
    <p>Header Type Organization Count</p>
    <p>X-Forwarded-For Client IP Farahoosh Dena, ChinaMobile (GD, SD), ChinaTelecom(SH,</p>
    <p>SX, SC, QH, XJ, GS), PT Telkom, ChinaUnicom (JL, LN, XJ) 139</p>
    <p>X-Nx_remoteip* Client IP ChinaTelecom (QH, SC) 3</p>
    <p>x-huawei-NASIP* Gateway</p>
    <p>configuration ChinaUnicom 5</p>
    <p>x-source-id Gateway</p>
    <p>configuration ChinaUnicom (JL, LN), ChinaMobile (GD), ChinaTelecom</p>
    <p>(SH, SN, QH, SC, XJ, YN, NM, JS) 62</p>
    <p>Cdn-Src-Ip* Client IP CNISP-Union, ChinaUnicom (LN) 24</p>
  </div>
  <div class="page">
    <p>Dataset Analysis</p>
    <p>Modification of HTTP Headers  Special header</p>
    <p>Compromised Content-Type</p>
    <p>The value of 2 sessions have been modified to probes of a vulnerability (Struts2, CVE-2017-5638).</p>
    <p>OGNL codes</p>
  </div>
  <div class="page">
    <p>Dataset Analysis</p>
    <p>Modification of HTTP Headers  Special headers</p>
    <p>Compromised Content-Type</p>
    <p>Payload += (#cmd=%s). % cmd</p>
    <p>whoami  nMaskCustomMuttMoloz</p>
  </div>
  <div class="page">
    <p>Dataset Analysis</p>
    <p>Modification of HTTP Headers  Special headers</p>
    <p>Compromised Content-Type</p>
    <p>Reason</p>
    <p>Content-Type: text/xml</p>
    <p>Content-Type: exploit code</p>
    <p>Mobile Client</p>
    <p>Proxy server</p>
    <p>Web server</p>
  </div>
  <div class="page">
    <p>Background</p>
    <p>Methodology</p>
    <p>Analysis</p>
    <p>Conclusion</p>
    <p>Contents</p>
  </div>
  <div class="page">
    <p>Conclusion</p>
    <p>Contribution</p>
    <p>A measurement study on</p>
    <p>manipulation of HTTP traffic by transparent proxies</p>
    <p>in cellular network from China-wide</p>
    <p>HTTP traffic manipulation</p>
    <p>3.86% of collected HTTP traffic are modified</p>
    <p>Two ways  web contents modification</p>
    <p>HTTP headers injection</p>
  </div>
  <div class="page">
    <p>Motivations of manipulating HTTP traffic</p>
    <p>Advertising</p>
    <p>E.g., ads injected to web pages</p>
    <p>Malicious behaviors</p>
    <p>E.g., exploit code</p>
    <p>User tracking or identifying</p>
    <p>E.g., user-related and device-related headers</p>
    <p>Conclusion</p>
  </div>
  <div class="page">
    <p>Conclusion</p>
    <p>Future work</p>
    <p>Exact location of traffic manipulation</p>
    <p>TTL limited requests</p>
    <p>In-path vs. on-path injections</p>
  </div>
  <div class="page">
    <p>Measuring Privacy Threats in China-Wide Mobile Networks</p>
    <p>Mingming Zhang, Baojun Liu1, Chaoyi Lu1, Jia Zhang1, Shuang Hao2 and Haixin Duan1</p>
    <p>zhangmm.nku@gmail.com</p>
  </div>
</Presentation>
