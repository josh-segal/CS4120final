<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>A Study of the Feasibility of Co-located App Attacks against BLE</p>
    <p>and a</p>
    <p>Large-Scale Analysis of the Current ApplicationLayer Security Landscape</p>
    <p>USENIX Security</p>
    <p>Pallavi Sivakumaran, Jorge Blasco</p>
    <p>August 14th, 2019</p>
    <p>Centre for Doctoral Training in Cyber Security Information Security Group</p>
    <p>Royal Holloway University of London</p>
  </div>
  <div class="page">
    <p>Background: Bluetooth Low Energy Data Access and Pairing</p>
  </div>
  <div class="page">
    <p>Handle Attribute Type Attribute Value</p>
    <p>A tt</p>
    <p>ri b u te</p>
    <p>s</p>
  </div>
  <div class="page">
    <p>Handle Attribute Type Attribute Value</p>
    <p>A tt</p>
    <p>ri b u te</p>
    <p>s</p>
  </div>
  <div class="page">
    <p>Read Request for Handle 0x00AD (Heart Rate Measurement)</p>
    <p>Read Response for Handle 0x00AD = 80bpm</p>
  </div>
  <div class="page"/>
  <div class="page">
    <p>Permissions</p>
    <p>Access</p>
    <p>Authentication (pairing)</p>
    <p>Authorization</p>
  </div>
  <div class="page"/>
  <div class="page">
    <p>Q1: Can an Unauthorised App Access Protected Data?</p>
  </div>
  <div class="page"/>
  <div class="page">
    <p>Co-located App Data Access Scenario #1</p>
  </div>
  <div class="page">
    <p>Connect GATT, Read Request for Handle 0x00AD</p>
    <p>Scan and Connect</p>
  </div>
  <div class="page">
    <p>Connect GATT, Read Request for Handle 0x00AD</p>
    <p>ERROR: Insufficient Authentication</p>
    <p>Scan and Connect</p>
  </div>
  <div class="page">
    <p>Pairing Exchange</p>
    <p>Connect GATT, Read Request for Handle 0x00AD</p>
    <p>ERROR: Insufficient Authentication</p>
    <p>Scan and Connect</p>
  </div>
  <div class="page">
    <p>Connect GATT, Read Request for Handle 0x00AD</p>
    <p>Pairing Exchange</p>
    <p>ERROR: Insufficient Authentication</p>
    <p>Scan and Connect</p>
    <p>Bluetooth pairing request</p>
    <p>Device</p>
    <p>TestBLE</p>
    <p>Pairing code</p>
    <p>CANCEL PAIR</p>
    <p>Bluetooth</p>
    <p>On</p>
    <p>Bluetooth pairing request</p>
    <p>Device TestBLE</p>
    <p>Pairing code</p>
    <p>CANCEL PAIR</p>
  </div>
  <div class="page">
    <p>Pairing Exchange</p>
    <p>Encrypted link</p>
    <p>Connect GATT, Read Request for Handle 0x00AD</p>
    <p>ERROR: Insufficient Authentication</p>
    <p>Scan and Connect</p>
    <p>Read/Write Request for Handle 0x00AD</p>
    <p>Response for Handle 0x00AD</p>
  </div>
  <div class="page">
    <p>Scan and Connect</p>
  </div>
  <div class="page">
    <p>Scan and Connect</p>
    <p>Link Encryption Using Stored Credentials</p>
    <p>Encrypted link</p>
    <p>Connect GATT, Read/Write Request for Handle 0x00AD</p>
    <p>Response for Handle 0x00AD</p>
  </div>
  <div class="page">
    <p>Scan and Connect</p>
    <p>Link Encryption Using Stored Credentials</p>
    <p>Encrypted link</p>
    <p>User is not aware</p>
    <p>Connect GATT, Read/Write Request for Handle 0x00AD</p>
    <p>Response for Handle 0x00AD</p>
  </div>
  <div class="page">
    <p>HAL</p>
    <p>Bluetooth Process</p>
    <p>App1 App2</p>
    <p>BLE Stack BLE Stack</p>
  </div>
  <div class="page">
    <p>HAL</p>
    <p>Bluetooth Process</p>
    <p>App1 App2</p>
    <p>BLE Stack BLE Stack</p>
  </div>
  <div class="page">
    <p>Co-located App Data Access Scenario #2</p>
  </div>
  <div class="page">
    <p>Pairing Exchange</p>
    <p>Encrypted link</p>
    <p>Scan and Connect</p>
  </div>
  <div class="page">
    <p>Get Connected Devices</p>
  </div>
  <div class="page">
    <p>Get Connected Devices</p>
    <p>Encrypted link</p>
    <p>Read/Write Request for Handle 0x00AD</p>
    <p>Response for Handle 0x00AD</p>
    <p>Opportunistic data access (not possible in Classic Bluetooth)</p>
    <p>Connect to GATT Server</p>
  </div>
  <div class="page">
    <p>Get Connected Devices</p>
    <p>Encrypted link</p>
    <p>Connect to GATT Server</p>
    <p>Read/Write Request for Handle 0x00AD</p>
    <p>Response for Handle 0x00AD</p>
    <p>No scanning required</p>
  </div>
  <div class="page">
    <p>Allow GoodApp to access your location?</p>
    <p>DENY ALLOW</p>
    <p>In st</p>
    <p>a ll</p>
    <p>t im</p>
    <p>e F</p>
    <p>ir st</p>
    <p>r u</p>
    <p>n</p>
    <p>GoodApp needs access to</p>
    <p>Bluetooth</p>
    <p>Bluetooth Admin</p>
    <p>Location</p>
    <p>Internet</p>
    <p>Google Play ACCEPT</p>
  </div>
  <div class="page">
    <p>GoodApp needs access to</p>
    <p>Bluetooth</p>
    <p>Bluetooth Admin</p>
    <p>Location</p>
    <p>Internet</p>
    <p>Google Play ACCEPT</p>
    <p>Allow GoodApp to access your location?</p>
    <p>DENY ALLOW</p>
    <p>In st</p>
    <p>a ll</p>
    <p>t im</p>
    <p>e F</p>
    <p>ir st</p>
    <p>r u</p>
    <p>n</p>
    <p>EvilApp needs access to</p>
    <p>Bluetooth</p>
    <p>Internet</p>
    <p>NFC</p>
    <p>Other</p>
    <p>Google Play ACCEPT</p>
    <p>?</p>
  </div>
  <div class="page">
    <p>Summary of unauthorised data access scenarios:</p>
    <p>Scenario #1</p>
    <p>Malicious app can access data at any time (as long as Bluetooth is on</p>
    <p>and BLE device is nearby, of course!).</p>
    <p>Malicious app requires BLUETOOTH, BLUETOOTH_ADMIN, LOCATION</p>
    <p>permissions (user may view the app as being intrusive).</p>
    <p>Scenario #2</p>
    <p>Malicious app can only access data when good app is connected.</p>
    <p>Malicious app requires only BLUETOOTH permission (activity less visible</p>
    <p>to user/app appears more benign). 29</p>
  </div>
  <div class="page">
    <p>Protecting BLE Data</p>
  </div>
  <div class="page">
    <p>HAL</p>
    <p>Bluetooth Process</p>
    <p>App1 App2</p>
    <p>BLE Stack BLE Stack</p>
  </div>
  <div class="page">
    <p>Several stakeholders</p>
    <p>Android (and other OSs)</p>
    <p>Dont allow multiple apps to share a BLE connection.</p>
    <p>Associate pairing credentials with the app that triggered pairing?</p>
    <p>Bluetooth SIG</p>
    <p>Add application layer protection+modify sensitive profiles. Flexibility?</p>
    <p>Developers</p>
    <p>Implement application-layer security</p>
    <p>Awareness? (We informed the Android Security Team and the</p>
    <p>Bluetooth SIG of the need for documentation regarding this issue.) 32</p>
  </div>
  <div class="page">
    <p>Q2: What Proportion of Devices Have End-to-End Protection for BLE Data?</p>
  </div>
  <div class="page">
    <p>Data</p>
  </div>
  <div class="page">
    <p>Firmware AnalysisAPK Analysis</p>
    <p>Data</p>
  </div>
  <div class="page">
    <p>BLECryptracer:</p>
    <p>Tool to identify the presence of cryptographically-processed</p>
    <p>BLE data.</p>
    <p>Analyses Android APKs:</p>
    <p>cryptographic libraries.</p>
  </div>
  <div class="page">
    <p>If cryptographically-processed BLE data is identified,</p>
    <p>BLECryptracer assigns the result a confidence level:</p>
    <p>High: If BLE-crypto link is identified via direct register value</p>
    <p>transfers and/or immediate method invocations.</p>
    <p>Medium: If BLE-crypto link is identified by considering</p>
    <p>abstract/interface methods and/or associated registers.</p>
    <p>Low: If crypto is identified in any instruction within any</p>
    <p>previously encountered method (originating from BLE data</p>
    <p>access call). 37</p>
  </div>
  <div class="page">
    <p>Access Tool Conf. Level</p>
    <p>App Set</p>
    <p>Detected TP FP TN FN Precision Recall F-Measure</p>
    <p>Read</p>
    <p>Amandroid</p>
    <p>N/A 92 49 44 5 10 33 90% 57% 70%</p>
    <p>BLE Cryptracer</p>
    <p>High 92 62 58 4 11 19 94% 75% 83%</p>
    <p>Med 30 11 7 4 7 12 64% 37% 47%</p>
    <p>Low 19 12 8 4 3 4 67% 67% 67%</p>
    <p>Write</p>
    <p>Amandroid</p>
    <p>N/A 92 56 49 7 8 28 88% 64% 74%</p>
    <p>BLE Cryptracer</p>
    <p>High 92 50 46 4 11 31 92% 60% 72%</p>
    <p>Med 42 22 19 3 8 12 86% 61% 72%</p>
    <p>Low 20 10 5 5 3 7 50% 42% 45%</p>
  </div>
  <div class="page">
    <p>Real-world APKs</p>
    <p>Executed against 18,929 APKs (from Androzoo) that have</p>
    <p>BLE data access calls.</p>
  </div>
  <div class="page">
    <p>BLE Reads</p>
    <p>High</p>
    <p>Medium</p>
    <p>Low</p>
    <p>None</p>
    <p>BLE Writes</p>
    <p>BLECryptracer Results</p>
  </div>
  <div class="page">
    <p>Several APKs implement BLE functionality via 3rd party</p>
    <p>libraries.</p>
    <p>Beacon, DFU, BLE helper/wrappers</p>
    <p>BLE writes: 63% APKs solely use libraries.</p>
    <p>BLE reads: 58% use only libraries.</p>
    <p>App-specific BLE data access methods less likely to</p>
    <p>incorporate crypto.</p>
  </div>
  <div class="page">
    <p>Health &amp; Fitness</p>
    <p>Lifestyle Business Travel &amp; Local</p>
    <p>Shopping Maps &amp; Navigation</p>
    <p>Medical</p>
    <p>% APKs with Cryptographically Processed BLE Data</p>
    <p>High Medium Low 42</p>
  </div>
  <div class="page">
    <p>Health &amp; Fitness</p>
    <p>Lifestyle Business Travel &amp; Local</p>
    <p>Shopping Maps &amp; Navigation</p>
    <p>Medical</p>
    <p>% APKs with Cryptographically Processed BLE Data</p>
    <p>High Medium Low 43</p>
  </div>
  <div class="page">
    <p>Cryptographical correctness (CogniCrypt)</p>
    <p>ECB or other bad mode</p>
    <p>Hardcoded keys</p>
    <p>Non-random IVs</p>
    <p>Incomplete operations</p>
  </div>
  <div class="page">
    <p>In Summary</p>
  </div>
  <div class="page">
    <p>Pairing-protected attributes on the BLE device can be</p>
    <p>read and written by any application on the Android</p>
    <p>device.</p>
    <p>Regardless of pairing method.</p>
    <p>Opportunistic data access enables malicious apps to</p>
    <p>request fewer permissions than legitimate apps.</p>
  </div>
  <div class="page">
    <p>Different stakeholders involved. Difficult to determine</p>
    <p>responsibility.</p>
    <p>Currently, security is in the hands of developers.</p>
    <p>Almost half of all BLE APKs dont protect BLE</p>
    <p>reads/writes. Also, bad crypto practices in some that do.</p>
    <p>70% of Medical apps dont protect BLE data.</p>
    <p>https://github.com/projectbtle/BLECryptracer 47</p>
  </div>
  <div class="page">
    <p>Thank You</p>
  </div>
</Presentation>
