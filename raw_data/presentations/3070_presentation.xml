<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Graviton Trusted Execution Environments on GPUs</p>
    <p>Stavros Volos, Kapil Vaswani, and Rodrigo Bruno</p>
    <p>Microsoft Research University of Lisbon</p>
  </div>
  <div class="page">
    <p>Trends in Cloud Computing</p>
    <p>Accelerators play pivotal role in cloud</p>
    <p>CPUs running out of steam due to End of Moores Law</p>
    <p>GPUs, FPGAs, custom silicon deliver 10-100x higher performance</p>
    <p>Cloud privacy important but challenging</p>
    <p>Customers operate on sensitive data (e.g., patients, transactions)</p>
    <p>Increasing frequency and sophistication of data breaches</p>
  </div>
  <div class="page">
    <p>Confidential Cloud Computing</p>
    <p>CPU</p>
    <p>Hypervisor</p>
    <p>App</p>
    <p>OS</p>
    <p>App</p>
    <p>Trusted Execution Environments (TEE)</p>
    <p>Execution isolated from privileged attackers</p>
    <p>Remote attestation for establishing trust</p>
    <p>Examples: Intel SGX, ARM TrustZone</p>
    <p>Supported by major cloud providers (e.g. Azure Confidential Computing)</p>
    <p>But, CPU TEEs cannot be used in apps that utilize accelerators</p>
    <p>Code</p>
    <p>Data</p>
  </div>
  <div class="page">
    <p>Our Proposal: Graviton</p>
    <p>Graviton: Trusted Execution Environments on GPUs</p>
    <p>Execution isolated from system software and other co-tenants</p>
    <p>Remote attestation for establishing trust</p>
    <p>Contributions</p>
    <p>Graviton architecture with minimal hardware extensions</p>
    <p>Extensions to CUDA runtime for end-to-end security</p>
    <p>Graviton implementation for demonstrating low performance overheads</p>
  </div>
  <div class="page">
    <p>Outline</p>
    <p>Introduction</p>
    <p>GPUs &amp; Threat Model</p>
    <p>Graviton</p>
    <p>Evaluation</p>
    <p>Conclusion</p>
  </div>
  <div class="page">
    <p>GPU 101: System Stack</p>
    <p>Code</p>
    <p>On-package Memory</p>
    <p>Command</p>
    <p>Processor (CP)</p>
    <p>DMA</p>
    <p>Engines</p>
    <p>C o</p>
    <p>m p</p>
    <p>u te</p>
    <p>E n g</p>
    <p>.</p>
    <p>cudaMemcpy</p>
    <p>cudaLaunch</p>
    <p>PCIe</p>
    <p>Ctrl.</p>
    <p>CPU</p>
    <p>Hypervisor</p>
    <p>PCI Bus</p>
    <p>Application</p>
    <p>Runtime</p>
    <p>GPU</p>
    <p>OS / Driver</p>
    <p>GPU engines controlled via group of commands</p>
    <p>Generated by runtime and fetched by command processor</p>
    <p>Data</p>
    <p>CORE CORE CORE CORE</p>
    <p>CORE CORE CORE CORE</p>
    <p>CORE CORE CORE CORE</p>
    <p>CORE CORE CORE CORE</p>
    <p>GPU commands</p>
  </div>
  <div class="page">
    <p>GPU 101: Execution Model</p>
    <p>CPU</p>
    <p>Hypervisor</p>
    <p>PCI Bus</p>
    <p>Application</p>
    <p>Runtime</p>
    <p>OS / Driver</p>
    <p>Contexts supported by channels</p>
    <p>Implement virtual memory abstraction</p>
    <p>Expose command queues to runtime</p>
    <p>Context</p>
    <p>Code</p>
    <p>GPU</p>
    <p>Data</p>
  </div>
  <div class="page">
    <p>Context</p>
    <p>GPU 101: Cat Classifier Example</p>
    <p>cudaMalloc1</p>
    <p>cudaMemcpy2 2</p>
    <p>Application</p>
    <p>Runtime</p>
    <p>OS / Driver</p>
    <p>CPU</p>
    <p>Hypervisor</p>
    <p>PCI Bus</p>
    <p>Code</p>
    <p>GPU</p>
    <p>Data 1</p>
    <p>MMIO</p>
  </div>
  <div class="page">
    <p>GPU 101: Tampering with Commands &amp; Data</p>
    <p>Context 1 Malicious</p>
    <p>OS</p>
  </div>
  <div class="page">
    <p>GPU 101: Violating Context Isolation</p>
    <p>Context 1 Context 2</p>
    <p>Malicious</p>
    <p>OS</p>
  </div>
  <div class="page">
    <p>Threat Model</p>
    <p>Trusted computing base</p>
    <p>GPU package including on-package memory</p>
    <p>CPU package including TEE implementation</p>
    <p>GPU runtime hosted in CPU TEE</p>
    <p>Goal: Confidentiality and integrity of computation and data</p>
    <p>Out of scope: side channels and package assembly attacks</p>
  </div>
  <div class="page">
    <p>Outline</p>
    <p>Introduction</p>
    <p>GPUs &amp; Threat Model</p>
    <p>Graviton</p>
    <p>Evaluation</p>
    <p>Conclusion</p>
  </div>
  <div class="page">
    <p>Graviton: Overview</p>
    <p>CPU</p>
    <p>Hypervisor</p>
    <p>PCI Bus</p>
    <p>Application</p>
    <p>Runtime</p>
    <p>OS / Driver</p>
    <p>Code</p>
    <p>GPU</p>
    <p>Data</p>
    <p>Hardware primitives in GPU</p>
    <p>Remote attestation for establishing trust</p>
    <p>Context isolation</p>
    <p>Secure command submission</p>
    <p>Runtime abstractions</p>
    <p>Secure memory management</p>
    <p>Secure memory copy and task launch</p>
    <p>Key concept: Redefined interface between hardware and software</p>
  </div>
  <div class="page">
    <p>MMIO</p>
    <p>Graviton: Context Isolation</p>
    <p>Protected Memory</p>
    <p>Command</p>
    <p>Processor</p>
    <p>Runtime</p>
    <p>Untrusted MemoryProtected memory</p>
    <p>Hosts VM structures, code, and data</p>
    <p>CPUs MMIO accesses are blocked</p>
    <p>Virtual memory management via CP</p>
    <p>Ensures use of protected memory</p>
    <p>Exclusive use of contexts memory resources</p>
    <p>Secure command submission</p>
    <p>Session key during context creation</p>
    <p>Only owner runtime can execute tasks</p>
    <p>c o</p>
    <p>m m</p>
    <p>a n d</p>
    <p>s</p>
    <p>Driver</p>
  </div>
  <div class="page">
    <p>Protected Memory</p>
    <p>Command</p>
    <p>Processor</p>
    <p>Runtime</p>
    <p>c o</p>
    <p>m m</p>
    <p>a n d</p>
    <p>s</p>
    <p>Driver</p>
    <p>Graviton: Secure Memory Copy</p>
    <p>Key concept</p>
    <p>Data/code plaintext only inside TEEs</p>
    <p>Data/code ciphertext outside TEE (DMA buffer)</p>
    <p>Protocol</p>
    <p>Untrusted Memory</p>
  </div>
  <div class="page">
    <p>Protected Memory</p>
    <p>Command</p>
    <p>Processor</p>
    <p>Runtime</p>
    <p>c o</p>
    <p>m m</p>
    <p>a n d</p>
    <p>s</p>
    <p>Driver</p>
    <p>Graviton: Secure Memory Copy</p>
    <p>Key concept</p>
    <p>Data/code plaintext only inside TEEs</p>
    <p>Data/code ciphertext outside TEE (DMA buffer)</p>
    <p>Protocol</p>
    <p>Secure submission of copy task</p>
    <p>Untrusted Memory</p>
  </div>
  <div class="page">
    <p>Protected Memory</p>
    <p>Command</p>
    <p>Processor</p>
    <p>Runtime</p>
    <p>c o</p>
    <p>m m</p>
    <p>a n d</p>
    <p>s</p>
    <p>Driver</p>
    <p>Graviton: Secure Memory Copy</p>
    <p>Key concept</p>
    <p>Data/code plaintext only inside TEEs</p>
    <p>Data/code ciphertext outside TEE (DMA buffer)</p>
    <p>Protocol</p>
    <p>Secure submission of copy task</p>
    <p>Secure submission for authenticated decryption</p>
    <p>Untrusted Memory</p>
  </div>
  <div class="page">
    <p>Graviton in a Nutshell</p>
    <p>On-package Memory</p>
    <p>Command</p>
    <p>Processor</p>
    <p>DMA</p>
    <p>Engines</p>
    <p>C o</p>
    <p>m p</p>
    <p>u te</p>
    <p>E n g</p>
    <p>.</p>
    <p>PCI</p>
    <p>Ctrl.</p>
    <p>CORE CORE CORE CORE</p>
    <p>CORE CORE CORE CORE</p>
    <p>CORE CORE CORE CORE</p>
    <p>CORE CORE CORE CORE</p>
    <p>Sec.</p>
    <p>Mod.</p>
    <p>Endorsement key</p>
    <p>ECDSA</p>
    <p>Blocks MMIO</p>
    <p>to Protected</p>
    <p>Memory</p>
    <p>Remote attestation</p>
    <p>VM mgmt. commands</p>
    <p>AES-GCM engineLow hardware complexity</p>
    <p>Changes limited to peripheral components</p>
    <p>No changes to CPU, GPU cores and memory</p>
    <p>Transparent to developers</p>
    <p>GPU runtime abstractions</p>
    <p>Hidden behind GPU programming model</p>
  </div>
  <div class="page">
    <p>Implementation</p>
    <p>NVIDIA GTX Titan Black</p>
    <p>2880 CUDA cores, 6GB of memory, peak performance 5.6 TFLOPS</p>
    <p>Prototype</p>
    <p>GPU runtime: secure task submission and secure memory management</p>
    <p>Device driver: address-space mgmt. command submission</p>
    <p>Hardware primitives: emulation of new commands and crypto in device driver</p>
    <p>Benchmarks: Cifar10-CNN and MNIST-autoencoder</p>
  </div>
  <div class="page">
    <p>Implications on System Performance</p>
    <p>Cifar10 MNIST BlackScholes</p>
    <p>E n d</p>
    <p>-t o</p>
    <p>-E n d</p>
    <p>R u n ti m</p>
    <p>e</p>
    <p>(N o</p>
    <p>rm a liz</p>
    <p>e d</p>
    <p>t o</p>
    <p>I n se</p>
    <p>c u re</p>
    <p>)</p>
    <p>Baseline Isolation Secure Copy</p>
    <p>Overhead correlates with ratio between computation and I/O</p>
    <p>Insecure</p>
    <p>Isolation</p>
    <p>Secure context management</p>
    <p>Secure command submission</p>
    <p>Secure copy</p>
    <p>Host-side authenticated encryption</p>
    <p>GPU-side authenticated encryption</p>
  </div>
  <div class="page">
    <p>Concluding Remarks</p>
    <p>Cloud trends in collision</p>
    <p>Confidentiality and hardware acceleration</p>
    <p>But, confidential computing restricted to CPUs</p>
    <p>Graviton: Trusted Execution Environments on GPUs</p>
    <p>Low hardware complexity</p>
    <p>Low performance overheads</p>
    <p>Hardware complexity hidden by GPU programming model</p>
  </div>
</Presentation>
