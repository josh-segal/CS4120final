<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>)</p>
    <p>Optimized Invariant Representation of Network Traffic for Detecting Unseen</p>
    <p>Malware Variants Karel Bartos</p>
    <p>(kbartos@cisco.com)</p>
    <p>Michal Sofka</p>
    <p>Vojtech Franc</p>
  </div>
  <div class="page">
    <p>Motivation  Network Security Challenges  Large variability of malicious samples</p>
    <p>100k new or modified malware samples every day</p>
    <p>Lack of labeled data (obtaining additional labels is costly)  Most of existing methods rely on signature matching or feeds  High precision  Low recall (detect only known threats)</p>
    <p>Behavior changes introduce problems when training detectors  Attackers change the behavior frequently to remain undetected</p>
  </div>
  <div class="page">
    <p>Malicious Traffic and HTTP(S)</p>
  </div>
  <div class="page">
    <p>Our Goal Build a representation of malware behavior robust to most of the modifications done by the attacker in the future:</p>
  </div>
  <div class="page">
    <p>Our Goal Build a representation of malware behavior robust to most of the modifications done by the attacker in the future:</p>
    <p>Change in malicious code, payload, obfuscation</p>
    <p>Change in hostname or server IP address</p>
    <p>Change in the intensity</p>
    <p>Change in timing</p>
    <p>Change in URL path, parameters, etc.</p>
  </div>
  <div class="page">
    <p>Input data  proxy log records P</p>
    <p>ro xy</p>
    <p>HTTP(S)</p>
    <p>Time | IP | URL | UserAgent |  2:45:00 | 54.62.37.10 | http://www.google.com | Mozilla ( |  2:45:01 | 68.62.37.10 | http://www.yahoo.com | Mozilla ( |  2:45:02 | 22.62.37.10 | http://www.cnn.com | Chrome ( |  2:45:05 | 59.62.37.10 | http://xyfsfnweinfsfe.ru | Mozilla ( |  ...</p>
    <p>One flow</p>
  </div>
  <div class="page">
    <p>Flows are Grouped into Bags BAG = Flows from one user/device to one hostname in the given time interval Contains user-hostname communication</p>
  </div>
  <div class="page">
    <p>Malware Bags</p>
    <p>Single-flow bags</p>
  </div>
  <div class="page">
    <p>Malware Bags</p>
    <p>Single-flow bags</p>
    <p>Static bags</p>
  </div>
  <div class="page">
    <p>Malware Bags</p>
    <p>Single-flow bags</p>
    <p>Static bags</p>
    <p>Dynamic bags</p>
  </div>
  <div class="page">
    <p>Malware Bags Single-flow bags</p>
    <p>Static bags</p>
    <p>Dynamic bags</p>
    <p>Flow-based Flow-based Flow-based Features:</p>
  </div>
  <div class="page">
    <p>Malware Bags Single-flow bags</p>
    <p>Static bags</p>
    <p>Dynamic bags</p>
    <p>Flow-based Flow-based</p>
    <p>Bag-based Features</p>
    <p>Flow-based Features:</p>
  </div>
  <div class="page">
    <p>Malware Changes  Example</p>
    <p>Similar of different?</p>
    <p>Network traffic of two malware bags of the same type</p>
  </div>
  <div class="page">
    <p>Flow-based features</p>
  </div>
  <div class="page">
    <p>Flow-based features</p>
    <p>Training bag Testing bag</p>
  </div>
  <div class="page">
    <p>Flow-based features</p>
    <p>Training bag Testing bag</p>
    <p>Model: 44 &lt; length(URL) &lt; 48</p>
  </div>
  <div class="page">
    <p>Flow-based features</p>
    <p>Training bag Testing bag</p>
    <p>Model: 44 &lt; length(URL) &lt; 48 missed</p>
    <p>Intuition: Flow-based features are not suitable for dynamic bags.</p>
  </div>
  <div class="page">
    <p>High Variability of Flow-based Features Normalized Entropy of Feature Values for 32 Malware Categories</p>
    <p>Features 1 2 3 4 5 6 7 8 9 10 11 12 13 14</p>
    <p>M al</p>
    <p>w ar</p>
    <p>e C</p>
    <p>at eg</p>
    <p>or ie</p>
    <p>s</p>
    <p>Features: 1  URL string 2  Thinking time 3  URL query values 4  URL path 5  Number of flows 6  SC bytes 7  Server IP 8  Hostname 9  URL path length 10  URL query names 11  URL filename 12  URL filename length 13  Number of URL query params 14  Cs bytes</p>
    <p>Yellow = high variability</p>
    <p>Categories: Asterope, Bedep, Dridex, Gamarue, InstallCore, Mudrop, MultiPlug, Poweliks, Rerdom, Ramnit, Rovnix, Sality, Tempedreve, Upatre, Vawtrak, Wowliks,</p>
  </div>
  <div class="page">
    <p>Histogram</p>
    <p>histogram</p>
  </div>
  <div class="page">
    <p>Histogram</p>
    <p>histogram</p>
  </div>
  <div class="page">
    <p>What is better?</p>
    <p>What do we want to represent?</p>
    <p>What is common across malware categories?</p>
  </div>
  <div class="page">
    <p>Asterope hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=12739868&amp;os=6.128.0.7601.18571&amp;res=41921466&amp;f=1 hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=15425581&amp;os=6.128.0.7601.18571&amp;res=41921516&amp;f=1 hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=27423103&amp;os=6.128.0.7601.18571&amp;res=41921342&amp;f=1 hxxp://194.165.16.146:8080/pgt/?ver=1.3.3753&amp;id=126&amp;r=8955018&amp;os=6.128.0.7601.18571&amp;res=41921319&amp;f=1 hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=31957678&amp;os=6.128.0.7601.18571&amp;res=41921223&amp;f=1 Click-fraud, malvertising-related botnet hxxp://directcashfunds.com/opntrk.php?tkey=024f9730e23f8553c3e5342568a70300&amp;Email=name.surname@company.com hxxp://directcashfunds.com/opntrk.php?tkey=c1b6e3d50632d4f5c0ae13a52d3c4d8d&amp;Email=name.surname@company.com hxxp://directcashfunds.com/opntrk.php?tkey=7c9a843ce18126900c46dbe4be3b6425&amp;Email=name.surname@company.com hxxp://directcashfunds.com/opntrk.php?tkey=c1b6e3d50632d4f5c0ae13a52d3c4d8d&amp;Email=name.surname@company.com hxxp://directcashfunds.com/opntrk.php?tkey=bfba7d7023220c59d06e76f0085d6573&amp;Email=name.surname@company.com DGA hxxp://uvyqifymelapuvoh.biz/s531ka.ji5 hxxp://uvyqifymelapuvoh.biz/rl59c281.x19 hxxp://uvyqifymelapuvoh.biz/seibpn6.2m0 hxxp://uvyqifymelapuvoh.biz/3854f.u17 hxxp://uvyqifymelapuvoh.biz/06hk3j.449 Dridex hxxp://27.54.174.181/8qV578&amp;$o@HU6Q6S/gz$J0l=iTTH 28%2CM/we20%3D hxxp://27.54.174.181/C4GyRx%7E@RY6x /M&amp;N=sq/bW ra4OTJ hxxp://27.54.174.181/gPvh+=GO/9RPPfk0%2CzXOYU%20/Vq8Ww/+a m%7Ez hxxp://27.54.174.181/qE0my4KIz48Cf3H8wG%7Evpz=iJ%26fqMl%24m/46JoELp=GJww%3D%26Ib+Ar.y3 iu%2D1E/sso hxxp://27.54.174.181/kv7tig2s1vslfv&amp;i &amp;/s&amp;no%2Ds83%7E%2B+ns5%2D%3F+%20&amp;1/kjx%26e8x=$.pfilr@s3j66%2D InstallCore Monetization hxxp://rp.any-file-opener.org/?pcrc=1559319553&amp;v=2.0 hxxp://utouring.net/search/q/conducing hxxp://rp.any-file-opener.org/?pcrc=1132521307&amp;v=2.0 hxxp://utouring.net/go/u/1/r/1647 hxxp://rp.any-file-opener.org/?pcrc=1123945956&amp;v=2.0 hxxp://utouring.net/go/u/0/r/2675 hxxp://rp.any-file-opener.org/?pcrc=1075608192&amp;v=2.0 hxxp://utouring.net/search/f/1/q/refiles hxxp://rp.any-file-opener.org/?pcrc=995719244&amp;v=2.0 hxxp://utouring.net/search/f/1/q/refiles Poweliks hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=nitric+oxide+side+effects&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=0 hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=weight+loss+success+stories&amp;ua=Mozilla%2F5 . . . &amp;lr=0&amp;ls=0 hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=shoulder+pain&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=2 hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=cheap+car+insurance&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=2 hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=natural+testosterone+boosters&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=2 Zeus hxxp://130.185.106.28/m/IbQFdXVjiriLva4KHeNpWCmThrJBn3f34HNwsLVVsUmLXtsumSSPe/zzXtIu9SzwjI9zKlxdE . . . 3RqvGzKN5 hxxp://130.185.106.28/m/IbQJFUVjgZn4vx4KHeNpWCmThrJBn3f34HNwsLVVsUmLfkoPaSS+S+zzXtIu9SzwjI9zKlxdE . . . 3vKwmk0oUi hxxp://130.185.106.28/m/IbQJFUVjiJwJBX4KHeNpWCmThrJBn3f34HNwsLVVsUmKH7ue2STvSkzzXtIu9SzwjI9zKlxdE . . . 3vKwmk0oUi hxxp://130.185.106.28/m/IbQNtVVji5/7Yp4KHeNpWCmThrJBn3f34HNwsLVVsUmLz4sO6YRvOjzzXtIu9SzwjI9zKlxdE . . . 3zB9057quqv hxxp://130.185.106.28/m/IbQG9VVjjSnDM94KHeNpWCmThrJBn3f34HNwsLVVsUmLXpt/+YRue8zzXtIu9SzwjI9zKlxdE . . . 6iN5mt6Tj3 Legitimate traffic hxxp://www.cnn.com/.a/1.73.0/js/vendor/usabilla.min.js hxxp://www.cnn.com/.element/ssi/auto/4.0/sect/MAIN/markets wsod expansion.html hxxp://www.cnn.com/.a/1.73.0/assets/sprite-s1dced3ff2b.png hxxp://www.cnn.com/.element/widget/video/videoapi/api/latest/js/CNNVideoBootstrapper.js hxxp://www.cnn.com/jsonp/video/nowPlayingSchedule.json?callback=nowPlayingScheduleCallbackWrapper&amp; =1422885578476 Legitimate traffic hxxp://ads.adaptv.advertising.com/a/h/7g doK40WLPMYHbkD9G2u7HSXjqzIaa7Bqhslod+u7iQl . . . &amp;context=fullUrl%3Dpandora.com hxxp://ads.adaptv.advertising.com/crossdomain.xml hxxp://ads.advertising.com/411f1e96-3bde-4d85-b17e-63749e5f0695.js hxxp://ads.advertising.com/ids/411f1e96-3bde-4d85-b17e-63749e5f0695 hxxp://ads.adaptv.advertising.com/applist?placementId=297920&amp;key=&amp;d.vw=1&amp;orgId=8656&amp;hostname=data.rtbfy.com</p>
    <p>TABLE IV: URLs of flows from selected malicious categories together with two examples of legitimate URLs (at the bottom). You can see that URLs within each malicious bag are similar to each other (as opposed to most of legitimate bags). Small non-zero variability of flow-based feature values is projected into the proposed representation with both types of histograms, which makes the representation more robust to further malware changes and variants.</p>
  </div>
  <div class="page">
    <p>What is better?</p>
    <p>What do we want to represent?</p>
    <p>What is common across malware categories?</p>
    <p>Usually parameter names and subdomains are not stable, but the URL structure usually remains the same.</p>
  </div>
  <div class="page">
    <p>Example</p>
    <p>histogram</p>
    <p>Its common for many mw categories and different from most of legitimate traffic</p>
    <p>How?</p>
  </div>
  <div class="page">
    <p>Example</p>
    <p>histogram</p>
    <p>Parallel to action recognition:</p>
    <p>Malware dynamics: Its common for many mw categories and different from most of legitimate traffic</p>
  </div>
  <div class="page">
    <p>Example</p>
    <p>histogram</p>
    <p>Action recognition can be solved with self-similarity matrix 1 image  1 flow</p>
    <p>Malware dynamics: Its common for many mw categories and different from most of legitimate traffic</p>
    <p>Parallel to action recognition: Each bag (set of mw flows) is an action of mw</p>
  </div>
  <div class="page">
    <p>Example</p>
    <p>Self-similarity matrix:</p>
    <p>This paper proposes to compute a set of similarity matrices, one for every feature. More specifically, for i-th bag Xi a perfeature self-similarity set of matrices Si = {S1i , S</p>
    <p>n i }</p>
    <p>is computed, where</p>
    <p>S</p>
    <p>k i =</p>
    <p>BBB @</p>
    <p>s</p>
    <p>k 11 s</p>
    <p>k 12 . . . s</p>
    <p>k 1m</p>
    <p>s</p>
    <p>k 21 s</p>
    <p>k 22 . . . s</p>
    <p>k 2m</p>
    <p>... s</p>
    <p>k m1 s</p>
    <p>k m2 . . . s</p>
    <p>k mm</p>
    <p>CCC A</p>
    <p>(7)</p>
    <p>and skpq = d(xpk, xqk) is a distance between feature values xpk and xqk of k-th feature. This means that the bag Xi with m samples and n features will be represented with n selfsimilarity matrices of size m  m.</p>
    <p>Such matrices can be further improved by local feature scaling described in Section IV-A. The only difference is that a single scaling factor is applied on all matrix values, since the self-similarity matrix expresses differences among all flows in a bag.</p>
    <p>C. Permutation and Size Invariance Representing bags with scaled matrices Xi and locally</p>
    <p>scaled self-similarity matrices Si achieves the scale and shift invariance. However, as there are no restrictions on the size of a bag (i.e. how many flows are included in one bag), the corresponding self-similarity matrix can be of various size. Thus, the representation should be invariant against the size of the bag - size invariance. Moreover, in highly dynamic environments, the samples may occur in a variable ordering, so the representation should be also invariant against any reordering of rows and columns - permutation invariance.</p>
    <p>The final step of the proposed transformation is the transition from the scaled matrices Xi, Si introduced in Sections IV-A and IV-B respectively. Each column (j) of matrix Xi (i.e. all bag values of a given feature) is transformed into histograms hFij with predefined number of bins. Histograms created from the columns of matrix Xi will be denoted as feature values histograms, because they carry information about the distribution of bag feature values. On the other hand, histogram hSij created from self-similarity matrix S</p>
    <p>j i 2 Si will be called</p>
    <p>feature differences histograms, as they capture inner feature variability within bag samples.</p>
    <p>Overall, i-th bag is represented as a vector hi of size 2  n  l as follows:</p>
    <p>hi = (hFi1, h S i1, h</p>
    <p>F i2, h</p>
    <p>S i2, . . . , h</p>
    <p>F in, h</p>
    <p>S in), (8)</p>
    <p>where n is the number of the original flow-based features and l is the number of bins. All histograms are scaled to have a sum of all bin values equal to one. The whole transformation from input network flows to the final feature vector is depicted in Figure 1. As you can see, two types of invariant histograms are created from values of each flow-based feature. At the end, both histograms are concatenated into the final bag representation. In the next section, a real-world example is shown to demonstrate the invariant properties of the proposed representation.</p>
    <p>web logs</p>
    <p>...</p>
    <p>vector of flow 1</p>
    <p>...</p>
    <p>...</p>
    <p>vector of flow N</p>
    <p>flow 1</p>
    <p>...</p>
    <p>flow N</p>
    <p>us er</p>
    <p>:h os</p>
    <p>tn am</p>
    <p>e</p>
    <p>feature values</p>
    <p>locally-scaled self-similarity</p>
    <p>matrix</p>
    <p>... 3</p>
    <p>feature differences histogram</p>
    <p>...</p>
    <p>ba g</p>
    <p>fe at</p>
    <p>ur e</p>
    <p>fe at</p>
    <p>ur e</p>
    <p>M</p>
    <p>...</p>
    <p>feature values histogram</p>
    <p>combined final feature vector</p>
    <p>Fig. 1: Graphical illustration of the individual steps that are needed to transform the bag (set of flows with the same user and hostname) into the proposed invariant representation. First, the bag is represented with a standard feature vector (1). Then feature values histograms of locally scaled feature values are computed for each feature separately (2). Next, the locallyscaled self-similarity matrix is computed for each feature (3) to capture inner differences. This matrix is then transformed into feature differences histogram (4), which is invariant on the number or the ordering of the samples within the bag. Finally, feature values and feature differences histograms of all features are concatenated into resulting feature vector.</p>
    <p>V. MALWARE REPRESENTATION EXAMPLE</p>
    <p>This Section illustrates how the proposed representation is calculated for two real-world examples of malicious behavior. Namely, two versions of a polymorphic malware Sality are compared. Sality [14] is a malware family that has become a dynamic and complex form of malicious infection. It utilizes polymorphic techniques to infect files of Widows machines. Signature-based systems or classifiers trained on a specific malware type often struggles with detecting new variants of this kind of malware. Note that most of the conclusions to the discussion that follows can be drawn for many other malware threats.</p>
    <p>Figure 2 shows how the two Sality samples are represented with the proposed approach. First, the input flows are grouped into two bags (one bag for each Sality sample), because all flows of each bag have the same user and the same hostname (1). For the sake of simplicity, only URLs of the corresponding flows are displayed. Next, 88 flow-based feature vectors are computed for each bag (2). To simplify illustration, we use only a single feature  URL length. After this step, each Sality sample is represented with one feature vector of flow-based values. Existing approaches use these vectors as the input for the subsequent detection methods. As we will show in Section VI, these feature values are highly variable within and across malware categories. Classification models trained with such feature values loose generalization capability. In case the first sample is in the training set, the classifier would learn that</p>
    <p>This paper proposes to compute a set of similarity matrices, one for every feature. More specifically, for i-th bag Xi a perfeature self-similarity set of matrices Si = {S1i , S</p>
    <p>n i }</p>
    <p>is computed, where</p>
    <p>S</p>
    <p>k i =</p>
    <p>BBB @</p>
    <p>s</p>
    <p>k 11 s</p>
    <p>k 12 . . . s</p>
    <p>k 1m</p>
    <p>s</p>
    <p>k 21 s</p>
    <p>k 22 . . . s</p>
    <p>k 2m</p>
    <p>... s</p>
    <p>k m1 s</p>
    <p>k m2 . . . s</p>
    <p>k mm</p>
    <p>CCC A</p>
    <p>(7)</p>
    <p>and skpq = d(xpk, xqk) is a distance between feature values xpk and xqk of k-th feature. This means that the bag Xi with m samples and n features will be represented with n selfsimilarity matrices of size m  m.</p>
    <p>Such matrices can be further improved by local feature scaling described in Section IV-A. The only difference is that a single scaling factor is applied on all matrix values, since the self-similarity matrix expresses differences among all flows in a bag.</p>
    <p>C. Permutation and Size Invariance Representing bags with scaled matrices Xi and locally</p>
    <p>scaled self-similarity matrices Si achieves the scale and shift invariance. However, as there are no restrictions on the size of a bag (i.e. how many flows are included in one bag), the corresponding self-similarity matrix can be of various size. Thus, the representation should be invariant against the size of the bag - size invariance. Moreover, in highly dynamic environments, the samples may occur in a variable ordering, so the representation should be also invariant against any reordering of rows and columns - permutation invariance.</p>
    <p>The final step of the proposed transformation is the transition from the scaled matrices Xi, Si introduced in Sections IV-A and IV-B respectively. Each column (j) of matrix Xi (i.e. all bag values of a given feature) is transformed into histograms hFij with predefined number of bins. Histograms created from the columns of matrix Xi will be denoted as feature values histograms, because they carry information about the distribution of bag feature values. On the other hand, histogram hSij created from self-similarity matrix S</p>
    <p>j i 2 Si will be called</p>
    <p>feature differences histograms, as they capture inner feature variability within bag samples.</p>
    <p>Overall, i-th bag is represented as a vector hi of size 2  n  l as follows:</p>
    <p>hi = (hFi1, h S i1, h</p>
    <p>F i2, h</p>
    <p>S i2, . . . , h</p>
    <p>F in, h</p>
    <p>S in), (8)</p>
    <p>where n is the number of the original flow-based features and l is the number of bins. All histograms are scaled to have a sum of all bin values equal to one. The whole transformation from input network flows to the final feature vector is depicted in Figure 1. As you can see, two types of invariant histograms are created from values of each flow-based feature. At the end, both histograms are concatenated into the final bag representation. In the next section, a real-world example is shown to demonstrate the invariant properties of the proposed representation.</p>
    <p>web logs</p>
    <p>...</p>
    <p>vector of flow 1</p>
    <p>...</p>
    <p>...</p>
    <p>vector of flow N</p>
    <p>flow 1</p>
    <p>...</p>
    <p>flow N</p>
    <p>us er</p>
    <p>:h os</p>
    <p>tn am</p>
    <p>e</p>
    <p>feature values</p>
    <p>locally-scaled self-similarity</p>
    <p>matrix</p>
    <p>... 3</p>
    <p>feature differences histogram</p>
    <p>...</p>
    <p>ba g</p>
    <p>fe at</p>
    <p>ur e</p>
    <p>fe at</p>
    <p>ur e</p>
    <p>M</p>
    <p>...</p>
    <p>feature values histogram</p>
    <p>combined final feature vector</p>
    <p>Fig. 1: Graphical illustration of the individual steps that are needed to transform the bag (set of flows with the same user and hostname) into the proposed invariant representation. First, the bag is represented with a standard feature vector (1). Then feature values histograms of locally scaled feature values are computed for each feature separately (2). Next, the locallyscaled self-similarity matrix is computed for each feature (3) to capture inner differences. This matrix is then transformed into feature differences histogram (4), which is invariant on the number or the ordering of the samples within the bag. Finally, feature values and feature differences histograms of all features are concatenated into resulting feature vector.</p>
    <p>V. MALWARE REPRESENTATION EXAMPLE</p>
    <p>This Section illustrates how the proposed representation is calculated for two real-world examples of malicious behavior. Namely, two versions of a polymorphic malware Sality are compared. Sality [14] is a malware family that has become a dynamic and complex form of malicious infection. It utilizes polymorphic techniques to infect files of Widows machines. Signature-based systems or classifiers trained on a specific malware type often struggles with detecting new variants of this kind of malware. Note that most of the conclusions to the discussion that follows can be drawn for many other malware threats.</p>
    <p>Figure 2 shows how the two Sality samples are represented with the proposed approach. First, the input flows are grouped into two bags (one bag for each Sality sample), because all flows of each bag have the same user and the same hostname (1). For the sake of simplicity, only URLs of the corresponding flows are displayed. Next, 88 flow-based feature vectors are computed for each bag (2). To simplify illustration, we use only a single feature  URL length. After this step, each Sality sample is represented with one feature vector of flow-based values. Existing approaches use these vectors as the input for the subsequent detection methods. As we will show in Section VI, these feature values are highly variable within and across malware categories. Classification models trained with such feature values loose generalization capability. In case the first sample is in the training set, the classifier would learn that</p>
  </div>
  <div class="page">
    <p>Example</p>
    <p>|45-45| |45-47|</p>
    <p>Shifting, scaling invariance</p>
    <p>Self-similarity matrix:</p>
  </div>
  <div class="page">
    <p>Example</p>
    <p>Histogram</p>
    <p>We are not interested in geometrical interpretation</p>
    <p>Permutation and size invariance</p>
  </div>
  <div class="page">
    <p>Example</p>
  </div>
  <div class="page">
    <p>Example</p>
  </div>
  <div class="page">
    <p>Example</p>
    <p>Cryptowall</p>
    <p>Asterope</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=12739868&amp;os=6.128.0.7601.18571&amp;res=41921466&amp;f=1</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=15425581&amp;os=6.128.0.7601.18571&amp;res=41921516&amp;f=1</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=27423103&amp;os=6.128.0.7601.18571&amp;res=41921342&amp;f=1</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3753&amp;id=126&amp;r=8955018&amp;os=6.128.0.7601.18571&amp;res=41921319&amp;f=1</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=31957678&amp;os=6.128.0.7601.18571&amp;res=41921223&amp;f=1</p>
    <p>Click-fraud, malvertising-related botnet</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=024f9730e23f8553c3e5342568a70300&amp;Email=name.surname@company.com</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=c1b6e3d50632d4f5c0ae13a52d3c4d8d&amp;Email=name.surname@company.com</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=7c9a843ce18126900c46dbe4be3b6425&amp;Email=name.surname@company.com</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=c1b6e3d50632d4f5c0ae13a52d3c4d8d&amp;Email=name.surname@company.com</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=bfba7d7023220c59d06e76f0085d6573&amp;Email=name.surname@company.com</p>
    <p>DGA</p>
    <p>hxxp://uvyqifymelapuvoh.biz/s531ka.ji5</p>
    <p>hxxp://uvyqifymelapuvoh.biz/rl59c281.x19</p>
    <p>hxxp://uvyqifymelapuvoh.biz/seibpn6.2m0</p>
    <p>hxxp://uvyqifymelapuvoh.biz/3854f.u17</p>
    <p>hxxp://uvyqifymelapuvoh.biz/06hk3j.449</p>
    <p>DGA</p>
    <p>hxxp://zerosumstudio.com/img5.php?z=smnk91cpnmd</p>
    <p>hxxp://zerosumstudio.com/img5.php?z=sd04vutaog</p>
    <p>hxxp://zemamranews.com/jxke9u.php?z=snmofp2ye0x</p>
    <p>hxxp://balustradydrewniane.pl/Fcb7VZ.php?z=23ur4wmxrs2</p>
    <p>Dridex</p>
    <p>hxxp://27.54.174.181/8qV578&amp;$o@HU6Q6S/gz$J0l=iTTH 28%2CM/we20%3D</p>
    <p>hxxp://27.54.174.181/C4GyRx%7E@RY6x /M&amp;N=sq/bW ra4OTJ</p>
    <p>hxxp://27.54.174.181/gPvh+=GO/9RPPfk0%2CzXOYU%20/Vq8Ww/+a m%7Ez</p>
    <p>hxxp://27.54.174.181/qE0my4KIz48Cf3H8wG%7Evpz=iJ%26fqMl%24m/46JoELp=GJww%3D%26Ib+Ar.y3 iu%2D1E/sso</p>
    <p>hxxp://27.54.174.181/kv7tig2s1vslfv&amp;i &amp;/s&amp;no%2Ds83%7E%2B+ns5%2D%3F+%20&amp;1/kjx%26e8x=$.pfilr@s3j66%2D</p>
    <p>InstallCore Monetization hxxp://rp.any-file-opener.org/?pcrc=1559319553&amp;v=2.0 hxxp://utouring.net/search/q/conducing</p>
    <p>hxxp://rp.any-file-opener.org/?pcrc=1132521307&amp;v=2.0 hxxp://utouring.net/go/u/1/r/1647</p>
    <p>hxxp://rp.any-file-opener.org/?pcrc=1123945956&amp;v=2.0 hxxp://utouring.net/go/u/0/r/2675</p>
    <p>hxxp://rp.any-file-opener.org/?pcrc=1075608192&amp;v=2.0 hxxp://utouring.net/search/f/1/q/refiles</p>
    <p>hxxp://rp.any-file-opener.org/?pcrc=995719244&amp;v=2.0 hxxp://utouring.net/search/f/1/q/refiles</p>
    <p>Poweliks</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=nitric+oxide+side+effects&amp;ua=Mozilla . . . &amp;lr=7&amp;ls=0</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=weight+loss+success+stories&amp;ua=Mozilla . . . &amp;lr=0&amp;ls=0</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=shoulder+pain&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=2</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=cheap+car+insurance&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=2</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=natural+testosterone+boosters&amp;ua=Mozilla . . . &amp;lr=7&amp;ls=2</p>
    <p>Zeus</p>
    <p>hxxp://130.185.106.28/m/IbQFdXVjiriLva4KHeNpWCmThrJBn3f34HNwsLVVsUmLXtsumSSPe/zzXtIu9SzwjI . . . 3RqvGzKN5</p>
    <p>hxxp://130.185.106.28/m/IbQJFUVjgZn4vx4KHeNpWCmThrJBn3f34HNwsLVVsUmLfkoPaSS+S+zzXtIu9SzwjI . . . 3vKwmk0oUi</p>
    <p>hxxp://130.185.106.28/m/IbQJFUVjiJwJBX4KHeNpWCmThrJBn3f34HNwsLVVsUmKH7ue2STvSkzzXtIu9SzwjI . . . 3vKwmk0oUi</p>
    <p>hxxp://130.185.106.28/m/IbQNtVVji5/7Yp4KHeNpWCmThrJBn3f34HNwsLVVsUmLz4sO6YRvOjzzXtIu9SzwjI . . . 3zB9057quqv</p>
    <p>hxxp://130.185.106.28/m/IbQG9VVjjSnDM94KHeNpWCmThrJBn3f34HNwsLVVsUmLXpt/+YRue8zzXtIu9SzwjI . . . 6iN5mt6Tj3</p>
    <p>Legitimate trac</p>
    <p>hxxp://www.cnn.com/.a/1.73.0/js/vendor/usabilla.min.js</p>
    <p>hxxp://www.cnn.com/.element/ssi/auto/4.0/sect/MAIN/markets wsod expansion.html</p>
    <p>hxxp://www.cnn.com/.a/1.73.0/assets/sprite-s1dced3ff2b.png</p>
    <p>hxxp://www.cnn.com/.element/widget/video/videoapi/api/latest/js/CNNVideoBootstrapper.js</p>
    <p>hxxp://www.cnn.com/jsonp/video/nowPlayingSchedule.json?callback=nowPlayingScheduleCallbackWrapper&amp; =1422885578476</p>
    <p>Legitimate trac</p>
    <p>hxxp://ads.adaptv.advertising.com/a/h/7g doK40WLPMYHbkD9G2u7HSXjqz . . . &amp;context=fullUrl%3Dpandora.com</p>
    <p>hxxp://ads.adaptv.advertising.com/crossdomain.xml</p>
    <p>hxxp://ads.advertising.com/411f1e96-3bde-4d85-b17e-63749e5f0695.js</p>
    <p>hxxp://ads.advertising.com/ids/411f1e96-3bde-4d85-b17e-63749e5f0695</p>
    <p>hxxp://ads.adaptv.advertising.com/applist?placementId=297920&amp;key=&amp;d.vw=1&amp;orgId=8656&amp;hostname=data.rtbfy.com</p>
    <p>Table 4.3: URLs of flows from selected malicious categories together with two examples of legitimate URLs (at the bottom). You can see that URLs within each malicious bag are similar to each other (as opposed to most of legitimate bags). Small non-zero variability of flow-based feature values is projected into the proposed representation with both types of histograms, which makes the representation more robust to further malware changes and variants.</p>
  </div>
  <div class="page">
    <p>Example</p>
    <p>Cryptowall</p>
    <p>Asterope</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=12739868&amp;os=6.128.0.7601.18571&amp;res=41921466&amp;f=1</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=15425581&amp;os=6.128.0.7601.18571&amp;res=41921516&amp;f=1</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=27423103&amp;os=6.128.0.7601.18571&amp;res=41921342&amp;f=1</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3753&amp;id=126&amp;r=8955018&amp;os=6.128.0.7601.18571&amp;res=41921319&amp;f=1</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=31957678&amp;os=6.128.0.7601.18571&amp;res=41921223&amp;f=1</p>
    <p>Click-fraud, malvertising-related botnet</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=024f9730e23f8553c3e5342568a70300&amp;Email=name.surname@company.com</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=c1b6e3d50632d4f5c0ae13a52d3c4d8d&amp;Email=name.surname@company.com</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=7c9a843ce18126900c46dbe4be3b6425&amp;Email=name.surname@company.com</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=c1b6e3d50632d4f5c0ae13a52d3c4d8d&amp;Email=name.surname@company.com</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=bfba7d7023220c59d06e76f0085d6573&amp;Email=name.surname@company.com</p>
    <p>DGA</p>
    <p>hxxp://uvyqifymelapuvoh.biz/s531ka.ji5</p>
    <p>hxxp://uvyqifymelapuvoh.biz/rl59c281.x19</p>
    <p>hxxp://uvyqifymelapuvoh.biz/seibpn6.2m0</p>
    <p>hxxp://uvyqifymelapuvoh.biz/3854f.u17</p>
    <p>hxxp://uvyqifymelapuvoh.biz/06hk3j.449</p>
    <p>DGA</p>
    <p>hxxp://zerosumstudio.com/img5.php?z=smnk91cpnmd</p>
    <p>hxxp://zerosumstudio.com/img5.php?z=sd04vutaog</p>
    <p>hxxp://zemamranews.com/jxke9u.php?z=snmofp2ye0x</p>
    <p>hxxp://balustradydrewniane.pl/Fcb7VZ.php?z=23ur4wmxrs2</p>
    <p>Dridex</p>
    <p>hxxp://27.54.174.181/8qV578&amp;$o@HU6Q6S/gz$J0l=iTTH 28%2CM/we20%3D</p>
    <p>hxxp://27.54.174.181/C4GyRx%7E@RY6x /M&amp;N=sq/bW ra4OTJ</p>
    <p>hxxp://27.54.174.181/gPvh+=GO/9RPPfk0%2CzXOYU%20/Vq8Ww/+a m%7Ez</p>
    <p>hxxp://27.54.174.181/qE0my4KIz48Cf3H8wG%7Evpz=iJ%26fqMl%24m/46JoELp=GJww%3D%26Ib+Ar.y3 iu%2D1E/sso</p>
    <p>hxxp://27.54.174.181/kv7tig2s1vslfv&amp;i &amp;/s&amp;no%2Ds83%7E%2B+ns5%2D%3F+%20&amp;1/kjx%26e8x=$.pfilr@s3j66%2D</p>
    <p>InstallCore Monetization hxxp://rp.any-file-opener.org/?pcrc=1559319553&amp;v=2.0 hxxp://utouring.net/search/q/conducing</p>
    <p>hxxp://rp.any-file-opener.org/?pcrc=1132521307&amp;v=2.0 hxxp://utouring.net/go/u/1/r/1647</p>
    <p>hxxp://rp.any-file-opener.org/?pcrc=1123945956&amp;v=2.0 hxxp://utouring.net/go/u/0/r/2675</p>
    <p>hxxp://rp.any-file-opener.org/?pcrc=1075608192&amp;v=2.0 hxxp://utouring.net/search/f/1/q/refiles</p>
    <p>hxxp://rp.any-file-opener.org/?pcrc=995719244&amp;v=2.0 hxxp://utouring.net/search/f/1/q/refiles</p>
    <p>Poweliks</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=nitric+oxide+side+effects&amp;ua=Mozilla . . . &amp;lr=7&amp;ls=0</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=weight+loss+success+stories&amp;ua=Mozilla . . . &amp;lr=0&amp;ls=0</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=shoulder+pain&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=2</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=cheap+car+insurance&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=2</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=natural+testosterone+boosters&amp;ua=Mozilla . . . &amp;lr=7&amp;ls=2</p>
    <p>Zeus</p>
    <p>hxxp://130.185.106.28/m/IbQFdXVjiriLva4KHeNpWCmThrJBn3f34HNwsLVVsUmLXtsumSSPe/zzXtIu9SzwjI . . . 3RqvGzKN5</p>
    <p>hxxp://130.185.106.28/m/IbQJFUVjgZn4vx4KHeNpWCmThrJBn3f34HNwsLVVsUmLfkoPaSS+S+zzXtIu9SzwjI . . . 3vKwmk0oUi</p>
    <p>hxxp://130.185.106.28/m/IbQJFUVjiJwJBX4KHeNpWCmThrJBn3f34HNwsLVVsUmKH7ue2STvSkzzXtIu9SzwjI . . . 3vKwmk0oUi</p>
    <p>hxxp://130.185.106.28/m/IbQNtVVji5/7Yp4KHeNpWCmThrJBn3f34HNwsLVVsUmLz4sO6YRvOjzzXtIu9SzwjI . . . 3zB9057quqv</p>
    <p>hxxp://130.185.106.28/m/IbQG9VVjjSnDM94KHeNpWCmThrJBn3f34HNwsLVVsUmLXpt/+YRue8zzXtIu9SzwjI . . . 6iN5mt6Tj3</p>
    <p>Legitimate trac</p>
    <p>hxxp://www.cnn.com/.a/1.73.0/js/vendor/usabilla.min.js</p>
    <p>hxxp://www.cnn.com/.element/ssi/auto/4.0/sect/MAIN/markets wsod expansion.html</p>
    <p>hxxp://www.cnn.com/.a/1.73.0/assets/sprite-s1dced3ff2b.png</p>
    <p>hxxp://www.cnn.com/.element/widget/video/videoapi/api/latest/js/CNNVideoBootstrapper.js</p>
    <p>hxxp://www.cnn.com/jsonp/video/nowPlayingSchedule.json?callback=nowPlayingScheduleCallbackWrapper&amp; =1422885578476</p>
    <p>Legitimate trac</p>
    <p>hxxp://ads.adaptv.advertising.com/a/h/7g doK40WLPMYHbkD9G2u7HSXjqz . . . &amp;context=fullUrl%3Dpandora.com</p>
    <p>hxxp://ads.adaptv.advertising.com/crossdomain.xml</p>
    <p>hxxp://ads.advertising.com/411f1e96-3bde-4d85-b17e-63749e5f0695.js</p>
    <p>hxxp://ads.advertising.com/ids/411f1e96-3bde-4d85-b17e-63749e5f0695</p>
    <p>hxxp://ads.adaptv.advertising.com/applist?placementId=297920&amp;key=&amp;d.vw=1&amp;orgId=8656&amp;hostname=data.rtbfy.com</p>
    <p>Table 4.3: URLs of flows from selected malicious categories together with two examples of legitimate URLs (at the bottom). You can see that URLs within each malicious bag are similar to each other (as opposed to most of legitimate bags). Small non-zero variability of flow-based feature values is projected into the proposed representation with both types of histograms, which makes the representation more robust to further malware changes and variants.</p>
    <p>DNS Changer</p>
    <p>Asterope</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=12739868&amp;os=6.128.0.7601.18571&amp;res=41921466&amp;f=1</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=15425581&amp;os=6.128.0.7601.18571&amp;res=41921516&amp;f=1</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=27423103&amp;os=6.128.0.7601.18571&amp;res=41921342&amp;f=1</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3753&amp;id=126&amp;r=8955018&amp;os=6.128.0.7601.18571&amp;res=41921319&amp;f=1</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=31957678&amp;os=6.128.0.7601.18571&amp;res=41921223&amp;f=1</p>
    <p>Click-fraud, malvertising-related botnet</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=024f9730e23f8553c3e5342568a70300&amp;Email=name.surname@company.com</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=c1b6e3d50632d4f5c0ae13a52d3c4d8d&amp;Email=name.surname@company.com</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=7c9a843ce18126900c46dbe4be3b6425&amp;Email=name.surname@company.com</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=c1b6e3d50632d4f5c0ae13a52d3c4d8d&amp;Email=name.surname@company.com</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=bfba7d7023220c59d06e76f0085d6573&amp;Email=name.surname@company.com</p>
    <p>DGA</p>
    <p>hxxp://uvyqifymelapuvoh.biz/s531ka.ji5</p>
    <p>hxxp://uvyqifymelapuvoh.biz/rl59c281.x19</p>
    <p>hxxp://uvyqifymelapuvoh.biz/seibpn6.2m0</p>
    <p>hxxp://uvyqifymelapuvoh.biz/3854f.u17</p>
    <p>hxxp://uvyqifymelapuvoh.biz/06hk3j.449</p>
    <p>DGA</p>
    <p>hxxp://ukhealer.net/u/?a=KELQFAJusqu6Gd33DB0T1zATPwoXsmYFciyO9THSYS7na3zZfVczZ8GzHHydLYn8hVyiy1l0...</p>
    <p>hxxp://sethealer.com/u/?a=L4ZTRAn2VVC9F -BkobTaxsNyaqCKxReHIOOWoVFdYZxFkES4Y mBgSCaN 1K1rWdeM...</p>
    <p>hxxp://sethealer.net/u/?a=qF1coIn2VVE3OFYDC1NXrm24fgDShSqjFsut7gMXRymFe3zZuFTQPw1lI4X6t2MQIMntv2It...</p>
    <p>hxxp://balustradydrewniane.pl/Fcb7VZ.php?z=23ur4wmxrs2</p>
    <p>Dridex</p>
    <p>hxxp://27.54.174.181/8qV578&amp;$o@HU6Q6S/gz$J0l=iTTH 28%2CM/we20%3D</p>
    <p>hxxp://27.54.174.181/C4GyRx%7E@RY6x /M&amp;N=sq/bW ra4OTJ</p>
    <p>hxxp://27.54.174.181/gPvh+=GO/9RPPfk0%2CzXOYU%20/Vq8Ww/+a m%7Ez</p>
    <p>hxxp://27.54.174.181/qE0my4KIz48Cf3H8wG%7Evpz=iJ%26fqMl%24m/46JoELp=GJww%3D%26Ib+Ar.y3 iu%2D1E/sso</p>
    <p>hxxp://27.54.174.181/kv7tig2s1vslfv&amp;i &amp;/s&amp;no%2Ds83%7E%2B+ns5%2D%3F+%20&amp;1/kjx%26e8x=$.pfilr@s3j66%2D</p>
    <p>InstallCore Monetization hxxp://rp.any-file-opener.org/?pcrc=1559319553&amp;v=2.0 hxxp://utouring.net/search/q/conducing</p>
    <p>hxxp://rp.any-file-opener.org/?pcrc=1132521307&amp;v=2.0 hxxp://utouring.net/go/u/1/r/1647</p>
    <p>hxxp://rp.any-file-opener.org/?pcrc=1123945956&amp;v=2.0 hxxp://utouring.net/go/u/0/r/2675</p>
    <p>hxxp://rp.any-file-opener.org/?pcrc=1075608192&amp;v=2.0 hxxp://utouring.net/search/f/1/q/refiles</p>
    <p>hxxp://rp.any-file-opener.org/?pcrc=995719244&amp;v=2.0 hxxp://utouring.net/search/f/1/q/refiles</p>
    <p>Poweliks</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=nitric+oxide+side+effects&amp;ua=Mozilla . . . &amp;lr=7&amp;ls=0</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=weight+loss+success+stories&amp;ua=Mozilla . . . &amp;lr=0&amp;ls=0</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=shoulder+pain&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=2</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=cheap+car+insurance&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=2</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=natural+testosterone+boosters&amp;ua=Mozilla . . . &amp;lr=7&amp;ls=2</p>
    <p>Zeus</p>
    <p>hxxp://130.185.106.28/m/IbQFdXVjiriLva4KHeNpWCmThrJBn3f34HNwsLVVsUmLXtsumSSPe/zzXtIu9SzwjI . . . 3RqvGzKN5</p>
    <p>hxxp://130.185.106.28/m/IbQJFUVjgZn4vx4KHeNpWCmThrJBn3f34HNwsLVVsUmLfkoPaSS+S+zzXtIu9SzwjI . . . 3vKwmk0oUi</p>
    <p>hxxp://130.185.106.28/m/IbQJFUVjiJwJBX4KHeNpWCmThrJBn3f34HNwsLVVsUmKH7ue2STvSkzzXtIu9SzwjI . . . 3vKwmk0oUi</p>
    <p>hxxp://130.185.106.28/m/IbQNtVVji5/7Yp4KHeNpWCmThrJBn3f34HNwsLVVsUmLz4sO6YRvOjzzXtIu9SzwjI . . . 3zB9057quqv</p>
    <p>hxxp://130.185.106.28/m/IbQG9VVjjSnDM94KHeNpWCmThrJBn3f34HNwsLVVsUmLXpt/+YRue8zzXtIu9SzwjI . . . 6iN5mt6Tj3</p>
    <p>Legitimate trac</p>
    <p>hxxp://www.cnn.com/.a/1.73.0/js/vendor/usabilla.min.js</p>
    <p>hxxp://www.cnn.com/.element/ssi/auto/4.0/sect/MAIN/markets wsod expansion.html</p>
    <p>hxxp://www.cnn.com/.a/1.73.0/assets/sprite-s1dced3ff2b.png</p>
    <p>hxxp://www.cnn.com/.element/widget/video/videoapi/api/latest/js/CNNVideoBootstrapper.js</p>
    <p>hxxp://www.cnn.com/jsonp/video/nowPlayingSchedule.json?callback=nowPlayingScheduleCallbackWrapper&amp; =1422885578476</p>
    <p>Legitimate trac</p>
    <p>hxxp://ads.adaptv.advertising.com/a/h/7g doK40WLPMYHbkD9G2u7HSXjqz . . . &amp;context=fullUrl%3Dpandora.com</p>
    <p>hxxp://ads.adaptv.advertising.com/crossdomain.xml</p>
    <p>hxxp://ads.advertising.com/411f1e96-3bde-4d85-b17e-63749e5f0695.js</p>
    <p>hxxp://ads.advertising.com/ids/411f1e96-3bde-4d85-b17e-63749e5f0695</p>
    <p>hxxp://ads.adaptv.advertising.com/applist?placementId=297920&amp;key=&amp;d.vw=1&amp;orgId=8656&amp;hostname=data.rtbfy.com</p>
    <p>Table 4.3: URLs of flows from selected malicious categories together with two examples of legitimate URLs (at the bottom). You can see that URLs within each malicious bag are similar to each other (as opposed to most of legitimate bags). Small non-zero variability of flow-based feature values is projected into the proposed representation with both types of histograms, which makes the representation more robust to further malware changes and variants.</p>
  </div>
  <div class="page">
    <p>Example</p>
    <p>Cryptowall</p>
    <p>Asterope</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=12739868&amp;os=6.128.0.7601.18571&amp;res=41921466&amp;f=1</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=15425581&amp;os=6.128.0.7601.18571&amp;res=41921516&amp;f=1</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=27423103&amp;os=6.128.0.7601.18571&amp;res=41921342&amp;f=1</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3753&amp;id=126&amp;r=8955018&amp;os=6.128.0.7601.18571&amp;res=41921319&amp;f=1</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=31957678&amp;os=6.128.0.7601.18571&amp;res=41921223&amp;f=1</p>
    <p>Click-fraud, malvertising-related botnet</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=024f9730e23f8553c3e5342568a70300&amp;Email=name.surname@company.com</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=c1b6e3d50632d4f5c0ae13a52d3c4d8d&amp;Email=name.surname@company.com</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=7c9a843ce18126900c46dbe4be3b6425&amp;Email=name.surname@company.com</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=c1b6e3d50632d4f5c0ae13a52d3c4d8d&amp;Email=name.surname@company.com</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=bfba7d7023220c59d06e76f0085d6573&amp;Email=name.surname@company.com</p>
    <p>DGA</p>
    <p>hxxp://uvyqifymelapuvoh.biz/s531ka.ji5</p>
    <p>hxxp://uvyqifymelapuvoh.biz/rl59c281.x19</p>
    <p>hxxp://uvyqifymelapuvoh.biz/seibpn6.2m0</p>
    <p>hxxp://uvyqifymelapuvoh.biz/3854f.u17</p>
    <p>hxxp://uvyqifymelapuvoh.biz/06hk3j.449</p>
    <p>DGA</p>
    <p>hxxp://zerosumstudio.com/img5.php?z=smnk91cpnmd</p>
    <p>hxxp://zerosumstudio.com/img5.php?z=sd04vutaog</p>
    <p>hxxp://zemamranews.com/jxke9u.php?z=snmofp2ye0x</p>
    <p>hxxp://balustradydrewniane.pl/Fcb7VZ.php?z=23ur4wmxrs2</p>
    <p>Dridex</p>
    <p>hxxp://27.54.174.181/8qV578&amp;$o@HU6Q6S/gz$J0l=iTTH 28%2CM/we20%3D</p>
    <p>hxxp://27.54.174.181/C4GyRx%7E@RY6x /M&amp;N=sq/bW ra4OTJ</p>
    <p>hxxp://27.54.174.181/gPvh+=GO/9RPPfk0%2CzXOYU%20/Vq8Ww/+a m%7Ez</p>
    <p>hxxp://27.54.174.181/qE0my4KIz48Cf3H8wG%7Evpz=iJ%26fqMl%24m/46JoELp=GJww%3D%26Ib+Ar.y3 iu%2D1E/sso</p>
    <p>hxxp://27.54.174.181/kv7tig2s1vslfv&amp;i &amp;/s&amp;no%2Ds83%7E%2B+ns5%2D%3F+%20&amp;1/kjx%26e8x=$.pfilr@s3j66%2D</p>
    <p>InstallCore Monetization hxxp://rp.any-file-opener.org/?pcrc=1559319553&amp;v=2.0 hxxp://utouring.net/search/q/conducing</p>
    <p>hxxp://rp.any-file-opener.org/?pcrc=1132521307&amp;v=2.0 hxxp://utouring.net/go/u/1/r/1647</p>
    <p>hxxp://rp.any-file-opener.org/?pcrc=1123945956&amp;v=2.0 hxxp://utouring.net/go/u/0/r/2675</p>
    <p>hxxp://rp.any-file-opener.org/?pcrc=1075608192&amp;v=2.0 hxxp://utouring.net/search/f/1/q/refiles</p>
    <p>hxxp://rp.any-file-opener.org/?pcrc=995719244&amp;v=2.0 hxxp://utouring.net/search/f/1/q/refiles</p>
    <p>Poweliks</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=nitric+oxide+side+effects&amp;ua=Mozilla . . . &amp;lr=7&amp;ls=0</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=weight+loss+success+stories&amp;ua=Mozilla . . . &amp;lr=0&amp;ls=0</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=shoulder+pain&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=2</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=cheap+car+insurance&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=2</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=natural+testosterone+boosters&amp;ua=Mozilla . . . &amp;lr=7&amp;ls=2</p>
    <p>Zeus</p>
    <p>hxxp://130.185.106.28/m/IbQFdXVjiriLva4KHeNpWCmThrJBn3f34HNwsLVVsUmLXtsumSSPe/zzXtIu9SzwjI . . . 3RqvGzKN5</p>
    <p>hxxp://130.185.106.28/m/IbQJFUVjgZn4vx4KHeNpWCmThrJBn3f34HNwsLVVsUmLfkoPaSS+S+zzXtIu9SzwjI . . . 3vKwmk0oUi</p>
    <p>hxxp://130.185.106.28/m/IbQJFUVjiJwJBX4KHeNpWCmThrJBn3f34HNwsLVVsUmKH7ue2STvSkzzXtIu9SzwjI . . . 3vKwmk0oUi</p>
    <p>hxxp://130.185.106.28/m/IbQNtVVji5/7Yp4KHeNpWCmThrJBn3f34HNwsLVVsUmLz4sO6YRvOjzzXtIu9SzwjI . . . 3zB9057quqv</p>
    <p>hxxp://130.185.106.28/m/IbQG9VVjjSnDM94KHeNpWCmThrJBn3f34HNwsLVVsUmLXpt/+YRue8zzXtIu9SzwjI . . . 6iN5mt6Tj3</p>
    <p>Legitimate trac</p>
    <p>hxxp://www.cnn.com/.a/1.73.0/js/vendor/usabilla.min.js</p>
    <p>hxxp://www.cnn.com/.element/ssi/auto/4.0/sect/MAIN/markets wsod expansion.html</p>
    <p>hxxp://www.cnn.com/.a/1.73.0/assets/sprite-s1dced3ff2b.png</p>
    <p>hxxp://www.cnn.com/.element/widget/video/videoapi/api/latest/js/CNNVideoBootstrapper.js</p>
    <p>hxxp://www.cnn.com/jsonp/video/nowPlayingSchedule.json?callback=nowPlayingScheduleCallbackWrapper&amp; =1422885578476</p>
    <p>Legitimate trac</p>
    <p>hxxp://ads.adaptv.advertising.com/a/h/7g doK40WLPMYHbkD9G2u7HSXjqz . . . &amp;context=fullUrl%3Dpandora.com</p>
    <p>hxxp://ads.adaptv.advertising.com/crossdomain.xml</p>
    <p>hxxp://ads.advertising.com/411f1e96-3bde-4d85-b17e-63749e5f0695.js</p>
    <p>hxxp://ads.advertising.com/ids/411f1e96-3bde-4d85-b17e-63749e5f0695</p>
    <p>hxxp://ads.adaptv.advertising.com/applist?placementId=297920&amp;key=&amp;d.vw=1&amp;orgId=8656&amp;hostname=data.rtbfy.com</p>
    <p>Table 4.3: URLs of flows from selected malicious categories together with two examples of legitimate URLs (at the bottom). You can see that URLs within each malicious bag are similar to each other (as opposed to most of legitimate bags). Small non-zero variability of flow-based feature values is projected into the proposed representation with both types of histograms, which makes the representation more robust to further malware changes and variants.</p>
    <p>DNS Changer</p>
    <p>Asterope</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=12739868&amp;os=6.128.0.7601.18571&amp;res=41921466&amp;f=1</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=15425581&amp;os=6.128.0.7601.18571&amp;res=41921516&amp;f=1</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=27423103&amp;os=6.128.0.7601.18571&amp;res=41921342&amp;f=1</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3753&amp;id=126&amp;r=8955018&amp;os=6.128.0.7601.18571&amp;res=41921319&amp;f=1</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=31957678&amp;os=6.128.0.7601.18571&amp;res=41921223&amp;f=1</p>
    <p>Click-fraud, malvertising-related botnet</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=024f9730e23f8553c3e5342568a70300&amp;Email=name.surname@company.com</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=c1b6e3d50632d4f5c0ae13a52d3c4d8d&amp;Email=name.surname@company.com</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=7c9a843ce18126900c46dbe4be3b6425&amp;Email=name.surname@company.com</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=c1b6e3d50632d4f5c0ae13a52d3c4d8d&amp;Email=name.surname@company.com</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=bfba7d7023220c59d06e76f0085d6573&amp;Email=name.surname@company.com</p>
    <p>DGA</p>
    <p>hxxp://uvyqifymelapuvoh.biz/s531ka.ji5</p>
    <p>hxxp://uvyqifymelapuvoh.biz/rl59c281.x19</p>
    <p>hxxp://uvyqifymelapuvoh.biz/seibpn6.2m0</p>
    <p>hxxp://uvyqifymelapuvoh.biz/3854f.u17</p>
    <p>hxxp://uvyqifymelapuvoh.biz/06hk3j.449</p>
    <p>DGA</p>
    <p>hxxp://ukhealer.net/u/?a=KELQFAJusqu6Gd33DB0T1zATPwoXsmYFciyO9THSYS7na3zZfVczZ8GzHHydLYn8hVyiy1l0...</p>
    <p>hxxp://sethealer.com/u/?a=L4ZTRAn2VVC9F -BkobTaxsNyaqCKxReHIOOWoVFdYZxFkES4Y mBgSCaN 1K1rWdeM...</p>
    <p>hxxp://sethealer.net/u/?a=qF1coIn2VVE3OFYDC1NXrm24fgDShSqjFsut7gMXRymFe3zZuFTQPw1lI4X6t2MQIMntv2It...</p>
    <p>hxxp://balustradydrewniane.pl/Fcb7VZ.php?z=23ur4wmxrs2</p>
    <p>Dridex</p>
    <p>hxxp://27.54.174.181/8qV578&amp;$o@HU6Q6S/gz$J0l=iTTH 28%2CM/we20%3D</p>
    <p>hxxp://27.54.174.181/C4GyRx%7E@RY6x /M&amp;N=sq/bW ra4OTJ</p>
    <p>hxxp://27.54.174.181/gPvh+=GO/9RPPfk0%2CzXOYU%20/Vq8Ww/+a m%7Ez</p>
    <p>hxxp://27.54.174.181/qE0my4KIz48Cf3H8wG%7Evpz=iJ%26fqMl%24m/46JoELp=GJww%3D%26Ib+Ar.y3 iu%2D1E/sso</p>
    <p>hxxp://27.54.174.181/kv7tig2s1vslfv&amp;i &amp;/s&amp;no%2Ds83%7E%2B+ns5%2D%3F+%20&amp;1/kjx%26e8x=$.pfilr@s3j66%2D</p>
    <p>InstallCore Monetization hxxp://rp.any-file-opener.org/?pcrc=1559319553&amp;v=2.0 hxxp://utouring.net/search/q/conducing</p>
    <p>hxxp://rp.any-file-opener.org/?pcrc=1132521307&amp;v=2.0 hxxp://utouring.net/go/u/1/r/1647</p>
    <p>hxxp://rp.any-file-opener.org/?pcrc=1123945956&amp;v=2.0 hxxp://utouring.net/go/u/0/r/2675</p>
    <p>hxxp://rp.any-file-opener.org/?pcrc=1075608192&amp;v=2.0 hxxp://utouring.net/search/f/1/q/refiles</p>
    <p>hxxp://rp.any-file-opener.org/?pcrc=995719244&amp;v=2.0 hxxp://utouring.net/search/f/1/q/refiles</p>
    <p>Poweliks</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=nitric+oxide+side+effects&amp;ua=Mozilla . . . &amp;lr=7&amp;ls=0</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=weight+loss+success+stories&amp;ua=Mozilla . . . &amp;lr=0&amp;ls=0</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=shoulder+pain&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=2</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=cheap+car+insurance&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=2</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=natural+testosterone+boosters&amp;ua=Mozilla . . . &amp;lr=7&amp;ls=2</p>
    <p>Zeus</p>
    <p>hxxp://130.185.106.28/m/IbQFdXVjiriLva4KHeNpWCmThrJBn3f34HNwsLVVsUmLXtsumSSPe/zzXtIu9SzwjI . . . 3RqvGzKN5</p>
    <p>hxxp://130.185.106.28/m/IbQJFUVjgZn4vx4KHeNpWCmThrJBn3f34HNwsLVVsUmLfkoPaSS+S+zzXtIu9SzwjI . . . 3vKwmk0oUi</p>
    <p>hxxp://130.185.106.28/m/IbQJFUVjiJwJBX4KHeNpWCmThrJBn3f34HNwsLVVsUmKH7ue2STvSkzzXtIu9SzwjI . . . 3vKwmk0oUi</p>
    <p>hxxp://130.185.106.28/m/IbQNtVVji5/7Yp4KHeNpWCmThrJBn3f34HNwsLVVsUmLz4sO6YRvOjzzXtIu9SzwjI . . . 3zB9057quqv</p>
    <p>hxxp://130.185.106.28/m/IbQG9VVjjSnDM94KHeNpWCmThrJBn3f34HNwsLVVsUmLXpt/+YRue8zzXtIu9SzwjI . . . 6iN5mt6Tj3</p>
    <p>Legitimate trac</p>
    <p>hxxp://www.cnn.com/.a/1.73.0/js/vendor/usabilla.min.js</p>
    <p>hxxp://www.cnn.com/.element/ssi/auto/4.0/sect/MAIN/markets wsod expansion.html</p>
    <p>hxxp://www.cnn.com/.a/1.73.0/assets/sprite-s1dced3ff2b.png</p>
    <p>hxxp://www.cnn.com/.element/widget/video/videoapi/api/latest/js/CNNVideoBootstrapper.js</p>
    <p>hxxp://www.cnn.com/jsonp/video/nowPlayingSchedule.json?callback=nowPlayingScheduleCallbackWrapper&amp; =1422885578476</p>
    <p>Legitimate trac</p>
    <p>hxxp://ads.adaptv.advertising.com/a/h/7g doK40WLPMYHbkD9G2u7HSXjqz . . . &amp;context=fullUrl%3Dpandora.com</p>
    <p>hxxp://ads.adaptv.advertising.com/crossdomain.xml</p>
    <p>hxxp://ads.advertising.com/411f1e96-3bde-4d85-b17e-63749e5f0695.js</p>
    <p>hxxp://ads.advertising.com/ids/411f1e96-3bde-4d85-b17e-63749e5f0695</p>
    <p>hxxp://ads.adaptv.advertising.com/applist?placementId=297920&amp;key=&amp;d.vw=1&amp;orgId=8656&amp;hostname=data.rtbfy.com</p>
    <p>Table 4.3: URLs of flows from selected malicious categories together with two examples of legitimate URLs (at the bottom). You can see that URLs within each malicious bag are similar to each other (as opposed to most of legitimate bags). Small non-zero variability of flow-based feature values is projected into the proposed representation with both types of histograms, which makes the representation more robust to further malware changes and variants.</p>
    <p>Rig Exploit Kit</p>
    <p>Asterope</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=12739868&amp;os=6.128.0.7601.18571&amp;res=41921466&amp;f=1</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=15425581&amp;os=6.128.0.7601.18571&amp;res=41921516&amp;f=1</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=27423103&amp;os=6.128.0.7601.18571&amp;res=41921342&amp;f=1</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3753&amp;id=126&amp;r=8955018&amp;os=6.128.0.7601.18571&amp;res=41921319&amp;f=1</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=31957678&amp;os=6.128.0.7601.18571&amp;res=41921223&amp;f=1</p>
    <p>Click-fraud, malvertising-related botnet</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=024f9730e23f8553c3e5342568a70300&amp;Email=name.surname@company.com</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=c1b6e3d50632d4f5c0ae13a52d3c4d8d&amp;Email=name.surname@company.com</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=7c9a843ce18126900c46dbe4be3b6425&amp;Email=name.surname@company.com</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=c1b6e3d50632d4f5c0ae13a52d3c4d8d&amp;Email=name.surname@company.com</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=bfba7d7023220c59d06e76f0085d6573&amp;Email=name.surname@company.com</p>
    <p>DGA</p>
    <p>hxxp://uvyqifymelapuvoh.biz/s531ka.ji5</p>
    <p>hxxp://uvyqifymelapuvoh.biz/rl59c281.x19</p>
    <p>hxxp://uvyqifymelapuvoh.biz/seibpn6.2m0</p>
    <p>hxxp://uvyqifymelapuvoh.biz/3854f.u17</p>
    <p>hxxp://uvyqifymelapuvoh.biz/06hk3j.449</p>
    <p>DGA</p>
    <p>hxxp://ds.revivefl.org/?x3qJc7iZLBrGAoc=l3SKfPrfJxzFGMSUb-nJDa9BMEXCRQLPh4SGhKrXCJ-ofSih17OIFxzsmT...</p>
    <p>hxxp://ds.revivefl.org/index.php?x3qJc7iZLBrGAoc=l3SMfPrfJxzFGMSUb-nJDa9BMEXCRQLPh4SGhKrXCJ-ofSih17...</p>
    <p>hxxp://ds.revivefl.org/index.php?h4SGhKrXCJ-ofSih17OIFxzsmTu2KV OpqxveN0SZFSOzQfZPVQlyZAdChoB Oqki0v...</p>
    <p>hxxp://balustradydrewniane.pl/Fcb7VZ.php?z=23ur4wmxrs2</p>
    <p>Dridex</p>
    <p>hxxp://27.54.174.181/8qV578&amp;$o@HU6Q6S/gz$J0l=iTTH 28%2CM/we20%3D</p>
    <p>hxxp://27.54.174.181/C4GyRx%7E@RY6x /M&amp;N=sq/bW ra4OTJ</p>
    <p>hxxp://27.54.174.181/gPvh+=GO/9RPPfk0%2CzXOYU%20/Vq8Ww/+a m%7Ez</p>
    <p>hxxp://27.54.174.181/qE0my4KIz48Cf3H8wG%7Evpz=iJ%26fqMl%24m/46JoELp=GJww%3D%26Ib+Ar.y3 iu%2D1E/sso</p>
    <p>hxxp://27.54.174.181/kv7tig2s1vslfv&amp;i &amp;/s&amp;no%2Ds83%7E%2B+ns5%2D%3F+%20&amp;1/kjx%26e8x=$.pfilr@s3j66%2D</p>
    <p>InstallCore Monetization hxxp://rp.any-file-opener.org/?pcrc=1559319553&amp;v=2.0 hxxp://utouring.net/search/q/conducing</p>
    <p>hxxp://rp.any-file-opener.org/?pcrc=1132521307&amp;v=2.0 hxxp://utouring.net/go/u/1/r/1647</p>
    <p>hxxp://rp.any-file-opener.org/?pcrc=1123945956&amp;v=2.0 hxxp://utouring.net/go/u/0/r/2675</p>
    <p>hxxp://rp.any-file-opener.org/?pcrc=1075608192&amp;v=2.0 hxxp://utouring.net/search/f/1/q/refiles</p>
    <p>hxxp://rp.any-file-opener.org/?pcrc=995719244&amp;v=2.0 hxxp://utouring.net/search/f/1/q/refiles</p>
    <p>Poweliks</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=nitric+oxide+side+effects&amp;ua=Mozilla . . . &amp;lr=7&amp;ls=0</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=weight+loss+success+stories&amp;ua=Mozilla . . . &amp;lr=0&amp;ls=0</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=shoulder+pain&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=2</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=cheap+car+insurance&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=2</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=natural+testosterone+boosters&amp;ua=Mozilla . . . &amp;lr=7&amp;ls=2</p>
    <p>Zeus</p>
    <p>hxxp://130.185.106.28/m/IbQFdXVjiriLva4KHeNpWCmThrJBn3f34HNwsLVVsUmLXtsumSSPe/zzXtIu9SzwjI . . . 3RqvGzKN5</p>
    <p>hxxp://130.185.106.28/m/IbQJFUVjgZn4vx4KHeNpWCmThrJBn3f34HNwsLVVsUmLfkoPaSS+S+zzXtIu9SzwjI . . . 3vKwmk0oUi</p>
    <p>hxxp://130.185.106.28/m/IbQJFUVjiJwJBX4KHeNpWCmThrJBn3f34HNwsLVVsUmKH7ue2STvSkzzXtIu9SzwjI . . . 3vKwmk0oUi</p>
    <p>hxxp://130.185.106.28/m/IbQNtVVji5/7Yp4KHeNpWCmThrJBn3f34HNwsLVVsUmLz4sO6YRvOjzzXtIu9SzwjI . . . 3zB9057quqv</p>
    <p>hxxp://130.185.106.28/m/IbQG9VVjjSnDM94KHeNpWCmThrJBn3f34HNwsLVVsUmLXpt/+YRue8zzXtIu9SzwjI . . . 6iN5mt6Tj3</p>
    <p>Legitimate trac</p>
    <p>hxxp://www.cnn.com/.a/1.73.0/js/vendor/usabilla.min.js</p>
    <p>hxxp://www.cnn.com/.element/ssi/auto/4.0/sect/MAIN/markets wsod expansion.html</p>
    <p>hxxp://www.cnn.com/.a/1.73.0/assets/sprite-s1dced3ff2b.png</p>
    <p>hxxp://www.cnn.com/.element/widget/video/videoapi/api/latest/js/CNNVideoBootstrapper.js</p>
    <p>hxxp://www.cnn.com/jsonp/video/nowPlayingSchedule.json?callback=nowPlayingScheduleCallbackWrapper&amp; =1422885578476</p>
    <p>Legitimate trac</p>
    <p>hxxp://ads.adaptv.advertising.com/a/h/7g doK40WLPMYHbkD9G2u7HSXjqz . . . &amp;context=fullUrl%3Dpandora.com</p>
    <p>hxxp://ads.adaptv.advertising.com/crossdomain.xml</p>
    <p>hxxp://ads.advertising.com/411f1e96-3bde-4d85-b17e-63749e5f0695.js</p>
    <p>hxxp://ads.advertising.com/ids/411f1e96-3bde-4d85-b17e-63749e5f0695</p>
    <p>hxxp://ads.adaptv.advertising.com/applist?placementId=297920&amp;key=&amp;d.vw=1&amp;orgId=8656&amp;hostname=data.rtbfy.com</p>
    <p>Table 4.3: URLs of flows from selected malicious categories together with two examples of legitimate URLs (at the bottom). You can see that URLs within each malicious bag are similar to each other (as opposed to most of legitimate bags). Small non-zero variability of flow-based feature values is projected into the proposed representation with both types of histograms, which makes the representation more robust to further malware changes and variants.</p>
  </div>
  <div class="page">
    <p>Example</p>
    <p>Cryptowall</p>
    <p>Asterope</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=12739868&amp;os=6.128.0.7601.18571&amp;res=41921466&amp;f=1</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=15425581&amp;os=6.128.0.7601.18571&amp;res=41921516&amp;f=1</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=27423103&amp;os=6.128.0.7601.18571&amp;res=41921342&amp;f=1</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3753&amp;id=126&amp;r=8955018&amp;os=6.128.0.7601.18571&amp;res=41921319&amp;f=1</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=31957678&amp;os=6.128.0.7601.18571&amp;res=41921223&amp;f=1</p>
    <p>Click-fraud, malvertising-related botnet</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=024f9730e23f8553c3e5342568a70300&amp;Email=name.surname@company.com</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=c1b6e3d50632d4f5c0ae13a52d3c4d8d&amp;Email=name.surname@company.com</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=7c9a843ce18126900c46dbe4be3b6425&amp;Email=name.surname@company.com</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=c1b6e3d50632d4f5c0ae13a52d3c4d8d&amp;Email=name.surname@company.com</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=bfba7d7023220c59d06e76f0085d6573&amp;Email=name.surname@company.com</p>
    <p>DGA</p>
    <p>hxxp://uvyqifymelapuvoh.biz/s531ka.ji5</p>
    <p>hxxp://uvyqifymelapuvoh.biz/rl59c281.x19</p>
    <p>hxxp://uvyqifymelapuvoh.biz/seibpn6.2m0</p>
    <p>hxxp://uvyqifymelapuvoh.biz/3854f.u17</p>
    <p>hxxp://uvyqifymelapuvoh.biz/06hk3j.449</p>
    <p>DGA</p>
    <p>hxxp://zerosumstudio.com/img5.php?z=smnk91cpnmd</p>
    <p>hxxp://zerosumstudio.com/img5.php?z=sd04vutaog</p>
    <p>hxxp://zemamranews.com/jxke9u.php?z=snmofp2ye0x</p>
    <p>hxxp://balustradydrewniane.pl/Fcb7VZ.php?z=23ur4wmxrs2</p>
    <p>Dridex</p>
    <p>hxxp://27.54.174.181/8qV578&amp;$o@HU6Q6S/gz$J0l=iTTH 28%2CM/we20%3D</p>
    <p>hxxp://27.54.174.181/C4GyRx%7E@RY6x /M&amp;N=sq/bW ra4OTJ</p>
    <p>hxxp://27.54.174.181/gPvh+=GO/9RPPfk0%2CzXOYU%20/Vq8Ww/+a m%7Ez</p>
    <p>hxxp://27.54.174.181/qE0my4KIz48Cf3H8wG%7Evpz=iJ%26fqMl%24m/46JoELp=GJww%3D%26Ib+Ar.y3 iu%2D1E/sso</p>
    <p>hxxp://27.54.174.181/kv7tig2s1vslfv&amp;i &amp;/s&amp;no%2Ds83%7E%2B+ns5%2D%3F+%20&amp;1/kjx%26e8x=$.pfilr@s3j66%2D</p>
    <p>InstallCore Monetization hxxp://rp.any-file-opener.org/?pcrc=1559319553&amp;v=2.0 hxxp://utouring.net/search/q/conducing</p>
    <p>hxxp://rp.any-file-opener.org/?pcrc=1132521307&amp;v=2.0 hxxp://utouring.net/go/u/1/r/1647</p>
    <p>hxxp://rp.any-file-opener.org/?pcrc=1123945956&amp;v=2.0 hxxp://utouring.net/go/u/0/r/2675</p>
    <p>hxxp://rp.any-file-opener.org/?pcrc=1075608192&amp;v=2.0 hxxp://utouring.net/search/f/1/q/refiles</p>
    <p>hxxp://rp.any-file-opener.org/?pcrc=995719244&amp;v=2.0 hxxp://utouring.net/search/f/1/q/refiles</p>
    <p>Poweliks</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=nitric+oxide+side+effects&amp;ua=Mozilla . . . &amp;lr=7&amp;ls=0</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=weight+loss+success+stories&amp;ua=Mozilla . . . &amp;lr=0&amp;ls=0</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=shoulder+pain&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=2</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=cheap+car+insurance&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=2</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=natural+testosterone+boosters&amp;ua=Mozilla . . . &amp;lr=7&amp;ls=2</p>
    <p>Zeus</p>
    <p>hxxp://130.185.106.28/m/IbQFdXVjiriLva4KHeNpWCmThrJBn3f34HNwsLVVsUmLXtsumSSPe/zzXtIu9SzwjI . . . 3RqvGzKN5</p>
    <p>hxxp://130.185.106.28/m/IbQJFUVjgZn4vx4KHeNpWCmThrJBn3f34HNwsLVVsUmLfkoPaSS+S+zzXtIu9SzwjI . . . 3vKwmk0oUi</p>
    <p>hxxp://130.185.106.28/m/IbQJFUVjiJwJBX4KHeNpWCmThrJBn3f34HNwsLVVsUmKH7ue2STvSkzzXtIu9SzwjI . . . 3vKwmk0oUi</p>
    <p>hxxp://130.185.106.28/m/IbQNtVVji5/7Yp4KHeNpWCmThrJBn3f34HNwsLVVsUmLz4sO6YRvOjzzXtIu9SzwjI . . . 3zB9057quqv</p>
    <p>hxxp://130.185.106.28/m/IbQG9VVjjSnDM94KHeNpWCmThrJBn3f34HNwsLVVsUmLXpt/+YRue8zzXtIu9SzwjI . . . 6iN5mt6Tj3</p>
    <p>Legitimate trac</p>
    <p>hxxp://www.cnn.com/.a/1.73.0/js/vendor/usabilla.min.js</p>
    <p>hxxp://www.cnn.com/.element/ssi/auto/4.0/sect/MAIN/markets wsod expansion.html</p>
    <p>hxxp://www.cnn.com/.a/1.73.0/assets/sprite-s1dced3ff2b.png</p>
    <p>hxxp://www.cnn.com/.element/widget/video/videoapi/api/latest/js/CNNVideoBootstrapper.js</p>
    <p>hxxp://www.cnn.com/jsonp/video/nowPlayingSchedule.json?callback=nowPlayingScheduleCallbackWrapper&amp; =1422885578476</p>
    <p>Legitimate trac</p>
    <p>hxxp://ads.adaptv.advertising.com/a/h/7g doK40WLPMYHbkD9G2u7HSXjqz . . . &amp;context=fullUrl%3Dpandora.com</p>
    <p>hxxp://ads.adaptv.advertising.com/crossdomain.xml</p>
    <p>hxxp://ads.advertising.com/411f1e96-3bde-4d85-b17e-63749e5f0695.js</p>
    <p>hxxp://ads.advertising.com/ids/411f1e96-3bde-4d85-b17e-63749e5f0695</p>
    <p>hxxp://ads.adaptv.advertising.com/applist?placementId=297920&amp;key=&amp;d.vw=1&amp;orgId=8656&amp;hostname=data.rtbfy.com</p>
    <p>Table 4.3: URLs of flows from selected malicious categories together with two examples of legitimate URLs (at the bottom). You can see that URLs within each malicious bag are similar to each other (as opposed to most of legitimate bags). Small non-zero variability of flow-based feature values is projected into the proposed representation with both types of histograms, which makes the representation more robust to further malware changes and variants.</p>
    <p>DNS Changer</p>
    <p>Asterope</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=12739868&amp;os=6.128.0.7601.18571&amp;res=41921466&amp;f=1</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=15425581&amp;os=6.128.0.7601.18571&amp;res=41921516&amp;f=1</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=27423103&amp;os=6.128.0.7601.18571&amp;res=41921342&amp;f=1</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3753&amp;id=126&amp;r=8955018&amp;os=6.128.0.7601.18571&amp;res=41921319&amp;f=1</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=31957678&amp;os=6.128.0.7601.18571&amp;res=41921223&amp;f=1</p>
    <p>Click-fraud, malvertising-related botnet</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=024f9730e23f8553c3e5342568a70300&amp;Email=name.surname@company.com</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=c1b6e3d50632d4f5c0ae13a52d3c4d8d&amp;Email=name.surname@company.com</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=7c9a843ce18126900c46dbe4be3b6425&amp;Email=name.surname@company.com</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=c1b6e3d50632d4f5c0ae13a52d3c4d8d&amp;Email=name.surname@company.com</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=bfba7d7023220c59d06e76f0085d6573&amp;Email=name.surname@company.com</p>
    <p>DGA</p>
    <p>hxxp://uvyqifymelapuvoh.biz/s531ka.ji5</p>
    <p>hxxp://uvyqifymelapuvoh.biz/rl59c281.x19</p>
    <p>hxxp://uvyqifymelapuvoh.biz/seibpn6.2m0</p>
    <p>hxxp://uvyqifymelapuvoh.biz/3854f.u17</p>
    <p>hxxp://uvyqifymelapuvoh.biz/06hk3j.449</p>
    <p>DGA</p>
    <p>hxxp://ukhealer.net/u/?a=KELQFAJusqu6Gd33DB0T1zATPwoXsmYFciyO9THSYS7na3zZfVczZ8GzHHydLYn8hVyiy1l0...</p>
    <p>hxxp://sethealer.com/u/?a=L4ZTRAn2VVC9F -BkobTaxsNyaqCKxReHIOOWoVFdYZxFkES4Y mBgSCaN 1K1rWdeM...</p>
    <p>hxxp://sethealer.net/u/?a=qF1coIn2VVE3OFYDC1NXrm24fgDShSqjFsut7gMXRymFe3zZuFTQPw1lI4X6t2MQIMntv2It...</p>
    <p>hxxp://balustradydrewniane.pl/Fcb7VZ.php?z=23ur4wmxrs2</p>
    <p>Dridex</p>
    <p>hxxp://27.54.174.181/8qV578&amp;$o@HU6Q6S/gz$J0l=iTTH 28%2CM/we20%3D</p>
    <p>hxxp://27.54.174.181/C4GyRx%7E@RY6x /M&amp;N=sq/bW ra4OTJ</p>
    <p>hxxp://27.54.174.181/gPvh+=GO/9RPPfk0%2CzXOYU%20/Vq8Ww/+a m%7Ez</p>
    <p>hxxp://27.54.174.181/qE0my4KIz48Cf3H8wG%7Evpz=iJ%26fqMl%24m/46JoELp=GJww%3D%26Ib+Ar.y3 iu%2D1E/sso</p>
    <p>hxxp://27.54.174.181/kv7tig2s1vslfv&amp;i &amp;/s&amp;no%2Ds83%7E%2B+ns5%2D%3F+%20&amp;1/kjx%26e8x=$.pfilr@s3j66%2D</p>
    <p>InstallCore Monetization hxxp://rp.any-file-opener.org/?pcrc=1559319553&amp;v=2.0 hxxp://utouring.net/search/q/conducing</p>
    <p>hxxp://rp.any-file-opener.org/?pcrc=1132521307&amp;v=2.0 hxxp://utouring.net/go/u/1/r/1647</p>
    <p>hxxp://rp.any-file-opener.org/?pcrc=1123945956&amp;v=2.0 hxxp://utouring.net/go/u/0/r/2675</p>
    <p>hxxp://rp.any-file-opener.org/?pcrc=1075608192&amp;v=2.0 hxxp://utouring.net/search/f/1/q/refiles</p>
    <p>hxxp://rp.any-file-opener.org/?pcrc=995719244&amp;v=2.0 hxxp://utouring.net/search/f/1/q/refiles</p>
    <p>Poweliks</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=nitric+oxide+side+effects&amp;ua=Mozilla . . . &amp;lr=7&amp;ls=0</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=weight+loss+success+stories&amp;ua=Mozilla . . . &amp;lr=0&amp;ls=0</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=shoulder+pain&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=2</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=cheap+car+insurance&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=2</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=natural+testosterone+boosters&amp;ua=Mozilla . . . &amp;lr=7&amp;ls=2</p>
    <p>Zeus</p>
    <p>hxxp://130.185.106.28/m/IbQFdXVjiriLva4KHeNpWCmThrJBn3f34HNwsLVVsUmLXtsumSSPe/zzXtIu9SzwjI . . . 3RqvGzKN5</p>
    <p>hxxp://130.185.106.28/m/IbQJFUVjgZn4vx4KHeNpWCmThrJBn3f34HNwsLVVsUmLfkoPaSS+S+zzXtIu9SzwjI . . . 3vKwmk0oUi</p>
    <p>hxxp://130.185.106.28/m/IbQJFUVjiJwJBX4KHeNpWCmThrJBn3f34HNwsLVVsUmKH7ue2STvSkzzXtIu9SzwjI . . . 3vKwmk0oUi</p>
    <p>hxxp://130.185.106.28/m/IbQNtVVji5/7Yp4KHeNpWCmThrJBn3f34HNwsLVVsUmLz4sO6YRvOjzzXtIu9SzwjI . . . 3zB9057quqv</p>
    <p>hxxp://130.185.106.28/m/IbQG9VVjjSnDM94KHeNpWCmThrJBn3f34HNwsLVVsUmLXpt/+YRue8zzXtIu9SzwjI . . . 6iN5mt6Tj3</p>
    <p>Legitimate trac</p>
    <p>hxxp://www.cnn.com/.a/1.73.0/js/vendor/usabilla.min.js</p>
    <p>hxxp://www.cnn.com/.element/ssi/auto/4.0/sect/MAIN/markets wsod expansion.html</p>
    <p>hxxp://www.cnn.com/.a/1.73.0/assets/sprite-s1dced3ff2b.png</p>
    <p>hxxp://www.cnn.com/.element/widget/video/videoapi/api/latest/js/CNNVideoBootstrapper.js</p>
    <p>hxxp://www.cnn.com/jsonp/video/nowPlayingSchedule.json?callback=nowPlayingScheduleCallbackWrapper&amp; =1422885578476</p>
    <p>Legitimate trac</p>
    <p>hxxp://ads.adaptv.advertising.com/a/h/7g doK40WLPMYHbkD9G2u7HSXjqz . . . &amp;context=fullUrl%3Dpandora.com</p>
    <p>hxxp://ads.adaptv.advertising.com/crossdomain.xml</p>
    <p>hxxp://ads.advertising.com/411f1e96-3bde-4d85-b17e-63749e5f0695.js</p>
    <p>hxxp://ads.advertising.com/ids/411f1e96-3bde-4d85-b17e-63749e5f0695</p>
    <p>hxxp://ads.adaptv.advertising.com/applist?placementId=297920&amp;key=&amp;d.vw=1&amp;orgId=8656&amp;hostname=data.rtbfy.com</p>
    <p>Table 4.3: URLs of flows from selected malicious categories together with two examples of legitimate URLs (at the bottom). You can see that URLs within each malicious bag are similar to each other (as opposed to most of legitimate bags). Small non-zero variability of flow-based feature values is projected into the proposed representation with both types of histograms, which makes the representation more robust to further malware changes and variants.</p>
    <p>Rig Exploit Kit</p>
    <p>Asterope</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=12739868&amp;os=6.128.0.7601.18571&amp;res=41921466&amp;f=1</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=15425581&amp;os=6.128.0.7601.18571&amp;res=41921516&amp;f=1</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=27423103&amp;os=6.128.0.7601.18571&amp;res=41921342&amp;f=1</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3753&amp;id=126&amp;r=8955018&amp;os=6.128.0.7601.18571&amp;res=41921319&amp;f=1</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=31957678&amp;os=6.128.0.7601.18571&amp;res=41921223&amp;f=1</p>
    <p>Click-fraud, malvertising-related botnet</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=024f9730e23f8553c3e5342568a70300&amp;Email=name.surname@company.com</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=c1b6e3d50632d4f5c0ae13a52d3c4d8d&amp;Email=name.surname@company.com</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=7c9a843ce18126900c46dbe4be3b6425&amp;Email=name.surname@company.com</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=c1b6e3d50632d4f5c0ae13a52d3c4d8d&amp;Email=name.surname@company.com</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=bfba7d7023220c59d06e76f0085d6573&amp;Email=name.surname@company.com</p>
    <p>DGA</p>
    <p>hxxp://uvyqifymelapuvoh.biz/s531ka.ji5</p>
    <p>hxxp://uvyqifymelapuvoh.biz/rl59c281.x19</p>
    <p>hxxp://uvyqifymelapuvoh.biz/seibpn6.2m0</p>
    <p>hxxp://uvyqifymelapuvoh.biz/3854f.u17</p>
    <p>hxxp://uvyqifymelapuvoh.biz/06hk3j.449</p>
    <p>DGA</p>
    <p>hxxp://ds.revivefl.org/?x3qJc7iZLBrGAoc=l3SKfPrfJxzFGMSUb-nJDa9BMEXCRQLPh4SGhKrXCJ-ofSih17OIFxzsmT...</p>
    <p>hxxp://ds.revivefl.org/index.php?x3qJc7iZLBrGAoc=l3SMfPrfJxzFGMSUb-nJDa9BMEXCRQLPh4SGhKrXCJ-ofSih17...</p>
    <p>hxxp://ds.revivefl.org/index.php?h4SGhKrXCJ-ofSih17OIFxzsmTu2KV OpqxveN0SZFSOzQfZPVQlyZAdChoB Oqki0v...</p>
    <p>hxxp://balustradydrewniane.pl/Fcb7VZ.php?z=23ur4wmxrs2</p>
    <p>Dridex</p>
    <p>hxxp://27.54.174.181/8qV578&amp;$o@HU6Q6S/gz$J0l=iTTH 28%2CM/we20%3D</p>
    <p>hxxp://27.54.174.181/C4GyRx%7E@RY6x /M&amp;N=sq/bW ra4OTJ</p>
    <p>hxxp://27.54.174.181/gPvh+=GO/9RPPfk0%2CzXOYU%20/Vq8Ww/+a m%7Ez</p>
    <p>hxxp://27.54.174.181/qE0my4KIz48Cf3H8wG%7Evpz=iJ%26fqMl%24m/46JoELp=GJww%3D%26Ib+Ar.y3 iu%2D1E/sso</p>
    <p>hxxp://27.54.174.181/kv7tig2s1vslfv&amp;i &amp;/s&amp;no%2Ds83%7E%2B+ns5%2D%3F+%20&amp;1/kjx%26e8x=$.pfilr@s3j66%2D</p>
    <p>InstallCore Monetization hxxp://rp.any-file-opener.org/?pcrc=1559319553&amp;v=2.0 hxxp://utouring.net/search/q/conducing</p>
    <p>hxxp://rp.any-file-opener.org/?pcrc=1132521307&amp;v=2.0 hxxp://utouring.net/go/u/1/r/1647</p>
    <p>hxxp://rp.any-file-opener.org/?pcrc=1123945956&amp;v=2.0 hxxp://utouring.net/go/u/0/r/2675</p>
    <p>hxxp://rp.any-file-opener.org/?pcrc=1075608192&amp;v=2.0 hxxp://utouring.net/search/f/1/q/refiles</p>
    <p>hxxp://rp.any-file-opener.org/?pcrc=995719244&amp;v=2.0 hxxp://utouring.net/search/f/1/q/refiles</p>
    <p>Poweliks</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=nitric+oxide+side+effects&amp;ua=Mozilla . . . &amp;lr=7&amp;ls=0</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=weight+loss+success+stories&amp;ua=Mozilla . . . &amp;lr=0&amp;ls=0</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=shoulder+pain&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=2</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=cheap+car+insurance&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=2</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=natural+testosterone+boosters&amp;ua=Mozilla . . . &amp;lr=7&amp;ls=2</p>
    <p>Zeus</p>
    <p>hxxp://130.185.106.28/m/IbQFdXVjiriLva4KHeNpWCmThrJBn3f34HNwsLVVsUmLXtsumSSPe/zzXtIu9SzwjI . . . 3RqvGzKN5</p>
    <p>hxxp://130.185.106.28/m/IbQJFUVjgZn4vx4KHeNpWCmThrJBn3f34HNwsLVVsUmLfkoPaSS+S+zzXtIu9SzwjI . . . 3vKwmk0oUi</p>
    <p>hxxp://130.185.106.28/m/IbQJFUVjiJwJBX4KHeNpWCmThrJBn3f34HNwsLVVsUmKH7ue2STvSkzzXtIu9SzwjI . . . 3vKwmk0oUi</p>
    <p>hxxp://130.185.106.28/m/IbQNtVVji5/7Yp4KHeNpWCmThrJBn3f34HNwsLVVsUmLz4sO6YRvOjzzXtIu9SzwjI . . . 3zB9057quqv</p>
    <p>hxxp://130.185.106.28/m/IbQG9VVjjSnDM94KHeNpWCmThrJBn3f34HNwsLVVsUmLXpt/+YRue8zzXtIu9SzwjI . . . 6iN5mt6Tj3</p>
    <p>Legitimate trac</p>
    <p>hxxp://www.cnn.com/.a/1.73.0/js/vendor/usabilla.min.js</p>
    <p>hxxp://www.cnn.com/.element/ssi/auto/4.0/sect/MAIN/markets wsod expansion.html</p>
    <p>hxxp://www.cnn.com/.a/1.73.0/assets/sprite-s1dced3ff2b.png</p>
    <p>hxxp://www.cnn.com/.element/widget/video/videoapi/api/latest/js/CNNVideoBootstrapper.js</p>
    <p>hxxp://www.cnn.com/jsonp/video/nowPlayingSchedule.json?callback=nowPlayingScheduleCallbackWrapper&amp; =1422885578476</p>
    <p>Legitimate trac</p>
    <p>hxxp://ads.adaptv.advertising.com/a/h/7g doK40WLPMYHbkD9G2u7HSXjqz . . . &amp;context=fullUrl%3Dpandora.com</p>
    <p>hxxp://ads.adaptv.advertising.com/crossdomain.xml</p>
    <p>hxxp://ads.advertising.com/411f1e96-3bde-4d85-b17e-63749e5f0695.js</p>
    <p>hxxp://ads.advertising.com/ids/411f1e96-3bde-4d85-b17e-63749e5f0695</p>
    <p>hxxp://ads.adaptv.advertising.com/applist?placementId=297920&amp;key=&amp;d.vw=1&amp;orgId=8656&amp;hostname=data.rtbfy.com</p>
    <p>Table 4.3: URLs of flows from selected malicious categories together with two examples of legitimate URLs (at the bottom). You can see that URLs within each malicious bag are similar to each other (as opposed to most of legitimate bags). Small non-zero variability of flow-based feature values is projected into the proposed representation with both types of histograms, which makes the representation more robust to further malware changes and variants.</p>
    <p>Dridex</p>
    <p>Asterope</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=12739868&amp;os=6.128.0.7601.18571&amp;res=41921466&amp;f=1</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=15425581&amp;os=6.128.0.7601.18571&amp;res=41921516&amp;f=1</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=27423103&amp;os=6.128.0.7601.18571&amp;res=41921342&amp;f=1</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3753&amp;id=126&amp;r=8955018&amp;os=6.128.0.7601.18571&amp;res=41921319&amp;f=1</p>
    <p>hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=31957678&amp;os=6.128.0.7601.18571&amp;res=41921223&amp;f=1</p>
    <p>Click-fraud, malvertising-related botnet</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=024f9730e23f8553c3e5342568a70300&amp;Email=name.surname@company.com</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=c1b6e3d50632d4f5c0ae13a52d3c4d8d&amp;Email=name.surname@company.com</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=7c9a843ce18126900c46dbe4be3b6425&amp;Email=name.surname@company.com</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=c1b6e3d50632d4f5c0ae13a52d3c4d8d&amp;Email=name.surname@company.com</p>
    <p>hxxp://directcashfunds.com/opntrk.php?tkey=bfba7d7023220c59d06e76f0085d6573&amp;Email=name.surname@company.com</p>
    <p>DGA</p>
    <p>hxxp://uvyqifymelapuvoh.biz/s531ka.ji5</p>
    <p>hxxp://uvyqifymelapuvoh.biz/rl59c281.x19</p>
    <p>hxxp://uvyqifymelapuvoh.biz/seibpn6.2m0</p>
    <p>hxxp://uvyqifymelapuvoh.biz/3854f.u17</p>
    <p>hxxp://uvyqifymelapuvoh.biz/06hk3j.449</p>
    <p>DGA</p>
    <p>hxxp://zerosumstudio.com/img5.php?z=smnk91cpnmd</p>
    <p>hxxp://zerosumstudio.com/img5.php?z=sd04vutaog</p>
    <p>hxxp://zemamranews.com/jxke9u.php?z=snmofp2ye0x</p>
    <p>hxxp://balustradydrewniane.pl/Fcb7VZ.php?z=23ur4wmxrs2</p>
    <p>Dridex</p>
    <p>hxxp://27.54.174.181/8qV578&amp;$o@HU6Q6S/gz$J0l=iTTH 28%2CM/we20%3D</p>
    <p>hxxp://27.54.174.181/C4GyRx%7E@RY6x /M&amp;N=sq/bW ra4OTJ</p>
    <p>hxxp://27.54.174.181/gPvh+=GO/9RPPfk0%2CzXOYU%20/Vq8Ww/+a m%7Ez</p>
    <p>hxxp://27.54.174.181/qE0my4KIz48Cf3H8wG%7Evpz=iJ%26fqMl%24m/46JoELp=GJww%3D%26Ib+Ar.y3 iu%2D1E/sso</p>
    <p>hxxp://27.54.174.181/kv7tig2s1vslfv&amp;i &amp;/s&amp;no%2Ds83%7E%2B+ns5%2D%3F+%20&amp;1/kjx%26e8x=$.pfilr@s3j66%2D</p>
    <p>InstallCore Monetization hxxp://rp.any-file-opener.org/?pcrc=1559319553&amp;v=2.0 hxxp://utouring.net/search/q/conducing</p>
    <p>hxxp://rp.any-file-opener.org/?pcrc=1132521307&amp;v=2.0 hxxp://utouring.net/go/u/1/r/1647</p>
    <p>hxxp://rp.any-file-opener.org/?pcrc=1123945956&amp;v=2.0 hxxp://utouring.net/go/u/0/r/2675</p>
    <p>hxxp://rp.any-file-opener.org/?pcrc=1075608192&amp;v=2.0 hxxp://utouring.net/search/f/1/q/refiles</p>
    <p>hxxp://rp.any-file-opener.org/?pcrc=995719244&amp;v=2.0 hxxp://utouring.net/search/f/1/q/refiles</p>
    <p>Poweliks</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=nitric+oxide+side+effects&amp;ua=Mozilla . . . &amp;lr=7&amp;ls=0</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=weight+loss+success+stories&amp;ua=Mozilla . . . &amp;lr=0&amp;ls=0</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=shoulder+pain&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=2</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=cheap+car+insurance&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=2</p>
    <p>hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=natural+testosterone+boosters&amp;ua=Mozilla . . . &amp;lr=7&amp;ls=2</p>
    <p>Zeus</p>
    <p>hxxp://130.185.106.28/m/IbQFdXVjiriLva4KHeNpWCmThrJBn3f34HNwsLVVsUmLXtsumSSPe/zzXtIu9SzwjI . . . 3RqvGzKN5</p>
    <p>hxxp://130.185.106.28/m/IbQJFUVjgZn4vx4KHeNpWCmThrJBn3f34HNwsLVVsUmLfkoPaSS+S+zzXtIu9SzwjI . . . 3vKwmk0oUi</p>
    <p>hxxp://130.185.106.28/m/IbQJFUVjiJwJBX4KHeNpWCmThrJBn3f34HNwsLVVsUmKH7ue2STvSkzzXtIu9SzwjI . . . 3vKwmk0oUi</p>
    <p>hxxp://130.185.106.28/m/IbQNtVVji5/7Yp4KHeNpWCmThrJBn3f34HNwsLVVsUmLz4sO6YRvOjzzXtIu9SzwjI . . . 3zB9057quqv</p>
    <p>hxxp://130.185.106.28/m/IbQG9VVjjSnDM94KHeNpWCmThrJBn3f34HNwsLVVsUmLXpt/+YRue8zzXtIu9SzwjI . . . 6iN5mt6Tj3</p>
    <p>Legitimate trac</p>
    <p>hxxp://www.cnn.com/.a/1.73.0/js/vendor/usabilla.min.js</p>
    <p>hxxp://www.cnn.com/.element/ssi/auto/4.0/sect/MAIN/markets wsod expansion.html</p>
    <p>hxxp://www.cnn.com/.a/1.73.0/assets/sprite-s1dced3ff2b.png</p>
    <p>hxxp://www.cnn.com/.element/widget/video/videoapi/api/latest/js/CNNVideoBootstrapper.js</p>
    <p>hxxp://www.cnn.com/jsonp/video/nowPlayingSchedule.json?callback=nowPlayingScheduleCallbackWrapper&amp; =1422885578476</p>
    <p>Legitimate trac</p>
    <p>hxxp://ads.adaptv.advertising.com/a/h/7g doK40WLPMYHbkD9G2u7HSXjqz . . . &amp;context=fullUrl%3Dpandora.com</p>
    <p>hxxp://ads.adaptv.advertising.com/crossdomain.xml</p>
    <p>hxxp://ads.advertising.com/411f1e96-3bde-4d85-b17e-63749e5f0695.js</p>
    <p>hxxp://ads.advertising.com/ids/411f1e96-3bde-4d85-b17e-63749e5f0695</p>
    <p>hxxp://ads.adaptv.advertising.com/applist?placementId=297920&amp;key=&amp;d.vw=1&amp;orgId=8656&amp;hostname=data.rtbfy.com</p>
    <p>Table 4.3: URLs of flows from selected malicious categories together with two examples of legitimate URLs (at the bottom). You can see that URLs within each malicious bag are similar to each other (as opposed to most of legitimate bags). Small non-zero variability of flow-based feature values is projected into the proposed representation with both types of histograms, which makes the representation more robust to further malware changes and variants.</p>
  </div>
  <div class="page">
    <p>Overview web logs</p>
    <p>...</p>
    <p>vector of flow 1</p>
    <p>...</p>
    <p>...</p>
    <p>vector of flow N</p>
    <p>flow 1</p>
    <p>...</p>
    <p>flow N</p>
    <p>us er</p>
    <p>:h os</p>
    <p>tn am</p>
    <p>e</p>
    <p>feature values</p>
    <p>locally-scaled self-similarity</p>
    <p>matrix</p>
    <p>... 3</p>
    <p>feature differences histogram</p>
    <p>...</p>
    <p>ba g</p>
    <p>fe at</p>
    <p>ur e</p>
    <p>fe at</p>
    <p>ur e</p>
    <p>M</p>
    <p>...</p>
    <p>feature values histogram</p>
    <p>combined final feature vector</p>
    <p>Flow-based</p>
  </div>
  <div class="page">
    <p>Invariant to the following changes:</p>
    <p>- Malicious code, payload, obfuscation - Server or hostname - URL path or filename - Names, values, or number of URL parameters - Encoded URL content - Number of flows - Thinking time - Ordering of flows - Size of flows</p>
    <p>Asterope hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=12739868&amp;os=6.128.0.7601.18571&amp;res=41921466&amp;f=1 hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=15425581&amp;os=6.128.0.7601.18571&amp;res=41921516&amp;f=1 hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=27423103&amp;os=6.128.0.7601.18571&amp;res=41921342&amp;f=1 hxxp://194.165.16.146:8080/pgt/?ver=1.3.3753&amp;id=126&amp;r=8955018&amp;os=6.128.0.7601.18571&amp;res=41921319&amp;f=1 hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=31957678&amp;os=6.128.0.7601.18571&amp;res=41921223&amp;f=1 Click-fraud, malvertising-related botnet hxxp://directcashfunds.com/opntrk.php?tkey=024f9730e23f8553c3e5342568a70300&amp;Email=name.surname@company.com hxxp://directcashfunds.com/opntrk.php?tkey=c1b6e3d50632d4f5c0ae13a52d3c4d8d&amp;Email=name.surname@company.com hxxp://directcashfunds.com/opntrk.php?tkey=7c9a843ce18126900c46dbe4be3b6425&amp;Email=name.surname@company.com hxxp://directcashfunds.com/opntrk.php?tkey=c1b6e3d50632d4f5c0ae13a52d3c4d8d&amp;Email=name.surname@company.com hxxp://directcashfunds.com/opntrk.php?tkey=bfba7d7023220c59d06e76f0085d6573&amp;Email=name.surname@company.com DGA hxxp://uvyqifymelapuvoh.biz/s531ka.ji5 hxxp://uvyqifymelapuvoh.biz/rl59c281.x19 hxxp://uvyqifymelapuvoh.biz/seibpn6.2m0 hxxp://uvyqifymelapuvoh.biz/3854f.u17 hxxp://uvyqifymelapuvoh.biz/06hk3j.449 Dridex hxxp://27.54.174.181/8qV578&amp;$o@HU6Q6S/gz$J0l=iTTH 28%2CM/we20%3D hxxp://27.54.174.181/C4GyRx%7E@RY6x /M&amp;N=sq/bW ra4OTJ hxxp://27.54.174.181/gPvh+=GO/9RPPfk0%2CzXOYU%20/Vq8Ww/+a m%7Ez hxxp://27.54.174.181/qE0my4KIz48Cf3H8wG%7Evpz=iJ%26fqMl%24m/46JoELp=GJww%3D%26Ib+Ar.y3 iu%2D1E/sso hxxp://27.54.174.181/kv7tig2s1vslfv&amp;i &amp;/s&amp;no%2Ds83%7E%2B+ns5%2D%3F+%20&amp;1/kjx%26e8x=$.pfilr@s3j66%2D InstallCore Monetization hxxp://rp.any-file-opener.org/?pcrc=1559319553&amp;v=2.0 hxxp://utouring.net/search/q/conducing hxxp://rp.any-file-opener.org/?pcrc=1132521307&amp;v=2.0 hxxp://utouring.net/go/u/1/r/1647 hxxp://rp.any-file-opener.org/?pcrc=1123945956&amp;v=2.0 hxxp://utouring.net/go/u/0/r/2675 hxxp://rp.any-file-opener.org/?pcrc=1075608192&amp;v=2.0 hxxp://utouring.net/search/f/1/q/refiles hxxp://rp.any-file-opener.org/?pcrc=995719244&amp;v=2.0 hxxp://utouring.net/search/f/1/q/refiles Poweliks hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=nitric+oxide+side+effects&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=0 hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=weight+loss+success+stories&amp;ua=Mozilla%2F5 . . . &amp;lr=0&amp;ls=0 hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=shoulder+pain&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=2 hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=cheap+car+insurance&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=2 hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=natural+testosterone+boosters&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=2 Zeus hxxp://130.185.106.28/m/IbQFdXVjiriLva4KHeNpWCmThrJBn3f34HNwsLVVsUmLXtsumSSPe/zzXtIu9SzwjI9zKlxdE . . . 3RqvGzKN5 hxxp://130.185.106.28/m/IbQJFUVjgZn4vx4KHeNpWCmThrJBn3f34HNwsLVVsUmLfkoPaSS+S+zzXtIu9SzwjI9zKlxdE . . . 3vKwmk0oUi hxxp://130.185.106.28/m/IbQJFUVjiJwJBX4KHeNpWCmThrJBn3f34HNwsLVVsUmKH7ue2STvSkzzXtIu9SzwjI9zKlxdE . . . 3vKwmk0oUi hxxp://130.185.106.28/m/IbQNtVVji5/7Yp4KHeNpWCmThrJBn3f34HNwsLVVsUmLz4sO6YRvOjzzXtIu9SzwjI9zKlxdE . . . 3zB9057quqv hxxp://130.185.106.28/m/IbQG9VVjjSnDM94KHeNpWCmThrJBn3f34HNwsLVVsUmLXpt/+YRue8zzXtIu9SzwjI9zKlxdE . . . 6iN5mt6Tj3 Legitimate traffic hxxp://www.cnn.com/.a/1.73.0/js/vendor/usabilla.min.js hxxp://www.cnn.com/.element/ssi/auto/4.0/sect/MAIN/markets wsod expansion.html hxxp://www.cnn.com/.a/1.73.0/assets/sprite-s1dced3ff2b.png hxxp://www.cnn.com/.element/widget/video/videoapi/api/latest/js/CNNVideoBootstrapper.js hxxp://www.cnn.com/jsonp/video/nowPlayingSchedule.json?callback=nowPlayingScheduleCallbackWrapper&amp; =1422885578476 Legitimate traffic hxxp://ads.adaptv.advertising.com/a/h/7g doK40WLPMYHbkD9G2u7HSXjqzIaa7Bqhslod+u7iQl . . . &amp;context=fullUrl%3Dpandora.com hxxp://ads.adaptv.advertising.com/crossdomain.xml hxxp://ads.advertising.com/411f1e96-3bde-4d85-b17e-63749e5f0695.js hxxp://ads.advertising.com/ids/411f1e96-3bde-4d85-b17e-63749e5f0695 hxxp://ads.adaptv.advertising.com/applist?placementId=297920&amp;key=&amp;d.vw=1&amp;orgId=8656&amp;hostname=data.rtbfy.com</p>
    <p>TABLE IV: URLs of flows from selected malicious categories together with two examples of legitimate URLs (at the bottom). You can see that URLs within each malicious bag are similar to each other (as opposed to most of legitimate bags). Small non-zero variability of flow-based feature values is projected into the proposed representation with both types of histograms, which makes the representation more robust to further malware changes and variants.</p>
    <p>Asterope hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=12739868&amp;os=6.128.0.7601.18571&amp;res=41921466&amp;f=1 hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=15425581&amp;os=6.128.0.7601.18571&amp;res=41921516&amp;f=1 hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=27423103&amp;os=6.128.0.7601.18571&amp;res=41921342&amp;f=1 hxxp://194.165.16.146:8080/pgt/?ver=1.3.3753&amp;id=126&amp;r=8955018&amp;os=6.128.0.7601.18571&amp;res=41921319&amp;f=1 hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=31957678&amp;os=6.128.0.7601.18571&amp;res=41921223&amp;f=1 Click-fraud, malvertising-related botnet hxxp://directcashfunds.com/opntrk.php?tkey=024f9730e23f8553c3e5342568a70300&amp;Email=name.surname@company.com hxxp://directcashfunds.com/opntrk.php?tkey=c1b6e3d50632d4f5c0ae13a52d3c4d8d&amp;Email=name.surname@company.com hxxp://directcashfunds.com/opntrk.php?tkey=7c9a843ce18126900c46dbe4be3b6425&amp;Email=name.surname@company.com hxxp://directcashfunds.com/opntrk.php?tkey=c1b6e3d50632d4f5c0ae13a52d3c4d8d&amp;Email=name.surname@company.com hxxp://directcashfunds.com/opntrk.php?tkey=bfba7d7023220c59d06e76f0085d6573&amp;Email=name.surname@company.com DGA hxxp://uvyqifymelapuvoh.biz/s531ka.ji5 hxxp://uvyqifymelapuvoh.biz/rl59c281.x19 hxxp://uvyqifymelapuvoh.biz/seibpn6.2m0 hxxp://uvyqifymelapuvoh.biz/3854f.u17 hxxp://uvyqifymelapuvoh.biz/06hk3j.449 Dridex hxxp://27.54.174.181/8qV578&amp;$o@HU6Q6S/gz$J0l=iTTH 28%2CM/we20%3D hxxp://27.54.174.181/C4GyRx%7E@RY6x /M&amp;N=sq/bW ra4OTJ hxxp://27.54.174.181/gPvh+=GO/9RPPfk0%2CzXOYU%20/Vq8Ww/+a m%7Ez hxxp://27.54.174.181/qE0my4KIz48Cf3H8wG%7Evpz=iJ%26fqMl%24m/46JoELp=GJww%3D%26Ib+Ar.y3 iu%2D1E/sso hxxp://27.54.174.181/kv7tig2s1vslfv&amp;i &amp;/s&amp;no%2Ds83%7E%2B+ns5%2D%3F+%20&amp;1/kjx%26e8x=$.pfilr@s3j66%2D InstallCore Monetization hxxp://rp.any-file-opener.org/?pcrc=1559319553&amp;v=2.0 hxxp://utouring.net/search/q/conducing hxxp://rp.any-file-opener.org/?pcrc=1132521307&amp;v=2.0 hxxp://utouring.net/go/u/1/r/1647 hxxp://rp.any-file-opener.org/?pcrc=1123945956&amp;v=2.0 hxxp://utouring.net/go/u/0/r/2675 hxxp://rp.any-file-opener.org/?pcrc=1075608192&amp;v=2.0 hxxp://utouring.net/search/f/1/q/refiles hxxp://rp.any-file-opener.org/?pcrc=995719244&amp;v=2.0 hxxp://utouring.net/search/f/1/q/refiles Poweliks hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=nitric+oxide+side+effects&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=0 hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=weight+loss+success+stories&amp;ua=Mozilla%2F5 . . . &amp;lr=0&amp;ls=0 hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=shoulder+pain&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=2 hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=cheap+car+insurance&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=2 hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=natural+testosterone+boosters&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=2 Zeus hxxp://130.185.106.28/m/IbQFdXVjiriLva4KHeNpWCmThrJBn3f34HNwsLVVsUmLXtsumSSPe/zzXtIu9SzwjI9zKlxdE . . . 3RqvGzKN5 hxxp://130.185.106.28/m/IbQJFUVjgZn4vx4KHeNpWCmThrJBn3f34HNwsLVVsUmLfkoPaSS+S+zzXtIu9SzwjI9zKlxdE . . . 3vKwmk0oUi hxxp://130.185.106.28/m/IbQJFUVjiJwJBX4KHeNpWCmThrJBn3f34HNwsLVVsUmKH7ue2STvSkzzXtIu9SzwjI9zKlxdE . . . 3vKwmk0oUi hxxp://130.185.106.28/m/IbQNtVVji5/7Yp4KHeNpWCmThrJBn3f34HNwsLVVsUmLz4sO6YRvOjzzXtIu9SzwjI9zKlxdE . . . 3zB9057quqv hxxp://130.185.106.28/m/IbQG9VVjjSnDM94KHeNpWCmThrJBn3f34HNwsLVVsUmLXpt/+YRue8zzXtIu9SzwjI9zKlxdE . . . 6iN5mt6Tj3 Legitimate traffic hxxp://www.cnn.com/.a/1.73.0/js/vendor/usabilla.min.js hxxp://www.cnn.com/.element/ssi/auto/4.0/sect/MAIN/markets wsod expansion.html hxxp://www.cnn.com/.a/1.73.0/assets/sprite-s1dced3ff2b.png hxxp://www.cnn.com/.element/widget/video/videoapi/api/latest/js/CNNVideoBootstrapper.js hxxp://www.cnn.com/jsonp/video/nowPlayingSchedule.json?callback=nowPlayingScheduleCallbackWrapper&amp; =1422885578476 Legitimate traffic hxxp://ads.adaptv.advertising.com/a/h/7g doK40WLPMYHbkD9G2u7HSXjqzIaa7Bqhslod+u7iQl . . . &amp;context=fullUrl%3Dpandora.com hxxp://ads.adaptv.advertising.com/crossdomain.xml hxxp://ads.advertising.com/411f1e96-3bde-4d85-b17e-63749e5f0695.js hxxp://ads.advertising.com/ids/411f1e96-3bde-4d85-b17e-63749e5f0695 hxxp://ads.adaptv.advertising.com/applist?placementId=297920&amp;key=&amp;d.vw=1&amp;orgId=8656&amp;hostname=data.rtbfy.com</p>
    <p>TABLE IV: URLs of flows from selected malicious categories together with two examples of legitimate URLs (at the bottom). You can see that URLs within each malicious bag are similar to each other (as opposed to most of legitimate bags). Small non-zero variability of flow-based feature values is projected into the proposed representation with both types of histograms, which makes the representation more robust to further malware changes and variants.</p>
  </div>
  <div class="page">
    <p>Not invariant to the following changes:</p>
    <p>- Static behavior is not considered - Multiple behaviors in a bag - Encrypted HTTPS traffic - Real-time changes and fast evolution</p>
    <p>Asterope hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=12739868&amp;os=6.128.0.7601.18571&amp;res=41921466&amp;f=1 hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=15425581&amp;os=6.128.0.7601.18571&amp;res=41921516&amp;f=1 hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=27423103&amp;os=6.128.0.7601.18571&amp;res=41921342&amp;f=1 hxxp://194.165.16.146:8080/pgt/?ver=1.3.3753&amp;id=126&amp;r=8955018&amp;os=6.128.0.7601.18571&amp;res=41921319&amp;f=1 hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=31957678&amp;os=6.128.0.7601.18571&amp;res=41921223&amp;f=1 Click-fraud, malvertising-related botnet hxxp://directcashfunds.com/opntrk.php?tkey=024f9730e23f8553c3e5342568a70300&amp;Email=name.surname@company.com hxxp://directcashfunds.com/opntrk.php?tkey=c1b6e3d50632d4f5c0ae13a52d3c4d8d&amp;Email=name.surname@company.com hxxp://directcashfunds.com/opntrk.php?tkey=7c9a843ce18126900c46dbe4be3b6425&amp;Email=name.surname@company.com hxxp://directcashfunds.com/opntrk.php?tkey=c1b6e3d50632d4f5c0ae13a52d3c4d8d&amp;Email=name.surname@company.com hxxp://directcashfunds.com/opntrk.php?tkey=bfba7d7023220c59d06e76f0085d6573&amp;Email=name.surname@company.com DGA hxxp://uvyqifymelapuvoh.biz/s531ka.ji5 hxxp://uvyqifymelapuvoh.biz/rl59c281.x19 hxxp://uvyqifymelapuvoh.biz/seibpn6.2m0 hxxp://uvyqifymelapuvoh.biz/3854f.u17 hxxp://uvyqifymelapuvoh.biz/06hk3j.449 Dridex hxxp://27.54.174.181/8qV578&amp;$o@HU6Q6S/gz$J0l=iTTH 28%2CM/we20%3D hxxp://27.54.174.181/C4GyRx%7E@RY6x /M&amp;N=sq/bW ra4OTJ hxxp://27.54.174.181/gPvh+=GO/9RPPfk0%2CzXOYU%20/Vq8Ww/+a m%7Ez hxxp://27.54.174.181/qE0my4KIz48Cf3H8wG%7Evpz=iJ%26fqMl%24m/46JoELp=GJww%3D%26Ib+Ar.y3 iu%2D1E/sso hxxp://27.54.174.181/kv7tig2s1vslfv&amp;i &amp;/s&amp;no%2Ds83%7E%2B+ns5%2D%3F+%20&amp;1/kjx%26e8x=$.pfilr@s3j66%2D InstallCore Monetization hxxp://rp.any-file-opener.org/?pcrc=1559319553&amp;v=2.0 hxxp://utouring.net/search/q/conducing hxxp://rp.any-file-opener.org/?pcrc=1132521307&amp;v=2.0 hxxp://utouring.net/go/u/1/r/1647 hxxp://rp.any-file-opener.org/?pcrc=1123945956&amp;v=2.0 hxxp://utouring.net/go/u/0/r/2675 hxxp://rp.any-file-opener.org/?pcrc=1075608192&amp;v=2.0 hxxp://utouring.net/search/f/1/q/refiles hxxp://rp.any-file-opener.org/?pcrc=995719244&amp;v=2.0 hxxp://utouring.net/search/f/1/q/refiles Poweliks hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=nitric+oxide+side+effects&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=0 hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=weight+loss+success+stories&amp;ua=Mozilla%2F5 . . . &amp;lr=0&amp;ls=0 hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=shoulder+pain&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=2 hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=cheap+car+insurance&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=2 hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=natural+testosterone+boosters&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=2 Zeus hxxp://130.185.106.28/m/IbQFdXVjiriLva4KHeNpWCmThrJBn3f34HNwsLVVsUmLXtsumSSPe/zzXtIu9SzwjI9zKlxdE . . . 3RqvGzKN5 hxxp://130.185.106.28/m/IbQJFUVjgZn4vx4KHeNpWCmThrJBn3f34HNwsLVVsUmLfkoPaSS+S+zzXtIu9SzwjI9zKlxdE . . . 3vKwmk0oUi hxxp://130.185.106.28/m/IbQJFUVjiJwJBX4KHeNpWCmThrJBn3f34HNwsLVVsUmKH7ue2STvSkzzXtIu9SzwjI9zKlxdE . . . 3vKwmk0oUi hxxp://130.185.106.28/m/IbQNtVVji5/7Yp4KHeNpWCmThrJBn3f34HNwsLVVsUmLz4sO6YRvOjzzXtIu9SzwjI9zKlxdE . . . 3zB9057quqv hxxp://130.185.106.28/m/IbQG9VVjjSnDM94KHeNpWCmThrJBn3f34HNwsLVVsUmLXpt/+YRue8zzXtIu9SzwjI9zKlxdE . . . 6iN5mt6Tj3 Legitimate traffic hxxp://www.cnn.com/.a/1.73.0/js/vendor/usabilla.min.js hxxp://www.cnn.com/.element/ssi/auto/4.0/sect/MAIN/markets wsod expansion.html hxxp://www.cnn.com/.a/1.73.0/assets/sprite-s1dced3ff2b.png hxxp://www.cnn.com/.element/widget/video/videoapi/api/latest/js/CNNVideoBootstrapper.js hxxp://www.cnn.com/jsonp/video/nowPlayingSchedule.json?callback=nowPlayingScheduleCallbackWrapper&amp; =1422885578476 Legitimate traffic hxxp://ads.adaptv.advertising.com/a/h/7g doK40WLPMYHbkD9G2u7HSXjqzIaa7Bqhslod+u7iQl . . . &amp;context=fullUrl%3Dpandora.com hxxp://ads.adaptv.advertising.com/crossdomain.xml hxxp://ads.advertising.com/411f1e96-3bde-4d85-b17e-63749e5f0695.js hxxp://ads.advertising.com/ids/411f1e96-3bde-4d85-b17e-63749e5f0695 hxxp://ads.adaptv.advertising.com/applist?placementId=297920&amp;key=&amp;d.vw=1&amp;orgId=8656&amp;hostname=data.rtbfy.com</p>
    <p>TABLE IV: URLs of flows from selected malicious categories together with two examples of legitimate URLs (at the bottom). You can see that URLs within each malicious bag are similar to each other (as opposed to most of legitimate bags). Small non-zero variability of flow-based feature values is projected into the proposed representation with both types of histograms, which makes the representation more robust to further malware changes and variants.</p>
    <p>Asterope hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=12739868&amp;os=6.128.0.7601.18571&amp;res=41921466&amp;f=1 hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=15425581&amp;os=6.128.0.7601.18571&amp;res=41921516&amp;f=1 hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=27423103&amp;os=6.128.0.7601.18571&amp;res=41921342&amp;f=1 hxxp://194.165.16.146:8080/pgt/?ver=1.3.3753&amp;id=126&amp;r=8955018&amp;os=6.128.0.7601.18571&amp;res=41921319&amp;f=1 hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=31957678&amp;os=6.128.0.7601.18571&amp;res=41921223&amp;f=1 Click-fraud, malvertising-related botnet hxxp://directcashfunds.com/opntrk.php?tkey=024f9730e23f8553c3e5342568a70300&amp;Email=name.surname@company.com hxxp://directcashfunds.com/opntrk.php?tkey=c1b6e3d50632d4f5c0ae13a52d3c4d8d&amp;Email=name.surname@company.com hxxp://directcashfunds.com/opntrk.php?tkey=7c9a843ce18126900c46dbe4be3b6425&amp;Email=name.surname@company.com hxxp://directcashfunds.com/opntrk.php?tkey=c1b6e3d50632d4f5c0ae13a52d3c4d8d&amp;Email=name.surname@company.com hxxp://directcashfunds.com/opntrk.php?tkey=bfba7d7023220c59d06e76f0085d6573&amp;Email=name.surname@company.com DGA hxxp://uvyqifymelapuvoh.biz/s531ka.ji5 hxxp://uvyqifymelapuvoh.biz/rl59c281.x19 hxxp://uvyqifymelapuvoh.biz/seibpn6.2m0 hxxp://uvyqifymelapuvoh.biz/3854f.u17 hxxp://uvyqifymelapuvoh.biz/06hk3j.449 Dridex hxxp://27.54.174.181/8qV578&amp;$o@HU6Q6S/gz$J0l=iTTH 28%2CM/we20%3D hxxp://27.54.174.181/C4GyRx%7E@RY6x /M&amp;N=sq/bW ra4OTJ hxxp://27.54.174.181/gPvh+=GO/9RPPfk0%2CzXOYU%20/Vq8Ww/+a m%7Ez hxxp://27.54.174.181/qE0my4KIz48Cf3H8wG%7Evpz=iJ%26fqMl%24m/46JoELp=GJww%3D%26Ib+Ar.y3 iu%2D1E/sso hxxp://27.54.174.181/kv7tig2s1vslfv&amp;i &amp;/s&amp;no%2Ds83%7E%2B+ns5%2D%3F+%20&amp;1/kjx%26e8x=$.pfilr@s3j66%2D InstallCore Monetization hxxp://rp.any-file-opener.org/?pcrc=1559319553&amp;v=2.0 hxxp://utouring.net/search/q/conducing hxxp://rp.any-file-opener.org/?pcrc=1132521307&amp;v=2.0 hxxp://utouring.net/go/u/1/r/1647 hxxp://rp.any-file-opener.org/?pcrc=1123945956&amp;v=2.0 hxxp://utouring.net/go/u/0/r/2675 hxxp://rp.any-file-opener.org/?pcrc=1075608192&amp;v=2.0 hxxp://utouring.net/search/f/1/q/refiles hxxp://rp.any-file-opener.org/?pcrc=995719244&amp;v=2.0 hxxp://utouring.net/search/f/1/q/refiles Poweliks hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=nitric+oxide+side+effects&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=0 hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=weight+loss+success+stories&amp;ua=Mozilla%2F5 . . . &amp;lr=0&amp;ls=0 hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=shoulder+pain&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=2 hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=cheap+car+insurance&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=2 hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=natural+testosterone+boosters&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=2 Zeus hxxp://130.185.106.28/m/IbQFdXVjiriLva4KHeNpWCmThrJBn3f34HNwsLVVsUmLXtsumSSPe/zzXtIu9SzwjI9zKlxdE . . . 3RqvGzKN5 hxxp://130.185.106.28/m/IbQJFUVjgZn4vx4KHeNpWCmThrJBn3f34HNwsLVVsUmLfkoPaSS+S+zzXtIu9SzwjI9zKlxdE . . . 3vKwmk0oUi hxxp://130.185.106.28/m/IbQJFUVjiJwJBX4KHeNpWCmThrJBn3f34HNwsLVVsUmKH7ue2STvSkzzXtIu9SzwjI9zKlxdE . . . 3vKwmk0oUi hxxp://130.185.106.28/m/IbQNtVVji5/7Yp4KHeNpWCmThrJBn3f34HNwsLVVsUmLz4sO6YRvOjzzXtIu9SzwjI9zKlxdE . . . 3zB9057quqv hxxp://130.185.106.28/m/IbQG9VVjjSnDM94KHeNpWCmThrJBn3f34HNwsLVVsUmLXpt/+YRue8zzXtIu9SzwjI9zKlxdE . . . 6iN5mt6Tj3 Legitimate traffic hxxp://www.cnn.com/.a/1.73.0/js/vendor/usabilla.min.js hxxp://www.cnn.com/.element/ssi/auto/4.0/sect/MAIN/markets wsod expansion.html hxxp://www.cnn.com/.a/1.73.0/assets/sprite-s1dced3ff2b.png hxxp://www.cnn.com/.element/widget/video/videoapi/api/latest/js/CNNVideoBootstrapper.js hxxp://www.cnn.com/jsonp/video/nowPlayingSchedule.json?callback=nowPlayingScheduleCallbackWrapper&amp; =1422885578476 Legitimate traffic hxxp://ads.adaptv.advertising.com/a/h/7g doK40WLPMYHbkD9G2u7HSXjqzIaa7Bqhslod+u7iQl . . . &amp;context=fullUrl%3Dpandora.com hxxp://ads.adaptv.advertising.com/crossdomain.xml hxxp://ads.advertising.com/411f1e96-3bde-4d85-b17e-63749e5f0695.js hxxp://ads.advertising.com/ids/411f1e96-3bde-4d85-b17e-63749e5f0695 hxxp://ads.adaptv.advertising.com/applist?placementId=297920&amp;key=&amp;d.vw=1&amp;orgId=8656&amp;hostname=data.rtbfy.com</p>
    <p>TABLE IV: URLs of flows from selected malicious categories together with two examples of legitimate URLs (at the bottom). You can see that URLs within each malicious bag are similar to each other (as opposed to most of legitimate bags). Small non-zero variability of flow-based feature values is projected into the proposed representation with both types of histograms, which makes the representation more robust to further malware changes and variants.</p>
    <p>?</p>
    <p>Asterope hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=12739868&amp;os=6.128.0.7601.18571&amp;res=41921466&amp;f=1 hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=15425581&amp;os=6.128.0.7601.18571&amp;res=41921516&amp;f=1 hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=27423103&amp;os=6.128.0.7601.18571&amp;res=41921342&amp;f=1 hxxp://194.165.16.146:8080/pgt/?ver=1.3.3753&amp;id=126&amp;r=8955018&amp;os=6.128.0.7601.18571&amp;res=41921319&amp;f=1 hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=31957678&amp;os=6.128.0.7601.18571&amp;res=41921223&amp;f=1 Click-fraud, malvertising-related botnet hxxp://directcashfunds.com/opntrk.php?tkey=024f9730e23f8553c3e5342568a70300&amp;Email=name.surname@company.com hxxp://directcashfunds.com/opntrk.php?tkey=c1b6e3d50632d4f5c0ae13a52d3c4d8d&amp;Email=name.surname@company.com hxxp://directcashfunds.com/opntrk.php?tkey=7c9a843ce18126900c46dbe4be3b6425&amp;Email=name.surname@company.com hxxp://directcashfunds.com/opntrk.php?tkey=c1b6e3d50632d4f5c0ae13a52d3c4d8d&amp;Email=name.surname@company.com hxxp://directcashfunds.com/opntrk.php?tkey=bfba7d7023220c59d06e76f0085d6573&amp;Email=name.surname@company.com DGA hxxp://uvyqifymelapuvoh.biz/s531ka.ji5 hxxp://uvyqifymelapuvoh.biz/rl59c281.x19 hxxp://uvyqifymelapuvoh.biz/seibpn6.2m0 hxxp://uvyqifymelapuvoh.biz/3854f.u17 hxxp://uvyqifymelapuvoh.biz/06hk3j.449 Dridex hxxp://27.54.174.181/8qV578&amp;$o@HU6Q6S/gz$J0l=iTTH 28%2CM/we20%3D hxxp://27.54.174.181/C4GyRx%7E@RY6x /M&amp;N=sq/bW ra4OTJ hxxp://27.54.174.181/gPvh+=GO/9RPPfk0%2CzXOYU%20/Vq8Ww/+a m%7Ez hxxp://27.54.174.181/qE0my4KIz48Cf3H8wG%7Evpz=iJ%26fqMl%24m/46JoELp=GJww%3D%26Ib+Ar.y3 iu%2D1E/sso hxxp://27.54.174.181/kv7tig2s1vslfv&amp;i &amp;/s&amp;no%2Ds83%7E%2B+ns5%2D%3F+%20&amp;1/kjx%26e8x=$.pfilr@s3j66%2D InstallCore Monetization hxxp://rp.any-file-opener.org/?pcrc=1559319553&amp;v=2.0 hxxp://utouring.net/search/q/conducing hxxp://rp.any-file-opener.org/?pcrc=1132521307&amp;v=2.0 hxxp://utouring.net/go/u/1/r/1647 hxxp://rp.any-file-opener.org/?pcrc=1123945956&amp;v=2.0 hxxp://utouring.net/go/u/0/r/2675 hxxp://rp.any-file-opener.org/?pcrc=1075608192&amp;v=2.0 hxxp://utouring.net/search/f/1/q/refiles hxxp://rp.any-file-opener.org/?pcrc=995719244&amp;v=2.0 hxxp://utouring.net/search/f/1/q/refiles Poweliks hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=nitric+oxide+side+effects&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=0 hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=weight+loss+success+stories&amp;ua=Mozilla%2F5 . . . &amp;lr=0&amp;ls=0 hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=shoulder+pain&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=2 hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=cheap+car+insurance&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=2 hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=natural+testosterone+boosters&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=2 Zeus hxxp://130.185.106.28/m/IbQFdXVjiriLva4KHeNpWCmThrJBn3f34HNwsLVVsUmLXtsumSSPe/zzXtIu9SzwjI9zKlxdE . . . 3RqvGzKN5 hxxp://130.185.106.28/m/IbQJFUVjgZn4vx4KHeNpWCmThrJBn3f34HNwsLVVsUmLfkoPaSS+S+zzXtIu9SzwjI9zKlxdE . . . 3vKwmk0oUi hxxp://130.185.106.28/m/IbQJFUVjiJwJBX4KHeNpWCmThrJBn3f34HNwsLVVsUmKH7ue2STvSkzzXtIu9SzwjI9zKlxdE . . . 3vKwmk0oUi hxxp://130.185.106.28/m/IbQNtVVji5/7Yp4KHeNpWCmThrJBn3f34HNwsLVVsUmLz4sO6YRvOjzzXtIu9SzwjI9zKlxdE . . . 3zB9057quqv hxxp://130.185.106.28/m/IbQG9VVjjSnDM94KHeNpWCmThrJBn3f34HNwsLVVsUmLXpt/+YRue8zzXtIu9SzwjI9zKlxdE . . . 6iN5mt6Tj3 Legitimate traffic hxxp://www.cnn.com/.a/1.73.0/js/vendor/usabilla.min.js hxxp://www.cnn.com/.element/ssi/auto/4.0/sect/MAIN/markets wsod expansion.html hxxp://www.cnn.com/.a/1.73.0/assets/sprite-s1dced3ff2b.png hxxp://www.cnn.com/.element/widget/video/videoapi/api/latest/js/CNNVideoBootstrapper.js hxxp://www.cnn.com/jsonp/video/nowPlayingSchedule.json?callback=nowPlayingScheduleCallbackWrapper&amp; =1422885578476 Legitimate traffic hxxp://ads.adaptv.advertising.com/a/h/7g doK40WLPMYHbkD9G2u7HSXjqzIaa7Bqhslod+u7iQl . . . &amp;context=fullUrl%3Dpandora.com hxxp://ads.adaptv.advertising.com/crossdomain.xml hxxp://ads.advertising.com/411f1e96-3bde-4d85-b17e-63749e5f0695.js hxxp://ads.advertising.com/ids/411f1e96-3bde-4d85-b17e-63749e5f0695 hxxp://ads.adaptv.advertising.com/applist?placementId=297920&amp;key=&amp;d.vw=1&amp;orgId=8656&amp;hostname=data.rtbfy.com</p>
    <p>TABLE IV: URLs of flows from selected malicious categories together with two examples of legitimate URLs (at the bottom). You can see that URLs within each malicious bag are similar to each other (as opposed to most of legitimate bags). Small non-zero variability of flow-based feature values is projected into the proposed representation with both types of histograms, which makes the representation more robust to further malware changes and variants.</p>
    <p>Asterope hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=12739868&amp;os=6.128.0.7601.18571&amp;res=41921466&amp;f=1 hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=15425581&amp;os=6.128.0.7601.18571&amp;res=41921516&amp;f=1 hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=27423103&amp;os=6.128.0.7601.18571&amp;res=41921342&amp;f=1 hxxp://194.165.16.146:8080/pgt/?ver=1.3.3753&amp;id=126&amp;r=8955018&amp;os=6.128.0.7601.18571&amp;res=41921319&amp;f=1 hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=31957678&amp;os=6.128.0.7601.18571&amp;res=41921223&amp;f=1 Click-fraud, malvertising-related botnet hxxp://directcashfunds.com/opntrk.php?tkey=024f9730e23f8553c3e5342568a70300&amp;Email=name.surname@company.com hxxp://directcashfunds.com/opntrk.php?tkey=c1b6e3d50632d4f5c0ae13a52d3c4d8d&amp;Email=name.surname@company.com hxxp://directcashfunds.com/opntrk.php?tkey=7c9a843ce18126900c46dbe4be3b6425&amp;Email=name.surname@company.com hxxp://directcashfunds.com/opntrk.php?tkey=c1b6e3d50632d4f5c0ae13a52d3c4d8d&amp;Email=name.surname@company.com hxxp://directcashfunds.com/opntrk.php?tkey=bfba7d7023220c59d06e76f0085d6573&amp;Email=name.surname@company.com DGA hxxp://uvyqifymelapuvoh.biz/s531ka.ji5 hxxp://uvyqifymelapuvoh.biz/rl59c281.x19 hxxp://uvyqifymelapuvoh.biz/seibpn6.2m0 hxxp://uvyqifymelapuvoh.biz/3854f.u17 hxxp://uvyqifymelapuvoh.biz/06hk3j.449 Dridex hxxp://27.54.174.181/8qV578&amp;$o@HU6Q6S/gz$J0l=iTTH 28%2CM/we20%3D hxxp://27.54.174.181/C4GyRx%7E@RY6x /M&amp;N=sq/bW ra4OTJ hxxp://27.54.174.181/gPvh+=GO/9RPPfk0%2CzXOYU%20/Vq8Ww/+a m%7Ez hxxp://27.54.174.181/qE0my4KIz48Cf3H8wG%7Evpz=iJ%26fqMl%24m/46JoELp=GJww%3D%26Ib+Ar.y3 iu%2D1E/sso hxxp://27.54.174.181/kv7tig2s1vslfv&amp;i &amp;/s&amp;no%2Ds83%7E%2B+ns5%2D%3F+%20&amp;1/kjx%26e8x=$.pfilr@s3j66%2D InstallCore Monetization hxxp://rp.any-file-opener.org/?pcrc=1559319553&amp;v=2.0 hxxp://utouring.net/search/q/conducing hxxp://rp.any-file-opener.org/?pcrc=1132521307&amp;v=2.0 hxxp://utouring.net/go/u/1/r/1647 hxxp://rp.any-file-opener.org/?pcrc=1123945956&amp;v=2.0 hxxp://utouring.net/go/u/0/r/2675 hxxp://rp.any-file-opener.org/?pcrc=1075608192&amp;v=2.0 hxxp://utouring.net/search/f/1/q/refiles hxxp://rp.any-file-opener.org/?pcrc=995719244&amp;v=2.0 hxxp://utouring.net/search/f/1/q/refiles Poweliks hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=nitric+oxide+side+effects&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=0 hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=weight+loss+success+stories&amp;ua=Mozilla%2F5 . . . &amp;lr=0&amp;ls=0 hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=shoulder+pain&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=2 hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=cheap+car+insurance&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=2 hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=natural+testosterone+boosters&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=2 Zeus hxxp://130.185.106.28/m/IbQFdXVjiriLva4KHeNpWCmThrJBn3f34HNwsLVVsUmLXtsumSSPe/zzXtIu9SzwjI9zKlxdE . . . 3RqvGzKN5 hxxp://130.185.106.28/m/IbQJFUVjgZn4vx4KHeNpWCmThrJBn3f34HNwsLVVsUmLfkoPaSS+S+zzXtIu9SzwjI9zKlxdE . . . 3vKwmk0oUi hxxp://130.185.106.28/m/IbQJFUVjiJwJBX4KHeNpWCmThrJBn3f34HNwsLVVsUmKH7ue2STvSkzzXtIu9SzwjI9zKlxdE . . . 3vKwmk0oUi hxxp://130.185.106.28/m/IbQNtVVji5/7Yp4KHeNpWCmThrJBn3f34HNwsLVVsUmLz4sO6YRvOjzzXtIu9SzwjI9zKlxdE . . . 3zB9057quqv hxxp://130.185.106.28/m/IbQG9VVjjSnDM94KHeNpWCmThrJBn3f34HNwsLVVsUmLXpt/+YRue8zzXtIu9SzwjI9zKlxdE . . . 6iN5mt6Tj3 Legitimate traffic hxxp://www.cnn.com/.a/1.73.0/js/vendor/usabilla.min.js hxxp://www.cnn.com/.element/ssi/auto/4.0/sect/MAIN/markets wsod expansion.html hxxp://www.cnn.com/.a/1.73.0/assets/sprite-s1dced3ff2b.png hxxp://www.cnn.com/.element/widget/video/videoapi/api/latest/js/CNNVideoBootstrapper.js hxxp://www.cnn.com/jsonp/video/nowPlayingSchedule.json?callback=nowPlayingScheduleCallbackWrapper&amp; =1422885578476 Legitimate traffic hxxp://ads.adaptv.advertising.com/a/h/7g doK40WLPMYHbkD9G2u7HSXjqzIaa7Bqhslod+u7iQl . . . &amp;context=fullUrl%3Dpandora.com hxxp://ads.adaptv.advertising.com/crossdomain.xml hxxp://ads.advertising.com/411f1e96-3bde-4d85-b17e-63749e5f0695.js hxxp://ads.advertising.com/ids/411f1e96-3bde-4d85-b17e-63749e5f0695 hxxp://ads.adaptv.advertising.com/applist?placementId=297920&amp;key=&amp;d.vw=1&amp;orgId=8656&amp;hostname=data.rtbfy.com</p>
    <p>TABLE IV: URLs of flows from selected malicious categories together with two examples of legitimate URLs (at the bottom). You can see that URLs within each malicious bag are similar to each other (as opposed to most of legitimate bags). Small non-zero variability of flow-based feature values is projected into the proposed representation with both types of histograms, which makes the representation more robust to further malware changes and variants.</p>
    <p>Asterope hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=12739868&amp;os=6.128.0.7601.18571&amp;res=41921466&amp;f=1 hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=15425581&amp;os=6.128.0.7601.18571&amp;res=41921516&amp;f=1 hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=27423103&amp;os=6.128.0.7601.18571&amp;res=41921342&amp;f=1 hxxp://194.165.16.146:8080/pgt/?ver=1.3.3753&amp;id=126&amp;r=8955018&amp;os=6.128.0.7601.18571&amp;res=41921319&amp;f=1 hxxp://194.165.16.146:8080/pgt/?ver=1.3.3398&amp;id=126&amp;r=31957678&amp;os=6.128.0.7601.18571&amp;res=41921223&amp;f=1 Click-fraud, malvertising-related botnet hxxp://directcashfunds.com/opntrk.php?tkey=024f9730e23f8553c3e5342568a70300&amp;Email=name.surname@company.com hxxp://directcashfunds.com/opntrk.php?tkey=c1b6e3d50632d4f5c0ae13a52d3c4d8d&amp;Email=name.surname@company.com hxxp://directcashfunds.com/opntrk.php?tkey=7c9a843ce18126900c46dbe4be3b6425&amp;Email=name.surname@company.com hxxp://directcashfunds.com/opntrk.php?tkey=c1b6e3d50632d4f5c0ae13a52d3c4d8d&amp;Email=name.surname@company.com hxxp://directcashfunds.com/opntrk.php?tkey=bfba7d7023220c59d06e76f0085d6573&amp;Email=name.surname@company.com DGA hxxp://uvyqifymelapuvoh.biz/s531ka.ji5 hxxp://uvyqifymelapuvoh.biz/rl59c281.x19 hxxp://uvyqifymelapuvoh.biz/seibpn6.2m0 hxxp://uvyqifymelapuvoh.biz/3854f.u17 hxxp://uvyqifymelapuvoh.biz/06hk3j.449 Dridex hxxp://27.54.174.181/8qV578&amp;$o@HU6Q6S/gz$J0l=iTTH 28%2CM/we20%3D hxxp://27.54.174.181/C4GyRx%7E@RY6x /M&amp;N=sq/bW ra4OTJ hxxp://27.54.174.181/gPvh+=GO/9RPPfk0%2CzXOYU%20/Vq8Ww/+a m%7Ez hxxp://27.54.174.181/qE0my4KIz48Cf3H8wG%7Evpz=iJ%26fqMl%24m/46JoELp=GJww%3D%26Ib+Ar.y3 iu%2D1E/sso hxxp://27.54.174.181/kv7tig2s1vslfv&amp;i &amp;/s&amp;no%2Ds83%7E%2B+ns5%2D%3F+%20&amp;1/kjx%26e8x=$.pfilr@s3j66%2D InstallCore Monetization hxxp://rp.any-file-opener.org/?pcrc=1559319553&amp;v=2.0 hxxp://utouring.net/search/q/conducing hxxp://rp.any-file-opener.org/?pcrc=1132521307&amp;v=2.0 hxxp://utouring.net/go/u/1/r/1647 hxxp://rp.any-file-opener.org/?pcrc=1123945956&amp;v=2.0 hxxp://utouring.net/go/u/0/r/2675 hxxp://rp.any-file-opener.org/?pcrc=1075608192&amp;v=2.0 hxxp://utouring.net/search/f/1/q/refiles hxxp://rp.any-file-opener.org/?pcrc=995719244&amp;v=2.0 hxxp://utouring.net/search/f/1/q/refiles Poweliks hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=nitric+oxide+side+effects&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=0 hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=weight+loss+success+stories&amp;ua=Mozilla%2F5 . . . &amp;lr=0&amp;ls=0 hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=shoulder+pain&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=2 hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=cheap+car+insurance&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=2 hxxp://31.184.194.39/query?version=1.7&amp;sid=793&amp;builddate=114&amp;q=natural+testosterone+boosters&amp;ua=Mozilla%2F5 . . . &amp;lr=7&amp;ls=2 Zeus hxxp://130.185.106.28/m/IbQFdXVjiriLva4KHeNpWCmThrJBn3f34HNwsLVVsUmLXtsumSSPe/zzXtIu9SzwjI9zKlxdE . . . 3RqvGzKN5 hxxp://130.185.106.28/m/IbQJFUVjgZn4vx4KHeNpWCmThrJBn3f34HNwsLVVsUmLfkoPaSS+S+zzXtIu9SzwjI9zKlxdE . . . 3vKwmk0oUi hxxp://130.185.106.28/m/IbQJFUVjiJwJBX4KHeNpWCmThrJBn3f34HNwsLVVsUmKH7ue2STvSkzzXtIu9SzwjI9zKlxdE . . . 3vKwmk0oUi hxxp://130.185.106.28/m/IbQNtVVji5/7Yp4KHeNpWCmThrJBn3f34HNwsLVVsUmLz4sO6YRvOjzzXtIu9SzwjI9zKlxdE . . . 3zB9057quqv hxxp://130.185.106.28/m/IbQG9VVjjSnDM94KHeNpWCmThrJBn3f34HNwsLVVsUmLXpt/+YRue8zzXtIu9SzwjI9zKlxdE . . . 6iN5mt6Tj3 Legitimate traffic hxxp://www.cnn.com/.a/1.73.0/js/vendor/usabilla.min.js hxxp://www.cnn.com/.element/ssi/auto/4.0/sect/MAIN/markets wsod expansion.html hxxp://www.cnn.com/.a/1.73.0/assets/sprite-s1dced3ff2b.png hxxp://www.cnn.com/.element/widget/video/videoapi/api/latest/js/CNNVideoBootstrapper.js hxxp://www.cnn.com/jsonp/video/nowPlayingSchedule.json?callback=nowPlayingScheduleCallbackWrapper&amp; =1422885578476 Legitimate traffic hxxp://ads.adaptv.advertising.com/a/h/7g doK40WLPMYHbkD9G2u7HSXjqzIaa7Bqhslod+u7iQl . . . &amp;context=fullUrl%3Dpandora.com hxxp://ads.adaptv.advertising.com/crossdomain.xml hxxp://ads.advertising.com/411f1e96-3bde-4d85-b17e-63749e5f0695.js hxxp://ads.advertising.com/ids/411f1e96-3bde-4d85-b17e-63749e5f0695 hxxp://ads.adaptv.advertising.com/applist?placementId=297920&amp;key=&amp;d.vw=1&amp;orgId=8656&amp;hostname=data.rtbfy.com</p>
    <p>TABLE IV: URLs of flows from selected malicious categories together with two examples of legitimate URLs (at the bottom). You can see that URLs within each malicious bag are similar to each other (as opposed to most of legitimate bags). Small non-zero variability of flow-based feature values is projected into the proposed representation with both types of histograms, which makes the representation more robust to further malware changes and variants.</p>
  </div>
  <div class="page">
    <p>Parameters of the Representation Number of bins, all of them are equidistant  major impact on the results How to choose the correct number?</p>
    <p>We want to learn the parameters automatically from the data</p>
  </div>
  <div class="page">
    <p>Proposed Optimization Algorithm 1) Define the initial number of mini-bins (256) 2) Find a set of weights by solving:</p>
    <p>web logs</p>
    <p>...</p>
    <p>vector of flow 1</p>
    <p>...</p>
    <p>...</p>
    <p>vector of flow N</p>
    <p>flow 1</p>
    <p>...</p>
    <p>flow N</p>
    <p>us er</p>
    <p>:h os</p>
    <p>tn am</p>
    <p>e</p>
    <p>feature values</p>
    <p>locally-scaled self-similarity</p>
    <p>matrix</p>
    <p>... 3</p>
    <p>feature differences histogram</p>
    <p>...</p>
    <p>ba g</p>
    <p>fe at</p>
    <p>ur e</p>
    <p>fe at</p>
    <p>ur e</p>
    <p>M</p>
    <p>...</p>
    <p>feature values histogram</p>
    <p>combined final feature vector</p>
    <p>Fig. 1: Graphical illustration of the individual steps that are needed to transform the bag (set of flows with the same user and hostname) into the proposed invariant representation. First, the bag is represented with a standard feature vector (1). Then feature values histograms of locally scaled feature values are computed for each feature separately (2). Next, the locallyscaled self-similarity matrix is computed for each feature (3) to capture inner differences. This matrix is then transformed into feature differences histogram (4), which is invariant on the number or the ordering of the samples within the bag. Finally, feature values and feature differences histograms of all features are concatenated into resulting feature vector.</p>
    <p>The input instance z is represented via a feature map : Rnm ! Rnb defined as a concatenation of the normalized histograms of all vectors in that sequence, that is, (z; ) = ((z1; 1), . . . , (zn; n)), where  = (1, . . . , n) denotes bin edges of all normalized histograms stacked to a single vector.</p>
    <p>We aim at designing a classifier h: Rnm  Rn+1  Rn(b+1) ! {1, +1} working on top of the histogram representation, that is</p>
    <p>h(z; w, w0, ) = sign(h(z, w)i + w0)</p>
    <p>= sign</p>
    <p>@ nX</p>
    <p>i=1</p>
    <p>bX</p>
    <p>j=1</p>
    <p>(zi, i,j1, i,j)wi,j + w0</p>
    <p>A . (8)</p>
    <p>The classifier (8) is linear in the parameters (w, w0) but nonlinear in  and z. We are going to show how to learn parameters (w, w0) and implicitly also  via a convex optimization.</p>
    <p>Assume we are given a training set of examples {(z1, y1), . . . , (zm, ym)} 2 (Rnm{+1, 1})m. We fix the representation  such that the number of bins b is sufficiently large and the bin edges  are equally spaced. We find the weights (w, w0) by solving</p>
    <p>min</p>
    <p>w2Rbp,w02R</p>
    <p>nX</p>
    <p>i=1</p>
    <p>b1X</p>
    <p>j=1</p>
    <p>|wi,j  wi,j+1|</p>
    <p>+</p>
    <p>m</p>
    <p>mX</p>
    <p>i=1</p>
    <p>max</p>
    <p>0, 1  yih(zi; ), wi}</p>
    <p># . (9)</p>
    <p>The objective is a sum of two convex terms. The second term is the standard hinge-loss surrogate of the training classification error. The first term is a regularization encouraging weights of neighboring bins to be similar. If it happens that j-th and j +1 bin of the i-the histogram have the same weight, wi,j = wi,j+1 = w, then these bins can be effectively merged to a single bin because</p>
    <p>wi,j(zi; i,j1, i,j) + wi,j+1(zi; i,j, i,j+1)</p>
    <p>= 2w(zi; i,j1, i,j+1) . (10)</p>
    <p>The trade-off constant  &gt; 0 can be used to control the number of merged bins. A large value of  will result in massive merging and consequently in a small number of resulting bins. Hence the objective of the problem (9) is to minimize the training error and to simultaneously control the number of resulting bins. The number of bins influences the expressive power of the classifier and thus also the generalization of the classifier. The optimal setting of  is found by tuning its value on a validation set.</p>
    <p>Once the problem (9) is solved, we use the resulting weights w</p>
    <p>to construct a new set of bin edges  such that we merge the original bins if the neighboring weights have the same sign (i.e. if wi,jw</p>
    <p>i,j+1 &gt; 0). This implies that the new bin edges</p>
    <p>are a subset of the original bin edges , however, their number can be significantly reduced (depending on ) and they have different widths unlike the original bins. Having the new bins defined, we learn a new set of weights by the standard SVM algorithm</p>
    <p>min</p>
    <p>w2Rn,w02R</p>
    <p>&quot;  2</p>
    <p>kwk2 + 1</p>
    <p>m</p>
    <p>mX</p>
    <p>i=1</p>
    <p>max</p>
    <p>0, 1  yih(zi; ), wi}</p>
    <p># .</p>
    <p>Note that we could add the quadratic regularizer  2 kwk2 to the</p>
    <p>objective of (9) and learn the weights and the representation in a single stage. However, this would require tuning two regularization parameters ( and ) simultaneously which would be order of magnitude more expensive than tuning them separately in the two stage approach.</p>
    <p>VI. MALWARE REPRESENTATION EXAMPLE This Section illustrates how the proposed representation is</p>
    <p>calculated for two real-world examples of malicious behavior. Namely, two versions of a polymorphic malware Sality are compared. Sality [14] is a malware family that has become a dynamic and complex form of malicious infection. It utilizes polymorphic techniques to infect files of Widows machines. Signature-based systems or classifiers trained on a specific malware type often struggles with detecting new variants of this kind of malware. Note that most of the conclusions to the discussion that follows can be drawn for many other malware threats.</p>
    <p>Figure 2 shows how the two Sality samples are represented with the proposed approach. First, the input flows are grouped into two bags (one bag for each Sality sample), because all flows of each bag have the same user and the same hostname (1). For the sake of simplicity, only URLs of the corresponding flows are displayed. Next, 88 flow-based feature vectors are</p>
    <p>web logs</p>
    <p>...</p>
    <p>vector of flow 1</p>
    <p>...</p>
    <p>...</p>
    <p>vector of flow N</p>
    <p>flow 1</p>
    <p>...</p>
    <p>flow N</p>
    <p>us er</p>
    <p>:h os</p>
    <p>tn am</p>
    <p>e</p>
    <p>feature values</p>
    <p>locally-scaled self-similarity</p>
    <p>matrix</p>
    <p>... 3</p>
    <p>feature differences histogram</p>
    <p>...</p>
    <p>ba g</p>
    <p>fe at</p>
    <p>ur e</p>
    <p>fe at</p>
    <p>ur e</p>
    <p>M</p>
    <p>...</p>
    <p>feature values histogram</p>
    <p>combined final feature vector</p>
    <p>Fig. 1: Graphical illustration of the individual steps that are needed to transform the bag (set of flows with the same user and hostname) into the proposed invariant representation. First, the bag is represented with a standard feature vector (1). Then feature values histograms of locally scaled feature values are computed for each feature separately (2). Next, the locallyscaled self-similarity matrix is computed for each feature (3) to capture inner differences. This matrix is then transformed into feature differences histogram (4), which is invariant on the number or the ordering of the samples within the bag. Finally, feature values and feature differences histograms of all features are concatenated into resulting feature vector.</p>
    <p>The input instance z is represented via a feature map : Rnm ! Rnb defined as a concatenation of the normalized histograms of all vectors in that sequence, that is, (z; ) = ((z1; 1), . . . , (zn; n)), where  = (1, . . . , n) denotes bin edges of all normalized histograms stacked to a single vector.</p>
    <p>We aim at designing a classifier h: Rnm  Rn+1  Rn(b+1) ! {1, +1} working on top of the histogram representation, that is</p>
    <p>h(z; w, w0, ) = sign(h(z, w)i + w0)</p>
    <p>= sign</p>
    <p>@ nX</p>
    <p>i=1</p>
    <p>bX</p>
    <p>j=1</p>
    <p>(zi, i,j1, i,j)wi,j + w0</p>
    <p>A . (8)</p>
    <p>The classifier (8) is linear in the parameters (w, w0) but nonlinear in  and z. We are going to show how to learn parameters (w, w0) and implicitly also  via a convex optimization.</p>
    <p>Assume we are given a training set of examples {(z1, y1), . . . , (zm, ym)} 2 (Rnm{+1, 1})m. We fix the representation  such that the number of bins b is sufficiently large and the bin edges  are equally spaced. We find the weights (w, w0) by solving</p>
    <p>min</p>
    <p>w2Rbp,w02R</p>
    <p>nX</p>
    <p>i=1</p>
    <p>b1X</p>
    <p>j=1</p>
    <p>|wi,j  wi,j+1|</p>
    <p>+</p>
    <p>m</p>
    <p>mX</p>
    <p>i=1</p>
    <p>max</p>
    <p>0, 1  yih(zi; ), wi}</p>
    <p># . (9)</p>
    <p>The objective is a sum of two convex terms. The second term is the standard hinge-loss surrogate of the training classification error. The first term is a regularization encouraging weights of neighboring bins to be similar. If it happens that j-th and j +1 bin of the i-the histogram have the same weight, wi,j = wi,j+1 = w, then these bins can be effectively merged to a single bin because</p>
    <p>wi,j(zi; i,j1, i,j) + wi,j+1(zi; i,j, i,j+1)</p>
    <p>= 2w(zi; i,j1, i,j+1) . (10)</p>
    <p>The trade-off constant  &gt; 0 can be used to control the number of merged bins. A large value of  will result in massive merging and consequently in a small number of resulting bins. Hence the objective of the problem (9) is to minimize the training error and to simultaneously control the number of resulting bins. The number of bins influences the expressive power of the classifier and thus also the generalization of the classifier. The optimal setting of  is found by tuning its value on a validation set.</p>
    <p>Once the problem (9) is solved, we use the resulting weights w</p>
    <p>to construct a new set of bin edges  such that we merge the original bins if the neighboring weights have the same sign (i.e. if wi,jw</p>
    <p>i,j+1 &gt; 0). This implies that the new bin edges</p>
    <p>are a subset of the original bin edges , however, their number can be significantly reduced (depending on ) and they have different widths unlike the original bins. Having the new bins defined, we learn a new set of weights by the standard SVM algorithm</p>
    <p>min</p>
    <p>w2Rn,w02R</p>
    <p>&quot;  2</p>
    <p>kwk2 + 1</p>
    <p>m</p>
    <p>mX</p>
    <p>i=1</p>
    <p>max</p>
    <p>0, 1  yih(zi; ), wi}</p>
    <p># .</p>
    <p>Note that we could add the quadratic regularizer  2 kwk2 to the</p>
    <p>objective of (9) and learn the weights and the representation in a single stage. However, this would require tuning two regularization parameters ( and ) simultaneously which would be order of magnitude more expensive than tuning them separately in the two stage approach.</p>
    <p>VI. MALWARE REPRESENTATION EXAMPLE This Section illustrates how the proposed representation is</p>
    <p>calculated for two real-world examples of malicious behavior. Namely, two versions of a polymorphic malware Sality are compared. Sality [14] is a malware family that has become a dynamic and complex form of malicious infection. It utilizes polymorphic techniques to infect files of Widows machines. Signature-based systems or classifiers trained on a specific malware type often struggles with detecting new variants of this kind of malware. Note that most of the conclusions to the discussion that follows can be drawn for many other malware threats.</p>
    <p>Figure 2 shows how the two Sality samples are represented with the proposed approach. First, the input flows are grouped into two bags (one bag for each Sality sample), because all flows of each bag have the same user and the same hostname (1). For the sake of simplicity, only URLs of the corresponding flows are displayed. Next, 88 flow-based feature vectors are</p>
    <p>merging hinge loss</p>
  </div>
  <div class="page">
    <p>Experiments  Dataset Description</p>
    <p>Training data: positives: 8 mw categories negatives: company A</p>
    <p>Testing data:</p>
    <p>positives: 24 unseen mw categories negatives: company B</p>
    <p>Features 1 2 3 4 5 6 7 8 9 10 11 12 13 14</p>
    <p>N or</p>
    <p>m al</p>
    <p>iz ed</p>
    <p>E nt</p>
    <p>ro py</p>
    <p>Malicious traffic Legitimate traffic</p>
    <p>Fig. 4: Normalized entropy describing the variability of feature values for all malicious and legitimate traffic. Most of the features are not stable even across malware categories. The variability of the feature values of legitimate traffic is shown for a comparison.</p>
    <p>Category Samples Signature-based deviceFlows Bags TPs Recall Training Positives 132,756 5,011 736 0.15 Click-fraud mw 12,091 819 238 0.29 DGA malware 8,629 397 231 0.58 Dridex 8,402 264 31 0.12 IntallCore 17,317 1,332 0 0.00 Monetization 3,107 135 0 0.00 Mudrop 37,142 701 0 0.00 Poweliks 11,648 132 0 0.00 Zeus 34,420 1,275 236 0.19 Testing Positives 43,380 2,090 48 0.02 Training Negatives 862,478 26,825 Testing Negatives 15,379,466 240,549</p>
    <p>TABLE II: Number of flows and bags of malware categories and legitimate background traffic used for training and testing the proposed representation and SVM classifier. Right-most column shows the amount of bags that were found and blocked by an existing signature-based device. Majority of the malicious bags from the test were missed, as the device, relying on a static database of signatures, was not able to catch evolving versions and new types of the malicious behaviors.</p>
    <p>with unseen behaviors. The classifier training requires a small amount of positive samples to converge and is less prone to over-fitting.</p>
    <p>This data-driven classification system can be easily combined with most security architectures to complement current security devices, such as anti-viruses, firewalls, or other highprecision signature-based systems. Even though the precision of any robust data-driven classification system is lower when compared to signature-based systems, the results can be correlated and a priority score can be assigned to each security incident. Once all known threats identified with signatures are mitigated, additional incidents including new and unseen threats reported by a data-driven system can be further investigated.</p>
    <p>IX. EXPERIMENTAL EVALUATION The proposed representation was applied to classify unseen</p>
    <p>malware bags. Next section provides the specification of datasets and malware categories, followed by the results from</p>
    <p>the experimental evaluation. We will show that an SVM classifier trained on the proposed invariant representation achieves significantly better efficacy results when compared to the baseline flow-based representation that is used in previously published work. Furthermore, this result was significantly exceeded when both the representation and the classifier are learned from the data, as described in Section V.</p>
    <p>A. Specification of the Datasets</p>
    <p>This section provides a detailed description of the datasets, labeled malware samples, and features used in the experimental evaluation. Malware samples were obtained from several months (January - July 2015) of real network traffic of 80 international companies in form of proxy logs [27]. All the datasets were captured and provided by company not disclosed due to paper anonymization. The companies are of various sizes, from smaller with around 500 seats up to global corporations with 100k seats. Summary of the datasets used in the evaluation is described in Table II.</p>
    <p>The logs contain HTTP and HTTPS flows, where one flow is one connection defined as a group of packets from a single host and source port with a single server IP address, port, and protocol. As flows from the proxy logs are bidirectional, both directions of a communication are included in each flow. The malware samples were obtained from findings of several network security devices based on signatures (Cisco Cloud Web Security), blacklists (Shadowserver1), feeds (Collective Intelligence Framework CIF [15]), and static and behavioral analysis (Cisco Cloud Web Security). In many cases, human experts were involved to label novel previously undetected threats. Findings from VirusTotal2 server were also used.</p>
    <p>In the following, malware samples will be referred as positive bags, where one positive bag is a set of flows (connections) from proxy records with the same source host towards the same destination hostname. In other words, each bag contains the whole client-hostname communication for a given period of time.The bags that are not labeled as malicious are considered as legitimate/negative. We assume that the number of unknown malicious bags labeled as negatives is negligible when compared to the number of correctly labeled negative bags. Each bag should contain at least 5 flows to be able to compute a meaningful histogram representation from the input flows.</p>
    <p>Training dataset contains 5k malicious (8 malware families) and 27k legitimate bags, while testing dataset is consist of 2k malicious ( 32 malware families) and 241k legitimate bags (more than 15 million flows).</p>
    <p>Each flow consists of the following fields: user name, source IP address, destination IP address, source port, destination port, protocol, number of bytes transferred from client to server and from server to client, flow duration, timestamp, user agent, URL, referer, MIME-Type, and HTTP status. The most informative field is the URL, which can be decomposed further into 7 parts as illustrated in Figure 5. From the flow fields mentioned above, we extracted 88 flow-based features</p>
  </div>
  <div class="page">
    <p>Experiments  2D projection (t-SNE) 12</p>
    <p>Dimension 1 -100 -80 -60 -40 -20 0 20 40 60 80 100</p>
    <p>D im</p>
    <p>en si</p>
    <p>on 2</p>
    <p>-80</p>
    <p>-60</p>
    <p>-40</p>
    <p>-20</p>
    <p>Legitimate Malicious</p>
    <p>Fig. 8: Graphical projection of feature vectors of the baseline flow-based representation (some vectors are in Figure 6) into two dimensions using t-SNE transformation. Feature vectors from 32 different malware categories are displayed. Due to high variability of flow-based feature values, legitimate and malicious samples are scattered without any clear separation. The results show that the flow-based representation is suitable for training classifiers specialized on a single malware category, which often leads to classifiers with high precision and low recall.</p>
    <p>Dimension 1 -60 -40 -20 0 20 40 60 80</p>
    <p>D im</p>
    <p>en si</p>
    <p>on 2</p>
    <p>-50</p>
    <p>-40</p>
    <p>-30</p>
    <p>-20</p>
    <p>-10</p>
    <p>Malicious Legitimate</p>
    <p>Fig. 9: Graphical projection of feature vectors of the proposed representation (some vectors are in Figure 7) into two dimensions using t-SNE transformation. Thanks to the invariant properties, malicious bags from various categories are grouped together, as they have similar dynamics modeled by the representation. Most of the legitimate bags are concentrated on the left-hand side, far from the malicious bags. This shows that training a classifier with the proposed representation will achieve higher recall with comparable precision.</p>
    <p>with dark blue color, while maximum values (equal to 1) are depicted with yellow bars. Instead of ten flow-based feature vectors, each bag is represented with a single vector describing the inner dynamics of flow-based feature values within each bag. Malicious bags have a lot of values equal to zero as opposed to legitimate bags, which increases the separability of the two classes. Moreover, feature values equal to one are common for most of malicious bags across categories, which increases the descriptive value and robustness of the proposed representation. Such representation is more suitable for classification of frequently-changing malicious behaviors, as will be demonstrated further in this section.</p>
    <p>Two-dimensional projection of the feature vectors for the flow-based and the proposed representation is illustrated in Figures 8 and 9 respectively. Bags from 32 malicious categories are displayed with red circles, while the legitimate bags are denoted with green circles. The projections show that the flow-based representation is suitable for training classifiers specialized on a single malware category. In case of the proposed representation, malicious bags from various categories are grouped together and far from the legitimate traffic, which means that the classifiers based on this representation will have higher recall and comparable precision with the flow-based classifiers.</p>
    <p>Next, we will show the properties of the proposed method of learning the representation to maximize the separation between positive and negative samples (see Section V for details). Figure 10 visualizes the proposed method on synthetic 2dimensional input data. The input 2D point (x, y) 2 R2 is represented by 4-dimensional feature vector (x2, y2, x +</p>
    <p>y, x  y). Each of the 4 features is then represented by a histogram with 100 bins (i.e. each feature is represented by 100 dimensional binary vector will all zeros but a single one corresponding to the active bin). Figures in the top row show the decision boundaries of two-class classifiers learned from data. The bottom row shows the weights of the linear classifier corresponding to the bins (in total 400 weights resulting from 100 bins for each out of 4 features). The columns correspond to the results obtained for different setting of the parameter  which controls the number of emerging bins and thus also the complexity of the decision boundary. With increasing  the data are represented with less bins and the boundary becomes smoother. Figure 10 shows the principle of the proposed optimization process. The bins of the representation are learned in such a way that it is much easier for the classifier to separate negative and positive samples and at the same time control the complexity of the classifier.</p>
    <p>Figures 11 and 12 show the bins and weights learned from the training set of real network traffic. The blue vertical lines represent learned weights associated with 256 bins of a histogram computed on a single input feature. The red lines show new bins derived from the weights by merging those neighboring bins which have the weights with the same sign. Figure 11 shows the weights and the derived bins for a standard SVM which has no incentive to have similar weights. The histogram derived from the SVM weights reduces the number of bins from 256 to 130. Figure 12 shows the results for the proposed method which enforces the similar weights for neighboring bins. In this case, the weights exhibit a clear structure and the derived histogram has only 18 bins. The</p>
    <p>Flow-based features Bag Invariant Features Good for individual malware families Good for general malware</p>
  </div>
  <div class="page">
    <p>Learning bins from 256 equidistant mini-bins</p>
    <p>Standard SVM Modified SVM with merging</p>
    <p>feature x</p>
    <p>fe at</p>
    <p>ur e</p>
    <p>y</p>
    <p>lambda=0.00010, trnerr=2.4%, tsterr=14.8%</p>
    <p>feature x</p>
    <p>fe at</p>
    <p>ur e</p>
    <p>y</p>
    <p>lambda=0.01000, trnerr=10.4%, tsterr=13.5%</p>
    <p>feature x</p>
    <p>fe at</p>
    <p>ur e</p>
    <p>y</p>
    <p>lambda=0.10000, trnerr=13.2%, tsterr=10.5%</p>
    <p>feature 50 100 150 200 250 300 350 400</p>
    <p>w ei gh t</p>
    <p>-2</p>
    <p>-1</p>
    <p>feature 50 100 150 200 250 300 350 400</p>
    <p>w ei gh t</p>
    <p>-1</p>
    <p>feature 50 100 150 200 250 300 350 400</p>
    <p>w ei gh t</p>
    <p>-1</p>
    <p>Fig. 10: Visualization of the proposed method of learning the invariant representation on 2-dimensional synthetic data. Figures in the top row show the decision boundaries of two class classifier learned from the bins for three different values of parameter  (0.0001, 0.01, 0.1) which controls the number of emerging bins (the corresponding weights are shown in the bottom row) and thus the complexity of the boundary. With increasing  the data are represented with less bins and the boundary becomes smoother and less over-fitted to the training data.</p>
    <p>feature index 50 100 150 200 250</p>
    <p>w ei</p>
    <p>gh t v</p>
    <p>al ue</p>
    <p>Fig. 11: Weights (blue bars) and derived bins of a histogram (red line) for a standard SVM and one of the invariant features. Since the bins are equidistant and predefined at the beginning, the resulting histogram (defined by the red line) has complicated structure, leading most probably to complex boundary and over-fitted results (as shown in Figure 10 on the left hand side).</p>
    <p>feature index 50 100 150 200 250</p>
    <p>w ei</p>
    <p>gh t v</p>
    <p>al ue</p>
    <p>found 18 bins</p>
    <p>Fig. 12: Weights (blue bars) and derived bins of a histogram (red line) for the proposed bin optimization. In this case, the weights show a clear structure and the derived histogram has only 18 bins. The decision boundary is in this case smoother and the classifier trained from this representation will be more robust. Green dashed lines also show how the histogram bins would look like if they are positioned equidistantly (16 bins).</p>
    <p>decision boundary is in this case smoother and the classifier trained from this representation will be more robust.</p>
    <p>Next, a two-class SVM classifier was evaluated on five representations: baseline flow-based, per-feature histograms</p>
    <p>of values (zXk ,  X k ) (bag mean), per-feature histograms of</p>
    <p>feature differences (zSk ,  S k ) (bag variance), the combination</p>
    <p>of both (bag combined), and the combination of both with bin optimization (optimized bag combined). The training and</p>
    <p>Blue bars weights Red lines bins All mini-bins with the same weight sign create new bin.</p>
  </div>
  <div class="page">
    <p>Optimizing Decision Boundary 11</p>
    <p>feature x</p>
    <p>fe at</p>
    <p>ur e</p>
    <p>y</p>
    <p>lambda=0.00010, trnerr=2.4%, tsterr=14.8%</p>
    <p>feature x</p>
    <p>fe at</p>
    <p>ur e</p>
    <p>y</p>
    <p>lambda=0.01000, trnerr=10.4%, tsterr=13.5%</p>
    <p>feature x</p>
    <p>fe at</p>
    <p>ur e</p>
    <p>y</p>
    <p>lambda=0.10000, trnerr=13.2%, tsterr=10.5%</p>
    <p>feature 50 100 150 200 250 300 350 400</p>
    <p>w ei gh t</p>
    <p>-2</p>
    <p>-1</p>
    <p>feature 50 100 150 200 250 300 350 400</p>
    <p>w ei gh t</p>
    <p>-1</p>
    <p>feature 50 100 150 200 250 300 350 400</p>
    <p>w ei gh t</p>
    <p>-1</p>
    <p>Fig. 6: jo</p>
    <p>Flow-Based Feature Values for Legitimate and Malicious Behaviors</p>
    <p>Feature Values 10 20 30 40 50 60 70 80</p>
    <p>Legitimate</p>
    <p>Legitimate</p>
    <p>Click-Fraud</p>
    <p>DGA</p>
    <p>Dridex</p>
    <p>Zeus</p>
    <p>Asterope</p>
    <p>Fig. 7: Graphical illustration of a baseline representation of two legitimate and five malicious bags. Each bag is represented with 10 flow-based feature vectors (rows). You can see that feature values of legitimate vectors have high range of values, which complicates the training of classifiers. However, they have also significantly higher variability of feature values than malicious bags, which cannot be utilized from flow-based representation.</p>
    <p>Ten flow-based feature vectors of two legitimate and five malicious bags are displayed in Figure 7. Each row represents one flow-based feature vector. You can see that legitimate bags have higher diversity of flow-based feature values, which is a result of higher diversity of flows within a bag (illustrated in Table IV). This diversity (also shown in Figure 4) makes it difficult for a flow-based classifier to learn more complex malicious behaviors, as they are not well separated from the legitimate traffic. On the other hand, feature values within malicious bags are more consistent, resulting in more bars</p>
    <p>Proposed Feature Vectors of Legitimate and Malicious Behaviors</p>
    <p>Feature Values 50 100 150 200 250 300 350 400 450 500</p>
    <p>Legitimate</p>
    <p>Legitimate</p>
    <p>Click-Fraud</p>
    <p>DGA</p>
    <p>Dridex</p>
    <p>Zeus</p>
    <p>Asterope</p>
    <p>Fig. 8: Illustration of the proposed invariant representation of bags. First two legitimate bags show high variability of feature values and can be easily separated from malicious bags. On the other hand, feature values of malicious bags describe the inner similarity of flows or URLs within each bag as illustrated in Table IV. In contrast to legitimate bags, malicious bags have a lot of common feature values equal to 0 and 1, which improves their separability.</p>
    <p>with uniform color. This key property, which is shared across malware categories, is not visible from the flow-based features point of view. It is visible only at the level of bags.</p>
    <p>Figure 8 shows how the same positive and negative samples look in the proposed representation. Zero values are depicted with dark blue color, while maximum values (equal to 1) are depicted with yellow bars. Instead of ten flow-based feature vectors, each bag is represented with a single vector describing the inner dynamics of flow-based feature values within each bag. Malicious bags have a lot of values equal to zero as</p>
  </div>
  <div class="page">
    <p>Efficacy Results  Unseen Malware</p>
    <p>False Positive Rate 0 0.2 0.4 0.6 0.8 1</p>
    <p>Tr ue</p>
    <p>P os</p>
    <p>iti ve</p>
    <p>R at</p>
    <p>e</p>
    <p>flow-based bag mean bag variance bag combined optimized bag combined</p>
    <p>False Positive Rate 10 -5 10 -4 10 -3 10 -2 10 -1 10 0</p>
    <p>Tr ue</p>
    <p>P os</p>
    <p>iti ve</p>
    <p>R at</p>
    <p>e</p>
    <p>flow-based bag mean bag variance bag combined optimized bag combined</p>
    <p>Fig. 13: ROC curves of SVM classifier (logarithmic scale on the right) on training data for five types of representations: baseline flow-based, per-feature histograms of values (zXk ,</p>
    <p>X k ) (bag mean), per-feature histograms of feature differences (z</p>
    <p>S k ,</p>
    <p>S k )</p>
    <p>(bag variance), the combination of both (bag combined), and the combination of both with bin optimization (optimized bag combined). The flow-based classifier detected small amount of samples (approx. 7%) with very low false positive rate. This means that the classifier was specialized on these flows at the expense of the rest of the malicious samples. On the other hand, the proposed combination of bag representations resulted in high recall with acceptable low false positive rate.</p>
    <p>False Positive Rate 0 0.2 0.4 0.6 0.8 1</p>
    <p>Tr ue</p>
    <p>P os</p>
    <p>iti ve</p>
    <p>R at</p>
    <p>e</p>
    <p>flow-based bag mean bag variance bag combined optimized bag combined</p>
    <p>False Positive Rate 10 -5 10 -4 10 -3 10 -2 10 -1 10 0</p>
    <p>Tr ue</p>
    <p>P os</p>
    <p>iti ve</p>
    <p>R at</p>
    <p>e</p>
    <p>flow-based bag mean bag variance bag combined optimized bag combined</p>
    <p>Fig. 14: ROC curves of SVM classifier on test data for five types of representations (logarithmic scale on the right). Flow-based representation shows very unsatisfactory results showing that flow-based approach cannot be applied in practice to detect unseen malware variants. The combination of feature values with feature differences histogram (bin combined) led to significantly better efficacy results when compared to flow-based approach. These results were further exceeded when the parameters of the invariant representation were learned automatically from the training data (optimized bag combined).</p>
    <p>testing datasets were composed of bags described in Table II. ROC curve of training data is depicted in Figure 13, where all types of representations are compared. Flow-based classifier achieved high-precision results with only very limited recall (approx. 7%). This means that the classifier was specialized on these flows at the expense of the rest of the malicious samples. It also means that flow-based features are good for training specialized classifiers designed for one specific behavior. On the contrary, the proposed combination of both bag representations resulted in significantly higher recall with low false positive rate.</p>
    <p>The results of the SVM classifier on testing data are depicted in Figure 14. Note that positive bags in the testing set are from different malware categories than bags from the training set, which makes the classification problem much harder. The purpose of this evaluation is to compare flow-based</p>
    <p>representation, which is used in most of previously published work, with the proposed invariant representation. Flow-based representation shows very unsatisfactory results, mainly due to the fact that the classifier was based only on the values of flow-based features that are not robust across different malware categories (as shown in Section VII). The SVM classifier based on combined bag representation that is invariant against shifting, scaling, permutation, and size of the bags performed significantly better.</p>
    <p>Precision-recall curve is depicted in Figure 15 to compare the efficacy results of classifiers based on the proposed representation with predefined number of bins per feature (8, 16, 64, 128, and 256 bins) with the same representation, but when the parameters are learned from the training data (using bin optimization described in Section V).</p>
    <p>Overall, the results show the importance of combining</p>
    <p>Recall 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1</p>
    <p>P re</p>
    <p>ci si</p>
    <p>on</p>
    <p>bag combined (256 bins) bag combined (128 bins) bag combined (64 bins) bag combined (16 bins) bag combined (8 bins) optimized bag combined</p>
    <p>Fig. 15: Precision-recall curve of SVM classifier trained on the proposed representation with different number of histogram bins for each feature. All classifiers are outperformed by the classifier, where the parameters of the invariant representation are learned automatically from the data (optimized bag combined).</p>
    <p>both types of histograms introduced in Section IV together, allowing the representation to be more descriptive and precise without sacrificing recall. But most importantly, when the parameters of the representation are trained to maximize the separability between malicious and legitimate samples, the resulting classifier performs in order of a magnitude better than a classifier with parameters predefined by human.</p>
    <p>X. CONCLUSION</p>
    <p>This paper proposes a robust representation suitable for classifying evolving malware behaviors. It represents sets of network flows as bags based on the combination of invariant histograms of feature values and feature differences. The representation is designed to be invariant under shifting and scaling of the feature values and under permutation and size changes of the bags. The proposed optimization method learns the parameters of the representation automatically from the training data. Formally, the representation solves the domain adaptation problem in a supervised learning setting, where the training and testing datasets have different probability distributions. For the network security domain, it means that the proposed approach allows the classifiers to create robust models of malicious behaviors capable of detecting previously unseen malware variants and changes.</p>
    <p>The proposed representation was evaluated on real HTTP network traffic with more than 43k malicious samples and more than 15M samples overall. The comparison with a baseline flow-based approach and a widely-used signaturebased web security device showed several key advantages of the proposed representation. First, the invariant properties of the representation result in the detection of new types of malware. More specifically, the proposed classifier trained on the optimized representation achieved 90% precision and detected 67% (29k) of malware samples of previously unseen variants. Second, multiple malware behaviors can be represented in the same feature space while flow-based features necessitate training a separate detector for each malware family. Third,</p>
    <p>the combination of precise signature-based devices with datadriven classifiers trained with the proposed representation significantly increases the network threat coverage. The new classifier improves the incident reporting and prioritization by including threats that are new but perhaps not yet confirmed.</p>
    <p>REFERENCES</p>
    <p>[1] Cisco netflow. http://www.cisco.com/warp/public/732/tech/netflow. [2] List of 1 million top web sites. http://www.alexa.com. [3] M. Antonakakis, R. Perdisci, Y. Nadji, N. Vasiloglou, S. Abu-Nimeh,</p>
    <p>W. Lee, and D. Dagon. From throw-away traffic to bots: Detecting the rise of dga-based malware. In Proceedings of the 21st USENIX Conference on Security Symposium, Security12, pages 2424, Berkeley, CA, USA, 2012. USENIX Association.</p>
    <p>[4] M. Bailey, J. Oberheide, J. Andersen, Z. Mao, F. Jahanian, and J. Nazario. Automated classification and analysis of internet malware. In C. Kruegel, R. Lippmann, and A. Clark, editors, Recent Advances in Intrusion Detection, volume 4637 of Lecture Notes in Computer Science, pages 178197. Springer Berlin Heidelberg, 2007.</p>
    <p>[5] S. Ben-David, J. Blitzer, K. Crammer, F. Pereira, et al. Analysis of representations for domain adaptation. Advances in neural information processing systems, 19:137, 2007.</p>
    <p>[6] L. Bernaille, R. Teixeira, I. Akodkenou, A. Soule, and K. Salamatian. Traffic classification on the fly. ACM SIGCOMM 06, 36(2):2326, Apr. 2006.</p>
    <p>[7] L. Bilge, D. Balzarotti, W. Robertson, E. Kirda, and C. Kruegel. Disclosure: Detecting botnet command and control servers through large-scale netflow analysis. In Proceedings of the 28th Annual Computer Security Applications Conference, ACSAC 12, pages 129138, New York, NY, USA, 2012. ACM.</p>
    <p>[8] J. Blitzer, R. McDonald, and F. Pereira. Domain adaptation with structural correspondence learning. In Proceedings of the 2006 conference on empirical methods in natural language processing, pages 120128. Association for Computational Linguistics, 2006.</p>
    <p>[9] V. Chandola, A. Banerjee, and V. Kumar. Anomaly detection: A survey. ACM Comput. Surv., 41:15:115:58, July 2009.</p>
    <p>[10] H. Choi, B. B. Zhu, and H. Lee. Detecting malicious web links and identifying their attack types. In Proceedings of the 2Nd USENIX Conference on Web Application Development, WebApps11, pages 11 11, Berkeley, CA, USA, 2011. USENIX Association.</p>
    <p>[11] W. Dai, Q. Yang, G.-R. Xue, and Y. Yu. Boosting for transfer learning. In Proceedings of the 24th international conference on Machine learning, pages 193200. ACM, 2007.</p>
    <p>[12] L. Duan, I. W. Tsang, and D. Xu. Domain transfer multiple kernel learning. Pattern Analysis and Machine Intelligence, IEEE Transactions on, 34(3):465479, 2012.</p>
    <p>[13] J. Erman, M. Arlitt, and A. Mahanti. Traffic classification using clustering algorithms. In Proceedings of the 2006 SIGCOMM Workshop on Mining Network Data, MineNet 06, pages 281286, New York, NY, USA, 2006. ACM.</p>
    <p>[14] N. Falliere. Sality: Story of a peer-to-peer viral network. Rapport technique, Symantec Corporation, 2011.</p>
    <p>[15] G. Farnham and K. Leune. Tools and standards for cyber threat intelligence projects. Technical report, SANS Institute InfoSec Reading Room, 10 2013.</p>
    <p>[16] A. Gretton, A. Smola, J. Huang, M. Schmittfull, K. Borgwardt, and B. Scholkopf. Covariate shift by kernel mean matching. Dataset shift in machine learning, 3(4):5, 2009.</p>
    <p>[17] K. Griffin, S. Schneider, X. Hu, and T.-C. Chiueh. Automatic generation of string signatures for malware detection. In Proceedings of the 12th International Symposium on Recent Advances in Intrusion Detection, RAID 09, pages 101120, Berlin, Heidelberg, 2009. Springer-Verlag.</p>
    <p>[18] G. Gu, R. Perdisci, J. Zhang, W. Lee, et al. Botminer: Clustering analysis of network traffic for protocol-and structure-independent botnet detection. In USENIX Security Symposium, volume 5, pages 139154, 2008.</p>
    <p>[19] H. Huang, L. Qian, and Y. Wang. A svm-based technique to detect phishing urls. Information Technology Journal, 11(7):921925, 2012.</p>
    <p>[20] L. Invernizzi, S. Miskovic, R. Torres, S. Saha, S. Lee, M. Mellia, C. Kruegel, and G. Vigna. Nazca: Detecting malware distribution in large-scale networks. In Proceedings of the Network and Distributed System Security Symposium (NDSS), 2014.</p>
    <p>ROC Curve  log scale Precision  Recall Curve</p>
  </div>
  <div class="page">
    <p>Conclusion and Future Work  Flaws of flow-based representation</p>
    <p>New representation based on the dynamics of malware bags</p>
    <p>New optimization method that learns the parameters of the representation automatically from the data</p>
    <p>In progress:  Modified version for HTTPS</p>
  </div>
  <div class="page">
    <p>Thank you</p>
    <p>Q&amp;A ?</p>
  </div>
</Presentation>
