<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Stuart Schechter Cormac Herley</p>
    <p>Michael Mitzenmacher</p>
    <p>Choose a password: Your email address:</p>
  </div>
  <div class="page"/>
  <div class="page"/>
  <div class="page"/>
  <div class="page">
    <p>Why are we doing this to our users?</p>
  </div>
  <div class="page">
    <p>Threat 1: Password file compromised</p>
    <p>stus, cormac, michaelm, helenw, wdcui, dmolnar, alexmos, bparno,</p>
  </div>
  <div class="page">
    <p>Threat 1: Password file compromised</p>
    <p>h stus,abc123 0xD1F7255CA</p>
    <p>stus, cormac, michaelm, helenw, wdcui, dmolnar, alexmos, bparno,</p>
  </div>
  <div class="page">
    <p>Threat 1: Password file compromised</p>
    <p>stus, cormac, michaelm, helenw, wdcui, dmolnar, alexmos, bparno,</p>
    <p>h stus,asdf 0xCF832A834 =</p>
    <p>cost of one guess = cost to compute h</p>
  </div>
  <div class="page">
    <p>Threat 1: Password file compromised</p>
  </div>
  <div class="page">
    <p>Threat 1: Password file compromised</p>
    <p>stus, cormac, michaelm, helenw, wdcui, dmolnar, alexmos, bparno,</p>
    <p>asdf 123456 password1 rockyou princess abc123 qwerty monkey</p>
  </div>
  <div class="page">
    <p>Threat 2: Online dicTonary aUack</p>
    <p>stus, cormac, michaelm, helenw, wdcui, dmolnar, alexmos, bparno,</p>
    <p>stus,abc123</p>
    <p>Sorry!</p>
  </div>
  <div class="page">
    <p>Threat 2a: Online staTsTcal guessing</p>
    <p>stus,password1</p>
    <p>Sorry!</p>
    <p>Common passwords (sorted by popularity) password1 password abc123 asdf 1234568 p@ssword iloveyou</p>
    <p>cormac,password1</p>
    <p>Sorry!</p>
    <p>michaelm,password1</p>
    <p>Welcome!</p>
  </div>
  <div class="page">
    <p>Threat 2a: Online staTsTcal guessing</p>
    <p>Userbased lockout ineffecTve  300m users * 10 guesses per user = 3 billion guesses</p>
    <p>IP lockout slightly less ineffecTve  10m node botnet * 10 guesses per IP = 100M guesses</p>
    <p>Some accounts will be compromised  Frequency of most popular password * guesses  100k accounts if 0.1% use most popular password</p>
  </div>
  <div class="page">
    <p>Here comes the big idea of the talk *yet low carbon</p>
    <p>*</p>
  </div>
  <div class="page">
    <p>Replace composiTon rules with one new rule</p>
    <p>Your may not choose a popular password (one already in use by n% of other users.)</p>
  </div>
  <div class="page">
    <p>Dont password rules already accomplish this?</p>
    <p>hUp://failblog.org/2008/01/03/failcamera/</p>
  </div>
  <div class="page">
    <p>Expected password choices without rules</p>
    <p>password &lt;&gt; asdf 1234 qwert iloveyou fuckyou asdFkl;</p>
    <p>P e rc</p>
    <p>e n t o f u se</p>
    <p>rs w</p>
    <p>ith p</p>
    <p>a ss</p>
    <p>w o rd</p>
    <p>Password</p>
    <p>Example based on real data but not real data!</p>
    <p>Im so clever!</p>
  </div>
  <div class="page">
    <p>Rule 1: At least 8 characters</p>
    <p>password asdFkl; 12345678 iloveyou fuckyou! baseball football nothanks</p>
    <p>P e rc</p>
    <p>e n t o f u se</p>
    <p>rs w</p>
    <p>ith p</p>
    <p>a ss</p>
    <p>w o rd</p>
    <p>Password</p>
    <p>SomeTmes rules have unintended consequences</p>
  </div>
  <div class="page">
    <p>Rule 2: At least 1 number</p>
    <p>password1 12345678 blink182 trustno1 no1knows hard2forget answeris42 ih8rules</p>
    <p>P e rc</p>
    <p>e n t o f u se</p>
    <p>rs w</p>
    <p>ith p</p>
    <p>a ss</p>
    <p>w o rd</p>
    <p>Password</p>
  </div>
  <div class="page">
    <p>Rule 3: At least 1 special character</p>
    <p>p@ssword1 p@$$word1 p@ssword0 1p@assword givememy$ p@ssword0? password1! mk1#ofit</p>
    <p>P e rc</p>
    <p>e n t o f u se</p>
    <p>rs w</p>
    <p>ith p</p>
    <p>a ss</p>
    <p>w o rd</p>
    <p>Password</p>
    <p>I sure know how to obfuscate! Im so original!</p>
  </div>
  <div class="page">
    <p>P@ssword</p>
    <p>Large sites favor strength meters over rules</p>
  </div>
  <div class="page">
    <p>P@ssword password1</p>
  </div>
  <div class="page">
    <p>P@$$word1</p>
  </div>
  <div class="page">
    <p>ComposiTon rules stronger passwords</p>
    <p>password  P@$$word1</p>
  </div>
  <div class="page">
    <p>Back to our desired policy</p>
    <p>Your may not choose a popular password (one already in use by n% of other users.)</p>
  </div>
  <div class="page">
    <p>If we enforced no popular passwords</p>
    <p>p1 p2 p3 p4 p5 p6 p7 p8</p>
    <p>P e rc</p>
    <p>e n t o f u se</p>
    <p>rs w</p>
    <p>ith p</p>
    <p>a ss</p>
    <p>w o rd</p>
    <p>Password</p>
    <p>p@ssword1 p@$$word1 p@ssword0 1p@assword givememy$ p@ssword0? password1! mk1#ofit</p>
    <p>P e rc</p>
    <p>e n t o f u se</p>
    <p>rs w</p>
    <p>ith p</p>
    <p>a ss</p>
    <p>w o rd</p>
    <p>Password</p>
  </div>
  <div class="page">
    <p>Enforcing the no popular passwords rule</p>
    <p>P@$$word1</p>
    <p>Sorry! At least 100 other users are already using this password. Youll need to choose another one.</p>
  </div>
  <div class="page">
    <p>We must track popularity to prevent it</p>
    <p>Common passwords (sorted by popularity) password1, 2805 password, 2280 abc123, 1568 asdf, 1375 1234568, 583 p@ssword, 390 Iloveyou, 334</p>
  </div>
  <div class="page">
    <p>Dangers of tracking popular passwords</p>
    <p>AUackers will use this data for staTsTcal guessing  Against you  Against other sites</p>
  </div>
  <div class="page">
    <p>Tracking popular passwords</p>
    <p>Common passwords (sorted by popularity) password1, 2805 password, 2280 abc123, 1568 asdf, 1375 1234568, 583 p@ssword, 390 Iloveyou, 334</p>
  </div>
  <div class="page">
    <p>Dangers of tracking popular passwords</p>
    <p>AUackers will use for staTsTcal guessing aUacks  Against you  Against other sites</p>
    <p>AUackers will use for offline staTsTcal guessing  Crack using only passwords in the popularity list</p>
  </div>
  <div class="page">
    <p>Common passwords (sorted by popularity) password1, 2805 password, 2280 abc123, 1568 asdf, 1375 1234568, 583 p@ssword, 390 Iloveyou, 334</p>
    <p>Tracking popular passwords</p>
  </div>
  <div class="page">
    <p>Common passwords (sorted by popularity) 0xCF832A834 0xC86A00386 0x0DB015528 0x5723B9291 0x24BF98902 0x23482AA83 0x1B200D481</p>
    <p>Tracking populra passwords</p>
  </div>
  <div class="page">
    <p>Dangers of tracking popular passwords</p>
    <p>AUackers will use for staTsTcal guessing aUacks  Against you  Against other sites</p>
    <p>AUackers will use for offline staTsTcal guessing  Crack using only passwords in the popularity list</p>
  </div>
  <div class="page">
    <p>Common passwords (sorted by popularity) 0xCF832A834 0xC86A00386 0x0DB015528 0x5723B9291 0x24BF98902 0x23482AA83 0x1B200D481</p>
    <p>How can we track popular passwords?</p>
    <p>Crack popular password file (once for all accounts) to idenWfy passwords to use against salted password file entries</p>
    <p>Salt free</p>
  </div>
  <div class="page">
    <p>Dangers of tracking popular passwords</p>
    <p>AUackers will use for staTsTcal guessing aUacks  Against you  Against other sites</p>
    <p>AUackers will use for offline staTsTcal guessing  Crack using only passwords in the popularity list  Crack popularity list entries (which are unsalted) to idenTfy passwords in password file (which is salted)</p>
    <p>Filter candidate password list (with access to oracle) These seem unavoidable</p>
  </div>
  <div class="page">
    <p>Requirements for popularitytracking data structure</p>
    <p>add(p) Adds the occurrence (use) of a password p</p>
    <p>count(p)</p>
    <p>Returns # of Tmes p has been added</p>
    <p>Need not be exact count(p)  number of Wmes p added</p>
    <p>a few false posi2ves are OK</p>
  </div>
  <div class="page">
    <p>Well implement a probabilis*c oracle</p>
    <p>False posiTves (falsely popular), no false negaTves</p>
    <p>Countmin sketch  RelaTve of bloom filter (and counTng bloom filter)</p>
  </div>
  <div class="page">
    <p>password</p>
    <p>h1</p>
    <p>h2</p>
    <p>h3</p>
    <p>h4</p>
    <p>Base case (single table) of a countmin sketch</p>
  </div>
  <div class="page">
    <p>password</p>
    <p>h1</p>
    <p>h2</p>
    <p>h3</p>
    <p>h4</p>
    <p>Countmin sketch: add(password)</p>
  </div>
  <div class="page">
    <p>password</p>
    <p>h1</p>
    <p>h2</p>
    <p>h3</p>
    <p>h4</p>
    <p>Countmin sketch: count(password) count(password) = min(1,1,1,1) = 1</p>
  </div>
  <div class="page">
    <p>ih8rules</p>
    <p>h1</p>
    <p>h2</p>
    <p>h3</p>
    <p>h4</p>
    <p>add(ih8rules)</p>
    <p>Hash collision with password</p>
  </div>
  <div class="page">
    <p>password</p>
    <p>h1</p>
    <p>h2</p>
    <p>h3</p>
    <p>h4</p>
    <p>Countmin sketch: add(password) count(password) = min(1,2,1,1) = 1 count(password) = min(2,2,2,2) = 2</p>
    <p>Need not be incremented (conservaWve add)</p>
  </div>
  <div class="page">
    <p>password</p>
    <p>h1</p>
    <p>h2</p>
    <p>h3</p>
    <p>h4</p>
    <p>Countmin sketch: add(password) count(password) = min(1,2,1,1) = 1 count(password) = 100 = MAX_ALLOWED</p>
  </div>
  <div class="page">
    <p>Dangers of tracking popular passwords</p>
    <p>AUackers will use for staTsTcal guessing aUacks  Against you  Against other sites</p>
    <p>AUackers will use for offline staTsTcal guessing  Crack using only passwords in the popularity list  Crack popularity list entries (which are unsalted) to idenTfy passwords in password file (which is salted)</p>
    <p>Filter candidate password list (with access to oracle)</p>
  </div>
  <div class="page">
    <p>False posiTves to the rescue!</p>
    <p>Randomly generated password x likely to have count(x) &gt; 0</p>
    <p>h1 0x?????</p>
  </div>
  <div class="page">
    <p>Dangers of tracking user passwords</p>
    <p>AUackers will use for staTsTcal guessing aUacks  Against you  Against other sites</p>
    <p>AUackers will use for offline staTsTcal guessing  Crack using only passwords in the popularity list  Crack popularity list entries (which are unsalted) to idenTfy passwords in password file (which is salted)</p>
    <p>Filter candidate password list (with access to oracle)</p>
  </div>
  <div class="page">
    <p>False posiTves to the rescue, again!</p>
    <p>AssumpTons  2% false posiTve rate for countmin sketch  20% of user password choices are too popular</p>
    <p>ImplicaTons  9% of the passwords rejected as too popular were actually false posiTves</p>
    <p>DicTonary of 260 10 char passwords, filtered to 254 (2% of 260)</p>
    <p>If dicTonary cracked, force all passwords to be changed.</p>
  </div>
  <div class="page">
    <p>Dangers of tracking popular passwords</p>
    <p>AUackers will use for staTsTcal guessing aUacks  Against you  Against other sites</p>
    <p>AUackers will use for offline staTsTcal guessing  Walk the password list (if popularity list is plaintext)  Crack popularity list entries (which are unsalted) to idenTfy passwords in password file (which is salted)</p>
    <p>Filter candidate password list (with access to oracle)</p>
  </div>
  <div class="page">
    <p>One last warning</p>
    <p>Popular strategies can be dangerous even if passwords are unique</p>
  </div>
  <div class="page">
    <p>Unique passwords, dangerously popular strategies</p>
    <p>Passwords with derivaTve of username  stuspassword, sutspassword</p>
    <p>Passwords containing text that can be found on web search of user  hUp://google.com/?q=stus popularityiseverything bing</p>
  </div>
  <div class="page">
    <p>Backup Slide for Responding to QuesTons</p>
    <p>You didnt expect wed believe this did you?</p>
  </div>
  <div class="page">
    <p>QuesTons? Im sorry dear,</p>
    <p>but if this represents the best presentaWon well be capable of, even with millions of addiWonal years to</p>
    <p>evolve, maybe its best that we not reproduce.</p>
  </div>
</Presentation>
