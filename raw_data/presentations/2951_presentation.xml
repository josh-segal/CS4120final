<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Eidetic Systems David Devecsery, Michael Chow, Xianzheng Dou,</p>
    <p>Jason Flinn, Peter Chen</p>
    <p>University of Michigan</p>
  </div>
  <div class="page">
    <p>What is an Eidetic System?</p>
    <p>Eidetic  Having Perfect memory or Total Recall</p>
    <p>Eidetic System  A system which can recall and trace through the lineage of any past computation</p>
  </div>
  <div class="page">
    <p>Motivation - Heartbleed</p>
    <p>Was Heartbleed exploited?</p>
    <p>What data was leaked?</p>
    <p>David Devecsery</p>
  </div>
  <div class="page">
    <p>Motivation - Heartbleed</p>
    <p>Heartbleed Message</p>
    <p>Leaked Data</p>
    <p>Was Heartbleed exploited? - Yes</p>
    <p>What data was leaked?</p>
    <p>David Devecsery</p>
  </div>
  <div class="page">
    <p>Motivation - Heartbleed</p>
    <p>Was Heartbleed exploited? - Yes</p>
    <p>What data was leaked?</p>
    <p>Leaked Database Rows</p>
    <p>David Devecsery</p>
    <p>Heartbleed Message</p>
    <p>Leaked Data</p>
  </div>
  <div class="page">
    <p>Motivation  Wrong Reference</p>
    <p>Bad Citation</p>
    <p>How did I get the wrong citation?</p>
    <p>David Devecsery</p>
  </div>
  <div class="page">
    <p>Motivation  Wrong Reference</p>
    <p>How did I get the wrong citation?</p>
    <p>David Devecsery</p>
  </div>
  <div class="page">
    <p>Motivation  Wrong Reference</p>
    <p>How did I get the wrong citation?</p>
    <p>David Devecsery</p>
  </div>
  <div class="page">
    <p>Motivation  Wrong Reference</p>
    <p>How did I get the wrong citation?</p>
    <p>What else did this affect?</p>
    <p>David Devecsery</p>
  </div>
  <div class="page">
    <p>Motivation</p>
    <p>How did I get the wrong citation?</p>
    <p>What else did this affect?</p>
    <p>David Devecsery</p>
  </div>
  <div class="page">
    <p>Arnold</p>
    <p>First practical eidetic computer system  Efficiently records &amp; recalls all user-space computation</p>
    <p>Process register/memory state</p>
    <p>Inter-process communication</p>
    <p>Handles lineage queries  What data was affected?</p>
    <p>What states and outputs were affected?</p>
    <p>Targeted towards desktop/workstation use</p>
    <p>Reasonable overheads  Record 4 years of data on $150 commodity HD  Under 8% performance overhead on most benchmarks</p>
  </div>
  <div class="page">
    <p>Overview</p>
    <p>Introduction</p>
    <p>Motivation</p>
    <p>How Arnold remembers all state</p>
    <p>How Arnold supports lineage queries</p>
    <p>Conclusion</p>
  </div>
  <div class="page">
    <p>Remembering State</p>
    <p>Requirements:  Store years of state on a single disk</p>
    <p>Memory/register space within a process</p>
    <p>Inter process communication</p>
    <p>File state</p>
    <p>Recall any state in reasonable time</p>
    <p>Solution:  Deterministic record &amp; replay</p>
    <p>Process group based replay</p>
    <p>Process graph to track inter-process lineage</p>
    <p>Log compression</p>
  </div>
  <div class="page">
    <p>Recording Granularity</p>
    <p>What granularity is best to record our system?</p>
    <p>Pipe</p>
    <p>Read 1</p>
    <p>Pipe</p>
    <p>Read 1 Pipe</p>
    <p>Read 1</p>
    <p>Pipe</p>
    <p>Read 1</p>
    <p>Pipe</p>
    <p>Read 1</p>
    <p>External Inputs</p>
    <p>David Devecsery</p>
  </div>
  <div class="page">
    <p>Recording Granularity</p>
    <p>Whole system recording Low space overhead  Costly to replay</p>
    <p>Pipe</p>
    <p>Read 1</p>
    <p>Pipe</p>
    <p>Read 1 Pipe</p>
    <p>Read 1</p>
    <p>Pipe</p>
    <p>Read 1</p>
    <p>Pipe</p>
    <p>Read 1</p>
    <p>External Inputs</p>
    <p>David Devecsery</p>
  </div>
  <div class="page">
    <p>Recording Granularity</p>
    <p>Process level recording Efficient to replay Uses extra disk space  No Inter-process tracking</p>
    <p>Pipe</p>
    <p>Read 1</p>
    <p>Pipe</p>
    <p>Read 1 Pipe</p>
    <p>Read 1</p>
    <p>Pipe</p>
    <p>Read 1</p>
    <p>Pipe</p>
    <p>Read 1</p>
    <p>External Inputs</p>
    <p>David Devecsery</p>
  </div>
  <div class="page">
    <p>Recording Granularity</p>
    <p>Process group recording Efficient to replay Reasonable disk space No Inter-process tracking</p>
    <p>Pipe</p>
    <p>Read 1</p>
    <p>Pipe</p>
    <p>Read 1 Pipe</p>
    <p>Read 1</p>
    <p>Pipe</p>
    <p>Read 1</p>
    <p>Pipe</p>
    <p>Read 1</p>
    <p>External Inputs</p>
    <p>David Devecsery</p>
  </div>
  <div class="page">
    <p>Implementation  Process Graph</p>
    <p>Record Log</p>
    <p>Pipe</p>
    <p>Read 1</p>
    <p>Pipe</p>
    <p>Read 1Pipe</p>
    <p>Read 1</p>
    <p>IPC Read</p>
    <p>David Devecsery</p>
  </div>
  <div class="page">
    <p>Implementation  Process Graph</p>
    <p>Record Log</p>
    <p>Pipe</p>
    <p>Read 1</p>
    <p>Pipe</p>
    <p>Read 1Pipe</p>
    <p>Read 1</p>
    <p>IPC Read Pipe</p>
    <p>Read 1Pipe</p>
    <p>Read 1</p>
    <p>David Devecsery</p>
  </div>
  <div class="page">
    <p>Recording</p>
    <p>Process group recording + process graph</p>
    <p>Efficient to replay Reasonable disk space Inter-process tracking</p>
    <p>Pipe</p>
    <p>Read 1</p>
    <p>Pipe</p>
    <p>Read 1 Pipe</p>
    <p>Read 1</p>
    <p>Pipe</p>
    <p>Read 1</p>
    <p>Pipe</p>
    <p>Read 1</p>
    <p>External Inputs</p>
    <p>David Devecsery</p>
  </div>
  <div class="page">
    <p>Space Optimizations</p>
    <p>Lo g</p>
    <p>C o</p>
    <p>m p</p>
    <p>re ss</p>
    <p>io n</p>
    <p>v s</p>
    <p>B a</p>
    <p>se li</p>
    <p>n e</p>
    <p>David Devecsery</p>
  </div>
  <div class="page">
    <p>Space Optimizations</p>
    <p>Lo g</p>
    <p>C o</p>
    <p>m p</p>
    <p>re ss</p>
    <p>io n</p>
    <p>v s</p>
    <p>B a</p>
    <p>se li</p>
    <p>n e</p>
    <p>David Devecsery</p>
  </div>
  <div class="page">
    <p>Space Optimizations</p>
    <p>Lo g</p>
    <p>C o</p>
    <p>m p</p>
    <p>re ss</p>
    <p>io n</p>
    <p>v s</p>
    <p>B a</p>
    <p>se li</p>
    <p>n e</p>
    <p>David Devecsery</p>
  </div>
  <div class="page">
    <p>Space Optimizations</p>
    <p>Lo g</p>
    <p>C o</p>
    <p>m p</p>
    <p>re ss</p>
    <p>io n</p>
    <p>v s</p>
    <p>B a</p>
    <p>se li</p>
    <p>n e</p>
    <p>David Devecsery</p>
  </div>
  <div class="page">
    <p>Model-Based Compression</p>
    <p>Formulate a model of a typical execution</p>
    <p>Only record deviations from that model</p>
    <p>ret_val = sys_read (fd, buffer, count);</p>
    <p>Idea: Partial determinism</p>
    <p>Encourage the program to conform to the model</p>
    <p>usually equal</p>
    <p>David Devecsery</p>
  </div>
  <div class="page">
    <p>Semi-Deterministic Time</p>
    <p>Frequent time queries are non-deterministic</p>
    <p>Use partially deterministic clock at record time  Real time clock &amp; deterministic clock</p>
    <p>Bound deviation</p>
    <p>if (deterministic_clock  real_time_clock &lt; threshold) { adjust deterministic_clock record deviation</p>
    <p>} return deterministic_clock</p>
    <p>David Devecsery</p>
  </div>
  <div class="page">
    <p>Performance Evaluation</p>
    <p>N o</p>
    <p>rm a</p>
    <p>li ze</p>
    <p>d R</p>
    <p>u n</p>
    <p>ti m</p>
    <p>e</p>
    <p>Baseline Arnold</p>
    <p>David Devecsery</p>
  </div>
  <div class="page">
    <p>Overview</p>
    <p>Introduction</p>
    <p>Motivation</p>
    <p>How Arnold remembers all state</p>
    <p>How Arnold supports lineage queries</p>
    <p>Conclusion</p>
  </div>
  <div class="page">
    <p>Querying Lineage</p>
    <p>Two types of queries:  Reverse: Where did this data come from?  Forward: What did this data affect?</p>
    <p>How does Arnold support these queries?  User specifies initial state  Trace the lineage of the computation</p>
    <p>Intra-process tracking  Inter-process tracking</p>
  </div>
  <div class="page">
    <p>Intra-Process Lineage</p>
    <p>Use taint tracking for intra-process causality  Run retroactively, on recorded execution</p>
    <p>Parallelizable</p>
    <p>Arnold supports several notions of causality:</p>
    <p>Copy Only Data Flow Data+Index Flow</p>
    <p>May miss relations Misses few relations Recall</p>
    <p>Strong input/output relation</p>
    <p>Weak input/output Relation</p>
    <p>Precision</p>
    <p>Control Flow</p>
    <p>David Devecsery</p>
  </div>
  <div class="page">
    <p>Intra-Process Lineage</p>
    <p>Which linkage tool should Arnold use?</p>
    <p>Inputs</p>
    <p>Program</p>
    <p>David Devecsery</p>
  </div>
  <div class="page">
    <p>Intra-Process Lineage</p>
    <p>Data Flow Data+Index Flow</p>
    <p>May miss relations Misses few relations Recall</p>
    <p>Strong input/output relation</p>
    <p>Weak input/output Relation</p>
    <p>Precision</p>
    <p>Copy</p>
    <p>David Devecsery</p>
  </div>
  <div class="page">
    <p>Intra-Process Lineage</p>
    <p>Data Flow Data+Index Flow</p>
    <p>May miss relations Misses few relations Recall</p>
    <p>Strong input/output relation</p>
    <p>Weak input/output Relation</p>
    <p>Precision</p>
    <p>Copy</p>
    <p>David Devecsery</p>
  </div>
  <div class="page">
    <p>Intra-Process Lineage</p>
    <p>Data Flow Data+Index Flow</p>
    <p>May miss relations Misses few relations Recall</p>
    <p>Strong input/output relation</p>
    <p>Weak input/output Relation</p>
    <p>Precision</p>
    <p>Copy</p>
    <p>David Devecsery</p>
  </div>
  <div class="page">
    <p>Intra-Process Lineage</p>
    <p>Data Flow Data+Index Flow</p>
    <p>May miss relations Misses few relations Recall</p>
    <p>Strong input/output relation</p>
    <p>Weak input/output Relation</p>
    <p>Precision</p>
    <p>Copy</p>
    <p>David Devecsery</p>
  </div>
  <div class="page">
    <p>Intra-Process Lineage</p>
    <p>Data Flow Data+Index Flow</p>
    <p>May miss relations Misses few relations Recall</p>
    <p>Strong input/output relation</p>
    <p>Weak input/output Relation</p>
    <p>Precision</p>
    <p>Copy</p>
    <p>David Devecsery</p>
  </div>
  <div class="page">
    <p>Intra-Process Lineage</p>
    <p>Data Flow</p>
    <p>May miss relations Misses few relations Recall</p>
    <p>Strong input/output relation</p>
    <p>Weak input/output Relation</p>
    <p>Precision</p>
    <p>Arnold selects the most precise tool with at least one result</p>
    <p>David Devecsery</p>
  </div>
  <div class="page">
    <p>Inter-Process Lineage</p>
    <p>Two notions of inter-process linkage</p>
    <p>Process graph  Tracks lineage through inter-process communication</p>
    <p>Precise</p>
    <p>Captures group to group communication</p>
    <p>Human linkage  Handles relations between user inputs and outputs</p>
    <p>Infers linkages based on data content and time</p>
    <p>Imprecise  may have false negatives and false positives</p>
    <p>Can capture linkages the process graph can miss</p>
  </div>
  <div class="page">
    <p>Evaluation  Wrong Reference</p>
    <p>Data + IndexDataCopyCopyData</p>
    <p>Few false positives (font files, latex sty files, libc.so, libXt.so)</p>
    <p>No false negatives Record Time Replay Time Replay + Pin</p>
    <p>Time Query Time</p>
    <p>Human Linkage</p>
    <p>David Devecsery</p>
  </div>
  <div class="page">
    <p>Evaluation  Heartbleed</p>
    <p>No false positives or negatives</p>
    <p>Data + IndexData + Index Data + Index</p>
    <p>Record Time Replay Time Replay + Pin Time</p>
    <p>Query Time</p>
    <p>David Devecsery</p>
  </div>
  <div class="page">
    <p>Conclusion</p>
    <p>Eidetic Systems are powerful tools  Complete vision into past computation  Answer powerful queries about states lineage</p>
    <p>Arnold  First practical Eidetic System  Low runtime overhead  4 years of computation on a commodity HD  Supports powerful lineage queries</p>
    <p>Code is released https://github.com/endplay/omniplay</p>
  </div>
  <div class="page">
    <p>Questions?</p>
  </div>
  <div class="page">
    <p>Backup Slides</p>
  </div>
  <div class="page">
    <p>Cloud Storage</p>
    <p>Future work</p>
    <p>Two approaches:  Statically served content  Distributed replay system</p>
  </div>
  <div class="page">
    <p>Related Works</p>
    <p>Execution Mining (Tralfamadore)</p>
    <p>DejaVu</p>
    <p>RAIL</p>
  </div>
  <div class="page">
    <p>User Study Log-Sizes</p>
    <p>Users Days Groups Per Day</p>
    <p>Storage Utilization (MB)</p>
    <p>RAW File Cache</p>
    <p>Logs Filemap Total</p>
    <p>A 25 995 475 267 36 779</p>
    <p>B 24 475 1095 936 339 2064</p>
    <p>C 21 26122 869 350 690 1910</p>
    <p>D 16 3339 1675 838 838 2594</p>
  </div>
  <div class="page"/>
</Presentation>
