<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>DDoS Vulnerability Analysis of BitTorrent Protocol</p>
    <p>CS239 project Spring 2006</p>
  </div>
  <div class="page">
    <p>Background</p>
    <p>BitTorrent (BT)  P2P file sharing protocol  30% of Internet traffic  6881- top 10 scanned port in the Internet</p>
    <p>DDoS  Distributed  hard to guard against by simply</p>
    <p>filtering at upstream routers  Application level (resources)  Network level (bandwidth)</p>
  </div>
  <div class="page">
    <p>How BT works</p>
    <p>.torrent file (meta-data)  Information of files being shared  Hashes of pieces of files</p>
    <p>Trackers (coordinator)  http, udp trackers  Trackerless (DHT)</p>
    <p>BT clients (participants)  Azureus  BitComet  uTorrent  etc.</p>
    <p>Online forum (exchange medium)  For user to announce and search for .torrent files</p>
  </div>
  <div class="page">
    <p>Communication with trackers</p>
    <p>Tracker</p>
    <p>seeder</p>
    <p>clients</p>
    <p>client</p>
    <p>.torrent</p>
    <p>.torrent</p>
    <p>I have the file!</p>
    <p>Who has the file?</p>
    <p>Discussion forum</p>
    <p>Who has the file?</p>
  </div>
  <div class="page">
    <p>Message exchange</p>
    <p>HTTP/UDP tracker  Get peer + announce combined (who is sharing files)  Scrapping (information lookup)</p>
    <p>DHT (trackerless)  Ping/response (announcing participation in DHT network)  Find node (location peers in DHT network)</p>
    <p>Get peer (locate who is sharing files)  Announce (announce who is sharing files)</p>
  </div>
  <div class="page">
    <p>Vulnerabilities</p>
    <p>Spoofed information  * Both http and udp trackers allow specified IP in announce  DHT does not allow specified IP in announce</p>
    <p>Allow spoofed information on who is participating in DHT network</p>
    <p>Possible to redirect a lot of DHT query to a victim</p>
    <p>Compromised tracker</p>
  </div>
  <div class="page">
    <p>Attack illustration</p>
    <p>Tracker</p>
    <p>victim</p>
    <p>clients</p>
    <p>attacker</p>
    <p>Victim has the files!</p>
    <p>Discussion forum</p>
    <p>Who has the files?</p>
    <p>.torrent .torrent</p>
    <p>.torrent .torrent</p>
    <p>.torrent .torrent</p>
  </div>
  <div class="page">
    <p>Experiments</p>
    <p>Discussion forum (http://www.mininova.org)  1191 newly uploaded .torrent files in 2 days</p>
    <p>Victim (131.179.187.205)  Apache web server (configured to serve 400 clients)  tcpdump, netstat</p>
    <p>Attacker  Python script to process .torrent files and contact trackers</p>
    <p>Zombies  Computers running BitTorrent clients in the Internet</p>
  </div>
  <div class="page">
    <p>Statistics</p>
    <p>Total 1191</p>
    <p>Corrupted 6</p>
    <p>Single tracker 999</p>
    <p>Multiple trackers 186</p>
    <p>Support DHT 121</p>
    <p>http trackers 1963</p>
    <p>udp trackers 85</p>
    <p>Unique http trackers 311</p>
    <p>Unique udp trackers 21</p>
    <p>Torrents</p>
    <p>Trackers</p>
  </div>
  <div class="page">
    <p>Measurements (1)</p>
    <p>Attacker  1191 torrent files used  30 concurrent threads, contact trackers once</p>
  </div>
  <div class="page">
    <p>Measurements (2)</p>
    <p>Attacker  1191 torrent files used  40 concurrent threads, contact trackers 10 times  Attack ends after 8 hours</p>
  </div>
  <div class="page">
    <p>Measurements (3)</p>
    <p>30513 distinct IPs recorded  Number of connection attempts per host</p>
    <p>Retry 3,6,9, seems a common implementation</p>
  </div>
  <div class="page">
    <p>Measurement (abnormal behavior) o Top 15 hosts with highest number of connection attempts</p>
    <p>o 8995 202.156.6.67 Country: SINGAPORE (SG) o 8762 24.22.183.141 Country: UNITED STATES (US) o 1953 71.83.213.106 Country: (Unknown Country?) (XX) o 1841 24.5.44.13Country: UNITED STATES (US) o 1273 147.197.200.44 Country: UNITED KINGDOM (UK) o 1233 82.40.167.116 Country: UNITED KINGDOM (UK) o 1183 194.144.130.220 Country: ICELAND (IS) o 1171 82.33.194.6 Country: UNITED KINGDOM (UK) o 1167 219.78.137.197 Country: HONG KONG (HK) o 1053 83.146.39.94 Country: UNITED KINGDOM (UK) o 1042 82.10.187.190 Country: UNITED KINGDOM (UK) o 896 65.93.12.152 Country: CANADA (CA) o 861 84.231.86.223 Country: FINLAND (FI) o 855 24.199.85.75 Country: UNITED STATES (US) o 753 207.210.96.205 Country: CANADA (CA)</p>
    <p>o Content pollution agents? o Other researchers?</p>
  </div>
  <div class="page">
    <p>Top 15 countries</p>
    <p>United States  Canada  United Kingdom  Germany  France  Spain  Australia  Sweden  Netherlands  Malaysia  Norway  Poland  Japan  Brazil  China</p>
  </div>
  <div class="page">
    <p>Countries with less BT clients running  Albania  Bermuda  Bolivia  Georgia  Ghana  Kenya  Lao  Lebanon  Monaco  Mongolia  Nicaragua  Nigeria  Qatar  Tanzania  Uganda  Zimbabwe</p>
  </div>
  <div class="page">
    <p>Solution</p>
    <p>Better tracker implementation</p>
    <p>Authentication with trackers  Similar to the one used in DHT</p>
    <p>Filtering packets by analyzing the protocol  e.g. check [SYN|ACK|80] incoming packets for legitimate</p>
    <p>HTTP header</p>
  </div>
  <div class="page">
    <p>End</p>
    <p>Q and A</p>
  </div>
  <div class="page">
    <p>Tracker</p>
    <p>seeder</p>
    <p>client</p>
    <p>.torrent</p>
    <p>.torrent</p>
    <p>I have the file!</p>
    <p>Who has the file?</p>
    <p>Discussion forum</p>
  </div>
  <div class="page">
    <p>Tracker</p>
    <p>victim</p>
    <p>clients</p>
    <p>attacker</p>
    <p>Victim has the files!</p>
    <p>Discussion forum</p>
    <p>Who has the files?</p>
    <p>.torrent .torrent</p>
    <p>.torrent .torrent</p>
    <p>.torrent .torrent</p>
  </div>
</Presentation>
