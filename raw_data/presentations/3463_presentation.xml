<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>O Single Sign-Off, Where Art Thou? An Empirical Analysis of Single Sign-On</p>
    <p>Account Hijacking and Session Management on the Web</p>
    <p>Mohammad Ghasemisharif, Amrutha Ramesh, Stephen Checkoway, Chris Kanich, and Jason Polakis</p>
    <p>University of Illinois at Chicago</p>
    <p>USENIX Security Symposium, August 2018</p>
  </div>
  <div class="page">
    <p>Single Sign-On</p>
  </div>
  <div class="page">
    <p>Single Sing-On Authentication Flow</p>
    <p>Identity Provider (IdP or OP)</p>
    <p>Relying Party (RP or client)</p>
    <p>End User</p>
  </div>
  <div class="page">
    <p>Single Sing-On Authentication Flow</p>
    <p>Identity Provider (IdP or OP)</p>
    <p>Relying Party (RP or client)</p>
    <p>End User Login to RP</p>
    <p>Authorization Endpoint</p>
    <p>HTTP 302</p>
  </div>
  <div class="page">
    <p>Single Sing-On Authentication Flow</p>
    <p>Identity Provider (IdP or OP)</p>
    <p>Relying Party (RP or client)</p>
    <p>End User Login to RP</p>
    <p>Authorization Endpoint</p>
    <p>HTTP 302</p>
    <p>Is User Agent logged in?</p>
  </div>
  <div class="page">
    <p>Single Sing-On Authentication Flow</p>
    <p>Identity Provider (IdP or OP)</p>
    <p>Relying Party (RP or client)</p>
    <p>End User Login to RP</p>
    <p>Authorization Endpoint</p>
    <p>HTTP 302</p>
  </div>
  <div class="page">
    <p>Single Sing-On Authentication Flow</p>
    <p>Identity Provider (IdP or OP)</p>
    <p>Relying Party (RP or client)</p>
    <p>End User Login to RP</p>
    <p>Authorization code Authorization Endpoint</p>
    <p>HTTP 302</p>
  </div>
  <div class="page">
    <p>Single Sing-On Authentication Flow</p>
    <p>Identity Provider (IdP or OP)</p>
    <p>Relying Party (RP or client)</p>
    <p>End User Login to RP</p>
    <p>Authorization code</p>
    <p>Token Endpoint Retrieve Tokens</p>
    <p>Authorization Endpoint</p>
    <p>HTTP 302</p>
  </div>
  <div class="page">
    <p>Single Sing-On Authentication Flow</p>
    <p>Relying Party (RP or client)</p>
    <p>End User</p>
  </div>
  <div class="page">
    <p>Single Sign-On, the Good, the Bad and the Ugly</p>
  </div>
  <div class="page">
    <p>Single Sign-On, the Good, the Bad and the Ugly</p>
    <p>Good  Ease of use  Integrated experience  Eliminates burden of</p>
    <p>multiple account creation</p>
  </div>
  <div class="page">
    <p>Single Sign-On, the Good, the Bad and the Ugly</p>
    <p>Good  Ease of use  Integrated experience  Eliminates burden of</p>
    <p>multiple account creation</p>
    <p>Bad  Attackers can leverage</p>
    <p>the same functionality to increase access coverage even when it is implemented correctly</p>
  </div>
  <div class="page">
    <p>Single Sign-On, the Good, the Bad and the Ugly</p>
    <p>Good  Ease of use  Integrated experience  Eliminates burden of</p>
    <p>multiple account creation</p>
    <p>Bad  Attackers can leverage</p>
    <p>the same functionality to increase access coverage even when it is implemented correctly</p>
    <p>Ugly  Very hard/impossible</p>
    <p>to recover from IdP account compromise</p>
  </div>
  <div class="page">
    <p>Threat Model</p>
    <p>IdP accounts are keys to the kingdom  We are not concerned with how they are compromised</p>
    <p>In our experiments we consider  Phishing (main type of Google account compromise [Bursztein et al.,</p>
    <p>IMC14])  Cookie hijacking [Sivakorn et al., S&amp;P16]</p>
    <p>These attacks capture different levels of capabilities and technical difficulty</p>
  </div>
  <div class="page">
    <p>Facebook Account Takeover</p>
    <p>Audited Messenger, Instagram, Main FB app on major platforms</p>
  </div>
  <div class="page">
    <p>Facebook Account Takeover</p>
    <p>Audited Messenger, Instagram, Main FB app on major platforms</p>
    <p>staticxx.facebook.com</p>
    <p>No HSTS, No Secure flag</p>
  </div>
  <div class="page">
    <p>Facebook Account Takeover</p>
    <p>Audited Messenger, Instagram, Main FB app on major platforms  Attackers session doesnt show up in FB active sessions</p>
    <p>staticxx.facebook.com</p>
    <p>No HSTS, No Secure flag</p>
  </div>
  <div class="page">
    <p>Facebook Account Takeover</p>
    <p>Audited Messenger, Instagram, Main FB app on major platforms  Attackers session doesnt show up in FB active sessions  Session hijack also allows password overwrite</p>
    <p>staticxx.facebook.com</p>
    <p>No HSTS, No Secure flag</p>
  </div>
  <div class="page">
    <p>Quantifying Facebook Vulnerability</p>
    <p>Passively monitored universitys wireless traffic for duration of four months (January  May 2017) [IRB approved]  5,729 unique session cookies  Total account takeover through cookie hijacking  11 different subdomains</p>
  </div>
  <div class="page">
    <p>Quantifying SSO Adoption</p>
    <p>65 IdPs (OAuth 2.0 and/or OpenID Connect)  Crawled Alexa top 1 million  912,206 correctly processed  57,555 (6.3%) SSO support  Prominent IdP: Facebook (4.62%)  Google (2.75%)  Twitter (1.34%)</p>
  </div>
  <div class="page">
    <p>Some RPs Are IdPs</p>
  </div>
  <div class="page">
    <p>Some RPs Are IdPs</p>
  </div>
  <div class="page">
    <p>Some RPs Are IdPs</p>
  </div>
  <div class="page">
    <p>Some RPs Are IdPs</p>
  </div>
  <div class="page">
    <p>Some RPs Are IdPs</p>
  </div>
  <div class="page">
    <p>Dual behavior in IdPs: 52%</p>
    <p>Some RPs Are IdPs</p>
  </div>
  <div class="page">
    <p>Attack Scenarios</p>
    <p>RP account takeover  Preemptive RP account takeover</p>
  </div>
  <div class="page">
    <p>Relying Party Account Takeover</p>
    <p>Studied 95 major services  29 Web from Alexa top 500  66 iOS applications</p>
    <p>Is it feasible to access RP services using hijacked IdP cookie?  How much of the attack is visible to the victim?  How long can the attacker maintain the access?</p>
  </div>
  <div class="page">
    <p>Relying Party Account Takeover</p>
    <p>98% did not require reauthentication when using cookies  Visibility test on 95 services:  None of the RPs notified victim  No alarm on Facebook</p>
    <p>Uber  Real-time tracking  Past trips  Can even tip the</p>
    <p>driver :-)</p>
    <p>HUD (Dating app)  Messages remain</p>
    <p>unread</p>
  </div>
  <div class="page">
    <p>Long-term Access (variation 1)</p>
    <p>Lines between SSO and local account management become blurry  Gain initial access over SSO, switch to email/password afterwards  Enables stealthy long-term access</p>
    <p>Email modification  15 out of 29 did not require password for modifying emails</p>
    <p>RPs</p>
    <p>Ema il/Pa</p>
    <p>ssw ord</p>
  </div>
  <div class="page">
    <p>Long-term Access (variation 2)</p>
    <p>Account linking attack  5 out of 29 are vulnerable</p>
    <p>Stealthy  victim never gets notified  Exhaustive manual work for remediation</p>
    <p>Victims RPAtt</p>
    <p>ack ers</p>
    <p>FB</p>
    <p>Victims FB</p>
  </div>
  <div class="page">
    <p>Long-term Access (variation 2)</p>
    <p>Account linking attack  5 out of 29 are vulnerable</p>
    <p>Stealthy  victim never gets notified  Exhaustive manual work for remediation</p>
    <p>Victims RPAtt</p>
    <p>ack ers</p>
    <p>FB</p>
    <p>Victims FB</p>
  </div>
  <div class="page">
    <p>Long-term Access (variation 2)</p>
    <p>Account linking attack  5 out of 29 are vulnerable</p>
    <p>Stealthy  victim never gets notified  Exhaustive manual work for remediation</p>
    <p>Victims RPAtt</p>
    <p>ack ers</p>
    <p>FB</p>
    <p>Victims FB</p>
  </div>
  <div class="page">
    <p>Long-term Access (variation 2)</p>
    <p>Account linking attack  5 out of 29 are vulnerable</p>
    <p>Stealthy  victim never gets notified  Exhaustive manual work for remediation</p>
    <p>Victims RPAtt</p>
    <p>ack ers</p>
    <p>FB</p>
    <p>Victims FB</p>
  </div>
  <div class="page">
    <p>What if the victim doesnt yet have an RP account?</p>
  </div>
  <div class="page">
    <p>Preemptive Relying Party Account Takeover</p>
    <p>Authentication Method Account Already Exists Account Doesnt Exist</p>
    <p>Traditional credential-based authentication</p>
    <p>Single Sign-On</p>
  </div>
  <div class="page">
    <p>Preemptive Relying Party Account Takeover</p>
    <p>Authentication Method Account Already Exists Account Doesnt Exist</p>
    <p>Traditional credential-based authentication</p>
    <p>Single Sign-On</p>
  </div>
  <div class="page">
    <p>Preemptive Relying Party Account Takeover</p>
    <p>Authentication Method Account Already Exists Account Doesnt Exist</p>
    <p>Traditional credential-based authentication</p>
    <p>Single Sign-On (Account Creation)</p>
    <p>(Login)</p>
  </div>
  <div class="page">
    <p>Post-Compromise Remediation</p>
    <p>A two-link chain is created upon user authentication with SSO:  User and IdP  User and RP</p>
    <p>RPIdP</p>
    <p>What can victims do once they become aware of their account being hijacked?</p>
  </div>
  <div class="page">
    <p>Post-Compromise Remediation</p>
    <p>A two-link chain is created upon user authentication with SSO:  User and IdP  User and RP RP Password</p>
    <p>Id P</p>
    <p>Pa ss wo</p>
    <p>rd</p>
    <p>IdP Se</p>
    <p>ssi on RP Session</p>
    <p>RPIdP</p>
    <p>What can victims do once they become aware of their account being hijacked?</p>
    <p>SSO Authorization</p>
  </div>
  <div class="page">
    <p>Post-Compromise Remediation</p>
    <p>A two-link chain is created upon user authentication with SSO:  User and IdP  User and RP RP Password</p>
    <p>Id P</p>
    <p>Pa ss wo</p>
    <p>rd</p>
    <p>IdP Se</p>
    <p>ssi on RP Session</p>
    <p>RP P</p>
    <p>as sw</p>
    <p>or d</p>
    <p>IdP Passw ord</p>
    <p>RP Ses</p>
    <p>sion RP Session</p>
    <p>RPIdP</p>
    <p>What can victims do once they become aware of their account being hijacked?</p>
    <p>SSO Authorization</p>
  </div>
  <div class="page">
    <p>Post-Compromise Remediation</p>
    <p>A two-link chain is created upon user authentication with SSO:  User and IdP  User and RP RP Password</p>
    <p>Id P</p>
    <p>Pa ss wo</p>
    <p>rd</p>
    <p>IdP Se</p>
    <p>ssi on RP Session</p>
    <p>RP P</p>
    <p>as sw</p>
    <p>or d</p>
    <p>RP Ses</p>
    <p>sion</p>
    <p>RPIdP</p>
    <p>What can victims do once they become aware of their account being hijacked?</p>
  </div>
  <div class="page">
    <p>Post-Compromise Remediation</p>
    <p>What session management options are available?  How effective are they?</p>
    <p>Possible remediation actions:  Logout from IdP  Logout from RP  Reset/change IdP password  Add/change RP password  Revoke RP access from IdP  Invalidate active RP sessions from RP</p>
    <p>Examined each action independently on 95 RPs</p>
  </div>
  <div class="page">
    <p>Post-Compromise Remediation</p>
    <p>No effective recovery action for 74.7% RPs  89.5% RPs do not offer session management  Complete remediation: revoking RP access and invalidating active</p>
    <p>sessions  Until RP cookie expires  short-lived sessions in only 5 Web RPs</p>
    <p>GoodReads:  revoke access only affects Web access</p>
    <p>Kayak:  partial read access always remains</p>
  </div>
  <div class="page">
    <p>Single Sign-Off</p>
    <p>Identity Provider</p>
    <p>User Devices</p>
    <p>Relying Parties</p>
    <p>User access Hijacking Authentication revocation</p>
  </div>
  <div class="page">
    <p>Single Sign-Off</p>
    <p>Identity Provider</p>
    <p>User Devices</p>
    <p>Relying Parties</p>
    <p>User access Hijacking Authentication revocation</p>
    <p>Steps - : IdP account compromise</p>
  </div>
  <div class="page">
    <p>Single Sign-Off</p>
    <p>Identity Provider</p>
    <p>User Devices</p>
    <p>Relying Parties</p>
    <p>User access Hijacking Authentication revocation</p>
    <p>Steps - : IdP account compromise</p>
  </div>
  <div class="page">
    <p>Single Sign-Off</p>
    <p>Identity Provider</p>
    <p>User Devices</p>
    <p>Relying Parties</p>
    <p>User access Hijacking Authentication revocation</p>
    <p>Steps - : IdP account compromise</p>
    <p>Revoke all tokens and notify all RPs</p>
  </div>
  <div class="page">
    <p>Single Sign-Off</p>
    <p>Identity Provider</p>
    <p>User Devices</p>
    <p>Relying Parties</p>
    <p>User access Hijacking Authentication revocation</p>
    <p>Steps - : IdP account compromise</p>
    <p>Revoke all tokens and notify all RPs</p>
    <p>RP accounts should be frozen until the victim reauthenticates through SSO</p>
  </div>
  <div class="page">
    <p>Takeaways</p>
    <p>SSO magnifies the scale and persistence of attacks, and also enables novel attacks not feasible with traditional credentialbased authentication.  No options for remediating account compromise in most</p>
    <p>services. Due to SSO prevalence, remediation infeasible in practice.  We propose a strict universal revocation scheme that addresses</p>
    <p>the attacks enabled by SSO.</p>
  </div>
  <div class="page">
    <p>Questions</p>
    <p>Please read the paper for all the missing details  Feel free to contact me:  mghas2@uic.edu</p>
    <p>Dataset: http://cs.uic.edu/~sso-study</p>
  </div>
</Presentation>
