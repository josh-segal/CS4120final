<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Performance Annotations for Cloud Computing</p>
    <p>Daniele Rogora Steffen Smolka% Antonio Carzaniga Amer Diwan$</p>
    <p>Robert Soul</p>
    <p>presented by</p>
    <p>Daniele Rogora</p>
    <p>Universit della Svizzera italiana %Cornell University $Google Barefoot Networks</p>
    <p>HotCloud 2017</p>
  </div>
  <div class="page">
    <p>Data Centers Are Everywhere...</p>
    <p>Data centers provide  Services for end users</p>
    <p>Google, Facebook, Dropbox</p>
    <p>Services for companies and universities  AWS for SAP, cloud mail services</p>
    <p>Raw processing power (IaaS, PaaS)  Amazon EC2, Microsoft Azure</p>
  </div>
  <div class="page">
    <p>Data Centers Are Everywhere...</p>
    <p>Data centers provide  Services for end users</p>
    <p>Google, Facebook, Dropbox</p>
    <p>Services for companies and universities  AWS for SAP, cloud mail services</p>
    <p>Raw processing power (IaaS, PaaS)  Amazon EC2, Microsoft Azure</p>
    <p>Data centers are widespread  Microsoft has more than 100 data centers</p>
    <p>they account for more than 1M servers</p>
    <p>Amazon has more than 30 data centers  they account for more than 1.5M servers</p>
    <p>Google has 15 data centers scattered around the world  in 2013 they accounted for around 900k servers</p>
  </div>
  <div class="page">
    <p>... But They Are Complex</p>
    <p>Machine 1</p>
    <p>Machine 2</p>
    <p>Machine 3</p>
    <p>Machine 4</p>
    <p>Machine 5</p>
    <p>Switch 1</p>
    <p>Machine 6</p>
    <p>Machine 7</p>
    <p>Machine 8</p>
    <p>Machine 9</p>
    <p>Machine 10</p>
    <p>Switch 2</p>
    <p>Machine 11</p>
    <p>Machine 12</p>
    <p>Machine 13</p>
    <p>Machine 14</p>
    <p>Machine 15</p>
    <p>Switch 3</p>
  </div>
  <div class="page">
    <p>... But They Are Complex</p>
    <p>Machine 1</p>
    <p>Machine 2</p>
    <p>Machine 3</p>
    <p>Machine 4</p>
    <p>Machine 5</p>
    <p>Switch 1</p>
    <p>Machine 6</p>
    <p>Machine 7</p>
    <p>Machine 8</p>
    <p>Machine 9</p>
    <p>Machine 10</p>
    <p>Switch 2</p>
    <p>Machine 11</p>
    <p>Machine 12</p>
    <p>Machine 13</p>
    <p>Machine 14</p>
    <p>Machine 15</p>
    <p>Switch 3</p>
    <p>CPU HDD NET</p>
  </div>
  <div class="page">
    <p>... But They Are Complex</p>
    <p>Machine 1</p>
    <p>Machine 2</p>
    <p>Machine 3</p>
    <p>Machine 4</p>
    <p>Machine 5</p>
    <p>Switch 1</p>
    <p>Machine 6</p>
    <p>Machine 7</p>
    <p>Machine 8</p>
    <p>Machine 9</p>
    <p>Machine 10</p>
    <p>Switch 2</p>
    <p>Machine 11</p>
    <p>Machine 12</p>
    <p>Machine 13</p>
    <p>Machine 14</p>
    <p>Machine 15</p>
    <p>Switch 3</p>
    <p>CPU HDD NET</p>
    <p>Operating System</p>
  </div>
  <div class="page">
    <p>... But They Are Complex</p>
    <p>Machine 1</p>
    <p>Machine 2</p>
    <p>Machine 3</p>
    <p>Machine 4</p>
    <p>Machine 5</p>
    <p>Switch 1</p>
    <p>Machine 6</p>
    <p>Machine 7</p>
    <p>Machine 8</p>
    <p>Machine 9</p>
    <p>Machine 10</p>
    <p>Switch 2</p>
    <p>Machine 11</p>
    <p>Machine 12</p>
    <p>Machine 13</p>
    <p>Machine 14</p>
    <p>Machine 15</p>
    <p>Switch 3</p>
    <p>CPU HDD NET</p>
    <p>Operating System</p>
    <p>Virtual Network</p>
  </div>
  <div class="page">
    <p>... But They Are Complex</p>
    <p>Machine 1</p>
    <p>Machine 2</p>
    <p>Machine 3</p>
    <p>Machine 4</p>
    <p>Machine 5</p>
    <p>Switch 1</p>
    <p>Machine 6</p>
    <p>Machine 7</p>
    <p>Machine 8</p>
    <p>Machine 9</p>
    <p>Machine 10</p>
    <p>Switch 2</p>
    <p>Machine 11</p>
    <p>Machine 12</p>
    <p>Machine 13</p>
    <p>Machine 14</p>
    <p>Machine 15</p>
    <p>Switch 3</p>
    <p>CPU HDD NET</p>
    <p>Operating System</p>
    <p>Virtual Network</p>
    <p>Virtual Machines</p>
  </div>
  <div class="page">
    <p>... But They Are Complex</p>
    <p>Machine 1</p>
    <p>Machine 2</p>
    <p>Machine 3</p>
    <p>Machine 4</p>
    <p>Machine 5</p>
    <p>Switch 1</p>
    <p>Machine 6</p>
    <p>Machine 7</p>
    <p>Machine 8</p>
    <p>Machine 9</p>
    <p>Machine 10</p>
    <p>Switch 2</p>
    <p>Machine 11</p>
    <p>Machine 12</p>
    <p>Machine 13</p>
    <p>Machine 14</p>
    <p>Machine 15</p>
    <p>Switch 3</p>
    <p>CPU HDD NET</p>
    <p>Operating System</p>
    <p>Virtual Network</p>
    <p>Virtual Machines</p>
    <p>Software</p>
  </div>
  <div class="page">
    <p>... But They Are Complex</p>
    <p>Machine 1</p>
    <p>Machine 2</p>
    <p>Machine 3</p>
    <p>Machine 4</p>
    <p>Machine 5</p>
    <p>Switch 1</p>
    <p>Machine 6</p>
    <p>Machine 7</p>
    <p>Machine 8</p>
    <p>Machine 9</p>
    <p>Machine 10</p>
    <p>Switch 2</p>
    <p>Machine 11</p>
    <p>Machine 12</p>
    <p>Machine 13</p>
    <p>Machine 14</p>
    <p>Machine 15</p>
    <p>Switch 3</p>
    <p>CPU HDD NET</p>
    <p>Operating System</p>
    <p>Virtual Network</p>
    <p>Virtual Machines</p>
    <p>Software</p>
    <p>CPU HDD NET</p>
    <p>Operating System</p>
    <p>Virtual Network</p>
    <p>Virtual Machines</p>
    <p>Software</p>
  </div>
  <div class="page">
    <p>... But They Are Complex</p>
    <p>Machine 1</p>
    <p>Machine 2</p>
    <p>Machine 3</p>
    <p>Machine 4</p>
    <p>Machine 5</p>
    <p>Switch 1</p>
    <p>Machine 6</p>
    <p>Machine 7</p>
    <p>Machine 8</p>
    <p>Machine 9</p>
    <p>Machine 10</p>
    <p>Switch 2</p>
    <p>Machine 11</p>
    <p>Machine 12</p>
    <p>Machine 13</p>
    <p>Machine 14</p>
    <p>Machine 15</p>
    <p>Switch 3</p>
    <p>CPU HDD NET</p>
    <p>Operating System</p>
    <p>Virtual Network</p>
    <p>Virtual Machines</p>
    <p>Software</p>
    <p>CPU HDD NET</p>
    <p>Operating System</p>
    <p>Virtual Network</p>
    <p>Virtual Machines</p>
    <p>Software</p>
  </div>
  <div class="page">
    <p>... But They Are Complex</p>
    <p>Machine 1</p>
    <p>Machine 2</p>
    <p>Machine 3</p>
    <p>Machine 4</p>
    <p>Machine 5</p>
    <p>Switch 1</p>
    <p>Machine 6</p>
    <p>Machine 7</p>
    <p>Machine 8</p>
    <p>Machine 9</p>
    <p>Machine 10</p>
    <p>Switch 2</p>
    <p>Machine 11</p>
    <p>Machine 12</p>
    <p>Machine 13</p>
    <p>Machine 14</p>
    <p>Machine 15</p>
    <p>Switch 3</p>
    <p>CPU HDD NET</p>
    <p>Operating System</p>
    <p>Virtual Network</p>
    <p>Virtual Machines</p>
    <p>Web Server</p>
    <p>CPU HDD NET</p>
    <p>Operating System</p>
    <p>Virtual Network</p>
    <p>Virtual Machines</p>
    <p>DBMS</p>
  </div>
  <div class="page">
    <p>... But They Are Complex</p>
    <p>Machine 1</p>
    <p>Machine 2</p>
    <p>Machine 3</p>
    <p>Machine 4</p>
    <p>Machine 5</p>
    <p>Switch 1</p>
    <p>Machine 6</p>
    <p>Machine 7</p>
    <p>Machine 8</p>
    <p>Machine 9</p>
    <p>Machine 10</p>
    <p>Switch 2</p>
    <p>Machine 11</p>
    <p>Machine 12</p>
    <p>Machine 13</p>
    <p>Machine 14</p>
    <p>Machine 15</p>
    <p>Switch 3</p>
    <p>CPU HDD NET</p>
    <p>Operating System</p>
    <p>Virtual Network</p>
    <p>Virtual Machines</p>
    <p>AUTH Web Server</p>
    <p>CPU HDD NET</p>
    <p>Operating System</p>
    <p>Virtual Network</p>
    <p>Virtual Machines</p>
    <p>DBMS</p>
    <p>RPC</p>
  </div>
  <div class="page">
    <p>... But They Are Complex</p>
    <p>Machine 1</p>
    <p>Machine 2</p>
    <p>Machine 3</p>
    <p>Machine 4</p>
    <p>Machine 5</p>
    <p>Switch 1</p>
    <p>Machine 6</p>
    <p>Machine 7</p>
    <p>Machine 8</p>
    <p>Machine 9</p>
    <p>Machine 10</p>
    <p>Switch 2</p>
    <p>Machine 11</p>
    <p>Machine 12</p>
    <p>Machine 13</p>
    <p>Machine 14</p>
    <p>Machine 15</p>
    <p>Switch 3</p>
    <p>CPU HDD NET</p>
    <p>Operating System</p>
    <p>Virtual Network</p>
    <p>Virtual Machines</p>
    <p>AUTH Web Server</p>
    <p>CPU HDD NET</p>
    <p>Operating System</p>
    <p>Virtual Network</p>
    <p>Virtual Machines</p>
    <p>DBMS</p>
    <p>RPC</p>
  </div>
  <div class="page">
    <p>Machine 1</p>
    <p>Machine 2</p>
    <p>Machine 3</p>
    <p>Machine 4</p>
    <p>Machine 5</p>
    <p>Switch 1</p>
    <p>Machine 1</p>
    <p>Machine 2</p>
    <p>Machine 3</p>
    <p>Machine 4</p>
    <p>Machine 5</p>
    <p>Switch 2</p>
    <p>Machine 11</p>
    <p>Machine 12</p>
    <p>Machine 13</p>
    <p>Machine 14</p>
    <p>Machine 15</p>
    <p>Switch 3</p>
    <p>Operating System</p>
    <p>Virtual Network</p>
    <p>Virtual Machines AUTH</p>
    <p>Web Server</p>
    <p>Operating System</p>
    <p>Virtual Network</p>
    <p>Virtual Machines</p>
    <p>DBMS</p>
    <p>RPC</p>
    <p>Understanding the performance of a data center is difficult</p>
    <p>many layers</p>
    <p>limited scope of tools and peoples knowledge</p>
  </div>
  <div class="page">
    <p>Machine 1</p>
    <p>Machine 2</p>
    <p>Machine 3</p>
    <p>Machine 4</p>
    <p>Machine 5</p>
    <p>Switch 1</p>
    <p>Machine 1</p>
    <p>Machine 2</p>
    <p>Machine 3</p>
    <p>Machine 4</p>
    <p>Machine 5</p>
    <p>Switch 2</p>
    <p>Machine 11</p>
    <p>Machine 12</p>
    <p>Machine 13</p>
    <p>Machine 14</p>
    <p>Machine 15</p>
    <p>Switch 3</p>
    <p>Operating System</p>
    <p>Virtual Network</p>
    <p>Virtual Machines AUTH</p>
    <p>Web Server</p>
    <p>Operating System</p>
    <p>Virtual Network</p>
    <p>Virtual Machines</p>
    <p>DBMS</p>
    <p>RPC</p>
    <p>Understanding the performance of a data center is difficult</p>
    <p>many layers</p>
    <p>limited scope of tools and peoples knowledge</p>
    <p>How much load increase can we support with the current</p>
    <p>setup? Where will the bottleneck be? What would break</p>
    <p>first?</p>
    <p>How much would it help to move the database server to</p>
    <p>faster hardware, or directly on the metal?</p>
    <p>Can we understand and explain unexpected behaviors?</p>
  </div>
  <div class="page">
    <p>Goal: Creating a New Model</p>
    <p>We want to build a dynamic performance model for data centers</p>
    <p>comprehensive</p>
    <p>live</p>
    <p>interactive</p>
  </div>
  <div class="page">
    <p>Goal: Creating a New Model</p>
    <p>We want to build a dynamic performance model for data centers</p>
    <p>comprehensive</p>
    <p>live</p>
    <p>interactive</p>
    <p>Logs</p>
    <p>Query</p>
    <p>Model</p>
  </div>
  <div class="page">
    <p>Goal: Creating a New Model</p>
    <p>We want to build a dynamic performance model for data centers</p>
    <p>comprehensive</p>
    <p>live</p>
    <p>interactive</p>
    <p>Logs</p>
    <p>Query</p>
    <p>Model</p>
    <p>How is it performing now?</p>
    <p>Performance</p>
  </div>
  <div class="page">
    <p>Goal: Creating a New Model</p>
    <p>We want to build a dynamic performance model for data centers</p>
    <p>comprehensive</p>
    <p>live</p>
    <p>interactive</p>
    <p>Logs</p>
    <p>Query</p>
    <p>Model</p>
    <p>What if the we improve the hardware?</p>
    <p>Predictive result</p>
  </div>
  <div class="page">
    <p>Goal: Creating a New Model</p>
    <p>We want to build a dynamic performance model for data centers</p>
    <p>comprehensive</p>
    <p>live</p>
    <p>interactive</p>
    <p>Logs</p>
    <p>Query</p>
    <p>Statistical Model</p>
  </div>
  <div class="page">
    <p>Performance Annotations</p>
  </div>
  <div class="page">
    <p>Example: a Web Service</p>
    <p>Request Response</p>
    <p>System</p>
    <p>The response time grows quadratically</p>
    <p>with the size of the body of the request</p>
  </div>
  <div class="page">
    <p>Example: a Web Service</p>
    <p>Request Response</p>
    <p>System</p>
    <p>The response time grows quadratically</p>
    <p>with the size of the body of the request</p>
    <p>ti m</p>
    <p>e (</p>
    <p>m s )</p>
    <p>body size (MB)</p>
  </div>
  <div class="page">
    <p>Example: a Web Service</p>
    <p>Request Response</p>
    <p>System</p>
    <p>The response time grows quadratically</p>
    <p>with the size of the body of the request</p>
    <p>ti m</p>
    <p>e (</p>
    <p>m s )</p>
    <p>body size (MB) @Time  a |in|2 + b |in|+ c</p>
  </div>
  <div class="page">
    <p>Example: a Web Service</p>
    <p>Request Response</p>
    <p>System</p>
    <p>The memory used grows linearly</p>
    <p>with the size of the body of the request</p>
    <p>m e m</p>
    <p>o ry</p>
    <p>u s a g e (</p>
    <p>k B</p>
    <p>)</p>
    <p>body size (kB) @Mem  a |in|+ b</p>
  </div>
  <div class="page">
    <p>Example: a Web Service</p>
    <p>Request Response</p>
    <p>System</p>
    <p>Machine 1 Machine 7</p>
  </div>
  <div class="page">
    <p>Example: a Web Service</p>
    <p>Request Response</p>
    <p>System</p>
    <p>Machine 1 Machine 7 VM PostgreSQL</p>
  </div>
  <div class="page">
    <p>Example: a Web Service</p>
    <p>Request Response</p>
    <p>System</p>
    <p>Machine 1 Machine 7 VM PostgreSQLApache WS</p>
  </div>
  <div class="page">
    <p>Example: a Web Service</p>
    <p>Request Response</p>
    <p>System</p>
    <p>Machine 1 Machine 7 VM PostgreSQLApache WS</p>
    <p>OwnCloud</p>
  </div>
  <div class="page">
    <p>Example: a Web Service</p>
    <p>Request Response</p>
    <p>System</p>
    <p>Machine 1 Machine 7 VM PostgreSQLApache WS</p>
    <p>OwnCloud</p>
    <p>getFile(string f)</p>
    <p>normalizePath(string p)</p>
    <p>parseQuery(string q)</p>
    <p>execute(query q)</p>
  </div>
  <div class="page">
    <p>Example: a Web Service</p>
    <p>Request Response</p>
    <p>System</p>
    <p>Machine 1 Machine 7 VM PostgreSQLApache WS</p>
    <p>OwnCloud</p>
    <p>getFile(string f)</p>
    <p>ti m</p>
    <p>e (</p>
    <p>m s )</p>
    <p>body size (MB)</p>
    <p>normalizePath(string p)</p>
    <p>m e</p>
    <p>m o</p>
    <p>ry u</p>
    <p>s a</p>
    <p>g e</p>
    <p>( k B</p>
    <p>)</p>
    <p>body size (kB)</p>
    <p>parseQuery(string q)</p>
    <p>M e</p>
    <p>m o</p>
    <p>ry (</p>
    <p>k b</p>
    <p>y te</p>
    <p>s )</p>
    <p>String length</p>
    <p>execute(query q)</p>
    <p>ti m</p>
    <p>e (</p>
    <p>m s )</p>
    <p>query size</p>
  </div>
  <div class="page">
    <p>M e</p>
    <p>m o</p>
    <p>ry (</p>
    <p>k b</p>
    <p>y te</p>
    <p>s )</p>
    <p>String length</p>
  </div>
  <div class="page">
    <p>M e</p>
    <p>m o</p>
    <p>ry (</p>
    <p>k b</p>
    <p>y te</p>
    <p>s )</p>
    <p>String length</p>
    <p>@MemConstant(8kB)</p>
  </div>
  <div class="page">
    <p>M e</p>
    <p>m o</p>
    <p>ry (</p>
    <p>k b</p>
    <p>y te</p>
    <p>s )</p>
    <p>String length</p>
    <p>@MemConstant(8kB) 0</p>
    <p>M e</p>
    <p>m o</p>
    <p>ry (</p>
    <p>k b</p>
    <p>y te</p>
    <p>s )</p>
    <p>Path length</p>
  </div>
  <div class="page">
    <p>M e</p>
    <p>m o</p>
    <p>ry (</p>
    <p>k b</p>
    <p>y te</p>
    <p>s )</p>
    <p>String length</p>
    <p>@MemConstant(8kB) 0</p>
    <p>M e</p>
    <p>m o</p>
    <p>ry (</p>
    <p>k b</p>
    <p>y te</p>
    <p>s )</p>
    <p>Path length</p>
    <p>Line Fit</p>
  </div>
  <div class="page">
    <p>M e</p>
    <p>m o</p>
    <p>ry (</p>
    <p>k b</p>
    <p>y te</p>
    <p>s )</p>
    <p>String length</p>
    <p>@MemConstant(8kB) 0</p>
    <p>M e</p>
    <p>m o</p>
    <p>ry (</p>
    <p>k b</p>
    <p>y te</p>
    <p>s )</p>
    <p>Path length</p>
    <p>Line Fit</p>
    <p>@MemNorm(5ms*path_len(path), 5ms)</p>
  </div>
  <div class="page">
    <p>M e</p>
    <p>m o</p>
    <p>ry (</p>
    <p>k b</p>
    <p>y te</p>
    <p>s )</p>
    <p>String length</p>
    <p>@MemConstant(8kB) 0</p>
    <p>M e</p>
    <p>m o</p>
    <p>ry (</p>
    <p>k b</p>
    <p>y te</p>
    <p>s )</p>
    <p>Path length</p>
    <p>Line Fit</p>
    <p>@MemNorm(5ms*path_len(path), 5ms)</p>
    <p>M e</p>
    <p>m o</p>
    <p>ry (</p>
    <p>k b</p>
    <p>y te</p>
    <p>s )</p>
    <p>String length 9 / 27</p>
  </div>
  <div class="page">
    <p>M e</p>
    <p>m o</p>
    <p>ry (</p>
    <p>k b</p>
    <p>y te</p>
    <p>s )</p>
    <p>String length</p>
    <p>@MemConstant(8kB) 0</p>
    <p>M e</p>
    <p>m o</p>
    <p>ry (</p>
    <p>k b</p>
    <p>y te</p>
    <p>s )</p>
    <p>Path length</p>
    <p>Line Fit</p>
    <p>@MemNorm(5ms*path_len(path), 5ms)</p>
    <p>M e</p>
    <p>m o</p>
    <p>ry (</p>
    <p>k b</p>
    <p>y te</p>
    <p>s )</p>
    <p>String length</p>
    <p>@MemConstant(4.2kB)</p>
    <p>@MemConstant(0.5kB)</p>
  </div>
  <div class="page">
    <p>M e</p>
    <p>m o</p>
    <p>ry (</p>
    <p>k b</p>
    <p>y te</p>
    <p>s )</p>
    <p>String length</p>
    <p>@MemConstant(8kB) 0</p>
    <p>M e</p>
    <p>m o</p>
    <p>ry (</p>
    <p>k b</p>
    <p>y te</p>
    <p>s )</p>
    <p>Path length</p>
    <p>Line Fit</p>
    <p>@MemNorm(5ms*path_len(path), 5ms)</p>
    <p>M e</p>
    <p>m o</p>
    <p>ry (</p>
    <p>k b</p>
    <p>y te</p>
    <p>s )</p>
    <p>String length</p>
    <p>@MemConstant(4.2kB)</p>
    <p>@MemConstant(0.5kB)</p>
    <p>e m</p>
    <p>o ry</p>
    <p>( b</p>
    <p>y te</p>
    <p>s )</p>
    <p>String length 9 / 27</p>
  </div>
  <div class="page">
    <p>M e</p>
    <p>m o</p>
    <p>ry (</p>
    <p>k b</p>
    <p>y te</p>
    <p>s )</p>
    <p>String length</p>
    <p>@MemConstant(8kB) 0</p>
    <p>M e</p>
    <p>m o</p>
    <p>ry (</p>
    <p>k b</p>
    <p>y te</p>
    <p>s )</p>
    <p>Path length</p>
    <p>Line Fit</p>
    <p>@MemNorm(5ms*path_len(path), 5ms)</p>
    <p>M e</p>
    <p>m o</p>
    <p>ry (</p>
    <p>k b</p>
    <p>y te</p>
    <p>s )</p>
    <p>String length</p>
    <p>@MemConstant(4.2kB)</p>
    <p>@MemConstant(0.5kB)</p>
    <p>e m</p>
    <p>o ry</p>
    <p>( b</p>
    <p>y te</p>
    <p>s )</p>
    <p>String length</p>
    <p>@Mem?</p>
  </div>
  <div class="page">
    <p>How To Create Annotations</p>
  </div>
  <div class="page">
    <p>Instrumentation</p>
  </div>
  <div class="page">
    <p>Instrumentation</p>
    <p>For every call of all the functions in the system, we need:</p>
    <p>metrics of interest  execution time  dynamic memory allocation  locks holding time</p>
    <p>relevant features of the input parameters  string length  collection size</p>
  </div>
  <div class="page">
    <p>Instrumentation</p>
    <p>For every call of all the functions in the system, we need:</p>
    <p>metrics of interest  execution time  dynamic memory allocation  locks holding time</p>
    <p>relevant features of the input parameters  string length  collection size</p>
    <p>Also, the instrumentation must be:</p>
    <p>crosslayer</p>
    <p>crossplatform</p>
  </div>
  <div class="page">
    <p>Automatic Annotation Inference</p>
  </div>
  <div class="page">
    <p>Automatic Annotation Inference</p>
    <p>Logs</p>
    <p>Function: correctFolderSize feature: collection size pcc: 0.5610</p>
    <p>M e m</p>
    <p>o ry</p>
    <p>( k b y te</p>
    <p>s )</p>
    <p>Collection size</p>
  </div>
  <div class="page">
    <p>Automatic Annotation Inference</p>
    <p>Logs</p>
    <p>Function: correctFolderSize feature: string length</p>
    <p>pcc: 0.78673</p>
    <p>M e m</p>
    <p>o ry</p>
    <p>( k b y te</p>
    <p>s )</p>
    <p>String length</p>
  </div>
  <div class="page">
    <p>Automatic Annotation Inference</p>
    <p>Logs</p>
    <p>Function: correctFolderSize feature: path length</p>
    <p>pcc: 0.9473</p>
    <p>M e m</p>
    <p>o ry</p>
    <p>( k b y te</p>
    <p>s )</p>
    <p>Path length</p>
  </div>
  <div class="page">
    <p>Automatic Annotation Inference</p>
    <p>Logs</p>
    <p>Function: correctFolderSize feature: path length</p>
    <p>pcc: 0.9473</p>
    <p>M e m</p>
    <p>o ry</p>
    <p>( k b y te</p>
    <p>s )</p>
    <p>Path length</p>
    <p>Line fit</p>
    <p>regression</p>
  </div>
  <div class="page">
    <p>Automatic Annotation Inference</p>
    <p>Logs</p>
    <p>Function: broadcastEvent feature: collection size pcc: -0.1155</p>
    <p>T im</p>
    <p>e (</p>
    <p>m s )</p>
    <p>Collection size</p>
  </div>
  <div class="page">
    <p>Automatic Annotation Inference</p>
    <p>Logs</p>
    <p>Function: broadcastEvent feature: string length</p>
    <p>pcc: -0.2764</p>
    <p>T im</p>
    <p>e (</p>
    <p>m s )</p>
    <p>String length</p>
  </div>
  <div class="page">
    <p>Automatic Annotation Inference</p>
    <p>Logs</p>
    <p>Function: broadcastEvent no feature</p>
    <p>-1 -0.5 0 0.5 1</p>
    <p>T im</p>
    <p>e (</p>
    <p>m s )</p>
    <p>Scalar value</p>
    <p>clusters</p>
  </div>
  <div class="page">
    <p>Annotations Uses</p>
  </div>
  <div class="page">
    <p>Uses</p>
  </div>
  <div class="page">
    <p>Uses</p>
    <p>Documentation  how do functions behave?</p>
  </div>
  <div class="page">
    <p>Uses</p>
    <p>Documentation  how do functions behave?</p>
    <p>Anomaly/failure detection  is the system behaving normally? Is there a performance regression?</p>
  </div>
  <div class="page">
    <p>Uses</p>
    <p>Documentation  how do functions behave?</p>
    <p>Anomaly/failure detection  is the system behaving normally? Is there a performance regression?</p>
    <p>Extrapolation  can we scale up?</p>
  </div>
  <div class="page">
    <p>Uses</p>
    <p>Documentation  how do functions behave?</p>
    <p>Anomaly/failure detection  is the system behaving normally? Is there a performance regression?</p>
    <p>Extrapolation  can we scale up?</p>
    <p>Composition  can we infer the behavior of the caller from the annotations of the callees?</p>
  </div>
  <div class="page">
    <p>Case Study</p>
  </div>
  <div class="page">
    <p>Case Study</p>
    <p>setup</p>
  </div>
  <div class="page">
    <p>The System: Application Level</p>
    <p>Client</p>
    <p>VM</p>
    <p>HAProxy</p>
    <p>VM nginx</p>
    <p>OwnCloud VM</p>
    <p>PostgreSQL</p>
    <p>VM</p>
    <p>NFS</p>
    <p>WEBDAV WEBDAV</p>
    <p>TCP</p>
    <p>TCP</p>
  </div>
  <div class="page">
    <p>The System: Computing Resources</p>
    <p>ETH</p>
    <p>Host01 Host02</p>
    <p>Host03 Host04 Host05 Host06 Host07</p>
    <p>Host08 Host09 Host10 Host11 Host12</p>
  </div>
  <div class="page">
    <p>The System: Computing Resources</p>
    <p>ETH + VLAN</p>
    <p>Host01</p>
    <p>Test</p>
    <p>Host02</p>
    <p>Openstack</p>
    <p>Neutron</p>
    <p>Host03 Host04 Host05 Host06 Host07</p>
    <p>Host08 Host09 Host10 Host11 Host12</p>
  </div>
  <div class="page">
    <p>The System: Computing Resources</p>
    <p>ETH + VLAN</p>
    <p>STORAGE NODE</p>
    <p>Host01</p>
    <p>Test</p>
    <p>Host02</p>
    <p>Openstack</p>
    <p>Neutron</p>
    <p>Host03 Host04 Host05 Host06 Host07</p>
    <p>Host08</p>
    <p>Ceph OSD</p>
    <p>Host09</p>
    <p>Ceph OSD</p>
    <p>Host10</p>
    <p>Ceph OSD</p>
    <p>Host11</p>
    <p>Ceph OSD</p>
    <p>Host12</p>
    <p>Ceph OSD</p>
  </div>
  <div class="page">
    <p>The System: Computing Resources</p>
    <p>ETH + VLAN</p>
    <p>COMPUTE NODE</p>
    <p>STORAGE NODE</p>
    <p>Host01</p>
    <p>Test</p>
    <p>Host02</p>
    <p>Openstack</p>
    <p>Neutron</p>
    <p>Host03</p>
    <p>Ceph master</p>
    <p>DBMS</p>
    <p>Host04</p>
    <p>Ceph master</p>
    <p>NFS server</p>
    <p>Host05</p>
    <p>Ceph master</p>
    <p>Web server</p>
    <p>Host06</p>
    <p>Sync server</p>
    <p>DBMS</p>
    <p>Host07</p>
    <p>Load balancer</p>
    <p>LDAP</p>
    <p>Host08</p>
    <p>Ceph OSD</p>
    <p>Host09</p>
    <p>Ceph OSD</p>
    <p>Host10</p>
    <p>Ceph OSD</p>
    <p>Host11</p>
    <p>Ceph OSD</p>
    <p>Host12</p>
    <p>Ceph OSD</p>
  </div>
  <div class="page">
    <p>PHP Instrumentation</p>
    <p>OwnCloud (php)</p>
    <p>function foo(){...}</p>
  </div>
  <div class="page">
    <p>PHP Instrumentation</p>
    <p>OwnCloud (php)</p>
    <p>function foo_inner() {...}</p>
  </div>
  <div class="page">
    <p>PHP Instrumentation</p>
    <p>OwnCloud (php)</p>
    <p>function foo_inner() {...}</p>
    <p>foo_inner()</p>
    <p>function foo() {</p>
    <p>start = time()</p>
    <p>end = time()</p>
    <p>log(end - start)</p>
    <p>}</p>
  </div>
  <div class="page">
    <p>Cross-Platform Instrumentation</p>
    <p>OwnCloud (php)</p>
    <p>function write_to_db() {</p>
    <p>...</p>
    <p>}</p>
  </div>
  <div class="page">
    <p>Cross-Platform Instrumentation</p>
    <p>OwnCloud (php)</p>
    <p>function write_to_db() { ...</p>
    <p>trace_id = rnd_string() ...</p>
    <p>}</p>
  </div>
  <div class="page">
    <p>Cross-Platform Instrumentation</p>
    <p>OwnCloud (php)</p>
    <p>function write_to_db() { ...</p>
    <p>trace_id = rnd_string() ...</p>
    <p>}</p>
    <p>PostgreSQL (C)</p>
    <p>function execute_query() { ...</p>
    <p>get(trace_id) ...</p>
    <p>}</p>
  </div>
  <div class="page">
    <p>Cross-Platform Instrumentation</p>
    <p>OwnCloud (php)</p>
    <p>function write_to_db() { ...</p>
    <p>trace_id = rnd_string() ...</p>
    <p>}</p>
    <p>PostgreSQL (C)</p>
    <p>function execute_query() { ...</p>
    <p>get(trace_id) ...</p>
    <p>}</p>
    <p>Marshaller (C)</p>
    <p>marshall() { ...</p>
    <p>put(trace_id) ...</p>
    <p>}</p>
    <p>Unmarshaller (C)</p>
    <p>unmarshall() { ...</p>
    <p>get(trace_id) ...</p>
    <p>}</p>
  </div>
  <div class="page">
    <p>Case Study</p>
  </div>
  <div class="page">
    <p>Case Study</p>
    <p>annotations</p>
  </div>
  <div class="page">
    <p>It Works!</p>
    <p>M e</p>
    <p>m o</p>
    <p>ry (</p>
    <p>k b</p>
    <p>y te</p>
    <p>s )</p>
    <p>Collection size</p>
    <p>@Mem  721.362B |in|+ 8851.16B</p>
  </div>
  <div class="page">
    <p>It Works!</p>
    <p>M e</p>
    <p>m o</p>
    <p>ry (</p>
    <p>k b</p>
    <p>y te</p>
    <p>s )</p>
    <p>String length</p>
    <p>\OC\Files\View::getOwner()</p>
    <p>@Mem  8.240kB</p>
  </div>
  <div class="page">
    <p>It Works!</p>
    <p>T im</p>
    <p>e (</p>
    <p>m s )</p>
    <p>Collection size</p>
    <p>\Sabre\DAV\Server::generateMultiStatus()</p>
    <p>@Time  3.6e  03B |in|2 + 3.8e  05B |in|+ 6.6e  06B</p>
  </div>
  <div class="page">
    <p>It Works!</p>
    <p>M e</p>
    <p>m o</p>
    <p>ry (</p>
    <p>b y te</p>
    <p>s )</p>
    <p>String length</p>
    <p>\OC\Files\Cache\Cache::normalize()</p>
    <p>@Mem  Norm (</p>
    <p>Norm (</p>
    <p>Norm (</p>
    <p>Norm (</p>
    <p>Norm (</p>
    <p>Norm (</p>
  </div>
  <div class="page">
    <p>Case Study</p>
  </div>
  <div class="page">
    <p>Case Study</p>
    <p>anomaly detection</p>
  </div>
  <div class="page">
    <p>Anomaly Injection</p>
    <p>Client</p>
    <p>VM</p>
    <p>HAProxy</p>
    <p>VM nginx</p>
    <p>OwnCloud VM</p>
    <p>PostgreSQL</p>
    <p>VM</p>
    <p>NFS</p>
    <p>WEBDAV WEBDAV</p>
    <p>TCP</p>
    <p>TCP</p>
  </div>
  <div class="page">
    <p>Anomaly Injection</p>
    <p>Client</p>
    <p>VM</p>
    <p>HAProxy</p>
    <p>VM nginx</p>
    <p>OwnCloud VM</p>
    <p>PostgreSQL</p>
    <p>VM</p>
    <p>NFS</p>
    <p>WEBDAV WEBDAV</p>
    <p>TCP</p>
    <p>TCP</p>
    <p>Added Latency: 1-10ms 23 / 27</p>
  </div>
  <div class="page">
    <p>Annotations Catch The Anomaly</p>
    <p>%</p>
    <p>Annotation robustness (%)</p>
    <p>no delay</p>
  </div>
  <div class="page">
    <p>Annotations Catch The Anomaly</p>
    <p>%</p>
    <p>Annotation robustness (%)</p>
    <p>no delay</p>
  </div>
  <div class="page">
    <p>Annotations Catch The Anomaly</p>
    <p>%</p>
    <p>Annotation robustness (%)</p>
    <p>no delay</p>
  </div>
  <div class="page">
    <p>Annotations Catch The Anomaly</p>
    <p>%</p>
    <p>Annotation robustness (%)</p>
    <p>no delay</p>
  </div>
  <div class="page">
    <p>Annotations Catch The Anomaly</p>
    <p>%</p>
    <p>Annotation robustness (%)</p>
    <p>no delay</p>
  </div>
  <div class="page">
    <p>Future</p>
  </div>
  <div class="page">
    <p>Ongoing Work - Discussion</p>
    <p>Machine learning techniques fine tuning</p>
  </div>
  <div class="page">
    <p>Ongoing Work - Discussion</p>
    <p>Machine learning techniques fine tuning</p>
    <p>Annotations composition  stack analysis</p>
  </div>
  <div class="page">
    <p>Ongoing Work - Discussion</p>
    <p>Machine learning techniques fine tuning</p>
    <p>Annotations composition  stack analysis</p>
    <p>Workload creation  can we forge workloads that expose specific behaviors?</p>
  </div>
  <div class="page">
    <p>Ongoing Work - Discussion</p>
    <p>Machine learning techniques fine tuning</p>
    <p>Annotations composition  stack analysis</p>
    <p>Workload creation  can we forge workloads that expose specific behaviors?</p>
    <p>Feature Selection  Is a heuristically built set of basic features enough?  Can we exploit programmers knowledge of the system?</p>
  </div>
  <div class="page">
    <p>Ongoing Work - Discussion</p>
    <p>Machine learning techniques fine tuning</p>
    <p>Annotations composition  stack analysis</p>
    <p>Workload creation  can we forge workloads that expose specific behaviors?</p>
    <p>Feature Selection  Is a heuristically built set of basic features enough?  Can we exploit programmers knowledge of the system?</p>
    <p>Extensive testing  Java, DaCapo benchmarks</p>
  </div>
  <div class="page">
    <p>Performance Annotations for Cloud Computing</p>
    <p>Daniele Rogora Steffen Smolka% Antonio Carzaniga Amer Diwan$</p>
    <p>Robert Soul</p>
    <p>presented by</p>
    <p>Daniele Rogora</p>
    <p>Universit della Svizzera italiana %Cornell University $Google Barefoot Networks</p>
    <p>HotCloud 2017</p>
  </div>
</Presentation>
