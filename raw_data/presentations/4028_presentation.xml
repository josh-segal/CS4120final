<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Automated Reverse Engineering using Lego</p>
    <p>Georg Chalupar and Stefan Peherstorfer University of Applied Sciences Upper Austria</p>
    <p>Erik Poll and Joeri de Ruiter Radboud University Nijmegen</p>
  </div>
  <div class="page">
    <p>Joeri de Ruiter - Digital Security, Radboud University Nijmegen 2 / 19</p>
    <p>Introduction</p>
    <p>Used automated learning techniques to reverse engineer e.dentifier2</p>
    <p>Results in state machines  Previously done for bank cards</p>
  </div>
  <div class="page">
    <p>Joeri de Ruiter - Digital Security, Radboud University Nijmegen 3 / 19</p>
    <p>e.dentifier2</p>
    <p>Developed by Todos (now Gemalto)</p>
    <p>EMV-CAP  Can be used with or without USB  With USB:</p>
    <p>See-What-You-Sign  the most secure sign-what-you-see</p>
    <p>end user device ever seen  Good idea!</p>
  </div>
  <div class="page">
    <p>Joeri de Ruiter - Digital Security, Radboud University Nijmegen 4 / 19</p>
    <p>EMV-CAP</p>
    <p>challenge</p>
    <p>bitfilter(AC)</p>
    <p>PIN</p>
    <p>GENERATE AC (challenge,...)</p>
    <p>AC</p>
    <p>PIN</p>
    <p>OK</p>
  </div>
  <div class="page">
    <p>Joeri de Ruiter - Digital Security, Radboud University Nijmegen 5 / 19</p>
    <p>Protocol e.dentifier2</p>
  </div>
  <div class="page">
    <p>Joeri de Ruiter - Digital Security, Radboud University Nijmegen 6 / 19</p>
    <p>Protocol e.dentifier2</p>
  </div>
  <div class="page">
    <p>Joeri de Ruiter - Digital Security, Radboud University Nijmegen 7 / 19</p>
    <p>Protocol e.dentifier2</p>
  </div>
  <div class="page">
    <p>Joeri de Ruiter - Digital Security, Radboud University Nijmegen 8 / 19</p>
    <p>Protocol e.dentifier2</p>
  </div>
  <div class="page">
    <p>Joeri de Ruiter - Digital Security, Radboud University Nijmegen 9 / 19</p>
    <p>Automated learning</p>
    <p>Used LearnLib  Implementation of</p>
    <p>adapted L* algorithm</p>
    <p>Complete Mealy machine</p>
    <p>Equivalence queries approximated  Random traces  W-method</p>
  </div>
  <div class="page">
    <p>Joeri de Ruiter - Digital Security, Radboud University Nijmegen 10 / 19</p>
    <p>Using automated learning</p>
    <p>Reverse engineering  Manual inspection of correctness and security</p>
    <p>Fuzzing or model-based testing  Use as basis for automated fuzz testing</p>
    <p>Formal verification  Use as basis for model checking</p>
  </div>
  <div class="page">
    <p>Joeri de Ruiter - Digital Security, Radboud University Nijmegen 11 / 19</p>
    <p>Automated reverse engineering</p>
    <p>Two different versions of the device  Programmable smart card</p>
    <p>All PIN codes accepted  Responses fixed</p>
    <p>Physical interaction needed</p>
  </div>
  <div class="page">
    <p>Joeri de Ruiter - Digital Security, Radboud University Nijmegen 12 / 19</p>
    <p>Robot</p>
    <p>Built using Lego  Controlled by Raspberry Pi</p>
    <p>3 motors: OK, Cancel, digit  Power USB line  USB commands</p>
  </div>
  <div class="page">
    <p>Joeri de Ruiter - Digital Security, Radboud University Nijmegen 13 / 19</p>
    <p>Robot</p>
  </div>
  <div class="page">
    <p>Joeri de Ruiter - Digital Security, Radboud University Nijmegen 14 / 19</p>
    <p>Robot</p>
  </div>
  <div class="page">
    <p>Joeri de Ruiter - Digital Security, Radboud University Nijmegen 15 / 19</p>
    <p>Results</p>
  </div>
  <div class="page">
    <p>Joeri de Ruiter - Digital Security, Radboud University Nijmegen 16 / 19</p>
    <p>Results</p>
  </div>
  <div class="page">
    <p>Joeri de Ruiter - Digital Security, Radboud University Nijmegen 17 / 19</p>
    <p>Model checking</p>
    <p>Converted output to labelled transition system  Used model checker CADP  Checked property in modal logic</p>
    <p>Is valid cryptogram generated only after OK button is pushed?</p>
    <p>Resulted in an attack trace for the old device</p>
  </div>
  <div class="page">
    <p>Joeri de Ruiter - Digital Security, Radboud University Nijmegen 18 / 19</p>
    <p>Conclusions</p>
    <p>Automated learning techniques  Useful in security analysis for embedded devices  Can automatically find security vulnerabilities  Good excuse to play with Lego</p>
  </div>
  <div class="page">
    <p>Joeri de Ruiter - Digital Security, Radboud University Nijmegen 19 / 19</p>
    <p>Conclusions</p>
    <p>Automated learning techniques  Useful in security analysis for embedded devices  Can automatically find security vulnerabilities  Good excuse to play with Lego</p>
    <p>Thanks for your attention!</p>
  </div>
</Presentation>
