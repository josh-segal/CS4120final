<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>LP-based Algorithms for Capacitated Facility Location</p>
    <p>Chaitanya Swamy</p>
    <p>Joint work with Retsef Levi and David Shmoys</p>
    <p>Cornell University</p>
  </div>
  <div class="page">
    <p>Capacitated Facility Location (CFL)</p>
    <p>F : set of facilities D : set of clients.</p>
    <p>Facility i has facility cost = fi capacity</p>
    <p>= ui</p>
    <p>cij : distance between points i and j</p>
    <p>client</p>
    <p>facility 2</p>
  </div>
  <div class="page">
    <p>Want to:</p>
    <p>Goal: Minimize total cost = iA fi + jD ci(j)j</p>
    <p>= facility cost + client assignment cost</p>
    <p>facility</p>
    <p>client</p>
    <p>At most ui clients may be assigned to i.</p>
    <p>open facility3</p>
  </div>
  <div class="page">
    <p>Related Work</p>
    <p>Korupolu, Plaxton &amp; Rajaraman:  First constant-approx. algorithm.  Handle uniform capacities.</p>
    <p>Chudak &amp; Williamson:  Simplified and improved analysis.</p>
    <p>Pal, Tardos &amp; Wexler:  Constant-approximation algorithm</p>
    <p>for non-uniform capacities.</p>
    <p>Improvements by Mahdian &amp; Pal, Zhang, Chen &amp; Ye (ZCY04). Current best factor: 5.83 (ZCY04).</p>
    <p>All results based on local search.</p>
    <p>Approximation Algorithms</p>
  </div>
  <div class="page">
    <p>Strengthening LP relaxations</p>
    <p>No LP-relaxation is known for CFL with a constant integrality gap.</p>
    <p>Padberg, Van Roy &amp; Wolsey:  considered single-client CFL</p>
    <p>problem  gave extended flow cover</p>
    <p>inequalities; integrality gap = 1 for uniform capacities.</p>
    <p>Aardal:  adapted flow cover inequalities</p>
    <p>to general CFL.</p>
    <p>Carr, Fleischer, Leung &amp; Phillips:  gave covering inequalities for</p>
    <p>single-client CFL; integrality gap  2.</p>
  </div>
  <div class="page">
    <p>Our Results</p>
    <p>Give an LP-rounding algorithm for CFL.</p>
    <p>First LP-based approx. algorithm. Get an approx. ratio of 5 when all facility costs are equal (capacities can be different).</p>
    <p>Decomposition technique to divide the CFL instance into single-client CFL problems which are solved separately.</p>
    <p>Analysis is not a client-by-client analysis.</p>
    <p>Decomposition technique might be useful in analyzing sophisticated LP relaxations.</p>
  </div>
  <div class="page">
    <p>LP formulation</p>
    <p>Minimize i fiyi + j,i cijxij (CFL-P)</p>
    <p>subject toi xij  1 j</p>
    <p>xij  yi i, j</p>
    <p>j xij  uiyi i, j</p>
    <p>yi  1 i</p>
    <p>xij,yi  0 i, j</p>
    <p>yi : indicates if facility i is open.</p>
    <p>xij : indicates if client j is assigned to facility i.</p>
    <p>ui : capacity of facility i.</p>
  </div>
  <div class="page">
    <p>i,j wij + uiri  fi + zi i</p>
    <p>The Dual</p>
    <p>cij</p>
    <p>vj, wij, zi, ri  0 i, j</p>
    <p>Maximize j vj  i zi (CFL-D)</p>
    <p>subject to</p>
    <p>vj  cij + wij + ri i, j</p>
    <p>wij</p>
    <p>ri</p>
    <p>vj</p>
    <p>j</p>
    <p>Strong Duality: Primal and dual problems have same optimum value.</p>
  </div>
  <div class="page">
    <p>Single-Client CFL</p>
    <p>Also called single-node fixed-charge problem.</p>
    <p>Minimize i fi Yi + i ciXi (SN-P)</p>
    <p>subject to i Xi  D</p>
    <p>Xi  ui Yi i</p>
    <p>Yi  1 i</p>
    <p>Xi, Yi  0 i</p>
    <p>Yi : indicates if facility i is open.</p>
    <p>Xi : demand assigned to facility i.</p>
    <p>Demand = D</p>
  </div>
  <div class="page">
    <p>Can set Yi = Xi /ui, so</p>
    <p>(SN-P)  Minimize i (fi /ui+ci)Xi</p>
    <p>subject to i Xi  D</p>
    <p>Xi  ui i</p>
    <p>Xi  0 i</p>
    <p>Lemma: Assigning demand to facilities in (fi /ui + ci) order gives optimal solution to (SNP).</p>
    <p>at most one facility i such that 0 &lt; Yi &lt; 1.</p>
    <p>get integer solution of cost  OPTSN-P + maxi fi.</p>
  </div>
  <div class="page">
    <p>Algorithm Outline</p>
    <p>Partition facilities in {i : yi &gt; 0} into clusters.</p>
    <p>Each cluster is centered around a client k and denoted by Nk. Cluster Nk takes care of demand j,iNk xij.</p>
    <p>Open each facility iNk with yi = 1.</p>
    <p>Consider total demand served by facilities in Nk with yi &lt; 1 as located at center k  get a 1client CFL instance.</p>
    <p>Solve instance to decide which other facilities to open from Nk.</p>
    <p>Let (x,y) : optimal primal solution</p>
  </div>
  <div class="page">
    <p>A Sample Run 2 31 4</p>
    <p>client facility with yi &gt; 0</p>
  </div>
  <div class="page">
    <p>A Sample Run</p>
    <p>Partition facilities in {i : yi &gt; 0} into clusters.</p>
    <p>client facility with yi &gt; 0cluster center</p>
  </div>
  <div class="page">
    <p>A Sample Run 2 31 4</p>
    <p>client facility with yi &gt; 0cluster center open facility</p>
    <p>Open each facility i with yi = 1.</p>
  </div>
  <div class="page">
    <p>A Sample Run 2 31 4</p>
    <p>client facility with yi &gt; 0cluster center open facility</p>
    <p>Create 1-client CFL instances  move demand to cluster centers.</p>
  </div>
  <div class="page">
    <p>A Sample Run 2 31 4</p>
    <p>client facility with yi &gt; 0cluster center open facility</p>
    <p>Create 1-client CFL instances by moving demand to cluster centers.</p>
  </div>
  <div class="page">
    <p>A Sample Run 2 31 4</p>
    <p>Solve the 1-client CFL instances to decide which facilities to open.</p>
    <p>client facility with yi &gt; 0cluster center open facility</p>
  </div>
  <div class="page">
    <p>A Sample Run 2 31 4</p>
    <p>client facility with yi &gt; 0open facility</p>
    <p>Assign clients to open facilities.</p>
  </div>
  <div class="page">
    <p>Clustering</p>
    <p>Form clusters iteratively. Clustering ensures the following properties:</p>
    <p>Let Fj = {i: xij &gt; 0}, wt(S) = iS yi,</p>
    <p>ctr(i) = center of is cluster, i.e., iNctr(i) .</p>
    <p>j k</p>
    <p>i ctr(i)</p>
    <p>Fj</p>
    <p>ci,ctr(i)  3vj</p>
    <p>For every client j and facility iFj, ci,ctr(i)  3vj.</p>
    <p>Each cluster Nk has wt(Nk)  .</p>
    <p>iNk yi</p>
  </div>
  <div class="page">
    <p>Analysis Overview</p>
    <p>Let y' = {0,1}-solution constructed</p>
    <p>y'i = 1 iff facility i is open, 0 otherwise.</p>
    <p>Will construct x' so that (x',y') is a feasible solution to (CFL-P) and bound cost of (x',y').</p>
    <p>Use dual variables vj to bound cost: xij &gt; 0  cij  vj.</p>
    <p>Problem: Have zis in the dual.</p>
    <p>But zi &gt; 0  yi = 1. So can open these facilities and charge all of this cost to the LP; takes care of zis.</p>
  </div>
  <div class="page">
    <p>Overview (contd.)</p>
    <p>j</p>
    <p>i ctr(i)</p>
    <p>Fj</p>
    <p>If iFj, then ci,ctr(i)  3vj,</p>
    <p>wt(cluster)</p>
    <p>Rest is handled by the 1-client CFL solutions.</p>
    <p>assigning j xij units of demand to each such i.</p>
  </div>
  <div class="page">
    <p>Taking care of zis</p>
    <p>For each facility i with yi = 1</p>
    <p>Open facility i.</p>
    <p>For each j, assign xij fraction to i.</p>
    <p>Lemma: Cost incurred</p>
    <p>= i:yi=1 (fi + j cijxij)</p>
    <p>= j vj (i:yi=1 xij)  i zi.</p>
    <p>Proof: By complementary slackness.</p>
    <p>Corollary: i:yi&lt;1 (fiyi+ j cijxij) = j vj (i:yi&lt;1</p>
    <p>xij).</p>
  </div>
  <div class="page">
    <p>Cost of 1-client CFL solns.</p>
    <p>open facility with yi = 1</p>
    <p>OPTSN-P  cost of (X, Y)</p>
    <p>= iLk fiyi + iLk cik(j xij)</p>
    <p>Let Lk={iNk: yi &lt; 1}.</p>
    <p>facility in Lk</p>
    <p>(x,y) induces feasible solution to (SN-P).</p>
    <p>Set Yi = yi, Xi = j xij.</p>
    <p>k</p>
    <p>cluster Nk</p>
    <p>Cost of integer 1-client CFL solution for Nk</p>
    <p>OPTSN-P + maxiLk fi.</p>
    <p>Only place where we use the fact that the facility costs are all equal.</p>
    <p>But fi = f and wt(Nk)  , so cost</p>
    <p>iLk fiyi + iLk cik(j xij) + 2 .ik</p>
    <p>fiyi.</p>
  </div>
  <div class="page">
    <p>Cost of 1-client CFL solns.</p>
    <p>open facility with yi = 1</p>
    <p>OPTSN-P  cost of (X, Y)</p>
    <p>= iLk fiyi + iLk cik(j xij)</p>
    <p>Let Lk={iNk: yi &lt; 1}.</p>
    <p>facility in Lk</p>
    <p>(x,y) induces feasible solution to (SN-P).</p>
    <p>Set Yi = yi, Xi = j xij.</p>
    <p>k</p>
    <p>cluster Nk</p>
    <p>So total cost of all 1-client CFL solutions</p>
    <p>i:yi&lt;1 (3fiyi + j ci,ctr(i) xij) + 2 .i:yi=1</p>
    <p>fi .</p>
    <p>Cost of integer 1-client CFL solution for Nk</p>
    <p>OPTSN-P + maxiLk fi.But fi = f and wt(Nk)  , so cost</p>
    <p>iLk fiyi + iLk cik(j xij) + 2 .ik</p>
    <p>fiyi.</p>
  </div>
  <div class="page">
    <p>Moving back demands</p>
    <p>j</p>
    <p>i ctr(i)</p>
    <p>Fj</p>
    <p>Fix client j.</p>
    <p>For every facility i with yi &lt; 1, move xij demand from ctr(i) back to j.</p>
    <p>Cost incurred for j = i:yi&lt;1 cctr(i),j xij  i:yi&lt;1 (ci,ctr(i) + cij) xij</p>
    <p>Overall cost = i:yi&lt;1 j (ci,ctr(i) +</p>
    <p>cij) xij</p>
  </div>
  <div class="page">
    <p>Putting it all together</p>
    <p>Recall: for each iFj, ci,ctr(i)  3vj</p>
    <p>i:yi&lt;1 (fiyi + j cijxij) = j vj (i:yi&lt;1</p>
    <p>xij)3 components of total cost:</p>
    <p>i:yi=1 (fi + j cijxij) = j vj (i:yi=1 xij)  i</p>
    <p>zi. 2) Cost of 1-client CFL solutions</p>
    <p>i:yi&lt;1 (3fiyi + j ci,ctr(i) xij) + 2.i:yi=1</p>
    <p>fi.3) Cost of moving back demands</p>
    <p>i:yi&lt;1 j (ci,ctr(i) + cij) xij</p>
    <p>Total cost  i:yi=1 (3fi + j cijxij) +</p>
    <p>i:yi&lt;1 (3fiyi + j cijxij) + j 6vj (i:yi&lt;1</p>
    <p>xij)  9(j vj  i zi )  9.OPT.</p>
  </div>
  <div class="page">
    <p>Theorem: Get a 9approximation algorithm for equal facility costs. Improvement</p>
    <p>Clustering ensures that for every client j, an xij-weight of   is in facilities i such that ci,ctr(i)  vj.</p>
    <p>j</p>
    <p>Fj</p>
    <p>S iS xij</p>
    <p>For each iS, ci,ctr(i)  vj</p>
    <p>Can do a tighter analysis to show that algorithm is a 5-approx. algorithm.</p>
  </div>
  <div class="page">
    <p>Open Questions</p>
    <p>LP relaxation with a constant integrality gap?</p>
    <p>Strong formulations known for the 1-client CFL problem.</p>
    <p>extended flow cover inequalities of Padberg, Van Roy &amp; Wolsey</p>
    <p>covering inequalities of Carr, Fleischer, Leung &amp; Phillips</p>
    <p>Can we use these to get a strong LP relaxation for CFL?</p>
  </div>
  <div class="page">
    <p>Thank You.</p>
  </div>
</Presentation>
