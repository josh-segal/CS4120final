<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Troubleshooting Chronic Troubleshooting Chronic Conditions in Large IP NetworksConditions in Large IP Networks</p>
    <p>Ajay MahimkarAjay Mahimkar, Jennifer Yates, Yin Zhang,, Jennifer Yates, Yin Zhang, Aman Shaikh, Jia Wang, Zihui Ge, Cheng Tien EeAman Shaikh, Jia Wang, Zihui Ge, Cheng Tien Ee</p>
    <p>UTUT--Austin and AT&amp;T LabsAustin and AT&amp;T Labs--ResearchResearch mahimkar@cs.utexas.edumahimkar@cs.utexas.edu</p>
    <p>ACM CoNEXT 2008ACM CoNEXT 2008</p>
  </div>
  <div class="page">
    <p>Network ReliabilityNetwork Reliability  Applications demand high reliability and performance</p>
    <p>VoIP, IPTV, Gaming,   Best-effort service is no longer acceptable</p>
    <p>Accurate and timely troubleshooting of network outages required  Outages can occur due to mis-configurations, software bugs,</p>
    <p>malicious attacks  Can cause significant performance impact  Can incur huge losses</p>
  </div>
  <div class="page">
    <p>Hard FailuresHard Failures  Traditionally, troubleshooting focused on hard failures</p>
    <p>E.g., fiber cuts, line card failures, router failures  Relatively easy to detect  Quickly fix the problem and get resource up and running</p>
    <p>Lots of other network events flying under the radar, and potentially impacting performance</p>
    <p>Link failure</p>
  </div>
  <div class="page">
    <p>Chronic ConditionsChronic Conditions  Individual events disappear before an operator can</p>
    <p>react to them  Keep re-occurring  Can cause significant performance degradation</p>
    <p>Can turn into hard failure  Examples</p>
    <p>Chronic link flaps  Chronic router CPU utilization anomalies</p>
    <p>Router Router CPU Spikes</p>
    <p>Chronic link flaps</p>
  </div>
  <div class="page">
    <p>Troubleshooting Chronic Troubleshooting Chronic ConditionsConditions</p>
    <p>Detect and troubleshoot before customer complains</p>
    <p>State of art  Manual troubleshooting</p>
    <p>Network-wide Information Correlation and Exploration (NICE)  First infrastructure for automated, scalable and flexible</p>
    <p>troubleshooting of chronic conditions  Becoming a powerful tool inside AT&amp;T</p>
    <p>Used to troubleshoot production network issues  Discovered anomalous chronic network conditions</p>
  </div>
  <div class="page">
    <p>OutlineOutline  Troubleshooting Challenges Troubleshooting Challenges</p>
    <p>NICE Approach NICE Approach</p>
    <p>NICE Validation NICE Validation</p>
    <p>Deployment Experience Deployment Experience</p>
    <p>ConclusionConclusion</p>
  </div>
  <div class="page">
    <p>Troubleshooting Chronic Troubleshooting Chronic Conditions is hardConditions is hard</p>
    <p>Routing reports</p>
    <p>Syslogs</p>
    <p>Layer-1Performance reports</p>
    <p>Workflow Traffic</p>
    <p>Effectively mining measurement data forEffectively mining measurement data for troubleshooting is the contribution of this papertroubleshooting is the contribution of this paper</p>
  </div>
  <div class="page">
    <p>Troubleshooting ChallengesTroubleshooting Challenges  Massive Scale</p>
    <p>Potential root-causes hidden in thousands of event-series  E.g., root-causes for packet loss include link congestion</p>
    <p>(SNMP), protocol down (Route data), software errors (syslogs)</p>
    <p>Complex spatial and topology models  Cross-layer dependency  Causal impact scope</p>
    <p>Local versus global (propagation through protocols)</p>
    <p>Imperfect timing information  Propagation (events take time to show impact  timers)  Measurement granularity (point versus range events)</p>
  </div>
  <div class="page">
    <p>NICENICE  Statistical correlation analysis across multiple data</p>
    <p>Chronic condition manifests in many measurements</p>
    <p>Blind mining leads to information snow of results  NICE starts with symptom and identifies correlated events</p>
    <p>Chronic Symptom</p>
    <p>Spatial Proximity</p>
    <p>model</p>
    <p>Unified Data</p>
    <p>Model</p>
    <p>Statistical Correlation</p>
    <p>Other Network Events</p>
    <p>Statistically Correlated Events</p>
    <p>NICE</p>
  </div>
  <div class="page">
    <p>Spatial Proximity ModelSpatial Proximity Model  Select events in close proximity</p>
    <p>Hierarchical structure  Capture event location</p>
    <p>Proximity distance  Capture impact scope of event</p>
    <p>Examples  Path packet loss - events on routers</p>
    <p>and links on same path  Router CPU anomalies - events on</p>
    <p>same router and interfaces</p>
    <p>OSPF area</p>
    <p>Router</p>
    <p>Path</p>
    <p>Logical link</p>
    <p>Physical link</p>
    <p>Layer-1 device Interface</p>
    <p>Network operators find it flexible and convenient to express the impact scope of network events</p>
    <p>Hierarchical Structure</p>
    <p>Path</p>
    <p>Physical link</p>
    <p>Layer-1 device Interface</p>
    <p>Logical link Router</p>
    <p>Path</p>
    <p>Router Logical link</p>
    <p>Physical link</p>
    <p>Layer-1 device Interface</p>
  </div>
  <div class="page">
    <p>Unified Data ModelUnified Data Model  Facilitate easy cross-event correlations  Padding time-margins to handle diverse data</p>
    <p>Convert any event-series to range series  Common time-bin to simplify correlations</p>
    <p>Convert range-series to binary time-series</p>
    <p>Range Event Series A</p>
    <p>Point Event Series B</p>
    <p>Padding margin</p>
    <p>Overlapping range</p>
    <p>Convert to binary</p>
    <p>Merge Overlapping range</p>
    <p>Auto-correlation</p>
  </div>
  <div class="page">
    <p>Statistical Correlation TestingStatistical Correlation Testing  Co-occurrence is not sufficient</p>
    <p>Measure statistical time co-occurrence  Pair-wise Pearsons correlation coefficient</p>
    <p>Unfortunately, cannot apply the classic significance test  Due to auto-correlation</p>
    <p>Samples within an event-series are not independent  Over-estimates the correlation confidence: high false alarms</p>
    <p>We propose a novel circular permutation test  Key Idea: Keep one series fixed and shift another</p>
    <p>Preserve auto-correlation  Establishes baseline for null hypothesis that two series are</p>
    <p>independent</p>
  </div>
  <div class="page">
    <p>NICE ValidationNICE Validation  Goal: Test if NICE correlation output matches</p>
    <p>networking domain knowledge  Validation using 6 months of data from AT&amp;T backbone</p>
    <p>Missed Correlations</p>
    <p>Unexpected Correlations</p>
    <p>Matched outputs</p>
    <p>Expected to correlate</p>
    <p>Expected not to</p>
    <p>correlate</p>
    <p>Pairs for correlation</p>
    <p>testing</p>
    <p>NICE Correlation ResultsResults Expected by Network operators</p>
    <p>For 97% pairs, NICE correlation output agreed with domain knowledge  For remaining 3% mismatch, their causes fell into three categories</p>
    <p>Imperfect domain knowledge  Measurement data artifacts  Anomalous network behavior</p>
    <p>Expected to not correlate,</p>
    <p>NICE marked correlated</p>
    <p>Expected to correlate,</p>
    <p>NICE marked uncorrelated</p>
  </div>
  <div class="page">
    <p>Anomalous Network BehaviorAnomalous Network Behavior  Example  Cross-layer Failure interactions</p>
    <p>Modern ISPs use failure recovery at layer-1 to rapidly recover from faults without inducing re-convergence at layer-3</p>
    <p>i.e., if layer-1 has protection mechanism invoked successfully, then layer-3 should not see a link failure</p>
    <p>Expectation: Layer-3 link down events should not correlate with layer-1 automated failure recovery  Spatial proximity model: SAME LINK</p>
    <p>Result: NICE identified strong statistical correlation  Router feature bugs identified as root cause  Problem has been mitigated</p>
  </div>
  <div class="page">
    <p>Troubleshooting Case StudiesTroubleshooting Case Studies AT&amp;T Backbone Network</p>
    <p>Uplink packet loss on an access router</p>
    <p>Packet loss observed by active measurement between a router pair</p>
    <p>CPU anomalies on routers</p>
    <p>Data Source Number of Event types</p>
    <p>Layer-1 Alarms 130 SNMP 4 Router Syslogs 937 Command Logs 839 OSPF Events 25</p>
    <p>Total 1935</p>
    <p>All three case studies uncover interesting correlations with new insights</p>
  </div>
  <div class="page">
    <p>Chronic Uplink Packet lossChronic Uplink Packet loss</p>
    <p>Problem: Identify strongly correlated event-series with chronic packet drops on router uplinks  Significantly impacting customers</p>
    <p>NICE Input: Customer interface packet drops (SNMP) and router syslogs</p>
    <p>Customer interfaces</p>
    <p>Which customer interface events</p>
    <p>correlate?</p>
    <p>ISP Network Uplinks to backbone</p>
    <p>Packet drops</p>
    <p>Access Router</p>
    <p>..</p>
  </div>
  <div class="page">
    <p>Chronic Uplink Packet lossChronic Uplink Packet loss</p>
    <p>High co-occurrence, but no statistical</p>
    <p>correlation</p>
    <p>NICE identifies strong statistical</p>
    <p>correlation</p>
  </div>
  <div class="page">
    <p>Chronic Uplink Packet lossChronic Uplink Packet loss  NICE Findings: Strong Correlations with</p>
    <p>Packet drops on four customer-facing interfaces (out of 150+ with packet drops)</p>
    <p>All four interfaces from SAME CUSTOMER</p>
    <p>Short-term traffic bursts appear to cause internal router limits to be reached</p>
    <p>Impacts traffic flowing out of router  Impacting other customers</p>
    <p>Mitigation Action: Re-home customer interface to another access router</p>
  </div>
  <div class="page">
    <p>ConclusionsConclusions  Important to detect and troubleshoot chronic network</p>
    <p>conditions before customer complains</p>
    <p>NICE  First scalable, automated and flexible infrastructure for troubleshooting chronic network conditions  Statistical correlation testing  Incorporates topology and routing model</p>
    <p>Operational experience is very positive  Becoming a powerful tool inside AT&amp;T</p>
    <p>Future Work  Network behavior change monitoring using correlations  Multi-way correlations</p>
  </div>
  <div class="page">
    <p>Thank You !</p>
  </div>
  <div class="page">
    <p>Backup Slides</p>
  </div>
  <div class="page">
    <p>Router CPU Utilization Router CPU Utilization AnomaliesAnomalies</p>
    <p>Problem: Identify strongly correlated event-series with chronic CPU anomalies as input symptom</p>
    <p>NICE Input: Router syslogs, routing events, command logs and layer-1 alarms</p>
    <p>NICE Findings: Strong Correlations with  Control-plane activities  Commands such as viewing routing protocol states  Customer-provisioning</p>
    <p>SNMP polling  Mitigation Action: Operators are working with router polling</p>
    <p>systems to refine their polling mechanisms</p>
    <p>Consistent with earlier operations findings</p>
    <p>New</p>
  </div>
  <div class="page">
    <p>AutoAuto--correlationcorrelation</p>
    <p>About 30% of event-series have significant auto-correlation at lag 100 or higher</p>
  </div>
  <div class="page">
    <p>Circular Permutation TestCircular Permutation Test Auto-correlation</p>
    <p>Series A</p>
    <p>Series B</p>
    <p>Permutation provides correlation baseline to test hypothesis of independence</p>
  </div>
  <div class="page">
    <p>Imperfect Domain KnowledgeImperfect Domain Knowledge  Example  one of router commands used to view</p>
    <p>routing state is considered highly CPU intensive</p>
    <p>We did not find significant correlation between the command and CPU value as low as 50%  Correlation became significant only with CPU above 40%  Conclusion: The command does cause CPU spikes, but not as</p>
    <p>high as we had expected  Domain knowledge updated !</p>
  </div>
</Presentation>
