<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Opaque</p>
    <p>Wenting Zheng, Ankur Dave, Jethro G. Beekman, Raluca Ada Popa, Joseph E. Gonzalez, Ion Stoica</p>
    <p>UC Berkeley</p>
    <p>An Oblivious and Encrypted Distributed Analytics Platform</p>
  </div>
  <div class="page">
    <p>Complex analytics run on sensitive data</p>
    <p>client cloud provider</p>
    <p>sensitive data</p>
  </div>
  <div class="page">
    <p>Complex analytics run on sensitive data</p>
    <p>client</p>
    <p>Spark SQL MLLib GraphX</p>
    <p>Spark Streaming</p>
    <p>cloud provider</p>
    <p>sensitive data</p>
  </div>
  <div class="page">
    <p>Complex analytics run on sensitive data</p>
    <p>client</p>
    <p>Spark SQL MLLib GraphX</p>
    <p>Spark Streaming</p>
    <p>cloud provider</p>
    <p>sensitive data</p>
  </div>
  <div class="page">
    <p>Cloud attackers</p>
    <p>client cloud provider</p>
    <p>sensitive data</p>
  </div>
  <div class="page">
    <p>Cloud attackers</p>
    <p>client cloud provider</p>
    <p>sensitive data</p>
  </div>
  <div class="page">
    <p>Cloud attackers</p>
    <p>client cloud provider</p>
    <p>sensitive data</p>
  </div>
  <div class="page">
    <p>Cloud attackers</p>
    <p>client cloud provider</p>
    <p>sensitive data</p>
  </div>
  <div class="page">
    <p>Cloud attackers</p>
    <p>client cloud provider</p>
    <p>sensitive data</p>
  </div>
  <div class="page">
    <p>Cloud attackers</p>
    <p>client cloud provider</p>
    <p>sensitive data</p>
  </div>
  <div class="page">
    <p>Cloud attackers</p>
    <p>client cloud provider</p>
    <p>sensitive data</p>
  </div>
  <div class="page">
    <p>Cloud attackers</p>
    <p>client cloud provider</p>
    <p>sensitive data</p>
  </div>
  <div class="page">
    <p>How to protect data while preserving functionality?</p>
  </div>
  <div class="page">
    <p>Cryptographic approach?</p>
  </div>
  <div class="page">
    <p>Cryptographic approach?  Fully homomorphic encryption [Gentry 09]</p>
  </div>
  <div class="page">
    <p>Cryptographic approach?  Fully homomorphic encryption [Gentry 09]</p>
    <p>fully functional</p>
  </div>
  <div class="page">
    <p>Cryptographic approach?  Fully homomorphic encryption [Gentry 09]</p>
    <p>fully functional  too slow</p>
  </div>
  <div class="page">
    <p>Cryptographic approach?  Fully homomorphic encryption [Gentry 09]</p>
    <p>fully functional  too slow</p>
    <p>CryptDB [PRZB 11]</p>
  </div>
  <div class="page">
    <p>Cryptographic approach?  Fully homomorphic encryption [Gentry 09]</p>
    <p>fully functional  too slow</p>
    <p>CryptDB [PRZB 11]  more practical performance</p>
  </div>
  <div class="page">
    <p>Cryptographic approach?  Fully homomorphic encryption [Gentry 09]</p>
    <p>fully functional  too slow</p>
    <p>CryptDB [PRZB 11]  more practical performance  limited functionality</p>
  </div>
  <div class="page">
    <p>Cryptographic approach?  Fully homomorphic encryption [Gentry 09]</p>
    <p>fully functional  too slow</p>
    <p>CryptDB [PRZB 11]  more practical performance  limited functionality</p>
    <p>Alternative: hardware enclaves</p>
  </div>
  <div class="page">
    <p>Hardware enclaves (e.g., Intel SGX, AMD memory encryption)</p>
  </div>
  <div class="page">
    <p>Hardware enclaves (e.g., Intel SGX, AMD memory encryption)</p>
    <p>Hardware-enforced secure execution environment</p>
  </div>
  <div class="page">
    <p>Enclave</p>
    <p>Hardware enclaves (e.g., Intel SGX, AMD memory encryption)</p>
    <p>Hardware-enforced secure execution environment</p>
    <p>Untrusted OS</p>
    <p>Code</p>
  </div>
  <div class="page">
    <p>Enclave</p>
    <p>Hardware enclaves (e.g., Intel SGX, AMD memory encryption)</p>
    <p>Hardware-enforced secure execution environment</p>
    <p>Encrypted enclave memory (accessible only from the enclave)</p>
    <p>Untrusted OS</p>
    <p>Code</p>
  </div>
  <div class="page">
    <p>Enclave</p>
    <p>Hardware enclaves (e.g., Intel SGX, AMD memory encryption)</p>
    <p>Hardware-enforced secure execution environment</p>
    <p>Encrypted enclave memory (accessible only from the enclave)</p>
    <p>Untrusted OS</p>
    <p>Secret dataCode</p>
  </div>
  <div class="page">
    <p>Enclave</p>
    <p>Hardware enclaves (e.g., Intel SGX, AMD memory encryption)</p>
    <p>Hardware-enforced secure execution environment</p>
    <p>Encrypted enclave memory (accessible only from the enclave)</p>
    <p>Protect against an attacker who has root access</p>
    <p>Untrusted OS</p>
    <p>Secret dataCode</p>
  </div>
  <div class="page">
    <p>Enclave-based systems</p>
  </div>
  <div class="page">
    <p>Enclave-based systems  Prior work: Haven [BMG 14], VC3 [SCFGPMR 15]:</p>
  </div>
  <div class="page">
    <p>Enclave-based systems  Prior work: Haven [BMG 14], VC3 [SCFGPMR 15]:</p>
    <p>full functionality</p>
  </div>
  <div class="page">
    <p>Enclave-based systems  Prior work: Haven [BMG 14], VC3 [SCFGPMR 15]:</p>
    <p>full functionality  great performance</p>
  </div>
  <div class="page">
    <p>Enclave-based systems  Prior work: Haven [BMG 14], VC3 [SCFGPMR 15]:</p>
    <p>full functionality  great performance  data access pattern leakage [XCP 15, OCFGKS 15]</p>
  </div>
  <div class="page">
    <p>Problem: access pattern leakage [XCP 15, OCFGKS 15]</p>
  </div>
  <div class="page">
    <p>Problem: access pattern leakage [XCP 15, OCFGKS 15]</p>
    <p>ID Name Age Disease</p>
  </div>
  <div class="page">
    <p>Problem: access pattern leakage [XCP 15, OCFGKS 15]</p>
    <p>ID Name Age Disease</p>
    <p>SELECT count(*) FROM medical GROUP BY disease</p>
  </div>
  <div class="page">
    <p>Problem: access pattern leakage [XCP 15, OCFGKS 15]</p>
  </div>
  <div class="page">
    <p>Problem: access pattern leakage [XCP 15, OCFGKS 15]</p>
  </div>
  <div class="page">
    <p>Problem: access pattern leakage [XCP 15, OCFGKS 15]</p>
  </div>
  <div class="page">
    <p>Problem: access pattern leakage [XCP 15, OCFGKS 15]</p>
  </div>
  <div class="page">
    <p>Problem: access pattern leakage [XCP 15, OCFGKS 15]</p>
  </div>
  <div class="page">
    <p>Problem: access pattern leakage [XCP 15, OCFGKS 15]</p>
  </div>
  <div class="page">
    <p>Problem: access pattern leakage [XCP 15, OCFGKS 15]</p>
    <p>Public information: Diabetes twice as common as cancer</p>
  </div>
  <div class="page">
    <p>Problem: access pattern leakage [XCP 15, OCFGKS 15]</p>
    <p>Public information: Diabetes twice as common as cancer</p>
  </div>
  <div class="page">
    <p>Problem: access pattern leakage [XCP 15, OCFGKS 15]</p>
    <p>Public information: Diabetes twice as common as cancer</p>
  </div>
  <div class="page">
    <p>Problem: access pattern leakage [XCP 15, OCFGKS 15]</p>
    <p>Public information: Diabetes twice as common as cancer</p>
  </div>
  <div class="page">
    <p>Problem: access pattern leakage [XCP 15, OCFGKS 15]</p>
  </div>
  <div class="page">
    <p>Problem: access pattern leakage [XCP 15, OCFGKS 15]</p>
  </div>
  <div class="page">
    <p>Problem: access pattern leakage [XCP 15, OCFGKS 15]</p>
  </div>
  <div class="page">
    <p>Problem: access pattern leakage [XCP 15, OCFGKS 15]</p>
  </div>
  <div class="page">
    <p>Problem: access pattern leakage [XCP 15, OCFGKS 15]</p>
    <p>??? Diabetes</p>
    <p>??? Diabetes</p>
    <p>??? Cancer</p>
    <p>??? Diabetes</p>
    <p>??? Cancer</p>
    <p>??? Diabetes</p>
  </div>
  <div class="page">
    <p>Problem: access pattern leakage [XCP 15, OCFGKS 15]</p>
    <p>??? Diabetes</p>
    <p>??? Diabetes</p>
    <p>??? Cancer</p>
    <p>??? Diabetes</p>
    <p>??? Cancer</p>
    <p>??? Diabetes</p>
    <p>??? Cancer</p>
  </div>
  <div class="page">
    <p>Problem: access pattern leakage [XCP 15, OCFGKS 15]</p>
  </div>
  <div class="page">
    <p>Problem: access pattern leakage [XCP 15, OCFGKS 15]</p>
  </div>
  <div class="page">
    <p>Problem: access pattern leakage [XCP 15, OCFGKS 15]</p>
    <p>Attack viable by observing both memory and network accesses!</p>
  </div>
  <div class="page">
    <p>Opaque*: secure distributed analytics</p>
    <p>* Oblivious Platform for Analytic QUEries</p>
    <p>Spark SQL Opaque</p>
    <p>SQL ML Graph Analytics</p>
  </div>
  <div class="page">
    <p>Security guarantees</p>
  </div>
  <div class="page">
    <p>Security guarantees  Data encryption and authentication</p>
  </div>
  <div class="page">
    <p>Security guarantees  Data encryption and authentication  Computation integrity: a check enforcing that the</p>
    <p>computation is executed correctly</p>
  </div>
  <div class="page">
    <p>Security guarantees  Data encryption and authentication  Computation integrity: a check enforcing that the</p>
    <p>computation is executed correctly  see paper for more!</p>
  </div>
  <div class="page">
    <p>Security guarantees  Data encryption and authentication  Computation integrity: a check enforcing that the</p>
    <p>computation is executed correctly  see paper for more!</p>
    <p>Obliviousness = hiding access patterns</p>
  </div>
  <div class="page">
    <p>Security guarantees  Data encryption and authentication  Computation integrity: a check enforcing that the</p>
    <p>computation is executed correctly  see paper for more!</p>
    <p>Obliviousness = hiding access patterns  Informal statement</p>
  </div>
  <div class="page">
    <p>Security guarantees  Data encryption and authentication  Computation integrity: a check enforcing that the</p>
    <p>computation is executed correctly  see paper for more!</p>
    <p>Obliviousness = hiding access patterns  Informal statement</p>
    <p>The memory and network accesses of the computation is the same for any input of the same size</p>
  </div>
  <div class="page"/>
  <div class="page">
    <p>Challenge: obliviousness is expensive</p>
  </div>
  <div class="page">
    <p>Challenge: obliviousness is expensive</p>
    <p>Two-part solution:</p>
  </div>
  <div class="page">
    <p>Challenge: obliviousness is expensive</p>
    <p>Two-part solution:</p>
    <p>Distributed oblivious SQL operators</p>
  </div>
  <div class="page">
    <p>Challenge: obliviousness is expensive</p>
    <p>Novel query planning techniques</p>
    <p>Two-part solution:</p>
    <p>Distributed oblivious SQL operators</p>
  </div>
  <div class="page">
    <p>Novel query planning techniques</p>
    <p>Two-part solution:</p>
    <p>Distributed oblivious SQL operators</p>
  </div>
  <div class="page">
    <p>Novel query planning techniques</p>
    <p>Two-part solution:</p>
    <p>Distributed oblivious SQL operators</p>
    <p>Oblivious filter</p>
  </div>
  <div class="page">
    <p>Novel query planning techniques</p>
    <p>Two-part solution:</p>
    <p>Distributed oblivious SQL operators</p>
    <p>Oblivious filter</p>
    <p>Oblivious sort</p>
  </div>
  <div class="page">
    <p>Novel query planning techniques</p>
    <p>Two-part solution:</p>
    <p>Distributed oblivious SQL operators</p>
    <p>Oblivious filter</p>
    <p>Oblivious sort</p>
    <p>Oblivious aggregation</p>
  </div>
  <div class="page">
    <p>Novel query planning techniques</p>
    <p>Two-part solution:</p>
    <p>Distributed oblivious SQL operators</p>
    <p>Oblivious filter</p>
    <p>Oblivious sort</p>
    <p>Oblivious aggregation</p>
    <p>Oblivious join</p>
  </div>
  <div class="page">
    <p>Novel query planning techniques</p>
    <p>Two-part solution:</p>
    <p>Distributed oblivious SQL operators</p>
    <p>Oblivious filter</p>
    <p>Oblivious sort</p>
    <p>Oblivious aggregation</p>
    <p>Oblivious join</p>
    <p>Rule-based optimization</p>
  </div>
  <div class="page">
    <p>Novel query planning techniques</p>
    <p>Two-part solution:</p>
    <p>Distributed oblivious SQL operators</p>
    <p>Oblivious filter</p>
    <p>Oblivious sort</p>
    <p>Oblivious aggregation</p>
    <p>Oblivious join</p>
    <p>Cost model</p>
    <p>Rule-based optimization</p>
  </div>
  <div class="page">
    <p>Novel query planning techniques</p>
    <p>Two-part solution:</p>
    <p>Distributed oblivious SQL operators</p>
    <p>Oblivious filter</p>
    <p>Oblivious sort</p>
    <p>Oblivious aggregation</p>
    <p>Oblivious join</p>
    <p>Cost model</p>
    <p>Rule-based optimization</p>
    <p>Cost-based optimization</p>
  </div>
  <div class="page">
    <p>Novel query planning techniques</p>
    <p>Two-part solution:</p>
    <p>Distributed oblivious SQL operators</p>
    <p>Oblivious filter</p>
    <p>Oblivious sort</p>
    <p>Oblivious aggregation</p>
    <p>Oblivious join</p>
    <p>Cost model</p>
    <p>Rule-based optimization</p>
    <p>Cost-based optimization</p>
  </div>
  <div class="page">
    <p>Oblivious aggregation</p>
    <p>SELECT count(*) FROM medical GROUP BY disease</p>
  </div>
  <div class="page">
    <p>Oblivious aggregation</p>
    <p>SELECT count(*) FROM medical GROUP BY disease</p>
  </div>
  <div class="page">
    <p>Oblivious aggregation</p>
    <p>SELECT count(*) FROM medical GROUP BY disease</p>
  </div>
  <div class="page">
    <p>Oblivious aggregation</p>
    <p>Oblivious sort</p>
    <p>[CLRS, Leighton 85]</p>
    <p>Map Sort</p>
    <p>SELECT count(*) FROM medical GROUP BY disease</p>
  </div>
  <div class="page">
    <p>Oblivious aggregation</p>
    <p>Oblivious sort</p>
    <p>[CLRS, Leighton 85]</p>
    <p>Map Sort</p>
    <p>SELECT count(*) FROM medical GROUP BY disease</p>
  </div>
  <div class="page">
    <p>Oblivious aggregation</p>
    <p>Oblivious sort</p>
    <p>[CLRS, Leighton 85]</p>
    <p>Map Sort</p>
    <p>SELECT count(*) FROM medical GROUP BY disease</p>
  </div>
  <div class="page">
    <p>Oblivious aggregation</p>
    <p>Oblivious sort</p>
    <p>[CLRS, Leighton 85]</p>
    <p>Map Sort</p>
    <p>SELECT count(*) FROM medical GROUP BY disease</p>
    <p>????</p>
  </div>
  <div class="page">
    <p>Map Sort</p>
    <p>Oblivious sort</p>
    <p>[CLRS, Leighton 85]</p>
    <p>Oblivious aggregation SELECT count(*) FROM medical GROUP BY disease</p>
  </div>
  <div class="page">
    <p>Oblivious sort</p>
    <p>[CLRS, Leighton 85]</p>
    <p>Oblivious aggregation SELECT count(*) FROM medical GROUP BY disease</p>
  </div>
  <div class="page">
    <p>Oblivious aggregation SELECT count(*) FROM medical GROUP BY disease</p>
  </div>
  <div class="page">
    <p>Oblivious aggregation SELECT count(*) FROM medical GROUP BY disease</p>
    <p>The Diabetes group is split!</p>
  </div>
  <div class="page">
    <p>Oblivious aggregation SELECT count(*) FROM medical GROUP BY disease</p>
  </div>
  <div class="page">
    <p>Oblivious aggregation SELECT count(*) FROM medical GROUP BY disease</p>
    <p>How to aggregate obliviously and in parallel?</p>
  </div>
  <div class="page">
    <p>Oblivious aggregation SELECT count(*) FROM medical GROUP BY disease</p>
  </div>
  <div class="page">
    <p>Scan</p>
    <p>Oblivious aggregation SELECT count(*) FROM medical GROUP BY disease</p>
  </div>
  <div class="page">
    <p>Scan</p>
    <p>Statistics</p>
    <p>Statistics</p>
    <p>Oblivious aggregation SELECT count(*) FROM medical GROUP BY disease</p>
  </div>
  <div class="page">
    <p>Scan Boundary processing</p>
    <p>Statistics</p>
    <p>Statistics</p>
    <p>Oblivious aggregation SELECT count(*) FROM medical GROUP BY disease</p>
  </div>
  <div class="page">
    <p>Scan Boundary processing</p>
    <p>Statistics</p>
    <p>Statistics</p>
    <p>Oblivious aggregation SELECT count(*) FROM medical GROUP BY disease</p>
  </div>
  <div class="page">
    <p>Diabetes:3</p>
    <p>Scan Boundary processing</p>
    <p>Oblivious aggregation</p>
    <p>Diabetes:1</p>
    <p>SELECT count(*) FROM medical GROUP BY disease</p>
  </div>
  <div class="page">
    <p>Diabetes:3</p>
    <p>Scan Boundary processing</p>
    <p>Partial agg.</p>
    <p>Oblivious aggregation</p>
    <p>Diabetes:1</p>
    <p>SELECT count(*) FROM medical GROUP BY disease</p>
  </div>
  <div class="page">
    <p>Diabetes:3</p>
    <p>Scan Boundary processing</p>
    <p>Oblivious aggregation</p>
    <p>Diabetes:1</p>
    <p>SELECT count(*) FROM medical GROUP BY disease</p>
  </div>
  <div class="page">
    <p>Scan Boundary processing</p>
    <p>Oblivious aggregation</p>
    <p>Diabetes:1</p>
    <p>SELECT count(*) FROM medical GROUP BY disease</p>
  </div>
  <div class="page">
    <p>Scan Boundary processing</p>
    <p>Oblivious aggregation</p>
    <p>DUMMY</p>
    <p>Diabetes:1</p>
    <p>SELECT count(*) FROM medical GROUP BY disease</p>
  </div>
  <div class="page">
    <p>Scan Boundary processing</p>
    <p>Oblivious aggregation</p>
    <p>DUMMY</p>
    <p>Diabetes:1</p>
    <p>SELECT count(*) FROM medical GROUP BY disease</p>
  </div>
  <div class="page">
    <p>Scan Boundary processing</p>
    <p>Oblivious aggregation</p>
    <p>DUMMY</p>
    <p>Diabetes:1</p>
    <p>SELECT count(*) FROM medical GROUP BY disease</p>
  </div>
  <div class="page">
    <p>Scan Boundary processing</p>
    <p>Scan</p>
    <p>Oblivious aggregation</p>
    <p>DUMMY</p>
    <p>Diabetes:1</p>
    <p>SELECT count(*) FROM medical GROUP BY disease</p>
  </div>
  <div class="page">
    <p>Scan Boundary processing</p>
    <p>Scan</p>
    <p>Oblivious aggregation</p>
    <p>DUMMY</p>
    <p>Diabetes:1</p>
    <p>SELECT count(*) FROM medical GROUP BY disease</p>
  </div>
  <div class="page">
    <p>Scan Boundary processing</p>
    <p>Scan</p>
    <p>Oblivious aggregation</p>
    <p>DUMMY</p>
    <p>Diabetes:1</p>
    <p>DUMMY</p>
    <p>Cancer: 2</p>
    <p>DUMMY</p>
    <p>SELECT count(*) FROM medical GROUP BY disease</p>
  </div>
  <div class="page">
    <p>Scan Boundary processing</p>
    <p>Scan</p>
    <p>Oblivious aggregation</p>
    <p>DUMMY</p>
    <p>Diabetes:1</p>
    <p>DUMMY</p>
    <p>Cancer: 2</p>
    <p>DUMMY</p>
    <p>DUMMY</p>
    <p>DUMMY</p>
    <p>Diabetes:4</p>
    <p>SELECT count(*) FROM medical GROUP BY disease</p>
  </div>
  <div class="page">
    <p>Oblivious aggregation</p>
    <p>Scan Boundary processing</p>
    <p>Scan</p>
    <p>DUMMY</p>
    <p>Cancer: 2</p>
    <p>DUMMY</p>
    <p>DUMMY</p>
    <p>DUMMY</p>
    <p>Diabetes:4</p>
    <p>Diabetes:1</p>
    <p>DummyDUMMY</p>
    <p>Diabetes:1</p>
    <p>SELECT count(*) FROM medical GROUP BY disease</p>
  </div>
  <div class="page">
    <p>Oblivious aggregation</p>
    <p>Diabetes</p>
    <p>Diabetes</p>
    <p>Cancer</p>
    <p>Diabetes</p>
    <p>Cancer</p>
    <p>Diabetes</p>
    <p>DUMMY</p>
    <p>Cancer: 2</p>
    <p>DUMMY</p>
    <p>DUMMY</p>
    <p>DUMMY</p>
    <p>Diabetes:4</p>
    <p>SELECT count(*) FROM medical GROUP BY disease</p>
  </div>
  <div class="page">
    <p>Oblivious aggregation</p>
    <p>DUMMY</p>
    <p>Cancer: 2</p>
    <p>DUMMY</p>
    <p>DUMMY</p>
    <p>DUMMY</p>
    <p>Diabetes:4</p>
    <p>SELECT count(*) FROM medical GROUP BY disease</p>
  </div>
  <div class="page">
    <p>Oblivious aggregation</p>
    <p>DUMMY</p>
    <p>Cancer: 2</p>
    <p>DUMMY</p>
    <p>DUMMY</p>
    <p>DUMMY</p>
    <p>Diabetes:4</p>
    <p>Sort</p>
    <p>Oblivious sort</p>
    <p>[CLRS, Leighton 85]</p>
    <p>SELECT count(*) FROM medical GROUP BY disease</p>
  </div>
  <div class="page">
    <p>Oblivious aggregation</p>
    <p>DUMMY</p>
    <p>Cancer: 2</p>
    <p>DUMMY</p>
    <p>DUMMY</p>
    <p>DUMMY</p>
    <p>Diabetes:4</p>
    <p>Sort</p>
    <p>Oblivious sort</p>
    <p>[CLRS, Leighton 85]</p>
    <p>SELECT count(*) FROM medical GROUP BY disease</p>
  </div>
  <div class="page">
    <p>Oblivious aggregation</p>
    <p>Cancer: 2</p>
    <p>Diabetes:4</p>
    <p>Sort</p>
    <p>Oblivious sort</p>
    <p>[CLRS, Leighton 85]</p>
    <p>SELECT count(*) FROM medical GROUP BY disease</p>
  </div>
  <div class="page">
    <p>Oblivious aggregation</p>
    <p>Cancer: 2</p>
    <p>Diabetes:4</p>
    <p>Sort</p>
    <p>Oblivious sort</p>
    <p>[CLRS, Leighton 85]</p>
    <p>Final result</p>
    <p>SELECT count(*) FROM medical GROUP BY disease</p>
  </div>
  <div class="page">
    <p>Oblivious aggregation</p>
    <p>Cancer: 2</p>
    <p>Diabetes:4</p>
    <p>Sort</p>
    <p>Oblivious sort</p>
    <p>[CLRS, Leighton 85]</p>
    <p>Final result</p>
    <p>SELECT count(*) FROM medical GROUP BY disease</p>
    <p>Aggregation has two sorts</p>
  </div>
  <div class="page">
    <p>Oblivious aggregation</p>
    <p>Cancer: 2</p>
    <p>Diabetes:4</p>
    <p>Sort</p>
    <p>Oblivious sort</p>
    <p>[CLRS, Leighton 85]</p>
    <p>Final result</p>
    <p>SELECT count(*) FROM medical GROUP BY disease</p>
    <p>Aggregation has two sorts</p>
    <p>Can we do better?</p>
  </div>
  <div class="page">
    <p>Novel query planning techniques</p>
    <p>Two-part solution:</p>
    <p>Distributed oblivious SQL operators</p>
    <p>Oblivious filter</p>
    <p>Oblivious sort</p>
    <p>Oblivious aggregation</p>
    <p>Oblivious join</p>
    <p>Cost model</p>
    <p>Rule-based optimization</p>
    <p>Cost-based optimization</p>
  </div>
  <div class="page">
    <p>Novel query planning techniques</p>
    <p>Two-part solution:</p>
    <p>Distributed oblivious SQL operators</p>
    <p>Oblivious filter</p>
    <p>Oblivious sort</p>
    <p>Oblivious aggregation</p>
    <p>Oblivious join</p>
    <p>Cost model</p>
    <p>Rule-based optimization</p>
    <p>Cost-based optimization</p>
  </div>
  <div class="page">
    <p>Rule-based optimization</p>
  </div>
  <div class="page">
    <p>Rule-based optimization</p>
    <p>SELECT count(*) FROM medical WHERE age &gt; 30 GROUP BY disease</p>
  </div>
  <div class="page">
    <p>Rule-based optimization</p>
    <p>SELECT count(*) FROM medical WHERE age &gt; 30 GROUP BY disease</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op.</p>
  </div>
  <div class="page">
    <p>Insight 1</p>
  </div>
  <div class="page">
    <p>Insight 1</p>
  </div>
  <div class="page">
    <p>Insight 1</p>
  </div>
  <div class="page">
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op.</p>
  </div>
  <div class="page">
    <p>Rule-based optimization Opaque op.</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op.</p>
  </div>
  <div class="page">
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>Opaque op.</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op.</p>
  </div>
  <div class="page">
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>Opaque op.</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op.</p>
  </div>
  <div class="page">
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>Scan</p>
    <p>Opaque op.</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op.</p>
  </div>
  <div class="page">
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>Scan</p>
    <p>Opaque op.</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op. 12809 Amanda D. Edwards 40 Diabetes 29489 Robert R. McGowan 56 Diabetes 13744 Kimberly R. Seay 51 Cancer 18740 Dennis G. Bates 32 Diabetes 32591 Donna R. Bridges 26 Diabetes 98329 Ronald S. Ogden 53 Cancer</p>
  </div>
  <div class="page">
    <p>O-sort</p>
    <p>Filter</p>
    <p>Project</p>
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>Scan</p>
    <p>Opaque op.</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op. 12809 Amanda D. Edwards 40 Diabetes 29489 Robert R. McGowan 56 Diabetes 13744 Kimberly R. Seay 51 Cancer 18740 Dennis G. Bates 32 Diabetes 32591 Donna R. Bridges 26 Diabetes 98329 Ronald S. Ogden 53 Cancer</p>
  </div>
  <div class="page">
    <p>O-sort</p>
    <p>Filter</p>
    <p>Project</p>
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>Scan</p>
    <p>Opaque op.</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op. 12809 Amanda D. Edwards 40 Diabetes 29489 Robert R. McGowan 56 Diabetes 13744 Kimberly R. Seay 51 Cancer 18740 Dennis G. Bates 32 Diabetes 32591 Donna R. Bridges 26 Diabetes 98329 Ronald S. Ogden 53 Cancer</p>
  </div>
  <div class="page">
    <p>O-sort</p>
    <p>Filter</p>
    <p>ProjectProject</p>
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>Scan</p>
    <p>Opaque op.</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op. 12809 Amanda D. Edwards 40 Diabetes 29489 Robert R. McGowan 56 Diabetes 13744 Kimberly R. Seay 51 Cancer 18740 Dennis G. Bates 32 Diabetes 32591 Donna R. Bridges 26 Diabetes 98329 Ronald S. Ogden 53 Cancer</p>
  </div>
  <div class="page">
    <p>O-sort</p>
    <p>Filter</p>
    <p>ProjectProject</p>
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>Scan</p>
    <p>Opaque op.</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op. 12809 Amanda D. Edwards 40 Diabetes 29489 Robert R. McGowan 56 Diabetes 13744 Kimberly R. Seay 51 Cancer 18740 Dennis G. Bates 32 Diabetes 32591 Donna R. Bridges 26 Diabetes 98329 Ronald S. Ogden 53 Cancer</p>
  </div>
  <div class="page">
    <p>O-sort</p>
    <p>Filter</p>
    <p>ProjectProject</p>
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>Scan</p>
    <p>Opaque op.</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op. 12809 Amanda D. Edwards 40 Diabetes 29489 Robert R. McGowan 56 Diabetes 13744 Kimberly R. Seay 51 Cancer 18740 Dennis G. Bates 32 Diabetes 32591 Donna R. Bridges 26 Diabetes 98329 Ronald S. Ogden 53 Cancer</p>
  </div>
  <div class="page">
    <p>O-sort</p>
    <p>Filter</p>
    <p>ProjectProject</p>
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>Scan</p>
    <p>Opaque op.</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op. 12809 Amanda D. Edwards 40 Diabetes 29489 Robert R. McGowan 56 Diabetes 13744 Kimberly R. Seay 51 Cancer 18740 Dennis G. Bates 32 Diabetes 32591 Donna R. Bridges 26 Diabetes</p>
  </div>
  <div class="page">
    <p>O-sort</p>
    <p>Filter</p>
    <p>ProjectProject</p>
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>Scan</p>
    <p>Opaque op.</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op. 12809 Amanda D. Edwards 40 Diabetes 29489 Robert R. McGowan 56 Diabetes 13744 Kimberly R. Seay 51 Cancer 18740 Dennis G. Bates 32 Diabetes 32591 Donna R. Bridges 26 Diabetes</p>
  </div>
  <div class="page">
    <p>O-sort</p>
    <p>Filter</p>
    <p>Project</p>
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>Scan</p>
    <p>Opaque op.</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op. 12809 Amanda D. Edwards 40 Diabetes 29489 Robert R. McGowan 56 Diabetes 13744 Kimberly R. Seay 51 Cancer 18740 Dennis G. Bates 32 Diabetes 32591 Donna R. Bridges 26 Diabetes</p>
  </div>
  <div class="page">
    <p>O-sort</p>
    <p>Filter</p>
    <p>Project</p>
    <p>O-sort</p>
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>Scan</p>
    <p>Opaque op.</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op. 12809 Amanda D. Edwards 40 Diabetes 29489 Robert R. McGowan 56 Diabetes 13744 Kimberly R. Seay 51 Cancer 18740 Dennis G. Bates 32 Diabetes 32591 Donna R. Bridges 26 Diabetes</p>
  </div>
  <div class="page">
    <p>O-sort</p>
    <p>Filter</p>
    <p>Project</p>
    <p>O-sort</p>
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>Scan</p>
    <p>Opaque op.</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op. 12809 Amanda D. Edwards 40 Diabetes 29489 Robert R. McGowan 56 Diabetes 13744 Kimberly R. Seay 51 Cancer 18740 Dennis G. Bates 32 Diabetes 32591 Donna R. Bridges 26 Diabetes</p>
  </div>
  <div class="page">
    <p>O-sort</p>
    <p>Filter</p>
    <p>Project</p>
    <p>O-sort</p>
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>Scan</p>
    <p>Opaque op.</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op. 12809 Amanda D. Edwards 40 Diabetes 29489 Robert R. McGowan 56 Diabetes 13744 Kimberly R. Seay 51 Cancer 18740 Dennis G. Bates 32 Diabetes</p>
  </div>
  <div class="page">
    <p>O-sort</p>
    <p>Filter</p>
    <p>Project</p>
    <p>O-sort</p>
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>Scan</p>
    <p>Opaque op.</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op. 12809 Amanda D. Edwards 40 Diabetes 29489 Robert R. McGowan 56 Diabetes 13744 Kimberly R. Seay 51 Cancer 18740 Dennis G. Bates 32 Diabetes</p>
  </div>
  <div class="page">
    <p>O-sort</p>
    <p>Filter</p>
    <p>Project</p>
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>Scan</p>
    <p>Opaque op.</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op. 12809 Amanda D. Edwards 40 Diabetes 29489 Robert R. McGowan 56 Diabetes 13744 Kimberly R. Seay 51 Cancer 18740 Dennis G. Bates 32 Diabetes</p>
  </div>
  <div class="page">
    <p>O-sort</p>
    <p>Filter</p>
    <p>Project</p>
    <p>Filter</p>
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>Scan</p>
    <p>Opaque op.</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op. 12809 Amanda D. Edwards 40 Diabetes 29489 Robert R. McGowan 56 Diabetes 13744 Kimberly R. Seay 51 Cancer 18740 Dennis G. Bates 32 Diabetes</p>
  </div>
  <div class="page">
    <p>O-sort</p>
    <p>Filter</p>
    <p>Project</p>
    <p>Filter</p>
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>Scan</p>
    <p>Opaque op.</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op. 12809 Amanda D. Edwards 40 Diabetes 29489 Robert R. McGowan 56 Diabetes 13744 Kimberly R. Seay 51 Cancer 18740 Dennis G. Bates 32 Diabetes</p>
  </div>
  <div class="page">
    <p>O-sort</p>
    <p>Filter</p>
    <p>Project</p>
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>Scan</p>
    <p>Opaque op.</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op. 12809 Amanda D. Edwards 40 Diabetes 29489 Robert R. McGowan 56 Diabetes 13744 Kimberly R. Seay 51 Cancer 18740 Dennis G. Bates 32 Diabetes</p>
  </div>
  <div class="page">
    <p>O-sort</p>
    <p>Agg.</p>
    <p>O-sort</p>
    <p>O-sort</p>
    <p>Filter</p>
    <p>Project</p>
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>Scan</p>
    <p>Opaque op.</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op. 12809 Amanda D. Edwards 40 Diabetes 29489 Robert R. McGowan 56 Diabetes 13744 Kimberly R. Seay 51 Cancer 18740 Dennis G. Bates 32 Diabetes</p>
  </div>
  <div class="page">
    <p>O-sort</p>
    <p>Agg.</p>
    <p>O-sort</p>
    <p>O-sort</p>
    <p>Filter</p>
    <p>Project</p>
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>Scan</p>
    <p>Opaque op.</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op. 12809 Amanda D. Edwards 40 Diabetes 29489 Robert R. McGowan 56 Diabetes 13744 Kimberly R. Seay 51 Cancer 18740 Dennis G. Bates 32 Diabetes</p>
  </div>
  <div class="page">
    <p>O-sort</p>
    <p>Agg.</p>
    <p>O-sort</p>
    <p>O-sort</p>
    <p>Filter</p>
    <p>Project</p>
    <p>O-sort</p>
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>Scan</p>
    <p>Opaque op.</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op. 12809 Amanda D. Edwards 40 Diabetes 29489 Robert R. McGowan 56 Diabetes 13744 Kimberly R. Seay 51 Cancer 18740 Dennis G. Bates 32 Diabetes</p>
  </div>
  <div class="page">
    <p>O-sort</p>
    <p>Agg.</p>
    <p>O-sort</p>
    <p>O-sort</p>
    <p>Filter</p>
    <p>Project</p>
    <p>O-sort</p>
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>Scan</p>
    <p>Opaque op.</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op.</p>
  </div>
  <div class="page">
    <p>O-sort</p>
    <p>Agg.</p>
    <p>O-sort</p>
    <p>O-sort</p>
    <p>Filter</p>
    <p>Project</p>
    <p>O-sort</p>
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>Scan</p>
    <p>Opaque op.</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op.</p>
    <p>Can we remove any sort?</p>
  </div>
  <div class="page">
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>O-sort</p>
    <p>Scan</p>
    <p>Filter</p>
    <p>O-sort</p>
    <p>Agg.</p>
    <p>O-sort</p>
    <p>Opaque op.</p>
    <p>Project</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op.</p>
  </div>
  <div class="page">
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>O-sort</p>
    <p>Scan</p>
    <p>Filter</p>
    <p>O-sort</p>
    <p>Agg.</p>
    <p>O-sort</p>
    <p>Opaque op.</p>
    <p>Project</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op.</p>
  </div>
  <div class="page">
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>O-sort</p>
    <p>Scan</p>
    <p>Filter</p>
    <p>O-sort</p>
    <p>Agg.</p>
    <p>O-sort</p>
    <p>Opaque op.</p>
    <p>Project</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op.</p>
  </div>
  <div class="page">
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>O-sort</p>
    <p>Scan</p>
    <p>Filter</p>
    <p>O-sort</p>
    <p>Agg.</p>
    <p>O-sort</p>
    <p>Opaque op.</p>
    <p>Project</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op.</p>
    <p>Sort on 0/1 column</p>
  </div>
  <div class="page">
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>O-sort</p>
    <p>Scan</p>
    <p>Filter</p>
    <p>O-sort</p>
    <p>Agg.</p>
    <p>O-sort</p>
    <p>Opaque op.</p>
    <p>Project</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op.</p>
    <p>Sort on 0/1 column</p>
  </div>
  <div class="page">
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>O-sort</p>
    <p>Scan</p>
    <p>Filter</p>
    <p>O-sort</p>
    <p>Agg.</p>
    <p>O-sort</p>
    <p>Opaque op.</p>
    <p>Project</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op.</p>
    <p>Sort on 0/1 column</p>
    <p>Sort on Disease</p>
  </div>
  <div class="page">
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>O-sort</p>
    <p>Scan</p>
    <p>Filter</p>
    <p>O-sort</p>
    <p>Agg.</p>
    <p>O-sort</p>
    <p>Opaque op.</p>
    <p>Project</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op.</p>
    <p>Sort on 0/1 column</p>
    <p>Sort on Disease +</p>
  </div>
  <div class="page">
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>O-sort</p>
    <p>Scan</p>
    <p>Filter</p>
    <p>O-sort</p>
    <p>Agg.</p>
    <p>O-sort</p>
    <p>Opaque op.</p>
    <p>Project</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op.</p>
    <p>Sort on 0/1 column</p>
    <p>Sort on Disease +</p>
    <p>=</p>
  </div>
  <div class="page">
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>O-sort</p>
    <p>Scan</p>
    <p>Filter</p>
    <p>O-sort</p>
    <p>Agg.</p>
    <p>O-sort</p>
    <p>Opaque op.</p>
    <p>Project</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op.</p>
    <p>Sort on 0/1 column</p>
    <p>Sort on Disease +</p>
    <p>Sort on (0/1, Disease)</p>
    <p>=</p>
  </div>
  <div class="page">
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>O-sort</p>
    <p>Scan</p>
    <p>Filter</p>
    <p>O-sort</p>
    <p>Agg.</p>
    <p>O-sort</p>
    <p>Opaque op.</p>
    <p>Project</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op.</p>
  </div>
  <div class="page">
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>O-sort</p>
    <p>Scan</p>
    <p>Filter</p>
    <p>O-sort</p>
    <p>Agg.</p>
    <p>O-sort</p>
    <p>Opaque op.</p>
    <p>Project</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op.</p>
  </div>
  <div class="page">
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>O-sort</p>
    <p>Scan</p>
    <p>Filter</p>
    <p>Agg.</p>
    <p>O-sort</p>
    <p>Opaque op.</p>
    <p>Project</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op.</p>
  </div>
  <div class="page">
    <p>Scan</p>
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>Agg.</p>
    <p>O-sort</p>
    <p>Opaque op.</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op.</p>
    <p>O-sort</p>
    <p>Filter</p>
    <p>Project</p>
  </div>
  <div class="page">
    <p>Scan</p>
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>Scan</p>
    <p>Agg.</p>
    <p>O-sort</p>
    <p>Opaque op.</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op.</p>
    <p>O-sort</p>
    <p>Filter</p>
    <p>Project</p>
  </div>
  <div class="page">
    <p>Scan</p>
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>Scan</p>
    <p>Agg.</p>
    <p>O-sort</p>
    <p>Opaque op.</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op. 12809 Amanda D. Edwards 40 Diabetes 29489 Robert R. McGowan 56 Diabetes 13744 Kimberly R. Seay 51 Cancer 18740 Dennis G. Bates 32 Diabetes 32591 Donna R. Bridges 26 Diabetes 98329 Ronald S. Ogden 53 Cancer</p>
    <p>O-sort</p>
    <p>Filter</p>
    <p>Project</p>
  </div>
  <div class="page">
    <p>Scan</p>
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>Agg.</p>
    <p>O-sort</p>
    <p>Opaque op.</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op. 12809 Amanda D. Edwards 40 Diabetes 29489 Robert R. McGowan 56 Diabetes 13744 Kimberly R. Seay 51 Cancer 18740 Dennis G. Bates 32 Diabetes 32591 Donna R. Bridges 26 Diabetes 98329 Ronald S. Ogden 53 Cancer</p>
    <p>O-sort</p>
    <p>Filter</p>
    <p>Project</p>
  </div>
  <div class="page">
    <p>Scan</p>
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>Agg.</p>
    <p>O-sort</p>
    <p>Opaque op.</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op. 12809 Amanda D. Edwards 40 Diabetes 29489 Robert R. McGowan 56 Diabetes 13744 Kimberly R. Seay 51 Cancer 18740 Dennis G. Bates 32 Diabetes 32591 Donna R. Bridges 26 Diabetes 98329 Ronald S. Ogden 53 Cancer</p>
    <p>O-sort</p>
    <p>Filter</p>
    <p>ProjectProject</p>
  </div>
  <div class="page">
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>O-sort</p>
    <p>Scan</p>
    <p>Agg.</p>
    <p>O-sort</p>
    <p>Opaque op.</p>
    <p>Project</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op. 12809 Amanda D. Edwards 40 Diabetes 0 29489 Robert R. McGowan 56 Diabetes 0 13744 Kimberly R. Seay 51 Cancer 0 18740 Dennis G. Bates 32 Diabetes 0 32591 Donna R. Bridges 26 Diabetes 1 98329 Ronald S. Ogden 53 Cancer 0</p>
    <p>Project</p>
    <p>Filter</p>
  </div>
  <div class="page">
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>O-sort</p>
    <p>Scan</p>
    <p>Agg.</p>
    <p>O-sort</p>
    <p>Opaque op.</p>
    <p>Project</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op. 12809 Amanda D. Edwards 40 Diabetes 0 29489 Robert R. McGowan 56 Diabetes 0 13744 Kimberly R. Seay 51 Cancer 0 18740 Dennis G. Bates 32 Diabetes 0 32591 Donna R. Bridges 26 Diabetes 1 98329 Ronald S. Ogden 53 Cancer 0</p>
    <p>Filter</p>
  </div>
  <div class="page">
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>O-sort</p>
    <p>Scan</p>
    <p>Agg.</p>
    <p>O-sort</p>
    <p>Opaque op.</p>
    <p>Project</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op.</p>
    <p>O-sort</p>
    <p>Filter</p>
  </div>
  <div class="page">
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>O-sort</p>
    <p>Scan</p>
    <p>Agg.</p>
    <p>O-sort</p>
    <p>Opaque op.</p>
    <p>Project</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op.</p>
    <p>O-sort</p>
    <p>multi-column sort</p>
    <p>Filter</p>
  </div>
  <div class="page">
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>O-sort</p>
    <p>Scan</p>
    <p>Agg.</p>
    <p>O-sort</p>
    <p>Opaque op.</p>
    <p>Project</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op.</p>
    <p>O-sort</p>
    <p>multi-column sort</p>
    <p>Filter</p>
  </div>
  <div class="page">
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>O-sort</p>
    <p>Scan</p>
    <p>Agg.</p>
    <p>O-sort</p>
    <p>Opaque op.</p>
    <p>Project</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op.</p>
    <p>O-sort</p>
    <p>multi-column sort</p>
    <p>Filter</p>
  </div>
  <div class="page">
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>O-sort</p>
    <p>Scan</p>
    <p>Agg.</p>
    <p>O-sort</p>
    <p>Opaque op.</p>
    <p>Project</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op.</p>
    <p>multi-column sort</p>
    <p>Filter</p>
  </div>
  <div class="page">
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>O-sort</p>
    <p>Scan</p>
    <p>Agg.</p>
    <p>O-sort</p>
    <p>Opaque op.</p>
    <p>Project</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op.</p>
    <p>multi-column sort</p>
    <p>FilterFilter</p>
  </div>
  <div class="page">
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>O-sort</p>
    <p>Scan</p>
    <p>Agg.</p>
    <p>O-sort</p>
    <p>Opaque op.</p>
    <p>Project</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op.</p>
    <p>multi-column sort</p>
    <p>FilterFilter</p>
  </div>
  <div class="page">
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>O-sort</p>
    <p>Scan</p>
    <p>Agg.</p>
    <p>O-sort</p>
    <p>Opaque op.</p>
    <p>Project</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op.</p>
    <p>multi-column sort</p>
    <p>Filter</p>
  </div>
  <div class="page">
    <p>Rule-based optimization</p>
    <p>medical</p>
    <p>O-sort</p>
    <p>Scan</p>
    <p>Agg.</p>
    <p>O-sort</p>
    <p>Opaque op.</p>
    <p>Project</p>
    <p>medical</p>
    <p>Filter</p>
    <p>Aggregation</p>
    <p>Logical op.</p>
    <p>multi-column sort</p>
    <p>Filter</p>
    <p>Eliminated one oblivious sort!</p>
  </div>
  <div class="page">
    <p>Novel query planning techniques</p>
    <p>Two-part solution:</p>
    <p>Distributed oblivious SQL operators</p>
    <p>Oblivious filter</p>
    <p>Oblivious sort</p>
    <p>Oblivious aggregation</p>
    <p>Oblivious join</p>
    <p>Cost model</p>
    <p>Rule-based optimization</p>
    <p>Cost-based optimization</p>
  </div>
  <div class="page">
    <p>Observation: not all tables are sensitive</p>
  </div>
  <div class="page">
    <p>Observation: not all tables are sensitive</p>
    <p>P_ID</p>
    <p>D_ID</p>
    <p>Name</p>
    <p>Age</p>
    <p>Hospitalized patients</p>
    <p>D_ID</p>
    <p>Name</p>
    <p>G_ID</p>
    <p>Disease</p>
    <p>M_ID</p>
    <p>D_ID</p>
    <p>Name</p>
    <p>Cost</p>
    <p>Medication</p>
  </div>
  <div class="page">
    <p>Observation: not all tables are sensitive</p>
    <p>P_ID</p>
    <p>D_ID</p>
    <p>Name</p>
    <p>Age</p>
    <p>Hospitalized patients</p>
    <p>D_ID</p>
    <p>Name</p>
    <p>G_ID</p>
    <p>Disease</p>
    <p>M_ID</p>
    <p>D_ID</p>
    <p>Name</p>
    <p>Cost</p>
    <p>Medication</p>
    <p>P_ID</p>
    <p>D_ID</p>
    <p>Name</p>
    <p>Age</p>
    <p>Hospitalized patients</p>
  </div>
  <div class="page">
    <p>Observation: not all tables are sensitive</p>
    <p>P_ID</p>
    <p>D_ID</p>
    <p>Name</p>
    <p>Age</p>
    <p>Hospitalized patients</p>
    <p>D_ID</p>
    <p>Name</p>
    <p>G_ID</p>
    <p>Disease</p>
    <p>M_ID</p>
    <p>D_ID</p>
    <p>Name</p>
    <p>Cost</p>
    <p>Medication</p>
    <p>P_ID</p>
    <p>D_ID</p>
    <p>Name</p>
    <p>Age</p>
    <p>Hospitalized patients</p>
    <p>Opaque can operate in mixed sensitivity: sensitive tables are run with oblivious operators</p>
  </div>
  <div class="page">
    <p>A B C DC</p>
    <p>Observation: not all tables are sensitive</p>
  </div>
  <div class="page">
    <p>A B C DC</p>
    <p>Observation: not all tables are sensitive</p>
  </div>
  <div class="page">
    <p>A B C DC</p>
    <p>Observation: not all tables are sensitive</p>
    <p>Not oblivious!</p>
  </div>
  <div class="page">
    <p>A B C DC</p>
    <p>Observation: not all tables are sensitive</p>
  </div>
  <div class="page">
    <p>A B C DC</p>
    <p>Observation: not all tables are sensitive</p>
    <p>Sensitivity propagation: propagate obliviousness from leaf to root</p>
  </div>
  <div class="page">
    <p>A B C DC</p>
    <p>Observation: not all tables are sensitive</p>
    <p>Sensitivity propagation: propagate obliviousness from leaf to root</p>
  </div>
  <div class="page">
    <p>A B C D</p>
    <p>C</p>
    <p>Observation: not all tables are sensitive</p>
    <p>Sensitivity propagation: propagate obliviousness from leaf to root</p>
  </div>
  <div class="page">
    <p>Insight 2</p>
    <p>Sensitivity propagation introduces a new dimension to</p>
    <p>query optimization</p>
  </div>
  <div class="page">
    <p>Cost-based optimization</p>
    <p>P_ID</p>
    <p>D_ID</p>
    <p>Name</p>
    <p>Age</p>
    <p>Hospitalized patients</p>
    <p>D_ID</p>
    <p>Name</p>
    <p>G_ID</p>
    <p>Disease</p>
    <p>M_ID</p>
    <p>D_ID</p>
    <p>Name</p>
    <p>Cost</p>
    <p>Medication</p>
    <p>Find the least costly medication for each patient</p>
  </div>
  <div class="page">
    <p>Cost-based optimization</p>
    <p>P_ID</p>
    <p>D_ID</p>
    <p>Name</p>
    <p>Age</p>
    <p>Hospitalized patients</p>
    <p>D_ID</p>
    <p>Name</p>
    <p>G_ID</p>
    <p>Disease</p>
    <p>M_ID</p>
    <p>D_ID</p>
    <p>Name</p>
    <p>Cost</p>
    <p>Medication</p>
    <p>Find the least costly medication for each patient</p>
    <p>Assumption: |P| &lt; |D| &lt; |M|</p>
  </div>
  <div class="page">
    <p>Cost-based optimization</p>
    <p>P_ID</p>
    <p>D_ID</p>
    <p>Name</p>
    <p>Age</p>
    <p>Hospitalized patients</p>
    <p>D_ID</p>
    <p>Name</p>
    <p>G_ID</p>
    <p>Disease</p>
    <p>M_ID</p>
    <p>D_ID</p>
    <p>Name</p>
    <p>Cost</p>
    <p>Medication</p>
    <p>SELECT p_name, d_name, med_cost FROM patient, disease, (SELECT d_id, min(cost) AS med_cost FROM medication GROUP BY d_id) AS med WHERE disease.d_id = patient.d_id AND disease.d_id = med.d_id</p>
    <p>Find the least costly medication for each patient</p>
    <p>Assumption: |P| &lt; |D| &lt; |M|</p>
  </div>
  <div class="page">
    <p>Cost-based optimization</p>
    <p>P_ID</p>
    <p>D_ID</p>
    <p>Name</p>
    <p>Age</p>
    <p>Hospitalized patients</p>
    <p>D_ID</p>
    <p>Name</p>
    <p>G_ID</p>
    <p>Disease</p>
    <p>M_ID</p>
    <p>D_ID</p>
    <p>Name</p>
    <p>Cost</p>
    <p>Medication</p>
    <p>SELECT p_name, d_name, med_cost FROM patient, disease, (SELECT d_id, min(cost) AS med_cost FROM medication GROUP BY d_id) AS med WHERE disease.d_id = patient.d_id AND disease.d_id = med.d_id</p>
    <p>Find the least costly medication for each patient</p>
    <p>Assumption: |P| &lt; |D| &lt; |M|</p>
  </div>
  <div class="page">
    <p>Cost-based optimization</p>
    <p>P_ID</p>
    <p>D_ID</p>
    <p>Name</p>
    <p>Age</p>
    <p>Hospitalized patients</p>
    <p>D_ID</p>
    <p>Name</p>
    <p>G_ID</p>
    <p>Disease</p>
    <p>M_ID</p>
    <p>D_ID</p>
    <p>Name</p>
    <p>Cost</p>
    <p>Medication</p>
    <p>SELECT p_name, d_name, med_cost FROM patient, disease, (SELECT d_id, min(cost) AS med_cost FROM medication GROUP BY d_id) AS med WHERE disease.d_id = patient.d_id AND disease.d_id = med.d_id</p>
    <p>Find the least costly medication for each patient</p>
    <p>Assumption: |P| &lt; |D| &lt; |M|</p>
  </div>
  <div class="page">
    <p>Cost-based optimization</p>
    <p>Patient Disease Medication</p>
    <p>Patient</p>
    <p>Disease</p>
    <p>Medication</p>
    <p>SQL optimizer with new cost:</p>
  </div>
  <div class="page">
    <p>Cost-based optimization</p>
    <p>Patient Disease Medication</p>
    <p>Patient</p>
    <p>Disease</p>
    <p>Medication</p>
    <p>SQL optimizer with new cost:</p>
    <p>More selective non-oblivious join</p>
  </div>
  <div class="page">
    <p>Cost-based optimization</p>
    <p>Patient Disease Medication</p>
    <p>Patient</p>
    <p>Disease</p>
    <p>Medication</p>
    <p>SQL optimizer with new cost:</p>
    <p>More selective non-oblivious join</p>
  </div>
  <div class="page">
    <p>Cost-based optimization</p>
    <p>Patient Disease Medication</p>
    <p>Patient</p>
    <p>Disease</p>
    <p>Medication</p>
    <p>SQL optimizer with new cost and sensitivity propagation:</p>
  </div>
  <div class="page">
    <p>Cost-based optimization</p>
    <p>Patient Disease Medication</p>
    <p>Patient</p>
    <p>Disease</p>
    <p>Medication</p>
    <p>SQL optimizer with new cost and sensitivity propagation:</p>
    <p>Fewer oblivious joins</p>
  </div>
  <div class="page">
    <p>Cost-based optimization</p>
    <p>Patient Disease Medication</p>
    <p>Patient</p>
    <p>Disease</p>
    <p>Medication</p>
    <p>SQL optimizer with new cost and sensitivity propagation:</p>
    <p>Fewer oblivious joins</p>
  </div>
  <div class="page">
    <p>Evaluation setup</p>
  </div>
  <div class="page">
    <p>Evaluation setup  Single machine experiments:</p>
    <p>Intel Xeon E3-1280 v5, 4 cores, 64 GB RAM</p>
    <p>Intel SGX: 128 MB of enclave page cache (EPC)</p>
  </div>
  <div class="page">
    <p>Evaluation setup  Single machine experiments:</p>
    <p>Intel Xeon E3-1280 v5, 4 cores, 64 GB RAM</p>
    <p>Intel SGX: 128 MB of enclave page cache (EPC)</p>
    <p>Distributed experiments</p>
    <p>A cluster of 5 SGX machines</p>
  </div>
  <div class="page">
    <p>Evaluation</p>
  </div>
  <div class="page">
    <p>Evaluation  How does Opaque compare to Spark SQL?</p>
  </div>
  <div class="page">
    <p>Evaluation  How does Opaque compare to Spark SQL?</p>
    <p>Big Data Benchmark (BDB); 4 queries total</p>
  </div>
  <div class="page">
    <p>Evaluation  How does Opaque compare to Spark SQL?</p>
    <p>Big Data Benchmark (BDB); 4 queries total  Queries 1, 2, 3: filter, aggregation, join</p>
  </div>
  <div class="page">
    <p>Evaluation  How does Opaque compare to Spark SQL?</p>
    <p>Big Data Benchmark (BDB); 4 queries total  Queries 1, 2, 3: filter, aggregation, join  1 million records</p>
  </div>
  <div class="page">
    <p>Evaluation  How does Opaque compare to Spark SQL?</p>
    <p>Big Data Benchmark (BDB); 4 queries total  Queries 1, 2, 3: filter, aggregation, join  1 million records</p>
    <p>How does Opaque compare to state-of-the-art oblivious systems?</p>
  </div>
  <div class="page">
    <p>Evaluation  How does Opaque compare to Spark SQL?</p>
    <p>Big Data Benchmark (BDB); 4 queries total  Queries 1, 2, 3: filter, aggregation, join  1 million records</p>
    <p>How does Opaque compare to state-of-the-art oblivious systems?  GraphSC (oblivious graph analytics)</p>
  </div>
  <div class="page">
    <p>Evaluation  How does Opaque compare to Spark SQL?</p>
    <p>Big Data Benchmark (BDB); 4 queries total  Queries 1, 2, 3: filter, aggregation, join  1 million records</p>
    <p>How does Opaque compare to state-of-the-art oblivious systems?  GraphSC (oblivious graph analytics)</p>
    <p>PageRank</p>
  </div>
  <div class="page">
    <p>Big Data Benchmark (distributed)</p>
  </div>
  <div class="page">
    <p>Big Data Benchmark (distributed)</p>
    <p>Data encryption, authentication, computation verification</p>
  </div>
  <div class="page">
    <p>Big Data Benchmark (distributed)</p>
    <p>R un</p>
    <p>tim e</p>
    <p>(s )</p>
    <p>Query number Query 1 Query 2 Query 3</p>
    <p>Spark SQL Opaque</p>
    <p>Data encryption, authentication, computation verification</p>
  </div>
  <div class="page">
    <p>Big Data Benchmark (distributed)</p>
    <p>R un</p>
    <p>tim e</p>
    <p>(s )</p>
    <p>Query number Query 1 Query 2 Query 3</p>
    <p>Spark SQL Opaque</p>
    <p>Data encryption, authentication, computation verification</p>
  </div>
  <div class="page">
    <p>Big Data Benchmark (distributed)</p>
    <p>R un</p>
    <p>tim e</p>
    <p>(s )</p>
    <p>Query number Query 1 Query 2 Query 3</p>
    <p>Spark SQL Opaque</p>
    <p>Data encryption, authentication, computation verification</p>
  </div>
  <div class="page">
    <p>Big Data Benchmark (distributed)</p>
    <p>R un</p>
    <p>tim e</p>
    <p>(s )</p>
    <p>Query number Query 1 Query 2 Query 3</p>
    <p>Spark SQL Opaque</p>
    <p>Data encryption, authentication, computation verification</p>
    <p>Overhead: 0.47x to 2.3x</p>
  </div>
  <div class="page">
    <p>Big Data Benchmark (distributed)</p>
    <p>R un</p>
    <p>tim e</p>
    <p>(s )</p>
    <p>Query number Query 1 Query 2 Query 3</p>
    <p>Spark SQL Opaque</p>
    <p>Data encryption, authentication, computation verification</p>
    <p>Overhead: 0.47x to 2.3x</p>
    <p>+ Obliviousness</p>
  </div>
  <div class="page">
    <p>Big Data Benchmark (distributed)</p>
    <p>R un</p>
    <p>tim e</p>
    <p>(s )</p>
    <p>Query number Query 1 Query 2 Query 3</p>
    <p>Spark SQL Opaque</p>
    <p>Data encryption, authentication, computation verification</p>
    <p>Overhead: 0.47x to 2.3x</p>
    <p>R un</p>
    <p>tim e</p>
    <p>(s )</p>
    <p>Query number Query 1 Query 2 Query 3</p>
    <p>Spark SQL Opaque</p>
    <p>+ Obliviousness</p>
  </div>
  <div class="page">
    <p>Big Data Benchmark (distributed)</p>
    <p>R un</p>
    <p>tim e</p>
    <p>(s )</p>
    <p>Query number Query 1 Query 2 Query 3</p>
    <p>Spark SQL Opaque</p>
    <p>Data encryption, authentication, computation verification</p>
    <p>Overhead: 0.47x to 2.3x</p>
    <p>R un</p>
    <p>tim e</p>
    <p>(s )</p>
    <p>Query number Query 1 Query 2 Query 3</p>
    <p>Spark SQL Opaque</p>
    <p>+ Obliviousness</p>
  </div>
  <div class="page">
    <p>Big Data Benchmark (distributed)</p>
    <p>R un</p>
    <p>tim e</p>
    <p>(s )</p>
    <p>Query number Query 1 Query 2 Query 3</p>
    <p>Spark SQL Opaque</p>
    <p>Data encryption, authentication, computation verification</p>
    <p>Overhead: 0.47x to 2.3x</p>
    <p>R un</p>
    <p>tim e</p>
    <p>(s )</p>
    <p>Query number Query 1 Query 2 Query 3</p>
    <p>Spark SQL Opaque</p>
    <p>+ Obliviousness</p>
  </div>
  <div class="page">
    <p>Big Data Benchmark (distributed)</p>
    <p>R un</p>
    <p>tim e</p>
    <p>(s )</p>
    <p>Query number Query 1 Query 2 Query 3</p>
    <p>Spark SQL Opaque</p>
    <p>Data encryption, authentication, computation verification</p>
    <p>Overhead: 0.47x to 2.3x</p>
    <p>R un</p>
    <p>tim e</p>
    <p>(s )</p>
    <p>Query number Query 1 Query 2 Query 3</p>
    <p>Spark SQL Opaque</p>
    <p>+ Obliviousness</p>
    <p>Overhead: 21x to 45x</p>
  </div>
  <div class="page">
    <p>PageRank: comparison with GraphSC (single machine)</p>
  </div>
  <div class="page">
    <p>Conclusion Opaque is an oblivious and encrypted distributed analytics platform</p>
    <p>Spark SQL Opaque</p>
    <p>SQL ML Graph Analytics</p>
    <p>Open source: github.com/ucbrise/opaque</p>
  </div>
</Presentation>
