<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Northeastern University International Secure Systems Lab</p>
    <p>A Large-Scale, Automated Approach to Detecting Ransomware</p>
    <p>Amin Kharraz, Sajjad Arshad, Collin Mulliner, William Robertson, Engin Kirda</p>
    <p>NEU SECLAB</p>
  </div>
  <div class="page">
    <p>NEU SECLAB</p>
    <p>What is a ransomware attack?</p>
    <p>Receiving the decryption key2 Paying the ransom fee1</p>
  </div>
  <div class="page">
    <p>NEU SECLAB 3</p>
    <p>A Typical Ransom Note</p>
  </div>
  <div class="page">
    <p>NEU SECLAB 4</p>
    <p>Attacks on Hospitals</p>
  </div>
  <div class="page">
    <p>NEU SECLAB 5</p>
  </div>
  <div class="page">
    <p>NEU SECLAB 7</p>
  </div>
  <div class="page">
    <p>CNN Interview with FBI, April 2016</p>
    <p>Cyber-criminals collected $209 million in the first three months of 2016 by extorting businesses and institutions to unlock computer servers.</p>
  </div>
  <div class="page">
    <p>NEU SECLAB 8</p>
    <p>How to defend against ransomware attacks?</p>
    <p>Educating end-users - Have a reliable backup policy - Avoid risky online behavior</p>
    <p>Developing detection tools to assist defenders - Providing insight from internal behavior</p>
    <p>Developing protection tools to enhance AV capabilities - Stopping the attack, and keeping the data consistent</p>
  </div>
  <div class="page">
    <p>NEU SECLAB 8</p>
    <p>How to defend against ransomware attacks?</p>
    <p>Educating end-users - Have a reliable backup policy - Avoid risky online behavior</p>
    <p>Developing detection tools to assist defenders - Providing insight from internal behavior</p>
    <p>Developing protection tools to enhance AV capabilities - Stopping the attack, and keeping the data consistent</p>
  </div>
  <div class="page">
    <p>NEU SECLAB 9</p>
    <p>Threat Model  Ransomware can employ any techniques to attack</p>
    <p>- Inject code into benign processes - Perform encrypted communication - Leverage arbitrary cryptosystems</p>
    <p>We assume that OS kernel, and underlying software</p>
    <p>and hardware stack are free of malicious code.</p>
    <p>Unveil detects ransomware during dynamic analysis</p>
    <p>phase, and not at end-user machines.</p>
    <p>- Complements current dynamic analysis systems - A cloud-based malware analysis service, sample sharing</p>
    <p>But, how can we detect a ransomware sample?</p>
  </div>
  <div class="page">
    <p>NEU SECLAB 10</p>
    <p>Achilles Heel of Ransomware</p>
    <p>Ransomware has to inform victim that attack has taken place</p>
    <p>Ransomware has certain behaviors that are predictable  e.g., entropy changes, modal dialogs and background activity,</p>
    <p>accessing user files  A good sandbox that looks for some of these signs helps</p>
    <p>here</p>
  </div>
  <div class="page">
    <p>NEU SECLAB 10</p>
    <p>UNVEIL: An Early Warning Dynamic Detection System for Ransomware</p>
  </div>
  <div class="page">
    <p>UNVEILs Architecture</p>
    <p>NEU SECLAB 11</p>
  </div>
  <div class="page">
    <p>NEU SECLAB</p>
    <p>Approach</p>
    <p>Detecting Cryptographic Ransomware:  Generating a fake (and attractive) user environment  Finding a reliable method for monitoring filesystem</p>
    <p>activity</p>
    <p>Why do we generate fake user environments?</p>
    <p>Making the analysis environment more realistic  Protecting the analysis system from some user environment</p>
    <p>fingerprinting - A static user environment can be easily detected by a</p>
    <p>malware</p>
  </div>
  <div class="page">
    <p>NEU SECLAB</p>
    <p>Approach</p>
    <p>Detecting Cryptographic Ransomware:  Generating a fake (and attractive) user environment  Finding a reliable method for monitoring filesystem</p>
    <p>activity</p>
    <p>Why do we generate fake user environments?</p>
    <p>Making the analysis environment more realistic  Protecting the analysis system from bare-user environment</p>
    <p>fingerprinting - A static user environment can be easily detected by a</p>
    <p>malware How do we generate fake user environments?</p>
  </div>
  <div class="page">
    <p>NEU SECLAB 13</p>
    <p>Generating Fake (Honey) Content</p>
    <p>Real files with valid headers  Using standard libraries (e.g., python- docx, python-pptx,</p>
    <p>OpenSSL)  Content that appears meaningful  File names do not look random, and appear realistic</p>
    <p>File paths  Users directory structure is generated randomly, but</p>
    <p>meaningfully  File attributes</p>
    <p>Generate content with different creation, modification, and access times</p>
  </div>
  <div class="page">
    <p>User</p>
    <p>Kernel</p>
    <p>Content Generator</p>
    <p>I/O MANAGER</p>
    <p>UNVEIL</p>
    <p>NEU SECLAB 15</p>
  </div>
  <div class="page">
    <p>User</p>
    <p>Kernel</p>
    <p>Rfs = &lt;Time,Pname,Pid,PPid,IRPflag,Arg,Result,BufEntropy&gt;</p>
    <p>I/O MANAGER</p>
    <p>UNVEIL</p>
  </div>
  <div class="page">
    <p>NEU SECLAB 17</p>
    <p>Extracting I/O Access Sequences</p>
    <p>(1) Overwrites the users file with an encrypted version</p>
    <p>(2) reads, encrypts and deletes files without wiping them from storage</p>
    <p>(3) reads, creates a new encrypted version, and securely deletes</p>
    <p>the original files</p>
  </div>
  <div class="page">
    <p>NEU SECLAB 18</p>
    <p>IO Access Sequences in Multiple Ransomware Families</p>
    <p>Read Write</p>
    <p>New File Encrypted version</p>
    <p>Deleting the Original File</p>
    <p>New File Encrypted version</p>
    <p>Secure Deletion</p>
  </div>
  <div class="page">
    <p>NEU SECLAB 19</p>
    <p>Iteration over files during a CryptoWall attack</p>
  </div>
  <div class="page">
    <p>Desktop Locker Ransomware</p>
    <p>NEU SECLAB</p>
    <p>Malware run</p>
  </div>
  <div class="page">
    <p>Desktop Locker Ransomware</p>
    <p>NEU SECLAB</p>
    <p>Dissimilarity Score</p>
  </div>
  <div class="page">
    <p>NEU SECLAB 21</p>
    <p>Preparing the Analysis Environment</p>
    <p>UNVEIL is deployed on top of Cuckoo Sandbox - UNVEIL supports all versions of Windows platforms.</p>
    <p>- Our tool is deployed in Kernel.</p>
    <p>- Bypassing UNVEIL is not technically easy in user-mode.</p>
    <p>Finding active malware is not easy</p>
    <p>- We modified some parts of Cuckoo to make it more resilient to environmentally sensitive samples</p>
    <p>- e.g., fake response to some of the environment checks</p>
    <p>- Other anti-evasion measures to look more realistic - e.g., defining multiple NTFS drives, changing IP address</p>
    <p>range and MAC addresses</p>
  </div>
  <div class="page">
    <p>NEU SECLAB 22</p>
    <p>Evaluation 1) Detecting known ransomware samples</p>
    <p>a) Collecting ~3500 ransomware from public repo, Anubis, two security companies.</p>
    <p>b) 149 benign executables including ransomware-like behavior c) 348 malware samples from 36 malware families</p>
    <p>Ransomware FamiliesBenign Applications</p>
  </div>
  <div class="page">
    <p>NEU SECLAB 23</p>
    <p>Dissimilarity score is different from family to family</p>
  </div>
  <div class="page">
    <p>NEU SECLAB</p>
    <p>Detecting known ransomware samples</p>
    <p>The threshold value t = 0.32 gives the highest recall with 100% precision</p>
  </div>
  <div class="page">
    <p>NEU SECLAB</p>
    <p>Evaluation UNVEIL with unknown samples</p>
    <p>. . .56 UNVEIL-enabled VMs on 8 Servers</p>
    <p>Ganeti Cluster</p>
    <p>~ 1200 malware samples per day</p>
  </div>
  <div class="page">
    <p>NEU SECLAB</p>
    <p>Evaluation UNVEIL with unknown samples  We used the same similarity threshold (t = 0.32) for the large scale</p>
    <p>experiment.</p>
    <p>The incoming samples were acquired from the daily malware feed provided</p>
    <p>by Anubis from March 18 to February 12, 2016.</p>
    <p>The dataset contained 148,223 distinct samples.</p>
  </div>
  <div class="page">
    <p>NEU SECLAB</p>
    <p>Cross-checking with VirusTotal</p>
    <p>Pollution ratio is defined as the ratio of the number of scanners that identified the sample to the number of scanners in VirusTotal</p>
  </div>
  <div class="page">
    <p>NEU SECLAB</p>
    <p>Detection Results</p>
  </div>
  <div class="page">
    <p>NEU SECLAB</p>
    <p>Detection: New Ransomware Family</p>
  </div>
  <div class="page">
    <p>NEU SECLAB</p>
    <p>Detection: New Ransomware Family</p>
    <p>During our experiments, we discovered a new malware family  We call it SilentCrypt  After we reported it, others started detecting it as well  We were not able to find any information about this family</p>
    <p>online  The ransomware first checks for private files of a user,</p>
    <p>contacts the C&amp;C server, and starts the attack based on the answer</p>
  </div>
  <div class="page">
    <p>NEU SECLAB</p>
    <p>Detection: New Ransomware Family</p>
  </div>
  <div class="page">
    <p>NEU SECLAB 32</p>
    <p>Ransomware is a serious threat</p>
    <p>UNVEIL introduces concrete models to detect Ransomware</p>
    <p>Detecting an unknown family shows that the solutions are useful in practice</p>
    <p>We continue to improve functionality tuned towards detecting ransomware</p>
    <p>Conclusion</p>
  </div>
  <div class="page">
    <p>NEU SECLAB 34</p>
    <p>Thank You</p>
  </div>
</Presentation>
