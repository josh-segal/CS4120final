<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>CAUDIT: Continuous Auditing of SSH Servers To Mitigate Brute-Force Attacks</p>
    <p>Phuong Cao Yuming Wu, Subho Banerjee, Justin Azoff, Alex Withers, Zbigniew Kalbarczyk, Ravishankar Iyer</p>
    <p>Electrical and Computer Engineering, Computer Science, National Center for Supercomputing Applications, Corelight</p>
  </div>
  <div class="page">
    <p>National Center for Supercomputing Applications (NCSA)</p>
    <p>NSF International Research Network Connections</p>
    <p>National Center for Supercomputing Applications</p>
  </div>
  <div class="page">
    <p>NCSA hosts critical data and enables scientific research</p>
    <p>National Center for Supercomputing Applications</p>
    <p>HIV virus simulation LIGO gravitational wave Tornado simulation</p>
    <p>Enabling scientific discovery in genomics, astrophysics, and earth sciences.</p>
  </div>
  <div class="page">
    <p>Internet</p>
    <p>SSH brute-force attacks affect internal hosts and monitors</p>
    <p>Blue Waters Science/Industry Data</p>
    <p>Bro</p>
    <p>AttackTagger [HotSoS16]</p>
    <p>netflows osquery</p>
    <p>SSH brute-force</p>
    <p>Alerts overload</p>
    <p>NCSA observes in the order of 10 million SSH brute-force attack a day</p>
  </div>
  <div class="page">
    <p>InternetSSH brute-force</p>
    <p>SSH brute-force attacks affect internal hosts and monitors</p>
    <p>Blue Waters Science/Industry Data</p>
    <p>Bro</p>
    <p>AttackTagger [HotSoS16]</p>
    <p>netflows osquery</p>
    <p>Issues: 1: SSH brute-force attacks overwhelm existing monitors</p>
    <p>Problem Statement:</p>
    <p>How to audit internal hosts against SSH brute-force attacks?</p>
  </div>
  <div class="page">
    <p>Putting SSH auditing in perspective</p>
    <p>Failing to password-protect exposed SSH servers</p>
    <p>How we protect #AzureAD and Microsoft Account from lists of leaked usernames and passwords</p>
  </div>
  <div class="page">
    <p>Internet</p>
    <p>CAUDIT: An operational system to audit internal servers</p>
    <p>Black Hole Router</p>
    <p>Auditor</p>
    <p>Blue Waters Science/Industry Data</p>
    <p>Continuous Auditing (CAUDIT)</p>
    <p>Honeypot</p>
    <p>SSH database</p>
    <p>/16 IP space (65K hosts)</p>
    <p>SSH brute-force</p>
    <p>Alert sharing network</p>
  </div>
  <div class="page">
    <p>Decreasing security incidents at NCSA</p>
    <p>Year</p>
    <p>C ou</p>
    <p>nt</p>
  </div>
  <div class="page">
    <p>Outline</p>
    <p>Internet-scale measurements of 405M SSH brute-force attacks</p>
    <p>Key enabling techniques of CAUDIT</p>
    <p>Benefits of CAUDIT in operational network</p>
  </div>
  <div class="page">
    <p>Where are the attacks coming from?</p>
    <p>Particular cloud providers are conduits for a high percentage of attacks</p>
    <p>China owns 7.7% of IPv4, but China ISPs are conduits for one fourth of attack attempts</p>
    <p>Others: 63.12%</p>
    <p>Top 5 ISP % Top 5 Cloud/VPN %</p>
    <p>IP -&gt; ASN mapping using KeyCDN as of May 2018</p>
  </div>
  <div class="page">
    <p>What kind of SSH client libraries are brute-forcing NCSA?</p>
    <p>Top 5 SSH client libraries</p>
    <p>Old routers or</p>
    <p>IoT devicesCVE201810933 (auth</p>
    <p>bypass)</p>
    <p>Rethinking network security for the Internet-of-Things [HotNets 15]</p>
  </div>
  <div class="page">
    <p>Daily count of passwords</p>
    <p>C u</p>
    <p>m u</p>
    <p>la ti v e p</p>
    <p>ro b</p>
    <p>a b</p>
    <p>il it y</p>
    <p>Leaked</p>
    <p>Default</p>
    <p>Dict</p>
    <p>Leaked passwords could indicate targeted attacks</p>
    <p>Leaked passwords are 3X more frequent than default/dictionary-based passwords</p>
  </div>
  <div class="page">
    <p>New and unknown SSH keys used in attack attempts</p>
    <p>None of the 159 observed keys belongs to known leaked SSH key db</p>
    <p>Passphrase SSH private keys  Hash of the recent host names in the known_host file</p>
    <p>Those keys have led to the adoption of new security policies</p>
    <p>(Top 5)</p>
  </div>
  <div class="page">
    <p>Outline</p>
    <p>Internet-scale measurements of SSH brute-force attacks</p>
    <p>Key enabling techniques of CAUDIT</p>
    <p>Benefits of CAUDIT in operational network</p>
  </div>
  <div class="page">
    <p>Interactive honeypots are difficult to operate at scale</p>
    <p>Blue Waters Science/Industry Data</p>
    <p>Interactive honeypot</p>
    <p>Data extraction</p>
    <p>Shell /bin/sh</p>
    <p>Code</p>
    <p>Internet SSH brute-force</p>
  </div>
  <div class="page">
    <p>Non-interactive honeypots can scale to millions of attempts</p>
    <p>Blue Waters Science/Industry Data</p>
    <p>Continuous Auditing (CAUDIT)</p>
    <p>Non-interactive honeypot</p>
    <p>SSH database</p>
    <p>Randomized SSH key fingerprints</p>
    <p>Non-interactive honeypots have a low memory footprint and are straightforward to operate.</p>
    <p>/16 IP space</p>
    <p>XInternetSSH brute-force</p>
  </div>
  <div class="page">
    <p>Continuous audits are driven by external attack attempts</p>
    <p>Internet</p>
    <p>Continuous Auditing (CAUDIT)</p>
    <p>Non-interactive honeypot</p>
    <p>Attack database</p>
    <p>Continuous Auditor</p>
    <p>/16 IP space Blue Waters Science/Industry Data</p>
    <p>External attackers attempts Continuous auditing</p>
    <p>SSH brute-force</p>
    <p>Bro netflows</p>
    <p>Continuous auditing can be seamlessly integrated to existing network infrastructure.</p>
    <p>Traditional auditing is disruptive: Iterating over all password combinations X servers X ports</p>
  </div>
  <div class="page">
    <p>BHR filters malicious connections from the network border</p>
    <p>Non-interactive honeypot</p>
    <p>Attack database</p>
    <p>Continuous Auditor</p>
    <p>Bro netflows</p>
    <p>/16 IP space Blue Waters Science/Industry Data</p>
    <p>External attackers attempts Continuous auditing</p>
    <p>Black Hole Router</p>
    <p>SDN Controller</p>
    <p>X</p>
    <p>Legitimate Users</p>
  </div>
  <div class="page">
    <p>Outline</p>
    <p>Internet-scale measurements of SSH brute-force attacks</p>
    <p>Key enabling techniques of CAUDIT</p>
    <p>Benefits of CAUDIT in operational network</p>
  </div>
  <div class="page">
    <p>BHR reduces attack traffic to internal monitors</p>
    <p>Non-interactive honeypot</p>
    <p>Attack database</p>
    <p>Continuous Auditor</p>
    <p>Bro netflows</p>
    <p>/16 IP space Blue Waters Science/Industry Data</p>
    <p>External attackers attempts Continuous auditing</p>
    <p>Black Hole Router</p>
    <p>SDN Controller</p>
    <p>X 57M connections are dropped daily</p>
    <p>Legitimate Users</p>
  </div>
  <div class="page">
    <p>Date</p>
    <p>C ou nt</p>
    <p>Attacks increased by 300x when the BHR is in maintenance</p>
    <p>Peak during BHR maintenance (21M attempts)</p>
    <p>Median during BHR operational (69K attempts per day)</p>
  </div>
  <div class="page">
    <p>Continuous auditing preempted potential security incidents</p>
    <p>One smart device that repeatedly scanned the internal network for 700 times</p>
    <p>One unsecure DataDirect Network storage device for HPC research data</p>
    <p>Six hosts with weak credentials in the NCSA internal network</p>
  </div>
  <div class="page">
    <p>Future Work</p>
    <p>Extend the SSH honeypot to support other kinds of attacks, e.g., remote code execution</p>
    <p>Evaluate effectiveness of the alert sharing network against attacks coordinated across sites</p>
  </div>
  <div class="page">
    <p>Conclusion</p>
    <p>SSH brute-force attacks can have significant impact on network security infrastructure, however, existing solutions do not work with large-scale networks.</p>
    <p>CAUDIT: Continuous auditing driven by attacker attempts  Honeypot revealed the use of unknown SSH keys and leaked passwords  Continuous auditing preempted several attacks from maturing to incidents  Black hole router successfully blocks 57 million attack attempts on a daily basis  Our data is being shared with partners in an alert sharing network</p>
    <p>Open-sourced, compatible with standard tools, ready to deploy! https://pmcao.github.io/caudit</p>
  </div>
</Presentation>
