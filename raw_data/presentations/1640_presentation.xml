<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Strong and Efficient Consistency with Consistency-Aware Durability</p>
    <p>Aishwarya Ganesan, Ram Alagappan,</p>
    <p>Andrea Arpaci-Dusseau, and Remzi Arpaci-Dusseau</p>
  </div>
  <div class="page">
    <p>Distributed Storage Systems</p>
  </div>
  <div class="page">
    <p>Consistency Models in Distributed Systems</p>
  </div>
  <div class="page">
    <p>Consistency Models in Distributed Systems</p>
    <p>What does a read see given a previous set of reads and writes?</p>
  </div>
  <div class="page">
    <p>Consistency Models in Distributed Systems</p>
    <p>What does a read see given a previous set of reads and writes?</p>
    <p>linearizability strong</p>
  </div>
  <div class="page">
    <p>Consistency Models in Distributed Systems</p>
    <p>What does a read see given a previous set of reads and writes?</p>
    <p>linearizability eventual strong weak</p>
  </div>
  <div class="page">
    <p>Consistency Models in Distributed Systems</p>
    <p>What does a read see given a previous set of reads and writes?</p>
    <p>linearizability eventual</p>
    <p>sequential</p>
    <p>causal+ PRAM</p>
    <p>monotonic</p>
    <p>readscausal strong weak</p>
  </div>
  <div class="page">
    <p>Consistency Models in Distributed Systems</p>
    <p>What does a read see given a previous set of reads and writes?</p>
    <p>linearizability eventual</p>
    <p>sequential</p>
    <p>causal+ PRAM</p>
    <p>monotonic</p>
    <p>readscausal strong weak</p>
    <p>Well studied and understood!</p>
  </div>
  <div class="page">
    <p>Unlike consistency models, scant attention to durability model!</p>
    <p>Durability Models</p>
  </div>
  <div class="page">
    <p>Unlike consistency models, scant attention to durability model!</p>
    <p>How writes are replicated and persisted</p>
    <p>Durability Models</p>
  </div>
  <div class="page">
    <p>Unlike consistency models, scant attention to durability model!</p>
    <p>How writes are replicated and persisted</p>
    <p>Durability model influences consistency</p>
    <p>Durability Models</p>
  </div>
  <div class="page">
    <p>Unlike consistency models, scant attention to durability model!</p>
    <p>How writes are replicated and persisted</p>
    <p>Durability model influences consistency</p>
    <p>Also determines performance</p>
    <p>Durability Models</p>
  </div>
  <div class="page">
    <p>Unlike consistency models, scant attention to durability model!</p>
    <p>How writes are replicated and persisted</p>
    <p>Durability model influences consistency</p>
    <p>Also determines performance</p>
    <p>Durability Models</p>
    <p>Despite this importance, often overlooked!</p>
  </div>
  <div class="page">
    <p>Two Widely Used Durability Models</p>
  </div>
  <div class="page">
    <p>Two Widely Used Durability Models</p>
    <p>Immediate durability</p>
  </div>
  <div class="page">
    <p>Two Widely Used Durability Models</p>
    <p>client</p>
    <p>write</p>
    <p>node-1 node-2 node-3</p>
    <p>Immediate durability</p>
  </div>
  <div class="page">
    <p>Two Widely Used Durability Models</p>
    <p>replicateclient write</p>
    <p>node-1 node-2 node-3</p>
    <p>Immediate durability</p>
  </div>
  <div class="page">
    <p>Two Widely Used Durability Models</p>
    <p>replicate</p>
    <p>persist client</p>
    <p>write</p>
    <p>node-1 node-2 node-3</p>
    <p>Immediate durability fs</p>
    <p>y n c</p>
    <p>fs y n c</p>
    <p>fs y n c</p>
  </div>
  <div class="page">
    <p>Two Widely Used Durability Models</p>
    <p>replicate</p>
    <p>persist client</p>
    <p>write</p>
    <p>node-1 node-2 node-3</p>
    <p>Immediate durability</p>
    <p>ack</p>
    <p>fs y n c</p>
    <p>fs y n c</p>
    <p>fs y n c</p>
  </div>
  <div class="page">
    <p>Two Widely Used Durability Models</p>
    <p>replicate</p>
    <p>persist client</p>
    <p>write</p>
    <p>node-1 node-2 node-3</p>
    <p>Immediate durability</p>
    <p>ack</p>
    <p>enables strong consistency</p>
    <p>but too slow!</p>
    <p>fs y n c</p>
    <p>fs y n c</p>
    <p>fs y n c</p>
  </div>
  <div class="page">
    <p>Two Widely Used Durability Models</p>
    <p>replicate</p>
    <p>persist client</p>
    <p>write</p>
    <p>node-1 node-2 node-3</p>
    <p>Immediate durability</p>
    <p>ack</p>
    <p>enables strong consistency</p>
    <p>but too slow!</p>
    <p>Eventual durability fs</p>
    <p>y n c</p>
    <p>fs y n c</p>
    <p>fs y n c</p>
  </div>
  <div class="page">
    <p>Two Widely Used Durability Models</p>
    <p>replicate</p>
    <p>persist client</p>
    <p>write</p>
    <p>node-1 node-2 node-3</p>
    <p>Immediate durability</p>
    <p>ack</p>
    <p>enables strong consistency</p>
    <p>but too slow!</p>
    <p>client</p>
    <p>write</p>
    <p>node-1 node-2 node-3</p>
    <p>Eventual durability fs</p>
    <p>y n c</p>
    <p>fs y n c</p>
    <p>fs y n c</p>
    <p>ack</p>
  </div>
  <div class="page">
    <p>Two Widely Used Durability Models</p>
    <p>replicate</p>
    <p>persist client</p>
    <p>write</p>
    <p>node-1 node-2 node-3</p>
    <p>Immediate durability</p>
    <p>ack</p>
    <p>enables strong consistency</p>
    <p>but too slow!</p>
    <p>client</p>
    <p>write</p>
    <p>node-1 node-2 node-3</p>
    <p>Eventual durability</p>
    <p>lazily replicate</p>
    <p>and persist</p>
    <p>fs y n c</p>
    <p>fs y n c</p>
    <p>fs y n c</p>
    <p>ack</p>
  </div>
  <div class="page">
    <p>Two Widely Used Durability Models</p>
    <p>replicate</p>
    <p>persist client</p>
    <p>write</p>
    <p>node-1 node-2 node-3</p>
    <p>Immediate durability</p>
    <p>ack</p>
    <p>enables strong consistency</p>
    <p>but too slow!</p>
    <p>client</p>
    <p>write</p>
    <p>node-1 node-2 node-3</p>
    <p>Eventual durability</p>
    <p>fast</p>
    <p>but enables only weak consistency due</p>
    <p>to data loss upon failures!</p>
    <p>lazily replicate</p>
    <p>and persist</p>
    <p>fs y n c</p>
    <p>fs y n c</p>
    <p>fs y n c</p>
    <p>ack</p>
  </div>
  <div class="page">
    <p>Is it possible for a durability layer to enable both strong consistency and</p>
    <p>high performance?</p>
  </div>
  <div class="page">
    <p>CAD: Consistency-aware Durability</p>
  </div>
  <div class="page">
    <p>Design the durability layer by taking the consistency model into account</p>
    <p>CAD: Consistency-aware Durability</p>
  </div>
  <div class="page">
    <p>Design the durability layer by taking the consistency model into account</p>
    <p>Intuition: what a read sees is important for most consistency models</p>
    <p>CAD: Consistency-aware Durability</p>
  </div>
  <div class="page">
    <p>Design the durability layer by taking the consistency model into account</p>
    <p>Intuition: what a read sees is important for most consistency models</p>
    <p>Key idea: CAD shifts the point of durability to reads from writes data is replicated and persisted before a read is served</p>
    <p>CAD: Consistency-aware Durability</p>
  </div>
  <div class="page">
    <p>Design the durability layer by taking the consistency model into account</p>
    <p>Intuition: what a read sees is important for most consistency models</p>
    <p>Key idea: CAD shifts the point of durability to reads from writes data is replicated and persisted before a read is served</p>
    <p>delayed writes  high performance</p>
    <p>CAD: Consistency-aware Durability</p>
  </div>
  <div class="page">
    <p>Design the durability layer by taking the consistency model into account</p>
    <p>Intuition: what a read sees is important for most consistency models</p>
    <p>Key idea: CAD shifts the point of durability to reads from writes data is replicated and persisted before a read is served</p>
    <p>delayed writes  high performance</p>
    <p>data durable before it is read  strong consistency even under failures</p>
    <p>CAD: Consistency-aware Durability</p>
  </div>
  <div class="page">
    <p>Design the durability layer by taking the consistency model into account</p>
    <p>Intuition: what a read sees is important for most consistency models</p>
    <p>Key idea: CAD shifts the point of durability to reads from writes data is replicated and persisted before a read is served</p>
    <p>delayed writes  high performance</p>
    <p>data durable before it is read  strong consistency even under failures</p>
    <p>lose some writes if failures arise before read; but, useful for many systems that use eventual durability</p>
    <p>CAD: Consistency-aware Durability</p>
  </div>
  <div class="page">
    <p>Design the durability layer by taking the consistency model into account</p>
    <p>Intuition: what a read sees is important for most consistency models</p>
    <p>Key idea: CAD shifts the point of durability to reads from writes data is replicated and persisted before a read is served</p>
    <p>delayed writes  high performance</p>
    <p>data durable before it is read  strong consistency even under failures</p>
    <p>lose some writes if failures arise before read; but, useful for many systems that use eventual durability</p>
    <p>We show efficacy of CAD by providing cross-client monotonic reads a new and strong consistency property</p>
    <p>CAD: Consistency-aware Durability</p>
  </div>
  <div class="page">
    <p>Results</p>
  </div>
  <div class="page">
    <p>ORCA: CAD and cross-client monotonic reads for leader-based systems implemented in ZooKeeper</p>
    <p>Results</p>
  </div>
  <div class="page">
    <p>ORCA: CAD and cross-client monotonic reads for leader-based systems implemented in ZooKeeper</p>
    <p>Compared to strongly consistent ZooKeeper ORCA is 1.6  3.3x faster by using CAD</p>
    <p>higher read throughput by allowing reads at many nodes</p>
    <p>reduces latency in geo-distributed settings by 14x</p>
    <p>Results</p>
  </div>
  <div class="page">
    <p>ORCA: CAD and cross-client monotonic reads for leader-based systems implemented in ZooKeeper</p>
    <p>Compared to strongly consistent ZooKeeper ORCA is 1.6  3.3x faster by using CAD</p>
    <p>higher read throughput by allowing reads at many nodes</p>
    <p>reduces latency in geo-distributed settings by 14x</p>
    <p>Compared to weakly consistent ZooKeeper ORCA provides similar throughput and latency</p>
    <p>but with stronger guarantees</p>
    <p>Results</p>
  </div>
  <div class="page">
    <p>ORCA: CAD and cross-client monotonic reads for leader-based systems implemented in ZooKeeper</p>
    <p>Compared to strongly consistent ZooKeeper ORCA is 1.6  3.3x faster by using CAD</p>
    <p>higher read throughput by allowing reads at many nodes</p>
    <p>reduces latency in geo-distributed settings by 14x</p>
    <p>Compared to weakly consistent ZooKeeper ORCA provides similar throughput and latency</p>
    <p>but with stronger guarantees</p>
    <p>Experimentally show ORCAs guarantees under failures, useful for apps</p>
    <p>Results</p>
  </div>
  <div class="page">
    <p>Outline</p>
    <p>Introduction</p>
    <p>Motivation</p>
    <p>CAD and cross-client monotonic reads</p>
    <p>ORCA design</p>
    <p>Results</p>
    <p>Summary and conclusion</p>
  </div>
  <div class="page">
    <p>Consistency Models and Guarantees</p>
    <p>Example: Im bored at FAST and want to go home!</p>
  </div>
  <div class="page">
    <p>Consistency Models and Guarantees</p>
    <p>Example: Im bored at FAST and want to go home!</p>
  </div>
  <div class="page">
    <p>Consistency Models and Guarantees</p>
    <p>Example: Im bored at FAST and want to go home!</p>
  </div>
  <div class="page">
    <p>Consistency Models and Guarantees</p>
    <p>Example: Im bored at FAST and want to go home!</p>
  </div>
  <div class="page">
    <p>Consistency Models and Guarantees</p>
    <p>Example: Im bored at FAST and want to go home!</p>
    <p>Linearizability</p>
  </div>
  <div class="page">
    <p>Consistency Models and Guarantees</p>
    <p>Example: Im bored at FAST and want to go home!</p>
    <p>Linearizability</p>
  </div>
  <div class="page">
    <p>Consistency Models and Guarantees</p>
    <p>Example: Im bored at FAST and want to go home!</p>
    <p>Linearizability</p>
  </div>
  <div class="page">
    <p>Consistency Models and Guarantees</p>
    <p>Example: Im bored at FAST and want to go home!</p>
    <p>Linearizability</p>
    <p>latest data: no staleness</p>
  </div>
  <div class="page">
    <p>Consistency Models and Guarantees</p>
    <p>Example: Im bored at FAST and want to go home!</p>
    <p>Linearizability</p>
    <p>latest data: no staleness</p>
    <p>in-order reads across clients</p>
  </div>
  <div class="page">
    <p>Consistency Models and Guarantees</p>
    <p>Example: Im bored at FAST and want to go home!</p>
    <p>Linearizability</p>
    <p>latest data: no staleness</p>
    <p>in-order reads across clients</p>
    <p>Weaker models</p>
  </div>
  <div class="page">
    <p>Consistency Models and Guarantees</p>
    <p>Example: Im bored at FAST and want to go home!</p>
    <p>Linearizability</p>
    <p>latest data: no staleness</p>
    <p>in-order reads across clients</p>
    <p>Weaker models</p>
  </div>
  <div class="page">
    <p>Consistency Models and Guarantees</p>
    <p>Example: Im bored at FAST and want to go home!</p>
    <p>Linearizability</p>
    <p>latest data: no staleness</p>
    <p>in-order reads across clients</p>
    <p>Weaker models</p>
  </div>
  <div class="page">
    <p>Consistency Models and Guarantees</p>
    <p>Example: Im bored at FAST and want to go home!</p>
    <p>Linearizability</p>
    <p>latest data: no staleness</p>
    <p>in-order reads across clients</p>
    <p>Weaker models</p>
    <p>stale reads</p>
    <p>out-of-order reads across clients</p>
  </div>
  <div class="page">
    <p>Consistency Models and Guarantees</p>
    <p>Example: Im bored at FAST and want to go home!</p>
    <p>Linearizability</p>
    <p>latest data: no staleness</p>
    <p>in-order reads across clients</p>
    <p>Weaker models</p>
    <p>stale reads</p>
    <p>out-of-order reads across clients</p>
    <p>even with monotonic reads and causal</p>
  </div>
  <div class="page">
    <p>Linearizability requires immediate durability must synchronously replicate and persist data on a majority to tolerate failures</p>
    <p>Realizing Strong Consistency</p>
  </div>
  <div class="page">
    <p>Linearizability requires immediate durability must synchronously replicate and persist data on a majority to tolerate failures</p>
    <p>Realizing Strong Consistency</p>
    <p>leader  S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a0</p>
    <p>a0</p>
    <p>a0</p>
    <p>on diskin memory durable = on disk on a majority</p>
  </div>
  <div class="page">
    <p>Linearizability requires immediate durability must synchronously replicate and persist data on a majority to tolerate failures</p>
    <p>Realizing Strong Consistency</p>
    <p>leader  S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a0</p>
    <p>a0</p>
    <p>a0</p>
    <p>on diskin memory durable = on disk on a majority</p>
  </div>
  <div class="page">
    <p>Linearizability requires immediate durability must synchronously replicate and persist data on a majority to tolerate failures</p>
    <p>Realizing Strong Consistency</p>
    <p>leader  S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a0</p>
    <p>a0</p>
    <p>a0</p>
    <p>a1</p>
    <p>on diskin memory durable = on disk on a majority</p>
    <p>a1</p>
    <p>a1</p>
  </div>
  <div class="page">
    <p>Linearizability requires immediate durability must synchronously replicate and persist data on a majority to tolerate failures</p>
    <p>Realizing Strong Consistency</p>
    <p>leader  S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a0</p>
    <p>a0</p>
    <p>a0</p>
    <p>a1</p>
    <p>on diskin memory durable = on disk on a majority</p>
    <p>a1</p>
    <p>a1</p>
    <p>a1</p>
    <p>a1</p>
  </div>
  <div class="page">
    <p>Linearizability requires immediate durability must synchronously replicate and persist data on a majority to tolerate failures</p>
    <p>Realizing Strong Consistency</p>
    <p>leader  S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a0</p>
    <p>a0</p>
    <p>a0</p>
    <p>a1</p>
    <p>on diskin memory durable = on disk on a majority</p>
    <p>a1</p>
    <p>a1</p>
    <p>a1</p>
    <p>a1</p>
  </div>
  <div class="page">
    <p>Linearizability requires immediate durability must synchronously replicate and persist data on a majority to tolerate failures</p>
    <p>Realizing Strong Consistency</p>
    <p>leader  S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a0</p>
    <p>a0</p>
    <p>a0</p>
    <p>a1</p>
    <p>on diskin memory durable = on disk on a majority</p>
    <p>a1</p>
    <p>a1</p>
    <p>a1</p>
    <p>a1</p>
  </div>
  <div class="page">
    <p>Linearizability requires immediate durability must synchronously replicate and persist data on a majority to tolerate failures</p>
    <p>Realizing Strong Consistency</p>
    <p>leader  S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a0</p>
    <p>a0</p>
    <p>a0</p>
    <p>a1</p>
    <p>on diskin memory durable = on disk on a majority</p>
    <p>a1</p>
    <p>a1</p>
    <p>a1</p>
  </div>
  <div class="page">
    <p>Linearizability requires immediate durability must synchronously replicate and persist data on a majority to tolerate failures</p>
    <p>Realizing Strong Consistency</p>
    <p>leader  S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a0</p>
    <p>a0</p>
    <p>a0</p>
    <p>a1</p>
    <p>on diskin memory durable = on disk on a majority</p>
    <p>a1</p>
    <p>a1</p>
    <p>a1</p>
  </div>
  <div class="page">
    <p>Linearizability requires immediate durability must synchronously replicate and persist data on a majority to tolerate failures</p>
    <p>Realizing Strong Consistency</p>
    <p>leader  S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a0</p>
    <p>a0</p>
    <p>a0</p>
    <p>a1</p>
    <p>on diskin memory durable = on disk on a majority</p>
    <p>a1</p>
    <p>a1</p>
    <p>a1</p>
  </div>
  <div class="page">
    <p>Linearizability requires immediate durability must synchronously replicate and persist data on a majority to tolerate failures</p>
    <p>Realizing Strong Consistency</p>
    <p>Poor performance due to synchronous operations 10x slower within data center</p>
    <p>leader  S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a0</p>
    <p>a0</p>
    <p>a0</p>
    <p>a1</p>
    <p>on diskin memory durable = on disk on a majority</p>
    <p>a1</p>
    <p>a1</p>
    <p>a1</p>
  </div>
  <div class="page">
    <p>Weaker models only require eventual durability data buffered on one node, replication and persistence in background</p>
    <p>Realizing Weaker Models</p>
    <p>S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a0</p>
    <p>a0</p>
    <p>a0</p>
  </div>
  <div class="page">
    <p>Weaker models only require eventual durability data buffered on one node, replication and persistence in background</p>
    <p>Realizing Weaker Models</p>
    <p>S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a0</p>
    <p>a0</p>
    <p>a0</p>
    <p>app</p>
    <p>session-1</p>
  </div>
  <div class="page">
    <p>Weaker models only require eventual durability data buffered on one node, replication and persistence in background</p>
    <p>Realizing Weaker Models</p>
    <p>S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a0</p>
    <p>a0</p>
    <p>a0</p>
    <p>a1</p>
    <p>app</p>
    <p>session-1</p>
  </div>
  <div class="page">
    <p>Weaker models only require eventual durability data buffered on one node, replication and persistence in background</p>
    <p>Realizing Weaker Models</p>
    <p>S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a0</p>
    <p>a0</p>
    <p>a0</p>
    <p>a1</p>
    <p>app</p>
    <p>session-1</p>
  </div>
  <div class="page">
    <p>Weaker models only require eventual durability data buffered on one node, replication and persistence in background</p>
    <p>Realizing Weaker Models</p>
    <p>S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a0</p>
    <p>a0</p>
    <p>a0</p>
    <p>a1</p>
    <p>app</p>
    <p>session-1</p>
  </div>
  <div class="page">
    <p>Weaker models only require eventual durability data buffered on one node, replication and persistence in background</p>
    <p>Realizing Weaker Models</p>
    <p>S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a0</p>
    <p>a0</p>
    <p>a0</p>
    <p>app</p>
    <p>session-1</p>
  </div>
  <div class="page">
    <p>Weaker models only require eventual durability data buffered on one node, replication and persistence in background</p>
    <p>Realizing Weaker Models</p>
    <p>S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a0</p>
    <p>a0</p>
    <p>a0</p>
    <p>app</p>
    <p>session-1</p>
    <p>S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a0</p>
    <p>a0</p>
    <p>a0</p>
  </div>
  <div class="page">
    <p>Weaker models only require eventual durability data buffered on one node, replication and persistence in background</p>
    <p>Realizing Weaker Models</p>
    <p>S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a0</p>
    <p>a0</p>
    <p>a0</p>
    <p>app</p>
    <p>session-1</p>
    <p>S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a0</p>
    <p>a0</p>
    <p>a0</p>
    <p>app</p>
    <p>session-2</p>
  </div>
  <div class="page">
    <p>Weaker models only require eventual durability data buffered on one node, replication and persistence in background</p>
    <p>Realizing Weaker Models</p>
    <p>S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a0</p>
    <p>a0</p>
    <p>a0</p>
    <p>app</p>
    <p>session-1</p>
    <p>S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a0</p>
    <p>a0</p>
    <p>a0</p>
    <p>app</p>
    <p>session-2</p>
  </div>
  <div class="page">
    <p>Weaker models only require eventual durability data buffered on one node, replication and persistence in background</p>
    <p>out-of-order across</p>
    <p>clients</p>
    <p>valid under causal and</p>
    <p>monotonic reads</p>
    <p>but confusing semantics</p>
    <p>Realizing Weaker Models</p>
    <p>S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a0</p>
    <p>a0</p>
    <p>a0</p>
    <p>app</p>
    <p>session-1</p>
    <p>S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a0</p>
    <p>a0</p>
    <p>a0</p>
    <p>app</p>
    <p>session-2</p>
  </div>
  <div class="page">
    <p>Weaker models only require eventual durability data buffered on one node, replication and persistence in background</p>
    <p>out-of-order across</p>
    <p>clients</p>
    <p>valid under causal and</p>
    <p>monotonic reads</p>
    <p>but confusing semantics</p>
    <p>Many deployments prefer eventual durability for performance in fact, it is the default (e.g., MongoDB, Redis)</p>
    <p>Realizing Weaker Models</p>
    <p>S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a0</p>
    <p>a0</p>
    <p>a0</p>
    <p>app</p>
    <p>session-1</p>
    <p>S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a0</p>
    <p>a0</p>
    <p>a0</p>
    <p>app</p>
    <p>session-2</p>
  </div>
  <div class="page">
    <p>Weaker models only require eventual durability data buffered on one node, replication and persistence in background</p>
    <p>out-of-order across</p>
    <p>clients</p>
    <p>valid under causal and</p>
    <p>monotonic reads</p>
    <p>but confusing semantics</p>
    <p>Many deployments prefer eventual durability for performance in fact, it is the default (e.g., MongoDB, Redis)</p>
    <p>Thus settle for weak consistency</p>
    <p>Realizing Weaker Models</p>
    <p>S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a0</p>
    <p>a0</p>
    <p>a0</p>
    <p>app</p>
    <p>session-1</p>
    <p>S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a0</p>
    <p>a0</p>
    <p>a0</p>
    <p>app</p>
    <p>session-2</p>
  </div>
  <div class="page">
    <p>Immediate durability enables strong consistency but is slow</p>
    <p>Eventual durability is fast but enables only weaker consistency</p>
  </div>
  <div class="page">
    <p>Outline</p>
    <p>Introduction</p>
    <p>Motivation</p>
    <p>CAD and cross-client monotonic reads</p>
    <p>ORCA design</p>
    <p>Results</p>
    <p>Summary and conclusion</p>
  </div>
  <div class="page">
    <p>Consistency-aware Durability</p>
  </div>
  <div class="page">
    <p>Most consistency models care about what reads see</p>
    <p>Consistency-aware Durability</p>
  </div>
  <div class="page">
    <p>Most consistency models care about what reads see</p>
    <p>Key idea: CAD shifts the point of durability to reads from writes</p>
    <p>Consistency-aware Durability</p>
  </div>
  <div class="page">
    <p>Most consistency models care about what reads see</p>
    <p>Key idea: CAD shifts the point of durability to reads from writes</p>
    <p>Consistency-aware Durability</p>
    <p>delay durability of writes</p>
  </div>
  <div class="page">
    <p>Most consistency models care about what reads see</p>
    <p>Key idea: CAD shifts the point of durability to reads from writes</p>
    <p>Consistency-aware Durability</p>
    <p>client write</p>
    <p>S1 S2 S3</p>
    <p>delay durability of writes</p>
  </div>
  <div class="page">
    <p>Most consistency models care about what reads see</p>
    <p>Key idea: CAD shifts the point of durability to reads from writes</p>
    <p>Consistency-aware Durability</p>
    <p>client write</p>
    <p>S1 S2 S3</p>
    <p>delay durability of writes</p>
  </div>
  <div class="page">
    <p>Most consistency models care about what reads see</p>
    <p>Key idea: CAD shifts the point of durability to reads from writes</p>
    <p>Consistency-aware Durability</p>
    <p>client write</p>
    <p>S1 S2 S3ack</p>
    <p>delay durability of writes</p>
  </div>
  <div class="page">
    <p>Most consistency models care about what reads see</p>
    <p>Key idea: CAD shifts the point of durability to reads from writes</p>
    <p>Consistency-aware Durability</p>
    <p>client write</p>
    <p>S1 S2 S3ack</p>
    <p>delay durability of writes</p>
    <p>good performance</p>
  </div>
  <div class="page">
    <p>Most consistency models care about what reads see</p>
    <p>Key idea: CAD shifts the point of durability to reads from writes</p>
    <p>Consistency-aware Durability</p>
    <p>client write</p>
    <p>S1 S2 S3ack</p>
    <p>delay durability of writes</p>
    <p>good performance</p>
    <p>make data durable before serving reads</p>
  </div>
  <div class="page">
    <p>Most consistency models care about what reads see</p>
    <p>Key idea: CAD shifts the point of durability to reads from writes</p>
    <p>Consistency-aware Durability</p>
    <p>client write</p>
    <p>S1 S2 S3ack</p>
    <p>delay durability of writes</p>
    <p>good performance</p>
    <p>make data durable before serving reads</p>
    <p>client</p>
    <p>S1 S2 S3</p>
    <p>read</p>
  </div>
  <div class="page">
    <p>Most consistency models care about what reads see</p>
    <p>Key idea: CAD shifts the point of durability to reads from writes</p>
    <p>Consistency-aware Durability</p>
    <p>client write</p>
    <p>S1 S2 S3ack</p>
    <p>delay durability of writes</p>
    <p>good performance</p>
    <p>make data durable before serving reads</p>
    <p>client</p>
    <p>S1 S2 S3</p>
    <p>read</p>
  </div>
  <div class="page">
    <p>Most consistency models care about what reads see</p>
    <p>Key idea: CAD shifts the point of durability to reads from writes</p>
    <p>Consistency-aware Durability</p>
    <p>client write</p>
    <p>S1 S2 S3ack</p>
    <p>delay durability of writes</p>
    <p>good performance</p>
    <p>make data durable before serving reads</p>
    <p>client</p>
    <p>S1 S2 S3</p>
    <p>read</p>
  </div>
  <div class="page">
    <p>Most consistency models care about what reads see</p>
    <p>Key idea: CAD shifts the point of durability to reads from writes</p>
    <p>Consistency-aware Durability</p>
    <p>client write</p>
    <p>S1 S2 S3ack</p>
    <p>delay durability of writes</p>
    <p>good performance</p>
    <p>make data durable before serving reads</p>
    <p>client</p>
    <p>S1 S2 S3</p>
    <p>read</p>
  </div>
  <div class="page">
    <p>Most consistency models care about what reads see</p>
    <p>Key idea: CAD shifts the point of durability to reads from writes</p>
    <p>Consistency-aware Durability</p>
    <p>client write</p>
    <p>S1 S2 S3ack</p>
    <p>delay durability of writes</p>
    <p>good performance</p>
    <p>make data durable before serving reads</p>
    <p>client</p>
    <p>S1 S2 S3</p>
    <p>prevents out-of-order data across failures</p>
    <p>strong consistency</p>
    <p>read</p>
  </div>
  <div class="page">
    <p>Most consistency models care about what reads see</p>
    <p>Key idea: CAD shifts the point of durability to reads from writes</p>
    <p>Consistency-aware Durability</p>
    <p>client write</p>
    <p>S1 S2 S3ack</p>
    <p>delay durability of writes</p>
    <p>CAD does not always incur overheads on reads reads do not immediately follow writes  natural in many workloads</p>
    <p>common case: data already durable well before applications access it</p>
    <p>good performance</p>
    <p>make data durable before serving reads</p>
    <p>client</p>
    <p>S1 S2 S3</p>
    <p>prevents out-of-order data across failures</p>
    <p>strong consistency</p>
    <p>read</p>
  </div>
  <div class="page">
    <p>Cross-client Monotonic Reads upon CAD</p>
  </div>
  <div class="page">
    <p>Cross-client Monotonic Reads upon CAD</p>
    <p>A read from a client guaranteed to return at least the latest state returned to a previous read from any client</p>
  </div>
  <div class="page">
    <p>Cross-client Monotonic Reads upon CAD</p>
    <p>A read from a client guaranteed to return at least the latest state returned to a previous read from any client</p>
    <p>a0 a1 a2</p>
  </div>
  <div class="page">
    <p>Cross-client Monotonic Reads upon CAD</p>
    <p>A read from a client guaranteed to return at least the latest state returned to a previous read from any client</p>
    <p>a0 a1</p>
    <p>client-1 a2</p>
    <p>a2</p>
  </div>
  <div class="page">
    <p>Cross-client Monotonic Reads upon CAD</p>
    <p>A read from a client guaranteed to return at least the latest state returned to a previous read from any client</p>
    <p>a0 a1</p>
    <p>client-1 a2</p>
    <p>client-2 a2</p>
    <p>a2</p>
  </div>
  <div class="page">
    <p>Cross-client Monotonic Reads upon CAD</p>
    <p>A read from a client guaranteed to return at least the latest state returned to a previous read from any client</p>
    <p>a0 a1</p>
    <p>client-1 a2</p>
    <p>client-2 a2</p>
    <p>Even in the presence of failures and</p>
    <p>across client sessionsa2</p>
  </div>
  <div class="page">
    <p>Cross-client Monotonic Reads upon CAD</p>
    <p>A read from a client guaranteed to return at least the latest state returned to a previous read from any client</p>
    <p>a0 a1</p>
    <p>client-1 a2</p>
    <p>client-2 a2</p>
    <p>Even in the presence of failures and</p>
    <p>across client sessions</p>
    <p>No existing model provides this</p>
    <p>guarantee except linearizability but not</p>
    <p>with high performance</p>
    <p>a2</p>
  </div>
  <div class="page">
    <p>Cross-client Monotonic Reads upon CAD</p>
    <p>A read from a client guaranteed to return at least the latest state returned to a previous read from any client</p>
    <p>a0 a1</p>
    <p>client-1 a2</p>
    <p>client-2 a2</p>
    <p>Even in the presence of failures and</p>
    <p>across client sessions</p>
    <p>No existing model provides this</p>
    <p>guarantee except linearizability but not</p>
    <p>with high performance</p>
    <p>CAD enables this property with high</p>
    <p>performance</p>
    <p>a2</p>
  </div>
  <div class="page">
    <p>Cross-client Monotonic Reads upon CAD</p>
    <p>A read from a client guaranteed to return at least the latest state returned to a previous read from any client</p>
    <p>a0 a1</p>
    <p>client-1 a2</p>
    <p>client-2 a2</p>
    <p>Even in the presence of failures and</p>
    <p>across client sessions</p>
    <p>No existing model provides this</p>
    <p>guarantee except linearizability but not</p>
    <p>with high performance</p>
    <p>CAD enables this property with high</p>
    <p>performance</p>
    <p>Does not prevent staleness like many weaker models</p>
    <p>a2</p>
  </div>
  <div class="page">
    <p>Cross-client Monotonic Reads upon CAD</p>
    <p>A read from a client guaranteed to return at least the latest state returned to a previous read from any client</p>
    <p>a0 a1</p>
    <p>client-1 a2</p>
    <p>client-2 a2</p>
    <p>Even in the presence of failures and</p>
    <p>across client sessions</p>
    <p>No existing model provides this</p>
    <p>guarantee except linearizability but not</p>
    <p>with high performance</p>
    <p>CAD enables this property with high</p>
    <p>performance</p>
    <p>Does not prevent staleness like many weaker models</p>
    <p>However, avoids out-of-order data, useful in many app scenarios e.g., location-sharing, twitter timelines</p>
    <p>a2</p>
  </div>
  <div class="page">
    <p>Outline</p>
    <p>Introduction</p>
    <p>Motivation</p>
    <p>CAD and cross-client monotonic reads</p>
    <p>ORCA design</p>
    <p>Results</p>
    <p>Summary and conclusion</p>
  </div>
  <div class="page">
    <p>ORCA</p>
  </div>
  <div class="page">
    <p>ORCA</p>
    <p>Implementation of consistency-aware durability and cross-client monotonic reads in leader-based majority systems</p>
  </div>
  <div class="page">
    <p>ORCA</p>
    <p>Implementation of consistency-aware durability and cross-client monotonic reads in leader-based majority systems</p>
    <p>Leader-based systems (e.g., MongoDB, ZooKeeper) leader  a dedicated node</p>
    <p>others are followers</p>
    <p>writes flow through leader, establishes a single order</p>
  </div>
  <div class="page">
    <p>ORCA</p>
    <p>Implementation of consistency-aware durability and cross-client monotonic reads in leader-based majority systems</p>
    <p>Leader-based systems (e.g., MongoDB, ZooKeeper) leader  a dedicated node</p>
    <p>others are followers</p>
    <p>writes flow through leader, establishes a single order</p>
    <p>Majority data is safe when persisted on majority nodes (e.g., 3 out of 5 servers)</p>
  </div>
  <div class="page">
    <p>ORCA Write Path</p>
  </div>
  <div class="page">
    <p>ORCA Write Path</p>
    <p>Same as an eventually durable system</p>
    <p>leader  S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a0 on diskin memory durable = on disk on a majority</p>
  </div>
  <div class="page">
    <p>ORCA Write Path</p>
    <p>Same as an eventually durable system</p>
    <p>leader  S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a0 on diskin memory durable = on disk on a majority</p>
  </div>
  <div class="page">
    <p>ORCA Write Path</p>
    <p>Same as an eventually durable system</p>
    <p>leader  S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>b</p>
    <p>a0 on diskin memory durable = on disk on a majority</p>
  </div>
  <div class="page">
    <p>ORCA Write Path</p>
    <p>Same as an eventually durable system</p>
    <p>leader  S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>b</p>
    <p>a0 on diskin memory durable = on disk on a majority</p>
  </div>
  <div class="page">
    <p>ORCA Write Path</p>
    <p>Same as an eventually durable system</p>
    <p>replication and persistence in background</p>
    <p>leader  S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>b</p>
    <p>a0 on diskin memory durable = on disk on a majority</p>
    <p>b</p>
    <p>b</p>
  </div>
  <div class="page">
    <p>ORCA Write Path</p>
    <p>Same as an eventually durable system</p>
    <p>replication and persistence in background</p>
    <p>leader  S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>b</p>
    <p>a0 on diskin memory durable = on disk on a majority</p>
    <p>b</p>
    <p>b</p>
    <p>b</p>
    <p>b</p>
    <p>b</p>
  </div>
  <div class="page">
    <p>ORCA Read Path</p>
    <p>on disk</p>
    <p>in memory</p>
    <p>durable = on disk on</p>
    <p>a majority</p>
    <p>leader  S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>b</p>
  </div>
  <div class="page">
    <p>ORCA Read Path</p>
    <p>on disk</p>
    <p>in memory</p>
    <p>durable = on disk on</p>
    <p>a majority</p>
    <p>leader  S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>b</p>
  </div>
  <div class="page">
    <p>ORCA Read Path</p>
    <p>on disk</p>
    <p>in memory</p>
    <p>durable = on disk on</p>
    <p>a majority</p>
    <p>Durable-index  index of the latest durable item in the system</p>
    <p>leader  S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>b</p>
  </div>
  <div class="page">
    <p>ORCA Read Path</p>
    <p>on disk</p>
    <p>in memory</p>
    <p>durable = on disk on</p>
    <p>a majority</p>
    <p>Durable-index  index of the latest durable item in the system Update-index of item i -- index of the last update that modified i</p>
    <p>leader  S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>b</p>
  </div>
  <div class="page">
    <p>ORCA Read Path</p>
    <p>on disk</p>
    <p>in memory</p>
    <p>durable = on disk on</p>
    <p>a majority</p>
    <p>Durable-index  index of the latest durable item in the system Update-index of item i -- index of the last update that modified i Durability check  i durable if update-index of i  durable-index of system</p>
    <p>leader  S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>b</p>
  </div>
  <div class="page">
    <p>ORCA Read Path</p>
    <p>durable-index:1</p>
    <p>as update-index:1</p>
    <p>a is durable</p>
    <p>on disk</p>
    <p>in memory</p>
    <p>durable = on disk on</p>
    <p>a majority</p>
    <p>Durable-index  index of the latest durable item in the system Update-index of item i -- index of the last update that modified i Durability check  i durable if update-index of i  durable-index of system</p>
    <p>leader  S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>b</p>
  </div>
  <div class="page">
    <p>ORCA Read Path</p>
    <p>durable-index:1</p>
    <p>as update-index:1</p>
    <p>a is durable</p>
    <p>serve read immediately on disk</p>
    <p>in memory</p>
    <p>durable = on disk on</p>
    <p>a majority</p>
    <p>Durable-index  index of the latest durable item in the system Update-index of item i -- index of the last update that modified i Durability check  i durable if update-index of i  durable-index of system</p>
    <p>leader  S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>b</p>
  </div>
  <div class="page">
    <p>ORCA Read Path</p>
    <p>durable-index:1</p>
    <p>as update-index:1</p>
    <p>a is durable</p>
    <p>serve read immediately on disk</p>
    <p>in memory</p>
    <p>durable = on disk on</p>
    <p>a majority</p>
    <p>Durable-index  index of the latest durable item in the system Update-index of item i -- index of the last update that modified i Durability check  i durable if update-index of i  durable-index of system</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>bleader  S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>b</p>
  </div>
  <div class="page">
    <p>ORCA Read Path</p>
    <p>durable-index:1</p>
    <p>as update-index:1</p>
    <p>a is durable</p>
    <p>serve read immediately</p>
    <p>durable-index:1</p>
    <p>bs update-index: 2</p>
    <p>b is not durable</p>
    <p>on disk</p>
    <p>in memory</p>
    <p>durable = on disk on</p>
    <p>a majority</p>
    <p>Durable-index  index of the latest durable item in the system Update-index of item i -- index of the last update that modified i Durability check  i durable if update-index of i  durable-index of system</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>bleader  S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>b</p>
  </div>
  <div class="page">
    <p>ORCA Read Path</p>
    <p>durable-index:1</p>
    <p>as update-index:1</p>
    <p>a is durable</p>
    <p>serve read immediately</p>
    <p>durable-index:1</p>
    <p>bs update-index: 2</p>
    <p>b is not durable</p>
    <p>make b durable before serving</p>
    <p>on disk</p>
    <p>in memory</p>
    <p>durable = on disk on</p>
    <p>a majority</p>
    <p>Durable-index  index of the latest durable item in the system Update-index of item i -- index of the last update that modified i Durability check  i durable if update-index of i  durable-index of system</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>bleader  S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>b</p>
  </div>
  <div class="page">
    <p>ORCA Read Path</p>
    <p>durable-index:1</p>
    <p>as update-index:1</p>
    <p>a is durable</p>
    <p>serve read immediately</p>
    <p>durable-index:1</p>
    <p>bs update-index: 2</p>
    <p>b is not durable</p>
    <p>make b durable before serving</p>
    <p>on disk</p>
    <p>in memory</p>
    <p>durable = on disk on</p>
    <p>a majority</p>
    <p>Durable-index  index of the latest durable item in the system Update-index of item i -- index of the last update that modified i Durability check  i durable if update-index of i  durable-index of system</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>bleader  S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>b</p>
    <p>b</p>
    <p>b</p>
  </div>
  <div class="page">
    <p>ORCA Read Path</p>
    <p>durable-index:1</p>
    <p>as update-index:1</p>
    <p>a is durable</p>
    <p>serve read immediately</p>
    <p>durable-index:1</p>
    <p>bs update-index: 2</p>
    <p>b is not durable</p>
    <p>make b durable before serving</p>
    <p>on disk</p>
    <p>in memory</p>
    <p>durable = on disk on</p>
    <p>a majority</p>
    <p>Durable-index  index of the latest durable item in the system Update-index of item i -- index of the last update that modified i Durability check  i durable if update-index of i  durable-index of system</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>bleader  S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>b</p>
    <p>b</p>
    <p>b</p>
    <p>b</p>
    <p>b</p>
    <p>b</p>
  </div>
  <div class="page">
    <p>ORCA Read Path</p>
    <p>durable-index:1</p>
    <p>as update-index:1</p>
    <p>a is durable</p>
    <p>serve read immediately</p>
    <p>durable-index:1</p>
    <p>bs update-index: 2</p>
    <p>b is not durable</p>
    <p>make b durable before serving</p>
    <p>on disk</p>
    <p>in memory</p>
    <p>durable = on disk on</p>
    <p>a majority</p>
    <p>Durable-index  index of the latest durable item in the system Update-index of item i -- index of the last update that modified i Durability check  i durable if update-index of i  durable-index of system</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>bleader  S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>b</p>
    <p>b</p>
    <p>b</p>
    <p>b</p>
    <p>b</p>
    <p>b</p>
  </div>
  <div class="page">
    <p>ORCA Read Path</p>
    <p>durable-index:1</p>
    <p>as update-index:1</p>
    <p>a is durable</p>
    <p>serve read immediately</p>
    <p>durable-index:1</p>
    <p>bs update-index: 2</p>
    <p>b is not durable</p>
    <p>make b durable before serving</p>
    <p>on disk</p>
    <p>in memory</p>
    <p>durable = on disk on</p>
    <p>a majority</p>
    <p>Durable-index  index of the latest durable item in the system Update-index of item i -- index of the last update that modified i Durability check  i durable if update-index of i  durable-index of system</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>bleader  S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>b</p>
    <p>b</p>
    <p>b</p>
    <p>b</p>
    <p>b</p>
    <p>b</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>b</p>
    <p>b</p>
    <p>b</p>
    <p>b</p>
    <p>b</p>
    <p>b</p>
  </div>
  <div class="page">
    <p>ORCA Read Path</p>
    <p>durable-index:1</p>
    <p>as update-index:1</p>
    <p>a is durable</p>
    <p>serve read immediately</p>
    <p>durable-index:1</p>
    <p>bs update-index: 2</p>
    <p>b is not durable</p>
    <p>make b durable before serving</p>
    <p>on disk</p>
    <p>in memory</p>
    <p>durable = on disk on</p>
    <p>a majority</p>
    <p>Durable-index  index of the latest durable item in the system Update-index of item i -- index of the last update that modified i Durability check  i durable if update-index of i  durable-index of system</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>bleader  S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>b</p>
    <p>b</p>
    <p>b</p>
    <p>b</p>
    <p>b</p>
    <p>b</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>b</p>
    <p>b</p>
    <p>b</p>
    <p>b</p>
    <p>b</p>
    <p>b</p>
  </div>
  <div class="page">
    <p>ORCA Read Path</p>
    <p>durable-index:1</p>
    <p>as update-index:1</p>
    <p>a is durable</p>
    <p>serve read immediately</p>
    <p>durable-index:1</p>
    <p>bs update-index: 2</p>
    <p>b is not durable</p>
    <p>make b durable before serving</p>
    <p>on disk</p>
    <p>in memory</p>
    <p>durable = on disk on</p>
    <p>a majority</p>
    <p>Durable-index  index of the latest durable item in the system Update-index of item i -- index of the last update that modified i Durability check  i durable if update-index of i  durable-index of system</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>bleader  S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>b</p>
    <p>b</p>
    <p>b</p>
    <p>b</p>
    <p>b</p>
    <p>b</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>b</p>
    <p>b</p>
    <p>b</p>
    <p>b</p>
    <p>b</p>
    <p>b</p>
    <p>leader  S2</p>
  </div>
  <div class="page">
    <p>ORCA Read Path</p>
    <p>durable-index:1</p>
    <p>as update-index:1</p>
    <p>a is durable</p>
    <p>serve read immediately</p>
    <p>durable-index:1</p>
    <p>bs update-index: 2</p>
    <p>b is not durable</p>
    <p>make b durable before serving</p>
    <p>on disk</p>
    <p>in memory</p>
    <p>durable = on disk on</p>
    <p>a majority</p>
    <p>Durable-index  index of the latest durable item in the system Update-index of item i -- index of the last update that modified i Durability check  i durable if update-index of i  durable-index of system</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>bleader  S1</p>
    <p>S2</p>
    <p>S3</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>b</p>
    <p>b</p>
    <p>b</p>
    <p>b</p>
    <p>b</p>
    <p>b</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>b</p>
    <p>b</p>
    <p>b</p>
    <p>b</p>
    <p>b</p>
    <p>b</p>
    <p>leader  S2</p>
  </div>
  <div class="page">
    <p>Cross-Client Monotonic Reads in ORCA</p>
  </div>
  <div class="page">
    <p>Cross-Client Monotonic Reads in ORCA</p>
    <p>If reads restricted to leader, CAD provides cross-client monotonic reads</p>
  </div>
  <div class="page">
    <p>Cross-Client Monotonic Reads in ORCA</p>
    <p>If reads restricted to leader, CAD provides cross-client monotonic reads not scalable</p>
  </div>
  <div class="page">
    <p>Cross-Client Monotonic Reads in ORCA</p>
    <p>If reads restricted to leader, CAD provides cross-client monotonic reads not scalable</p>
    <p>Allow reads at followers lagging followers could cause out-of-order states, CAD is not sufficient</p>
  </div>
  <div class="page">
    <p>Cross-Client Monotonic Reads in ORCA</p>
    <p>If reads restricted to leader, CAD provides cross-client monotonic reads not scalable</p>
    <p>Allow reads at followers lagging followers could cause out-of-order states, CAD is not sufficient</p>
    <p>a1 a2</p>
    <p>a1</p>
    <p>a1</p>
    <p>a1</p>
    <p>a1</p>
    <p>leader  S1</p>
    <p>S5</p>
    <p>S2</p>
    <p>S3</p>
    <p>S4</p>
  </div>
  <div class="page">
    <p>Cross-Client Monotonic Reads in ORCA</p>
    <p>If reads restricted to leader, CAD provides cross-client monotonic reads not scalable</p>
    <p>Allow reads at followers lagging followers could cause out-of-order states, CAD is not sufficient</p>
    <p>a1 a2</p>
    <p>a1</p>
    <p>a1</p>
    <p>a1</p>
    <p>a1</p>
    <p>leader  S1</p>
    <p>S5</p>
    <p>S2</p>
    <p>S3</p>
    <p>S4</p>
  </div>
  <div class="page">
    <p>Cross-Client Monotonic Reads in ORCA</p>
    <p>If reads restricted to leader, CAD provides cross-client monotonic reads not scalable</p>
    <p>Allow reads at followers lagging followers could cause out-of-order states, CAD is not sufficient</p>
    <p>a1 a2</p>
    <p>a1</p>
    <p>a1</p>
    <p>a1</p>
    <p>a1</p>
    <p>leader  S1</p>
    <p>S5</p>
    <p>S2</p>
    <p>S3</p>
    <p>S4</p>
  </div>
  <div class="page">
    <p>Cross-Client Monotonic Reads in ORCA</p>
    <p>If reads restricted to leader, CAD provides cross-client monotonic reads not scalable</p>
    <p>Allow reads at followers lagging followers could cause out-of-order states, CAD is not sufficient</p>
    <p>a1 a2</p>
    <p>a1</p>
    <p>a1</p>
    <p>a1</p>
    <p>a1</p>
    <p>a2</p>
    <p>a2</p>
    <p>a2</p>
    <p>a2</p>
    <p>leader  S1</p>
    <p>S5</p>
    <p>S2</p>
    <p>S3</p>
    <p>S4</p>
  </div>
  <div class="page">
    <p>Cross-Client Monotonic Reads in ORCA</p>
    <p>If reads restricted to leader, CAD provides cross-client monotonic reads not scalable</p>
    <p>Allow reads at followers lagging followers could cause out-of-order states, CAD is not sufficient</p>
    <p>a1 a2</p>
    <p>a1</p>
    <p>a1</p>
    <p>a1</p>
    <p>a1</p>
    <p>a2</p>
    <p>a2</p>
    <p>a2</p>
    <p>a2</p>
    <p>leader  S1</p>
    <p>S5</p>
    <p>S2</p>
    <p>S3</p>
    <p>S4</p>
  </div>
  <div class="page">
    <p>Cross-Client Monotonic Reads in ORCA</p>
    <p>If reads restricted to leader, CAD provides cross-client monotonic reads not scalable</p>
    <p>Allow reads at followers lagging followers could cause out-of-order states, CAD is not sufficient</p>
    <p>a1 a2</p>
    <p>a1</p>
    <p>a1</p>
    <p>a1</p>
    <p>a1</p>
    <p>a2</p>
    <p>a2</p>
    <p>a2</p>
    <p>a2</p>
    <p>leader  S1</p>
    <p>S5</p>
    <p>S2</p>
    <p>S3</p>
    <p>S4</p>
  </div>
  <div class="page">
    <p>Cross-Client Monotonic Reads in ORCA</p>
    <p>If reads restricted to leader, CAD provides cross-client monotonic reads not scalable</p>
    <p>Allow reads at followers lagging followers could cause out-of-order states, CAD is not sufficient</p>
    <p>a1 a2</p>
    <p>a1</p>
    <p>a1</p>
    <p>a1</p>
    <p>a1</p>
    <p>a2</p>
    <p>a2</p>
    <p>a2</p>
    <p>a2</p>
    <p>a1 b</p>
    <p>a1</p>
    <p>a1</p>
    <p>a1</p>
    <p>a1</p>
    <p>a2</p>
    <p>a2</p>
    <p>a2</p>
    <p>a2</p>
    <p>leader  S1</p>
    <p>S5</p>
    <p>S2</p>
    <p>S3</p>
    <p>S4</p>
  </div>
  <div class="page">
    <p>Cross-Client Monotonic Reads in ORCA</p>
    <p>If reads restricted to leader, CAD provides cross-client monotonic reads not scalable</p>
    <p>Allow reads at followers lagging followers could cause out-of-order states, CAD is not sufficient</p>
    <p>a1 a2</p>
    <p>a1</p>
    <p>a1</p>
    <p>a1</p>
    <p>a1</p>
    <p>a2</p>
    <p>a2</p>
    <p>a2</p>
    <p>a2</p>
    <p>a1 b</p>
    <p>a1</p>
    <p>a1</p>
    <p>a1</p>
    <p>a1</p>
    <p>a2</p>
    <p>a2</p>
    <p>a2</p>
    <p>a2</p>
    <p>leader  S1</p>
    <p>S5</p>
    <p>S2</p>
    <p>S3</p>
    <p>S4</p>
  </div>
  <div class="page">
    <p>Cross-Client Monotonic Reads in ORCA</p>
    <p>If reads restricted to leader, CAD provides cross-client monotonic reads not scalable</p>
    <p>Allow reads at followers lagging followers could cause out-of-order states, CAD is not sufficient</p>
    <p>a1 a2</p>
    <p>a1</p>
    <p>a1</p>
    <p>a1</p>
    <p>a1</p>
    <p>a2</p>
    <p>a2</p>
    <p>a2</p>
    <p>a2</p>
    <p>a1 b</p>
    <p>a1</p>
    <p>a1</p>
    <p>a1</p>
    <p>a1</p>
    <p>a2</p>
    <p>a2</p>
    <p>a2</p>
    <p>a2</p>
    <p>leader  S1</p>
    <p>S5</p>
    <p>S2</p>
    <p>S3</p>
    <p>S4</p>
  </div>
  <div class="page">
    <p>Cross-Client Monotonic Reads in ORCA</p>
    <p>If reads restricted to leader, CAD provides cross-client monotonic reads not scalable</p>
    <p>Allow reads at followers lagging followers could cause out-of-order states, CAD is not sufficient</p>
    <p>a1 a2</p>
    <p>a1</p>
    <p>a1</p>
    <p>a1</p>
    <p>a1</p>
    <p>a2</p>
    <p>a2</p>
    <p>a2</p>
    <p>a2</p>
    <p>a1 b</p>
    <p>a1</p>
    <p>a1</p>
    <p>a1</p>
    <p>a1</p>
    <p>a2</p>
    <p>a2</p>
    <p>a2</p>
    <p>a2</p>
    <p>leader  S1</p>
    <p>S5</p>
    <p>S2</p>
    <p>S3</p>
    <p>S4</p>
  </div>
  <div class="page">
    <p>Cross-Client Monotonic Reads in ORCA</p>
    <p>If reads restricted to leader, CAD provides cross-client monotonic reads not scalable</p>
    <p>Allow reads at followers lagging followers could cause out-of-order states, CAD is not sufficient</p>
    <p>a1 a2</p>
    <p>a1</p>
    <p>a1</p>
    <p>a1</p>
    <p>a1</p>
    <p>a2</p>
    <p>a2</p>
    <p>a2</p>
    <p>a2</p>
    <p>a1 b</p>
    <p>a1</p>
    <p>a1</p>
    <p>a1</p>
    <p>a1</p>
    <p>a2</p>
    <p>a2</p>
    <p>a2</p>
    <p>a2</p>
    <p>leader  S1</p>
    <p>S5</p>
    <p>S2</p>
    <p>S3</p>
    <p>S4</p>
    <p>Additional mechanisms: Active sets (lease-based mechanism), not in this talk</p>
  </div>
  <div class="page">
    <p>Outline</p>
    <p>Introduction</p>
    <p>Motivation</p>
    <p>CAD and cross-client monotonic reads</p>
    <p>ORCA design</p>
    <p>Results</p>
    <p>Summary and conclusion</p>
  </div>
  <div class="page">
    <p>Evaluation</p>
  </div>
  <div class="page">
    <p>Evaluation</p>
    <p>Implemented in ZooKeeper</p>
  </div>
  <div class="page">
    <p>Evaluation</p>
    <p>Implemented in ZooKeeper</p>
    <p>Evaluate different durability models in isolation compare CAD against immediate and eventual durability</p>
  </div>
  <div class="page">
    <p>Evaluation</p>
    <p>Implemented in ZooKeeper</p>
    <p>Evaluate different durability models in isolation compare CAD against immediate and eventual durability</p>
    <p>Evaluate overall system performance ORCA against strong and weakly consistent ZooKeeper</p>
  </div>
  <div class="page">
    <p>CAD Durability Layer Performance</p>
  </div>
  <div class="page">
    <p>CAD Durability Layer Performance</p>
    <p>YCSB-A: 50% W, 50% R</p>
  </div>
  <div class="page">
    <p>CAD Durability Layer Performance</p>
    <p>YCSB-A: 50% W, 50% R</p>
    <p>C D</p>
    <p>F</p>
    <p>Latency (us)</p>
    <p>Write Latency Distribution</p>
    <p>immediate eventual cad</p>
  </div>
  <div class="page">
    <p>CAD Durability Layer Performance</p>
    <p>YCSB-A: 50% W, 50% R</p>
    <p>C D</p>
    <p>F</p>
    <p>Latency (us)</p>
    <p>Write Latency Distribution</p>
    <p>immediate eventual cad</p>
  </div>
  <div class="page">
    <p>CAD Durability Layer Performance</p>
    <p>YCSB-A: 50% W, 50% R</p>
    <p>CAD writes faster than immediate durability</p>
    <p>CAD matches performance of eventual</p>
    <p>C D</p>
    <p>F</p>
    <p>Latency (us)</p>
    <p>Write Latency Distribution</p>
    <p>immediate eventual cad</p>
  </div>
  <div class="page">
    <p>CAD Durability Layer Performance</p>
    <p>YCSB-A: 50% W, 50% R</p>
    <p>CAD writes faster than immediate durability</p>
    <p>CAD matches performance of eventual</p>
    <p>C D</p>
    <p>F</p>
    <p>Latency (us)</p>
    <p>Write Latency Distribution</p>
    <p>immediate eventual cad</p>
    <p>C D</p>
    <p>F</p>
    <p>Latency (us)</p>
    <p>Read Latency Distribution</p>
    <p>immediate eventual cad</p>
  </div>
  <div class="page">
    <p>CAD Durability Layer Performance</p>
    <p>YCSB-A: 50% W, 50% R</p>
    <p>CAD writes faster than immediate durability</p>
    <p>CAD matches performance of eventual</p>
    <p>C D</p>
    <p>F</p>
    <p>Latency (us)</p>
    <p>Write Latency Distribution</p>
    <p>immediate eventual cad</p>
    <p>C D</p>
    <p>F</p>
    <p>Latency (us)</p>
    <p>Read Latency Distribution</p>
    <p>immediate eventual cad</p>
  </div>
  <div class="page">
    <p>CAD Durability Layer Performance</p>
    <p>YCSB-A: 50% W, 50% R</p>
    <p>CAD writes faster than immediate durability</p>
    <p>CAD matches performance of eventual</p>
    <p>C D</p>
    <p>F</p>
    <p>Latency (us)</p>
    <p>Write Latency Distribution</p>
    <p>immediate eventual cad</p>
    <p>C D</p>
    <p>F</p>
    <p>Latency (us)</p>
    <p>Read Latency Distribution</p>
    <p>immediate eventual cad</p>
    <p>reads queued</p>
    <p>behind writes</p>
  </div>
  <div class="page">
    <p>CAD Durability Layer Performance</p>
    <p>YCSB-A: 50% W, 50% R</p>
    <p>CAD writes faster than immediate durability</p>
    <p>CAD matches performance of eventual</p>
    <p>C D</p>
    <p>F</p>
    <p>Latency (us)</p>
    <p>Write Latency Distribution</p>
    <p>immediate eventual cad</p>
    <p>C D</p>
    <p>F</p>
    <p>Latency (us)</p>
    <p>Read Latency Distribution</p>
    <p>immediate eventual cad</p>
    <p>Most reads in CAD fast</p>
    <p>Only 5% slow due to synchronous ops</p>
    <p>reads queued</p>
    <p>behind writes</p>
  </div>
  <div class="page">
    <p>CAD Durability Layer Performance</p>
    <p>YCSB-A: 50% W, 50% R</p>
    <p>CAD writes faster than immediate durability</p>
    <p>CAD matches performance of eventual</p>
    <p>C D</p>
    <p>F</p>
    <p>Latency (us)</p>
    <p>Write Latency Distribution</p>
    <p>immediate eventual cad</p>
    <p>C D</p>
    <p>F</p>
    <p>Latency (us)</p>
    <p>Read Latency Distribution</p>
    <p>immediate eventual cad</p>
    <p>Most reads in CAD fast</p>
    <p>Only 5% slow due to synchronous ops</p>
    <p>reads queued</p>
    <p>behind writes</p>
    <p>CAD performs similar to eventual and is faster than immediate</p>
  </div>
  <div class="page">
    <p>ORCA System Performance</p>
    <p>Strong-ZK  uses immediate durability, reads only at leader</p>
    <p>Weak-ZK  uses eventual durability, reads at many nodes</p>
    <p>ORCA  uses CAD, reads at many nodes</p>
  </div>
  <div class="page">
    <p>ORCA System Performance</p>
    <p>A B D F</p>
    <p>T h ro</p>
    <p>u g h p u t</p>
    <p>(K O</p>
    <p>p s/</p>
    <p>s)</p>
    <p>strong-ZK weak-ZK orca</p>
    <p>Strong-ZK  uses immediate durability, reads only at leader</p>
    <p>Weak-ZK  uses eventual durability, reads at many nodes</p>
    <p>ORCA  uses CAD, reads at many nodes</p>
  </div>
  <div class="page">
    <p>ORCA System Performance</p>
    <p>A B D F</p>
    <p>T h ro</p>
    <p>u g h p u t</p>
    <p>(K O</p>
    <p>p s/</p>
    <p>s)</p>
    <p>strong-ZK weak-ZK orca</p>
    <p>Strong-ZK performs poorly due to immediate durability and leader-restricted reads</p>
    <p>Strong-ZK  uses immediate durability, reads only at leader</p>
    <p>Weak-ZK  uses eventual durability, reads at many nodes</p>
    <p>ORCA  uses CAD, reads at many nodes</p>
  </div>
  <div class="page">
    <p>ORCA System Performance</p>
    <p>A B D F</p>
    <p>T h ro</p>
    <p>u g h p u t</p>
    <p>(K O</p>
    <p>p s/</p>
    <p>s)</p>
    <p>strong-ZK weak-ZK orca</p>
    <p>Strong-ZK performs poorly due to immediate durability and leader-restricted reads</p>
    <p>Weak-ZK performs well due to eventual durability and scalable reads</p>
    <p>Strong-ZK  uses immediate durability, reads only at leader</p>
    <p>Weak-ZK  uses eventual durability, reads at many nodes</p>
    <p>ORCA  uses CAD, reads at many nodes</p>
  </div>
  <div class="page">
    <p>ORCA System Performance</p>
    <p>A B D F</p>
    <p>T h ro</p>
    <p>u g h p u t</p>
    <p>(K O</p>
    <p>p s/</p>
    <p>s)</p>
    <p>strong-ZK weak-ZK orca</p>
    <p>Strong-ZK performs poorly due to immediate durability and leader-restricted reads</p>
    <p>Weak-ZK performs well due to eventual durability and scalable reads</p>
    <p>ORCA adds little overheads compared to weak-ZK</p>
    <p>reads that access non-durable data</p>
    <p>Strong-ZK  uses immediate durability, reads only at leader</p>
    <p>Weak-ZK  uses eventual durability, reads at many nodes</p>
    <p>ORCA  uses CAD, reads at many nodes</p>
  </div>
  <div class="page">
    <p>ORCA System Performance</p>
    <p>A B D F</p>
    <p>T h ro</p>
    <p>u g h p u t</p>
    <p>(K O</p>
    <p>p s/</p>
    <p>s)</p>
    <p>strong-ZK weak-ZK orca</p>
    <p>Strong-ZK performs poorly due to immediate durability and leader-restricted reads</p>
    <p>Weak-ZK performs well due to eventual durability and scalable reads</p>
    <p>ORCA adds little overheads compared to weak-ZK</p>
    <p>reads that access non-durable data</p>
    <p>Strong-ZK  uses immediate durability, reads only at leader</p>
    <p>Weak-ZK  uses eventual durability, reads at many nodes</p>
    <p>ORCA  uses CAD, reads at many nodes</p>
  </div>
  <div class="page">
    <p>More experiments in the paper</p>
    <p>Evaluation correctness testing using a cluster crash-testing framework</p>
    <p>geo-replicated setting</p>
    <p>micro-benchmarks</p>
    <p>Application case studies location-tracking</p>
    <p>social-media timeline</p>
  </div>
  <div class="page">
    <p>Summary and Conclusions</p>
  </div>
  <div class="page">
    <p>Summary and Conclusions</p>
    <p>Surprisingly, durability models are overlooked</p>
  </div>
  <div class="page">
    <p>Summary and Conclusions</p>
    <p>Surprisingly, durability models are overlooked</p>
    <p>Immediate durability enables strong consistency but is slow</p>
  </div>
  <div class="page">
    <p>Summary and Conclusions</p>
    <p>Surprisingly, durability models are overlooked</p>
    <p>Immediate durability enables strong consistency but is slow</p>
    <p>Eventual durability is fast but only enables weak consistency</p>
  </div>
  <div class="page">
    <p>Summary and Conclusions</p>
    <p>Surprisingly, durability models are overlooked</p>
    <p>Immediate durability enables strong consistency but is slow</p>
    <p>Eventual durability is fast but only enables weak consistency</p>
    <p>CAD  consistency-aware durability, a new way of thinking about durability</p>
    <p>enables both strong consistency and high performance</p>
  </div>
  <div class="page">
    <p>Summary and Conclusions</p>
    <p>Surprisingly, durability models are overlooked</p>
    <p>Immediate durability enables strong consistency but is slow</p>
    <p>Eventual durability is fast but only enables weak consistency</p>
    <p>CAD  consistency-aware durability, a new way of thinking about durability</p>
    <p>enables both strong consistency and high performance</p>
    <p>CAD is useful for many deployments that currently adopt eventual durability</p>
  </div>
  <div class="page">
    <p>Summary and Conclusions</p>
    <p>Surprisingly, durability models are overlooked</p>
    <p>Immediate durability enables strong consistency but is slow</p>
    <p>Eventual durability is fast but only enables weak consistency</p>
    <p>CAD  consistency-aware durability, a new way of thinking about durability</p>
    <p>enables both strong consistency and high performance</p>
    <p>CAD is useful for many deployments that currently adopt eventual durability</p>
    <p>Consistency and performance are seemingly at odds  by carefully examining</p>
    <p>the underlying layer, achieve both</p>
  </div>
  <div class="page">
    <p>Summary and Conclusions</p>
    <p>Surprisingly, durability models are overlooked</p>
    <p>Immediate durability enables strong consistency but is slow</p>
    <p>Eventual durability is fast but only enables weak consistency</p>
    <p>CAD  consistency-aware durability, a new way of thinking about durability</p>
    <p>enables both strong consistency and high performance</p>
    <p>CAD is useful for many deployments that currently adopt eventual durability</p>
    <p>Consistency and performance are seemingly at odds  by carefully examining</p>
    <p>the underlying layer, achieve both</p>
    <p>Thank you! 26</p>
  </div>
</Presentation>
