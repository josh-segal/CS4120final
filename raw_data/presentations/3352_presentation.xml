<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Picking Up My Tab: Understanding and Mitigating Synchronized Token Lifting and Spending in Mobile Payment</p>
    <p>-- Xiaolong Bai1*, Zhe Zhou23*, XiaoFeng Wang3, Zhou Li4, Xianghang Mi3, Nan Zhang3, Tongxin Li5, Shi-Min Hu1, Kehuan Zhang2</p>
    <p>*Alphabetically Ordered Authors</p>
  </div>
  <div class="page">
    <p>Mobile Payment  A Convenient Life Style</p>
    <p>Mobile payment is everywhere.  Over 5 Trillion US Dollar Transactions.</p>
  </div>
  <div class="page">
    <p>Offline Mobile Payment</p>
    <p>A Mobile Payment Method Without Network.  Mobile phone does not need network.  POS machine must be connected.</p>
    <p>Advantages.  Short delay.  Avoid poor network connection inside rooms.</p>
    <p>Simple to use.  No need to enter password  Simple approach a phone to POS.</p>
  </div>
  <div class="page">
    <p>Offline Mobile Payment Working Flow</p>
    <p>Hash value inside token.  Security based on the synchronized secret key.</p>
    <p>Secret</p>
    <p>Time</p>
    <p>User ID</p>
    <p>Hash</p>
    <p>APP POS Server</p>
    <p>User ID DB</p>
    <p>Time</p>
    <p>Secret</p>
    <p>Hash</p>
    <p>Compare</p>
    <p>Token</p>
    <p>Ac/Rj</p>
  </div>
  <div class="page">
    <p>Security Guarantees</p>
    <p>Through hashing, a token is bonded to  The time when being generated.  The user ID.  It cannot be forged without the synchronized secret.</p>
    <p>Tokens are hard to sniff.  Token transportation is designed to be distance bonded.</p>
    <p>Even if a token is sniffed.  A token, once received by the provider, is invalidated immediately.  A token is only valid in a short period of time.</p>
  </div>
  <div class="page">
    <p>Assumption: Passive Adversaries</p>
    <p>Passive attackers are already defended, because tokens, once sniffed, are also received by the provider, is invalidated immediately.</p>
  </div>
  <div class="page">
    <p>Break it with an active adversary</p>
    <p>But it is vulnerable to an active adversary!</p>
  </div>
  <div class="page">
    <p>Attacks against Offline Payment</p>
    <p>STLS Attacks.  Synchronized Token Lifting and Spending.</p>
    <p>Steps  Acquire a live token.  Prevent it from being legally used.  Spend it at another place, before it expires.</p>
    <p>Targets</p>
  </div>
  <div class="page">
    <p>Samsung Pay</p>
  </div>
  <div class="page">
    <p>Known Attacks against Samsung</p>
    <p>Previous paper sniffing and replaying Samsung pay tokens.  Assumption: Passive attackers.</p>
    <p>Legal transaction is not interrupted.  The sniffed token is not alive.  Users are still enough secure.</p>
  </div>
  <div class="page">
    <p>STLS Attack against Samsung Pay</p>
    <p>Assumption: Active Attackers.  Standing close to the POS, can jam the network.</p>
  </div>
  <div class="page">
    <p>STLS Attack against Samsung Pay</p>
    <p>Token replay.</p>
  </div>
  <div class="page">
    <p>Devices to launch the attack</p>
  </div>
  <div class="page">
    <p>Sound Pay</p>
  </div>
  <div class="page">
    <p>Attacking Sound Pay  Adversary Model</p>
  </div>
  <div class="page">
    <p>Attacking Sound Pay Sniffing and Jamming</p>
  </div>
  <div class="page">
    <p>Attacking Sound Pay  Colluder Side</p>
  </div>
  <div class="page">
    <p>STLS Attacks  QR Pay</p>
    <p>An extremely popular payment method.  Payment Mode  B2S mode: A phone scans QR code on a paper to pay.  B2L mode: A phone presents QR code under POS scanner to pay.</p>
  </div>
  <div class="page">
    <p>Adversary Model  QR Pay</p>
    <p>Payers phone is infected with attackers malware.  The malware has the front camera privilege.  For sniffing.</p>
    <p>The malware can display a floating window.  To prevent tokens from being legally used.</p>
  </div>
  <div class="page">
    <p>STLS Attacks  QR Code Sniffing</p>
  </div>
  <div class="page">
    <p>Prevent Legal Scanning</p>
    <p>A malware a draw a white block.  To prevent the code from legally recognized.  Positioning mark is critical for decoding.  POS machine can no longer decode the QR code.</p>
    <p>The sniffed QR code token is kept alive.  Attackers spend the token during the period.</p>
  </div>
  <div class="page">
    <p>P2P Mode Attacks</p>
    <p>What if you use iPhone instead of Android Phone?  iPhone does not support background front camera photo shooting.</p>
    <p>What if your phone is not infected?  P2P mode: A phone scans QR code on another phone to pay.  The QR code can also be used in B2L mode to pay to the merchants.</p>
  </div>
  <div class="page">
    <p>P2P Mode Attack Adversary Model</p>
    <p>The victim (payee) is not infected.  The payer is infected with attackers malware.</p>
    <p>Has an exactly same UI with legal payment app.  Will be used to sniff the QR code token.</p>
    <p>The victim has turned on the Bluetooth.  Can be exploited by attacker to keep the token alive.</p>
  </div>
  <div class="page">
    <p>STLS Attacks  QR Code Sniffing</p>
    <p>Payee Payer (infected)</p>
  </div>
  <div class="page">
    <p>Preventing sniffed QR code from legal scan</p>
    <p>Refresh</p>
    <p>(infected)</p>
  </div>
  <div class="page">
    <p>STLS Attacks  Alipays Action</p>
    <p>Alipay ceased P2P transfer through QR code in this Feb.  Face to face money transfer moved to printed QR code.  Users get an exclusive QR code for receiving money after application.</p>
  </div>
  <div class="page">
    <p>POSAUTH, restrict the use of sniffed tokens</p>
    <p>Live token can be spent at anywhere, with the upper bound amount.  Sniffed token cannot be spent remotely, once bonded to the POS ID.</p>
    <p>POS ID POS IDPOS ID</p>
  </div>
  <div class="page">
    <p>POSAUTH</p>
    <p>Get the POS ID  By a front scan.  Hash it into token.  Token is bonded.</p>
    <p>No hardware upgrade.</p>
  </div>
  <div class="page">
    <p>Q&amp;A</p>
    <p>Offline payment schemes only considered passive attackers.  Active attackers can keep the sniffed token alive by interrupting the transaction.  Attackers can spend the token before it expires.</p>
  </div>
  <div class="page">
    <p>Security Vulnerabilities</p>
    <p>A token is bond to  The time when being generated.  The user ID.  But not a specific transaction (Amount, Merchant ID, etc.).</p>
    <p>A live token can be spent by the attacker, once sniffed.  At anywhere.  With the upper bound amount.</p>
  </div>
  <div class="page">
    <p>STLS Attacks  B2L Mode Attacks</p>
    <p>The white block prevents QR code from being legally recognized.  The font camera captures a picture containing the QR code.  The background app can decode the QR code to get the token.  The token can be spent at another place.</p>
  </div>
</Presentation>
