<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Nektarios Leontiadis (CMU/EPP/CyLab) leontiadis@cmu.edu</p>
    <p>Joint work with Nicolas Christin (CMU) and Tyler Moore (Harvard)</p>
  </div>
  <div class="page">
    <p>Online crime  Emergence of complex supply chains  Understanding economics is key to combat it</p>
    <p>Why focus on drugs?  What about counterfeit software, fake watches?  Most dangerous form of online crime  Wrong dosage can kill, cf. Ryan Haight</p>
    <p>Method of exposure  Revealing interesting insights about the mechanics of the illicit trade</p>
  </div>
  <div class="page">
    <p>Email spamming has been the key tool for a long time</p>
    <p>Very low conversion rate* (about 1 purchase every 10 million emails sent)</p>
    <p>Unsolicited</p>
    <p>More recently: social network spam (e.g. Twitter) and blog spam</p>
    <p>Better conversion rate* (0.13%)</p>
    <p>Posting malicious links via compromised accounts Exploiting trust we have to our online friends</p>
    <p>Search engine manipulation</p>
    <p>Targeted to users looking for a product</p>
    <p>Probably better conversion rates</p>
    <p>*Ratio of realized sales over the number of emails/clicks</p>
  </div>
  <div class="page"/>
  <div class="page">
    <p>Bob runs a query on Google (e.g. no prescription cialis)</p>
    <p>Results will include infected websites</p>
    <p>Clicking on an infected result triggers injected</p>
    <p>code at the infected web server One or more HTTP</p>
    <p>Bob lands on an online pharmacy store</p>
  </div>
  <div class="page">
    <p>Exploitation of popular Web applications vulnerabilities and hosting platforms</p>
    <p>Bluehost</p>
    <p>WordPress</p>
    <p>Code is injected which alters the behavior of the web server based on the</p>
    <p>parameters of the request:</p>
    <p>Generic traffic</p>
    <p>Requests from search engine crawlers (User-</p>
    <p>Agent)</p>
    <p>Requests coming from a search engine results page (referrer)</p>
  </div>
  <div class="page">
    <p>Online pharmacies Redirector(s)</p>
    <p>Source infection(s)</p>
    <p>Query executed</p>
    <p>no prescription cialis</p>
    <p>cs.umass.edu stat-center.com</p>
    <p>securetabsonline.com</p>
    <p>best-online-cialis- store.com</p>
    <p>generictab.com</p>
    <p>genericrxpharma.com</p>
    <p>sylvan.k12.ca.us</p>
  </div>
  <div class="page"/>
  <div class="page">
    <p>Run 218 drug related queries daily.</p>
    <p>Daily collection from 4/12/2010.</p>
    <p>Using data until 10/21/2010.</p>
    <p>Complemented by a second 10-week dataset</p>
    <p>Collection process is still running.</p>
    <p>Collect top 64 search results from Google</p>
    <p>The limit is defined by Google Search API</p>
    <p>Storing all results for later processing</p>
    <p>Will also examine position information</p>
    <p>Identify all results that perform automated</p>
    <p>redirection</p>
    <p>A search result defines the website that a user will be redirected to when clicking on the link</p>
    <p>If the browser is redirected instead to a different website (domain), the result is infected.</p>
    <p>Follow all infected results</p>
    <p>Follow each result identified as infected from previous step</p>
    <p>Follow all redirections that might occur</p>
    <p>Record all the redirection information</p>
  </div>
  <div class="page">
    <p>vicodin no prescription cheap valium non prescription buy ativan online injecting pills buy xanax valium online florida order vicodin si levitra online buy xanax valium online florida color of adipex pills safest place to buy online</p>
    <p>vicodin without prescription generic cialis free sample cheap tadalafil 20 mg ambien overdose prozac side effects ambien buy online alprazolam online without prescription buy cheap</p>
  </div>
  <div class="page">
    <p>URI (number) URI (%) Domains (#) Domains (%)</p>
    <p>Source infections</p>
    <p>Active 44503 32.4 2907 12.6</p>
    <p>Inactive 29406 21.4 1745 7.6</p>
    <p>Health resources</p>
    <p>Pharmacies 4348 3.2 2138 9.3</p>
    <p>Legitimate 12 0.01 9 0.04</p>
    <p>Illicit 4336 3.2 2129 9.2</p>
    <p>Blog/forum spam</p>
    <p>Uncategorized 15945 11.6 7766 33.7</p>
    <p>Total 137354 100 23042 100</p>
  </div>
  <div class="page">
    <p>Classification by position in search results</p>
    <p>% results with classification at position y</p>
    <p>po si</p>
    <p>tio n</p>
    <p>in s</p>
    <p>ea rc</p>
    <p>h re</p>
    <p>su lts searchredirection</p>
    <p>attack (active) searchredirection attack (inactive) blog/forum spam</p>
    <p>illicit pharmacies</p>
    <p>health resources</p>
    <p>other</p>
  </div>
  <div class="page">
    <p>Avg. daily domains in search results</p>
    <p>Date</p>
    <p># D</p>
    <p>om ai</p>
    <p>ns</p>
    <p>May Jun Jul Aug Sep Oct Nov Dec Jan</p>
    <p>infections blog/forum spam illicit pharmacies health resources</p>
    <p>Blog spam is declining</p>
    <p>Search redirection</p>
    <p>attack is rising</p>
  </div>
  <div class="page">
    <p>Survival function for search results (PageRank)</p>
    <p>t days source infection remains in search results</p>
    <p>S (t)</p>
    <p>all 95% CI PR&gt;=7 0&lt;PR&lt;7 PR=0</p>
    <p>Survival function for search results (TLD)</p>
    <p>t days source infection remains in search results</p>
    <p>S (t)</p>
    <p>all 95% CI .COM .ORG .EDU .NET other</p>
    <p>.edu sites particularly attractive, as well as high PageRank sites (often sites fall in both categories)</p>
  </div>
  <div class="page">
    <p>Connected components in the graph evidence some level of business relationships between the nodes they connect</p>
    <p>Search result</p>
    <p>(hacked.edu)</p>
    <p>Redirector (attacker.com)</p>
    <p>Other pharmacy</p>
    <p>(cheaprx.com)</p>
    <p>Search result</p>
    <p>(pwned.com)</p>
    <p>Pharmacy (freerx.com)</p>
    <p>Redirector (1337.com)</p>
  </div>
  <div class="page">
    <p>34 connected components</p>
    <p>One connected component contains</p>
    <p>96% of all infected domains  90% of all redirection domains  92% of all pharmacies</p>
    <p>Is one person responsible for all of this?!  Not necessarily, but evidence of partner relationships</p>
  </div>
  <div class="page">
    <p>Run (spinglass) clustering algorithm in big connected component</p>
    <p>Evidence of separate organized groups/ campaigns more loosely connected to each other</p>
    <p>Interesting AS/registrar patterns.  11 ASes host most redirect</p>
    <p>servers  Some are over-</p>
    <p>represented</p>
  </div>
  <div class="page">
    <p>Payment processing visits / month</p>
    <p>Payment processing for pharmacy business</p>
    <p>month 75%</p>
    <p>month</p>
    <p>Drug query popularity (Google AdWords)</p>
    <p>Search-Redirection attacks</p>
    <p>month 38%</p>
    <p>month</p>
    <p>*Ratio of realized sales over the number of visitors</p>
  </div>
  <div class="page">
    <p>Other forms of advertisement</p>
    <p>Search- redirection</p>
    <p>advertisement</p>
    <p>Social network spam : 0.13%</p>
    <p>(Grier et al 2010)</p>
    <p>Email spam 0.00001%</p>
    <p>(Kanich et al 2008)</p>
    <p>Lower bound estimate 0.32%</p>
  </div>
  <div class="page">
    <p>Disrupting the redirection network</p>
    <p>Search engine</p>
    <p>intervention</p>
    <p>Remediation at the sources</p>
  </div>
  <div class="page">
    <p>In vs. outdegree in giant component</p>
    <p>indegree</p>
    <p>ou t de gr ee</p>
    <p>Redirectors we may want to go after</p>
  </div>
  <div class="page">
    <p>Measuring cybercrime Passive</p>
    <p>monitoring of advertised</p>
    <p>commodities</p>
    <p>IRC channels (Franklin et al</p>
    <p>CCS 07)</p>
    <p>Web forums (Zhuge et al WEIS 08)</p>
    <p>Active participation in online exchanges</p>
    <p>Botnet infiltration (Stone-Gross et al</p>
    <p>CCS 09)</p>
    <p>Web server</p>
    <p>operation (Wondracek et al</p>
    <p>WEIS 10)</p>
    <p>Data mining on publicly available web data</p>
    <p>This study</p>
    <p>Spam and</p>
    <p>Phishing (Moore et al LEET 09)</p>
    <p>Typo- squatting (Moore et al</p>
    <p>FC 10)</p>
    <p>One click fraud</p>
    <p>(Christin et al CCS 10)</p>
    <p>Malware distribution (Provos et al USENIX 08)</p>
  </div>
  <div class="page">
    <p>One group of affiliates is</p>
    <p>dominating the illegal online</p>
    <p>trade</p>
    <p>Popular websites and the EDU TLD</p>
    <p>are most favorable to attackers</p>
    <p>Unwelcome environment for online legitimate pharmacies  only 0.04%</p>
    <p>legitimate results</p>
    <p>Conversion rate is better than of</p>
    <p>other illicit advertising techniques</p>
    <p>Search- redirection</p>
    <p>attacks is where the action seems to be moving</p>
  </div>
  <div class="page">
    <p>Thank you!</p>
    <p>Nektarios Leontiadis leontiadis@cmu.edu Carnegie Mellon University/EPP/CyLab</p>
  </div>
</Presentation>
