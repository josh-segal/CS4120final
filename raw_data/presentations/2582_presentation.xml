<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>PHY Covert Channels: Can you see the Idles?</p>
    <p>Ki Suh Lee Cornell University</p>
    <p>Joint work with Han Wang, and Hakim Weatherspoon</p>
    <p>Chupja</p>
  </div>
  <div class="page">
    <p>(chupja)</p>
  </div>
  <div class="page">
    <p>Network Covert Channels</p>
    <p>Hiding informaJon  Through communicaJon not intended for data transfer</p>
  </div>
  <div class="page">
    <p>Network Covert Channels</p>
    <p>Hiding informaJon  Through communicaJon not intended for data transfer  Using legiJmate packets (Overt channel)</p>
    <p>Storage Channels: Packet headers  Timing Channels: Arrival Jmes of packets</p>
  </div>
  <div class="page">
    <p>Network Covert Channels</p>
    <p>Hiding informaJon  Through communicaJon not intended for data transfer  Using legiJmate packets (Overt channel)</p>
    <p>Storage Channels: Packet headers  Timing Channels: Arrival Jmes of packets</p>
  </div>
  <div class="page">
    <p>Goals of Covert Channels</p>
    <p>Bandwidth  How much informaJon can be delivered in a second</p>
    <p>Robustness  How much informaJon can be delivered without loss / error</p>
    <p>Undetectability  How well communicaJon is hidden</p>
  </div>
  <div class="page">
    <p>Goals of Covert Channels</p>
    <p>Bandwidth  How much informaJon can be delivered in a second  10~100s bits per second</p>
    <p>Robustness  How much informaJon can be delivered without loss / error  Cabuk04, Shah06</p>
    <p>Undetectability  How well communicaJon is hidden  Liu09, Liu10</p>
    <p>ApplicaJon</p>
    <p>Transport</p>
    <p>Network</p>
    <p>Data Link</p>
    <p>Physical</p>
  </div>
  <div class="page">
    <p>Current network covert channels are implemented in L3~4 (TCP/IP) layers</p>
    <p>and are extremely slow.</p>
  </div>
  <div class="page">
    <p>Chupja: PHY Covert Channel</p>
    <p>Bandwidth  How much informaJon can be delivered in a second  10~100s bits per second</p>
    <p>Robustness  How much informaJon can be delivered without loss / error  Bit Error Rate &lt; 10%</p>
    <p>Undetectability  How well communicaJon is hidden  Invisible to detecJon socware</p>
    <p>ApplicaJon</p>
    <p>Transport</p>
    <p>Network</p>
    <p>Data Link</p>
    <p>Physical Physical</p>
    <p>-&gt; 10s~100s Kilo bits per second</p>
  </div>
  <div class="page">
    <p>Chupja is a network covert channel which is faster than priori art.</p>
    <p>It is implemented in L1 (PHY),</p>
    <p>robust and virtually invisible to socware.</p>
  </div>
  <div class="page">
    <p>Outline</p>
    <p>IntroducJon  Design  EvaluaJon  Conclusion</p>
  </div>
  <div class="page">
    <p>Outline</p>
    <p>IntroducJon  Design</p>
    <p>Threat Model  10 Gigabit Ethernet</p>
    <p>EvaluaJon  Conclusion</p>
  </div>
  <div class="page">
    <p>Threat Model</p>
    <p>ApplicaJon</p>
    <p>Transport</p>
    <p>Network</p>
    <p>Data Link</p>
    <p>Physical</p>
    <p>ApplicaJon</p>
    <p>Transport</p>
    <p>Network</p>
    <p>Data Link</p>
    <p>Physical</p>
    <p>ApplicaJon</p>
    <p>Transport</p>
    <p>Network</p>
    <p>Data Link</p>
    <p>Physical</p>
    <p>ApplicaJon</p>
    <p>Transport</p>
    <p>Network</p>
    <p>Data Link</p>
    <p>Physical</p>
    <p>Sender Receiver</p>
    <p>Passive Adversary</p>
    <p>Commodity Server Commodity NIC</p>
  </div>
  <div class="page">
    <p>Idle Characters (/I/)</p>
    <p>Each bit is ~100 picosecond wide  7~8 bit special character in the physical layer  700~800 picoseconds to transmit  Only in PHY</p>
    <p>Packet i Packet i+1 Packet i+2</p>
    <p>ApplicaJon</p>
    <p>Transport</p>
    <p>Network</p>
    <p>Data Link</p>
    <p>Physical</p>
  </div>
  <div class="page">
    <p>Interpacket delays (D) and gaps (G)</p>
    <p>Homogeneous packet stream</p>
    <p>Same packet size,  Same IPD (IPG),  Same desJnaJon</p>
    <p>Terminology</p>
    <p>IPG</p>
    <p>Packet i Packet i+1</p>
    <p>IPD</p>
    <p>Packet i Packet i+1 Packet i+2</p>
  </div>
  <div class="page">
    <p>Chupja: Design</p>
    <p>Homogeneous stream</p>
    <p>Sender</p>
    <p>Receiver</p>
    <p>Packet i Packet i+1 Packet i+2</p>
    <p>G -  G +</p>
    <p>D -  D +</p>
    <p>0 1</p>
    <p>Packet i Packet i+2</p>
    <p>Gi Gi+1</p>
    <p>Di Di+1</p>
    <p>0 1 Packet i+1</p>
    <p>Packet i Packet i+2</p>
    <p>G G</p>
    <p>D D</p>
    <p>IPG IPG Packet i+1</p>
  </div>
  <div class="page">
    <p>Chupja: Design</p>
    <p>With shared G  Encoding 1: Gi = G +   Encoding 0: Gi = G -</p>
    <p>Packet i Packet i+1 Packet i+2</p>
    <p>G -  G +</p>
    <p>D -  D +</p>
    <p>0 1</p>
  </div>
  <div class="page">
    <p>ImplementaJon</p>
    <p>SoNIC [NSDI 13]  Socware-defined Network Interface Card  Allows control and access every bit of PHY</p>
    <p>In realJme, and in socware</p>
    <p>50 lines of C code addiJon</p>
    <p>ApplicaJon</p>
    <p>Transport</p>
    <p>Network</p>
    <p>Data Link</p>
    <p>Physical</p>
  </div>
  <div class="page">
    <p>Outline</p>
    <p>IntroducJon  Design  EvaluaJon</p>
    <p>Bandwidth  Robustness  Undetectability</p>
    <p>Conclusion</p>
  </div>
  <div class="page">
    <p>EvaluaJon</p>
    <p>What is the bandwidth of Chupja?</p>
    <p>How robust is Chupja?</p>
    <p>Why is Chupja robust?</p>
    <p>How undetectable is Chupja?</p>
  </div>
  <div class="page">
    <p>What is the bandwidth of Chupja?</p>
  </div>
  <div class="page">
    <p>EvaluaJon: Bandwidth</p>
    <p>Covert bandwidth equals to packet rate of overt channel</p>
    <p>Co ve rt C ha</p>
    <p>nn el C ap</p>
    <p>ac it y (b ps )</p>
    <p>Overt Channel Throughput (Gbps)</p>
  </div>
  <div class="page">
    <p>How robust is Chupja?</p>
  </div>
  <div class="page">
    <p>Boston</p>
    <p>Cornell (Ithaca)</p>
    <p>Cornell (NYC) NLR (NYC)</p>
    <p>Chicaco</p>
    <p>Cleveland</p>
    <p>Sender Receiver</p>
    <p>SW1 SW1</p>
    <p>SW2 SW2</p>
    <p>SW3 SW4</p>
    <p>Sender Receiver</p>
    <p>EvaluaJon Setup</p>
    <p>Small Network  Six commercial switches  Average RTT: 0.154 ms</p>
    <p>NaJonal Lambda Rail  Nine rouJng hops  Average RTT: 67.6ms  1~2 Gbps External Traffic</p>
  </div>
  <div class="page">
    <p>EvaluaJon: Robustness  Overt Channel at 1 Gbps (D = 12211ns, G=13738 /I/s)  Covert Channel at 81 kbps</p>
    <p>?</p>
    <p>Sender Receiver</p>
    <p>BE R</p>
    <p>(/I/s)</p>
    <p>Small No Ext. Small Ext 3.6G NLR</p>
  </div>
  <div class="page">
    <p>?</p>
    <p>EvaluaJon: Robustness  Overt Channel at 1 Gbps (D = 12211ns, G=13738 /I/s)  Covert Channel at 81 kbps  Modula=ng IPGS at 1.6us scale (=2048 /I/s)</p>
    <p>BE R</p>
    <p>(/I/s)</p>
    <p>Small No Ext. Small Ext 3.6G NLR</p>
  </div>
  <div class="page">
    <p>Why is Chupja robust?</p>
  </div>
  <div class="page">
    <p>EvaluaJon: Why?</p>
    <p>Switches do not add significant perturbaJons to IPDs  Switches treat 1s and 0s as uncorrelated</p>
    <p>Over mul=ple hops when there is no external traffic.  With external traffic</p>
  </div>
  <div class="page">
    <p>EvaluaJon: Why?</p>
    <p>Switches do not add significant perturbaJons to IPDs  Switches treat 1s and 0s as uncorrelated</p>
    <p>Over mul=ple hops when there is no external traffic.  With external traffic</p>
    <p>Sender</p>
    <p>Homogeneous 1518B at 1 Gbps</p>
    <p>Receiver</p>
    <p>Sender</p>
    <p>Chupja ( = 256/I/s) 1518B at 1 Gbps</p>
    <p>Receiver</p>
  </div>
  <div class="page">
    <p>EvaluaJon: Why?  Switches do not add significant perturbaJons to IPDs  Switches treat encoded 0 and 1 as uncorrelated</p>
    <p>Over mul=ple hops when there is no external traffic.</p>
    <p>D -</p>
    <p>D  250ns</p>
    <p>Homogeneous stream Chupja stream ( =256/I/s )</p>
    <p>D +</p>
  </div>
  <div class="page">
    <p>EvaluaJon: Why?</p>
    <p>Boston</p>
    <p>Cornell (Ithaca)</p>
    <p>Cornell (NYC) NLR (NYC)</p>
    <p>Chicaco</p>
    <p>Cleveland</p>
    <p>Most of IPDs are within some range from original IPD  Even when there is external traffic.</p>
    <p>Encoded Zero Encoded One</p>
    <p>Sender Receiver</p>
    <p>(/I/s) (ns)</p>
    <p>BER 0.367 0.391 0.281 0.089 0.013</p>
  </div>
  <div class="page">
    <p>EvaluaJon: Why?</p>
    <p>Switches do not add significant perturbaJons to IPDs  Switches treat 1s and 0s as uncorrelated</p>
    <p>Over mul=ple hops when there is no external traffic.  With external traffic</p>
    <p>?</p>
    <p>Sender Receiver</p>
    <p>With sufficiently large , the interpacket spacing holds throughout the network, and BER is less than 10%</p>
  </div>
  <div class="page">
    <p>How undetectable is Chupja?</p>
  </div>
  <div class="page">
    <p>EvaluaJon: DetecJon Setup</p>
    <p>Commodity server with 10G NIC  Kernel Jmestamping</p>
    <p>NLR Sender</p>
    <p>Kernel Jmestamping</p>
    <p>Receiver</p>
    <p>NLR Sender</p>
    <p>SoNIC Jmestamping</p>
    <p>Receiver</p>
  </div>
  <div class="page">
    <p>EvaluaJon: DetecJon</p>
    <p>HOM</p>
    <p>HOM</p>
    <p>Adversary cannot detect paPerns of Chupja</p>
    <p>Kernel Timestamping SoNIC Timestamping</p>
    <p>= 1024</p>
    <p>= 4096</p>
    <p>= 1024</p>
    <p>= 4096</p>
  </div>
  <div class="page">
    <p>EvaluaJon: Summary</p>
    <p>What is the bandwidth of Chupja?  10s~100s Kilo bits per second</p>
    <p>How robust is Chupja?  BER &lt; 10% over NLR</p>
    <p>Why is Chupja robust?  Sufficiently large  holds throughout the network</p>
    <p>How undetectable is Chupja?  Invisible to socware</p>
  </div>
  <div class="page">
    <p>Conclusion</p>
    <p>Chupja: PHY covert channel  High-bandwidth, robust, and undetectable</p>
    <p>Based on understanding of network devices  PerturbaJons from switches  Inaccurate endhost Jmestamping</p>
    <p>hvp://sonic.cs.cornell.edu &amp; GENI (ExoGENI)!!!</p>
  </div>
  <div class="page">
    <p>Thank you</p>
  </div>
</Presentation>
