<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>AN OBSERVATIONAL INVESTIGATION OF REVERSE ENGINEERS PROCESSES</p>
    <p>AND MENTAL MODELS Daniel Votipka, Seth Rabin, Kristopher Micinski, Michelle</p>
    <p>L. Mazurek, and Jeffrey S. Foster</p>
  </div>
  <div class="page">
    <p>SOFTWARE REVERSE ENGINEERING</p>
    <p>Looking at someone elses code to figure out how it works!</p>
  </div>
  <div class="page">
    <p>SOFTWARE REVERSE ENGINEERING</p>
    <p>Looking at someone elses code to figure out how it works!</p>
    <p>Vulnerability Discovery</p>
  </div>
  <div class="page">
    <p>SOFTWARE REVERSE ENGINEERING</p>
    <p>Looking at someone elses code to figure out how it works!</p>
    <p>Vulnerability Discovery</p>
    <p>Malware Analysis</p>
  </div>
  <div class="page">
    <p>SOFTWARE REVERSE ENGINEERING</p>
    <p>Looking at someone elses code to figure out how it works!</p>
    <p>Vulnerability Discovery</p>
    <p>Yakdan et al. 2016</p>
    <p>Malware Analysis</p>
  </div>
  <div class="page">
    <p>CURRENT TOOLS</p>
  </div>
  <div class="page">
    <p>CURRENT TOOLS</p>
    <p>Many sophisticated tools developed by academia, industry, and practitioners</p>
  </div>
  <div class="page">
    <p>CURRENT TOOLS</p>
    <p>Many sophisticated tools developed by academia, industry, and practitioners</p>
    <p>Ad-hoc, based on the developers intuition</p>
  </div>
  <div class="page">
    <p>CURRENT TOOLS</p>
    <p>Many sophisticated tools developed by academia, industry, and practitioners</p>
    <p>Ad-hoc, based on the developers intuition</p>
    <p>Limited theoretical model of RE process  Actions, habits, and mental models</p>
  </div>
  <div class="page">
    <p>CURRENT TOOLS</p>
    <p>Many sophisticated tools developed by academia, industry, and practitioners</p>
    <p>Ad-hoc, based on the developers intuition</p>
    <p>Limited theoretical model of RE process  Actions, habits, and mental models</p>
    <p>Goal: Develop a refined RE process model to</p>
    <p>guide future tool development.</p>
  </div>
  <div class="page">
    <p>PROGRAM COMPREHENSION How developers process unfamiliar code during modification, maintenance, and debugging tasks</p>
    <p>Hypotheses/Questions - approach unfamiliar programs from a non-linear, fact-finding perspective</p>
    <p>Beacons - Patterns that allow the reader to quickly infer program behavior</p>
    <p>Simulation methods - Any process for parsing the program to determine its function</p>
  </div>
  <div class="page">
    <p>PROGRAM COMPREHENSION How developers process unfamiliar code during modification, maintenance, and debugging tasks</p>
    <p>Hypotheses/Questions - approach unfamiliar programs from a non-linear, fact-finding perspective</p>
    <p>Beacons - Patterns that allow the reader to quickly infer program behavior</p>
    <p>Simulation methods - Any process for parsing the program to determine its function</p>
    <p>Is reverse engineering different?  No access to source code, developers, or documentation  Adversarial environment</p>
  </div>
  <div class="page">
    <p>RESEARCH QUESTIONS</p>
    <p>What high-level process do REs follow?  Steps of the process  Mental models</p>
    <p>What technical approaches do REs use?</p>
    <p>Are the RE and Program Comprehension processes different?</p>
  </div>
  <div class="page">
    <p>RESEARCH QUESTIONS</p>
    <p>What high-level process do REs follow?  Steps of the process  Mental models</p>
    <p>What technical approaches do REs use?</p>
    <p>Are the RE and Program Comprehension processes different?</p>
  </div>
  <div class="page">
    <p>OBSERVATIONAL INTERVIEWS Modified Critical Decision Method Protocol:</p>
    <p>Participants demonstrated how they reverse engineered a recent program</p>
    <p>Noted and asked further questions regarding items of interest:  Beacons  Hypotheses/Questions  Simulation Methods</p>
    <p>Decisions  Resources</p>
    <p>Klein et al. 1989</p>
  </div>
  <div class="page">
    <p>PARTICIPANTS</p>
    <p>Participants 16</p>
    <p>Gender 14 Male, 1 Female</p>
    <p>Age (Median) 18-29</p>
    <p>Location 7 US states, 5 countries</p>
    <p>Education (Median) B.S.</p>
    <p>Yrs. Experience 8.94 years</p>
    <p>Skill 4.06 (Advanced)</p>
    <p>Job 12* Vulnerability Discovery, 5* Malware Analysis,</p>
    <p>*One participant performed both malware analysis and vulnerability discovery for employment</p>
  </div>
  <div class="page">
    <p>PARTICIPANTS</p>
    <p>Participants 16</p>
    <p>Gender 14 Male, 1 Female</p>
    <p>Age (Median) 18-29</p>
    <p>Location 7 US states, 5 countries</p>
    <p>Education (Median) B.S.</p>
    <p>Yrs. Experience 8.94 years</p>
    <p>Skill 4.06 (Advanced)</p>
    <p>Job 12* Vulnerability Discovery, 5* Malware Analysis,</p>
    <p>*One participant performed both malware analysis and vulnerability discovery for employment</p>
  </div>
  <div class="page">
    <p>PARTICIPANTS</p>
    <p>Participants 16</p>
    <p>Gender 14 Male, 1 Female</p>
    <p>Age (Median) 18-29</p>
    <p>Location 7 US states, 5 countries</p>
    <p>Education (Median) B.S.</p>
    <p>Yrs. Experience 8.94 years</p>
    <p>Skill 4.06 (Advanced)</p>
    <p>Job 12* Vulnerability Discovery, 5* Malware Analysis,</p>
    <p>*One participant performed both malware analysis and vulnerability discovery for employment</p>
  </div>
  <div class="page">
    <p>THREE PHASE RE MODEL</p>
    <p>Focused Experimentation</p>
    <p>Sub-component Scanning</p>
    <p>Overview</p>
  </div>
  <div class="page">
    <p>OVERVIEW</p>
    <p>Focused Experimentation</p>
    <p>Sub-component Scanning</p>
    <p>Identify specific functions and code segments to focus on</p>
    <p>Full program</p>
    <p>List strings and APIs  Run the program  Review metadata</p>
    <p>Overview</p>
  </div>
  <div class="page">
    <p>Focused Experimentation</p>
    <p>Sub-component Scanning  Scan beacons</p>
    <p>Overview</p>
    <p>Specific hypotheses/questions that require concrete information</p>
    <p>Program slices</p>
    <p>SUB-COMPONENT SCANNING</p>
  </div>
  <div class="page"/>
  <div class="page">
    <p>its just trying to make a connection to each of</p>
    <p>those [websites].</p>
  </div>
  <div class="page">
    <p>if its able to make a connection, its going to return a non-zero value.</p>
  </div>
  <div class="page">
    <p>usually you see this activity if [malware] is trying to see if it has connectivity.</p>
  </div>
  <div class="page">
    <p>SUB-COMPONENT SCANNING</p>
    <p>Focused Experimentation</p>
    <p>Sub-component Scanning  Scan beacons  Data flow/control flow paths</p>
    <p>Overview</p>
    <p>Specific hypotheses/questions that require concrete information</p>
    <p>Program slices</p>
  </div>
  <div class="page">
    <p>val = 0 if y == 1 {</p>
    <p>x = y val = 1</p>
    <p>} else{</p>
    <p>a = -1 z = 1 val = a a += 1</p>
    <p>} if val == -1 {</p>
    <p>id_free(x) } else {</p>
    <p>safe() }</p>
  </div>
  <div class="page">
    <p>val = 0 if y == 1 {</p>
    <p>x = y val = 1</p>
    <p>} else{</p>
    <p>a = -1 z = 1 val = a a += 1</p>
    <p>} if val == -1 {</p>
    <p>id_free(x) } else {</p>
    <p>safe() }</p>
    <p>Can I free undefined memory?</p>
  </div>
  <div class="page">
    <p>val = 0 if y == 1 {</p>
    <p>x = y val = 1</p>
    <p>} else{</p>
    <p>a = -1 z = 1 val = a a += 1</p>
    <p>} if val == -1 {</p>
    <p>id_free(x) } else {</p>
    <p>safe() }</p>
    <p>Can I free undefined memory?</p>
  </div>
  <div class="page">
    <p>val = 0 if y == 1 {</p>
    <p>x = y val = 1</p>
    <p>} else{</p>
    <p>a = -1 z = 1 val = a a += 1</p>
    <p>} if val == -1 {</p>
    <p>id_free(x) } else {</p>
    <p>safe() }</p>
    <p>Can I free undefined memory?</p>
  </div>
  <div class="page">
    <p>val = 0 if y == 1 {</p>
    <p>x = y val = 1</p>
    <p>} else{</p>
    <p>a = -1 z = 1 val = a a += 1</p>
    <p>} if val == -1 {</p>
    <p>id_free(x) } else {</p>
    <p>safe() }</p>
    <p>Can I free undefined memory?</p>
  </div>
  <div class="page">
    <p>val = 0 if y == 1 {</p>
    <p>x = y val = 1</p>
    <p>} else{</p>
    <p>a = -1 z = 1 val = a a += 1</p>
    <p>} if val == -1 {</p>
    <p>id_free(x) } else {</p>
    <p>safe() }</p>
    <p>Can I free undefined memory?</p>
  </div>
  <div class="page">
    <p>val = 0 if y == 1 {</p>
    <p>x = y val = 1</p>
    <p>} else{</p>
    <p>a = -1  val = a</p>
    <p>} if val == -1 {</p>
    <p>id_free(x) } else {</p>
    <p>safe() }</p>
    <p>Can I free undefined memory?</p>
  </div>
  <div class="page">
    <p>val = 0 if y == 1 {</p>
    <p>x = y val = 1</p>
    <p>} else{</p>
    <p>a = -1  val = a</p>
    <p>} if val == -1 {</p>
    <p>id_free(x) } else {</p>
    <p>safe() }</p>
    <p>Can I free undefined memory?</p>
  </div>
  <div class="page">
    <p>val = 0 if y == 1 {</p>
    <p>x = y val = 1</p>
    <p>} else{</p>
    <p>a = -1  val = a</p>
    <p>} if val == -1 {</p>
    <p>id_free(x) } else {</p>
    <p>safe() }</p>
    <p>Can I free undefined memory?</p>
  </div>
  <div class="page">
    <p>SUB-COMPONENT SCANNING</p>
    <p>Focused Experimentation</p>
    <p>Sub-component Scanning  Scan beacons  Data flow/control flow paths</p>
    <p>Overview</p>
    <p>Specific hypotheses/questions that require concrete information</p>
    <p>Program slices</p>
  </div>
  <div class="page">
    <p>FOCUSED EXPERIMENTATION</p>
    <p>Execute under inspection  Compare to reference function  Read line-by-line</p>
    <p>Overview</p>
    <p>Sub-component Scanning</p>
    <p>Execution traces or a few lines of code</p>
    <p>Focused Experimentation</p>
    <p>Test hypotheses and produce concrete answers</p>
  </div>
  <div class="page">
    <p>FOCUSED EXPERIMENTATION</p>
    <p>Execute under inspection  Compare to reference function  Read line-by-line</p>
    <p>Overview</p>
    <p>Sub-component Scanning</p>
    <p>Execution traces or a few lines of code</p>
    <p>Focused Experimentation</p>
    <p>No more than 50 lines reviewed by any participants</p>
    <p>Test hypotheses and produce concrete answers</p>
  </div>
  <div class="page">
    <p>CROSS-PHASE TRENDS</p>
    <p>Focused Experimentation</p>
    <p>Sub-component Scanning</p>
    <p>Overview</p>
  </div>
  <div class="page">
    <p>CROSS-PHASE TRENDS</p>
    <p>Static</p>
    <p>Dynamic</p>
    <p>Methods</p>
    <p>Focused Experimentation</p>
    <p>Sub-component Scanning</p>
    <p>Overview</p>
  </div>
  <div class="page">
    <p>CROSS-PHASE TRENDS</p>
    <p>Static</p>
    <p>Dynamic</p>
    <p>Methods Role of</p>
    <p>Experience Choose focus areas</p>
    <p>Recognize behaviors/ vulnerabilities</p>
    <p>Choose methodFocused Experimentation</p>
    <p>Sub-component Scanning</p>
    <p>Overview</p>
  </div>
  <div class="page">
    <p>CROSS-PHASE TRENDS</p>
    <p>Static</p>
    <p>Dynamic</p>
    <p>Methods Role of</p>
    <p>Experience Choose focus areas</p>
    <p>Recognize behaviors/ vulnerabilities</p>
    <p>Choose methodFocused Experimentation</p>
    <p>Sub-component Scanning</p>
    <p>Overview</p>
    <p>Preferred tools improve readability</p>
  </div>
  <div class="page">
    <p>DISCUSSION</p>
  </div>
  <div class="page">
    <p>DISCUSSION</p>
    <p>Guidelines for usable tool design</p>
  </div>
  <div class="page">
    <p>DISCUSSION</p>
    <p>Guidelines for usable tool design  Framework for tool evaluation</p>
  </div>
  <div class="page">
    <p>DISCUSSION</p>
    <p>Guidelines for usable tool design  Framework for tool evaluation  Insights for RE automation</p>
  </div>
  <div class="page">
    <p>SUMMARY</p>
    <p>Three Phase Model:  Overview  Sub-component Scanning  Focused Experimentation</p>
    <p>Takeaways:  Guidelines for usable tool design  Framework for tool evaluation  Insights for RE automation</p>
    <p>dvotipka@cs.umd.edu sec-professionals.cs.umd.edu</p>
    <p>Questions:</p>
    <p>Cross-phase trends:  Begin with static methods</p>
    <p>and finish with dynamic  Experience guides where</p>
    <p>to look</p>
  </div>
</Presentation>
