<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>WiFi Mobility without Fast Handover</p>
    <p>Cos7n Raiciu Jointly with Andrei Croitoru and Drago Niculescu</p>
    <p>University Politehnica of Bucharest</p>
  </div>
  <div class="page">
    <p>WiFi mobility is back in fashion</p>
    <p>Cellular data growing at a rate that is not sustainable in the long run Offloading to WiFi touted as a solu=on Ubiquitous Access Point deployments in urban areas</p>
  </div>
  <div class="page">
    <p>AP deployment in Bucharest Center</p>
    <p>WiFi is mostly a sta,c connec,vity solu,on</p>
  </div>
  <div class="page">
    <p>L2 Mobility mantra One AP at a 7me  When link fades, look for new Aps  Scan for new APs  Connect to one of them based on</p>
    <p>Signal strength  User preference  Es=mated capacity</p>
    <p>Client doesnt know best AP un7l it tries it Best AP changes when client is mobile or sta7c</p>
    <p>FAST HANDOVER lots of research</p>
  </div>
  <div class="page">
    <p>Why bother selec7ng best AP?</p>
    <p>Connect to all APs Spread traffic with Mul7path TCP while having a single NIC in the client Implementa=on is straighNorward  On a single channel, use virtual interfaces  Channel switch between different channels</p>
  </div>
  <div class="page">
    <p>Connect to all APs</p>
    <p>So how should traffic be allocated? Most traffic should come via the best AP</p>
    <p>while probing all other APs</p>
  </div>
  <div class="page">
    <p>Mul=path TCP + Mul=ple APs</p>
    <p>Experiments  Single channel</p>
    <p>Hidden terminal  Carrier-sense</p>
    <p>Mul=ple channels  Use channel switching [see paper]</p>
    <p>AP1 AP2</p>
  </div>
  <div class="page">
    <p>Hidden terminal Experiment</p>
    <p>Client near AP1</p>
    <p>Client near AP2</p>
    <p>In-between</p>
    <p>APs</p>
    <p>Th ro</p>
    <p>ug hp</p>
    <p>ut [%</p>
    <p>]</p>
    <p>Position</p>
    <p>UDP1</p>
  </div>
  <div class="page">
    <p>Hidden terminal Experiment</p>
    <p>Client near AP1</p>
    <p>Client near AP2</p>
    <p>In-between</p>
    <p>APs</p>
    <p>Th ro</p>
    <p>ug hp</p>
    <p>ut [%</p>
    <p>]</p>
    <p>Position</p>
    <p>UDP1 UDP2</p>
  </div>
  <div class="page">
    <p>Hidden terminal Experiment</p>
    <p>Client near AP1</p>
    <p>Client near AP2</p>
    <p>In-between</p>
    <p>APs</p>
    <p>Th ro</p>
    <p>ug hp</p>
    <p>ut [%</p>
    <p>]</p>
    <p>Position</p>
    <p>UDP1 UDP2</p>
    <p>UDP1+2</p>
    <p>AP1 transmissions capture transmissions</p>
    <p>from AP2</p>
    <p>UDP throughput drops significantly</p>
  </div>
  <div class="page">
    <p>Th ro</p>
    <p>ug hp</p>
    <p>ut [%</p>
    <p>]</p>
    <p>Position</p>
    <p>UDP1 UDP2</p>
    <p>UDP1+2 MPTCP1+2</p>
    <p>Hidden terminal Experiment</p>
    <p>Client near AP1</p>
    <p>Client near AP2</p>
    <p>In-between</p>
    <p>APs</p>
    <p>Near optimal throughput with MPTCP One subflow always dominates airtime.</p>
  </div>
  <div class="page">
    <p>Carrier Sense experiment APs hear each other</p>
    <p>Th ro</p>
    <p>ug hp</p>
    <p>ut [%</p>
    <p>]</p>
    <p>Position</p>
    <p>TCP via AP1 TCP via AP2</p>
    <p>MPTCP over AP1+2</p>
  </div>
  <div class="page">
    <p>Carrier Sense experiment APs hear each other</p>
    <p>Th ro</p>
    <p>ug hp</p>
    <p>ut [%</p>
    <p>]</p>
    <p>Position</p>
    <p>TCP via AP1 TCP via AP2</p>
    <p>MPTCP over AP1+2</p>
  </div>
  <div class="page">
    <p>MAC with two APs sending AP1 Client</p>
    <p>X</p>
    <p>AP2</p>
    <p>X</p>
  </div>
  <div class="page">
    <p>Th ro</p>
    <p>ug hp</p>
    <p>ut [%</p>
    <p>]</p>
    <p>Position</p>
    <p>TCP via AP1 TCP via AP2</p>
    <p>MPTCP over AP1+2</p>
    <p>The closest AP wins contention most times,</p>
    <p>optimizing airtime usage</p>
    <p>Carrier Sense experiment APs hear each other</p>
  </div>
  <div class="page">
    <p>Th ro</p>
    <p>ug hp</p>
    <p>ut [%</p>
    <p>]</p>
    <p>Position</p>
    <p>TCP via AP1 TCP via AP2</p>
    <p>MPTCP over AP1+2</p>
    <p>MPTCP allows Wifi to exploit channel diversity</p>
    <p>Carrier Sense experiment APs hear each other</p>
  </div>
  <div class="page">
    <p>Great. Are we done?</p>
  </div>
  <div class="page">
    <p>Great. Are we done? NO With 802.11n, MPTCP client gets half the throughput it should receive</p>
  </div>
  <div class="page">
    <p>MAC with two APs sending AP1 Client AP2</p>
    <p>lower rate</p>
    <p>The Wifi MAC gives packet level fairness, reducing total throughput</p>
  </div>
  <div class="page">
    <p>Carrier-Sense performance depends on rate control algorithm  Near-op=mal behaviour when:</p>
    <p>All APs used the same fixed rate  Using minstrel (the default algorithm in Linux)</p>
    <p>Bad behaviour when:  Using less aggressive rate control algorithms  Using minstrel-ht (802.11n)</p>
    <p>Rate control algorithms are specific to each AP vendor. Change is very difficult.</p>
  </div>
  <div class="page">
    <p>MPTCP conges=on control primer</p>
    <p>Move traffic away from congested links  Put most data on the subflow with the</p>
    <p>smallest loss rate  Subflows with higher loss rate only receive</p>
    <p>probe traffic</p>
  </div>
  <div class="page">
    <p>MPTCP conges=on control in WiFi</p>
    <p>AP1 AP2</p>
    <p>p1 p2</p>
    <p>When the MAC gives packet level fairness, p1 = p2</p>
  </div>
  <div class="page">
    <p>Client knows which AP is beeer Client es7mates the average 7me Ti it takes APi to send one packet</p>
    <p>Assuming AP is alone accessing the medium  Passively es=mate PHY loss rates [see paper]</p>
    <p>Client orders its APs according to Ti  Informs server that APj is bad when</p>
    <p>Tj &gt; 1.3 mini=1,N(Ti)</p>
  </div>
  <div class="page">
    <p>Client ECN marking to steer traffic</p>
    <p>AP1 AP2</p>
    <p>p1 p2</p>
    <p>Mark 10% of incoming packets with ECN CE Codepoint</p>
  </div>
  <div class="page">
    <p>Client ECN marking to steer traffic</p>
    <p>AP1 AP2</p>
    <p>p1</p>
    <p>Mark 10% of incoming packets with ECN CE Codepoint</p>
  </div>
  <div class="page">
    <p>MPTCP conges=on control primer</p>
    <p>Move traffic away from congested links  Put most data on the subflow with the</p>
    <p>smallest loss rate  Subflows with higher loss rate only receive</p>
    <p>probe traffic</p>
    <p>Do at least as good as TCP on the best path  Use RTT and loss es=mates on each subflow</p>
    <p>to es=mate what TCP would get</p>
  </div>
  <div class="page">
    <p>Safe ECN Marking</p>
    <p>Mark  packets as congested using ECN</p>
  </div>
  <div class="page">
    <p>Safe ECN Marking</p>
    <p>The client can compute the safe marking threshold delta: Implemented in device-independent part of the WiFi driver of the Linux kernel.</p>
  </div>
  <div class="page">
    <p>How well does ECN marking work for 802.11n?</p>
    <p>Th ro</p>
    <p>ug hp</p>
    <p>ut (M</p>
    <p>bp s)</p>
    <p>Position</p>
    <p>AP1 AP2</p>
    <p>MPTCP MPTCP+ECN</p>
  </div>
  <div class="page">
    <p>Th ro</p>
    <p>ug hp</p>
    <p>ut (M</p>
    <p>bp s)</p>
    <p>TCP connections at the bottleneck link</p>
    <p>TCP via AP 1</p>
    <p>Ensuring good performance with boelenecked APs</p>
  </div>
  <div class="page">
    <p>Ensuring good performance with boelenecked APs</p>
    <p>Th ro</p>
    <p>ug hp</p>
    <p>ut (M</p>
    <p>bp s)</p>
    <p>TCP connections at the bottleneck link</p>
    <p>TCP via AP 1 TCP via AP 2</p>
  </div>
  <div class="page">
    <p>Ensuring good performance with boelenecked APs</p>
    <p>Th ro</p>
    <p>ug hp</p>
    <p>ut (M</p>
    <p>bp s)</p>
    <p>TCP connections at the bottleneck link</p>
    <p>TCP via AP 1 TCP via AP 2</p>
    <p>MPTCP</p>
  </div>
  <div class="page">
    <p>Ensuring good performance with boelenecked APs</p>
    <p>Th ro</p>
    <p>ug hp</p>
    <p>ut (M</p>
    <p>bp s)</p>
    <p>TCP connections at the bottleneck link</p>
    <p>TCP via AP 1 TCP via AP 2</p>
    <p>MPTCP MPTCP + ECN Marking</p>
  </div>
  <div class="page">
    <p>Indoor client, walking speed A mobility experiment</p>
    <p>Th ro</p>
    <p>ug hp</p>
    <p>ut (M</p>
    <p>bp s)</p>
    <p>Position</p>
    <p>AP1 AP2 AP3</p>
  </div>
  <div class="page">
    <p>Indoor client, walking speed A mobility experiment</p>
    <p>Th ro</p>
    <p>ug hp</p>
    <p>ut (M</p>
    <p>bp s)</p>
    <p>Position</p>
    <p>AP1 AP2</p>
    <p>AP3 Handover</p>
  </div>
  <div class="page">
    <p>Indoor client, walking speed A mobility experiment</p>
    <p>Th ro</p>
    <p>ug hp</p>
    <p>ut (M</p>
    <p>bp s)</p>
    <p>Position</p>
    <p>AP1 AP2</p>
    <p>AP3 Handover</p>
    <p>MPTCP+ECN</p>
  </div>
  <div class="page">
    <p>Conclusions</p>
    <p>MPTCP + WiFi =</p>
    <p>Match made in heaven:  Hidden terminals  CS, all senders use the same rate  CS, minstrel</p>
    <p>Human interven7on needed via ECN:  Robust across all cases we tested Code available at: hep://mobil4.org/mul=wifi/</p>
  </div>
  <div class="page">
    <p>Backup</p>
  </div>
  <div class="page">
    <p>Es=ma=ng the PHY Loss rate AP Client</p>
    <p>X</p>
    <p>X</p>
    <p>X Obvious formula:</p>
    <p>Client doesnt know Ntotal</p>
  </div>
  <div class="page">
    <p>Es=ma=ng the PHY Loss rate: Retry bit AP</p>
    <p>Client</p>
    <p>X</p>
    <p>X</p>
    <p>X packet</p>
    <p>packet 2</p>
    <p>packet 3</p>
    <p>packet 4</p>
  </div>
  <div class="page">
    <p>Es=ma=ng the PHY Loss rate: Retry bit AP</p>
    <p>Client</p>
    <p>X</p>
    <p>X</p>
    <p>X packet</p>
    <p>packet 2</p>
    <p>packet 3</p>
    <p>packet 4</p>
    <p>Estimate delivery probability for first transmission of each packet</p>
    <p>N0 #packets received without retry bit=0 N1 #packets received without retry bit=1 Nlost #lost packets</p>
  </div>
  <div class="page">
    <p>Client-side loss es=ma=on in prac=ce</p>
  </div>
  <div class="page"/>
  <div class="page">
    <p>Simple experiment to understand whats going on</p>
    <p>Ns2 simula7on</p>
    <p>UDP fill pipe</p>
    <p>UDP One packet / second</p>
  </div>
  <div class="page">
    <p>Loss experienced as a func=on of Wifi Retry Count</p>
  </div>
  <div class="page">
    <p>Sta=onary client</p>
  </div>
</Presentation>
