<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>P2P File-Sharing in Hell: Exploiting BitTorrent Vulnerabilities to Launch Distributed Reflective</p>
    <p>DoS Attacks</p>
    <p>Florian Adamsky, Syed Ali Khayam, Rudolf Jger and Muttukrishnan Rajarajan</p>
    <p>florian-woot15@adamsky.it http://florian.adamsky.it/</p>
  </div>
  <div class="page">
    <p>Outline</p>
  </div>
  <div class="page">
    <p>Table of Contents</p>
  </div>
  <div class="page"/>
  <div class="page"/>
  <div class="page">
    <p>DRDoS Attacks Thread Model</p>
    <p>PA</p>
    <p>Attacker</p>
    <p>PA</p>
    <p>PA</p>
    <p>PA</p>
    <p>Amplifiers</p>
    <p>PV</p>
    <p>Victim</p>
    <p>BA</p>
    <p>BA</p>
    <p>B A</p>
    <p>B V</p>
    <p>BV</p>
    <p>BV</p>
    <p>Bandwidth Amplification Factor (BAF) Christian Rossow introduced the Bandwidth Amplification Factor (BAF):</p>
    <p>BAF = |Bv| |Ba|</p>
  </div>
  <div class="page">
    <p>DRDoS Attacks Thread Model</p>
    <p>PA</p>
    <p>Attacker</p>
    <p>PA</p>
    <p>PA</p>
    <p>PA</p>
    <p>Amplifiers</p>
    <p>PV</p>
    <p>Victim</p>
    <p>BA</p>
    <p>BA</p>
    <p>B A</p>
    <p>B V</p>
    <p>BV</p>
    <p>BV</p>
    <p>Bandwidth Amplification Factor (BAF) Christian Rossow introduced the Bandwidth Amplification Factor (BAF):</p>
    <p>BAF = |Bv| |Ba|</p>
  </div>
  <div class="page">
    <p>DRDoS Attacks Thread Model</p>
    <p>PA</p>
    <p>Attacker</p>
    <p>PA</p>
    <p>PA</p>
    <p>PA</p>
    <p>Amplifiers</p>
    <p>PV</p>
    <p>Victim</p>
    <p>BA</p>
    <p>BA</p>
    <p>B A</p>
    <p>B V</p>
    <p>BV</p>
    <p>BV</p>
    <p>Bandwidth Amplification Factor (BAF) Christian Rossow introduced the Bandwidth Amplification Factor (BAF):</p>
    <p>BAF = |Bv| |Ba|</p>
  </div>
  <div class="page">
    <p>DRDoS Attacks Thread Model</p>
    <p>PA</p>
    <p>Attacker</p>
    <p>PA</p>
    <p>PA</p>
    <p>PA</p>
    <p>Amplifiers</p>
    <p>PV</p>
    <p>Victim</p>
    <p>BA</p>
    <p>BA</p>
    <p>B A</p>
    <p>B V</p>
    <p>BV</p>
    <p>BV</p>
    <p>Bandwidth Amplification Factor (BAF) Christian Rossow introduced the Bandwidth Amplification Factor (BAF):</p>
    <p>BAF = |Bv| |Ba|</p>
  </div>
  <div class="page">
    <p>Example: BAF = 5</p>
    <p>PA</p>
    <p>Attacker</p>
    <p>PA</p>
    <p>PA</p>
    <p>PA</p>
    <p>Amplifiers</p>
    <p>PV</p>
    <p>Victim</p>
    <p>BA</p>
    <p>BA</p>
    <p>B A</p>
    <p>B V</p>
    <p>BV</p>
    <p>BV</p>
    <p>BA = 1 Gbps BV = 5 Gbps</p>
  </div>
  <div class="page">
    <p>Example: BAF = 5</p>
    <p>PA</p>
    <p>Attacker</p>
    <p>PA</p>
    <p>PA</p>
    <p>PA</p>
    <p>Amplifiers</p>
    <p>PV</p>
    <p>Victim</p>
    <p>BA</p>
    <p>BA</p>
    <p>B A</p>
    <p>B V</p>
    <p>BV</p>
    <p>BV</p>
    <p>BA = 1 Gbps</p>
    <p>BV = 5 Gbps</p>
  </div>
  <div class="page">
    <p>Example: BAF = 5</p>
    <p>PA</p>
    <p>Attacker</p>
    <p>PA</p>
    <p>PA</p>
    <p>PA</p>
    <p>Amplifiers</p>
    <p>PV</p>
    <p>Victim</p>
    <p>BA</p>
    <p>BA</p>
    <p>B A</p>
    <p>B V</p>
    <p>BV</p>
    <p>BV</p>
    <p>BA = 1 Gbps BV = 5 Gbps</p>
  </div>
  <div class="page">
    <p>Advantages of a DRDoS Attack</p>
    <p>Attacker hides his own identity</p>
    <p>It can be initiated by a single computer, results in a distributed attack</p>
    <p>Amplifiers send a larger packet to the victim and therefore increase the impact of the attack</p>
  </div>
  <div class="page">
    <p>Worldwide Application Usage</p>
    <p>Source: Paloalto Networks9/34</p>
  </div>
  <div class="page">
    <p>Worldwide Application Usage</p>
    <p>BitTorrent % of total bandwidth: 3.35 %</p>
    <p>Source: Paloalto Networks10/34</p>
  </div>
  <div class="page">
    <p>BitTorrents protocol overview</p>
    <p>Variety of UDP-based protocols are used: Distributed Hash Table (DHT) Micro Transport Protocol (uTP)</p>
  </div>
  <div class="page">
    <p>Micro Transport Protocol (uTP)</p>
    <p>uTP is a reliable transport protocol which makes use of UDP Similarities to TCP</p>
    <p>Window based flow control Sequence numbers and ACK numbers</p>
    <p>Differences to TCP Sequence numbers and ACKs refer to packets, not bytes No congestion control (Slow-start, congestion avoidance, )  LEDBAT Two-way handshake instead of a three-way handshake</p>
  </div>
  <div class="page">
    <p>uTPs two-way handshake</p>
    <p>Initiator Receiver</p>
    <p>SYN_SENT ST_SYN</p>
    <p>CONNECTED</p>
    <p>CONNECTED</p>
    <p>ST_S TATE</p>
    <p>connection established</p>
  </div>
  <div class="page">
    <p>uTPs two-way handshake</p>
    <p>Initiator Receiver SYN_SENT ST_SYN</p>
    <p>CONNECTED</p>
    <p>CONNECTED</p>
    <p>ST_S TATE</p>
    <p>connection established</p>
  </div>
  <div class="page">
    <p>uTPs two-way handshake</p>
    <p>Initiator Receiver SYN_SENT ST_SYN</p>
    <p>CONNECTED</p>
    <p>CONNECTED</p>
    <p>ST_S TATE</p>
    <p>connection established</p>
  </div>
  <div class="page">
    <p>uTPs two-way handshake</p>
    <p>Initiator Receiver SYN_SENT ST_SYN</p>
    <p>CONNECTED</p>
    <p>CONNECTED</p>
    <p>ST_S TATE</p>
    <p>connection established</p>
  </div>
  <div class="page">
    <p>Table of Contents</p>
  </div>
  <div class="page">
    <p>BitTorrent Handshake</p>
    <p>&lt;pstrlen&gt;&lt;pstr&gt;&lt;extensions&gt;&lt;info_hash&gt;&lt;peer_id&gt;</p>
    <p>pstrlen = 19</p>
    <p>pstr = BitTorrent protocol</p>
    <p>extensions 8 bytes reserved</p>
    <p>info_hash 20 byte</p>
    <p>peer_id 20 byte</p>
  </div>
  <div class="page">
    <p>Exploiting uTPs two-way handshake</p>
    <p>Attacker Amplifier Victim</p>
    <p>ST_SYNa)</p>
    <p>ST_STATE</p>
    <p>b)</p>
    <p>ST_DATA (Handshake) c)</p>
    <p>ST_DATA (Handshake) d)ST_DATA (Handshake)ST_DATA (Handshake)</p>
  </div>
  <div class="page">
    <p>Exploiting uTPs two-way handshake</p>
    <p>Attacker Amplifier Victim</p>
    <p>ST_SYNa)</p>
    <p>ST_STATE</p>
    <p>b)</p>
    <p>ST_DATA (Handshake) c)</p>
    <p>ST_DATA (Handshake) d)ST_DATA (Handshake)ST_DATA (Handshake)</p>
  </div>
  <div class="page">
    <p>Exploiting uTPs two-way handshake</p>
    <p>Attacker Amplifier Victim</p>
    <p>ST_SYNa)</p>
    <p>ST_STATE</p>
    <p>b)</p>
    <p>ST_DATA (Handshake) c)</p>
    <p>ST_DATA (Handshake) d)ST_DATA (Handshake)ST_DATA (Handshake)</p>
  </div>
  <div class="page">
    <p>Exploiting uTPs two-way handshake</p>
    <p>Attacker Amplifier Victim</p>
    <p>ST_SYNa)</p>
    <p>ST_STATE</p>
    <p>b)</p>
    <p>ST_DATA (Handshake) c)</p>
    <p>ST_DATA (Handshake) d)ST_DATA (Handshake)ST_DATA (Handshake)</p>
  </div>
  <div class="page">
    <p>Exploiting uTPs two-way handshake</p>
    <p>Attacker Amplifier Victim</p>
    <p>ST_SYNa)</p>
    <p>ST_STATE</p>
    <p>b)</p>
    <p>ST_DATA (Handshake) c)</p>
    <p>ST_DATA (Handshake) d)</p>
    <p>ST_DATA (Handshake)ST_DATA (Handshake)</p>
  </div>
  <div class="page">
    <p>Exploiting uTPs two-way handshake</p>
    <p>Attacker Amplifier Victim</p>
    <p>ST_SYNa)</p>
    <p>ST_STATE</p>
    <p>b)</p>
    <p>ST_DATA (Handshake) c)</p>
    <p>ST_DATA (Handshake) d)ST_DATA (Handshake)</p>
    <p>ST_DATA (Handshake)</p>
  </div>
  <div class="page">
    <p>Exploiting uTPs two-way handshake</p>
    <p>Attacker Amplifier Victim</p>
    <p>ST_SYNa)</p>
    <p>ST_STATE</p>
    <p>b)</p>
    <p>ST_DATA (Handshake) c)</p>
    <p>ST_DATA (Handshake) d)ST_DATA (Handshake)ST_DATA (Handshake)</p>
  </div>
  <div class="page">
    <p>BV &gt; BA</p>
    <p>Definition (Packet Stuffing) Try to cram as much BitTorrent messages into one packet as possible to minimize the connection establishment protocol flow</p>
  </div>
  <div class="page">
    <p>Amplification Factors (BitTorrent)</p>
    <p>Description BAF PAF ucat 351.5 6 uTorrent w/o extensions 27.6 3.5 Mainline w/o extensions 27.8 3.5 uTorrent with LTEP 39.6 3 Mainline with LTEP 39.6 3 Vuze w/o extensions 13.9 2 Vuze with LTEP 18.7 2 Vuze with AMP 54.3 3.5 Transmission w/o extensions 4.0 3.5 Transmission with LTEP 4.0 3.5 Transmission with AMP 4.0 3.5 Libtorrent w/o extensions 5.2 4 Libtorrent with LTEP 5.2 4</p>
  </div>
  <div class="page">
    <p>Amplification Factors (BitTorrent)</p>
    <p>Description BAF PAF ucat 351.5 6 uTorrent w/o extensions 27.6 3.5 Mainline w/o extensions 27.8 3.5 uTorrent with LTEP 39.6 3 Mainline with LTEP 39.6 3 Vuze w/o extensions 13.9 2 Vuze with LTEP 18.7 2 Vuze with AMP 54.3 3.5 Transmission w/o extensions 4.0 3.5 Transmission with LTEP 4.0 3.5 Transmission with AMP 4.0 3.5 Libtorrent w/o extensions 5.2 4 Libtorrent with LTEP 5.2 4</p>
  </div>
  <div class="page">
    <p>Amplification Factors (BitTorrent)</p>
    <p>Description BAF PAF ucat 351.5 6 uTorrent w/o extensions 27.6 3.5 Mainline w/o extensions 27.8 3.5 uTorrent with LTEP 39.6 3 Mainline with LTEP 39.6 3 Vuze w/o extensions 13.9 2 Vuze with LTEP 18.7 2 Vuze with AMP 54.3 3.5 Transmission w/o extensions 4.0 3.5 Transmission with LTEP 4.0 3.5 Transmission with AMP 4.0 3.5 Libtorrent w/o extensions 5.2 4 Libtorrent with LTEP 5.2 4</p>
  </div>
  <div class="page">
    <p>Amplification Factors (BitTorrent)</p>
    <p>Description BAF PAF ucat 351.5 6 uTorrent w/o extensions 27.6 3.5 Mainline w/o extensions 27.8 3.5 uTorrent with LTEP 39.6 3 Mainline with LTEP 39.6 3 Vuze w/o extensions 13.9 2 Vuze with LTEP 18.7 2 Vuze with AMP 54.3 3.5 Transmission w/o extensions 4.0 3.5 Transmission with LTEP 4.0 3.5 Transmission with AMP 4.0 3.5 Libtorrent w/o extensions 5.2 4 Libtorrent with LTEP 5.2 4</p>
  </div>
  <div class="page">
    <p>Amplification Factors (BitTorrent)</p>
    <p>Description BAF PAF ucat 351.5 6 uTorrent w/o extensions 27.6 3.5 Mainline w/o extensions 27.8 3.5 uTorrent with LTEP 39.6 3 Mainline with LTEP 39.6 3 Vuze w/o extensions 13.9 2 Vuze with LTEP 18.7 2 Vuze with AMP 54.3 3.5 Transmission w/o extensions 4.0 3.5 Transmission with LTEP 4.0 3.5 Transmission with AMP 4.0 3.5 Libtorrent w/o extensions 5.2 4 Libtorrent with LTEP 5.2 4</p>
  </div>
  <div class="page">
    <p>Amplification Factors (BitTorrent)</p>
    <p>Description BAF PAF ucat 351.5 6 uTorrent w/o extensions 27.6 3.5 Mainline w/o extensions 27.8 3.5 uTorrent with LTEP 39.6 3 Mainline with LTEP 39.6 3 Vuze w/o extensions 13.9 2 Vuze with LTEP 18.7 2 Vuze with AMP 54.3 3.5 Transmission w/o extensions 4.0 3.5 Transmission with LTEP 4.0 3.5 Transmission with AMP 4.0 3.5 Libtorrent w/o extensions 5.2 4 Libtorrent with LTEP 5.2 4</p>
  </div>
  <div class="page">
    <p>Amplification Factors (BitTorrent)</p>
    <p>Description BAF PAF ucat 351.5 6 uTorrent w/o extensions 27.6 3.5 Mainline w/o extensions 27.8 3.5 uTorrent with LTEP 39.6 3 Mainline with LTEP 39.6 3 Vuze w/o extensions 13.9 2 Vuze with LTEP 18.7 2 Vuze with AMP 54.3 3.5 Transmission w/o extensions 4.0 3.5 Transmission with LTEP 4.0 3.5 Transmission with AMP 4.0 3.5 Libtorrent w/o extensions 5.2 4 Libtorrent with LTEP 5.2 4</p>
  </div>
  <div class="page">
    <p>Amplification Factors (BitTorrent)</p>
    <p>Description BAF PAF ucat 351.5 6 uTorrent w/o extensions 27.6 3.5 Mainline w/o extensions 27.8 3.5 uTorrent with LTEP 39.6 3 Mainline with LTEP 39.6 3 Vuze w/o extensions 13.9 2 Vuze with LTEP 18.7 2 Vuze with AMP 54.3 3.5 Transmission w/o extensions 4.0 3.5 Transmission with LTEP 4.0 3.5 Transmission with AMP 4.0 3.5 Libtorrent w/o extensions 5.2 4 Libtorrent with LTEP 5.2 4</p>
  </div>
  <div class="page">
    <p>Message Stream Encryption (MSE)</p>
    <p>Aim of MSE is to obfuscate BitTorrent traffic to avoid shaping</p>
    <p>MSE starts a Diffie-Hellman key exchange</p>
    <p>After the key exchange BitTorrent packets are RC4 encrypted</p>
    <p>Initiator Receiver PA = ga mod p RA = 0 bytes  RA  512 bytes</p>
    <p>PA, RA PB = ga mod p RB = 0 bytes  RB  512 bytesPB, RB</p>
    <p>Amplification Factor (MSE)</p>
  </div>
  <div class="page">
    <p>Message Stream Encryption (MSE)</p>
    <p>Aim of MSE is to obfuscate BitTorrent traffic to avoid shaping</p>
    <p>MSE starts a Diffie-Hellman key exchange</p>
    <p>After the key exchange BitTorrent packets are RC4 encrypted</p>
    <p>Initiator Receiver</p>
    <p>PA = ga mod p RA = 0 bytes  RA  512 bytes</p>
    <p>PA, RA PB = ga mod p RB = 0 bytes  RB  512 bytesPB, RB</p>
    <p>Amplification Factor (MSE)</p>
  </div>
  <div class="page">
    <p>Message Stream Encryption (MSE)</p>
    <p>Aim of MSE is to obfuscate BitTorrent traffic to avoid shaping</p>
    <p>MSE starts a Diffie-Hellman key exchange</p>
    <p>After the key exchange BitTorrent packets are RC4 encrypted</p>
    <p>Initiator Receiver PA = ga mod p RA = 0 bytes  RA  512 bytes</p>
    <p>PA, RA PB = ga mod p RB = 0 bytes  RB  512 bytesPB, RB</p>
    <p>Amplification Factor (MSE)</p>
  </div>
  <div class="page">
    <p>Message Stream Encryption (MSE)</p>
    <p>Aim of MSE is to obfuscate BitTorrent traffic to avoid shaping</p>
    <p>MSE starts a Diffie-Hellman key exchange</p>
    <p>After the key exchange BitTorrent packets are RC4 encrypted</p>
    <p>Initiator Receiver PA = ga mod p RA = 0 bytes  RA  512 bytes</p>
    <p>PA, RA</p>
    <p>PB = ga mod p RB = 0 bytes  RB  512 bytesPB, RB</p>
    <p>Amplification Factor (MSE)</p>
  </div>
  <div class="page">
    <p>Message Stream Encryption (MSE)</p>
    <p>Aim of MSE is to obfuscate BitTorrent traffic to avoid shaping</p>
    <p>MSE starts a Diffie-Hellman key exchange</p>
    <p>After the key exchange BitTorrent packets are RC4 encrypted</p>
    <p>Initiator Receiver PA = ga mod p RA = 0 bytes  RA  512 bytes</p>
    <p>PA, RA PB = ga mod p RB = 0 bytes  RB  512 bytes</p>
    <p>PB, RB</p>
    <p>Amplification Factor (MSE)</p>
  </div>
  <div class="page">
    <p>Message Stream Encryption (MSE)</p>
    <p>Aim of MSE is to obfuscate BitTorrent traffic to avoid shaping</p>
    <p>MSE starts a Diffie-Hellman key exchange</p>
    <p>After the key exchange BitTorrent packets are RC4 encrypted</p>
    <p>Initiator Receiver PA = ga mod p RA = 0 bytes  RA  512 bytes</p>
    <p>PA, RA PB = ga mod p RB = 0 bytes  RB  512 bytesPB, RB</p>
    <p>Amplification Factor (MSE)</p>
  </div>
  <div class="page">
    <p>Message Stream Encryption (MSE)</p>
    <p>Aim of MSE is to obfuscate BitTorrent traffic to avoid shaping</p>
    <p>MSE starts a Diffie-Hellman key exchange</p>
    <p>After the key exchange BitTorrent packets are RC4 encrypted</p>
    <p>Initiator Receiver PA = ga mod p RA = 0 bytes  RA  512 bytes</p>
    <p>PA, RA PB = ga mod p RB = 0 bytes  RB  512 bytesPB, RB</p>
    <p>Amplification Factor (MSE)</p>
  </div>
  <div class="page">
    <p>Distributed Hash Table</p>
    <p>DHT implementation in BitTorrent is divided into two protocols: Mainline DHT (MLDHT) Vuze DHT (VDHT)</p>
    <p>MLDHT is by far the biggest overlay network (around 1527 million users per day)</p>
    <p>Both protocols are not compatible with each other</p>
  </div>
  <div class="page">
    <p>Amplification Factors (DHT)</p>
    <p>Implementation Description BAF MLDHT ping 0.8</p>
    <p>find_node with K = 8 3.1 get_peers with 100 peers (IPv4) 11.9 get_peers with 100 peers (IPv6) 24.5 get_peers with scrapes 13.4</p>
    <p>VDHT ping 0.8 ping with Vivaldi coordinates 14.9</p>
  </div>
  <div class="page">
    <p>Amplification Factors (DHT)</p>
    <p>Implementation Description BAF MLDHT ping 0.8</p>
    <p>find_node with K = 8 3.1 get_peers with 100 peers (IPv4) 11.9 get_peers with 100 peers (IPv6) 24.5 get_peers with scrapes 13.4</p>
    <p>VDHT ping 0.8 ping with Vivaldi coordinates 14.9</p>
  </div>
  <div class="page">
    <p>Amplification Factors (DHT)</p>
    <p>Implementation Description BAF MLDHT ping 0.8</p>
    <p>find_node with K = 8 3.1 get_peers with 100 peers (IPv4) 11.9 get_peers with 100 peers (IPv6) 24.5 get_peers with scrapes 13.4</p>
    <p>VDHT ping 0.8 ping with Vivaldi coordinates 14.9</p>
  </div>
  <div class="page">
    <p>Amplification Factors (DHT)</p>
    <p>Implementation Description BAF MLDHT ping 0.8</p>
    <p>find_node with K = 8 3.1 get_peers with 100 peers (IPv4) 11.9 get_peers with 100 peers (IPv6) 24.5 get_peers with scrapes 13.4</p>
    <p>VDHT ping 0.8 ping with Vivaldi coordinates 14.9</p>
  </div>
  <div class="page">
    <p>BitTorrent Sync</p>
    <p>Proprietary protocol to synchronize files in a P2P way</p>
    <p>BTSync reached the 1 million users mark in 2013</p>
    <p>BTSync also uses uTP as its transport protocol</p>
  </div>
  <div class="page">
    <p>Amplification Vulnerabilities (BTSync)</p>
    <p>Message BAF BTSync handshake 10.8 ping 120</p>
  </div>
  <div class="page">
    <p>Amplification Vulnerabilities (BTSync)</p>
    <p>Message BAF BTSync handshake 10.8 ping 120</p>
  </div>
  <div class="page">
    <p>Amplification Vulnerabilities (BTSync)</p>
    <p>Message BAF BTSync handshake 10.8 ping 120</p>
  </div>
  <div class="page">
    <p>BTSync: ping flood</p>
  </div>
  <div class="page">
    <p>Evadability</p>
    <p>D N S 13</p>
    <p>N TP</p>
    <p>1 4</p>
    <p>B TH</p>
    <p>M LD</p>
    <p>H T</p>
    <p>V D H T</p>
    <p>B TS</p>
    <p>yn c</p>
    <p>M SE</p>
    <p>SPI firwall X X DPI firewall X X X X</p>
  </div>
  <div class="page">
    <p>Table of Contents</p>
  </div>
  <div class="page">
    <p>Experimental Evaluation</p>
    <p>Time in seconds (s)</p>
    <p>P ay</p>
    <p>lo ad</p>
    <p>si ze</p>
    <p>in by</p>
    <p>te s</p>
    <p>BV = Traffic to the victim BA = Traffic to the amplifiers</p>
    <p>Figure: Amplification attack with 1 attacker, 31 amplifiers and 1 victim. 27/34</p>
  </div>
  <div class="page">
    <p>BitTorrent Crawler</p>
    <p>We wrote a BitTorrent Crawler in Elixir</p>
    <p>Used PirateBay magnet link database from Feb 2012 We collected overall 9.6 million peers via MLDHT</p>
    <p>Beginning from 1st January 2015 until 1st February 2015.</p>
    <p>SuperVisor</p>
    <p>SuperVisor SuperVisorDB Worker</p>
    <p>DHT Harvester</p>
    <p>Peer RequesterDB</p>
    <p>Internet</p>
  </div>
  <div class="page">
    <p>Payload size from the DHT responses</p>
    <p>104</p>
    <p>Payload size in bytes</p>
    <p>N u m be</p>
    <p>r of</p>
    <p>re ce</p>
    <p>iv ed</p>
    <p>p ac</p>
    <p>ke ts</p>
    <p>Figure: Histogram of the payload size from the DHT responses which are caused by get_peers requests. The numbers on top of the bars are the average BAF values.</p>
  </div>
  <div class="page">
    <p>BitTorrent handshake size from the uTP responses</p>
    <p>BitTorrent Handshake size in bytes</p>
    <p>N u m be</p>
    <p>r of</p>
    <p>re ce</p>
    <p>iv ed</p>
    <p>p ac</p>
    <p>ke ts</p>
    <p>Figure: Histogram of the BitTorrent handshake size from the uTP responses. 30/34</p>
  </div>
  <div class="page">
    <p>BitTorrent handshake size from the uTP responses</p>
    <p>BitTorrent Handshake size in bytes</p>
    <p>N u m be</p>
    <p>r of</p>
    <p>re ce</p>
    <p>iv ed</p>
    <p>p ac</p>
    <p>ke ts</p>
    <p>Figure: Histogram of the BitTorrent handshake size from the uTP responses. 30/34</p>
  </div>
  <div class="page">
    <p>BitTorrent handshake size from the uTP responses</p>
    <p>BitTorrent Handshake size in bytes</p>
    <p>N u m be</p>
    <p>r of</p>
    <p>re ce</p>
    <p>iv ed</p>
    <p>p ac</p>
    <p>ke ts</p>
    <p>Figure: Histogram of the BitTorrent handshake size from the uTP responses. 30/34</p>
  </div>
  <div class="page">
    <p>BitTorrent handshake size from the uTP responses</p>
    <p>BitTorrent Handshake size in bytes</p>
    <p>N u m be</p>
    <p>r of</p>
    <p>re ce</p>
    <p>iv ed</p>
    <p>p ac</p>
    <p>ke ts</p>
    <p>Figure: Histogram of the BitTorrent handshake size from the uTP responses. 30/34</p>
  </div>
  <div class="page">
    <p>Table of Contents</p>
  </div>
  <div class="page">
    <p>Coutermeasures</p>
    <p>ISP side BCP 38 (ingress filtering)</p>
    <p>Protocol side uTP</p>
    <p>Three-way handshake Verify the second acknowledgment</p>
    <p>DHT Token scheme (similar to announce_peer)</p>
  </div>
  <div class="page">
    <p>Coutermeasures</p>
    <p>ISP side BCP 38 (ingress filtering)</p>
    <p>Protocol side uTP</p>
    <p>Three-way handshake Verify the second acknowledgment</p>
    <p>DHT Token scheme (similar to announce_peer)</p>
  </div>
  <div class="page">
    <p>Conclusion</p>
    <p>BitTorrent and BitTorrent Sync are vulnerable to DRDoS attacks</p>
    <p>Attacker is able to amplify traffic up to 50 times and with BTSync up to 120 times</p>
    <p>With Trackers, DHT and PEX, an attacker can collect millions of amplifiers Hard to circumvent, as the found vulnerabilities can only be defended with a DPI firewall</p>
    <p>in case of MSE it is even harder</p>
    <p>Responsible Disclosure uTorrent 3.4.4 49854 (beta) is released today!</p>
  </div>
  <div class="page">
    <p>Conclusion</p>
    <p>BitTorrent and BitTorrent Sync are vulnerable to DRDoS attacks</p>
    <p>Attacker is able to amplify traffic up to 50 times and with BTSync up to 120 times</p>
    <p>With Trackers, DHT and PEX, an attacker can collect millions of amplifiers Hard to circumvent, as the found vulnerabilities can only be defended with a DPI firewall</p>
    <p>in case of MSE it is even harder</p>
    <p>Responsible Disclosure uTorrent 3.4.4 49854 (beta) is released today!</p>
  </div>
  <div class="page">
    <p>Thank You</p>
    <p>Questions? florian-woot15@adamsky.it</p>
    <p>http://florian.adamsky.it/</p>
    <p>Institutions:</p>
  </div>
</Presentation>
