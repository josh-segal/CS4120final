<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Measuring*Pay-Per-Install:** The*Commodi8za8on*of*Malware*Distribu8on*</p>
    <p>Juan*Caballero,*Chris&amp;Grier,** Chris8an*Kreibich*and*Vern*Paxson*</p>
    <p>* IMDEA*SoGware*Ins8tute,*UC*Berkeley,** Interna8onal*Computer*Science*Ins8tute*</p>
  </div>
  <div class="page"/>
  <div class="page"/>
  <div class="page"/>
  <div class="page">
    <p>Market*for*Malware*Installa8on*  Goal:&amp;Measure&amp;and&amp;understand&amp;the&amp;the&amp;pay4per4install&amp;</p>
    <p>ecosystem*</p>
    <p>Our*approach:*  Infiltrate*four*PPI*programs*  Develop*milkers*to*automa8cally*download*malware*  Download,*execute,*and*classify*malware*being*installed*</p>
    <p>Insights*into*the*pay-per-install*business*  Real-8me*monitoring*of*changes*in*malware*ecosystem*  Types*of*clients*using*PPI*  Financial*impacts*of*botnet*takedown*</p>
  </div>
  <div class="page">
    <p>Outline*</p>
    <p>Background*on*pay-per-install*  Infiltra8on*and*monitoring*of*PPI*  Results*and*measurements*  Malware*being*installed*by*PPI*  Repacking*of*malware*  Geographically*diverse*distribu8on*</p>
  </div>
  <div class="page">
    <p>PPI*Ecosystem*  Clients*</p>
    <p>Pay*the*PPI*  Want*malware*installed*  Spambots,*informa8on*</p>
    <p>harves8ng,*rootkits,*fake*AV*</p>
    <p>Pay-per-install*(PPI)*  Purchases*compromised*</p>
    <p>hosts*from*affiliates*  Resells*to*clients*</p>
    <p>Affiliates*  Compromise*machines*  Execute*the*PPIs*binary*</p>
  </div>
  <div class="page">
    <p>PPI*Ecosystem*  Clients*</p>
    <p>Pay*the*PPI*  Want*malware*installed*  Spambots,*informa8on*</p>
    <p>harves8ng,*rootkits,*fake*AV*</p>
    <p>Pay-per-install*(PPI)*  Purchases*compromised*</p>
    <p>hosts*from*affiliates*  Resells*to*clients*</p>
    <p>Affiliates*  Compromise*machines*  Execute*the*PPIs*binary*</p>
  </div>
  <div class="page">
    <p>PPI*Ecosystem*  Clients*</p>
    <p>Pay*the*PPI*  Want*malware*installed*  Spambots,*informa8on*</p>
    <p>harves8ng,*rootkits,*fake*AV*</p>
    <p>Pay-per-install*(PPI)*  Purchases*compromised*</p>
    <p>hosts*from*affiliates*  Resells*to*clients*</p>
    <p>Affiliates*  Compromise*machines*  Execute*the*PPIs*binary*</p>
  </div>
  <div class="page">
    <p>PPI&amp;exe&amp;</p>
    <p>Rustock4dl&amp;</p>
    <p>PPI&amp;exe&amp;</p>
    <p>PPI&amp;exe&amp;</p>
    <p>Rustock&amp;</p>
    <p>PPI&amp;exe&amp;</p>
    <p>Pushdo&amp;</p>
    <p>Torpig&amp;</p>
    <p>Pinit&amp;</p>
    <p>Ambler&amp;</p>
    <p>Zbot&amp;</p>
    <p>Dropper*Lifecycle*</p>
    <p>Cutwail&amp; Malware&amp;exe&amp;</p>
    <p>PPI&amp;related&amp;exe&amp;</p>
  </div>
  <div class="page">
    <p>PPI&amp;InfiltraGon&amp;and&amp;Monitoring&amp;</p>
  </div>
  <div class="page">
    <p>Infiltra8on*Summary*  12*of*the*20*most*popular*families*of*malware* distributed*by*PPI*services*</p>
    <p>Infiltrated*four*PPI*command*and*control*networks*  Con8nual*monitoring*of*C&amp;C*  Download*new*binaries*  Download*from*geo-diverse*loca8ons*</p>
    <p>Dropped*Malware*  1,060,895*client*binaries*downloaded*  9,153*dis8nct*binaries*</p>
  </div>
  <div class="page">
    <p>PPI*Milking*System*</p>
  </div>
  <div class="page">
    <p>Milking*PPI*Services*</p>
  </div>
  <div class="page">
    <p>Running*Malware*</p>
    <p>GQ:&amp;PracGcal&amp;Containment&amp;for&amp;Measuring&amp;Modern&amp;Malware&amp;Systems&amp; C.*Kreibich,*N.*Weaver,*C.*Kanich,*W.*Cui,*V.*Paxson.*IMC*2011.*</p>
  </div>
  <div class="page">
    <p>Classifying*Malware*</p>
  </div>
  <div class="page">
    <p>Malware*Family*Coverage*</p>
  </div>
  <div class="page">
    <p>Most*Seen*Families:*Aug*2010*</p>
  </div>
  <div class="page">
    <p>Binary*Repacking*  Repacking*or*cryp8ng*  Changes*program*content*without*changing*func8onality*  Frequency*reflects*concern*about*AV*signatures*</p>
    <p>*  PPI*client*binaries*  Depends*on*family*of*malware*  Average*repacking*every*11*days*</p>
    <p>PPI*affiliate*binaries*  Repacking*done*by*PPI,*usually*daily*  Zlob*repacking*done*on-the-fly*</p>
  </div>
  <div class="page">
    <p>MD5s*by*date*for*August,*2010*for*two*families*of*malware.*</p>
    <p>Date</p>
    <p>M D 5</p>
    <p>| |</p>
    <p>|</p>
    <p>|</p>
    <p>| |</p>
    <p>|</p>
    <p>|</p>
    <p>|</p>
    <p>|</p>
    <p>|</p>
    <p>|</p>
    <p>|</p>
    <p>|</p>
    <p>|</p>
    <p>|</p>
    <p>| |</p>
    <p>|</p>
    <p>|</p>
    <p>| |</p>
    <p>|</p>
    <p>|</p>
    <p>|</p>
    <p>|</p>
    <p>|</p>
    <p>|</p>
    <p>|</p>
    <p>|</p>
    <p>|</p>
    <p>|</p>
    <p>VM Detection no yes</p>
    <p>Date</p>
    <p>M D 5</p>
    <p>||||| | |||</p>
    <p>|||| | | ||| |</p>
    <p>| || | | || | | | |</p>
    <p>| || || |||| ||</p>
    <p>| |||| || || | |</p>
    <p>|||| | | | ||</p>
    <p>|| | |</p>
    <p>| | | |</p>
    <p>| | | | |</p>
    <p>|| || | | || ||</p>
    <p>|||| | | ||</p>
    <p>| || | | ||| ||</p>
    <p>|| ||| ||</p>
    <p>|| ||| | |||</p>
    <p>|| || | || || |</p>
    <p>| || | || || | | |</p>
    <p>| || || | ||| ||</p>
    <p>||| || || || | |</p>
    <p>|| || | || ||</p>
    <p>| | | |</p>
    <p>| | | |</p>
    <p>| || | |</p>
    <p>|| || | | ||||</p>
    <p>|| || | |||</p>
    <p>| | | | | || | || ||</p>
    <p>| || ||</p>
    <p>VM Detection || no yes</p>
    <p>Rustock* SecuritySuite*</p>
  </div>
  <div class="page">
    <p>Date</p>
    <p>M D 5</p>
    <p>||||| | |||</p>
    <p>|||| | | ||| |</p>
    <p>| || | | || | | | |</p>
    <p>| || || |||| ||</p>
    <p>| |||| || || | |</p>
    <p>|||| | | | ||</p>
    <p>|| | |</p>
    <p>| | | |</p>
    <p>| | | | |</p>
    <p>|| || | | || ||</p>
    <p>|||| | | ||</p>
    <p>| || | | ||| ||</p>
    <p>|| ||| ||</p>
    <p>|</p>
    <p>| | | |</p>
    <p>|</p>
    <p>| | | |</p>
    <p>|| | | ||| |</p>
    <p>| || || || | |</p>
    <p>| || | | ||</p>
    <p>|||</p>
    <p>|| | || || || |</p>
    <p>|| | |||</p>
    <p>|| ||| | |||</p>
    <p>|| || | || || |</p>
    <p>| || | || || | | |</p>
    <p>| || || | ||| ||</p>
    <p>||| || || || | |</p>
    <p>|| || | || ||</p>
    <p>| | | |</p>
    <p>| | | |</p>
    <p>| || | |</p>
    <p>|| || | | ||||</p>
    <p>|| || | |||</p>
    <p>| | | | | || | || ||</p>
    <p>| || ||</p>
    <p>|</p>
    <p>| || |</p>
    <p>|</p>
    <p>| || |</p>
    <p>|| || | || |</p>
    <p>| ||| | || ||</p>
    <p>|| | | | ||</p>
    <p>| ||</p>
    <p>||| || || || |</p>
    <p>|| | | ||</p>
    <p>VM Detection || no || yes</p>
    <p>Date</p>
    <p>M D 5</p>
    <p>||||| | |||</p>
    <p>|||| | | ||| |</p>
    <p>| || | | || | | | |</p>
    <p>| || || |||| ||</p>
    <p>| |||| || || | |</p>
    <p>|||| | | | ||</p>
    <p>|| | |</p>
    <p>| | | |</p>
    <p>| | | | |</p>
    <p>|| || | | || ||</p>
    <p>|||| | | ||</p>
    <p>| || | | ||| ||</p>
    <p>|| ||| ||</p>
    <p>|</p>
    <p>| | | |</p>
    <p>|</p>
    <p>| | | |</p>
    <p>|| | | ||| |</p>
    <p>| || || || | |</p>
    <p>| || | | ||</p>
    <p>|||</p>
    <p>|| | || || || |</p>
    <p>|| | |||</p>
    <p>|| ||| | |||</p>
    <p>|| || | || || |</p>
    <p>| || | || || | | |</p>
    <p>| || || | ||| ||</p>
    <p>||| || || || | |</p>
    <p>|| || | || ||</p>
    <p>| | | |</p>
    <p>| | | |</p>
    <p>| || | |</p>
    <p>|| || | | ||||</p>
    <p>|| || | |||</p>
    <p>| | | | | || | || ||</p>
    <p>| || ||</p>
    <p>|</p>
    <p>| || |</p>
    <p>|</p>
    <p>| || |</p>
    <p>|| || | || |</p>
    <p>| ||| | || ||</p>
    <p>|| | | | ||</p>
    <p>| ||</p>
    <p>||| || || || |</p>
    <p>|| | | ||</p>
    <p>VM Detection || no || yes</p>
    <p>SecuritySuite*MD5s*by*date*</p>
    <p>Date</p>
    <p>M D 5</p>
    <p>||||| | |||</p>
    <p>|||| | | ||| |</p>
    <p>| || | | || | | | |</p>
    <p>| || || |||| ||</p>
    <p>| |||| || || | |</p>
    <p>|||| | | | ||</p>
    <p>|| | |</p>
    <p>| | | |</p>
    <p>| | | | |</p>
    <p>|| || | | || ||</p>
    <p>|||| | | ||</p>
    <p>| || | | ||| ||</p>
    <p>|| ||| ||</p>
    <p>|| ||| | |||</p>
    <p>|| || | || || |</p>
    <p>| || | || || | | |</p>
    <p>| || || | ||| ||</p>
    <p>||| || || || | |</p>
    <p>|| || | || ||</p>
    <p>| | | |</p>
    <p>| | | |</p>
    <p>| || | |</p>
    <p>|| || | | ||||</p>
    <p>|| || | |||</p>
    <p>| | | | | || | || ||</p>
    <p>| || ||</p>
    <p>VM Detection || no yes</p>
  </div>
  <div class="page">
    <p>Geographic*Distribu8on*of*Malware*</p>
    <p>Use*Tor*exit*points*in*15*different*countries*  Verify*exit-node*IP*using*MaxMind*GeoIP*database*  Zlob*blocks*Tor*</p>
    <p>PPI*clients*are*given*a*choice*for*installs*</p>
  </div>
  <div class="page">
    <p>Geographic*Distribu8on*of*Malware*</p>
    <p>Use*Tor*exit*points*in*15*different*countries*  Verify*exit-node*IP*using*MaxMind*GeoIP*database*  Zlob*blocks*Tor*</p>
    <p>PPI*clients*are*given*a*choice*for*installs*  Prices*vary*depending*on*install*loca8on*  Clients*mone8ze*hosts*differently*</p>
    <p>Localiza8on*of*Fake*AV*  Stolen*credit*card*value*varies*  Legal*limita8ons*</p>
  </div>
  <div class="page">
    <p>Dis8nct*Geographic*Distribu8on*</p>
    <p>Fr ac tio n</p>
    <p>DE ES FR GB GR IT JP KR PT RU US</p>
    <p>Russkill</p>
    <p>DE ES FR GB GR IT JP KR PT RU US</p>
    <p>Fr ac tio n</p>
    <p>DE ES FR GB GR IT JP KR PT RU US</p>
    <p>SmartAdsSolutions</p>
    <p>DE ES FR GB GR IT JP KR PT RU US</p>
  </div>
  <div class="page">
    <p>PPI*Arbitrage*</p>
    <p>Affiliate*at*one*PPI,*client* at*another!*</p>
    <p>Exploit*price*differen8al*  PPI*1:*Buys*1k*installs*for* $60*in*Greece*</p>
    <p>PPI*2:*Sells*1k*installs*for* $40*in*Greece*</p>
  </div>
  <div class="page">
    <p>Conclusions*</p>
    <p>First*systema8c*study*of*the*PPI*ecosystem*</p>
    <p>Infiltra8on*provides*malware+intelligence+  Used*to*perform*several*measurements*</p>
    <p>Much*of*worlds*top*malware*using*PPI*  Regular*repacking*of*binaries*  Clients*target*geographic*loca8ons*</p>
  </div>
  <div class="page">
    <p>Ques8ons?*</p>
  </div>
</Presentation>
