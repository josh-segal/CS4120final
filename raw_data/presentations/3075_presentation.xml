<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Neural Adaptive Content-aware Internet Video Delivery</p>
    <p>Hyunho Yeo, Youngmok Jung, Jaehong Kim,</p>
    <p>Jinwoo Shin, Dongsu Han</p>
  </div>
  <div class="page">
    <p>Observation on Current Video Ecosystem 2</p>
    <p>Adaptive streaming has been widely deployed (a primary tool for improving user QoE)</p>
    <p>High</p>
    <p>Quality</p>
    <p>Time Medium</p>
    <p>Low</p>
    <p>Video server Client</p>
    <p>Quality</p>
    <p>Time</p>
    <p>Bandwidth</p>
    <p>ABR</p>
    <p>Time</p>
  </div>
  <div class="page">
    <p>Goal: Find how to best utilize the network resource</p>
    <p>Traditional Approaches 3</p>
    <p>Optimizing ABR algorithms Pensieve [SIGCOMM 17], MPC [SIGCOMM 15]</p>
    <p>Choosing better servers, CDNs Content Multihoming [SIGCOMM 12], VDN [SIGCOMM 15]</p>
    <p>Leveraging centralized control plan Video Control Plane [SIGCOMM 12], Pythease [NSDI 17]</p>
  </div>
  <div class="page">
    <p>Limitation of Current Video Delivery 4</p>
    <p>Video server Client</p>
    <p>Low Quality Network</p>
    <p>Congestion</p>
    <p>Directly affect</p>
    <p>Video quality heavily depends on available bandwidth</p>
  </div>
  <div class="page">
    <p>Limitation of Current Video Delivery 5</p>
    <p>Client computing power is scarcely utilized other than for decoding</p>
    <p>Apple A4</p>
    <p>Apple A5</p>
    <p>Apple A6</p>
    <p>Apple A6X</p>
    <p>Apple A7</p>
    <p>Apple A8</p>
    <p>Apple A8X</p>
    <p>Apple A9</p>
    <p>Apple A9X Apple A10 Apple A10X</p>
    <p>Mobile GPU</p>
    <p>C o</p>
    <p>m p</p>
    <p>u ti</p>
    <p>n g</p>
    <p>p o</p>
    <p>w e</p>
    <p>r (G</p>
    <p>F LO</p>
    <p>P s)</p>
    <p>GTX 480</p>
    <p>GTX 580 GTX 680</p>
    <p>GTX 780</p>
    <p>GTX 780Ti</p>
    <p>GTX 980</p>
    <p>GTX 980Ti</p>
    <p>GTX 1080</p>
    <p>GTX 1080Ti</p>
    <p>C o</p>
    <p>m p</p>
    <p>u ti</p>
    <p>n g</p>
    <p>p o</p>
    <p>w e</p>
    <p>r (T</p>
    <p>F LO</p>
    <p>P s)</p>
    <p>Desktop GPU</p>
  </div>
  <div class="page">
    <p>Standard codecs efficiently reduce redundancy inside GOP</p>
    <p>Observation on Current Video Ecosystem 6</p>
    <p>Video</p>
    <p>: Intra-frame coding</p>
    <p>Group of Pictures (GOP)</p>
    <p>: Inter-frame coding</p>
    <p>Standard codecs (H.26x, VPx, AV1)</p>
    <p>Compressed</p>
    <p>I-frame I-frameP-frames</p>
  </div>
  <div class="page">
    <p>Standard codecs efficiently reduce redundancy inside GOP</p>
    <p>Observation on Current Video Ecosystem 7</p>
    <p>Video</p>
    <p>: Intra-frame coding</p>
    <p>Group of Pictures (GOP)</p>
    <p>: Inter-frame coding</p>
    <p>Standard codecs (H.26x, VPx, AV1)</p>
    <p>Compressed Time</p>
    <p>Video Quality</p>
    <p>: 210 seconds</p>
    <p>[Adaptive streaming]</p>
    <p>Seamless switching</p>
    <p>GOP</p>
    <p>I-frame I-frameP-frames</p>
  </div>
  <div class="page">
    <p>Limitation of Current Video Delivery 8</p>
    <p>Video</p>
    <p>Time</p>
    <p>Redundancy (large timescales)</p>
    <p>: 210 secondsGroup of Pictures (GOP)</p>
    <p>I-frame I-frame I-frameI-frame</p>
    <p>Standard codecs lack any mechanisms for exploiting redundancy that occurs at large timescales</p>
  </div>
  <div class="page">
    <p>Key Observations on Deep Neural Network</p>
    <p>Low quality High qualityDNN</p>
    <p>Computing device</p>
    <p>DNN</p>
    <p>GOP GOP</p>
  </div>
  <div class="page">
    <p>Super-resolution DNN High resolutionLow resolution</p>
    <p>Key Observations on Deep Neural Network</p>
    <p>Computing device</p>
    <p>DNN</p>
    <p>GOP GOP</p>
  </div>
  <div class="page">
    <p>DNN</p>
    <p>GOP GOP</p>
    <p>Key Observations on Deep Neural Network</p>
    <p>Low quality High qualityDNN</p>
    <p>Computing device</p>
    <p>Low resolution High resolutionSuper-resolution DNN</p>
    <p>Can we overcome the current limitations via DNN?</p>
    <p>How much QoE improvement can we achieve?</p>
  </div>
  <div class="page">
    <p>NAS: DNN-based Video Delivery 12</p>
    <p>NASExisting Approach (Pensieve  SIGCOMM 17)</p>
  </div>
  <div class="page">
    <p>Super-resolution</p>
    <p>NAS: DNN-based Video Delivery Apply super-resolution DNN on top of bitrate adaptation</p>
    <p>Bandwidth</p>
    <p>: Client computation</p>
  </div>
  <div class="page">
    <p>NAS: Design Scope 14</p>
    <p>GTX 1050 Ti (Entry-level) Titan Xp (High-end)</p>
    <p>Price $139 $1,200</p>
    <p>Example</p>
    <p>Example</p>
  </div>
  <div class="page">
    <p>Generic super-resolution1,2,3</p>
    <p>NAS: Two Initial Challenges 15</p>
    <p>New content Quality</p>
    <p>Guarantee performance</p>
    <p>Client A: Entry-level GPU Client B: High-end GPU</p>
    <p>GPU GPUx5 slower! Require adaptation to computing power</p>
    <p>SSIM = 0.86 SSIM = 0.84</p>
  </div>
  <div class="page">
    <p>Key Design (1): Content-aware DNN</p>
    <p>Challenge: Providing reliable DNN quality</p>
    <p>Content-aware DNN delivers the reliable training accuracy instead of the unpredictable testing accuracy.</p>
    <p>Video server</p>
    <p>Video 2 Super-resolution DNN 2</p>
    <p>Video 1 Super-resolution DNN 1</p>
  </div>
  <div class="page">
    <p>Training a content-aware super-resolution</p>
    <p>High-resolution (1080p)</p>
    <p>Low-resolutions (240p720p)</p>
    <p>Input Output</p>
    <p>Updates parameters</p>
    <p>Targetframes</p>
    <p>DNN</p>
  </div>
  <div class="page">
    <p>Implication on Video Encoding 18</p>
    <p>GOP</p>
    <p>Content-aware DNN</p>
    <p>GOP GOP</p>
    <p>Redundancy</p>
    <p>Standard codecs</p>
    <p>GOP</p>
    <p>Redundancy</p>
  </div>
  <div class="page">
    <p>Key Design (2): Multiple Quality DNNs 19</p>
    <p>ClientVideo server Downloads all? Several MBs</p>
    <p>Quality: Low High</p>
    <p>Size: Small (93KB) Large (2,143KB)</p>
    <p>Compute: Low High</p>
    <p>Challenge: Enabling real-time super-resolution on heterogeneous clients</p>
  </div>
  <div class="page">
    <p>Key Design (2): Multiple Quality DNNs 20</p>
    <p>ClientVideo server</p>
    <p>Manifest file</p>
    <p>Computing device (GTX 1080)</p>
    <p>Mock DNNs</p>
    <p>Selected</p>
    <p>Quality: Low High</p>
    <p>Size: Small (93KB) Large (2,143KB)</p>
    <p>Compute: Low High</p>
    <p>Challenge: Enabling real-time super-resolution on heterogeneous clients</p>
  </div>
  <div class="page">
    <p>NAS: Two Additional Challenges 21</p>
    <p>NAS streams video with a content-aware DNN, but</p>
    <p>Ultra-high (2,145KB) 360p video (400Kbps)</p>
    <p>Example</p>
    <p>Video server Client</p>
    <p>Example</p>
    <p>Incremental benefit</p>
    <p>Integrate with ABR</p>
  </div>
  <div class="page">
    <p>Key Design (3): Scalable DNN 22</p>
    <p>Challenge: Takes a long time to utilize a DNN</p>
    <p>ClientVideo server</p>
    <p>: Required : Optional</p>
    <p>additional by-passing paths</p>
    <p>La ye</p>
    <p>r</p>
    <p>La ye</p>
    <p>r</p>
    <p>La ye</p>
    <p>r</p>
    <p>La ye</p>
    <p>r</p>
    <p>La ye</p>
    <p>rInput Output</p>
    <p>La ye</p>
    <p>r</p>
    <p>No DNN</p>
    <p>(+ divide into similar-size chunks)</p>
  </div>
  <div class="page">
    <p>Pensieve agent</p>
    <p>Environment</p>
    <p>Extends a reinforcement-learning based ABR (Pensieve [SIGCOMM17] )</p>
    <p>Key Design (4): Integrated ABR 23</p>
    <p>Challenge: How to decide when to download a DNN</p>
    <p>Action  Bandwidth</p>
    <p>Bitrate</p>
    <p>Playback buffer</p>
    <p>State</p>
    <p>QoE metric = bitrate - rebuffering  smoothness</p>
    <p>Reward</p>
    <p>Goal: Maximize the total QoE over an entire video</p>
  </div>
  <div class="page">
    <p>NAS agent</p>
    <p>QoE metric = DNN(bitrate) - rebuffering  smoothness</p>
    <p>Key Design (4): Integrated ABR 24</p>
    <p>DNN# Remaining DNN</p>
    <p>Bandwidth</p>
    <p>Bitrate</p>
    <p>Playback buffer</p>
    <p>Action</p>
    <p>Challenge: How to decide when to download a DNN</p>
    <p>Environment</p>
    <p>State</p>
    <p>Goal: Maximize the total QoE reflecting DNN-based quality enhancement</p>
    <p>Extends a reinforcement-learning based ABR (Pensieve [SIGCOMM17] )</p>
    <p>Reward</p>
  </div>
  <div class="page">
    <p>Putting All Together: Implementation</p>
    <p>NAS Player (dash.js) 1.7K LOC (8.8%)</p>
    <p>DNN Processor (PyTorch) 6.3K LOC</p>
    <p>Server</p>
    <p>DNN</p>
    <p>Video</p>
    <p>Integrated ABR 5.5K LOC</p>
  </div>
  <div class="page">
    <p>Evaluation</p>
  </div>
  <div class="page">
    <p>NAS vs. Existing Video Delivery : QoE 27</p>
    <p>17.8 hours real-world network traces: collected from 3G network and broadband (average bandwidth: 1.31Mbps)</p>
    <p>27 YouTube videos: 5-24 minutes, encoded at {400, 800, 1200, 2400, 4800}kbps  Computing device: NVIDIA Titan Xp, DNN quality: Ultra-high  Video player: Chromium browser, Video server: Apache server</p>
  </div>
  <div class="page">
    <p>Demo: NAS Highlight 28</p>
    <p>NASExisting Approach (Pensieve  SIGCOMM 17)</p>
  </div>
  <div class="page">
    <p>C D</p>
    <p>F</p>
    <p>Average QoE</p>
    <p>C D</p>
    <p>F</p>
    <p>Average QoE</p>
    <p>NAS vs. Existing Video Delivery : QoE 29</p>
    <p>NAS improves user QoE by 43.08% compared to Pensieve and 92.28% compared to BOLA using same amount of bandwidth.</p>
    <p>BOLA RobustMPC Pensieve NAS</p>
    <p>better</p>
    <p>17.8 hours real-world network traces: collected from 3G network and broadband (average bandwidth: 1.31Mbps)</p>
    <p>27 YouTube videos: 5-24 minutes, encoded at {400, 800, 1200, 2400, 4800}kbps  Computing device: NVIDIA Titan Xp, DNN quality: Ultra-high  Video player: Chromium browser, Video server: Apache server</p>
  </div>
  <div class="page">
    <p>NAS vs. Existing Video Delivery : Cost 30</p>
    <p>When the total viewing reaches 30 hours (per minute of video), NAS CDN recoups the initial training cost.</p>
    <p>= 0.23$/minute of video</p>
    <p>NAS CDN</p>
    <p>= 0.085$/GB</p>
    <p>Pensieve CDN</p>
    <p>= 0.085$/GB</p>
    <p>o ta</p>
    <p>l c o</p>
    <p>st (</p>
    <p>$ )</p>
    <p>Total viewing time (hour)</p>
    <p>NAS Pensieve</p>
    <p>Training cost</p>
    <p>: 17.13% bandwidth for same quality</p>
    <p>b e</p>
    <p>tte r</p>
  </div>
  <div class="page">
    <p>Heterogeneous Clients 31</p>
    <p>DNN quality GPU model (Price)</p>
    <p>Low GTX 1050 Ti ($139)</p>
    <p>Medium GTX 1060 ($249)</p>
    <p>High GTX 1070 Ti ($449) GTX 1080 ($559)</p>
    <p>Ultra-high GTX 1080 Ti ($669) Titan Xp ($1,200)</p>
    <p>NAS adapts to heterogeneous devices, and a device with higher computing power receives greater benefit.</p>
    <p>Each GPU processes at real-time (&gt; 30fps for all resolutions)</p>
    <p>Average QoE C</p>
    <p>D F</p>
    <p>better</p>
    <p>Medium High Ultra-highLow</p>
    <p>BOLA RobustMPC Pensieve</p>
  </div>
  <div class="page">
    <p>Conclusion</p>
    <p>NAS presents a new type of QoE maximization &amp; encoding via DNN</p>
    <p>NAS accommodates four key designs: Content-aware DNN, Multiple quality DNNs, Scalable DNN, Integrated ABR.</p>
    <p>NAS can improve user QoE or reduce the video delivery cost for CDN.</p>
    <p>Large timescale redundancy</p>
    <p>Short</p>
    <p>[Standard codecs] [Content-aware DNN]</p>
  </div>
</Presentation>
