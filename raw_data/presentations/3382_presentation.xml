<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>DeTor: Provably Avoiding Geographic Regions in Tor</p>
    <p>Zhihao Li, Stephen Herwig, Dave Levin</p>
  </div>
  <div class="page">
    <p>Tor Network Aims to provide anonymous communications</p>
    <p>Tor network</p>
    <p>destinationsource</p>
  </div>
  <div class="page">
    <p>Tor Circuits Usually consist of three nodes</p>
    <p>source destination</p>
  </div>
  <div class="page">
    <p>Tor Circuits Usually consist of three nodes</p>
    <p>Entry</p>
    <p>Middle</p>
    <p>Exit</p>
    <p>source destination</p>
  </div>
  <div class="page">
    <p>Tor Circuits Usually consist of three nodes</p>
    <p>Entry</p>
    <p>Middle</p>
    <p>Exit</p>
    <p>source destination</p>
  </div>
  <div class="page">
    <p>Tor Circuits Usually consist of three nodes</p>
    <p>Entry</p>
    <p>Middle</p>
    <p>Exit</p>
    <p>source destination</p>
  </div>
  <div class="page">
    <p>Tor Network Aims to provides unlinkable communications</p>
    <p>Tor network</p>
    <p>source destination</p>
  </div>
  <div class="page">
    <p>Tor Network Aims to provides unlinkable communications</p>
    <p>Tor network</p>
    <p>source destination</p>
    <p>Knows doesnt know</p>
    <p>Attackers network</p>
  </div>
  <div class="page">
    <p>Tor Network Aims to provides unlinkable communications</p>
    <p>Tor network</p>
    <p>Adversary cannot link source with destination source destination</p>
    <p>Knows doesnt know</p>
  </div>
  <div class="page">
    <p>Tor Network Vulnerable to censorship</p>
    <p>[Anon. CCR12]</p>
    <p>source destination</p>
  </div>
  <div class="page">
    <p>Tor Network Vulnerable to censorship</p>
    <p>[Anon. CCR12]</p>
    <p>source destination</p>
  </div>
  <div class="page">
    <p>Tor Network Vulnerable to censorship</p>
    <p>[Anon. CCR12]</p>
    <p>source destination</p>
    <p>Censoring country</p>
  </div>
  <div class="page">
    <p>Tor Network Vulnerable to censorship</p>
    <p>[Anon. CCR12]</p>
    <p>source destination</p>
    <p>Censoring country</p>
  </div>
  <div class="page">
    <p>Tor Network Vulnerable to censorship</p>
    <p>[Anon. CCR12]</p>
    <p>source destination</p>
    <p>Censoring country</p>
  </div>
  <div class="page">
    <p>Tor Network Vulnerable to censorship</p>
    <p>[Anon. CCR12]</p>
    <p>source destination</p>
    <p>Censoring country</p>
  </div>
  <div class="page">
    <p>Tor Network Vulnerable to traffic correlation attacks</p>
    <p>[Hopper et al., ACM TISSEC. 2010; Gilad et al., PETS 2012]</p>
  </div>
  <div class="page">
    <p>Tor Network Vulnerable to traffic correlation attacks</p>
    <p>[Hopper et al., ACM TISSEC. 2010; Gilad et al., PETS 2012]</p>
  </div>
  <div class="page">
    <p>Tor Network Vulnerable to traffic correlation attacks</p>
    <p>[Hopper et al., ACM TISSEC. 2010; Gilad et al., PETS 2012]</p>
    <p>Traffic patterns</p>
  </div>
  <div class="page">
    <p>Tor Network Vulnerable to traffic correlation attacks</p>
    <p>[Hopper et al., ACM TISSEC. 2010; Gilad et al., PETS 2012]</p>
    <p>Traffic patterns</p>
  </div>
  <div class="page">
    <p>Tor Network Vulnerable to traffic correlation attacks</p>
    <p>[Hopper et al., ACM TISSEC. 2010; Gilad et al., PETS 2012]</p>
    <p>Traffic patterns</p>
  </div>
  <div class="page">
    <p>Threat model Nation-state adversary</p>
  </div>
  <div class="page">
    <p>Threat model Nation-state adversary</p>
    <p>Adversaries can:  launch various attacks when on the path  hide from network topology measurement (e.g. traceroute)  attract routes to their administrative domains</p>
  </div>
  <div class="page">
    <p>Threat model Nation-state adversary</p>
    <p>Adversaries can:  launch various attacks when on the path  hide from network topology measurement (e.g. traceroute)  attract routes to their administrative domains</p>
  </div>
  <div class="page">
    <p>Threat model Nation-state adversary</p>
    <p>Adversaries can:  launch various attacks when on the path  hide from network topology measurement (e.g. traceroute)  attract routes to their administrative domains</p>
    <p>Adversaries cannot:  violate cryptographic assumptions</p>
  </div>
  <div class="page">
    <p>Threat model Nation-state adversary</p>
    <p>Adversaries can:  launch various attacks when on the path  hide from network topology measurement (e.g. traceroute)  attract routes to their administrative domains</p>
    <p>Adversaries cannot:  violate cryptographic assumptions</p>
    <p>Fundamental assumption: We know the geographic boundaries</p>
    <p>wherein the attackers reside</p>
  </div>
  <div class="page">
    <p>DeTor With smart circuit selection, it is possible to provably avoid geographic regions with Tor</p>
  </div>
  <div class="page">
    <p>DeTor</p>
    <p>Never-once Never-twice</p>
    <p>With smart circuit selection, it is possible to provably avoid geographic regions with Tor</p>
  </div>
  <div class="page">
    <p>DeTor</p>
    <p>Never-once Never-twice</p>
    <p>With smart circuit selection, it is possible to provably avoid geographic regions with Tor</p>
  </div>
  <div class="page">
    <p>DeTor</p>
    <p>Never-once Never-twice</p>
    <p>With smart circuit selection, it is possible to provably avoid geographic regions with Tor</p>
  </div>
  <div class="page">
    <p>DeTor</p>
    <p>Never-once Never-twice</p>
    <p>With smart circuit selection, it is possible to provably avoid geographic regions with Tor</p>
  </div>
  <div class="page">
    <p>DeTor</p>
    <p>Never-once Never-twice</p>
    <p>send to</p>
    <p>but avoid</p>
    <p>With smart circuit selection, it is possible to provably avoid geographic regions with Tor</p>
  </div>
  <div class="page">
    <p>DeTor</p>
    <p>Never-once Never-twice</p>
    <p>send to</p>
    <p>but avoid</p>
    <p>With smart circuit selection, it is possible to provably avoid geographic regions with Tor</p>
  </div>
  <div class="page">
    <p>DeTor</p>
    <p>Never-once</p>
    <p>With smart circuit selection, it is possible to provably avoid geographic regions with Tor</p>
  </div>
  <div class="page">
    <p>DeTor</p>
    <p>Never-once Never-twice</p>
    <p>With smart circuit selection, it is possible to provably avoid geographic regions with Tor</p>
  </div>
  <div class="page">
    <p>DeTor</p>
    <p>Never-once Never-twice</p>
    <p>With smart circuit selection, it is possible to provably avoid geographic regions with Tor</p>
  </div>
  <div class="page">
    <p>DeTor</p>
    <p>Never-once Never-twice</p>
    <p>but entry &amp; exit legs never traverse the same</p>
    <p>send to</p>
    <p>With smart circuit selection, it is possible to provably avoid geographic regions with Tor</p>
  </div>
  <div class="page">
    <p>DeTor</p>
    <p>Never-once Never-twice</p>
    <p>but entry &amp; exit legs never traverse the same</p>
    <p>send to</p>
    <p>With smart circuit selection, it is possible to provably avoid geographic regions with Tor</p>
  </div>
  <div class="page">
    <p>DeTor</p>
    <p>Never-once Never-twice</p>
    <p>never traverse specified regions</p>
    <p>entry &amp; exit legs never traverse</p>
    <p>the same regions</p>
    <p>Provide per-packet proof of avoidance</p>
    <p>With smart circuit selection, it is possible to provably avoid geographic regions with Tor</p>
  </div>
  <div class="page">
    <p>DeTor goals</p>
    <p>Provide proofs of avoidanceProof</p>
    <p>Allow users to avoid adversaries with smart circuits selection</p>
    <p>Deployable</p>
  </div>
  <div class="page">
    <p>DeTor goals</p>
    <p>Deployable Allow users to avoid adversaries with smart circuits selection</p>
  </div>
  <div class="page">
    <p>DeTor goals</p>
    <p>Deployable</p>
    <p>Without having to know underlying routes</p>
    <p>Allow users to avoid adversaries with smart circuits selection</p>
  </div>
  <div class="page">
    <p>DeTor goals</p>
    <p>Deployable</p>
    <p>Without having to know underlying routes</p>
    <p>Allow users to avoid adversaries with smart circuits selection</p>
    <p>Without modifications to Internet routers</p>
  </div>
  <div class="page">
    <p>DeTor goals</p>
    <p>Deployable</p>
    <p>Without having to know underlying routes</p>
    <p>Allow users to avoid adversaries with smart circuits selection</p>
    <p>Without modifications to Internet routers</p>
    <p>Without changes to Tors protocol</p>
  </div>
  <div class="page">
    <p>DeTor goals</p>
    <p>Provide proofs of avoidanceProof</p>
  </div>
  <div class="page">
    <p>DeTor goals</p>
    <p>Provide proofs of avoidanceProof</p>
  </div>
  <div class="page">
    <p>DeTor goals</p>
    <p>Provide proofs of avoidanceProof</p>
  </div>
  <div class="page">
    <p>DeTor goals</p>
    <p>Provide proofs of avoidanceProof</p>
  </div>
  <div class="page">
    <p>DeTor goals</p>
    <p>Provide proofs of avoidanceProof</p>
  </div>
  <div class="page">
    <p>DeTor goals</p>
    <p>Provide proofs of avoidanceProof</p>
  </div>
  <div class="page">
    <p>DeTor goals</p>
    <p>Provide proofs of avoidanceProof</p>
    <p>Measurement of roundtrip time</p>
  </div>
  <div class="page">
    <p>Provable avoidance Alibi Routing by Levin et al. in SIGCOMM 2015</p>
  </div>
  <div class="page">
    <p>Provable avoidance Alibi Routing by Levin et al. in SIGCOMM 2015</p>
    <p>d</p>
  </div>
  <div class="page">
    <p>Provable avoidance Alibi Routing by Levin et al. in SIGCOMM 2015</p>
    <p>= 2 d / c</p>
    <p>d</p>
    <p>The shortest possible RTT thru to .</p>
  </div>
  <div class="page">
    <p>Provable avoidance Alibi Routing by Levin et al. in SIGCOMM 2015</p>
    <p>= 2 d / cMeasured RTT</p>
    <p>d</p>
    <p>The shortest possible RTT thru to .</p>
  </div>
  <div class="page">
    <p>Provable avoidance Alibi Routing by Levin et al. in SIGCOMM 2015</p>
    <p>= 2 d / cMeasured RTT</p>
    <p>d</p>
    <p>The packet could not have traversed to</p>
    <p>The shortest possible RTT thru to .</p>
  </div>
  <div class="page">
    <p>Provable avoidance Alibi Routing by Levin et al. in SIGCOMM 2015</p>
    <p>= 2 d / cMeasured RTT</p>
    <p>d</p>
    <p>Alibi Condition</p>
    <p>The packet could not have traversed to</p>
    <p>The shortest possible RTT thru to .</p>
  </div>
  <div class="page">
    <p>send to but avoid</p>
    <p>Provable avoidance Alibi Routing by Levin et al. in SIGCOMM 2015</p>
  </div>
  <div class="page">
    <p>send to but avoid</p>
    <p>Verifies</p>
    <p>Provable avoidance Alibi Routing by Levin et al. in SIGCOMM 2015</p>
  </div>
  <div class="page">
    <p>send to but avoid</p>
    <p>Verifies</p>
    <p>Provable avoidance Alibi Routing by Levin et al. in SIGCOMM 2015</p>
    <p>Reply contains a MAC from .</p>
  </div>
  <div class="page">
    <p>send to but avoid</p>
    <p>Verifies</p>
    <p>Provable avoidance Alibi Routing by Levin et al. in SIGCOMM 2015</p>
    <p>Reply contains a MAC from .  The packet reached</p>
  </div>
  <div class="page">
    <p>send to but avoid</p>
    <p>Verifies</p>
    <p>Provable avoidance Alibi Routing by Levin et al. in SIGCOMM 2015</p>
    <p>Reply contains a MAC from .  The packet reached</p>
  </div>
  <div class="page">
    <p>send to but avoid</p>
    <p>RTT less than shortest RTT thru .</p>
    <p>Verifies</p>
    <p>Provable avoidance Alibi Routing by Levin et al. in SIGCOMM 2015</p>
    <p>Reply contains a MAC from .  The packet reached</p>
  </div>
  <div class="page">
    <p>send to but avoid</p>
    <p>RTT less than shortest RTT thru .</p>
    <p>The packet could not have traversed &amp;</p>
    <p>Verifies</p>
    <p>Provable avoidance Alibi Routing by Levin et al. in SIGCOMM 2015</p>
    <p>Reply contains a MAC from .  The packet reached</p>
  </div>
  <div class="page">
    <p>DeTor</p>
    <p>Never-once Never-twice</p>
    <p>never traverse specified regions</p>
    <p>entry&amp;exit legs never traverse</p>
    <p>the same regions</p>
    <p>Provide per-packet proof of avoidance</p>
    <p>With smart circuit selection, it is possible to provably avoid geographic regions with Tor</p>
  </div>
  <div class="page">
    <p>DeTor</p>
    <p>Never-once Never-twice</p>
    <p>never traverse specified regions</p>
    <p>entry&amp;exit legs never traverse</p>
    <p>the same regions</p>
    <p>Provide per-packet proof of avoidance</p>
    <p>With smart circuit selection, it is possible to provably avoid geographic regions with Tor</p>
  </div>
  <div class="page">
    <p>DeTor: never-once avoidance Avoid user specified geographic regions</p>
    <p>send to</p>
    <p>but avoid</p>
  </div>
  <div class="page">
    <p>DeTor: never-once avoidance The shortest possible RTT thru and to .</p>
    <p>shortest distance = d1</p>
  </div>
  <div class="page">
    <p>DeTor: never-once avoidance</p>
    <p>d1 d2 d3 d4</p>
    <p>The shortest possible RTT thru and to .</p>
  </div>
  <div class="page">
    <p>DeTor: never-once avoidance</p>
    <p>d1 d2 d3 d4</p>
    <p>= 2 min{di}/ c The shortest possible RTT thru and to .</p>
    <p>The shortest possible RTT thru and to .</p>
  </div>
  <div class="page">
    <p>DeTor: never-once avoidance</p>
    <p>d1 d2 d3 d4</p>
    <p>= 2 min{di}/ c The shortest possible RTT thru and to .</p>
    <p>Measured RTT</p>
    <p>The shortest possible RTT thru and to .</p>
  </div>
  <div class="page">
    <p>DeTor: never-once avoidance</p>
    <p>d1 d2 d3 d4</p>
    <p>= 2 min{di}/ c The shortest possible RTT thru and to .</p>
    <p>Measured RTT</p>
    <p>The packet could not have traversed to</p>
    <p>The shortest possible RTT thru and to .</p>
  </div>
  <div class="page">
    <p>DeTor: never-once avoidance</p>
    <p>send to</p>
    <p>but avoid</p>
    <p>Achieving provable avoidance</p>
  </div>
  <div class="page">
    <p>DeTor: never-once avoidance</p>
    <p>send to</p>
    <p>but avoid</p>
    <p>Verifies</p>
    <p>Achieving provable avoidance</p>
  </div>
  <div class="page">
    <p>DeTor: never-once avoidance</p>
    <p>End-to-end integrity check</p>
    <p>send to</p>
    <p>but avoid</p>
    <p>Verifies</p>
    <p>Achieving provable avoidance</p>
  </div>
  <div class="page">
    <p>DeTor: never-once avoidance</p>
    <p>End-to-end integrity check</p>
    <p>send to</p>
    <p>but avoid</p>
    <p>Verifies</p>
    <p>Achieving provable avoidance</p>
    <p>The packet traversed and reached</p>
  </div>
  <div class="page">
    <p>DeTor: never-once avoidance</p>
    <p>End-to-end integrity check</p>
    <p>send to</p>
    <p>but avoid</p>
    <p>Verifies</p>
    <p>Achieving provable avoidance</p>
    <p>The packet traversed and reached</p>
  </div>
  <div class="page">
    <p>DeTor: never-once avoidance</p>
    <p>End-to-end integrity check</p>
    <p>send to</p>
    <p>but avoid</p>
    <p>Verifies</p>
    <p>Achieving provable avoidance</p>
    <p>RTT less than smallest RTT thru and .</p>
    <p>The packet traversed and reached</p>
  </div>
  <div class="page">
    <p>DeTor: never-once avoidance</p>
    <p>End-to-end integrity check</p>
    <p>send to</p>
    <p>but avoid</p>
    <p>The packet could not have traversed and</p>
    <p>Verifies</p>
    <p>Achieving provable avoidance</p>
    <p>RTT less than smallest RTT thru and .</p>
    <p>The packet traversed and reached</p>
  </div>
  <div class="page">
    <p>DeTor</p>
    <p>Never-once Never-twice</p>
    <p>never traverse specified regions</p>
    <p>entry&amp;exit legs never traverse</p>
    <p>the same regions</p>
    <p>Provide per-packet proof of avoidance</p>
    <p>With smart circuit selection, it is possible to provably avoid geographic regions with Tor</p>
  </div>
  <div class="page">
    <p>DeTor</p>
    <p>Never-once Never-twice</p>
    <p>never traverse specified regions</p>
    <p>entry&amp;exit legs never traverse</p>
    <p>the same regions</p>
    <p>Provide per-packet proof of avoidance</p>
    <p>With smart circuit selection, it is possible to provably avoid geographic regions with Tor</p>
  </div>
  <div class="page">
    <p>DeTor: never-twice avoidance Entry and exit legs never traverse the same region</p>
  </div>
  <div class="page">
    <p>DeTor: never-twice avoidance Entry and exit legs never traverse the same region</p>
  </div>
  <div class="page">
    <p>DeTor: never-twice avoidance Entry and exit legs never traverse the same region</p>
    <p>but entry &amp; exit legs never traverse the same</p>
    <p>send to</p>
  </div>
  <div class="page">
    <p>DeTor: never-twice avoidance Entry and exit legs never traverse the same region</p>
    <p>but entry &amp; exit legs never traverse the same</p>
    <p>send to</p>
  </div>
  <div class="page">
    <p>DeTor: never-twice avoidance Entry and exit legs never traverse the same region</p>
    <p>but entry &amp; exit legs never traverse the same</p>
    <p>send to</p>
  </div>
  <div class="page">
    <p>DeTor: never-twice avoidance Where could packets possibly reach</p>
    <p>Measured RTT = extrashortest possible RTT +</p>
  </div>
  <div class="page">
    <p>DeTor: never-twice avoidance Where could packets possibly reach</p>
    <p>Measured RTT =  shortest possible RTT + extra</p>
  </div>
  <div class="page">
    <p>DeTor: never-twice avoidance Where could packets possibly reach</p>
    <p>Measured RTT =  shortest possible RTT + extra</p>
  </div>
  <div class="page">
    <p>DeTor: never-twice avoidance Where could packets possibly reach</p>
    <p>Measured RTT =  shortest possible RTT + extra</p>
  </div>
  <div class="page">
    <p>DeTor: never-twice avoidance Where could packets possibly reach</p>
  </div>
  <div class="page">
    <p>DeTor: never-twice avoidance Where could packets possibly reach</p>
    <p>a b</p>
  </div>
  <div class="page">
    <p>DeTor: never-twice avoidance Where could packets possibly reach</p>
    <p>a b</p>
    <p>Upper bound RTT 2 (a+b) / c</p>
  </div>
  <div class="page">
    <p>DeTor: never-twice avoidance Where could packets possibly reach</p>
    <p>a b</p>
    <p>Upper bound RTT 2 (a+b) / c</p>
    <p>The packet could possibly reach any point in the ellipse</p>
  </div>
  <div class="page">
    <p>DeTor: never-twice avoidance Where could packets possibly reach</p>
  </div>
  <div class="page">
    <p>DeTor: never-twice avoidance Where could packets possibly reach</p>
    <p>Compute the worst-case scenarios for both entry and exit legs, separately</p>
  </div>
  <div class="page">
    <p>DeTor: never-twice avoidance Which countries can entry &amp; exit legs reach</p>
  </div>
  <div class="page">
    <p>DeTor: never-twice avoidance Which countries can entry &amp; exit legs reach</p>
    <p>s</p>
    <p>d</p>
  </div>
  <div class="page">
    <p>DeTor: never-twice avoidance Which countries can entry &amp; exit legs reach</p>
    <p>s</p>
    <p>e m</p>
    <p>x d</p>
  </div>
  <div class="page">
    <p>DeTor: never-twice avoidance Which countries can entry &amp; exit legs reach</p>
    <p>s</p>
    <p>e m</p>
    <p>x d</p>
  </div>
  <div class="page">
    <p>DeTor: never-twice avoidance Which countries can entry &amp; exit legs reach</p>
    <p>s</p>
    <p>e m</p>
    <p>x d</p>
  </div>
  <div class="page">
    <p>DeTor: never-twice avoidance Which countries can entry &amp; exit legs reach</p>
    <p>s</p>
    <p>e m</p>
    <p>x d</p>
  </div>
  <div class="page">
    <p>DeTor: never-twice avoidance Which countries can entry &amp; exit legs reach</p>
    <p>s</p>
    <p>e m</p>
    <p>x d</p>
  </div>
  <div class="page">
    <p>DeTor: never-twice avoidance Which countries can entry &amp; exit legs reach</p>
    <p>s</p>
    <p>e m</p>
    <p>x d</p>
    <p>no country intersects with both ellipses</p>
  </div>
  <div class="page">
    <p>DeTor: never-twice avoidance Which countries can entry &amp; exit legs reach</p>
    <p>s</p>
    <p>e m</p>
    <p>x d</p>
    <p>no country intersects with both ellipses</p>
  </div>
  <div class="page">
    <p>DeTor: never-twice avoidance Which countries can entry &amp; exit legs reach</p>
    <p>s</p>
    <p>e m</p>
    <p>x d</p>
    <p>no country intersects with both ellipses</p>
    <p>packet over entry/exit legs could not have traversed the same country</p>
  </div>
  <div class="page">
    <p>DeTor: never-twice avoidance Which countries can entry &amp; exit legs reach</p>
  </div>
  <div class="page">
    <p>DeTor: never-twice avoidance</p>
    <p>s</p>
    <p>Which countries can entry &amp; exit legs reach</p>
    <p>d</p>
  </div>
  <div class="page">
    <p>DeTor: never-twice avoidance</p>
    <p>s</p>
    <p>e</p>
    <p>m</p>
    <p>Which countries can entry &amp; exit legs reach</p>
    <p>d</p>
    <p>x</p>
  </div>
  <div class="page">
    <p>DeTor: never-twice avoidance</p>
    <p>s</p>
    <p>e</p>
    <p>m</p>
    <p>Which countries can entry &amp; exit legs reach</p>
    <p>d</p>
    <p>x</p>
  </div>
  <div class="page">
    <p>DeTor: never-twice avoidance</p>
    <p>s</p>
    <p>e</p>
    <p>m</p>
    <p>Which countries can entry &amp; exit legs reach</p>
    <p>d</p>
    <p>x</p>
  </div>
  <div class="page">
    <p>DeTor: never-twice avoidance</p>
    <p>s</p>
    <p>e</p>
    <p>m</p>
    <p>Which countries can entry &amp; exit legs reach</p>
    <p>d</p>
    <p>x</p>
  </div>
  <div class="page">
    <p>DeTor: never-twice avoidance</p>
    <p>s</p>
    <p>e</p>
    <p>m</p>
    <p>Which countries can entry &amp; exit legs reach</p>
    <p>d</p>
    <p>x</p>
  </div>
  <div class="page">
    <p>DeTor: never-twice avoidance</p>
    <p>s</p>
    <p>e</p>
    <p>m</p>
    <p>Which countries can entry &amp; exit legs reach</p>
    <p>d</p>
    <p>x</p>
  </div>
  <div class="page">
    <p>DeTor: never-twice avoidance</p>
    <p>s</p>
    <p>e</p>
    <p>m</p>
    <p>Which countries can entry &amp; exit legs reach</p>
    <p>d</p>
    <p>x</p>
    <p>For each country intersects with both ellipses as</p>
  </div>
  <div class="page">
    <p>DeTor: never-twice avoidance</p>
    <p>s</p>
    <p>e</p>
    <p>m</p>
    <p>Which countries can entry &amp; exit legs reach</p>
    <p>d</p>
    <p>x</p>
    <p>For each country intersects with both ellipses as</p>
    <p>The shortest possible RTT thru Tor and entry &amp; exit legs</p>
    <p>traverse .</p>
    <p>Measured RTT</p>
  </div>
  <div class="page">
    <p>DeTor: never-twice avoidance</p>
    <p>s</p>
    <p>e</p>
    <p>m</p>
    <p>Which countries can entry &amp; exit legs reach</p>
    <p>d</p>
    <p>x</p>
    <p>For each country intersects with both ellipses as</p>
    <p>The shortest possible RTT thru Tor and entry &amp; exit legs</p>
    <p>traverse .</p>
    <p>Measured RTT</p>
  </div>
  <div class="page">
    <p>DeTor: never-twice avoidance</p>
    <p>s</p>
    <p>e</p>
    <p>m</p>
    <p>Which countries can entry &amp; exit legs reach</p>
    <p>d</p>
    <p>x</p>
    <p>For each country intersects with both ellipses as</p>
    <p>The shortest possible RTT thru Tor and entry &amp; exit legs</p>
    <p>traverse .</p>
    <p>Measured RTT</p>
  </div>
  <div class="page">
    <p>DeTor: never-twice avoidance</p>
    <p>s</p>
    <p>e</p>
    <p>m</p>
    <p>Which countries can entry &amp; exit legs reach</p>
    <p>d</p>
    <p>x</p>
    <p>For each country intersects with both ellipses as</p>
    <p>The shortest possible RTT thru Tor and entry &amp; exit legs</p>
    <p>traverse .</p>
    <p>Measured RTT</p>
    <p>The packet could not have traversed over entry &amp; exit legs</p>
  </div>
  <div class="page">
    <p>Evaluation Through simulation</p>
  </div>
  <div class="page">
    <p>Evaluation</p>
    <p>50 random real Tor nodes  with GPS locations and pair-wise RTTs using Ting  choose sources and destinations among these nodes</p>
    <p>Through simulation</p>
  </div>
  <div class="page">
    <p>Evaluation</p>
    <p>50 random real Tor nodes  with GPS locations and pair-wise RTTs using Ting  choose sources and destinations among these nodes</p>
    <p>Eight countries to avoid for never-once:  China, India, PR Korea, Russia, Saudi Arabia, Syria, Japan, US</p>
    <p>Through simulation</p>
  </div>
  <div class="page">
    <p>Evaluation</p>
    <p>How successful is DeTor?</p>
    <p>How well do DeTor circuits perform?</p>
    <p>How diverse are the DeTor circuits?</p>
  </div>
  <div class="page">
    <p>Never-once success rate</p>
    <p>C hina</p>
    <p>India</p>
    <p>PK K</p>
    <p>o rean</p>
    <p>Japan</p>
    <p>R ussia</p>
    <p>U S</p>
    <p>Saudi A rabia</p>
    <p>Syria</p>
    <p>Successful with DeTor</p>
    <p>Theoretically avoid, but failed with real RTTs</p>
    <p>No circuits could provably avoid</p>
    <p>No trusted Tor nodes</p>
    <p>Source/Destination in Forbidden region</p>
  </div>
  <div class="page">
    <p>Never-once success rate</p>
    <p>C hina</p>
    <p>India</p>
    <p>PK K</p>
    <p>o rean</p>
    <p>Japan</p>
    <p>R ussia</p>
    <p>U S</p>
    <p>Saudi A rabia</p>
    <p>Syria</p>
    <p>Successful with DeTor</p>
    <p>Theoretically avoid, but failed with real RTTs</p>
    <p>No circuits could provably avoid</p>
    <p>No trusted Tor nodes</p>
    <p>Source/Destination in Forbidden region</p>
    <p>Most src-dst pairs can successful find never-once circuits</p>
  </div>
  <div class="page">
    <p>Never-once success rate</p>
    <p>C hina</p>
    <p>India</p>
    <p>PK K</p>
    <p>o rean</p>
    <p>Japan</p>
    <p>R ussia</p>
    <p>U S</p>
    <p>Saudi A rabia</p>
    <p>Syria</p>
    <p>Successful with DeTor</p>
    <p>Theoretically avoid, but failed with real RTTs</p>
    <p>No circuits could provably avoid</p>
    <p>No trusted Tor nodes</p>
    <p>Source/Destination in Forbidden region</p>
    <p>Failure typically arises when users are in or close to the regions to avoid</p>
  </div>
  <div class="page">
    <p>Number of never-once circuits</p>
    <p>Never-once</p>
    <p>Avoiding China</p>
  </div>
  <div class="page">
    <p>Number of never-once circuits</p>
    <p>Never-once</p>
    <p>Avoiding China</p>
    <p>Total number of possible Tor circuits</p>
  </div>
  <div class="page">
    <p>Number of never-once circuits</p>
    <p>Never-once</p>
    <p>Avoiding China</p>
    <p>Total number of possible Tor circuits</p>
  </div>
  <div class="page">
    <p>Number of never-once circuits Half of src-dst pairs have over 500 never-once circuits</p>
    <p>Never-once</p>
    <p>Avoiding China</p>
    <p>Total number of possible Tor circuits</p>
  </div>
  <div class="page">
    <p>Number of never-once circuits</p>
    <p>Never-once</p>
    <p>Avoiding China</p>
    <p>Tor with no Chinese relays provably avoids China less than 10% of the time</p>
    <p>Total number of possible Tor circuits</p>
  </div>
  <div class="page">
    <p>Number of never-twice circuits</p>
    <p>Never-twice</p>
    <p>Total number of possible Tor circuits</p>
  </div>
  <div class="page">
    <p>Number of never-twice circuits</p>
    <p>Client-side RTTs might be enough to address many attacks</p>
    <p>Never-twice</p>
    <p>Total number of possible Tor circuits</p>
  </div>
  <div class="page">
    <p>DeTor circuits tends to have lower RTTs</p>
    <p>Avoiding China</p>
  </div>
  <div class="page">
    <p>DeTor circuits tends to have lower RTTs</p>
  </div>
  <div class="page">
    <p>= 2 min{di}/ c The shortest possible RTT</p>
    <p>thru and . Measured</p>
    <p>RTT</p>
    <p>DeTor: never-once avoidance Achieving provable avoidance</p>
  </div>
  <div class="page">
    <p>= 2 min{di}/ c The shortest possible RTT</p>
    <p>thru and . Measured</p>
    <p>RTT</p>
    <p>DeTor: never-once avoidance Achieving provable avoidance</p>
  </div>
  <div class="page">
    <p>Other results</p>
    <p>DeTor circuits usually have higher bandwidth</p>
    <p>DeTor introduces slight node selection bias</p>
    <p>Most nodes serve on few DeTor circuits</p>
    <p>Possible to predict whether a circuit will achieve provable avoidance</p>
  </div>
  <div class="page">
    <p>DeTor With smart circuit selection, it is possible to provably avoid geographic regions with Tor</p>
    <p>Never-once Never-twice</p>
    <p>never traverse specified regions</p>
    <p>entry &amp; exit legs never traverse</p>
    <p>the same regions</p>
    <p>Proofs of avoidance verify that packets over DeTor circuits have avoided geographic regions</p>
    <p>DeTor circuits  are successful for most src-dst pairs  have better performance  introduce small node selection bias</p>
    <p>detor.cs.umd.edu Code and data available at:</p>
  </div>
  <div class="page">
    <p>DeTor With smart circuit selection, it is possible to provably avoid geographic regions with Tor</p>
    <p>Never-once Never-twice</p>
    <p>never traverse specified regions</p>
    <p>entry &amp; exit legs never traverse</p>
    <p>the same regions</p>
    <p>Proofs of avoidance verify that packets over DeTor circuits have avoided geographic regions</p>
    <p>DeTor circuits  are successful for most src-dst pairs  have better performance  introduce small node selection bias</p>
    <p>detor.cs.umd.edu Code and data available at:</p>
  </div>
</Presentation>
