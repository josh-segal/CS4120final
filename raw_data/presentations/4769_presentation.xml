<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>m p</p>
    <p>ut e</p>
    <p>ie nc</p>
    <p>e , T</p>
    <p>e xa</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U ni</p>
    <p>ve rs</p>
    <p>ity IMR-Pathload: Robust Available Bandwidth Estimation under End-Host Interrupt Delay</p>
    <p>IMRIMR--Pathload: Robust Available Pathload: Robust Available Bandwidth Estimation under EndBandwidth Estimation under End--Host Host Interrupt DelayInterrupt Delay</p>
    <p>Seong KangSeong Kang Joint work with Dmitri LoguinovJoint work with Dmitri Loguinov</p>
    <p>Internet Research LabInternet Research Lab Department of Computer ScienceDepartment of Computer Science Texas A&amp;M University, College Station, TX 77843Texas A&amp;M University, College Station, TX 77843</p>
    <p>April 30, 2008April 30, 2008</p>
  </div>
  <div class="page">
    <p>m p</p>
    <p>ut e</p>
    <p>ie nc</p>
    <p>e , T</p>
    <p>e xa</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U ni</p>
    <p>ve rs</p>
    <p>ity</p>
    <p>AgendaAgendaAgenda</p>
    <p>Introduction</p>
    <p>Interrupt moderation</p>
    <p>Analysis of Pathload  Impact of interrupt delays  Trend detection problem</p>
    <p>IMR-Pathload</p>
    <p>Performance evaluation</p>
    <p>Wrap-up</p>
  </div>
  <div class="page">
    <p>m p</p>
    <p>ut e</p>
    <p>ie nc</p>
    <p>e , T</p>
    <p>e xa</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U ni</p>
    <p>ve rs</p>
    <p>ity</p>
    <p>IntroductionIntroductionIntroduction</p>
    <p>Bandwidth estimation is an important area of Internet research  Plays an important role in characterizing network paths  Potentially can help various Internet applications</p>
    <p>The vast majority of tools focuses on end-to-end measurements  The ultimate goal is to measure diverse Internet paths</p>
    <p>under various traffic and network conditions  Fast estimation and high accuracy are desired</p>
  </div>
  <div class="page">
    <p>m p</p>
    <p>ut e</p>
    <p>ie nc</p>
    <p>e , T</p>
    <p>e xa</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U ni</p>
    <p>ve rs</p>
    <p>ity</p>
    <p>Introduction (2)Introduction (2)Introduction (2)</p>
    <p>All existing methods heavily rely on high-precision delay measurement at end-hosts  However, delay measurements are not perfect in practice  Interrupt delays at NIC cause timing irregularity</p>
    <p>State of the art tools attempt to reduce the effect of interrupt delays  Pathchirp and Pathload aim to weed out packets affected</p>
    <p>by interrupt delays</p>
  </div>
  <div class="page">
    <p>m p</p>
    <p>ut e</p>
    <p>ie nc</p>
    <p>e , T</p>
    <p>e xa</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U ni</p>
    <p>ve rs</p>
    <p>ity</p>
    <p>Introduction (3)Introduction (3)Introduction (3)</p>
    <p>Pathchirp  Sends substantially more packets by setting an option</p>
    <p>manually  Not desirable since it prolongs measurement duration</p>
    <p>Pathload  Filters out affected packets without increasing the number</p>
    <p>of probing packets  Has limited effect when interrupt delays are non-trivial</p>
    <p>Goal  To develop a tool that is robust to timing irregularity caused</p>
    <p>by NICs interrupt moderation  Mainly focus on improving Pathload</p>
  </div>
  <div class="page">
    <p>m p</p>
    <p>ut e</p>
    <p>ie nc</p>
    <p>e , T</p>
    <p>e xa</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U ni</p>
    <p>ve rs</p>
    <p>ity</p>
    <p>AgendaAgendaAgenda</p>
    <p>Introduction</p>
    <p>Interrupt moderation</p>
    <p>Analysis of Pathload  Impact of interrupt delays  Trend detection problem</p>
    <p>IMR-Pathload</p>
    <p>Performance evaluation</p>
    <p>Wrap-up</p>
  </div>
  <div class="page">
    <p>m p</p>
    <p>ut e</p>
    <p>ie nc</p>
    <p>e , T</p>
    <p>e xa</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U ni</p>
    <p>ve rs</p>
    <p>ity</p>
    <p>Interrupt ModerationInterrupt ModerationInterrupt Moderation</p>
    <p>Packet arrival/departure events at a network interface card (NIC) is handled by the CPU through interrupts</p>
    <p>Generating interrupts for every packet event creates significant per-packet overhead  For a Gigabit Ethernet NIC, an interrupt could be generated</p>
    <p>every 12 s with packets of size 1500 bytes  Substantial overhead for interrupt handling</p>
    <p>Solution to this is using interrupt moderation  Delays generation of a new interrupt  Stores packets at NIC until the next interrupt</p>
  </div>
  <div class="page">
    <p>m p</p>
    <p>ut e</p>
    <p>ie nc</p>
    <p>e , T</p>
    <p>e xa</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U ni</p>
    <p>ve rs</p>
    <p>ity</p>
    <p>Interrupt Moderation (2)Interrupt Moderation (2)Interrupt Moderation (2)</p>
    <p>It has become a common practice with Gigabit NICs</p>
    <p>At a single interrupt, NIC delivers multiple packets to the kernel</p>
    <p>time</p>
    <p>packets received after the last interrupt NIC delivers packets in a burst</p>
  </div>
  <div class="page">
    <p>m p</p>
    <p>ut e</p>
    <p>ie nc</p>
    <p>e , T</p>
    <p>e xa</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U ni</p>
    <p>ve rs</p>
    <p>ity</p>
    <p>Interrupt Moderation (3)Interrupt Moderation (3)Interrupt Moderation (3)</p>
    <p>Impact on inter-packet dispersions</p>
    <p>no interrupt moderation interrupt moderation</p>
  </div>
  <div class="page">
    <p>m p</p>
    <p>ut e</p>
    <p>ie nc</p>
    <p>e , T</p>
    <p>e xa</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U ni</p>
    <p>ve rs</p>
    <p>ity</p>
    <p>Interrupt Moderation (4)Interrupt Moderation (4)Interrupt Moderation (4)</p>
    <p>Impact on one-way delays (OWD) of probing packets  Difference between the sending time and arrival time</p>
    <p>no interrupt moderation interrupt moderation</p>
    <p>Negative trend in a single burst appears when receive latency is larger than inter-packet spacing at the sender</p>
  </div>
  <div class="page">
    <p>m p</p>
    <p>ut e</p>
    <p>ie nc</p>
    <p>e , T</p>
    <p>e xa</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U ni</p>
    <p>ve rs</p>
    <p>ity</p>
    <p>AgendaAgendaAgenda</p>
    <p>Introduction</p>
    <p>Interrupt moderation</p>
    <p>Analysis of Pathload  Impact of interrupt delays  Trend detection problem</p>
    <p>IMR-Pathload</p>
    <p>Performance evaluation</p>
    <p>Wrap-up</p>
  </div>
  <div class="page">
    <p>m p</p>
    <p>ut e</p>
    <p>ie nc</p>
    <p>e , T</p>
    <p>e xa</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U ni</p>
    <p>ve rs</p>
    <p>ity</p>
    <p>ObservationObservationObservation</p>
    <p>Many paths in PlanetLab cannot be measured by Pathload  We suspect that timing irregularity due to interrupt</p>
    <p>moderation is the major reason</p>
    <p>Thus, we investigate how interrupt delays affect Pathloads estimation  Conduct experiments in Emulab for different interrupt delays</p>
    <p>at the receiver</p>
    <p>We start by describing a topology for Emulab experiments</p>
  </div>
  <div class="page">
    <p>m p</p>
    <p>ut e</p>
    <p>ie nc</p>
    <p>e , T</p>
    <p>e xa</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U ni</p>
    <p>ve rs</p>
    <p>ity</p>
    <p>Experimentation TopologyExperimentation TopologyExperimentation Topology</p>
    <p>The speed of all access links is 100 Mb/s (delay 10 ms)  The remaining links between two routers have capacities Ci</p>
    <p>and propagation delay 40 ms  TCP cross-traffic is generated by Iperf traffic generator</p>
    <p>Run 100 threads in each cross-traffic source Si</p>
  </div>
  <div class="page">
    <p>m p</p>
    <p>ut e</p>
    <p>ie nc</p>
    <p>e , T</p>
    <p>e xa</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U ni</p>
    <p>ve rs</p>
    <p>ity</p>
    <p>Experimentation SetupExperimentation SetupExperimentation Setup</p>
    <p>Shaded values in each row represent the capacity and available bandwidth of the tight-link for each case</p>
    <p>Tight link is the link with the smallest available bandwidth  Values in square brackets represent the capacity of the</p>
    <p>narrow link for each case  Narrow link represents the link with the lowest speed</p>
  </div>
  <div class="page">
    <p>m p</p>
    <p>ut e</p>
    <p>ie nc</p>
    <p>e , T</p>
    <p>e xa</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U ni</p>
    <p>ve rs</p>
    <p>ity</p>
    <p>Experimentation Setup (2)Experimentation Setup (2)Experimentation Setup (2)</p>
    <p>Define eA to be relative estimation error:</p>
    <p>true available bandwidth of a path</p>
    <p>estimate of A</p>
  </div>
  <div class="page">
    <p>m p</p>
    <p>ut e</p>
    <p>ie nc</p>
    <p>e , T</p>
    <p>e xa</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U ni</p>
    <p>ve rs</p>
    <p>ity</p>
    <p>Estimation ReliabilityEstimation ReliabilityEstimation Reliability</p>
    <p>Next examine estimation behavior of Pathload with various interrupt delays</p>
    <p>With small interrupt delay, estimation accuracy is over 80%</p>
    <p>When the delay becomes larger, Pathload is unable to produce reliable estimates</p>
  </div>
  <div class="page">
    <p>m p</p>
    <p>ut e</p>
    <p>ie nc</p>
    <p>e , T</p>
    <p>e xa</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U ni</p>
    <p>ve rs</p>
    <p>ity</p>
    <p>Estimation AlgorithmEstimation AlgorithmEstimation Algorithm</p>
    <p>Recall that Pathload sends a sequence of packettrains with a rate R  Each train includes N back-to-back packets</p>
    <p>Receiver examines OWDs in each train and returns their trend information to the sender</p>
    <p>Sender adjusts its probe rate R in a binary search fashion based on the trend information  Increase the probe rate R if no trend is detected  Decrease R if an increasing trend is detected</p>
  </div>
  <div class="page">
    <p>m p</p>
    <p>ut e</p>
    <p>ie nc</p>
    <p>e , T</p>
    <p>e xa</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U ni</p>
    <p>ve rs</p>
    <p>ity</p>
    <p>Estimation Algorithm (2)Estimation Algorithm (2)Estimation Algorithm (2)</p>
    <p>Search for an appropriate probe rate R</p>
    <p>sequence of probe-trains</p>
    <p>probe rate R</p>
    <p>A</p>
  </div>
  <div class="page">
    <p>m p</p>
    <p>ut e</p>
    <p>ie nc</p>
    <p>e , T</p>
    <p>e xa</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U ni</p>
    <p>ve rs</p>
    <p>ity</p>
    <p>AgendaAgendaAgenda</p>
    <p>Introduction</p>
    <p>Interrupt moderation</p>
    <p>Analysis of Pathload  Impact of interrupt delays  Trend detection problem</p>
    <p>IMR-Pathload</p>
    <p>Performance evaluation</p>
    <p>Wrap-up</p>
  </div>
  <div class="page">
    <p>m p</p>
    <p>ut e</p>
    <p>ie nc</p>
    <p>e , T</p>
    <p>e xa</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U ni</p>
    <p>ve rs</p>
    <p>ity</p>
    <p>Trend DetectionTrend DetectionTrend Detection</p>
    <p>PCT and PDT metrics are used for trend detection</p>
    <p>PCT (Pairwise Comparison Test)</p>
    <p>Represents the fraction of consecutive OWD pairs that are increasing</p>
    <p>PDT (Pariwise Difference Test)</p>
    <p>Quantifies how strong the difference between the first and last OWDs in the data set is</p>
    <p>OWD of a packet j1 in a set of size n</p>
    <p>I(Y) is one if Y holds, zero otherwise</p>
  </div>
  <div class="page">
    <p>m p</p>
    <p>ut e</p>
    <p>ie nc</p>
    <p>e , T</p>
    <p>e xa</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U ni</p>
    <p>ve rs</p>
    <p>ity</p>
    <p>Trend Detection (2)Trend Detection (2)Trend Detection (2)</p>
    <p>To assess Pathloads trend detection mechanism, we conduct experiments for Case I (A = 31 Mb/s)  Collect OWD data by running Pathload with a fixed rate R=38 Mb/s and interrupt delay  = 250 s</p>
    <p>OWDs exhibit increasing trend overall</p>
    <p>one-way delays subtracted by their minimum value</p>
  </div>
  <div class="page">
    <p>m p</p>
    <p>ut e</p>
    <p>ie nc</p>
    <p>e , T</p>
    <p>e xa</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U ni</p>
    <p>ve rs</p>
    <p>ity</p>
    <p>Trend Detection (3)Trend Detection (3)Trend Detection (3)</p>
    <p>Before applying PCT and PDT tests, Pathload eliminates coalesced (back-to-back) packets</p>
    <p>However, it is unable to detect an increasing trend in the OWDs as it obtains PCT = 0.5, PDT = 0.11  increasing if PCT &gt; 0.66, non-increasing if PCT &lt; 0.54  increasing if PDT &gt; 0.55, non-increasing if PDT &lt; 0.45</p>
  </div>
  <div class="page">
    <p>m p</p>
    <p>ut e</p>
    <p>ie nc</p>
    <p>e , T</p>
    <p>e xa</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U ni</p>
    <p>ve rs</p>
    <p>ity</p>
    <p>AgendaAgendaAgenda</p>
    <p>Introduction</p>
    <p>Interrupt moderation</p>
    <p>Analysis of Pathload  Impact of interrupt delays  Trend detection problem</p>
    <p>IMR-Pathload</p>
    <p>Performance evaluation</p>
    <p>Wrap-up</p>
  </div>
  <div class="page">
    <p>m p</p>
    <p>ut e</p>
    <p>ie nc</p>
    <p>e , T</p>
    <p>e xa</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U ni</p>
    <p>ve rs</p>
    <p>ity</p>
    <p>IMR-PathloadIMRIMR--PathloadPathload</p>
    <p>Characterizing delay trend in measured noisy OWD data is a difficult problem Pathloads trend detection algorithm is not much</p>
    <p>effective in dealing with this</p>
    <p>To overcome this, we introduce two noisefiltering techniques in bandwidth measurement Wavelet-based signal processing Window-based averaging</p>
    <p>IMR-Pathload Interrupt Moderation Resilient Pathload</p>
  </div>
  <div class="page">
    <p>m p</p>
    <p>ut e</p>
    <p>ie nc</p>
    <p>e , T</p>
    <p>e xa</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U ni</p>
    <p>ve rs</p>
    <p>ity</p>
    <p>IMR-Pathload (2)IMRIMR--PathloadPathload (2)(2)</p>
    <p>OWD process can be decomposed into two components using wavelet decomposition  Scale coefficients represent deterministic trend  Wavelet coefficients represent stochastic noise</p>
    <p>noise</p>
    <p>trend</p>
    <p>HPF</p>
    <p>LPF</p>
  </div>
  <div class="page">
    <p>m p</p>
    <p>ut e</p>
    <p>ie nc</p>
    <p>e , T</p>
    <p>e xa</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U ni</p>
    <p>ve rs</p>
    <p>ity</p>
    <p>IMR-Pathload (3)IMRIMR--PathloadPathload (3)(3)</p>
    <p>Decomposition can be iterated  Successive scale coefficients are decomposed in turn</p>
    <p>cAj: scale coefficients in level j  cDj: wavelet coefficients in level j</p>
    <p>cA1 cD1</p>
    <p>S</p>
    <p>cA2 cD2</p>
    <p>cA3 cD3</p>
    <p>original signal</p>
  </div>
  <div class="page">
    <p>m p</p>
    <p>ut e</p>
    <p>ie nc</p>
    <p>e , T</p>
    <p>e xa</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U ni</p>
    <p>ve rs</p>
    <p>ity</p>
    <p>IMR-Pathload (4)IMRIMR--PathloadPathload (4)(4)</p>
    <p>OWD data are processed using wavelet decomposition or k-packet window-based averaging  For experiments, we use Daubechies length-4 wavelets</p>
    <p>Scale coefficients are given by:</p>
    <p>Wavelet coefficients are:</p>
  </div>
  <div class="page">
    <p>m p</p>
    <p>ut e</p>
    <p>ie nc</p>
    <p>e , T</p>
    <p>e xa</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U ni</p>
    <p>ve rs</p>
    <p>ity</p>
    <p>IMR-Pathload (5)IMRIMR--PathloadPathload (5)(5)</p>
    <p>Assume that a sequence s0, s1, , sn1is an input to the j-th stage filters</p>
    <p>Then, cAj,k and cDj,k are given by:</p>
  </div>
  <div class="page">
    <p>m p</p>
    <p>ut e</p>
    <p>ie nc</p>
    <p>e , T</p>
    <p>e xa</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U ni</p>
    <p>ve rs</p>
    <p>ity</p>
    <p>IMR-Pathload (6)IMRIMR--PathloadPathload (6)(6)</p>
    <p>Effect of de-noising on trend detection</p>
    <p>wavelet decomposition window averaging</p>
    <p>PCT=0.75, PDT=0.78 PCT=0.8, PDT=0.74</p>
    <p>IMR-Pathload: able to detect increasing trend accurately</p>
    <p>original OWDs</p>
    <p>PCT=0.5, PDT=0.11</p>
    <p>Pathload: unable to detect increasing trend</p>
  </div>
  <div class="page">
    <p>m p</p>
    <p>ut e</p>
    <p>ie nc</p>
    <p>e , T</p>
    <p>e xa</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U ni</p>
    <p>ve rs</p>
    <p>ity</p>
    <p>AgendaAgendaAgenda</p>
    <p>Introduction</p>
    <p>Interrupt moderation</p>
    <p>Analysis of Pathload  Impact of interrupt delays  Trend detection problem</p>
    <p>IMR-Pathload</p>
    <p>Performance evaluation</p>
    <p>Wrap-up</p>
  </div>
  <div class="page">
    <p>m p</p>
    <p>ut e</p>
    <p>ie nc</p>
    <p>e , T</p>
    <p>e xa</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U ni</p>
    <p>ve rs</p>
    <p>ity</p>
    <p>Performance EvaluationPerformance EvaluationPerformance Evaluation</p>
    <p>Emulab experiments  Investigate estimation accuracy of IMR-Pathload under a</p>
    <p>wide range of interrupt delays  Main metric is the relative estimation error eA</p>
    <p>Internet experiments  Measure Internet paths between several sites in US  Show how reliably IMR-Pathload measures Internet paths</p>
    <p>compared to the original Pathload</p>
  </div>
  <div class="page">
    <p>m p</p>
    <p>ut e</p>
    <p>ie nc</p>
    <p>e , T</p>
    <p>e xa</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U ni</p>
    <p>ve rs</p>
    <p>ity</p>
    <p>Emulab ExperimentEmulab ExperimentEmulab Experiment</p>
    <p>IMR-Pathload produces available bandwidth estimates for all cases with 88-99% accuracy</p>
    <p>Even with a large interrupt delay  = 500 s, it measures the paths within eA=10% error  Recall that the original Pathload can measure none of the</p>
    <p>paths when  &gt; 125 s</p>
  </div>
  <div class="page">
    <p>m p</p>
    <p>ut e</p>
    <p>ie nc</p>
    <p>e , T</p>
    <p>e xa</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U ni</p>
    <p>ve rs</p>
    <p>ity</p>
    <p>Internet ExperimentInternet ExperimentInternet Experiment</p>
    <p>Measure each path during 5 different periods of time in a day  Run both tools 3 times for each time period over a particular</p>
    <p>path</p>
    <p>If a tool can measure a path in all 3 times for a period, we report their average as its bandwidth estimate</p>
    <p>If a tool fails to measure a path at lest once in 3 trials, we consider that the tool cannot reliably measure that particular path during that period</p>
  </div>
  <div class="page">
    <p>m p</p>
    <p>ut e</p>
    <p>ie nc</p>
    <p>e , T</p>
    <p>e xa</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U ni</p>
    <p>ve rs</p>
    <p>ity</p>
    <p>Internet Experiment (2)Internet Experiment (2)Internet Experiment (2)</p>
    <p>Pathload cannot reliably measure these paths</p>
  </div>
  <div class="page">
    <p>m p</p>
    <p>ut e</p>
    <p>ie nc</p>
    <p>e , T</p>
    <p>e xa</p>
    <p>s A</p>
    <p>&amp; M</p>
    <p>U ni</p>
    <p>ve rs</p>
    <p>ity</p>
    <p>Wrap-upWrapWrap--upup</p>
    <p>Pathload exhibits estimation instability under nonnegligible interrupt delays  Instability stems from the fact that its delay-trend detection</p>
    <p>mechanism is unreliable</p>
    <p>IMR-Pathload provides robust trend detection under a wide range of interrupt delays  Signal de-noising facilitates accurate trend-detection</p>
    <p>IMR-Pathload significantly improves measurement stability of the original Pathload under various network settings</p>
  </div>
</Presentation>
