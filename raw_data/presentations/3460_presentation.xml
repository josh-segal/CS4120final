<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Who left open the cookie jar? A comprehensive evaluation of third-party cookie policies Gertjan Franken, Tom Van Goethem, Wouter Joosen</p>
    <p>August 15th 2018</p>
  </div>
  <div class="page">
    <p>Third-party policies are highly relevant today</p>
    <p>Online tracking study (200,000 users) [2] 95% of visited pages initiated cross-site request to potential trackers</p>
    <p>Of which 78% attempted to transfer potentially identifying data</p>
    <p>[1] https://www.zdnet.com/article/openemr-security-flaws-left-millions-of-patient-records-open-to-attack/ [2] YU, Z., MACBETH, S., MODI, K., ANDPUJOL, J.M. Tracking the trackers. In Proceedings of the 25th International Conference on World Wide Web (Republic and Canton of Geneva, Switzer- land, 2016)</p>
    <p>[1]</p>
  </div>
  <div class="page"/>
  <div class="page"/>
  <div class="page">
    <p>Outline</p>
    <p>Why you should keep an eye on your cookies</p>
    <p>The comprehensive evaluation</p>
    <p>Whats wrong with your browsers third-party cookie policies</p>
    <p>Conclusion</p>
  </div>
  <div class="page">
    <p>Why you should keep an eye on your cookies</p>
  </div>
  <div class="page">
    <p>Web Fundamentals</p>
    <p>domainA.com domainB.com</p>
    <p>/index.html /image.jpg</p>
    <p>Browser domainA.com/</p>
    <p>index.html domainB.com/</p>
    <p>image.jpg</p>
    <p>HTTP cookies [1]</p>
    <p>Domain A Domain B</p>
    <p>Implicit inclusion</p>
    <p>Authentication / identification</p>
    <p>Same-Origin Policy</p>
    <p>[1] Barth, A., &quot;HTTP State Management Mechanism&quot;, RFC 6265, DOI 10.17487/RFC6265, April 2011.</p>
    <p>A B A</p>
    <p>B</p>
  </div>
  <div class="page">
    <p>Exploitation of implicit authentication</p>
    <p>CSRF</p>
    <p>XSSI</p>
    <p>Cross-site timing attacks</p>
    <p>Cross-site attacks</p>
    <p>cute-kittens.comvictim doggo-bank.com</p>
    <p>&amp; 9 :: 9 - &quot; : 9/. &quot; : . . : : 99</p>
  </div>
  <div class="page">
    <p>Exploitation of implicit authentication</p>
    <p>CSRF</p>
    <p>XSSI</p>
    <p>Cross-site timing attacks</p>
    <p>Cross-site attacks</p>
    <p>cute-kittens.comvictim doggo-bank.com</p>
    <p>&amp; 9 :: 9 - &quot; : 9/. &quot; : . . : : 99</p>
    <p>THIRD-PARTY COOKIE</p>
    <p>POLICIES</p>
  </div>
  <div class="page">
    <p>Exploitation of implicit identification Tracking</p>
    <p>cat-news.comvictim paw-book.com</p>
    <p>: /:: &lt; &quot; &lt; .-:&quot; : -&lt; &quot; : &quot;/: :</p>
    <p>Advertising</p>
    <p>Social media</p>
    <p>Web analytics</p>
  </div>
  <div class="page">
    <p>Exploitation of implicit identification Tracking</p>
    <p>cat-news.comvictim paw-book.com</p>
    <p>: /:: &lt; &quot; &lt; .-:&quot; : -&lt; &quot; : &quot;/: :</p>
    <p>Advertising</p>
    <p>Social media</p>
    <p>Web analytics</p>
    <p>THIRD-PARTY COOKIE</p>
    <p>POLICIES</p>
  </div>
  <div class="page">
    <p>Existing third-party cookie policies</p>
    <p>Built-in browser options Block third-party cookies</p>
    <p>Firefox Tracking Protection</p>
    <p>Opera Ad Blocker</p>
    <p>Safari Intelligent Tracking Prevention</p>
    <p>Extensions Ad blocking</p>
    <p>Privacy protection</p>
    <p>Same-site cookies</p>
  </div>
  <div class="page">
    <p>Same-site cookie [1]</p>
    <p>Cookie with extra attribute SameSite</p>
    <p>SameSite=strict  NO CROSS-SITE REQUESTS!</p>
    <p>SameSite=lax  exceptions: top-level GET, prerender</p>
    <p>[1] West, M., Goodwin, M. Same-site cookies. Internet- Draft draft-ietf-httpbis-cookie-same-site-00,</p>
    <p>IETF Secretariat, June 2016.</p>
  </div>
  <div class="page">
    <p>Use of same-site cookies against cross-site attacks</p>
    <p>cute-kittens.comvictim doggo-bank.comdoggo-bank.com</p>
  </div>
  <div class="page">
    <p>Why evaluate third-party cookie policies?</p>
    <p>Browsers are known to exhibit inconsistent behavior Interference from different standards</p>
    <p>Unintended side-effects by code modification</p>
    <p>Extensions have been actively bypassed in the past [1]</p>
    <p>[1] https://blog.bugreplay.com/2016/11/pornhub-bypasses-ad-blockers-with.html</p>
    <p>Comprehensive evaluation of effectiveness</p>
  </div>
  <div class="page">
    <p>The comprehensive evaluation</p>
  </div>
  <div class="page">
    <p>Black box approach</p>
    <p>No code review! Browsers consist of millions of lines of code</p>
    <p>Source code not always available</p>
    <p>Many interesting extensions</p>
    <p>Framework Bypass detection data Browser instance - Browser - Extension - Configuration</p>
  </div>
  <div class="page">
    <p>Framework Design</p>
  </div>
  <div class="page">
    <p>Framework Design</p>
  </div>
  <div class="page">
    <p>Framework Design</p>
  </div>
  <div class="page">
    <p>Inside the framework</p>
    <p>Browser control Selenium / Command line interface</p>
    <p>Web server Initiate cross-site requests to blacklisted domain</p>
    <p>Proxy intercepts all requests</p>
    <p>Browser instance</p>
    <p>Proxy</p>
    <p>Web Server</p>
  </div>
  <div class="page">
    <p>Initiating cross-site requests</p>
    <p>AppCache API Caching cross-site pages</p>
    <p>HTML-tags &lt;script&gt;, &lt;img&gt;, &lt;link&gt;, etc.</p>
    <p>Headers Link, CSP headers</p>
    <p>Redirects</p>
    <p>JavaScript Fetch, EventSource API, etc.</p>
    <p>PDF JS sendForm()</p>
    <p>ServiceWorker API</p>
  </div>
  <div class="page">
    <p>Whats wrong with your browsers third-party cookie policies</p>
  </div>
  <div class="page">
    <p>Overview  Browsers</p>
    <p>Chrome</p>
    <p>Opera</p>
    <p>Firefox</p>
    <p>Safari</p>
    <p>Edge</p>
    <p>Tor Browser</p>
    <p>Cliqz</p>
    <p>Extensions</p>
    <p>Ad blocking (31)</p>
    <p>Tracking protection (15)</p>
    <p>SameSite</p>
    <p>SameSite</p>
    <p>SameSite</p>
    <p>SameSite</p>
  </div>
  <div class="page"/>
  <div class="page"/>
  <div class="page"/>
  <div class="page"/>
  <div class="page">
    <p>Extensions</p>
    <p>No extension managed to block all third-party cookies to blacklisted domains</p>
    <p>Insufficient API PDF JS for Chromium, but also Firefox favicon (HTML tags)</p>
    <p>Unclear API No clear distinction for browser background requests</p>
    <p>Common mistakes Insufficient permissions to intercept certain requests</p>
  </div>
  <div class="page">
    <p>PDFium design flaw</p>
    <p>Chrome and Opera</p>
    <p>DomainBGET / POST request</p>
  </div>
  <div class="page">
    <p>PDFium design flaw</p>
    <p>Chrome and Opera</p>
    <p>DomainBGET / POST request</p>
    <p>Extension API</p>
  </div>
  <div class="page">
    <p>PDFium design flaw</p>
    <p>Chrome and Opera</p>
    <p>DomainBGET / POST request</p>
    <p>Extension API</p>
    <p>Plugin / Extension</p>
  </div>
  <div class="page">
    <p>PDFium design flaw</p>
    <p>Chrome and Opera</p>
    <p>DomainBGET / POST request</p>
    <p>Extension API</p>
    <p>Plugin / Extension</p>
  </div>
  <div class="page">
    <p>PDFium design flaw</p>
    <p>Chrome and Opera</p>
    <p>DomainBGET / POST request</p>
    <p>Extension API</p>
    <p>Plugin / Extension Block third-party</p>
    <p>cookie option</p>
  </div>
  <div class="page">
    <p>Same-site cookie policy</p>
    <p>Chrome and Opera: prerender functionality Both lax and strict included in cross-site request</p>
    <p>Edge Lax bypasses: WebSocket API, &lt;embed&gt;, &lt;object&gt;</p>
    <p>Strict bypasses: WebSocket API, redirects</p>
  </div>
  <div class="page">
    <p>Exploitation of a bypass Same-site cookies</p>
    <p>cute-kittens.comvictim doggo-bank.comdoggo-bank.com</p>
    <p>:/ 9:/:/ ./: :/ &lt;&lt;9 &amp; . &quot; - &lt;: /: 9 9 = &lt; :/- 9 / &lt; - &lt;</p>
  </div>
  <div class="page">
    <p>Evaluation of the framework</p>
    <p>Distributed crawler setup Interception of headless Chrome network traffic (using linux network namespaces)</p>
    <p>Analysis of intercepted HTTP requests</p>
    <p>Alexa Top 10,000 Up to 20 pages on each website</p>
    <p>Completeness and novelty</p>
  </div>
  <div class="page">
    <p>Conclusion</p>
  </div>
  <div class="page">
    <p>Conclusion</p>
    <p>Built-in browser policies can be bypassed Same-site cookie, third-party cookie policies</p>
    <p>Advanced options (e.g. Opera AdBlocker, Firefox Tracking Protection)</p>
    <p>All adblocking and privacy extensions can be bypassed Due to extension API provided by browsers</p>
    <p>Due to common mistakes by extension developers</p>
    <p>What did we find?</p>
  </div>
  <div class="page">
    <p>Future work</p>
    <p>Expansion of framework Policy-wise  private browsing mode, security (e.g. CSP)</p>
    <p>Platform-wise  mobile browsers</p>
    <p>Goal: tool for comprehensive, automated analysis of</p>
    <p>security and privacy policy implementations</p>
    <p>What about other policies?</p>
  </div>
  <div class="page">
    <p>Illustration of importance</p>
    <p>Originally reported for Chrome 57</p>
    <p>Present in: 58 59 60 61</p>
    <p>Fixed in: 62 63 64 65</p>
    <p>Reintroduced in: 66 67 68</p>
    <p>Shows importance of a comprehensive evaluation</p>
    <p>of implemented policies</p>
    <p>The prerender bug (same-site policy bypass)</p>
  </div>
  <div class="page">
    <p>Thank you!</p>
    <p>More info and details:</p>
    <p>www.WhoLeftOpenTheCookieJar.com</p>
  </div>
</Presentation>
