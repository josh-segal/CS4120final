<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Interactive DNS rebinding</p>
    <p>Yunxing Dai, Ryan Resig yunxing@upthere.com, rresig@umich.edu</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>About myself</p>
    <p>Just graduated from University of Michigan  Joined as a backend engineer</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>How secure is it?</p>
    <p>Given a malicious link, how secure is your browser?</p>
    <p>Incognito mode  sandbox  no input of sensitive data  no executables files</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Goal</p>
    <p>Allows the attacker to make the victims browser as a proxy, thus gain access to an internal webpage</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-0</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-0</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-0</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-0</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-0</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-0</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-0</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-0</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-0</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-0</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-0</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-0</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-0</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-0</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-0</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Same Origin Policy</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>DNS Rebinding</p>
    <p>Attack the system in the IP layer.  Time varying</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-1Time-Varying</p>
    <p>attacker.com = ?</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-1Time-Varying</p>
    <p>attacker.com = ?</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-1Time-Varying</p>
    <p>attacker.com = ?</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-1Time-Varying</p>
    <p>attacker.com = ?</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-1Time-Varying</p>
    <p>attacker.com = ?</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-1Time-Varying</p>
    <p>attacker.com = ?</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-1Time-Varying</p>
    <p>attacker.com = 1.2.1.2</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-1Time-Varying</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-1Time-Varying</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-1Time-Varying</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-1Time-Varying</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-1Time-Varying</p>
    <p>attacker.com = ?</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-1Time-Varying</p>
    <p>attacker.com = ?</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-1Time-Varying</p>
    <p>attacker.com = ?</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-1Time-Varying</p>
    <p>attacker.com = ?</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-1Time-Varying</p>
    <p>attacker.com = ?</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-1Time-Varying</p>
    <p>attacker.com = ?</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-1Time-Varying</p>
    <p>TextText</p>
    <p>attacker.com = 127.0.0.1</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-1Time-Varying</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>DNS Pinning</p>
    <p>Ignore the TTL and pin the DNS entry in the Browsers cache after it expires</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Time varying attack</p>
    <p>Force the browser to issue the second DNS query</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Same Origin Policy?</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Same Origin Policy?</p>
    <p>Screws API up!</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Same Origin Policy Exceptions</p>
    <p>JSONP  WebSocket</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Same Origin Policy Exceptions</p>
    <p>JSONP  WebSocket</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Same Origin Policy Exceptions</p>
    <p>Another DNS query</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Same Origin Policy Exceptions</p>
    <p>Which will be pinned to the browser</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Same Origin Policy Exceptions</p>
    <p>The Browser has small DNS cache size</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Same Origin Policy Exceptions</p>
    <p>Earlier entries will be evicted</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Same Origin Policy Exceptions</p>
    <p>And we can thus flood it</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Implementation</p>
    <p>Flood the DNS cache with lots of cross site references</p>
    <p>Evict the original DNS entry  Force the browser to do the second DNS</p>
    <p>query</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-2 DNS table flooding</p>
    <p>attacker.com = ?</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-2 DNS table flooding</p>
    <p>attacker.com = ?</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-2 DNS table flooding</p>
    <p>attacker.com = ?</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-2 DNS table flooding</p>
    <p>attacker.com = ?</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-2 DNS table flooding</p>
    <p>attacker.com = ?</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-2 DNS table flooding</p>
    <p>attacker.com = ?</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-2 DNS table flooding</p>
    <p>attacker.com = 1.2.1.2</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-2 DNS table flooding</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-2 DNS table flooding</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-2 DNS table flooding</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-2 DNS table flooding</p>
    <p>attacker.com = 1.2.1.2</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-2 DNS table flooding</p>
    <p>attacker.com = 1.2.1.2</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-2 DNS table flooding</p>
    <p>attacker.com = 1.2.1.2</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-2 DNS table flooding</p>
    <p>attacker.com = 1.2.1.2</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-2 DNS table flooding</p>
    <p>attacker.com = 1.2.1.2</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-2 DNS table flooding</p>
    <p>attacker.com = ?</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-2 DNS table flooding</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-2 DNS table flooding</p>
    <p>attacker.com = ?</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-2 DNS table flooding</p>
    <p>attacker.com = ?</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-2 DNS table flooding</p>
    <p>attacker.com = ?</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Level-2 DNS table flooding</p>
    <p>TextText</p>
    <p>attacker.com = 127.0.0.1</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Live Demo</p>
    <p>Registered the domain name dnsrebind.info  Used it as a malicious link to access the</p>
    <p>routers control panel in my apartment</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>More examples</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>More examples</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>More examples</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Defenses</p>
    <p>Host: header field checking  Giving DNS entry correct priorities</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Discussion</p>
    <p>DNS rebinding has been existed for a long time, still hasnt been fixed</p>
  </div>
  <div class="page">
    <p>yunxing@upthere.com</p>
    <p>Questions?</p>
  </div>
</Presentation>
