<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think</p>
    <p>Marc GreenW, Leandro Rodrigues-LimaF, Andreas ZanklF, Gorka IrazoquiW, Johann HeyszlF, and Thomas EisenbarthW</p>
    <p>August 18th 2017  USENIX Security Symposium</p>
  </div>
  <div class="page">
    <p>The Big Picture</p>
    <p>Cache Attacks</p>
    <p>AutoLock</p>
    <p>Transition of attacks: desktop &amp; server  mobile</p>
    <p>Dedicated countermeasures are still necessary for protection</p>
    <p>Vulnerabililty and risk assessment are important, but challenging</p>
    <p>Eviction-based attacks are harder than previously believed</p>
    <p>Limited understanding of commercial microarchitectures</p>
    <p>Undocumented performance feature of inclusive caches on ARM</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 2</p>
  </div>
  <div class="page">
    <p>Cache Basics</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 3</p>
  </div>
  <div class="page">
    <p>Cache Basics Hierarchy</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 4</p>
  </div>
  <div class="page">
    <p>Cache Basics Hierarchy</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 5</p>
  </div>
  <div class="page">
    <p>Cache Basics Hierarchy</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 6</p>
  </div>
  <div class="page">
    <p>Cache Basics Hierarchy</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 7</p>
  </div>
  <div class="page">
    <p>Cache Basics Hierarchy</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 8</p>
  </div>
  <div class="page">
    <p>Cache Basics Hierarchy</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 9</p>
  </div>
  <div class="page">
    <p>Cache Basics Inclusiveness</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 10</p>
  </div>
  <div class="page">
    <p>Cache Basics Inclusiveness</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 11</p>
  </div>
  <div class="page">
    <p>Cache Basics Inclusiveness</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 12</p>
  </div>
  <div class="page">
    <p>Cache Basics Inclusiveness</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 13</p>
  </div>
  <div class="page">
    <p>Cache Basics Inclusiveness</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 14</p>
  </div>
  <div class="page">
    <p>Cache Basics Inclusiveness</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 15</p>
  </div>
  <div class="page">
    <p>Cache Basics Inclusiveness</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 16</p>
  </div>
  <div class="page">
    <p>Cache Basics Inclusiveness</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 17</p>
  </div>
  <div class="page">
    <p>Cache Basics Inclusiveness</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 18</p>
  </div>
  <div class="page">
    <p>Cache Attacks</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 19</p>
  </div>
  <div class="page">
    <p>Cache Attacks Cross-core Eviction</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 20</p>
  </div>
  <div class="page">
    <p>Cache Attacks Cross-core Eviction</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 21</p>
  </div>
  <div class="page">
    <p>Cache Attacks Cross-core Eviction</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 22</p>
  </div>
  <div class="page">
    <p>Cache Attacks Cross-core Eviction</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 23</p>
  </div>
  <div class="page">
    <p>Cache Attacks Cross-core Eviction</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 24</p>
  </div>
  <div class="page">
    <p>Cache Attacks Cross-core Eviction</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 25</p>
  </div>
  <div class="page">
    <p>Cache Attacks Cross-core Eviction</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 26</p>
  </div>
  <div class="page">
    <p>Cache Attacks Cross-core Eviction</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 27</p>
  </div>
  <div class="page">
    <p>Cache Attacks Cross-core Eviction</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 28</p>
  </div>
  <div class="page">
    <p>Cache Attacks Cross-core Eviction</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 29</p>
  </div>
  <div class="page">
    <p>Cache Attacks Cross-core Eviction</p>
    <p>N or</p>
    <p>m al</p>
    <p>iz ed</p>
    <p>f re</p>
    <p>qu en</p>
    <p>cy</p>
    <p>without eviction with eviction</p>
    <p>Qualcomm Krait 450</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 30</p>
  </div>
  <div class="page">
    <p>Cache Attacks Literature</p>
    <p>Method Task Reference</p>
    <p>Evict + Time Eviction [OST06] Prime + Probe Eviction [OST06] Evict + Reload Eviction [GSM15] Evict + Prefetch Eviction [GMF+16] Flush + Reload Flush [YF14] Flush + Prefetch Flush [GMF+16] Flush + Flush Flush [GMWM16]</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 31</p>
  </div>
  <div class="page">
    <p>Cache Attacks ARM Processors</p>
    <p>Flush on ARM</p>
    <p>Easy, fast, and robust</p>
    <p>Only from ARMv8 onwards</p>
    <p>No guaranteed userspace access</p>
    <p>Limited number of devices</p>
    <p>Eviction on ARM</p>
    <p>Complex, slow, and error-prone</p>
    <p>All ARM architectures: v6, v7, v8</p>
    <p>Userspace privileges are sufficient</p>
    <p>Larger number of devices</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 32</p>
  </div>
  <div class="page">
    <p>AutoLock</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 33</p>
  </div>
  <div class="page">
    <p>AutoLock Cross-core Eviction</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 34</p>
  </div>
  <div class="page">
    <p>AutoLock Cross-core Eviction</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 35</p>
  </div>
  <div class="page">
    <p>AutoLock Cross-core Eviction</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 36</p>
  </div>
  <div class="page">
    <p>AutoLock Cross-core Eviction</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 37</p>
  </div>
  <div class="page">
    <p>AutoLock Cross-core Eviction</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 38</p>
  </div>
  <div class="page">
    <p>AutoLock Cross-core Eviction</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 39</p>
  </div>
  <div class="page">
    <p>AutoLock Cross-core Eviction</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 40</p>
  </div>
  <div class="page">
    <p>AutoLock Cross-core Eviction</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 41</p>
  </div>
  <div class="page">
    <p>AutoLock Cross-core Eviction</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 42</p>
  </div>
  <div class="page">
    <p>AutoLock Cross-core Eviction</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 43</p>
  </div>
  <div class="page">
    <p>AutoLock Cross-core Eviction</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 44</p>
  </div>
  <div class="page">
    <p>AutoLock Cross-core Eviction</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 45</p>
  </div>
  <div class="page">
    <p>AutoLock Cross-core Eviction</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 46</p>
  </div>
  <div class="page">
    <p>AutoLock Cross-core Eviction</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 47</p>
  </div>
  <div class="page">
    <p>AutoLock Cross-core Eviction</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 48</p>
  </div>
  <div class="page">
    <p>AutoLock Cross-core Eviction</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 49</p>
  </div>
  <div class="page">
    <p>AutoLock Cross-core Eviction</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 50</p>
  </div>
  <div class="page">
    <p>AutoLock Cross-core Eviction</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 51</p>
  </div>
  <div class="page">
    <p>AutoLock Cross-core Eviction</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 52</p>
  </div>
  <div class="page">
    <p>AutoLock Cross-core Eviction</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 53</p>
  </div>
  <div class="page">
    <p>AutoLock Cross-core Eviction</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 54</p>
  </div>
  <div class="page">
    <p>AutoLock Cross-core Eviction</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 55</p>
  </div>
  <div class="page">
    <p>AutoLock Definition</p>
    <p>A patented and undocumented performance feature of inclusive cache levels that transparently prevents the eviction of cache lines, if they are contained in higher cache levels.</p>
    <p>Automatic + Lockdown = AutoLock</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 56</p>
  </div>
  <div class="page">
    <p>Implications of AutoLock</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 57</p>
  </div>
  <div class="page">
    <p>Implications Impact in Theory</p>
    <p>Method Task Same-core Cross-core</p>
    <p>Evict + Time Eviction 3 7 Prime + Probe Eviction 3 7 Evict + Reload Eviction 3 7 Evict + Prefetch Eviction 3 7 Flush + * Flush 3 3</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 58</p>
  </div>
  <div class="page">
    <p>Implications Impact in Practice</p>
    <p>N or</p>
    <p>m al</p>
    <p>iz ed</p>
    <p>f re</p>
    <p>qu en</p>
    <p>cy</p>
    <p>without eviction with eviction</p>
    <p>N or</p>
    <p>m al</p>
    <p>iz ed</p>
    <p>f re</p>
    <p>qu en</p>
    <p>cy</p>
    <p>without eviction with eviction</p>
    <p>Qualcomm Krait 450 ARM Cortex-A57</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 59</p>
  </div>
  <div class="page">
    <p>Implications SoC Evaluation</p>
    <p>Processor System-on-Chip (SoC) AutoLock</p>
    <p>ARM Cortex-A7 Samsung Exynos 5422 3 ARM Cortex-A15 Samsung Exynos 5422/5250 3 ARM Cortex-A53 ARM Juno r0 3 ARM Cortex-A57 ARM Juno r0 3 Qualcomm Krait 450 Snapdragon 805 7</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 60</p>
  </div>
  <div class="page">
    <p>Implications Smartphone SoCs</p>
    <p>Manufacturer SoC Family % featuring</p>
    <p>A7,-15,-53,-57 Apple A10, A9, A8, A7 0 HiSilicon Kirin 9xx, 6xx 86 Mediatek MT67xx, MT659x/8x 100 Nvidia Tegra X, K, 4 71 Qualcomm Snapdragon 8xx, 6xx, 4xx 47 Samsung Exynos 9, 8, 7, 5, 4 79 Xiaomi Surge S 100</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 61</p>
  </div>
  <div class="page">
    <p>Implications Previous Work on ARM</p>
    <p>ARMageddon Lipp et al. [LGS+16]</p>
    <p>ROP Flush + Reload Zhang et al. [ZXZ16]</p>
    <p>TruSpy Zhang et al. [ZSS+16]</p>
    <p>Device Selection  Attack Selection  Device Properties</p>
    <p>Qualcomm SoCs</p>
    <p>Userspace flush</p>
    <p>Cross-core eviction</p>
    <p>Flush + Reload</p>
    <p>cacheflush syscall</p>
    <p>No cross-core eviction</p>
    <p>ARM Cortex-A8</p>
    <p>Single-core setup</p>
    <p>No cross-core eviction</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 62</p>
  </div>
  <div class="page">
    <p>AutoLock = Countermeasure ?</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 63</p>
  </div>
  <div class="page">
    <p>Countermeasure? Not Ultimately</p>
    <p>Vulnerable SoCs</p>
    <p>ARM-compliant cores  Userspace flush instr.</p>
    <p>Same-Core Attacks</p>
    <p>ARM TrustZone  Compromised OS</p>
    <p>Remote Evictions</p>
    <p>Trigger self-evictions  Increase load and wait time</p>
    <p>Redundant Targets</p>
    <p>Attack multiple cache lines  e.g. entire AES T-tables</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 64</p>
  </div>
  <div class="page">
    <p>Countermeasure? Wait-a-minute Attack</p>
    <p>Attack by Irazoqui et al. [IIES14]</p>
    <p>Observes usage of AES T-tables  One cache line per table</p>
    <p>Simple redundant variant</p>
    <p>Observe all lines of all tables  Majority vote on derived keys</p>
    <p>Test environment</p>
    <p>ARM Cortex-A15 with AutoLock  Full Linux operating system</p>
    <p>R ec</p>
    <p>ov er</p>
    <p>ed k</p>
    <p>ey b</p>
    <p>yt es same-core [IIES14]</p>
    <p>cross-core [IIES14] majority vote</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 65</p>
  </div>
  <div class="page">
    <p>Conclusion</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 66</p>
  </div>
  <div class="page">
    <p>Conclusion Takeaways</p>
    <p>AutoLock: undocumented feature of inclusive LLCs on ARM</p>
    <p>Inhibits cross-core eviction and adversely affects attacks</p>
    <p>Predominantly implemented in Cortex-A designs by ARM</p>
    <p>Countermeasures are still necessary to protect against attacks</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 67</p>
  </div>
  <div class="page">
    <p>Questions ?</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 68</p>
  </div>
  <div class="page">
    <p>Bibliography</p>
    <p>[GMF+16] Daniel Gruss, Clmentine Maurice, Anders Fogh, Moritz Lipp, and Stefan Mangard. Prefetch side-channel attacks: Bypassing smap and kernel aslr. In Proceedings of the 2016 ACM SIGSAC Conference on Computer and Communications Security, CCS 16, pages 368379, New York, NY, USA, 2016. ACM.</p>
    <p>[GMWM16] Daniel Gruss, Clmentine Maurice, Klaus Wagner, and Stefan Mangard. Flush+flush: A fast and stealthy cache attack. In Juan Caballero, Urko Zurutuza, and Ricardo J. Rodrguez, editors, Detection of Intrusions and Malware, and Vulnerability Assessment: 13th International Conference, DIMVA 2016, San Sebastin, Spain, July 7-8, 2016, Proceedings, pages 279299, Cham, 2016. Springer International Publishing.</p>
    <p>[GSM15] Daniel Gruss, Raphael Spreitzer, and Stefan Mangard. Cache template attacks: Automating attacks on inclusive last-level caches. In 24th USENIX Security Symposium (USENIX Security 15), pages 897912, Washington, D.C., 2015. USENIX Association.</p>
    <p>[IIES14] Gorka Irazoqui, Mehmet Sinan Inci, Thomas Eisenbarth, and Berk Sunar. Wait a minute! a fast, cross-vm attack on aes. In Angelos Stavrou, Herbert Bos, and Georgios Portokalidis, editors, Research in Attacks, Intrusions and Defenses: 17th International Symposium, RAID 2014, Gothenburg, Sweden, September 17-19, 2014. Proceedings, pages 299319, Cham, 2014. Springer International Publishing.</p>
    <p>[LGS+16] Moritz Lipp, Daniel Gruss, Raphael Spreitzer, Clmentine Maurice, and Stefan Mangard. Armageddon: Cache attacks on mobile devices. In 25th USENIX Security Symposium (USENIX Security 16), pages 549564, Austin, TX, 2016. USENIX Association.</p>
    <p>[OST06] Dag Arne Osvik, Adi Shamir, and Eran Tromer. Cache attacks and countermeasures: The case of aes. In David Pointcheval, editor, Topics in Cryptology  CT-RSA 2006: The Cryptographers Track at the RSA Conference 2006, San Jose, CA, USA, February 13-17, 2005. Proceedings, pages 120, Berlin, Heidelberg, 2006. Springer Berlin Heidelberg.</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 69</p>
  </div>
  <div class="page">
    <p>Bibliography</p>
    <p>[YF14] Yuval Yarom and Katrina Falkner. Flush+reload: A high resolution, low noise, l3 cache side-channel attack. In 23rd USENIX Security Symposium (USENIX Security 14), pages 719732, San Diego, CA, 2014. USENIX Association.</p>
    <p>[ZSS+16] Ning Zhang, Kun Sun, Deborah Shands, Wenjing Lou, and Y. Thomas Hou. Truspy: Cache side-channel information leakage from the secure world on arm devices. Cryptology ePrint Archive, Report 2016/980, 2016. http://eprint.iacr.org/2016/980.</p>
    <p>[ZXZ16] Xiaokuan Zhang, Yuan Xiao, and Yinqian Zhang. Return-oriented flush-reload side channels on arm and their implications for android devices. In Proceedings of the 2016 ACM SIGSAC Conference on Computer and Communications Security, CCS 16, pages 858870, New York, NY, USA, 2016. ACM.</p>
    <p>AutoLock: Why Cache Attacks on ARM Are Harder Than You Think | Green et al. | USENIX Security 2017 | 70</p>
  </div>
</Presentation>
