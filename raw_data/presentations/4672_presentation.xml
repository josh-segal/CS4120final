<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Stream Monitoring under the Time Warping DistanceYasushi Sakurai (NTT Cyber Space Labs)</p>
    <p>Christos Faloutsos (Carnegie Mellon Univ.)</p>
    <p>Masashi Yamamuro (NTT Cyber Space Labs)</p>
  </div>
  <div class="page">
    <p>ICDE 2007 Y. Sakurai et al 2</p>
    <p>Introduction</p>
    <p>Data-stream applications  Network analysis  Sensor monitoring  Financial data analysis  Moving object tracking</p>
    <p>Goal  Monitor numerical streams  Find subsequences similar to the given query</p>
    <p>sequence  Distance measure: Dynamic Time Warping (DTW)</p>
  </div>
  <div class="page">
    <p>ICDE 2007 Y. Sakurai et al 3</p>
    <p>Introduction  DTW is computed by dynamic programming</p>
    <p>Stretch sequences along the time axis to minimize the distance  Warping path: set of grid cells in the time warping matrix</p>
    <p>X</p>
    <p>Y</p>
    <p>xN</p>
    <p>y M</p>
    <p>xi</p>
    <p>yj y1</p>
    <p>x1</p>
    <p>X</p>
    <p>Y</p>
    <p>x1 xi xN y1</p>
    <p>yj</p>
    <p>y M</p>
    <p>Time warping matrix</p>
    <p>Optimal warping path (the best alignment)</p>
  </div>
  <div class="page">
    <p>ICDE 2007 Y. Sakurai et al 4</p>
    <p>Related Work</p>
    <p>Sequence indexing, subsequence matching  Agrawal et al. (FODO 1998)  Keogh et al. (SIGMOD 2001)  Faloutsos et al. (SIGMOD 1994)  Moon et al. (SIGMOD 2002)</p>
    <p>Fast sequence matching for DTW  Yi et al. (ICDE 1998)  Keogh (VLDB 2002)  Zhu et al. (SIGMOD 2003)  Sakurai et al. (PODS 2005)</p>
  </div>
  <div class="page">
    <p>ICDE 2007 Y. Sakurai et al 5</p>
    <p>Related Work  Data stream processing for pattern discovery</p>
    <p>Clustering for data streams</p>
    <p>Guha et al. (TKDE 2003)  Monitoring multiple streams</p>
    <p>Zhu et al. (VLDB 2002)  Forecasting</p>
    <p>Papadimitriou et al. (VLDB 2003)  Detecting lag correlations</p>
    <p>Sakurai et al. (SIGMOD 2005)  DTW has been studied for finite, stored sequence sets  We address a new problem for DTW</p>
  </div>
  <div class="page">
    <p>ICDE 2007 Y. Sakurai et al 6</p>
    <p>Overview</p>
    <p>Introduction / Related work  Problem definition  Main ideas  Experimental results</p>
  </div>
  <div class="page">
    <p>ICDE 2007 Y. Sakurai et al 7</p>
    <p>Problem Definition  Subsequence matching for data streams</p>
    <p>(Fixed-length) query sequence Y=(y1 , y2 ,, ym)  Sequence (data stream) X=(x1 , x2 ,, xn)  Find all subsequences X[ts,te] such that )],:[( YttXD es</p>
  </div>
  <div class="page">
    <p>ICDE 2007 Y. Sakurai et al 8</p>
    <p>Subsequence Matching</p>
    <p>X[ts:te]</p>
    <p>xtextsx1 xn X</p>
    <p>y m</p>
    <p>Y</p>
    <p>y1</p>
    <p>Other similar subsequences</p>
    <p>Redundant, useless</p>
    <p>subsequences</p>
  </div>
  <div class="page">
    <p>ICDE 2007 Y. Sakurai et al 9</p>
    <p>Problem Definition  Subsequence matching for data streams</p>
    <p>(Fixed-length) query sequence Y  Sequence (data stream) X=(x1 , x2 ,, xn)  Find all subsequence X[ts,te] such that</p>
    <p>Multiple matches by subsequences which heavily overlap with the local minimum best match [ double harm ]  Flood the user with redundant information  Slow down the algorithm by forcing it to keep track of and report all</p>
    <p>these useless solutions</p>
    <p>Eliminate the redundant subsequences, and report only the optimal ones</p>
    <p>)],:[( YttXD es</p>
  </div>
  <div class="page">
    <p>ICDE 2007 Y. Sakurai et al 10</p>
    <p>Problem Definition</p>
    <p>Problem: Disjoint query  Given a threshold , report all X[ts:te] such that</p>
    <p>is the smallest value in the group of overlapping subsequences that satisfy the first condition</p>
    <p>Additional challenges: streaming solution  Process a new value of X efficiently  Guarantee no false dismissals  Report each match as early as possible</p>
    <p>)],:[( YttXD es</p>
    <p>)],:[( YttXD es</p>
  </div>
  <div class="page">
    <p>ICDE 2007 Y. Sakurai et al 11</p>
    <p>Overview</p>
    <p>Introduction / Related work  Problem definition  Main ideas  Experimental results</p>
  </div>
  <div class="page">
    <p>ICDE 2007 Y. Sakurai et al 12</p>
    <p>Compute the time warping matrices starting from every time-tick  Need O(n) matrices, O(nm) time per time-tick</p>
    <p>Disjoint query  Compute all the possible subsequences and then choose</p>
    <p>the optimal ones</p>
    <p>Y</p>
    <p>Xxts xte</p>
    <p>x1</p>
    <p>Why not naive?</p>
    <p>Capture the optimal subsequence</p>
    <p>starting from t = ts</p>
  </div>
  <div class="page">
    <p>ICDE 2007 Y. Sakurai et al 13</p>
    <p>Main idea (1)</p>
    <p>Star-padding  Use only a single matrix (the nave solution uses n matrices)  Prefix Y with *, that always gives zero distance  instead of Y=(y1 , y2 , , ym), compute distances</p>
    <p>with Y</p>
    <p>O(m) time and space (the nave requires O(nm))</p>
    <p>):(</p>
    <p>),,,,('</p>
    <p>y</p>
    <p>yyyyY m</p>
  </div>
  <div class="page">
    <p>ICDE 2007 Y. Sakurai et al 14</p>
    <p>X</p>
    <p>t=ts t=te</p>
    <p>Report X[ts:te] Second subsequence</p>
    <p>t=1</p>
    <p>Y</p>
    <p>SPRING</p>
    <p>Start at zero distance on</p>
    <p>every bottom row</p>
  </div>
  <div class="page">
    <p>ICDE 2007 Y. Sakurai et al 15</p>
    <p>Main idea (2)</p>
    <p>STWM (Subsequence Time Warping Matrix)  Problem of the star-padding: we lose the information</p>
    <p>about the starting time-tick of the match  After the scan, which is the optimal subsequence?</p>
    <p>Elements of STWM  Distance value of each subsequence  Starting position</p>
    <p>Combination of star-padding and STWM  Efficiently identify the optimal subsequence in a</p>
    <p>stream fashion</p>
  </div>
  <div class="page">
    <p>ICDE 2007 Y. Sakurai et al 16</p>
    <p>Main idea (3)</p>
    <p>Algorithm for disjoint queries  Designed to:</p>
    <p>Guarantee no false dismissals  Report each match as early as possible</p>
  </div>
  <div class="page">
    <p>ICDE 2007 Y. Sakurai et al 17</p>
    <p>Algorithm for disjoint queries 1. Update m elements (distance and starting position)</p>
    <p>at every time-tick</p>
    <p>(a) the captured optimal subsequence cannot be replaced</p>
    <p>by the upcoming subsequences</p>
    <p>(b) the upcoming subsequences dot not overlap with the</p>
    <p>captured optimal subsequence</p>
  </div>
  <div class="page">
    <p>ICDE 2007 Y. Sakurai et al 18</p>
    <p>Algorithm for disjoint queries distance (upper number), starting position (number in parentheses)  X=(5,12,6,10,6,5,13), Y=(11,6,9,4), = 20</p>
    <p>y4 = 4 54 (1)</p>
    <p>y3 = 9 53 (1)</p>
    <p>y2 = 6 37 (1)</p>
    <p>y1 = 11 36 (1)</p>
    <p>xt 5 12 6 10 6 5 13</p>
    <p>t 1 2 3 4 5 6 7</p>
  </div>
  <div class="page">
    <p>ICDE 2007 Y. Sakurai et al 19</p>
    <p>Algorithm for disjoint queries distance (upper number), starting position (number in parentheses)  X=(5,12,6,10,6,5,13), Y=(11,6,9,4), = 20  optimal subsequence, redundant subsequences</p>
    <p>y4 = 4 54 (1)</p>
    <p>y3 = 9 53 (1)</p>
    <p>y2 = 6 37 (1)</p>
    <p>y1 = 11 36 (1)</p>
    <p>xt 5 12 6 10 6 5 13</p>
    <p>t 1 2 3 4 5 6 7</p>
  </div>
  <div class="page">
    <p>ICDE 2007 Y. Sakurai et al 20</p>
    <p>Algorithm for disjoint queries distance (upper number), starting position (number in parentheses)  X=(5,12,6,10,6,5,13), Y=(11,6,9,4), = 20  optimal subsequence, redundant subsequences</p>
    <p>y4 = 4 54 (1)</p>
    <p>y3 = 9 53 (1)</p>
    <p>y2 = 6 37 (1)</p>
    <p>y1 = 11 36 (1)</p>
    <p>xt 5 12 6 10 6 5 13</p>
    <p>t 1 2 3 4 5 6 7</p>
  </div>
  <div class="page">
    <p>ICDE 2007 Y. Sakurai et al 21</p>
    <p>Algorithm for disjoint queries</p>
    <p>y4 = 4 54 (1)</p>
    <p>y3 = 9 53 (1)</p>
    <p>y2 = 6 37 (1)</p>
    <p>y1 = 11 36 (1)</p>
    <p>xt 5 12 6 10 6 5 13</p>
    <p>t 1 2 3 4 5 6 7</p>
    <p>distance (upper number), starting position (number in parentheses)  X=(5,12,6,10,6,5,13), Y=(11,6,9,4),  = 20  optimal subsequence, redundant subsequences</p>
  </div>
  <div class="page">
    <p>ICDE 2007 Y. Sakurai et al 22</p>
    <p>Algorithm for disjoint queries Guarantee to report the optimal subsequence</p>
    <p>(a) The captured optimal subsequence cannot be replaced</p>
    <p>(b) The upcoming subsequences do not overlap with the captured optimal subsequence</p>
    <p>y4 = 4 54 (1)</p>
    <p>y3 = 9 53 (1)</p>
    <p>y2 = 6 37 (1)</p>
    <p>y1 = 11 36 (1)</p>
    <p>xt 5 12 6 10 6 5 13</p>
    <p>t 1 2 3 4 5 6 7</p>
  </div>
  <div class="page">
    <p>ICDE 2007 Y. Sakurai et al 23</p>
    <p>Algorithm for disjoint queries Guarantee to report the optimal subsequence</p>
    <p>Finally report the optimal subsequence X[2:5] at t=7  Initialize the distance values (d2=51, d3=18, d4=88)</p>
    <p>y4 = 4 54 (1)</p>
    <p>y3 = 9 53 (1)</p>
    <p>y2 = 6 37 (1)</p>
    <p>y1 = 11 36 (1)</p>
    <p>xt 5 12 6 10 6 5 13</p>
    <p>t 1 2 3 4 5 6 7</p>
  </div>
  <div class="page">
    <p>ICDE 2007 Y. Sakurai et al 24</p>
    <p>Overview</p>
    <p>Introduction / Related work  Problem definition  Main ideas  Experimental results</p>
  </div>
  <div class="page">
    <p>ICDE 2007 Y. Sakurai et al 25</p>
    <p>Experimental Results</p>
    <p>Experiments with real and synthetic data sets  MaskedChirp, Temperature, Kursk, Sunspots</p>
    <p>Evaluation  Accuracy for pattern discovery  Computation time  (Memory space consumption)</p>
  </div>
  <div class="page">
    <p>ICDE 2007 Y. Sakurai et al 26</p>
    <p>Pattern Discovery</p>
    <p>MaskedChirp</p>
    <p>Query sequence Data stream</p>
  </div>
  <div class="page">
    <p>ICDE 2007 Y. Sakurai et al 27</p>
    <p>Pattern Discovery</p>
    <p>MaskedChirp SPRING identifies all sound parts with varying time periods</p>
    <p>Query sequence Data streamThe output time of each captured subsequence is very close to its</p>
    <p>end position</p>
  </div>
  <div class="page">
    <p>ICDE 2007 Y. Sakurai et al 28</p>
    <p>Pattern Discovery</p>
    <p>Temperature</p>
    <p>Query sequence Data stream</p>
  </div>
  <div class="page">
    <p>ICDE 2007 Y. Sakurai et al 29</p>
    <p>Pattern Discovery</p>
    <p>Temperature</p>
    <p>Query sequence Data stream</p>
    <p>SPRING finds the days when the temperature fluctuates</p>
    <p>from cool to hot</p>
  </div>
  <div class="page">
    <p>ICDE 2007 Y. Sakurai et al 30</p>
    <p>Pattern Discovery</p>
    <p>Kursk</p>
    <p>Query sequence Data stream</p>
  </div>
  <div class="page">
    <p>ICDE 2007 Y. Sakurai et al 31</p>
    <p>Pattern Discovery</p>
    <p>Kursk</p>
    <p>Query sequence Data stream</p>
    <p>SPRING is not affected by the difference in the</p>
    <p>environmental conditions</p>
  </div>
  <div class="page">
    <p>ICDE 2007 Y. Sakurai et al 32</p>
    <p>Pattern Discovery</p>
    <p>Sunspots</p>
    <p>Query sequence Data stream</p>
  </div>
  <div class="page">
    <p>ICDE 2007 Y. Sakurai et al 33</p>
    <p>Pattern Discovery</p>
    <p>Sunspots</p>
    <p>Query sequence Data stream</p>
    <p>SPRING can capture bursty periods and identify the time</p>
    <p>varying periodicity</p>
  </div>
  <div class="page">
    <p>ICDE 2007 Y. Sakurai et al 34</p>
    <p>Computation time  Wall clock time per time-tick</p>
    <p>Nave method: O(nm)  SPRING: O(m)  not depend on sequence length</p>
    <p>n</p>
  </div>
  <div class="page">
    <p>ICDE 2007 Y. Sakurai et al 35</p>
    <p>Extension to multiple streams  Motion capture data</p>
    <p>Place special markers on the joints of a human actor  Record their x-, y-, z-velocities  Use 16-dimensional sequences  Capture motions based on the similarity of rotational</p>
    <p>energy</p>
    <p>Erotation : rotational energy</p>
    <p>I : moment of inertia : angular velocity</p>
  </div>
  <div class="page">
    <p>ICDE 2007 Y. Sakurai et al 36</p>
    <p>High-speed Motion Capture</p>
  </div>
  <div class="page">
    <p>ICDE 2007 Y. Sakurai et al 37</p>
    <p>High-speed Motion Capture  Recognize all motions in a stream fashion</p>
    <p>Entertainment applications, etc</p>
    <p>Walk Swing Rotate Swing Rotate</p>
    <p>One-leg jump Jump Walk Run Walk</p>
  </div>
  <div class="page">
    <p>ICDE 2007 Y. Sakurai et al 38</p>
    <p>Conclusions</p>
    <p>Subsequence matching under the DTW distance over data streams</p>
    <p>Stored data sets  SPRING can be applied to stored sequence sets</p>
  </div>
  <div class="page">
    <p>Appendix</p>
  </div>
  <div class="page">
    <p>ICDE 2007 Y. Sakurai et al 40</p>
    <p>Mini-introduction to DTW  DTW allows sequences to be stretched along the</p>
    <p>time axis  Minimize the distance of sequences  Insert stutters into a sequence  THEN compute the (Euclidean) distance</p>
    <p>stutters:original</p>
  </div>
  <div class="page">
    <p>ICDE 2007 Y. Sakurai et al 41</p>
    <p>Mini-introduction to DTW  DTW is computed by dynamic programming</p>
    <p>Warping path: set of grid cells in the time warping matrix</p>
    <p>data sequence P of length N</p>
    <p>query sequence Q of length M</p>
    <p>pN</p>
    <p>q M</p>
    <p>pi</p>
    <p>qj q1</p>
    <p>p1</p>
    <p>P</p>
    <p>Q</p>
    <p>p1 pi pN q1</p>
    <p>qj</p>
    <p>q M</p>
    <p>p-stutters</p>
    <p>q-stutters</p>
    <p>Optimum warping path (the best alignment)</p>
  </div>
  <div class="page">
    <p>ICDE 2007 Y. Sakurai et al 42</p>
    <p>Mini-introduction to DTW</p>
    <p>)1,1(</p>
    <p>),1(</p>
    <p>)1,(</p>
    <p>min),(</p>
    <p>),(),(</p>
    <p>jif</p>
    <p>jif</p>
    <p>jif</p>
    <p>qpjif</p>
    <p>MNfQPD</p>
    <p>ji</p>
    <p>dtw</p>
    <p>q-stutter no stutter</p>
    <p>p-stutter</p>
    <p>DTW is computed by dynamic programming</p>
    <p>p1, p2, , pi,; q1, q2, , qj</p>
  </div>
  <div class="page">
    <p>ICDE 2007 Y. Sakurai et al 43</p>
    <p>Pattern Discovery</p>
    <p>Humidity</p>
    <p>Query sequence Data stream</p>
  </div>
  <div class="page">
    <p>ICDE 2007 Y. Sakurai et al 44</p>
    <p>Pattern Discovery</p>
    <p>Humidity</p>
    <p>Query sequence Data stream</p>
  </div>
  <div class="page">
    <p>ICDE 2007 Y. Sakurai et al 45</p>
    <p>Two Algorithms of SPRING</p>
    <p>SPRING-optimal</p>
    <p>= 10,000</p>
    <p>= 15,000</p>
    <p>Query sequence</p>
  </div>
  <div class="page">
    <p>ICDE 2007 Y. Sakurai et al 46</p>
    <p>Two Algorithms of SPRING</p>
    <p>SPRING-first</p>
    <p>= 10,000</p>
    <p>= 15,000</p>
    <p>Query sequence</p>
  </div>
  <div class="page">
    <p>ICDE 2007 Y. Sakurai et al 47</p>
    <p>Memory space consumption Memory space for time warping matrix (matrices)</p>
    <p>Nave method: O(nm)  SPRING: O(m)  not depend on sequence length n  SPRING (path): clearly lower than that of the nave method</p>
  </div>
</Presentation>
