<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Topic Models with Logical Constraints on Words</p>
    <p>Hayato Kobayashi, Hiromi Wakaki, Tomohiro</p>
    <p>Yamasaki, and Masaru Suzuki</p>
    <p>Corporate Research and Development Center,</p>
    <p>Toshiba Corporation, Japan</p>
  </div>
  <div class="page">
    <p>Topic modeling = Word clustering</p>
    <p>Method to extract latent topics on a corpus  Each topic is a distribution on words</p>
    <p>Corpus</p>
    <p>about</p>
    <p>Bulgaria</p>
    <p>LDA</p>
  </div>
  <div class="page">
    <p>Topic modeling = Word clustering</p>
    <p>Method to extract latent topics on a corpus  Each topic is a distribution on words</p>
    <p>Corpus</p>
    <p>about</p>
    <p>Bulgaria</p>
    <p>LDA</p>
    <p>yogurt milk</p>
    <p>food fruit</p>
    <p>bacteria fat</p>
    <p>cream</p>
  </div>
  <div class="page">
    <p>Topic modeling = Word clustering</p>
    <p>Method to extract latent topics on a corpus  Each topic is a distribution on words</p>
    <p>Corpus</p>
    <p>about</p>
    <p>Bulgaria</p>
    <p>LDA</p>
    <p>rose oil</p>
    <p>organic essential</p>
    <p>valley pure</p>
    <p>kazanlak</p>
    <p>yogurt milk</p>
    <p>food fruit</p>
    <p>bacteria fat</p>
    <p>cream</p>
  </div>
  <div class="page">
    <p>Topic modeling = Word clustering</p>
    <p>Method to extract latent topics on a corpus  Each topic is a distribution on words</p>
    <p>Corpus</p>
    <p>about</p>
    <p>Bulgaria</p>
    <p>LDA</p>
    <p>dance fire</p>
    <p>sexy ancient</p>
    <p>bikini walk exotic</p>
    <p>rose oil</p>
    <p>organic essential</p>
    <p>valley pure</p>
    <p>kazanlak</p>
    <p>yogurt milk</p>
    <p>food fruit</p>
    <p>bacteria fat</p>
    <p>cream</p>
    <p>Size of each word</p>
    <p>represents its frequency</p>
  </div>
  <div class="page">
    <p>dance fire</p>
    <p>sexy ancient</p>
    <p>bikini walk exotic</p>
    <p>Want to split</p>
    <p>into fire dance</p>
    <p>and sexy dance</p>
  </div>
  <div class="page">
    <p>Existing work [Andrzejewski+ ICML2009]</p>
    <p>Constraints on words for topic modeling  Must-Link(A,B) A and B appear in the same topic  Cannot-Link(A,B) A and B dont appear in the</p>
    <p>same topic</p>
    <p>Cannot-Link(fire, sexy) dance sexy bikini</p>
    <p>exotic</p>
    <p>dance fire</p>
    <p>ancient walk</p>
    <p>CL</p>
    <p>Want to split into fire dance</p>
    <p>and sexy dance</p>
  </div>
  <div class="page">
    <p>Problem of the existing work</p>
    <p>Constraints often dont align with users intention</p>
    <p>Cannot-Link(fire, sexy) dance sexy bikini</p>
    <p>exotic</p>
    <p>Want to split into fire dance</p>
    <p>and sexy dance</p>
    <p>blaze fire</p>
    <p>ancient forest</p>
    <p>CL</p>
    <p>You might get blaze topic</p>
    <p>instead of fire dance topic</p>
  </div>
  <div class="page">
    <p>This work</p>
    <p>Logical constraints on words for topic modeling  Conjunctions (), disjunctions (), negations ()</p>
    <p>Want to split into fire dance</p>
    <p>and sexy dance</p>
    <p>dance fire</p>
    <p>ancient walk</p>
    <p>ML dance sexy</p>
    <p>bikini exotic</p>
    <p>MLCL Cannot-Link(fire, sexy) (Must-Link(dance, fire)  Must-Link(dance, sexy))</p>
  </div>
  <div class="page">
    <p>Outline of the rest of this talk</p>
    <p>LDA [Blei+ JMLR2003]  One of topic modeling method</p>
    <p>LDA-DF [Andrzejewski+ ICML2009]  Must-Link and Cannot-Link</p>
    <p>This work  Logical expressions of Must-Links and Cannot-Links</p>
    <p>Experiment</p>
    <p>Conclusion</p>
  </div>
  <div class="page">
    <p>Latent Dirichlet Allocation (LDA) [Blei+ JMLR2003]</p>
    <p>Famous Topic modeling method</p>
    <p>(i) Assume a generative model of documents  Each topic is a distribution on words</p>
    <p>Each document is a distribution on topics  Taken from Dirichlet distributions to generate discrete distributions</p>
    <p>(ii) Infer parameters for the two distributions inverting the generative model</p>
  </div>
  <div class="page">
    <p>Generative process of documents in LDA</p>
    <p>Each topic is a distribution on words</p>
    <p>Each document is a distribution on topics Topic 1</p>
    <p>Topic 2</p>
    <p>Document 1</p>
    <p>Document 2</p>
  </div>
  <div class="page">
    <p>Generative process of documents in LDA</p>
    <p>Each topic is a distribution on words</p>
    <p>Each document is a distribution on topics</p>
    <p>rose oil</p>
    <p>organic essential</p>
    <p>yogurt milk</p>
    <p>food fruit</p>
    <p>Topic 1</p>
    <p>Topic 2</p>
    <p>Document 1</p>
    <p>Document 2</p>
  </div>
  <div class="page">
    <p>Generative process of documents in LDA</p>
    <p>Each topic is a distribution on words</p>
    <p>Each document is a distribution on topics</p>
    <p>rose oil</p>
    <p>organic essential</p>
    <p>yogurt milk</p>
    <p>food fruit</p>
    <p>yogurt milk yogurt food</p>
    <p>rose oil fruit food yogurt</p>
    <p>milk bacteria fat drink</p>
    <p>cream yogurt milk rose</p>
    <p>Topic 1</p>
    <p>Topic 2</p>
    <p>Document 1</p>
    <p>Document 2</p>
  </div>
  <div class="page">
    <p>Generative process of documents in LDA</p>
    <p>Each topic is a distribution on words</p>
    <p>Each document is a distribution on topics</p>
    <p>rose oil</p>
    <p>organic essential</p>
    <p>yogurt milk</p>
    <p>food fruit</p>
    <p>yogurt milk yogurt food</p>
    <p>rose oil fruit food yogurt</p>
    <p>milk bacteria fat drink</p>
    <p>cream yogurt milk rose</p>
    <p>rose oil yogurt rose valley</p>
    <p>essential milk pure</p>
    <p>kazanlak quality rose food</p>
    <p>oil organic yogurt milk</p>
    <p>Topic 1</p>
    <p>Topic 2</p>
    <p>Document 1</p>
    <p>Document 2</p>
  </div>
  <div class="page">
    <p>Parameter inference in LDA</p>
    <p>Infer word and topic distributions from a corpus inverting the generative process</p>
    <p>yogurt milk yogurt food</p>
    <p>rose oil fruit food yogurt</p>
    <p>milk bacteria fat drink</p>
    <p>cream yogurt milk rose</p>
    <p>rose oil yogurt rose valley</p>
    <p>essential milk pure</p>
    <p>kazanlak quality rose food</p>
    <p>oil organic yogurt milk</p>
    <p>Document 1</p>
    <p>Document 2</p>
    <p>Topic 1</p>
    <p>Topic 2</p>
    <p>?</p>
    <p>?</p>
    <p>?</p>
  </div>
  <div class="page">
    <p>LDA-DF [Andrzejewski+ ICML2009]</p>
    <p>Semi-supervised extension of LDA  Only conjunction of Must-Links and Cannot-Links</p>
    <p>Must-Link(A,B) A and B appear in the same topic</p>
    <p>Cannot-Link(A,B) A and B dont appear in the same topic</p>
    <p>Extending the generative process  Each topic is a constrained distribution on words</p>
    <p>Taken from a Dirichlet tree distribution, which is a generalization of a Dirichlet distribution</p>
    <p>Each document is a distribution on topics  Taken from a Dirichlet distribution</p>
  </div>
  <div class="page">
    <p>Generative process of LDA-DF</p>
    <p>Always generates a distribution, where yogurt and rose do not appear in the same topic.</p>
    <p>rose oil</p>
    <p>organic essential</p>
    <p>yogurt milk</p>
    <p>food fruit</p>
    <p>yogurt milk yogurt food</p>
    <p>rose oil fruit food yogurt</p>
    <p>milk bacteria fat drink</p>
    <p>cream yogurt milk rose</p>
    <p>rose oil yogurt rose valley</p>
    <p>essential milk pure</p>
    <p>kazanlak quality rose food</p>
    <p>oil organic yogurt milk</p>
    <p>Topic 1</p>
    <p>Topic 2</p>
    <p>Document 1</p>
    <p>Document 2</p>
    <p>CL</p>
  </div>
  <div class="page">
    <p>Algorithm to generate distributions in LDA-DF</p>
  </div>
  <div class="page">
    <p>Algorithm to generate distributions in LDA-DF</p>
    <p>Cannot-Link(A,B)Cannot-Link(E,G) Must-Link(B,E)Must-Link(C,D)</p>
    <p>ML</p>
    <p>CL</p>
    <p>ML</p>
    <p>CL</p>
    <p>A B</p>
    <p>C D</p>
    <p>E</p>
    <p>F G</p>
    <p>Words  Nodes</p>
    <p>Links  Edges</p>
  </div>
  <div class="page">
    <p>Algorithm to generate distributions in LDA-DF</p>
    <p>CL</p>
    <p>CL</p>
    <p>A</p>
    <p>BE</p>
    <p>F</p>
    <p>CD</p>
    <p>G</p>
    <p>ML</p>
    <p>CL</p>
    <p>ML</p>
    <p>CL</p>
    <p>A B</p>
    <p>C D</p>
    <p>E</p>
    <p>F G</p>
  </div>
  <div class="page">
    <p>Algorithm to generate distributions in LDA-DF</p>
    <p>CL</p>
    <p>CL</p>
    <p>A</p>
    <p>BE</p>
    <p>F</p>
    <p>CD</p>
    <p>G</p>
    <p>Extract</p>
    <p>MIS</p>
    <p>BEFCD</p>
    <p>AFCD G</p>
  </div>
  <div class="page">
    <p>Algorithm to generate distributions in LDA-DF</p>
    <p>Zero the frequencies of words not in the MIS</p>
    <p>A B C D E F G</p>
    <p>A B C D E F G</p>
    <p>CL CLML</p>
    <p>Zero</p>
    <p>frequency</p>
    <p>Same</p>
    <p>frequency</p>
    <p>Equal</p>
    <p>frequency</p>
    <p>BEFCD</p>
    <p>AFCD G</p>
  </div>
  <div class="page">
    <p>This work</p>
    <p>Algorithm to generate logically constrained distributions on LDA-DF</p>
    <p>We can not apply the existing algorithm</p>
    <p>(Cannot-Link(A,B)</p>
    <p>Must-Link(A,C)) Cannot-Link(B,C)</p>
    <p>Words  Nodes</p>
    <p>Links  Edges</p>
    <p>This constraint cannot be</p>
    <p>mapped to a graph</p>
  </div>
  <div class="page">
    <p>Negations</p>
    <p>Delete negations () in a preprocessing stage  Weak negation: Must-Link(A,B) = no constraint</p>
    <p>(A and B need not appear in the same topic)</p>
    <p>Strong negation: Must-Link(A,B) = Cannot-Link(A,B) (A and B must not appear in the same topic)</p>
    <p>(Cannot-Link(A,B)</p>
    <p>Must-Link(A,C)) Cannot-Link(B,C)</p>
    <p>(Must-Link(A,B)</p>
    <p>Must-Link(A,C)) Cannot-Link(B,C)</p>
    <p>Focus only on conjunctions and disjunctions</p>
  </div>
  <div class="page">
    <p>Key observation for logical expressions</p>
    <p>Any constrained distribution is represented by a conjunctive expression by two primitives</p>
    <p>EqualPrim(A, B): makes p(A)p(B)  ZeroPrim(A): makes p(A)0</p>
    <p>A B C D E F G</p>
    <p>CL CLML</p>
    <p>Zero</p>
    <p>frequency</p>
    <p>Same</p>
    <p>frequency</p>
    <p>Equal</p>
    <p>frequency</p>
    <p>EqualPrim(B, E)  EqualPrim(C, D)  ZeroPrim(A)  ZeroPrim(G)</p>
  </div>
  <div class="page">
    <p>Substitution of links with primitives</p>
    <p>Must-Link(A,B) = EqualPrim(A,B)</p>
    <p>Cannot-Links(A,B) = ZeroPrim(A)ZeroPrim(B)</p>
    <p>A B C</p>
    <p>A B C  A B C</p>
    <p>These two distributions</p>
    <p>satisfy Cannot-Link(A,B)</p>
  </div>
  <div class="page">
    <p>Proposed algorithm for logical expressions</p>
  </div>
  <div class="page">
    <p>Proposed algorithm for logical expressions</p>
    <p>primitives</p>
    <p>(Must-Link(A,B)Must-Link(A,C)) Cannot-Link(B,C)</p>
    <p>A B C  A B C</p>
    <p>A B C  A B C  CL CL</p>
    <p>ML ML</p>
    <p>EqualPrim(A,B) EqualPrim(A,C)</p>
    <p>ZeroPrim(B) ZeroPrim(C)</p>
    <p>(  )</p>
    <p>(</p>
  </div>
  <div class="page">
    <p>Proposed algorithm for logical expressions</p>
    <p>DNF = Disjunction of conjunctions of primitives</p>
    <p>A B C  A B C</p>
    <p>A B C  A B C</p>
    <p>CL CL</p>
    <p>ML ML</p>
    <p>(  )</p>
    <p>(  )</p>
    <p>(  )</p>
    <p>(  )</p>
    <p>DNF</p>
    <p>(  )</p>
    <p>(</p>
  </div>
  <div class="page">
    <p>Proposed algorithm for logical expressions</p>
    <p>A B C D E F G A B C D E F G</p>
    <p>A B C D E F G</p>
    <p>ML CL</p>
    <p>A B C D E F G</p>
    <p>A B C  A B C</p>
    <p>Combine each conjunction of primitives</p>
    <p>(  )</p>
    <p>(  )</p>
    <p>(  )</p>
    <p>(  )</p>
  </div>
  <div class="page">
    <p>Correctness of our method</p>
    <p>[Theorem] Our method and the existing method are asymptotically equivalent w.r.t. conjunctive expressions of links</p>
    <p>A</p>
    <p>B C</p>
    <p>CL CL</p>
    <p>CL(A,B)  CL(A,C)</p>
    <p>A B C D E F GA B C D E F G</p>
    <p>A B C D  A B C D</p>
    <p>A B C D  A B C D</p>
    <p>Same distributions</p>
    <p>GraphPrimitives Distributions by primitives</p>
    <p>are the same as</p>
    <p>distributions by a graph</p>
  </div>
  <div class="page">
    <p>Customization of new links</p>
    <p>Isolate-Link (ISL)  X1,,Xn do not appear (nearly)</p>
    <p>(Remove unnecessary words and stop words</p>
    <p>Imply-Link (IL)  B appears if A appears in a topic (AB)</p>
    <p>(Use when B has multiple meanings)</p>
    <p>Extended Imply-Link (XIL)  Y appears if X1,,Xn appear in a topic (X1,,XnY)</p>
    <p>)ZeroPrim(),EqualPrim( ),IL( ABABA</p>
    <p>)ZeroPrim(</p>
    <p>),EqualPrim( ),,...,XIL(</p>
    <p>n</p>
    <p>i</p>
    <p>n</p>
    <p>i</p>
    <p>in</p>
    <p>X</p>
    <p>YXYXX</p>
    <p>)ZeroPrim( ),...,ISL( n</p>
  </div>
  <div class="page">
    <p>Interactive topic analysis</p>
    <p>Movie review corpus (1000 reviews) [Pang&amp;Lee ACL2004]  No constraints</p>
    <p>Topic High frequency words</p>
    <p>? have give night film turn performance year mother take out</p>
    <p>? not life have own first only family tell yet moment even</p>
    <p>? movie have nt get good not see know just other time make</p>
    <p>? have black scene tom death die joe ryan man final private</p>
    <p>? film have nt not make out well see just very watch even</p>
    <p>? have film original new never more evil nt time power</p>
    <p>All topics are unclear</p>
  </div>
  <div class="page">
    <p>Interactive topic analysis</p>
    <p>Movie review corpus (1000 reviews)  Isolate-Link(have, film, movie, not, nt)</p>
    <p>Remove specified words as well as related unnecessary words</p>
    <p>Star Wars and Star Trek are merged,</p>
    <p>although most topics are clear</p>
    <p>Topic High frequency words</p>
    <p>(Isolated) have film movie not good make nt character see more get</p>
    <p>? star war trek planet effect special lucas jedi science</p>
    <p>Comedy comedy funny laugh school hilarious evil power bulworth</p>
    <p>Disney disney voice mulan animated song feature tarzan animation</p>
    <p>Family life love family mother woman father child relationship</p>
    <p>Thriller truman murder killer death thriller carrey final detective</p>
  </div>
  <div class="page">
    <p>Interactive topic analysis</p>
    <p>Movie review corpus (1000 reviews)  Isolate-Link(have, film, movie, not, nt)</p>
    <p>Cannot-Link(jedi, trek)</p>
    <p>Topic High frequency words</p>
    <p>(Isolated) have film movie not make good nt character see more get</p>
    <p>Star Wars star war lucas effect jedi special matrix menace computer</p>
    <p>Comedy funny comedy laugh get hilarious high joke humor bob smith</p>
    <p>Disney disney truman voice toy show animation animated tarzan</p>
    <p>Family family father mother boy child son parent wife performance</p>
    <p>Thriller killer murder case lawyer man david prison performance</p>
    <p>Star Trek disappears,</p>
    <p>altough Star Wars is obtained</p>
    <p>Dared to select jedi since</p>
    <p>star and war are too common</p>
  </div>
  <div class="page">
    <p>Interactive topic analysis</p>
    <p>Movie review corpus (1000 reviews)  Isolate-Link(have, film, movie, not, nt)</p>
    <p>Cannot-Link(jedi, trek) (Must-Link(star, jedi)Must-Link(star, trek))</p>
    <p>Topic High frequency words</p>
    <p>(Isolated) have film movie not make good nt character see more get</p>
    <p>Star Wars star war toy jedi menace phantom lucas burton planet</p>
    <p>Star Trek alien effect star science special trek action computer</p>
    <p>Comedy comedy funny laugh hilarious joke get ben john humor fun</p>
    <p>Disney disney voice animated mulan animation family tarzan shrek</p>
    <p>Family life love family man story child woman young mother</p>
    <p>Thriller scream horror flynt murder killer lawyer death sequel case</p>
    <p>We obtained Star Wars</p>
    <p>and Star Trek appropriately</p>
  </div>
  <div class="page">
    <p>Conclusion</p>
    <p>Simple algorithm for logical constraints on words for topic modeling</p>
    <p>Must-Link(A,B) A and B appear in the same topic</p>
    <p>Cannot-Link(A,B) A and B do not appear in the same topic</p>
    <p>Theorem for the correctness of the algorithm</p>
    <p>Customization of new links  Isolate-Link(X1, , Xn): X1, , Xn disappear</p>
    <p>Imply-Link(A, B): B appears if A appears in a topic</p>
    <p>Future Work  Comparative experiments on real corpora</p>
  </div>
  <div class="page">
    <p>Thank you for your attention</p>
  </div>
  <div class="page">
    <p>Appendix: Visualization of Priors</p>
    <p>ML = Must-Link, CL = Cannot-Link, IL = Imply-Link</p>
  </div>
  <div class="page">
    <p>Appendix: Visualization of Priors</p>
    <p>ML = Must-Link, CL = Cannot-Link, IL = Imply-Link</p>
  </div>
  <div class="page">
    <p>Appendix: Visualization of Priors</p>
    <p>ML = Must-Link, CL = Cannot-Link, IL = Imply-Link</p>
  </div>
</Presentation>
