<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Breaking Secure Pairing of Bluetooth Low Energy Using Downgrade Attacks</p>
    <p>Yue Zhang, Jian Weng, Rajib Dey , Yier Jin, Zhiqiang Lin, and Xinwen Fu</p>
    <p>Track 1: Wireless Security</p>
  </div>
  <div class="page">
    <p>Bluetooth Low Energy (BLE) and IoT</p>
    <p>Low Cost Large Coverage</p>
    <p>Client Server</p>
    <p>Client Server</p>
    <p>Internet</p>
    <p>IoT devices</p>
    <p>Attribute Protocol (ATT) Client/Server mode</p>
    <p>Bluetooth Low Energy</p>
  </div>
  <div class="page">
    <p>Bluetooth Low Energy (BLE) and IoT</p>
    <p>Low Cost Large Coverage</p>
    <p>Client Server</p>
    <p>Client Server</p>
    <p>Internet</p>
    <p>IoT devices</p>
    <p>Attribute Protocol (ATT) Client/Server mode</p>
    <p>Bluetooth Low Energy</p>
    <p>TLS/SSL</p>
    <p>Pairing</p>
  </div>
  <div class="page">
    <p>Bluetooth Low Energy (BLE) and IoT</p>
    <p>Low Cost Large Coverage</p>
    <p>Client Server</p>
    <p>Client Server IoT devices</p>
    <p>Attribute Protocol (ATT) Client/Server mode</p>
    <p>Bluetooth Low Energy</p>
    <p>TLS/SSL (Mutual</p>
    <p>Authentication)</p>
    <p>Pairing</p>
  </div>
  <div class="page">
    <p>General Workflow of BLE Pairing</p>
    <p>Device OS App 1.Start pairing</p>
  </div>
  <div class="page">
    <p>General Workflow of BLE Pairing</p>
    <p>Device OS App</p>
  </div>
  <div class="page">
    <p>General Workflow of BLE Pairing</p>
    <p>Device OS App</p>
    <p>LTKLTK Pairing method 1</p>
    <p>Pairing method: Just Works, Passkey Entry Numeric Comparison, Out of Band</p>
  </div>
  <div class="page">
    <p>General Workflow of BLE Pairing</p>
    <p>Device OS App</p>
    <p>LTKLTK Pairing method 1</p>
    <p>Pairing method: Just Works, Passkey Entry Numeric Comparison, Out of Band</p>
  </div>
  <div class="page">
    <p>General Workflow of BLE Pairing</p>
    <p>Device OS App</p>
    <p>LTKLTK Pairing method 1</p>
    <p>Pairing method: Just Works, Passkey Entry Numeric Comparison, Out of Band</p>
  </div>
  <div class="page">
    <p>Security Levels of BLE Pairing</p>
    <p>Security Levels:</p>
    <p>None (Plaintext)</p>
    <p>Encrypted (Just Works)</p>
    <p>Authenticated (Passkey Entry or Numeric Comparison)</p>
    <p>Secure Connections Only (SCO) mode (Enforced Passkey Entry or Numeric Comparison)</p>
  </div>
  <div class="page">
    <p>Security Levels of BLE Pairing</p>
    <p>Security Levels:</p>
    <p>None (Plaintext)</p>
    <p>Encrypted (Just Works)</p>
    <p>Authenticated (Passkey Entry or Numeric Comparison)</p>
    <p>Secure Connections Only (SCO) mode (Enforced Passkey Entry or Numeric Comparison)</p>
  </div>
  <div class="page">
    <p>Our Observation</p>
    <p>Device OS App</p>
    <p>Just Works</p>
  </div>
  <div class="page">
    <p>Our Observation</p>
    <p>Device OS App</p>
    <p>Just Works</p>
  </div>
  <div class="page">
    <p>Our Observation</p>
    <p>Device OS App</p>
    <p>Just Works</p>
  </div>
  <div class="page">
    <p>Our Observation</p>
    <p>Device OS App</p>
    <p>Just Works</p>
  </div>
  <div class="page">
    <p>Required Four Capabilities at Initiator</p>
    <p>Device OS App</p>
  </div>
  <div class="page">
    <p>Required Four Capabilities at Initiator - Initiation Stage</p>
    <p>Device OS App</p>
  </div>
  <div class="page">
    <p>Required Four Capabilities at Initiator  Status management</p>
    <p>Device OS App</p>
    <p>LTKLTK Passkey Entry Passkey Entry</p>
    <p>Capability (2) : Enforce the secure pairing method and notify the app</p>
    <p>Capability (1) : Specify a secure pairing method</p>
  </div>
  <div class="page">
    <p>Required Four Capabilities at Initiator  Errors Handling</p>
    <p>Device OS App</p>
    <p>LTKLTK Passkey Entry Passkey Entry</p>
    <p>Capability (2) : Enforce the secure pairing method and notify the app</p>
    <p>Capability (1) : Specify a secure pairing method</p>
    <p>Capability (3) : Allow app handle errors</p>
  </div>
  <div class="page">
    <p>Required Four Capabilities at Initiator  Bond Management</p>
    <p>Device OS App</p>
    <p>LTKLTK Passkey Entry Passkey Entry</p>
    <p>Capability (2) : Enforce the secure pairing method and notify the app</p>
    <p>LTKLTK Capability (4) : Remove the broken LTK so as to start a new secure pairing process</p>
    <p>Capability (1) : Specify a secure pairing method</p>
    <p>Capability (3) : Allow app handle errors</p>
  </div>
  <div class="page">
    <p>No SCO mode at Initiator is Cause of Downgrade Attacks</p>
    <p>Device OS App</p>
    <p>LTKLTK Passkey Entry Passkey Entry</p>
    <p>Capability (2) : Enforce the secure pairing method and notify the app</p>
    <p>LTKLTK Capability (4) : Remove the broken LTK so as to start a new secure pairing process</p>
    <p>Capability (1) : Specify a secure pairing method</p>
    <p>Capability (3) : Allow app handle errors</p>
  </div>
  <div class="page">
    <p>No SCO mode at Initiator is Cause of Downgrade Attacks</p>
    <p>OS handles pairing events in a compatible way without enforcing secure pairing</p>
    <p>Device OS App</p>
    <p>LTKLTK Passkey Entry Passkey Entry</p>
    <p>LTKLTK</p>
    <p>Capability (2) : Enforce the secure pairing method and notify the app</p>
    <p>Capability (4) : Remove the broken LTK so as to start a new secure pairing process</p>
    <p>Capability (1) : Specify a secure pairing method</p>
    <p>Capability (3) : Allow app handle errors</p>
  </div>
  <div class="page">
    <p>No SCO mode at Initiator is Cause of Downgrade Attacks</p>
    <p>OS handles pairing events in a compatible way without enforcing secure pairing</p>
    <p>Device OS App</p>
    <p>LTKLTK Passkey Entry Passkey Entry</p>
    <p>LTKLTK</p>
    <p>Flaw 1</p>
    <p>Flaw 2</p>
    <p>Flaw 3</p>
    <p>Flaw 4 5/13</p>
    <p>Capability (2) : Enforce the secure pairing method and notify the app</p>
    <p>Capability (4) : Remove the broken LTK so as to start a new secure pairing process</p>
    <p>Capability (1) : Specify a secure pairing method</p>
    <p>Capability (3) : Allow app handle errors</p>
  </div>
  <div class="page">
    <p>No SCO mode at Initiator is Cause of Downgrade Attacks</p>
    <p>OS handle pairing events in a compatible way without enforcing secure pairing</p>
    <p>Device OS App</p>
    <p>LTKLTK Passkey Entry Passkey Entry</p>
    <p>LTKLTK</p>
    <p>Flaw 1</p>
    <p>Flaw 2</p>
    <p>Flaw 3</p>
    <p>Flaw 4 5/13</p>
    <p>Capability (2) : Enforce the secure pairing method and notify the app</p>
    <p>Capability (4) : Remove the broken LTK so as to start a new secure pairing process</p>
    <p>Capability (1) : Specify a secure pairing method</p>
    <p>Capability (3) : Allow app handle errors</p>
  </div>
  <div class="page">
    <p>Threat model</p>
    <p>Device Mobile/OS App</p>
    <p>Paired with a secure pairing method (Passkey Entry/Numeric Comparison)</p>
  </div>
  <div class="page">
    <p>Downgrade Attacks</p>
    <p>Device Mobile/OS App</p>
    <p>Paired with a secure pairing method (Passkey Entry/Numeric Comparison)</p>
    <p>Fake Device</p>
    <p>against the mobile</p>
  </div>
  <div class="page">
    <p>Downgrade Attacks</p>
    <p>Device Mobile/OS AppFake Device</p>
    <p>against the mobile</p>
    <p>Fake Mobile</p>
    <p>to create a Fake mobile</p>
    <p>Paired with a secure pairing method (Passkey Entry/Numeric Comparison)</p>
  </div>
  <div class="page">
    <p>Downgrade Attacks</p>
    <p>Device Mobile/OS AppFake Device</p>
    <p>against the mobile</p>
    <p>Fake Mobile</p>
    <p>to create a Fake mobile3. deploy attacks</p>
    <p>against the device</p>
    <p>Paired with a secure pairing method (Passkey Entry/Numeric Comparison)</p>
  </div>
  <div class="page">
    <p>Downgrade Attacks</p>
    <p>Device Mobile/OS AppFake Device</p>
    <p>against the mobile</p>
    <p>Fake Mobile</p>
    <p>to create a Fake mobile3. deploy attacks</p>
    <p>against the device</p>
    <p>Downgraded communication (Just Works, Plaintext)</p>
    <p>Paired with a secure pairing method (Passkey Entry/Numeric Comparison)</p>
  </div>
  <div class="page">
    <p>Downgrade Attacks</p>
    <p>Attacks against Initiators Attacks against Devices</p>
    <p>Fake data injection Passive eavesdropping</p>
    <p>Sensitive data stealing Whitelist bypassing</p>
    <p>IRK stealing Data manipulation</p>
    <p>DoS attack Man-in-the-Middle</p>
  </div>
  <div class="page">
    <p>Enabling the SCO mode</p>
    <p>Device OS App</p>
    <p>LTKLTK Passkey Entry Passkey Entry</p>
    <p>LTKLTK</p>
    <p>Flaw 1</p>
    <p>Flaw 2</p>
    <p>Flaw 3</p>
    <p>Flaw 4 8/13</p>
    <p>Capability (2) : Enforce the secure pairing method and notify the app</p>
    <p>Capability (4) : Remove the broken LTK so as to start a new secure pairing process</p>
    <p>Capability (1) : Specify a secure pairing method</p>
    <p>Capability (3) : Allow app handle errors</p>
  </div>
  <div class="page">
    <p>Enabling the SCO mode</p>
    <p>Device OS App</p>
    <p>LTKLTK Passkey Entry</p>
    <p>LTKLTK</p>
    <p>Flaw 1</p>
    <p>Flaw 2</p>
    <p>Flaw 3</p>
    <p>Flaw 4</p>
    <p>Passkey Entry</p>
    <p>Capability (2) : Enforce the secure pairing method and notify the app</p>
    <p>Capability (4) : Remove the broken LTK so as to start a new secure pairing process</p>
    <p>Capability (1) : Specify a secure pairing method</p>
    <p>Capability (3) : Allow app handle errors</p>
  </div>
  <div class="page">
    <p>Enabling the SCO mode</p>
    <p>Device OS App</p>
    <p>LTKLTK Passkey Entry</p>
    <p>LTKLTK</p>
    <p>Passkey Entry</p>
    <p>Capability (2) : Enforce the secure pairing method and notify the app</p>
    <p>Capability (4) : Remove the broken LTK so as to start a new secure pairing process</p>
    <p>Capability (1) : Specify a secure pairing method</p>
    <p>Capability (3) : Allow app handle errors</p>
  </div>
  <div class="page">
    <p>Enabling the SCO mode</p>
    <p>Device OS App</p>
    <p>LTKLTK Passkey Entry</p>
    <p>LTKLTK</p>
    <p>Passkey Entry</p>
    <p>Capability (2) : Enforce the secure pairing method and notify the app</p>
    <p>Capability (4) : Remove the broken LTK so as to start a new secure pairing process</p>
    <p>Capability (1) : Specify a secure pairing method</p>
    <p>Capability (3) : Allow app handle errors</p>
  </div>
  <div class="page">
    <p>Attacks against Initiator</p>
    <p>Flaws across OSes Tested Android mobiles</p>
  </div>
  <div class="page">
    <p>Attacks beyond Initiator</p>
    <p>The Tested BLE devices MITM attack against BLE keyboards</p>
  </div>
  <div class="page">
    <p>Attacks beyond Initiator (contd)</p>
    <p>Maximal attack distance Success rate vs. advertising frequency</p>
    <p>C D</p>
    <p>F</p>
  </div>
  <div class="page">
    <p>Countermeasures</p>
    <p>Android 8.0</p>
  </div>
  <div class="page">
    <p>Summary</p>
    <p>Downgrade Attacks</p>
    <p>No mutual authentication: SCO mode is not enforced for the pairing initiator, e.g., a mobile</p>
    <p>Enabling SCO: Four capabilities is required at initiator;  Mutual authentication: SCO mode must be mutually</p>
    <p>enforced so as to achieve the strongest security</p>
    <p>Impact of Downgrade Attacks</p>
    <p>Initiators: Android, iOS, macOS, Windows, Linux are subject to our attacks</p>
    <p>Devices: We analysed 18 BLE devices; none of them are secure;</p>
  </div>
  <div class="page">
    <p>Breaking Secure Pairing of Bluetooth Low Energy Using Downgrade Attacks</p>
    <p>Yue Zhang zyueinfosec@gmail.com</p>
    <p>Joint work w/ Jian Weng, Rajib Dey , Yier Jin, Zhiqiang Lin, and Xinwen Fu</p>
    <p>THANK YOU !</p>
  </div>
</Presentation>
