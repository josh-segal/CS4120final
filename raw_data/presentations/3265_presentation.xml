<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Boxed Out: Blocking Cellular Interconnect</p>
    <p>Bypass Fraud at the Network Edge</p>
    <p>Brad Reaves*, Ethan Shernan**, Adam Bates*, Henry Carter**, Patrick Traynor*</p>
    <p>*Florida Institute for Cyber Security University of Florida</p>
    <p>**Georgia Institute of Technology</p>
  </div>
  <div class="page">
    <p>There is a black market for long-distance and international call termination</p>
    <p>Some companies provide gray routes that deliver calls without paying required tariffs or using regulated interconnects between carriers</p>
    <p>How do you connect to a carrier without them knowing?</p>
    <p>Are you happy with your long distance carrier?</p>
  </div>
  <div class="page">
    <p>The point of this setup is to deliver a call into carrier B without paying for a real interconnection with that</p>
    <p>carrier.</p>
    <p>Carriers use the term interconnect bypass fraud Well use the term simbox fraud for our talk</p>
    <p>PSTN Network A Internet</p>
    <p>International Border</p>
    <p>GSMVoIP Simbox</p>
    <p>PSTN Network B</p>
    <p>Legitimate Local Call</p>
    <p>Enter: Simbox Fraud</p>
  </div>
  <div class="page">
    <p>Cellular networks are necessarily provisioned under an assumptions of average call volume/cell</p>
    <p>The cellular network is fundamentally incapable of supporting the load of an illicit, unlicensed telecommunications provider</p>
    <p>Not to mention:</p>
    <p>Call quality is terrible</p>
    <p>People near the simbox operation have trouble placing calls</p>
    <p>It costs carriers $2 Billion annually</p>
    <p>This is a real problem</p>
  </div>
  <div class="page">
    <p>In this work, we present the Ammit system</p>
    <p>Key Insight: Simboxed call audio will sound different than legitimate call audio</p>
    <p>Ammit detects individual calls in real time at the tower servicing the simbox</p>
    <p>Ammit can isolate individual calls and SIM cards after just 20 calls</p>
    <p>Ammit</p>
  </div>
  <div class="page">
    <p>Why Ammit Works Over-the-Air</p>
    <p>Degrades</p>
    <p>VoIP Degrades</p>
    <p>Source Network</p>
    <p>Degrades</p>
    <p>PSTN Network A Internet</p>
    <p>International Border</p>
    <p>GSMVoIP Simbox</p>
    <p>PSTN Network B</p>
    <p>Legitimate Local Call</p>
  </div>
  <div class="page">
    <p>Cellular voice sees typical loss rates of several percent</p>
    <p>How are we supposed to tell legitimate losses from losses due to simboxing?</p>
    <p>Have the tower keep track of lost frames and ignore them when analyzing the audio!</p>
    <p>Dealing with Air Loss</p>
  </div>
  <div class="page">
    <p>Because VoIP is entirely digital, audio only degrades from lost (or really late) packets</p>
    <p>When losses occur, a VoIP client can either:</p>
    <p>Audio degradations in VoIP</p>
  </div>
  <div class="page">
    <p>We can compute the short-term energy of audio and look for sudden drops and rises again</p>
    <p>Detecting Unconcealed Losses</p>
    <p>Time (ms)</p>
    <p>S ho</p>
    <p>rt tim</p>
    <p>e en</p>
    <p>er gy</p>
    <p>Packet Loss Detected Loss</p>
    <p>True Positive</p>
    <p>Undetectable Loss</p>
  </div>
  <div class="page">
    <p>We looked at the GSM-FR packet loss concealment algorithm</p>
    <p>GSM-FR conceals losses by repeating and attenuating the last good 20 millisecond frame.</p>
    <p>Cepstral analysis (used for echo detection) can detect this</p>
    <p>Detecting concealed losses</p>
  </div>
  <div class="page">
    <p>GSM-FR Loss</p>
    <p>0.02</p>
    <p>Time (ms)</p>
    <p>A ud</p>
    <p>io A</p>
    <p>m pl</p>
    <p>itu de</p>
    <p>0.2</p>
    <p>Quefrency (ms)</p>
    <p>C ep</p>
    <p>st ru</p>
    <p>m M</p>
    <p>ag ni</p>
    <p>tu de</p>
    <p>Original Signal Repeated, AttenuatedSignal Repeated, Attenuated</p>
    <p>Signal</p>
  </div>
  <div class="page">
    <p>We simulated sets of 20 calls from 99 speakers to test effects of detecting multiple calls from a single SIM</p>
    <p>Simulation Setup</p>
    <p>TIMIT Audio</p>
    <p>GSM PLC Detector</p>
    <p>Silence Insertion Detector Simbox</p>
    <p>Decision</p>
    <p>GSM Frame Errors</p>
    <p>Ammit Simbox Detector</p>
    <p>Transit Encode</p>
    <p>Channel Loss</p>
    <p>Transit Decode</p>
    <p>GSM Air Simulator</p>
    <p>Encode Audio</p>
    <p>Audio Audio</p>
    <p>Audio Packetize</p>
    <p>Internet Loss</p>
    <p>Silence/PLC</p>
    <p>VoIP Simulator</p>
    <p>Encode Audio</p>
    <p>We tested Ammit on 462 individual simulated calls to systematically measure effect of loss rate and codec</p>
  </div>
  <div class="page">
    <p>Results: Individual Simulated Calls</p>
    <p>% C</p>
    <p>al ls</p>
    <p>D et</p>
    <p>ec te</p>
    <p>d</p>
    <p>% Loss Rate</p>
    <p>GSMFR GSMFR PLC G.711 Legitimate Calls (FP)</p>
  </div>
  <div class="page">
    <p>Results: Detecting Simulated SIMs</p>
    <p>% S</p>
    <p>IM s</p>
    <p>D et</p>
    <p>ec te</p>
    <p>d</p>
    <p>% Loss Rate</p>
    <p>G.711 GSMFR GSMFR PLC</p>
  </div>
  <div class="page">
    <p>100 simboxed and normal calls</p>
    <p>87% of simboxed calls detected  no false positives</p>
    <p>Results: Real Simbox Calls</p>
  </div>
  <div class="page">
    <p>Ammit hardware and software no less accessible to attackers than network core (e.g. billing systems)</p>
    <p>Ammit analyzes all call audio</p>
    <p>(Our implementation could handle up to 150 simultaneous calls.)</p>
    <p>Ammit reports single-call judgements to a central location (like the HLR)</p>
    <p>Ammit is widely deployed (to prevent trivial evasion)</p>
    <p>Security Assumptions</p>
  </div>
  <div class="page">
    <p>Simboxers may try to evade Ammit, but it will be hard to do.</p>
    <p>Here are some tricks they could try:</p>
    <p>Redundantly transmit audio to avoid packet loss (expensive)</p>
    <p>Try PLC's that Ammit doesn't know about (Most are known)</p>
    <p>Transmit bad VoIP frames to the tower as damaged GSM frames (really hard and probably detectable)</p>
    <p>Potential evasions</p>
  </div>
  <div class="page">
    <p>The use of simboxes for interconnect bypass fraud represent a threat to the reliable function of cellular networks that billions rely on.</p>
    <p>Ammit uses call audio to detect simbox calls in real time, stopping them at the source before they can be profitable</p>
    <p>Take-aways</p>
  </div>
  <div class="page">
    <p>Thanks!</p>
  </div>
</Presentation>
