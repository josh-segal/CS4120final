<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Same-Origin Policy: Evaluation in Modern Browsers</p>
    <p>Jrg Schwenk, Marcus Niemietz, Christian Mainka</p>
    <p>Ruhr-University Bochum</p>
  </div>
  <div class="page">
    <p>Contents</p>
  </div>
  <div class="page"/>
  <div class="page">
    <p>window</p>
    <p>document &lt;html&gt;</p>
    <p>e.g., main HTML document</p>
    <p>head &lt;head&gt;</p>
    <p>body &lt;body&gt;</p>
    <p>&lt;img src=&quot;URL3&quot; name=&quot;bear&quot;&gt;</p>
    <p>&lt;script src=&quot;URL1&quot;&gt;</p>
    <p>doctype HTML 5</p>
    <p>&lt;link src=&quot;URL4&quot;&gt;</p>
    <p>img.src=URL3</p>
    <p>Same-Origin Policy</p>
    <p>https://bank.com</p>
    <p>!</p>
  </div>
  <div class="page">
    <p>Same-Origin Policy</p>
    <p>https://bank.com</p>
    <p>https://bank.com</p>
    <p>IBAN: DE 2345 7568 4013 Amount: $50</p>
    <p>&quot;</p>
  </div>
  <div class="page">
    <p>Same-Origin Policy</p>
    <p>https://bank.com</p>
    <p>IBAN: DE 2345 7568 4013 Amount: $10</p>
    <p># JavaScript</p>
    <p>https://bank.com</p>
    <p>&quot;</p>
  </div>
  <div class="page">
    <p>Same-Origin Policy</p>
    <p>https://attackers.org</p>
    <p>https://bank.com</p>
    <p>IBAN: DE 1337 0000 0000 Amount: $10,000</p>
    <p>$ JavaScript</p>
    <p>%</p>
  </div>
  <div class="page">
    <p>Same-Origin Policy</p>
    <p>https://attackers.org</p>
    <p>https://bank.com</p>
    <p>IBAN: DE 2345 7568 4013 Amount: $50</p>
    <p>' JavaScript</p>
    <p>&quot;</p>
  </div>
  <div class="page">
    <p>window</p>
    <p>document &lt;html&gt;</p>
    <p>e.g., main HTML document e.g., iFrame</p>
    <p>head &lt;head&gt;</p>
    <p>body &lt;body&gt;</p>
    <p>&lt;img src=&quot;URL3&quot; name=&quot;bear&quot;&gt;</p>
    <p>&lt;iframe src=&quot;URL2&quot; id=&quot;ID1&quot;&gt;</p>
    <p>document &lt;html&gt;</p>
    <p>doctype XHTML</p>
    <p>head &lt;head&gt;</p>
    <p>&lt;script src=&quot;URL1&quot;&gt;</p>
    <p>window. frames[0]</p>
    <p>doctype HTML 5</p>
    <p>body &lt;body&gt;</p>
    <p>&lt;link src=&quot;URL4&quot;&gt;</p>
    <p>img.src=URL3</p>
    <p>id=ID1</p>
    <p>DOM-SOP</p>
    <p>!</p>
  </div>
  <div class="page">
    <p>Different Subsets Of SOP Rules</p>
    <p>DOM access (SOP-DOM)  Local storage and session storage  XMLHttpRequest  Pseudoprotocols  Plugins (e.g., Flash, Silverlight, PDF)  Window/tab  HTTP cookies</p>
  </div>
  <div class="page">
    <p>Focus</p>
    <p>Subset of SOP rules according to these criteria  Browser Interactions  Interaction of web objects once they have been loaded</p>
    <p>Web Origins (RFC 6454 as a foundation)  An image is passive content and, therefore, carries no authority, meaning the image has no access to the objects and resources available to its origin</p>
  </div>
  <div class="page">
    <p>Scalable Vector Graphics</p>
    <p>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt; &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; width=&quot;300&quot; height=&quot;300&quot;&gt; &lt;script&gt;alert(1)&lt;/script&gt; &lt;circle cx=&quot;120&quot; cy=&quot;120&quot; r=&quot;110&quot; fill=&quot;#fff&quot; stroke=&quot;#000&quot; strokewidth=&quot;8&quot;/&gt; &lt;/svg&gt;</p>
    <p>&lt;img src=&quot;test.svg&quot;&gt; &lt;embed src=&quot;test.svg&quot;&gt;</p>
  </div>
  <div class="page">
    <p>Research Questions</p>
    <p>How is SOP for DOM access (SOP-DOM) implemented in modern browsers?</p>
    <p>Which parts of the HTML markup influences SOP-DOM?</p>
    <p>How does the detected behavior match known access control policies?</p>
  </div>
  <div class="page"/>
  <div class="page">
    <p>SOP-DOM Setup: Test Cases</p>
    <p>Embedding Element (EE)</p>
    <p>Embedded Document (ED)</p>
    <p>SOP read?</p>
    <p>write?</p>
    <p>read?</p>
    <p>write?</p>
    <p>Host Document (HD)</p>
    <p>Web Object</p>
    <p>Subject: JavaScriptallow script execution?</p>
    <p>Web Origin ED</p>
    <p>{ee,sandbox,cors}</p>
    <p>Web Origin HD</p>
    <p>Subject: JavaScript</p>
    <p>Web Object</p>
  </div>
  <div class="page">
    <p>Your-SOP.com Testbed</p>
  </div>
  <div class="page">
    <p>Your-SOP.com Testbed</p>
  </div>
  <div class="page">
    <p>Different Browser Behaviors</p>
    <p>&gt;12%: Safari 9  Missing type: image/svg+xml</p>
    <p>Fixed in Safari 10.1</p>
    <p>&gt;35%: &lt;canvas&gt; and PNG/SVG (CORS)</p>
    <p>&gt;51%: &lt;link&gt; (CORS)</p>
    <p>One IE/Edge vulnerability without using CORS</p>
  </div>
  <div class="page">
    <p>Cross-Origin Login Oracle Attack</p>
  </div>
  <div class="page">
    <p>Cross-Origin Login Oracle Attack</p>
    <p>Webserver delivers different CSS files  User logged in or logged out?</p>
    <p>a.com attacks victim.com  &lt;link type=&quot;text/css&quot; rel=&quot;stylesheet&quot;</p>
    <p>href=&quot;//victim.com/style.css&quot; /&gt;  &lt;script&gt;alert(document.styleSheets[0].cssRul</p>
    <p>es[0].cssText)&lt;/script&gt;</p>
  </div>
  <div class="page">
    <p>Cross-Origin Login Oracle Attack</p>
  </div>
  <div class="page"/>
  <div class="page">
    <p>Limitations</p>
    <p>15 HTML elements with src attributes  Several more with a similar functionality</p>
    <p>Many sandbox attributes, ways to embed a document, MIME types, and pseudoprotocols</p>
    <p>&lt;link&gt;: imports, worker  &lt;svg&gt;: JavaScript via xlink  Growing surface with each new feature</p>
  </div>
  <div class="page">
    <p>Access Control Policies</p>
    <p>Discretionary Access Control (DAC)  Role-Based Access Control (RBAC)  Enhanced RBAC</p>
    <p>Attribute-Based Access Control (ABAC)</p>
  </div>
  <div class="page"/>
  <div class="page">
    <p>Conclusions &amp; Future Work</p>
    <p>Different browser data sets to identify inconsistencies (edge cases are important)</p>
    <p>Discussion about access control policies may help to understand the SOP-DOM</p>
    <p>Future Work  Other SOP subsets, HTML elements/attributes  Pseudoprotocols</p>
  </div>
  <div class="page">
    <p>Thank you for your attention</p>
    <p>marcus.niemietz@rub.de @mniemietz</p>
  </div>
</Presentation>
