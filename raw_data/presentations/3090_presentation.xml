<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Rev PA1 07/05/04 1 Ericsson Canada</p>
    <p>A new Distributed Security Model for Linux Clusters</p>
    <p>Makan.Pourzandi@Ericsson.Com</p>
    <p>Open Systems Lab Montral  Canada</p>
    <p>June, 2004</p>
  </div>
  <div class="page">
    <p>Rev PA1 07/05/04 2 Ericsson Canada</p>
    <p>Outline</p>
    <p>Context</p>
    <p>Distributed Security</p>
    <p>Distributed Access Control (DisAC)</p>
    <p>DisAC implementation: Distributed Security Infrastructure</p>
  </div>
  <div class="page">
    <p>Rev PA1 07/05/04 3 Ericsson Canada</p>
    <p>Context  Target application:</p>
    <p>Large distributed applications  Large software base  Up 24 hours/7 days  High Availability: from 2 to 5 nines (99.999%) uptime</p>
    <p>Linux Clustered servers  Providing services to different operators  Exposed to the Public network/Internet  Running untrusted thirdparty software</p>
    <p>No access to the sourc code  No possibility to audit the code for economical and schedule related reasons</p>
    <p>Software configuration evolves slowly over time: no wild software installations</p>
  </div>
  <div class="page">
    <p>Rev PA1 07/05/04 4 Ericsson Canada</p>
    <p>Specific Security Needs</p>
    <p>Security isolation, compartmentalization  Large applications supporting many functionalities  Probability of exploitable vulnerabilities in a large software base  A vulnerability in some parts of the system can compromise the entire system</p>
    <p>Preemptive security: changes in the security context will be reflected immediately</p>
    <p>Dynamic security policy: run time changes in security context and policy</p>
    <p>Don't only rely on application layer security mechanisms: Administrators must contend with vulnerabilities in applications over which they have no direct control</p>
  </div>
  <div class="page">
    <p>Rev PA1 07/05/04 5 Ericsson Canada</p>
    <p>Distributed Security</p>
  </div>
  <div class="page">
    <p>Rev PA1 07/05/04 6 Ericsson Canada</p>
    <p>Challenges in Distributed security  Implement coherent distributed security</p>
    <p>Many layers to fit together: Applications, Middleware, OS, Hardware, Network</p>
    <p>Heterogeneous environment: variety of Hardware, Software: OS, Middleware, Netwozrking technologis</p>
    <p>Security Architectural Elements in ITUT X.805, from Security in Telecom and Information Technology, Dec 2003</p>
  </div>
  <div class="page">
    <p>Rev PA1 07/05/04 7 Ericsson Canada</p>
    <p>Challenges in Distributed security (2)</p>
    <p>Integration of different security solutions from potentially different vendors...</p>
    <p>System management  If manually managed, it may lead to misconfigurations and</p>
    <p>inconsistencies</p>
  </div>
  <div class="page">
    <p>Rev PA1 07/05/04 8 Ericsson Canada</p>
    <p>Distributed Systems Require Distributed Security</p>
    <p>Hartman, Flinn, Beznosov, Enterprise Security with EJB and CORBA</p>
  </div>
  <div class="page">
    <p>Rev PA1 07/05/04 9 Ericsson Canada</p>
    <p>User based access control approach on cluster computing  Based on user privileges (login, password)</p>
    <p>Life time: a session of several hours/days</p>
    <p>Scope: limited range of operations according to the applications nature</p>
    <p>Security policy based upon login and passwords</p>
    <p>Our target application:  Few users only  Life time: months if not years  Scope: wide range of operations, from</p>
    <p>upgrading software to managing information in database</p>
    <p>Node 2 No Security check on</p>
    <p>Process a, but on Process b</p>
    <p>Security Manager</p>
    <p>Process a</p>
    <p>Process b</p>
    <p>Security Manager</p>
    <p>Node 1</p>
    <p>Access Request?</p>
  </div>
  <div class="page">
    <p>Rev PA1 07/05/04 10 Ericsson Canada</p>
    <p>Needs vs. Existing mechanisms</p>
    <p>Security policy depends on the processes and the source of the request rather than the user</p>
    <p>Running for a very long time (months) under the same login without rebooting</p>
    <p>Fine grained security policy based on processes</p>
    <p>Preemptive security</p>
    <p>Security policy based upon login and passwords</p>
    <p>Compartmentalization: necessity of creating/managing many users and groups</p>
    <p>User authentication often only at login time</p>
    <p>Running for short period of time (days) before each reboot</p>
    <p>No preemptive security</p>
    <p>NeedsCurrent mechanisms</p>
  </div>
  <div class="page">
    <p>Rev PA1 07/05/04 11 Ericsson Canada</p>
    <p>MAC vs DAC</p>
    <p>Discretionary Access Control (DAC)  It is at the discretion of the user to define access control</p>
    <p>privileges for user resources</p>
    <p>Mandatory Access Control (MAC)  Access control no longer solely depends on the user's decision  The system administrator defines the access control policy of the</p>
    <p>system</p>
  </div>
  <div class="page">
    <p>Rev PA1 07/05/04 12 Ericsson Canada</p>
    <p>Existing solutions</p>
    <p>Many existing security solutions exist:  As external security mechanisms to the servers such as firewalls and Intrusion</p>
    <p>Detection Systems  As part of servers such as Integrity checks and some mechanisms to enhance</p>
    <p>security as a part of OS</p>
    <p>Recent efforts  Linux Security Modules  SE Linux  Process right management in Solaris 10</p>
    <p>However, there are few efforts to make a coherent framework for enhancing security in a distributed system</p>
  </div>
  <div class="page">
    <p>Rev PA1 07/05/04 13 Ericsson Canada</p>
    <p>Distributed Access Control (DisAC)</p>
  </div>
  <div class="page">
    <p>Rev PA1 07/05/04 14 Ericsson Canada</p>
    <p>DisAC</p>
    <p>Goal  Extending kernellevel Mandatory Access Control features for a single</p>
    <p>computer into features for a distributed system</p>
    <p>Usage  Sharing the same cluster among different applications running untrusted third</p>
    <p>party software  Compartmentalization: Setting up virtual security zones inside the cluster</p>
  </div>
  <div class="page">
    <p>Rev PA1 07/05/04 15 Ericsson Canada</p>
    <p>Characteristics</p>
    <p>Clusterwide access control</p>
    <p>Processlevel granularity access control</p>
    <p>Access control at Operating system kernel level (Linux)</p>
    <p>Extra security functionality in addition to  User level authentication  Discretionary Access Control</p>
  </div>
  <div class="page">
    <p>Rev PA1 07/05/04 16 Ericsson Canada</p>
    <p>General access model</p>
    <p>Process</p>
    <p>Resource Access</p>
    <p>Node 1 Node 2 Node N</p>
    <p>Linux Cluster</p>
  </div>
  <div class="page">
    <p>Rev PA1 07/05/04 17 Ericsson Canada</p>
    <p>Process level Security Context  Process security ID: ScID</p>
    <p>Privileges associated with each process  Defined for the entire cluster: it can be transferred and interpreted through</p>
    <p>the whole cluster  Persistent</p>
    <p>Security ID: corresponding to the group security context  Assigned by local security manager at the creaton of the process</p>
    <p>Node security ID: SnID  Privileges associated with each node  Unique for each node in the cluster</p>
    <p>Security Context for each process  Defined by: &lt;ScID, SnID&gt;</p>
  </div>
  <div class="page">
    <p>Rev PA1 07/05/04 18 Ericsson Canada</p>
    <p>ScID for a newly created process  ScID of binary:</p>
    <p>Stored in ELF header  Integrity protected by digital signatures</p>
    <p>Parent Process ScID  Node SnID  New ScID stored at kernel level for each process</p>
    <p>SnID Node</p>
    <p>ScID Parent Process</p>
    <p>ScID New ProcessScID binary</p>
  </div>
  <div class="page">
    <p>Rev PA1 07/05/04 19 Ericsson Canada</p>
    <p>Classifying binaries based on security</p>
    <p>Using ScIDs for categorizing binaries</p>
  </div>
  <div class="page">
    <p>Rev PA1 07/05/04 20 Ericsson Canada</p>
    <p>Access control decisions</p>
    <p>Process level based on &lt;SnID, ScID&gt; of source and target</p>
    <p>Locality in the distributed system is taken into account</p>
    <p>An access is only granted if the following access policy exists:  Source &lt;SnID, ScID&gt;, Target &lt;SnID, ScID&gt;, Allowed Action</p>
    <p>Different classes of rules: network, socket, process, transition</p>
  </div>
  <div class="page">
    <p>Rev PA1 07/05/04 21 Ericsson Canada</p>
    <p>Distributed Security Policy (DSP)</p>
    <p>Express a coherent security vision (security policy) through out all the cluster</p>
    <p>Local security policy:  Initially integrated to the secure boot software  Maintained and updated by the security server through security communication</p>
    <p>channel</p>
  </div>
  <div class="page">
    <p>Rev PA1 07/05/04 22 Ericsson Canada</p>
    <p>Source Process</p>
    <p>(ScID=10)</p>
    <p>Node 1 (SnID=1)</p>
    <p>Target Process</p>
    <p>(ScID=20)</p>
    <p>Node 2 (SnID=2)</p>
    <p>Distributed Security Policy</p>
    <p>&lt;sScID&gt; &lt;/sScID&gt; &lt;/sSnID&gt;&lt;sSnID&gt;</p>
    <p>&lt;allow&gt; Connect &lt;/allow&gt;</p>
    <p>&lt;/tSnID&gt; &lt;/tScID&gt;</p>
    <p>&lt;tSnID&gt; &lt;tScID&gt;</p>
  </div>
  <div class="page">
    <p>Rev PA1 07/05/04 23 Ericsson Canada</p>
    <p>Source Node</p>
    <p>Proc12 ScID=10</p>
    <p>Main(){ ... send(sock1,..); ... }</p>
    <p>DSM</p>
    <p>DSP</p>
    <p>Target Node</p>
    <p>C H E C K C H E C K</p>
    <p>Proc14 ScID=10</p>
    <p>Main(){ ... receive(sock1,.); ... }</p>
    <p>DSP</p>
    <p>DSM</p>
    <p>SScID, SsnID IP Packet TCP Port 8000</p>
    <p>ScID=10 TCP Port x ScID=10</p>
    <p>Kernel Level</p>
    <p>User Level</p>
    <p>DisAC: Access control verifications</p>
  </div>
  <div class="page">
    <p>Rev PA1 07/05/04 24 Ericsson Canada</p>
    <p>Process::Send Process:Receive</p>
    <p>Node 1 (SnID=1) Node 2 (SnID=2)</p>
    <p>Port 8000 Server Socket</p>
    <p>Port xxx Client Socket</p>
    <p>permission to send msg</p>
    <p>Explicit assignment ScID=10</p>
    <p>Implicit assignment ScID=10</p>
    <p>permission to send IP packets</p>
    <p>permission for the socket to receive from node 2, ScID = 10</p>
    <p>permission to receive msg</p>
    <p>permission to receive IP packets 2</p>
  </div>
  <div class="page">
    <p>Rev PA1 07/05/04 25 Ericsson Canada</p>
    <p>Process</p>
    <p>Resource Access</p>
    <p>Security Zones</p>
    <p>Node 1 Node 2 Node N</p>
    <p>Clusterwide Access Control</p>
  </div>
  <div class="page">
    <p>Rev PA1 07/05/04 26 Ericsson Canada</p>
    <p>Security zones</p>
    <p>Each ScID corresponds to a security zone (few ScIDs)</p>
    <p>ScIDs are not meant to be unique for each process or application</p>
    <p>Possible simplification by using ALL keyword in DSP for SnID allows to avoid the locality in the cluster</p>
    <p>Very simple; using two ScIDs and SnID set to ALL; it is possible to divide the cluster into two zones: trusted and untrusted zone</p>
  </div>
  <div class="page">
    <p>Rev PA1 07/05/04 27 Ericsson Canada</p>
    <p>Inside the cluster Outside</p>
    <p>SS</p>
    <p>BackEnd server of PhoneMania</p>
    <p>FrontEnd server of PhoneMania</p>
    <p>BackEnd server of RingBell BackEnd server of RingBell</p>
    <p>FrontEnd server of RingBell</p>
    <p>SMSM</p>
    <p>DSM DSM</p>
    <p>TelecomClient</p>
    <p>SCC</p>
    <p>Virtual subcluster</p>
    <p>Virtual subcluster</p>
    <p>DisAC: Creating Virtual Security Zones</p>
  </div>
  <div class="page">
    <p>Rev PA1 07/05/04 28 Ericsson Canada</p>
    <p>DisAC implementation: Distributed Security Infrastructure</p>
  </div>
  <div class="page">
    <p>Rev PA1 07/05/04 29 Ericsson Canada</p>
    <p>Distributed Security Infrastructure</p>
  </div>
  <div class="page">
    <p>Rev PA1 07/05/04 30 Ericsson Canada</p>
    <p>SM SMSS DSP</p>
    <p>DSM DSM</p>
    <p>Node 1 Node 2</p>
    <p>UpdateDSP UpdateDSP</p>
    <p>security enforcementload and</p>
    <p>check</p>
    <p>propagate</p>
    <p>Secure Communication Channels</p>
    <p>Kernel</p>
    <p>DSP Update</p>
  </div>
  <div class="page">
    <p>Rev PA1 07/05/04 31 Ericsson Canada</p>
    <p>Development Environment</p>
    <p>Kernel 2.4.17</p>
    <p>LSM patch</p>
    <p>Red Hat 7.3</p>
    <p>C/C++</p>
    <p>GCC 2.96</p>
  </div>
  <div class="page">
    <p>Rev PA1 07/05/04 32 Ericsson Canada</p>
    <p>Benchmarking results</p>
    <p>OverheadWith DSIWithout DSITest type</p>
    <p>Results for LMBench on Linux 2.4.17, Pentium 4, 2,4 Ghz. Time units are microseconds.</p>
  </div>
  <div class="page">
    <p>Rev PA1 07/05/04 33 Ericsson Canada</p>
    <p>Challenges</p>
    <p>Comprehensible and acceptable security policy  Seltzed &amp; Schroder 1975: security mechanisms must be comprehensible and</p>
    <p>acceptable to users, or they will be ignored and bypassed.</p>
    <p>Explicitly defining security zones in DSP  generate the low level DSP rules from those high level security zones</p>
  </div>
  <div class="page">
    <p>Rev PA1 07/05/04 34 Ericsson Canada</p>
    <p>Conclusions</p>
    <p>Distributed Access Control  DisAC enforces clusterwide access control at kernel level for distributed</p>
    <p>systems</p>
    <p>Unified security view</p>
    <p>Process level Granularity</p>
    <p>Setting virtual security zones inside a cluster</p>
    <p>Distributed Security Infrastructure  Implemented under GPL (stable version for kernel 2.4.17, development version for</p>
    <p>kernel 2.6.X)</p>
  </div>
  <div class="page">
    <p>Rev PA1 07/05/04 35 Ericsson Canada</p>
    <p>DSI References  Web site</p>
    <p>http://disec.sourceforge.net/ http://www.linux.ericsson.ca/dsi</p>
    <p>DSI Packages http://sourceforge.net/project/showfiles.php?group_id=67502</p>
    <p>Online CVS http://cvs.sourceforge.net/viewcvs.py/disec/</p>
    <p>Contact person makan.pourzandi@ericsson.com</p>
  </div>
</Presentation>
