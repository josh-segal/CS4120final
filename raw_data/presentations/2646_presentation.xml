<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>HUG Multi-Resource Fairness for Correlated and Elastic Demands</p>
    <p>Mosharaf Chowdhury, Zhenhua Liu Ali Ghodsi, Ion Stoica</p>
  </div>
  <div class="page">
    <p>M1 M2 M3 MN</p>
    <p>Congestion-Less Core</p>
    <p>L1 L2 L3 LNLN+1 LN+2 LN+3 L2N</p>
    <p>How to share the links between multiple tenants to provide 1. optimal performance</p>
    <p>guarantees and 2. maximize utilization?</p>
    <p>Tenant-As VMs</p>
    <p>Tenant-Bs VMs</p>
  </div>
  <div class="page">
    <p>Single-Resource Max-Min Fairness</p>
    <p>L1 1/2</p>
    <p>Tenant-A wants half of it Tenant-B wants all of it</p>
  </div>
  <div class="page">
    <p>Single-Resource Max-Min Fairness</p>
    <p>L1 1/2</p>
    <p>Tenant-A wants half of it Tenant-B wants all of it</p>
    <p>dA = 1/2 aA = 1/2</p>
    <p>dB = 1 aB = 1/2 MB = = 1/2dB</p>
    <p>aB</p>
    <p>MA = = 1dA</p>
    <p>aA</p>
    <p>} Min(MA, MB) = 1/2</p>
    <p>Progress (M) of a tenant is its demand-normalized allocation</p>
    <p>Isolation Guarantee is the minimum progress across all</p>
  </div>
  <div class="page">
    <p>Single-Resource Max-Min Fairness</p>
    <p>L1 1/2</p>
    <p>Tenant-A wants half of it Tenant-B wants all of it</p>
  </div>
  <div class="page">
    <p>No Tradeoff for Single Resource</p>
    <p>Isolation Guarantee</p>
    <p>U ti</p>
    <p>li za</p>
    <p>ti on</p>
    <p>WorkConserving</p>
    <p>Low</p>
    <p>Low Optimal</p>
    <p>Per-Flow Fairness 1. Optimal Isolation</p>
    <p>Guarantee 2. Work Conservation 3. Strategyproof</p>
  </div>
  <div class="page">
    <p>M1 M2 M3 MN</p>
    <p>Congestion-Less Core</p>
    <p>L1 L2 L3 LNLN+1 LN+2 LN+3 L2N</p>
    <p>Tenants have different 1. placements, 2. communication patterns, 3. demand correlations, 4.</p>
    <p>Tenant-As VMs</p>
    <p>Tenant-Bs VMs</p>
  </div>
  <div class="page">
    <p>Per-Flow Fairness For Multiple Resources</p>
    <p>Isolation Guarantee</p>
    <p>U ti</p>
    <p>li za</p>
    <p>ti on</p>
    <p>WorkConserving</p>
    <p>Low</p>
    <p>Low Optimal</p>
    <p>Per-Flow Fairness</p>
    <p>Low</p>
  </div>
  <div class="page">
    <p>L1 L2</p>
    <p>Elastic Demands1</p>
    <p>Tenant-A wants all of L1 and all of L2</p>
    <p>Tenant-B wants all of L1 and all of L2</p>
  </div>
  <div class="page">
    <p>L1 L2</p>
    <p>dA = &lt;1, 1&gt;</p>
    <p>dB = &lt;1, 1&gt;</p>
    <p>Tenant-Level Max-Min Fairness (PS-P)</p>
    <p>Tenant-A wants all of L1 and all of L2</p>
    <p>Tenant-B wants all of L1 and all of L2</p>
    <p>aA = &lt;, &gt;</p>
    <p>aB = &lt;, &gt; Min(MA, MB) = }</p>
    <p>MA = min = dA</p>
    <p>aA i</p>
    <p>i( ) MB = min = ( )dB</p>
    <p>aB i</p>
    <p>i</p>
  </div>
  <div class="page">
    <p>Tenant-Level Max-Min Fairness (PS-P)</p>
    <p>Isolation Guarantee U</p>
    <p>ti li</p>
    <p>za ti</p>
    <p>on</p>
    <p>WorkConserving</p>
    <p>Low</p>
    <p>Low Optimal</p>
    <p>Per-Flow Fairness 1. Suboptimal</p>
    <p>Isolation Guarantee 2. Work Conservation</p>
    <p>PS-P</p>
  </div>
  <div class="page">
    <p>L1 L2</p>
    <p>Correlated Demands1</p>
    <p>Tenant-A wants some of L1 and all of L2</p>
    <p>Tenant-B wants some of L2 and all of L1</p>
  </div>
  <div class="page">
    <p>Dominant Resource Fairness (DRF)</p>
    <p>Tenant-A wants exactly half unit of L1 for each of L2</p>
    <p>Tenant-B wants exactly 1/6 unit of L2 for each of L1</p>
    <p>dA = &lt;1/2, 1&gt;</p>
    <p>dB = &lt;1, 1/6&gt;</p>
    <p>aA = &lt;1/3, 2/3&gt;</p>
    <p>aB = &lt;2/3, 1/9&gt; Min(MA, MB) = 2/3}</p>
    <p>MA = min = 2/3dA</p>
    <p>aA i</p>
    <p>i( ) MB = min = 2/3( )dB</p>
    <p>aB i</p>
    <p>i</p>
    <p>L1 L2</p>
  </div>
  <div class="page">
    <p>Dominant Resource Fairness (DRF)</p>
    <p>Isolation Guarantee U</p>
    <p>ti li</p>
    <p>za ti</p>
    <p>on</p>
    <p>WorkConserving</p>
    <p>Low</p>
    <p>Low Optimal</p>
    <p>Per-Flow Fairness 1. Optimal Isolation</p>
    <p>Guarantee 2. Arbitrarily Low</p>
    <p>Utilization 3. Strategyproof</p>
    <p>PS-P</p>
    <p>DRF</p>
  </div>
  <div class="page">
    <p>Isolation Guarantee U</p>
    <p>ti li</p>
    <p>za ti</p>
    <p>on</p>
    <p>WorkConserving</p>
    <p>Low</p>
    <p>Low Optimal</p>
    <p>Per-Flow Fairness</p>
    <p>PS-P</p>
    <p>DRF</p>
    <p>For elastic and correlated demands, can we simultaneously achieve optimal isolation guarantee and maximum utilization?</p>
  </div>
  <div class="page">
    <p>Isolation Guarantee U</p>
    <p>ti li</p>
    <p>za ti</p>
    <p>on</p>
    <p>WorkConserving</p>
    <p>Low</p>
    <p>Low Optimal</p>
    <p>Per-Flow Fairness</p>
    <p>PS-P</p>
    <p>DRF</p>
    <p>For elastic and correlated demands, can we simultaneously achieve optimal isolation guarantee and maximum utilization?</p>
    <p>NO</p>
  </div>
  <div class="page">
    <p>For elastic and correlated demands, can we simultaneously achieve optimal isolation guarantee and maximum utilization?</p>
    <p>Isolation Guarantee U</p>
    <p>ti li</p>
    <p>za ti</p>
    <p>on</p>
    <p>WorkConserving</p>
    <p>Low</p>
    <p>Low Optimal</p>
    <p>Per-Flow Fairness</p>
    <p>PS-P</p>
    <p>DRF</p>
    <p>NO</p>
  </div>
  <div class="page">
    <p>For elastic and correlated demands, can we simultaneously achieve optimal isolation guarantee and maximum utilization?</p>
    <p>Isolation Guarantee U</p>
    <p>ti li</p>
    <p>za ti</p>
    <p>on</p>
    <p>WorkConserving</p>
    <p>Low</p>
    <p>Low Optimal</p>
    <p>Per-Flow Fairness</p>
    <p>PS-P</p>
    <p>DRF</p>
  </div>
  <div class="page">
    <p>Elastic and Correlated Demands</p>
    <p>Tenant-A wants at least half unit of L1 for each of L2</p>
    <p>Tenant-B wants at least 1/6 unit of L2 for each of L1</p>
    <p>dA = &lt;1/2, 1&gt;</p>
    <p>dB = &lt;1, 1/6&gt;</p>
    <p>aA = &lt;1/3, 2/3&gt;</p>
    <p>aB = &lt;2/3, 1/9&gt; Min(MA, MB) = 2/3}</p>
    <p>MA = 2/3</p>
    <p>MB = 2/3</p>
    <p>L1 L2</p>
  </div>
  <div class="page">
    <p>Tenant-A wants at least half unit of L1 for each of L2</p>
    <p>Tenant-B wants at least 1/6 unit of L2 for each of L1</p>
    <p>dA = &lt;1/2, 1&gt;</p>
    <p>dB = &lt;1, 1/6&gt;</p>
    <p>aA = &lt;1/3, 2/3&gt;</p>
    <p>aB = &lt;2/3, 1/9&gt; Min(MA, MB) = 2/3}</p>
    <p>MA = 2/3</p>
    <p>MB = 2/3</p>
    <p>Elastic and Correlated Demands</p>
    <p>L1 L2</p>
    <p>Who gets this?</p>
  </div>
  <div class="page">
    <p>Work Conservation Doesnt Work!</p>
    <p>Tenant-A wants at least half unit of L1 and for each of L2</p>
    <p>Tenant-B wants at least 1/6 unit of L2 for each of L1</p>
    <p>d'A = &lt;1, 1&gt;</p>
    <p>dB = &lt;1, 1/6&gt;</p>
    <p>a'A = &lt;, &gt;</p>
    <p>aB = &lt;, 1/12&gt;</p>
    <p>L1 L2</p>
    <p>Tenant-A lies and asks for one unit of L1 for each of L2</p>
  </div>
  <div class="page">
    <p>Work Conservation Doesnt Work!</p>
    <p>Tenant-B wants at least 1/6 unit of L2 for each of L1</p>
    <p>d'A = &lt;1, 1&gt;</p>
    <p>dB = &lt;1, 1/6&gt;</p>
    <p>a'A = &lt;, &gt;</p>
    <p>aB = &lt;, 1/12&gt;</p>
    <p>M'A = 11/12</p>
    <p>M'B = 1/2</p>
    <p>L1 L2</p>
    <p>a'A = &lt;, 11/12&gt;</p>
    <p>Tenant-A lies and asks for one unit of L1 for each of L2</p>
  </div>
  <div class="page">
    <p>Prisoners Dilemma</p>
    <p>, 11 12</p>
    <p>,</p>
    <p>, 1 2</p>
    <p>,</p>
    <p>Tenant-A Te</p>
    <p>na nt</p>
    <p>-B</p>
    <p>LiesDoesnt Lie</p>
    <p>Doesnt Lie</p>
    <p>Lies</p>
  </div>
  <div class="page">
    <p>For elastic and correlated demands, can we simultaneously achieve optimal isolation guarantee and maximum utilization?</p>
    <p>Isolation Guarantee U</p>
    <p>ti li</p>
    <p>za ti</p>
    <p>on</p>
    <p>WorkConserving</p>
    <p>Low</p>
    <p>Low Optimal</p>
    <p>Per-Flow Fairness</p>
    <p>PS-P</p>
    <p>DRF</p>
    <p>Optimal isolation guarantee depends on being strategyproof, but work conservation cannot coexist with strategyproof-ness</p>
  </div>
  <div class="page">
    <p>For elastic and correlated demands, can we simultaneously achieve optimal isolation guarantee and maximum utilization?</p>
    <p>Isolation Guarantee U</p>
    <p>ti li</p>
    <p>za ti</p>
    <p>on</p>
    <p>WorkConserving</p>
    <p>Low</p>
    <p>Low Optimal</p>
    <p>PS-P</p>
    <p>DRF</p>
    <p>Per-Flow Fairness</p>
  </div>
  <div class="page">
    <p>Isolation Guarantee U</p>
    <p>ti li</p>
    <p>za ti</p>
    <p>on</p>
    <p>WorkConserving</p>
    <p>Low</p>
    <p>Low Optimal</p>
    <p>PS-P</p>
    <p>DRF</p>
    <p>Per-Flow Fairness</p>
    <p>HUG</p>
    <p>HUG in Non-Cooperative Setting</p>
  </div>
  <div class="page">
    <p>HUG Highest Utilizationwith theOptimal Isolation Guarantee</p>
    <p>Restrict a tenants allocation in any link to its allocation in the bottleneck link</p>
  </div>
  <div class="page">
    <p>Tenant-A Lied</p>
    <p>Tenant-B wants at least 1/6 unit of L2 for each of L1</p>
    <p>d'A = &lt;1, 1&gt;</p>
    <p>dB = &lt;1, 1/6&gt;</p>
    <p>a'A = &lt;, &gt;</p>
    <p>aB = &lt;, 1/12&gt;</p>
    <p>M'A = 11/12</p>
    <p>M'B = 1/2</p>
    <p>L1 L2</p>
    <p>a'A = &lt;, 11/12&gt;</p>
    <p>Tenant-A lies and asks for one unit of L1 for each of L2</p>
    <p>M'A = 1/2</p>
  </div>
  <div class="page">
    <p>Everyone is Forced to Tell the Truth</p>
    <p>Tenant-A wants at least half unit of L1 for each of L2</p>
    <p>Tenant-B wants at least 1/6 unit of L2 for each of L1</p>
    <p>dA = &lt;1/2, 1&gt;</p>
    <p>dB = &lt;1, 1/6&gt;</p>
    <p>aA = &lt;1/3, 2/3&gt;</p>
    <p>aB = &lt;2/3, 1/9&gt;</p>
    <p>MA = 2/3</p>
    <p>MB = 2/3</p>
    <p>L1 L2</p>
    <p>a'B = &lt;2/3, 1/3&gt;</p>
  </div>
  <div class="page">
    <p>HUG Highest Utilizationwith theOptimal Isolation Guarantee</p>
  </div>
  <div class="page">
    <p>Isolation Guarantee U</p>
    <p>ti li</p>
    <p>za ti</p>
    <p>on</p>
    <p>WorkConserving</p>
    <p>Low</p>
    <p>Low Optimal</p>
    <p>PS-P</p>
    <p>DRF</p>
    <p>Per-Flow Fairness</p>
    <p>HUG</p>
  </div>
  <div class="page">
    <p>Evaluation</p>
    <p>Isolation Guarantee U</p>
    <p>ti li</p>
    <p>za ti</p>
    <p>on</p>
    <p>100 concurrent tenants  3000 machines with 3Tbps</p>
    <p>total capacity  Original placement and</p>
    <p>communication patterns from the Facebook trace</p>
    <p>(Gbps)</p>
    <p>(T bp</p>
    <p>s)</p>
    <p>Per-Flow Fairness</p>
    <p>PS-P</p>
    <p>DRF</p>
    <p>HUG</p>
    <p>PS-P</p>
    <p>DRF</p>
    <p>Per-Flow Fairness HUG</p>
  </div>
  <div class="page">
    <p>Three Challenges</p>
    <p>#3 Decentralized</p>
    <p>Algorithms</p>
    <p>Survive master failures and enable low response times</p>
    <p>#1 Bursty</p>
    <p>Demands</p>
    <p>Periodic demand bursts in Spark streaming</p>
    <p>#2 Long-Term Guarantees</p>
    <p>Predictable performance guarantees over time</p>
  </div>
  <div class="page">
    <p>Generalizes single- and multi-resource fairness schemes  Optimal worst-case performance guarantees for tenants  Highest utilization for operators</p>
    <p>HUG</p>
    <p>Mosharaf Chowdhury - @mosharaf</p>
    <p>Highest Utilization with the</p>
    <p>Optimal Isolation Guarantee</p>
  </div>
  <div class="page"/>
  <div class="page">
    <p>Isolation Guarantee U</p>
    <p>ti li</p>
    <p>za ti</p>
    <p>on</p>
    <p>WorkConserving</p>
    <p>Low</p>
    <p>Low Optimal</p>
    <p>PS-P</p>
    <p>DRF</p>
    <p>Per-Flow Fairness</p>
    <p>HUG</p>
    <p>HUG in Cooperative Setting</p>
  </div>
  <div class="page">
    <p>Evaluation A 3000-machine trace-driven simulation based on a snapshot of Facebook production trace</p>
  </div>
  <div class="page">
    <p>Optimal Progress for ALL</p>
    <p>Min</p>
    <p>Max 1</p>
    <p>Per-Flow Fairness</p>
    <p>Max-to-Min Progress Ratio</p>
    <p>PS-P2</p>
    <p>DRF3</p>
    <p>HUG</p>
  </div>
  <div class="page">
    <p>Higher Network Utilization</p>
    <p>Total Utilization</p>
    <p>(Tbps) 2.21 2.20 1.42 2.00</p>
    <p>Max-to-Min Progress Ratio</p>
    <p>Per-Flow Fairness PS-P2 DRF3 HUG</p>
  </div>
  <div class="page">
    <p>Long-Term Performance</p>
    <p>Fr ac</p>
    <p>ti o n</p>
    <p>o f Sh</p>
    <p>uf fle</p>
    <p>s</p>
    <p>Slowdown w.r.t. Minimum Required Comp. Time</p>
    <p>Per-Flow Fairness PS-P HUG DRF Varys</p>
    <p>Average Time Per-flow Fairness 1.49X</p>
    <p>PS-P 1.14X</p>
    <p>DRF 1.14X</p>
    <p>HUG 1X Varys1 0.69X</p>
  </div>
  <div class="page">
    <p>Coordination Overheads and Scalability</p>
    <p>Computation overheads  Less than 5 s for 100</p>
    <p>machine cluster  Less than 10 ms for</p>
    <p>Communication overheads  Less than 10 ms for 100</p>
    <p>machine cluster  Less than 1 second for</p>
  </div>
  <div class="page">
    <p>Optimal Progress for ALL</p>
    <p>Fr ac</p>
    <p>ti o n</p>
    <p>o f Sh</p>
    <p>uf fle</p>
    <p>s</p>
    <p>Progress (Gbps)</p>
    <p>Per-Flow Fairness PS-P HUG DRF</p>
    <p>Max/Min Ratio Per-flow Fairness 10000X</p>
    <p>PS-P 10X</p>
    <p>DRF 1X</p>
    <p>HUG 1X</p>
  </div>
  <div class="page">
    <p>Fr ac</p>
    <p>ti o n</p>
    <p>o f Sh</p>
    <p>uf fle</p>
    <p>s</p>
    <p>Aggregate Bandwidth (Gbps)</p>
    <p>Per-Flow Fairness PS-P HUG DRF</p>
    <p>Higher Utilization</p>
    <p>Max/Min Ratio Per-flow Fairness 3240000X</p>
    <p>PS-P 2590X</p>
    <p>DRF 196X</p>
    <p>HUG 340X</p>
  </div>
</Presentation>
