<?xml version="1.0" ?>
<Presentation>
  <div class="page">
    <p>Kernel Regression with Order Preferences</p>
    <p>Xiaojin Zhu Andrew B. Goldberg</p>
    <p>Department of Computer Sciences University of Wisconsin, Madison, USA</p>
    <p>AAAI 2007</p>
    <p>Zhu, Goldberg (Wisconsin) Kernel Regression with Order Preferences AAAI 2007 1 / 24</p>
  </div>
  <div class="page">
    <p>How much is your house worth?</p>
    <p>Regression problem.</p>
    <p>labeled training data (x1, y1), . . . , (xl, yl) y  R: price x: features</p>
    <p>I location I location I location</p>
    <p>Zhu, Goldberg (Wisconsin) Kernel Regression with Order Preferences AAAI 2007 2 / 24</p>
  </div>
  <div class="page">
    <p>How much is your house worth?</p>
    <p>Regression problem.</p>
    <p>labeled training data (x1, y1), . . . , (xl, yl) y  R: price x: features</p>
    <p>I location</p>
    <p>I location I location</p>
    <p>Zhu, Goldberg (Wisconsin) Kernel Regression with Order Preferences AAAI 2007 2 / 24</p>
  </div>
  <div class="page">
    <p>How much is your house worth?</p>
    <p>Regression problem.</p>
    <p>labeled training data (x1, y1), . . . , (xl, yl) y  R: price x: features</p>
    <p>I location I location</p>
    <p>I location</p>
    <p>Zhu, Goldberg (Wisconsin) Kernel Regression with Order Preferences AAAI 2007 2 / 24</p>
  </div>
  <div class="page">
    <p>How much is your house worth?</p>
    <p>Regression problem.</p>
    <p>labeled training data (x1, y1), . . . , (xl, yl) y  R: price x: features</p>
    <p>I location I location I location</p>
    <p>Zhu, Goldberg (Wisconsin) Kernel Regression with Order Preferences AAAI 2007 2 / 24</p>
  </div>
  <div class="page">
    <p>How much is your house worth?</p>
    <p>Regression problem.</p>
    <p>labeled training data (x1, y1), . . . , (xl, yl) y  R: price x: features</p>
    <p>I location I number of bedrooms I age I median income I . . .</p>
    <p>learn f : X 7 R</p>
    <p>Zhu, Goldberg (Wisconsin) Kernel Regression with Order Preferences AAAI 2007 3 / 24</p>
  </div>
  <div class="page">
    <p>Knowledge from real estate experts</p>
    <p>Within some distance, other factors being roughly equal, the value is largely determined by the number of bedrooms.</p>
    <p>Zhu, Goldberg (Wisconsin) Kernel Regression with Order Preferences AAAI 2007 4 / 24</p>
  </div>
  <div class="page">
    <p>Order preferences</p>
    <p>One way to express the knowledge is to use order preferences on unlabeled data xl+1, xl+2, . . .</p>
    <p>For some xi, xj , we may not know f (xi), f (xj ). But we prefer f (xi)  f (xj ).</p>
    <p>Definition</p>
    <p>An order preference is a tuple (i, j, d, w), so we prefer f (xi)  f (xj )  d with confidence w.</p>
    <p>Zhu, Goldberg (Wisconsin) Kernel Regression with Order Preferences AAAI 2007 5 / 24</p>
  </div>
  <div class="page">
    <p>Order preferences</p>
    <p>One way to express the knowledge is to use order preferences on unlabeled data xl+1, xl+2, . . .</p>
    <p>For some xi, xj , we may not know f (xi), f (xj ). But we prefer f (xi)  f (xj ).</p>
    <p>Definition</p>
    <p>An order preference is a tuple (i, j, d, w), so we prefer f (xi)  f (xj )  d with confidence w.</p>
    <p>Zhu, Goldberg (Wisconsin) Kernel Regression with Order Preferences AAAI 2007 5 / 24</p>
  </div>
  <div class="page">
    <p>Order preferences can encode various information</p>
    <p>order f (xi)  f (xj )  d (i, j, d, w)</p>
    <p>equal f (xi) = f (xj ) (i, j, 0, w), (j, i, 0, w) close |f (xi)  f (xj )|   (i, j, , w), (j, i, , w) interval a  f (xi)  f (xj )  b (i, j, a, w), (j, i, b, w) unary f (xi)  g(xi) special case, g() given</p>
    <p>Zhu, Goldberg (Wisconsin) Kernel Regression with Order Preferences AAAI 2007 6 / 24</p>
  </div>
  <div class="page">
    <p>Order preferences can encode various information</p>
    <p>order f (xi)  f (xj )  d (i, j, d, w) equal f (xi) = f (xj ) (i, j, 0, w), (j, i, 0, w)</p>
    <p>close |f (xi)  f (xj )|   (i, j, , w), (j, i, , w) interval a  f (xi)  f (xj )  b (i, j, a, w), (j, i, b, w) unary f (xi)  g(xi) special case, g() given</p>
    <p>Zhu, Goldberg (Wisconsin) Kernel Regression with Order Preferences AAAI 2007 6 / 24</p>
  </div>
  <div class="page">
    <p>Order preferences can encode various information</p>
    <p>order f (xi)  f (xj )  d (i, j, d, w) equal f (xi) = f (xj ) (i, j, 0, w), (j, i, 0, w) close |f (xi)  f (xj )|   (i, j, , w), (j, i, , w)</p>
    <p>interval a  f (xi)  f (xj )  b (i, j, a, w), (j, i, b, w) unary f (xi)  g(xi) special case, g() given</p>
    <p>Zhu, Goldberg (Wisconsin) Kernel Regression with Order Preferences AAAI 2007 6 / 24</p>
  </div>
  <div class="page">
    <p>Order preferences can encode various information</p>
    <p>order f (xi)  f (xj )  d (i, j, d, w) equal f (xi) = f (xj ) (i, j, 0, w), (j, i, 0, w) close |f (xi)  f (xj )|   (i, j, , w), (j, i, , w) interval a  f (xi)  f (xj )  b (i, j, a, w), (j, i, b, w)</p>
    <p>unary f (xi)  g(xi) special case, g() given</p>
    <p>Zhu, Goldberg (Wisconsin) Kernel Regression with Order Preferences AAAI 2007 6 / 24</p>
  </div>
  <div class="page">
    <p>Order preferences can encode various information</p>
    <p>order f (xi)  f (xj )  d (i, j, d, w) equal f (xi) = f (xj ) (i, j, 0, w), (j, i, 0, w) close |f (xi)  f (xj )|   (i, j, , w), (j, i, , w) interval a  f (xi)  f (xj )  b (i, j, a, w), (j, i, b, w) unary f (xi)  g(xi) special case, g() given</p>
    <p>Zhu, Goldberg (Wisconsin) Kernel Regression with Order Preferences AAAI 2007 6 / 24</p>
  </div>
  <div class="page">
    <p>Regression with order preferences</p>
    <p>Given: I labeled data (x1, y1), . . . , (xl, yl) I unlabeled data xl+1, . . . , xl+2p I order preferences (i1, j1, d1, w1), . . . , (ip, jp, dp, wp)</p>
    <p>learn f : X 7 R</p>
    <p>Zhu, Goldberg (Wisconsin) Kernel Regression with Order Preferences AAAI 2007 7 / 24</p>
  </div>
  <div class="page">
    <p>Standard kernel regression</p>
    <p>min fH</p>
    <p>l i=1</p>
    <p>c(xi, yi, f (xi)) + (fH)</p>
    <p>c() loss function  regularization weight</p>
    <p>() monotonic increasing function</p>
    <p>Zhu, Goldberg (Wisconsin) Kernel Regression with Order Preferences AAAI 2007 8 / 24</p>
  </div>
  <div class="page">
    <p>Kernel regression with order preferences</p>
    <p>min fH</p>
    <p>l i=1</p>
    <p>c(xi, yi, f (xi)) + 1(fH) + 2r(x, f )</p>
    <p>c() loss function 1, 2 regularization weight</p>
    <p>() monotonic increasing function r(x, f ) order preference regularization</p>
    <p>Zhu, Goldberg (Wisconsin) Kernel Regression with Order Preferences AAAI 2007 9 / 24</p>
  </div>
  <div class="page">
    <p>Order preferences as regularization</p>
    <p>(i, j, d, w) : f (xi)  f (xj )  d</p>
    <p>w max(d  (f (xi)  f (xj )), 0)</p>
    <p>d f(x )f(x )i j</p>
    <p>r(x, f ) = p</p>
    <p>q=1</p>
    <p>wq max(dq  (f (xiq)  f (xjq)), 0)</p>
    <p>Zhu, Goldberg (Wisconsin) Kernel Regression with Order Preferences AAAI 2007 10 / 24</p>
  </div>
  <div class="page">
    <p>Representer Theorem</p>
    <p>The minimizer f of</p>
    <p>min fH</p>
    <p>l i=1</p>
    <p>c(xi, yi, f (xi)) + 1(fH) + 2r(x, f )</p>
    <p>admits the form</p>
    <p>f (x) = l+2p i=1</p>
    <p>iK(xi, x)</p>
    <p>We optimize .</p>
    <p>Zhu, Goldberg (Wisconsin) Kernel Regression with Order Preferences AAAI 2007 11 / 24</p>
  </div>
  <div class="page">
    <p>Design choices</p>
    <p>min fH</p>
    <p>l i=1</p>
    <p>c(xi, yi, f (xi)) + 1(fH) + 2r(x, f )</p>
    <p>Loss c(x, y, f (x))  |y  f (x)|</p>
    <p>L1-norm (fH)  1 =</p>
    <p>i |i| r(x, f ) as before</p>
    <p>min</p>
    <p>l i=1 |yi  f (xi)| + 11 +</p>
    <p>2 1 p</p>
    <p>p q=1 wq max(dq  (f (xiq)  f (xjq)), 0)</p>
    <p>Zhu, Goldberg (Wisconsin) Kernel Regression with Order Preferences AAAI 2007 12 / 24</p>
  </div>
  <div class="page">
    <p>Design choices</p>
    <p>min fH</p>
    <p>l i=1</p>
    <p>c(xi, yi, f (xi)) + 1(fH) + 2r(x, f )</p>
    <p>Loss c(x, y, f (x))  |y  f (x)| L1-norm (fH)  1 =</p>
    <p>i |i|</p>
    <p>r(x, f ) as before</p>
    <p>min</p>
    <p>l i=1 |yi  f (xi)| + 11 +</p>
    <p>2 1 p</p>
    <p>p q=1 wq max(dq  (f (xiq)  f (xjq)), 0)</p>
    <p>Zhu, Goldberg (Wisconsin) Kernel Regression with Order Preferences AAAI 2007 12 / 24</p>
  </div>
  <div class="page">
    <p>Design choices</p>
    <p>min fH</p>
    <p>l i=1</p>
    <p>c(xi, yi, f (xi)) + 1(fH) + 2r(x, f )</p>
    <p>Loss c(x, y, f (x))  |y  f (x)| L1-norm (fH)  1 =</p>
    <p>i |i|</p>
    <p>r(x, f ) as before</p>
    <p>min</p>
    <p>l i=1 |yi  f (xi)| + 11 +</p>
    <p>2 1 p</p>
    <p>p q=1 wq max(dq  (f (xiq)  f (xjq)), 0)</p>
    <p>Zhu, Goldberg (Wisconsin) Kernel Regression with Order Preferences AAAI 2007 12 / 24</p>
  </div>
  <div class="page">
    <p>Design choices</p>
    <p>min fH</p>
    <p>l i=1</p>
    <p>c(xi, yi, f (xi)) + 1(fH) + 2r(x, f )</p>
    <p>Loss c(x, y, f (x))  |y  f (x)| L1-norm (fH)  1 =</p>
    <p>i |i|</p>
    <p>r(x, f ) as before</p>
    <p>min</p>
    <p>l i=1 |yi  f (xi)| + 11 +</p>
    <p>2 1 p</p>
    <p>p q=1 wq max(dq  (f (xiq)  f (xjq)), 0)</p>
    <p>Zhu, Goldberg (Wisconsin) Kernel Regression with Order Preferences AAAI 2007 12 / 24</p>
  </div>
  <div class="page">
    <p>Linear program</p>
    <p>Convex, piecewise linear. Convert to a linear program</p>
    <p>min,0,,, 1 l 1&gt; + 11&gt; +</p>
    <p>2 p w&gt;</p>
    <p>s.t.    1  y1:l  K(x1:l, x1:l)  01   + 1   0       (K(xi1:p, x1:l)  K(x</p>
    <p>j 1:p, x1:l))  d</p>
    <p>0</p>
    <p>Zhu, Goldberg (Wisconsin) Kernel Regression with Order Preferences AAAI 2007 13 / 24</p>
  </div>
  <div class="page">
    <p>A toy example</p>
    <p>0.2 0 0.2 0.4 0.6 0.8 1 1.2</p>
    <p>4</p>
    <p>3</p>
    <p>2</p>
    <p>1</p>
    <p>truth SVR SSL</p>
    <p>True function 3rd order polynomial</p>
    <p>Regression underfits</p>
    <p>Random order preference f (0.30)  f (0.15)  0 improves fit</p>
    <p>Zhu, Goldberg (Wisconsin) Kernel Regression with Order Preferences AAAI 2007 14 / 24</p>
  </div>
  <div class="page">
    <p>A toy example</p>
    <p>0.2 0 0.2 0.4 0.6 0.8 1 1.2</p>
    <p>4</p>
    <p>3</p>
    <p>2</p>
    <p>1</p>
    <p>truth SVR SSL</p>
    <p>More random order preferences improve even more</p>
    <p>Zhu, Goldberg (Wisconsin) Kernel Regression with Order Preferences AAAI 2007 15 / 24</p>
  </div>
  <div class="page">
    <p>Experiments on benchmark datasets</p>
    <p>Settings: I w = 1 I RBF kernel I Kernel bandwidth and 1 tuned by CV I 2 = 1 I Test-set error</p>
    <p>itest |yi  f (xi)|/|test|</p>
    <p>I Average over 20 random trials</p>
    <p>Zhu, Goldberg (Wisconsin) Kernel Regression with Order Preferences AAAI 2007 16 / 24</p>
  </div>
  <div class="page">
    <p>Oracle order preferences improve regression</p>
    <p>Oracle order preferences f (xi)  f (xj )  0.5(yi  yj ) 1000 order preferences</p>
    <p>Dataset Partition Mean absolute error Improvement dim l/u/test SVR SSL</p>
    <p>Boston 13 20/200/286 4.780 3.511 27% Abalone 8 30/1000/3147 1.856 1.685 9% Computer 21 30/1000/7162 7.373 5.364 27% California 8 60/1000/19580 58268 52120 11% Census 16 60/1000/21724 24992 23241 7%</p>
    <p>Zhu, Goldberg (Wisconsin) Kernel Regression with Order Preferences AAAI 2007 17 / 24</p>
  </div>
  <div class="page">
    <p>The more preferences, the better</p>
    <p>Boston Abalone</p>
    <p>SVR SSL</p>
    <p>SVR SSL</p>
    <p>Computer California Census</p>
    <p>SVR SSL</p>
    <p>SVR SSL</p>
    <p>SVR SSL</p>
    <p>number of order preferences p</p>
    <p>Zhu, Goldberg (Wisconsin) Kernel Regression with Order Preferences AAAI 2007 18 / 24</p>
  </div>
  <div class="page">
    <p>Order preferences most helpful with little labeled data</p>
    <p>Boston Abalone</p>
    <p>SVR SSL</p>
    <p>SVR SSL</p>
    <p>Computer California Census</p>
    <p>SVR SSL</p>
    <p>SVR SSL</p>
    <p>SVR SSL</p>
    <p>labeled data size l</p>
    <p>Zhu, Goldberg (Wisconsin) Kernel Regression with Order Preferences AAAI 2007 19 / 24</p>
  </div>
  <div class="page">
    <p>Order preferences helpful even when imperfect</p>
    <p>f (xi)  f (xj )  (yi  yj ) Boston Abalone</p>
    <p>SVR SSL</p>
    <p>SVR SSL</p>
    <p>Computer California Census</p>
    <p>SVR SSL</p>
    <p>SVR SSL</p>
    <p>SVR SSL</p>
    <p>Zhu, Goldberg (Wisconsin) Kernel Regression with Order Preferences AAAI 2007 20 / 24</p>
  </div>
  <div class="page">
    <p>Experiment with real order preferences</p>
    <p>Predict house value (California).</p>
    <p>Roughly equal I within 25 miles I age difference within 10 years I income difference within $1000</p>
    <p>When roughly equal, price ordered by the number of bedrooms.</p>
    <p>d = 0, w = 1, p = 1200 6% reduction in test-set error</p>
    <p>Post experiment: 30% order preferences were wrong. Robust.</p>
    <p>Zhu, Goldberg (Wisconsin) Kernel Regression with Order Preferences AAAI 2007 21 / 24</p>
  </div>
  <div class="page">
    <p>Experiment with real order preferences</p>
    <p>Predict house value (California).</p>
    <p>Roughly equal I within 25 miles I age difference within 10 years I income difference within $1000</p>
    <p>When roughly equal, price ordered by the number of bedrooms.</p>
    <p>d = 0, w = 1, p = 1200 6% reduction in test-set error</p>
    <p>Post experiment: 30% order preferences were wrong. Robust.</p>
    <p>Zhu, Goldberg (Wisconsin) Kernel Regression with Order Preferences AAAI 2007 21 / 24</p>
  </div>
  <div class="page">
    <p>Experiment with real order preferences</p>
    <p>Predict house value (California).</p>
    <p>Roughly equal I within 25 miles I age difference within 10 years I income difference within $1000</p>
    <p>When roughly equal, price ordered by the number of bedrooms.</p>
    <p>d = 0, w = 1, p = 1200 6% reduction in test-set error</p>
    <p>Post experiment: 30% order preferences were wrong. Robust.</p>
    <p>Zhu, Goldberg (Wisconsin) Kernel Regression with Order Preferences AAAI 2007 21 / 24</p>
  </div>
  <div class="page">
    <p>Experiment with real order preferences</p>
    <p>Predict house value (California).</p>
    <p>Roughly equal I within 25 miles I age difference within 10 years I income difference within $1000</p>
    <p>When roughly equal, price ordered by the number of bedrooms.</p>
    <p>d = 0, w = 1, p = 1200</p>
    <p>Post experiment: 30% order preferences were wrong. Robust.</p>
    <p>Zhu, Goldberg (Wisconsin) Kernel Regression with Order Preferences AAAI 2007 21 / 24</p>
  </div>
  <div class="page">
    <p>Experiment with real order preferences</p>
    <p>Predict house value (California).</p>
    <p>Roughly equal I within 25 miles I age difference within 10 years I income difference within $1000</p>
    <p>When roughly equal, price ordered by the number of bedrooms.</p>
    <p>d = 0, w = 1, p = 1200 6% reduction in test-set error</p>
    <p>Post experiment: 30% order preferences were wrong. Robust.</p>
    <p>Zhu, Goldberg (Wisconsin) Kernel Regression with Order Preferences AAAI 2007 21 / 24</p>
  </div>
  <div class="page">
    <p>Experiment with real order preferences</p>
    <p>Predict house value (California).</p>
    <p>Roughly equal I within 25 miles I age difference within 10 years I income difference within $1000</p>
    <p>When roughly equal, price ordered by the number of bedrooms.</p>
    <p>d = 0, w = 1, p = 1200 6% reduction in test-set error</p>
    <p>Post experiment: 30% order preferences were wrong. Robust.</p>
    <p>Zhu, Goldberg (Wisconsin) Kernel Regression with Order Preferences AAAI 2007 21 / 24</p>
  </div>
  <div class="page">
    <p>Conclusions</p>
    <p>Order preferences encode domain knowledge</p>
    <p>Linear program for kernel regression</p>
    <p>Even noisy, heuristic order preferences help</p>
    <p>Zhu, Goldberg (Wisconsin) Kernel Regression with Order Preferences AAAI 2007 22 / 24</p>
  </div>
  <div class="page">
    <p>Thank you</p>
    <p>Questions?</p>
    <p>Zhu, Goldberg (Wisconsin) Kernel Regression with Order Preferences AAAI 2007 23 / 24</p>
  </div>
  <div class="page">
    <p>Connection to semi-supervised learning</p>
    <p>min fH</p>
    <p>l i=1</p>
    <p>c(xi, yi, f (xi)) + 1(fH) + 2r(x, f )</p>
    <p>Order preferences:</p>
    <p>r(x, f ) = p</p>
    <p>q=1</p>
    <p>wq max(dq  (f (xiq)  f (xjq)), 0)</p>
    <p>Graph-based semi-supervised learning (manifold regularization):</p>
    <p>r(x, f ) =</p>
    <p>i,jU wij (f (xi)  f (xj ))2,</p>
    <p>Semi-supervised support vector machines (S3VMs):</p>
    <p>r(x, f ) =  iU</p>
    <p>max(1  |f (xi)|, 0)</p>
    <p>Zhu, Goldberg (Wisconsin) Kernel Regression with Order Preferences AAAI 2007 24 / 24</p>
  </div>
</Presentation>
